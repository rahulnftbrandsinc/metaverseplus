!function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);h.length;)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={6:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=a);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+"assets/js/"+({14:"vendors~pdfjsWorker"}[e]||e)+"-"+{14:"cc10ff43502da9914f92",18:"deb590a95f32ad55a327",19:"9d314885b4be2546bd4d",20:"51602cb7f065a8c1138b",21:"6a9f00d0a5e7b80146b6",22:"3abf1b2bcf31f38ae0ed",23:"94819a85f75533f6e91c",24:"1aa12389c4edd8cb52ac",25:"6abcf658582e38411709",26:"a0114c7e0a3079e69f56"}[e]+".js"}(e);var l=new Error;r=function(t){s.onerror=s.onload=null,clearTimeout(c);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",l.name="ChunkLoadError",l.type=a,l.request=r,n[1](l)}i[e]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:s})}),12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="https://assets.metaverseplus2.xyz/hubs/",o.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;r.push([1609,0,2,1,7]),n()}({10:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return d}));const a=["linear","inverse","exponential"],i=Object.freeze({MEDIA_VIDEO:0,AVATAR_AUDIO_SOURCE:1,SFX:2,AUDIO_TARGET:3,AUDIO_ZONE:4}),r={Stereo:"stereo",PannerNode:"pannernode"},o={Linear:"linear",Inverse:"inverse",Exponential:"exponential"},s=Object.freeze({audioType:r.PannerNode,distanceModel:o.Inverse,rolloffFactor:5,refDistance:5,maxDistance:1e4,coneInnerAngle:180,coneOuterAngle:360,coneOuterGain:.9,gain:1}),l=Object.freeze({audioType:r.PannerNode,distanceModel:o.Inverse,rolloffFactor:5,refDistance:5,maxDistance:1e4,coneInnerAngle:360,coneOuterAngle:0,coneOuterGain:.9,gain:.5}),c=Object.freeze({audioType:r.PannerNode,distanceModel:o.Inverse,rolloffFactor:5,refDistance:8,maxDistance:1e4,coneInnerAngle:170,coneOuterAngle:300,coneOuterGain:.3,gain:1}),d=.2},103:function(e,t,n){"use strict";function a(e,t){for(;e&&(!e.components||!e.components[t]);)e=e.parentNode;return e}function i(e,t){const n=[];for(;e;){if(e.components)for(const a in e.components)e.components[a].name===t&&n.push(e.components[a]);if(n.length)return n;e=e.parentNode}return n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},104:function(e,t,n){e.exports={modal:"Modal__modal__1Ursl",header:"Modal__header__3mOig","before-title":"Modal__before-title__1zICW",beforeTitle:"Modal__before-title__1zICW","after-title":"Modal__after-title__1cSnu",afterTitle:"Modal__after-title__1cSnu",content:"Modal__content__2Xoyi","sm-fullscreen":"Modal__sm-fullscreen__3KER8",smFullscreen:"Modal__sm-fullscreen__3KER8"}},105:function(e,t,n){e.exports={"chat-input-container":"ChatSidebar__chat-input-container__5hl7C",chatInputContainer:"ChatSidebar__chat-input-container__5hl7C","message-list":"ChatSidebar__message-list__3771x",messageList:"ChatSidebar__message-list__3771x","message-group":"ChatSidebar__message-group__2XAMr",messageGroup:"ChatSidebar__message-group__2XAMr","message-group-label":"ChatSidebar__message-group-label__gHMNV",messageGroupLabel:"ChatSidebar__message-group-label__gHMNV","message-group-messages":"ChatSidebar__message-group-messages__1vI-w",messageGroupMessages:"ChatSidebar__message-group-messages__1vI-w","message-bubble":"ChatSidebar__message-bubble__1T3tG",messageBubble:"ChatSidebar__message-bubble__1T3tG",sent:"ChatSidebar__sent__1nNfC",emoji:"ChatSidebar__emoji__1c4DB",media:"ChatSidebar__media__2r4Qs",monospace:"ChatSidebar__monospace__2J8GU","system-message":"ChatSidebar__system-message__2XsZ4",systemMessage:"ChatSidebar__system-message__2XsZ4","chat-input-icon":"ChatSidebar__chat-input-icon__2U7e_",chatInputIcon:"ChatSidebar__chat-input-icon__2U7e_","chat-input-warning":"ChatSidebar__chat-input-warning__2g3DW",chatInputWarning:"ChatSidebar__chat-input-warning__2g3DW","warning-border":"ChatSidebar__warning-border__UOmZx",warningBorder:"ChatSidebar__warning-border__UOmZx","warning-text-color":"ChatSidebar__warning-text-color__3flSA",warningTextColor:"ChatSidebar__warning-text-color__3flSA","chat-input-text-area-styles":"ChatSidebar__chat-input-text-area-styles__1UPBX",chatInputTextAreaStyles:"ChatSidebar__chat-input-text-area-styles__1UPBX"}},1052:function(e,t,n){e.exports={"no-default-button-style":"hub__no-default-button-style__nC22i",noDefaultButtonStyle:"hub__no-default-button-style__nC22i"}},106:function(e,t,n){e.exports={"audio-debug-container":"AudioDebugPanel__audio-debug-container__3Py8H",audioDebugContainer:"AudioDebugPanel__audio-debug-container__3Py8H","audio-debug-row":"AudioDebugPanel__audio-debug-row__2FO2j",audioDebugRow:"AudioDebugPanel__audio-debug-row__2FO2j","prop-text":"AudioDebugPanel__prop-text__wY15J",propText:"AudioDebugPanel__prop-text__wY15J","value-text":"AudioDebugPanel__value-text__3GP95",valueText:"AudioDebugPanel__value-text__3GP95"}},109:function(e,t,n){"use strict";function a(e){if(!e)return"";const t=e.split("@"),n=t[0],a=t[1],i=n.substring(0,Math.min(n.length,3));return"".concat(i,"...@").concat(a)}n.d(t,"a",(function(){return a}))},11:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"n",(function(){return u})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"d",(function(){return E})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return _}));var a=n(24);const i=new THREE.Vector3;new THREE.Quaternion;function r(e,t){return e.updateMatrices(),t.setFromMatrixPosition(e.matrixWorld),t}function o(e,t){return e.updateMatrices(),e.matrixWorld.decompose(i,t,i),t}function s(e){e.map&&e.map.dispose(),e.lightMap&&e.lightMap.dispose(),e.bumpMap&&e.bumpMap.dispose(),e.normalMap&&e.normalMap.dispose(),e.specularMap&&e.specularMap.dispose(),e.envMap&&e.envMap.dispose(),e.dispose()}function l(e){if(e instanceof THREE.Mesh&&(e.geometry&&e.geometry.dispose(),e.material)){let t;e.material instanceof THREE.MeshFaceMaterial||e.material instanceof THREE.MultiMaterial?t=e.material.materials:e.material instanceof Array&&(t=e.material),t?t.forEach(s):s(e.material)}}const c=(new THREE.Matrix4).identity(),d=new THREE.Matrix4;function u(e,t){e.matrixIsModified||e.applyMatrix4(c),d.copy(e.matrixWorld),e.matrixWorld.copy(t),e.parent?(e.parent.updateMatrices(),e.matrix=e.matrix.copy(e.parent.matrixWorld).invert().multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale),d.near(e.matrixWorld,1e-11)?e.matrixWorld.copy(d):e.childrenNeedMatrixWorldUpdate=!0}function h(e,t){const n=e.tracks.map(e=>function(e,t){const{nodeName:n,objectName:a,objectIndex:i,propertyName:r,propertyIndex:o}=THREE.PropertyBinding.parseTrackName(e.name);let s="";if(void 0!==n){const e=t.get(n);void 0===e&&console.warn('Could not find KeyframeTrack target with uuid: "'.concat(n,'"')),s+=e}void 0!==a&&(s+="."+a),void 0!==i&&(s+="["+i+"]"),void 0!==r&&(s+="."+r),void 0!==o&&(s+="["+o+"]");const l=e.clone();return l.name=s,l}(e,t));return new THREE.AnimationClip(e.name,e.duration,n)}function p(e,t){const n=new Map,a=new Map,i=e.clone();return function e(t,n,a){a(t,n);for(let i=0;i<t.children.length;i++)e(t.children[i],n.children[i],a)}(e,i,(e,t)=>{n.set(e,t)}),e.traverse(e=>{const i=n.get(e);t&&(i.uuid=e.uuid),a.set(e.uuid,i.uuid)}),e.traverse(e=>{const t=n.get(e);if(!t)return;if(e.animations&&(t.animations=e.animations.map(e=>h(e,a))),e.isMesh&&e.geometry.boundsTree&&(t.geometry.boundsTree=e.geometry.boundsTree),(t.isDirectionalLight||t.isSpotLight)&&e.target&&(t.target=n.get(e.target)),!e.isSkinnedMesh)return;const i=e.skeleton.bones;t.skeleton=e.skeleton.clone(),t.skeleton.bones=i.map(e=>{if(!n.has(e))throw new Error("Required bones are not descendants of the given object.");return n.get(e)}),t.bind(t.skeleton,e.bindMatrix)}),i}function m(e,t){let n=[e];for(;n.length;){const e=n.shift();if(t(e))return e;e.children&&(n=n.concat(e.children))}return null}const f=function(){const e=new THREE.Matrix4,t={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3},n={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3},a={position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3};return function(i,r,o,s){return n.quaternion.setFromRotationMatrix(e.extractRotation(i)),t.quaternion.setFromRotationMatrix(e.extractRotation(r)),a.quaternion.slerpQuaternions(n.quaternion,t.quaternion,o),a.position.lerpVectors(n.position.setFromMatrixColumn(i,3),t.position.setFromMatrixColumn(r,3),o),a.scale.lerpVectors(n.scale.setFromMatrixScale(i),t.scale.setFromMatrixScale(r),o),s.compose(a.position,a.quaternion,a.scale)}}();!function(){const e=new THREE.Vector3,t=new THREE.Vector3}();const g=function(){const e=new THREE.Matrix4,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Matrix4;return function(s,l){return e.identity().extractRotation(o.copy(s)),t.setFromMatrixColumn(e,2).multiplyScalar(-1),n.copy(t).sub(r.copy(t).projectOnVector(i.set(0,1,0))).normalize(),a.crossVectors(n,i),l.makeBasis(a,i,n.multiplyScalar(-1)),l.scale(r.setFromMatrixScale(o)),l.setPosition(r.setFromMatrixColumn(o,3)),l}}(),v=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Matrix4;return function(a,i,r){g(a,e),n.copy(e).invert().multiply(a),g(i,t),r.copy(t).multiply(n)}}(),b=function(e,t,n,a,i){const r=Math.max(Math.abs(n.max.y-a.y),Math.abs(a.y-n.min.y)),o=Math.max(Math.abs(n.max.x-a.x),Math.abs(a.x-n.min.x)),s=THREE.Math.degToRad(e/2),l=Math.atan(Math.tan(s)*t)*(i?.5:1),c=Math.abs(1.05*r/Math.tan(s)),d=Math.abs(1.05*o/Math.tan(l)),u=Math.abs(n.max.z-a.z)+Math.max(c,d);return(i?Math.max(.25,u):u)||1.25},y=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Matrix4,a=new THREE.Vector3;return function(i,r,o){return e.copy(i),o.copy(n.makeRotationY(r).multiply(t.extractRotation(e))).scale(a.setFromMatrixScale(e)).setPosition(a.setFromMatrixPosition(e))}}(),E=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Matrix4,a=new THREE.Matrix4;return function(i,r,o){i.updateMatrices(),e.copy(i.matrixWorld).invert(),r.updateMatrices(),t.multiplyMatrices(e,r.matrixWorld),n.copy(t).invert(),a.multiplyMatrices(o,n),u(i,a)}}();function w(e,t,n,a,i=!0){const r=new THREE.PlaneBufferGeometry(e,t,n,a);if(!1===i){const e=r.getAttribute("uv");for(let t=0;t<e.count;t++)e.setY(t,1-e.getY(t))}return r}function _(e){const t=[];return e.skeleton.bones.forEach((e,n)=>{(function e(t){return"Head"===t.name||t.parent&&e(t.parent)})(e)&&t.push(n)}),t.length?(e.layers.set(a.a.CAMERA_LAYER_THIRD_PERSON_ONLY),function(e,t){const n=new THREE.SkinnedMesh(e.geometry.clone(),e.material);n.name="".concat(e.name,"(headless)"),n.frustumCulled=e.frustumCulled,n.layers.set(a.a.CAMERA_LAYER_FIRST_PERSON_ONLY);const i=n.geometry,r=i.getAttribute("skinIndex").array,o=[];for(let e=0;e<r.length;e+=4)o.push([r[e],r[e+1],r[e+2],r[e+3]]);const s=i.getAttribute("skinWeight").array,l=[];for(let e=0;e<s.length;e+=4)l.push([s[e],s[e+1],s[e+2],s[e+3]]);const c=i.getIndex();if(!c)throw new Error("The geometry doesn't have an index buffer");const d=Array.from(c.array),u=function(e,t,n,a){let i=0;if(null!=t&&t.length>0)for(let r=0;r<e.length;r+=3){const o=e[r],s=e[r+1],l=e[r+2],c=t[o],d=n[o];if(c[0]>0&&a.includes(d[0]))continue;if(c[1]>0&&a.includes(d[1]))continue;if(c[2]>0&&a.includes(d[2]))continue;if(c[3]>0&&a.includes(d[3]))continue;const u=t[s],h=n[s];if(u[0]>0&&a.includes(h[0]))continue;if(u[1]>0&&a.includes(h[1]))continue;if(u[2]>0&&a.includes(h[2]))continue;if(u[3]>0&&a.includes(h[3]))continue;const p=t[l],m=n[l];p[0]>0&&a.includes(m[0])||(p[1]>0&&a.includes(m[1])||p[2]>0&&a.includes(m[2])||p[3]>0&&a.includes(m[3])||(e[i++]=o,e[i++]=s,e[i++]=l))}return i}(d,l,o,t),h=[];for(let e=0;e<u;e++)h[e]=d[e];return i.setIndex(h),e.onBeforeRender&&(n.onBeforeRender=e.onBeforeRender),n.bind(new THREE.Skeleton(e.skeleton.bones,e.skeleton.boneInverses),new THREE.Matrix4),n}(e,t)):(e.layers.enable(a.a.CAMERA_LAYER_THIRD_PERSON_ONLY),void e.layers.enable(a.a.CAMERA_LAYER_FIRST_PERSON_ONLY))}},110:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));let a=null;function i(){return null===a&&(a=/\b(Macintosh|iPad|iPhone)\b/i.test(navigator.userAgent)&&function(){let e=!1;if("maxTouchPoints"in navigator)e=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)e=navigator.msMaxTouchPoints>0;else{const t=window.matchMedia&&matchMedia("(pointer:coarse)");if(t&&"(pointer:coarse)"===t.media)e=!!t.matches;else if("orientation"in window)e=!0;else{const t=navigator.userAgent;e=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)}}return e}()),a}},113:function(e,t,n){"use strict";function a(e){const t=e.sceneEl.is("frozen"),n=e.components.pinnable&&e.components.pinnable.data.pinned,a=!!e.components["super-spawner"],i=a&&"#interactable-emoji"===e.components["super-spawner"].data.template,r=(!!e.components.emoji||i?window.APP.hubChannel.can("spawn_emoji"):window.APP.hubChannel.can("spawn_and_move_media"))&&(!n||window.APP.hubChannel.can("pin_objects"));return(a||!n||t)&&r}function i(e){const t=e.components.pinnable&&e.components.pinnable.data.pinned,n=e&&e.components.networked&&e.components.networked.data.template,a="#interactable-camera"===n,i="#interactable-pen"===n,r="#interactable-emoji"===(e&&e.components["super-spawner"]&&e.components["super-spawner"].data.template),o=!!e.components.emoji;return e.components.tags&&e.components.tags.data.holdableButton||(o||r?window.APP.hubChannel.can("spawn_emoji"):window.APP.hubChannel.can("spawn_and_move_media"))&&(!t||window.APP.hubChannel.can("pin_objects"))&&(!a||window.APP.hubChannel.can("spawn_camera"))&&(!i||window.APP.hubChannel.can("spawn_drawing"))}function r(e,t){const n="string"==typeof e,a=n?e:e.component;return n?t.components.findIndex(e=>e===a):t.components.findIndex(t=>t.component===a&&t.property===e.property)}n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));let o=null;function s(e,t){null===o&&function(){o={};const{schemaDict:e}=NAF.schemas;for(const t in e){if(!e.hasOwnProperty(t))continue;const n=e[t];o[t]=(n.nonAuthorizedComponents||[]).map(e=>r(e,n)).map(e=>e.toString())}}();const n=o[e];for(const e in t.components)t.components.hasOwnProperty(e)&&(n.includes(e)||(t.components[e]=null));return t}function l(e,t,n){const{template:a,creator:i,isPinned:r}=e,o=t===i;return!(!a.endsWith("-waypoint-avatar")&&!a.endsWith("-media-frame"))||(a.endsWith("-avatar")?o:a.endsWith("-media")?(!r||n.pin_objects)&&(o||n.spawn_and_move_media):a.endsWith("-camera")?o||n.spawn_camera:a.endsWith("-pen")||a.endsWith("-drawing")?o||n.spawn_drawing:!!a.endsWith("-emoji")&&(o||n.spawn_emoji))}function c(e){const t=NAF.connection.adapter.getPendingDataForNetworkId(e);if(t){if(t.owner){if(!window.APP.hubChannel.presence.state[t.owner])return}const{template:e,creator:n}=t,a=NAF.schemas.schemaDict[e],i=t.components[r("pinnable",a)];return{template:e,creator:n,isPinned:i&&i.pinned}}const n=NAF.entities.getEntity(e);if(!n)return null;const{template:a,creator:i}=n.components.networked.data;return{template:a,creator:i,isPinned:n.components.pinnable&&n.components.pinnable.data.pinned}}function d(e,t,n){const a=c(e.networkId);if(!a)return!1;if(l(a,t,n))return!0;{const{template:t}=a;return s(t,e),!0}}const u={};function h(e,t){if(u[t.networkId]){const e=u[t.networkId].data,n=e.components;Object.assign(e,t),e.components=Object.assign(n,t.components)}else u[t.networkId]={dataType:"u",data:t,clientId:e.clientId,from_session_id:e.from_session_id}}const p={};function m(e){const{dataType:t,from_session_id:n}=e;if("u"===t&&e.data.isFirstSync&&!e.data.persistent)return e;const a=window.APP.hubChannel.presence.state[n];if(!a)return p;const i=a.metas[0].permissions;if("um"===t){let t=!1,a=!1;for(const r in e.data.d){if(!e.data.d.hasOwnProperty(r))continue;const o=e.data.d[r];if(o.persistent&&!NAF.entities.getEntity(o.networkId))h(e,o),e.data.d[r]=null,a=!0;else{d(o,n,i)||(e.data.d[r]=null,t=!0)}}return(t||a)&&(e.data.d=e.data.d.filter(e=>null!=e)),e}if("u"===t){if(e.data.persistent&&!NAF.entities.getEntity(e.data.networkId))return u[e.data.networkId]=e,p;return d(e.data,n,i)?e:p}if("r"===t){const t=c(e.data.networkId);return t&&l(t,n,i)?e:p}return e}function f(e){u[e]&&(NAF.connection.adapter.handleIncomingNAF(u[e]),delete u[e])}},1133:function(e,t){AFRAME.registerComponent("bone-mute-state-indicator",{schema:{unmutedBoneName:{default:"Watch_Joint_MicON"},mutedBoneName:{default:"Watch_Joint_Muted"},onPos:{default:.81},offPos:{default:.5}},init(){this.onStateToggled=this.onStateToggled.bind(this),this.el.addEventListener("model-loaded",()=>{this.unmutedBone=this.el.object3D.getObjectByName(this.data.unmutedBoneName),this.mutedBone=this.el.object3D.getObjectByName(this.data.mutedBoneName),this.modelLoaded=!0,this.updateMuteState()}),this.onMicStateChanged=()=>{this.updateMuteState()}},play(){APP.dialog.on("mic-state-changed",this.onMicStateChanged)},pause(){APP.dialog.off("mic-state-changed",this.onMicStateChanged)},updateMuteState(){if(!this.modelLoaded)return;const e=!APP.mediaDevicesManager.isMicEnabled;this.mutedBone.position.y=e?this.data.onPos:this.data.offPos,this.unmutedBone.position.y=e?this.data.offPos:this.data.onPos,this.mutedBone.matrixNeedsUpdate=!0,this.unmutedBone.matrixNeedsUpdate=!0}})},1134:function(e,t){function n(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}AFRAME.registerComponent("fader",{schema:{direction:{type:"string",default:"none"}},init(){const e=new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial({color:0,side:THREE.BackSide,opacity:0,transparent:!0,fog:!1}));e.scale.x=e.scale.y=1,e.scale.z=.15,e.matrixNeedsUpdate=!0,this.el.object3DMap.camera.add(e),this.mesh=e},fadeOut(){return this.beginTransition("out")},fadeIn(){return this.beginTransition("in")},beginTransition(e){var t,a=this;return(t=function*(){if(a._resolveFinish)throw new Error("Cannot fade while a fade is happening.");return a.el.setAttribute("fader",{direction:e}),new Promise(t=>{a.mesh.material.opacity===("in"==e?0:1)?t():a._resolveFinish=t})},function(){var e=this,a=arguments;return new Promise((function(i,r){var o=t.apply(e,a);function s(e){n(o,i,r,s,l,"next",e)}function l(e){n(o,i,r,s,l,"throw",e)}s(void 0)}))})()},tick(e,t){const n=this.mesh.material;this.mesh.visible="out"===this.data.direction||0!==n.opacity,this.mesh.visible&&("in"===this.data.direction?n.opacity=Math.max(0,n.opacity-1/750*Math.min(t,50)):"out"===this.data.direction&&(n.opacity=Math.min(1,n.opacity+1/750*Math.min(t,50))),0!==n.opacity&&1!==n.opacity||("none"!==this.data.direction&&this._resolveFinish&&(this._resolveFinish(),this._resolveFinish=null),this.el.setAttribute("fader",{direction:"none"})))}})},1135:function(e,t){AFRAME.registerComponent("icon-button",{schema:{image:{type:"string"},hoverImage:{type:"string"},activeImage:{type:"string"},activeHoverImage:{type:"string"},disabledImage:{type:"string"},active:{type:"boolean"},disabled:{type:"boolean"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init(){this.el.object3D.matrixNeedsUpdate=!0,this.onHover=()=>{this.hovering=!0,this.data.tooltip&&(this.data.tooltip.object3D.visible=!0),this.updateButtonState()},this.onHoverOut=()=>{this.hovering=!1,this.data.tooltip&&(this.data.tooltip.object3D.visible=!1),this.updateButtonState()}},play(){this.updateButtonState(),this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering,t=this.data.active,n=this.data.disabled;let a;if(a=n?"disabledImage":t?e?"activeHoverImage":"activeImage":e?"hoverImage":"image",this.el.components.sprite?this.data[a]?this.el.setAttribute("sprite","name",this.data[a]):console.warn("No ".concat(a," image on me."),this):console.error("No sprite."),this.data.tooltip&&e){const e=(this.data.active?this.data.activeTooltipText:this.data.tooltipText)+(n?" Disabled":"");this.data.tooltip.querySelector("[text]").setAttribute("text","value",e)}}})},1136:function(e,t){AFRAME.registerComponent("text-button",{schema:{textHoverColor:{type:"string"},textColor:{type:"string"},backgroundHoverColor:{type:"string"},backgroundColor:{type:"string"}},init(){this.el.object3D.matrixNeedsUpdate=!0,this.onHover=()=>{this.hovering=!0,this.updateButtonState()},this.onHoverOut=()=>{this.hovering=!1,this.updateButtonState()},this.textEl=this.el.querySelector("[text]"),this.el.getObject3D("mesh")?this.el.components.slice9.plane.material.toneMapped=!1:this.el.addEventListener("object3dset",()=>{this.el.components.slice9.plane.material.toneMapped=!1},{once:!0})},play(){this.updateButtonState(),this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.updateButtonState()},updateButtonState(){const e=this.hovering;this.el.setAttribute("slice9","color",e?this.data.backgroundHoverColor:this.data.backgroundColor),this.textEl&&this.textEl.setAttribute("text","color",e?this.data.textHoverColor:this.data.textColor)}});const n=function(){};AFRAME.registerComponent("text-raycast-hack",{dependencies:["text"],init(){this.el.getObject3D("text").raycast=n}})},1137:function(e,t){AFRAME.registerComponent("block-button",{init(){this.onClick=()=>{this.block(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},block(e){window.APP.hubChannel.hide(e)}})},1138:function(e,t){function n(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}AFRAME.registerComponent("mute-button",{init(){this.onClick=()=>{this.mute(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},mute(e){var t,a=this;return(t=function*(){a.el.sceneEl.emit("action_mute_client",{clientId:e})},function(){var e=this,a=arguments;return new Promise((function(i,r){var o=t.apply(e,a);function s(e){n(o,i,r,s,l,"next",e)}function l(e){n(o,i,r,s,l,"throw",e)}s(void 0)}))})()}})},1139:function(e,t){function n(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}AFRAME.registerComponent("kick-button",{init(){this.onClick=()=>{this.kick(this.owner)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.owner=e.components.networked.data.owner})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},kick(e){var t,a=this;return(t=function*(){a.el.sceneEl.emit("action_kick_client",{clientId:e})},function(){var e=this,a=arguments;return new Promise((function(i,r){var o=t.apply(e,a);function s(e){n(o,i,r,s,l,"next",e)}function l(e){n(o,i,r,s,l,"throw",e)}s(void 0)}))})()}})},1140:function(e,t){AFRAME.registerComponent("close-vr-notice-button",{init(){this.onClick=()=>{this.el.sceneEl.emit("action_vr_notice_closed")}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},1141:function(e,t){AFRAME.registerComponent("leave-room-button",{init(){this.onClick=()=>{this.el.sceneEl.emit("leave_room_requested")}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},1142:function(e,t){AFRAME.registerComponent("visible-if-permitted",{schema:{type:"string"},init(){this.updateVisibility=this.updateVisibility.bind(this),this.updateVisibility(),window.APP.hubChannel.addEventListener("permissions_updated",this.updateVisibility)},updateVisibility(){this.el.object3D.visible=this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data)},remove(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updateVisibility)}})},1143:function(e,t){AFRAME.registerComponent("visibility-on-content-types",{schema:{contentTypes:{type:"string"},contentSubtype:{type:"string"},visible:{type:"boolean",default:!0}},init(){this.updateVisibility=this.updateVisibility.bind(this),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,e.addEventListener("media_resolved",({detail:{contentType:e}})=>this.updateVisibility(e)),this.updateVisibility()}).catch(()=>{})},updateVisibility(e){const t=this.networkedEl.components["media-loader"],n=this.networkedEl.components["media-image"],a=this.networkedEl.components["media-video"],i=this.networkedEl.components["media-pdf"],r=e||a&&a.data.contentType||n&&n.data.contentType||i&&i.data.contentType;let o=!this.data.contentTypes;if(this.data.contentTypes&&r)for(const e of this.data.contentTypes.split(" ")){const t=r.toLowerCase().split(";")[0];if(t===e||e.endsWith("/")&&t.startsWith(e)){o=!0;break}}const s=!this.data.contentSubtype||t.data.contentSubtype&&t.data.contentSubtype===this.data.contentSubtype,l=!(!o||!s);this.el.object3D.visible=this.data.visible?l:!l}})},1144:function(e,t){AFRAME.registerComponent("hide-when-pinned-and-forbidden",{schema:{whenPinned:{type:"boolean"}},init(){this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)})},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){if(!this.targetEl)return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;if(this.data.whenPinned)this.el.object3D.visible=!e;else{const t=e&&!window.APP.hubChannel.canOrWillIfCreator("pin_objects");this.el.object3D.visible=!t}}})},1145:function(e,t,n){},1146:function(e,t){AFRAME.registerComponent("networked-avatar",{schema:{left_hand_pose:{default:0},right_hand_pose:{default:0}}})},116:function(e,t,n){"use strict";function a(e,t){let n=e;for(;n;){if(n===t)return!0;if(!n.visible)return!1;n=n.parent}return console.error("Root ".concat(t," is not an ancestor of node ").concat(e)),!1}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c}));const i=new THREE.Box3(new THREE.Vector3(-.001,-.001,-.001),new THREE.Vector3(.001,.001,.001)),r=function(){const e=new THREE.Vector3,t=new THREE.Matrix4,n=new THREE.Matrix4;return function(r,o,s){o.makeEmpty(),r.updateMatrices(),t.copy(r.matrixWorld).invert(),r.traverse(l=>{if((!s||a(l,r))&&(l.updateMatrices(),n.multiplyMatrices(t,l.matrixWorld),l.geometry))if(l.isTroikaText)o.union(i);else if(l.geometry.isGeometry)for(let t=0;t<l.geometry.vertices;t++)e.copy(l.geometry.vertices[t]).applyMatrix4(n),isNaN(e.x)||o.expandByPoint(e);else if(l.geometry.isBufferGeometry&&l.geometry.attributes.position){const t=l.geometry.attributes.position.array,a=l.geometry.attributes.position.itemSize;for(let i=0;i<l.geometry.attributes.position.count;i++){if(2===a)e.set(t[2*i],t[2*i+1],0);else{if(3!==a)return;e.fromBufferAttribute(l.geometry.attributes.position,i)}e.applyMatrix4(n),isNaN(e.x)||o.expandByPoint(e)}}})}}(),o=function(){const e=new THREE.Box3;return function(t,n,i){return n.makeEmpty(),t.updateMatrices(),t.traverse(r=>{if(i&&!a(r,t))return;r.updateMatrices();const o=r.geometry;null!=o&&(null==o.boundingBox&&o.computeBoundingBox(),n.union(e.copy(o.boundingBox).applyMatrix4(r.matrixWorld)))}),n}}(),s=new THREE.Euler;function l(e,t,n){const a=new THREE.Box3;return s.copy(e.object3D.rotation),e.object3D.rotation.set(0,0,0),e.object3D.updateMatrices(!0,!0),t.updateMatrices(!0,!0),t.updateMatrixWorld(!0),o(t,a,!1),a.isEmpty()||(n||(e.object3D.worldToLocal(a.min),e.object3D.worldToLocal(a.max)),e.object3D.rotation.copy(s),e.object3D.matrixNeedsUpdate=!0),t.matrixWorldNeedsUpdate=!0,t.updateMatrices(),a}function c(e,t){if(t.isEmpty())return 1;const{max:n,min:a}=t,i=Math.abs(n.x-a.x),r=Math.abs(n.y-a.y),o=Math.abs(n.z-a.z);return e/Math.max(i,r,o)}},1166:function(e,t){},1168:function(e,t){},12:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a=new URLSearchParams(location.search);function i(e){const t=a.get(e);return""===t||/1|on|true|yes/i.test(t)}function r(e){return a.get(e)}},13:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));const a=function(e,t){return new Promise(n=>{t.addEventListener(e,n,{once:!0})})},i=function(){return"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?Promise.resolve(null):a("DOMContentLoaded",window)},r=function(e){return new Promise(t=>{setTimeout(t,e)})}},132:function(e,t,n){var a={"./de.json":[237,18],"./es.json":[238,19],"./fr.json":[239,20],"./ja.json":[240,21],"./ko.json":[241,22],"./pt.json":[242,23],"./ru.json":[243,24],"./zh-cn.json":[244,25],"./zh-tw.json":[245,26]};function i(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],i=t[0];return n.e(t[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(a)},i.id=132,e.exports=i},1328:function(e,t){},1329:function(e,t){},1330:function(e,t){},1331:function(e,t){},1333:function(e,t){AFRAME.registerComponent("pinnable",{schema:{pinned:{default:!1}},init(){this._persist=this._persist.bind(this),this._persistAndAnimate=this._persistAndAnimate.bind(this),this.el.addEventListener("media_refreshed",this._persistAndAnimate),this.el.addEventListener("owned-pager-page-changed",this._persist),this.el.addEventListener("owned-video-state-changed",this._persistAndAnimate)},update(){this._animate()},_persistAndAnimate(){this._persist(),this._animate()},_persist(){window.APP.pinningHelper.setPinned(this.el,this.data.pinned)},_isMine(){var e;return(null===(e=this.el.components.networked)||void 0===e?void 0:e.data)&&NAF.utils.isMine(this.el)},_animate(){var e,t;const n=(null===(e=this.el.components["animation__pin-start"])||void 0===e?void 0:e.animationIsPlaying)||(null===(t=this.el.components["animation__pin-end"])||void 0===t?void 0:t.animationIsPlaying);if(this._isMine()&&this.data.pinned&&!n){this.el.removeAttribute("animation__pin-start"),this.el.removeAttribute("animation__pin-end");const e=this.el.object3D.scale;this.el.setAttribute("animation__pin-start",{property:"scale",dur:200,from:{x:e.x,y:e.y,z:e.z},to:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},easing:"easeOutElastic"}),this.el.setAttribute("animation__pin-end",{property:"scale",delay:200,dur:200,from:{x:1.1*e.x,y:1.1*e.y,z:1.1*e.z},to:{x:e.x,y:e.y,z:e.z},easing:"easeOutElastic"}),this.el.components["body-helper"]&&!this.el.sceneEl.systems.interaction.isHeld(this.el)&&this.el.setAttribute("body-helper",{type:"kinematic"})}},tick(){const e=this.el.sceneEl.systems.interaction.isHeld(this.el),t=this._isMine();let n=!1;!e&&this.wasHeld&&t&&(n=!0,this._persistAndAnimate()),this.wasHeld=e,this.transformObjectSystem=this.transformObjectSystem||AFRAME.scenes[0].systems["transform-selected-object"];const a=this.transformObjectSystem.transforming&&this.transformObjectSystem.target.el===this.el;!n&&!a&&this.wasTransforming&&t&&this._persistAndAnimate(),this.wasTransforming=a}})},1334:function(e,t,n){const a=n(209).COLLISION_LAYERS;AFRAME.registerComponent("drop-object-button",{init(){this.onClick=()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;this.targetEl.setAttribute("floaty-object",{modifyGravityOnRelease:!1}),this.targetEl.setAttribute("body-helper",{type:"dynamic",gravity:{x:0,y:-9.8,z:0},angularDamping:.01,linearDamping:.01,linearSleepingThreshold:1.6,angularSleepingThreshold:2.5,collisionFilterMask:a.DEFAULT_INTERACTABLE});const e=this.el.sceneEl.systems["hubs-systems"].physicsSystem;this.targetEl.components["body-helper"].uuid&&e.activateBody(this.targetEl.components["body-helper"].uuid),this.el.parentNode.removeChild(this.el)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}})},1335:function(e,t){AFRAME.registerComponent("visible-to-owner",{init(){this.onStateChange=e=>{this.el.setAttribute("visible",e.detail.newOwner===NAF.clientId)},NAF.utils.getNetworkedEntity(this.el).then(e=>{e.addEventListener("ownership-changed",this.onStateChange),this.el.setAttribute("visible",NAF.utils.isMine(e))})}})},1336:function(e,t){AFRAME.registerComponent("emit-state-change",{multiple:!0,schema:{state:{type:"string"},transform:{type:"string",oneof:["rising","falling"]},event:{type:"string"}},init(){this.stateadded=this.stateadded.bind(this),this.stateremoved=this.stateremoved.bind(this)},stateadded(e){e.detail===this.data.state&&this.el.emit(this.data.event)},stateremoved(e){e.detail===this.data.state&&this.el.emit(this.data.event)},update(){this.el.removeEventListener("stateadded",this.stateadded),this.el.removeEventListener("stateremoved",this.stateremoved),"rising"===this.data.transform&&this.el.addEventListener("stateadded",this.stateadded),"falling"===this.data.transform&&this.el.addEventListener("stateremoved",this.stateremoved)}})},1337:function(e,t){AFRAME.registerComponent("action-to-event",{multiple:!0,schema:{path:{type:"string"},event:{type:"string"},withPermission:{type:"string"}},init(){this.needsPermission=!!this.data.withPermission,this.updatePermissions=()=>{this.needsPermission&&window.APP.hubChannel&&(this.hasPermission=window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission))}},play(){this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions),this.updatePermissions()},pause(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updatePermissions)},tick(){if(this.needsPermission&&!this.hasPermission)return;AFRAME.scenes[0].systems.userinput.get(this.data.path)&&this.el.emit(this.data.event)}})},1338:function(e,t){AFRAME.registerComponent("action-to-remove",{multiple:!0,schema:{path:{type:"string"},requireOwnership:{type:"boolean",default:!0}},init(){NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e})},tick(){AFRAME.scenes[0].systems.userinput.get(this.data.path)&&(this.data.requireOwnership&&this.networkedEl&&!NAF.utils.isMine(this.networkedEl)||this.el.parentNode.removeChild(this.el))}})},1339:function(e,t){AFRAME.registerComponent("emit-scene-event-on-remove",{schema:{event:{default:null}},remove(){this.data.event&&this.el.sceneEl.emit(this.data.event,{el:this.el})}})},1340:function(e,t){AFRAME.registerComponent("follow-in-fov",{schema:{target:{type:"selector"},offset:{type:"vec3"},speed:{type:"number",default:.003},angle:{type:"number",default:45}},init(){this.targetPos=new THREE.Vector3,this.offset=new THREE.Vector3,this.offset.copy(this.data.offset),this.snappedRot=new THREE.Euler,this.snappedQ=new THREE.Quaternion,this.snappedXForm=new THREE.Matrix4,this.snappedXFormWorld=new THREE.Matrix4,this.tempVector=new THREE.Vector3},tick(e,t){if(!this.el.object3D.visible)return;if(!this.data.target)return;const n=this.el.object3D,a=this.data.target.object3D;let i=!1;const r=AFRAME.scenes[0].systems.interaction,o=r.state.rightRemote.hovered||r.state.leftRemote.hovered;if(o){let e=o;for(;e;){if(this.el===e){i=!0;break}e=e.parentNode}}if(i?this._hoveredFrames+=1:this._hoveredFrames=0,this._applyMaskedTargetRotation(-this.data.angle*THREE.Math.DEG2RAD,a.rotation.y,0,this.snappedXFormWorld),this.targetPos.copy(this.offset),this.targetPos.applyMatrix4(this.snappedXFormWorld),n.parent&&n.parent.worldToLocal(this.targetPos),this.started){const e=(this._hoveredFrames?this.data.speed*(1/(.2*(this._hoveredFrames+5))):this.data.speed)*t;n.position.set(n.position.x+(this.targetPos.x-n.position.x)*e,n.position.y+(this.targetPos.y-n.position.y)*e,n.position.z+(this.targetPos.z-n.position.z)*e)}else n.position.copy(this.targetPos),this.started=!0;this.snappedXFormWorld.decompose(this.tempVector,n.quaternion,this.tempVector),n.matrixNeedsUpdate=!0},reset(){this.started=!1},_applyMaskedTargetRotation(e,t,n,a){const i=this.data.target.object3D;this.snappedRot.set(e,t,n,i.rotation.order),this.snappedQ.setFromEuler(this.snappedRot),this.snappedXForm.compose(i.position,this.snappedQ,i.scale),a.multiplyMatrices(i.parent.matrixWorld,this.snappedXForm)}})},1341:function(e,t){function n(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}AFRAME.registerComponent("hover-menu",{multiple:!0,schema:{template:{type:"selector"},isFlat:{default:!0},dim:{default:!0},withPermission:{type:"string"}},init(){var e,t=this;return(e=function*(){t.onFrozenStateChange=t.onFrozenStateChange.bind(t),t.hovering=!1,yield t.getHoverMenu(),t.applyHoverState()},function(){var t=this,a=arguments;return new Promise((function(i,r){var o=e.apply(t,a);function s(e){n(o,i,r,s,l,"next",e)}function l(e){n(o,i,r,s,l,"throw",e)}s(void 0)}))})()},getHoverMenu(){return this.menuPromise?this.menuPromise:this.menuPromise=new Promise(e=>{const t=this.el.appendChild(document.importNode(this.data.template.content,!0).children[0]);setTimeout(()=>{this.menu=t;if(!("media-mirror-target"===this.el.parentEl.id))this.el.setAttribute("position-at-border",{target:".hover-container",isFlat:this.data.isFlat,animate:!1,scale:!1});else{const e=this.el.querySelector(".hover-container");e.object3D.position.z=.001,e.object3D.matrixNeedsUpdate=!0}e(this.menu)})})},onFrozenStateChange(e){"frozen"!==!e.detail&&this.applyHoverState()},applyHoverState(){if(!this.menu)return;const e=!this.data.withPermission||window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);this.menu.object3D.visible=e&&!this.el.sceneEl.is("frozen")&&this.hovering,this.data.dim&&this.el.object3DMap.mesh&&this.el.object3DMap.mesh.material&&this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible?.5:1)},play(){this.el.sceneEl.addEventListener("stateadded",this.onFrozenStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onFrozenStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onFrozenStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onFrozenStateChange)}})},1342:function(e,t){AFRAME.registerComponent("disable-frustum-culling",{init(){this.el.object3D.traverse(e=>e.frustumCulled=!1)}})},1343:function(e,t){AFRAME.registerComponent("track-pose",{schema:{path:{type:"string"}},play(){this.didRegister||(this.didRegister=!0,this.el.sceneEl.systems["hubs-systems"].cursorPoseTrackingSystem.register(this.el.object3D,this.data.path))},remove(){this.didRegister&&this.el.sceneEl.systems["hubs-systems"].cursorPoseTrackingSystem.unregister(this.el.object3D)}})},1344:function(e,t){AFRAME.registerComponent("replay",{init:function(){this.playhead=0,this.poseIndex=0},tick:function(e,t){let n=!1;for(;!n&&this.playhead>=this.poses[this.poseIndex].timestamp;)this.el.setAttribute("position",this.poses[this.poseIndex].position),this.el.setAttribute("rotation",this.poses[this.poseIndex].rotation),this.el.object3D.matrixNeedsUpdate=!0,this.poseIndex+=1,n=this.poseIndex===this.poses.length;this.playhead+=t,n&&(this.playhead=0,this.poseIndex=0)}})},1345:function(e,t){AFRAME.registerComponent("visibility-by-path",{schema:{path:{type:"string"}},tick(){const e=!!AFRAME.scenes[0].systems.userinput.get(this.data.path);this.el.object3D.visible!==e&&this.el.setAttribute("visible",e)}})},1346:function(e,t){AFRAME.registerComponent("periodic-full-syncs",{init(){this.lastSync=0},tick(){const e=performance.now();e-this.lastSync>=5e3&&this.el.components&&this.el.components.networked&&(this.lastSync=e,this.el.components.networked.syncAll(null,!0))}})},1347:function(e,t){AFRAME.registerComponent("inspect-button",{tick(){this.initializedInTick||(this.initializedInTick=!0,this.el.object3D.addEventListener("holdable-button-down",()=>{this.el.sceneEl.systems["hubs-systems"].cameraSystem.inspect(this.el,1.5)}),this.el.object3D.addEventListener("holdable-button-up",()=>{this.el.sceneEl.systems["hubs-systems"].cameraSystem.uninspect()}))}})},1348:function(e,t){AFRAME.registerComponent("inspect-pivot-child-selector",{schema:{selector:{type:"string"}}})},1349:function(e,t){AFRAME.registerComponent("optional-alternative-to-not-hide",{})},1350:function(e,t){AFRAME.registerComponent("avatar-inspect-collider",{play(){this.el.setObject3D("avatar-inspect-collider",new THREE.Mesh(new THREE.BoxGeometry(.3,.8,.3),new THREE.MeshBasicMaterial({depthWrite:!1,opacity:0,transparent:!0,color:131586,side:THREE.BackSide})))}})},1353:function(e,t,n){},139:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(4),l=n(21),c=n(83);function d(){const e=function(){var e,t,n;if(!Array.isArray(l.b))return;const a=null===(e=window.APP.store)||void 0===e||null===(t=e.state)||void 0===t||null===(n=t.preferences)||void 0===n?void 0:n.theme;return a?l.b.find(e=>e.id===a):Object(c.a)()}();return!(!e||!e.darkModeDefault)&&s.a.image("logo_dark")||s.a.image("logo")}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e){var t=e.title,n=e.titleId,i=h(e,["title","titleId"]);return a.createElement("svg",u({width:144,height:100,viewBox:"0 0 144 100",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M144 99.74H0V58.115h144v41.627zM41.88 87.245h-2.32V78.95c0-4.329-2.96-6.311-6.2-6.311-2.84 0-4.88 1.497-5.88 3.924-.88-2.67-3.28-3.924-5.88-3.924-2.52 0-4.4 1.173-5.48 3.115v-2.751H8.56v3.964h2.4v10.316h-2.4v3.964h10.96v-3.964h-3.44v-6.351c0-2.549 1-4.329 3.48-4.329 2.04 0 3.08 1.214 3.08 4.37v10.274h7.56v-3.964h-2.4v-6.351c0-2.549 1-4.329 3.48-4.329 2.04 0 3.08 1.214 3.08 4.37v10.234h7.52v-3.965zM53.801 72.64c-6.48 0-9.68 4.41-9.68 9.75 0 5.824 3.84 9.263 9.4 9.263 5.76 0 9.92-3.681 9.92-9.507 0-5.097-3.16-9.506-9.64-9.506zm-4.36 9.382c0 3.155 1.44 5.582 4.24 5.582 2.68 0 4.44-2.143 4.44-5.663 0-3.681-1.961-5.34-4.4-5.34-2.64 0-4.28 1.982-4.28 5.421zm30.156 2.43l4.08.404-1.12 6.392h-15.72l-.52-2.75 9.92-11.53h-5.64l-.8 2.832-3.72-.405.64-6.392h15.8l.4 2.751-10 11.53h5.84l.84-2.832zm13.283 6.797h-5.4v-6.553h5.4v6.553zm-5.4-11.692h5.4v-6.554h-5.4v6.554zm13.798 11.65l7.8-27.792h-5.08l-7.8 27.792h5.08zm18.282-27.792l-7.801 27.792h-5.08l7.8-27.792h5.081zm17.2 24.718c.24 0 .479-.04.76-.12l.12 2.79c-.961.527-2.12.85-3.24.85-2.401 0-3.72-1.416-3.96-3.64-1.04 1.86-2.88 3.64-5.801 3.64-2.6 0-5.559-1.416-5.559-5.219 0-4.49 4.279-5.542 8.4-5.542 1 0 2.04.04 2.96.162v-.607c0-1.86-.04-4.085-2.96-4.085-1.08 0-1.92.08-2.76.526l-.6 2.063-4.12-.445.64-4.208c3.16-1.294 4.76-1.658 7.72-1.658 3.88 0 7.16 2.022 7.16 6.19v7.888c0 1.051.4 1.415 1.24 1.415z",fill:i.color}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M126.48 87.891c-1.56 0-2.12-.93-2.12-2.104 0-1.982 1.6-2.508 3.44-2.508.84 0 1.76.122 2.6.243-.12 3.034-2.08 4.37-3.92 4.37z",fill:i.color}),a.createElement("path",{d:"M43.81 46.79H30.181V41.35h3.283V32.54c0-2.17-.383-3.721-1.149-4.657-.73-.935-1.788-1.402-3.174-1.402-1.606 0-2.864.505-3.776 1.515-.876 1.01-1.35 2.337-1.424 3.983v9.37h3.284v5.442H13.6v-5.442h3.284v-27.66h-3.284V8.191h10.343v17.168c1.642-2.918 4.288-4.376 7.936-4.376 2.335 0 4.36.71 6.075 2.132 1.715 1.42 2.572 3.628 2.572 6.62v11.614h3.284v5.442zm31.964 0H65.156v-3.87c-1.642 2.917-4.287 4.376-7.935 4.376-2.335 0-4.36-.711-6.075-2.132-1.715-1.422-2.572-3.629-2.572-6.62V26.93H45.29v-5.442h10.343v14.25c0 2.207.347 3.778 1.04 4.713.73.898 1.788 1.346 3.175 1.346 1.678 0 2.973-.56 3.885-1.683.949-1.122 1.423-2.562 1.423-4.32V26.93h-3.995v-5.442h11.055v19.86h3.558v5.443zm29.77-13.24c0 3.74-.967 6.976-2.901 9.706-1.897 2.73-4.706 4.096-8.428 4.096-3.758 0-6.403-1.459-7.936-4.377a34.365 34.365 0 01-.273 1.908 34.28 34.28 0 01-.274 1.908h-7.06c.255-1.31.475-2.619.657-3.928.182-1.309.274-2.6.274-3.87V13.688h-3.284V8.191h10.344v18.122c.656-1.46 1.641-2.712 2.955-3.76 1.35-1.047 3.138-1.57 5.363-1.57 3.102 0 5.637 1.103 7.608 3.31 1.97 2.207 2.955 5.292 2.955 9.257zm-7.334.617c0-2.431-.51-4.283-1.532-5.554-1.022-1.272-2.372-1.908-4.05-1.908-1.897 0-3.375.71-4.433 2.132-1.022 1.422-1.532 3.067-1.532 4.937v.617c0 2.058.492 3.797 1.477 5.218 1.022 1.384 2.463 2.076 4.324 2.076 1.605 0 2.955-.598 4.05-1.795 1.13-1.234 1.696-3.142 1.696-5.723zm32.278 4.881c0 2.805-1.095 4.9-3.284 6.284-2.152 1.346-4.962 2.02-8.427 2.02-1.789 0-3.595-.187-5.419-.561a21.349 21.349 0 01-5.144-1.908l.985-7.07 5.473.618v3.142c.656.224 1.35.374 2.079.449.73.037 1.278.056 1.643.056 1.349 0 2.517-.225 3.502-.673.985-.45 1.477-1.123 1.477-2.02 0-1.085-.748-1.795-2.243-2.132a102.972 102.972 0 00-5.2-1.01c-1.97-.337-3.703-1.029-5.199-2.076-1.496-1.047-2.244-2.824-2.244-5.33 0-3.104 1.168-5.18 3.503-6.227 2.372-1.085 4.816-1.627 7.334-1.627 3.284 0 6.366.766 9.248 2.3l.603 6.452-5.473.617-.438-3.535c-1.204-.41-2.499-.617-3.886-.617-.911 0-1.696.206-2.352.617-.622.375-.931.973-.931 1.796 0 1.085.711 1.814 2.134 2.188 1.459.337 3.137.673 5.035 1.01 1.934.336 3.613 1.028 5.035 2.076 1.46 1.01 2.189 2.73 2.189 5.161z",fill:i.color}))}p.defaultProps={color:"#000",title:"Hmc Logo"};var m=n(56);function f({className:e,forceConfigurableLogo:t}){return Object(m.a)()&&!t?i.a.createElement(p,{className:"hmc-logo"}):i.a.createElement("img",{className:e,alt:s.a.translation("app-name"),src:d()})}f.propTypes={className:o.a.string,forceConfigurableLogo:o.a.bool}},14:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return w}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(26),d=n.n(c),u=n(45),h=n.n(u),p=n(6);function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const g=Object(a.memo)(Object(a.forwardRef)((e,t)=>{let{as:n,sm:a,lg:r,xl:o,thin:s,thick:c,preset:u,className:p,children:g}=e,v=f(e,["as","sm","lg","xl","thin","thick","preset","className","children"]);const b=n,y="button"===b?{type:"button"}:{};return i.a.createElement(b,m({className:l()(d.a.button,h.a.button,d.a[u],{[d.a.sm]:a,[d.a.lg]:r,[d.a.xl]:o,[d.a.thin]:s,[d.a.thick]:c},p)},y,v,{ref:t}),g)}));function v(e){return i.a.createElement(g,m({preset:"accept"},e),i.a.createElement(p.a,{id:"button.next",defaultMessage:"Next"}))}function b(e){return i.a.createElement(g,m({preset:"cancel"},e),i.a.createElement(p.a,{id:"button.cancel",defaultMessage:"Cancel"}))}function y(e){return i.a.createElement(g,m({preset:"accept"},e),i.a.createElement(p.a,{id:"button.continue",defaultMessage:"Continue"}))}function E(e){return i.a.createElement(g,m({preset:"accept"},e),i.a.createElement(p.a,{id:"button.accept",defaultMessage:"Accept"}))}function w(e){return i.a.createElement(g,m({preset:"accept"},e),i.a.createElement(p.a,{id:"button.apply",defaultMessage:"Apply"}))}g.propTypes={as:o.a.elementType,preset:o.a.oneOf(["transparent","basic","primary","accept","cancel","accent1","accent2","accent3","accent4","accent5","accent6","landing","signin"]),className:o.a.string,children:o.a.node,sm:o.a.bool},g.defaultProps={as:"button",preset:"basic"}},140:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return A}));var a=n(13),i=n(11),r=n(2),o=n(116),s=n(12),l=n(167),c=n(24);const d=Object(s.b)("fov"),u=Object(s.a)("thirdPerson");function h(e){const t=function(e){let t=e;for(;t;){if(Object(l.a)(t,"inspectable"))return t.object3D;t=t.parentNode}return console.warn("could not find inspectable in hierarchy"),e.object3D}(e);return{inspectable:t,pivot:function(e){const t=e.components["inspect-pivot-child-selector"]&&e.components["inspect-pivot-child-selector"].data.selector;if(!t)return e.object3D;const n=e.querySelector(t);return n?n.object3D:(console.error("Failed to find pivot for selector: ".concat(t),e),e.object3D)}(t.el)}}const p=function(){const e=new THREE.Vector3;return function(t,n,a){t.decompose(n,a,e)}}(),m=(new THREE.Matrix4).identity(),f=function(){const e=new THREE.Quaternion,t=new THREE.Vector3,n=new THREE.Quaternion,a=new THREE.Vector3,r=new THREE.Quaternion,o=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Quaternion,u=new THREE.Vector3(1,1,1),h=new THREE.Matrix4,m=new THREE.Quaternion,f=new THREE.Quaternion;return function(g,v,b,y,E,w,_,S){g.updateMatrices(),p(g.matrixWorld,t,e),b.updateMatrices(),p(b.matrixWorld,a,n),v.getWorldQuaternion(r),m.setFromAxisAngle(o.set(0,1,0).applyQuaternion(e),.1*y*_),d.copy(n).premultiply(m),l.subVectors(a,t);const x=1-w*_,A=l.length()*x;A>.1&&A<100&&l.multiplyScalar(x),f.setFromAxisAngle(s.set(1,0,0).applyQuaternion(d),.1*E*_),d.premultiply(f),c.addVectors(t,l.applyQuaternion(m).applyQuaternion(f)).add(o.set(0,1,0).multiplyScalar(S*A).applyQuaternion(d)),h.compose(c,d,u),Object(i.d)(v,b,h)}}(),g=function(){const e=new THREE.Quaternion,t=new THREE.Vector3,n=new THREE.Quaternion,a=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3(.3,.3,.3),c=new THREE.Object3D;return function(d,u,h,f,g){c.parent||(AFRAME.scenes[0].object3D.add(c),c.applyMatrix4(m)),f.updateMatrices(),p(f.matrixWorld,t,e),p(u.matrixWorld,a,n),d.getWorldQuaternion(n);const v=Object(o.c)(h.el,h.el.getObject3D("mesh")||h,!0);v.min.x===1/0&&(v.min.subVectors(t,l),v.max.addVectors(t,l)),v.getCenter(s);const b=h.el.sceneEl.is("vr-mode"),y=Object(i.c)(h.el.sceneEl.camera.fov,h.el.sceneEl.camera.aspect,v,s,b)*g;c.position.addVectors(t,r.set(0,0,1).multiplyScalar(y).applyQuaternion(e)),c.quaternion.copy(e),c.matrixNeedsUpdate=!0,c.updateMatrices(),Object(i.d)(d,u,c.matrixWorld)}}(),v=0,b=3,y=4,E={[v]:1,1:2,2:v},w=function(e){e.isLight&&e.layers.enable(c.a.CAMERA_LAYER_INSPECT)},_=new THREE.Layers;_.set(c.a.CAMERA_LAYER_FIRST_PERSON_ONLY);const S=function(e){if(e.layers.test(_))return;const t=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem,n=t.batchingEnabled&&t.batchManager.batchForMesh.get(e);n?(n.layers.enable(c.a.CAMERA_LAYER_INSPECT),e.layers.enable(c.a.CAMERA_LAYER_BATCH_INSPECT)):e.layers.enable(c.a.CAMERA_LAYER_INSPECT)},x=function(e){if(e.layers.test(_))return;const t=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem,n=t.batchingEnabled&&t.batchManager.batchForMesh.get(e);n?(n.layers.disable(c.a.CAMERA_LAYER_INSPECT),e.layers.disable(c.a.CAMERA_LAYER_BATCH_INSPECT)):e.layers.disable(c.a.CAMERA_LAYER_INSPECT)};class A{constructor(e,t){this.tick=function(){const e=new THREE.Matrix4;let t;return function(n,a){this.viewingCamera.matrixNeedsUpdate=!0,this.viewingCamera.updateMatrix(),this.viewingCamera.updateMatrixWorld();const o=n.is("entered");t=t||document.getElementById("ui-root");if(!o&&t&&t.firstChild&&t.firstChild.classList.contains("isGhost")&&this.mode!==v&&this.mode!==b){this.mode=v;const e=new THREE.Vector3,t=new THREE.Quaternion,a=new THREE.Vector3;this.viewingRig.object3D.updateMatrices(),this.viewingRig.object3D.matrixWorld.decompose(e,t,a),e.setFromMatrixPosition(this.viewingCamera.matrixWorld),e.y=e.y-1.6,Object(i.n)(this.avatarRig.object3D,(new THREE.Matrix4).compose(e,t,a)),n.systems["hubs-systems"].characterController.fly=!0,this.avatarPOV.object3D.updateMatrices(),Object(i.n)(this.avatarPOV.object3D,this.viewingCamera.matrixWorld)}if(!this.enteredScene&&o&&(this.enteredScene=!0,this.mode=v),this.avatarPOVRotator=this.avatarPOVRotator||this.avatarPOV.components["pitch-yaw-rotator"],this.viewingCameraRotator=this.viewingCameraRotator||this.viewingCamera.el.components["pitch-yaw-rotator"],this.avatarPOVRotator.on=!0,this.viewingCameraRotator.on=!0,this.userinput=this.userinput||n.systems.userinput,this.interaction=this.interaction||n.systems.interaction,this.userinput.get(r.a.actions.startInspecting)&&this.mode!==b){const e=this.interaction.state.rightRemote.hovered||this.interaction.state.leftRemote.hovered;e&&this.inspect(e,1.5)}else this.mode===b&&this.userinput.get(r.a.actions.stopInspecting)&&(n.emit("uninspect"),this.uninspect());if(this.userinput.get(r.a.actions.nextCameraMode)&&this.nextMode(),this.ensureListenerIsParentedCorrectly(n),this.mode===v)this.viewingCameraRotator.on=!1,this.avatarRig.object3D.updateMatrices(),Object(i.n)(this.viewingRig.object3D,this.avatarRig.object3D.matrixWorld),n.is("vr-mode")?(this.viewingCamera.updateMatrices(),Object(i.n)(this.avatarPOV.object3D,this.viewingCamera.matrixWorld)):(this.avatarPOV.object3D.updateMatrices(),Object(i.n)(this.viewingCamera,this.avatarPOV.object3D.matrixWorld));else if(1===this.mode||2===this.mode)1===this.mode?e.makeTranslation(0,1,3):e.makeTranslation(0,2,8),this.avatarRig.object3D.updateMatrices(),this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(e),Object(i.n)(this.viewingRig.object3D,this.viewingRig.object3D.matrixWorld),this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.quaternion),this.avatarPOV.object3D.matrixNeedsUpdate=!0;else if(this.mode===b){this.avatarPOVRotator.on=!1,this.viewingCameraRotator.on=!1;const e=this.userinput.get(n.is("entered")?r.a.actions.cameraDelta:r.a.actions.lobbyCameraDelta);if(e){const t=(AFRAME.utils.device.isMobile()?-.6:1)*e[0]||0,n=(AFRAME.utils.device.isMobile()?-1.2:1)*e[1]||0;this.horizontalDelta=(this.horizontalDelta+t)/2,this.verticalDelta=(this.verticalDelta+n)/2}else(Math.abs(this.verticalDelta)>1e-4||Math.abs(this.horizontalDelta)>1e-4)&&(this.verticalDelta=.9*this.verticalDelta,this.horizontalDelta=.9*this.horizontalDelta);const t=.001*this.userinput.get(r.a.actions.inspectZoom);t?this.inspectZoom=t+5*this.inspectZoom/6:Math.abs(this.inspectZoom)>1e-4&&(this.inspectZoom=.9*this.inspectZoom);const o=this.userinput.get(r.a.actions.inspectPanY)||0;this.userinput.get(r.a.actions.resetInspectView)&&g(this.viewingRig.object3D,this.viewingCamera,this.inspectable,this.pivot,1),this.snapshot.audio&&Object(i.n)(this.snapshot.audio,this.audioSourceTargetTransform),(Math.abs(this.verticalDelta)>.001||Math.abs(this.horizontalDelta)>.001||Math.abs(this.inspectZoom)>.001||Math.abs(o)>1e-4)&&f(this.pivot,this.viewingRig.object3D,this.viewingCamera,this.horizontalDelta,this.verticalDelta,this.inspectZoom,a,o)}}}(),this.viewingCamera=e,this.lightsEnabled="true"===localStorage.getItem("show-background-while-inspecting"),this.verticalDelta=0,this.horizontalDelta=0,this.inspectZoom=0,this.mode=y,this.snapshot={audioTransform:new THREE.Matrix4,matrixWorld:new THREE.Matrix4},this.audioSourceTargetTransform=new THREE.Matrix4,d&&(this.viewingCamera.fov=d),this.viewingCamera.layers.enable(c.a.CAMERA_LAYER_VIDEO_TEXTURE_TARGET),this.viewingCamera.layers.enable(c.a.CAMERA_LAYER_FIRST_PERSON_ONLY);const n=t.xr,o=n.updateCamera;n.updateCamera=function(e){o(e);const t=n.getCamera();t.layers.mask=e.layers.mask,t.cameras.length&&(t.cameras[0].layers.set(c.a.CAMERA_LAYER_XR_LEFT_EYE),t.cameras[0].layers.mask|=e.layers.mask,t.cameras[1].layers.set(c.a.CAMERA_LAYER_XR_RIGHT_EYE),t.cameras[1].layers.mask|=e.layers.mask)},Object(a.b)().then(()=>{this.avatarPOV=document.getElementById("avatar-pov-node"),this.avatarRig=document.getElementById("avatar-rig"),this.viewingRig=document.getElementById("viewing-rig");const e=new THREE.Mesh(new THREE.BoxGeometry(100,100,100),new THREE.MeshBasicMaterial({color:131586,side:THREE.BackSide}));e.layers.set(c.a.CAMERA_LAYER_INSPECT),this.viewingRig.object3D.add(e)})}nextMode(){this.mode!==b?u&&this.mode!==y&&(this.mode=E[this.mode]||0):this.uninspect()}inspect(e,t,n=!0){const{inspectable:a,pivot:r}=h(e);if(this.verticalDelta=0,this.horizontalDelta=0,this.inspectZoom=0,this.mode===b)return;const o=AFRAME.scenes[0];o.object3D.traverse(w),o.classList.add("hand-cursor"),o.classList.remove("no-cursor"),this.snapshot.mode=this.mode,this.mode=b,this.inspectable=a,this.pivot=r;const s=o.is("vr-mode")?o.renderer.xr.getCamera():o.camera;this.snapshot.mask=s.layers.mask,this.lightsEnabled?(s.layers.disable(c.a.CAMERA_LAYER_FIRST_PERSON_ONLY),s.layers.enable(c.a.CAMERA_LAYER_THIRD_PERSON_ONLY)):this.hideEverythingButThisObject(a),this.viewingCamera.updateMatrices(),this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld),this.snapshot.audio=!(a.el&&Object(l.a)(a.el,"preventAudioBoost"))&&function(e){let t;return e.traverse(e=>{t||"Audio"!==e.type||(t=e)}),t}(a),this.snapshot.audio&&(this.snapshot.audio.updateMatrices(),this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld),o.audioListener.updateMatrices(),this.audioSourceTargetTransform.makeTranslation(0,0,-.25).premultiply(o.audioListener.matrixWorld),Object(i.n)(this.snapshot.audio,this.audioSourceTargetTransform)),this.ensureListenerIsParentedCorrectly(o),g(this.viewingRig.object3D,this.viewingCamera,this.inspectable,this.pivot,t||1),n&&o.emit("inspect-target-changed")}uninspect(e=!0){if(this.mode!==b)return;const t=AFRAME.scenes[0];t.is("entered")&&(t.classList.remove("hand-cursor"),t.classList.add("no-cursor")),this.showEverythingAsNormal(),this.inspectable=null,this.pivot=null,this.snapshot.audio&&(Object(i.n)(this.snapshot.audio,this.snapshot.audioTransform),this.snapshot.audio=null),this.mode=this.snapshot.mode,this.snapshot.mode===y&&Object(i.n)(this.viewingRig.object3D,this.snapshot.matrixWorld),this.snapshot.mode=null,this.tick(AFRAME.scenes[0]),e&&t.emit("inspect-target-changed")}toggleLights(){if(this.lightsEnabled=!this.lightsEnabled,localStorage.setItem("show-background-while-inspecting",this.lightsEnabled.toString()),this.mode===b&&this.inspectable)if(this.lightsEnabled){this.showEverythingAsNormal();const e=AFRAME.scenes[0],t=e.is("vr-mode")?e.renderer.xr.getCamera():e.camera;t.layers.disable(c.a.CAMERA_LAYER_FIRST_PERSON_ONLY),t.layers.enable(c.a.CAMERA_LAYER_THIRD_PERSON_ONLY)}else this.hideEverythingButThisObject(this.inspectable);AFRAME.scenes[0].emit("inspect-lights-changed")}ensureListenerIsParentedCorrectly(e){e.audioListener&&this.avatarPOV&&(this.mode===b&&e.audioListener.parent!==this.avatarPOV.object3D?this.avatarPOV.object3D.add(e.audioListener):this.mode!==v&&1!==this.mode&&2!==this.mode||e.audioListener.parent===this.viewingCamera||this.viewingCamera.add(e.audioListener))}hideEverythingButThisObject(e){this.notHiddenObject=e,e.traverse(S);const t=AFRAME.scenes[0];(t.is("vr-mode")?t.renderer.xr.getCamera():t.camera).layers.set(c.a.CAMERA_LAYER_INSPECT)}showEverythingAsNormal(){this.notHiddenObject&&(this.notHiddenObject.traverse(x),this.notHiddenObject=null);const e=AFRAME.scenes[0];(e.is("vr-mode")?e.renderer.xr.getCamera():e.camera).layers.mask=this.snapshot.mask}}},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(154),l=n(269),c=n(201);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const h=Object(a.memo)(Object(a.forwardRef)((e,t)=>{let{className:n,error:a,description:r,inputClassName:o,label:h,fullWidth:p}=e,m=u(e,["className","error","description","inputClassName","label","fullWidth"]);const f=Object(c.a)(),g=Object(c.a)();return i.a.createElement(s.a,{id:g,htmlFor:f,className:n,label:h,error:a,description:r,fullWidth:p},i.a.createElement(l.a,d({id:f,ref:t,className:o},m)))}));h.propTypes={className:o.a.string,label:o.a.node,error:o.a.node,description:o.a.node,labelClassName:o.a.string,inputClassName:o.a.string,fullWidth:o.a.bool}},153:function(e,t,n){"use strict";function a(){return new Promise(e=>{setTimeout(e,0)})}n.d(t,"a",(function(){return a}))},1531:function(e,t){AFRAME.registerSystem("frame-scheduler",{init(){this.registry=new Map,this.queues=[],this.frameIndex=0},schedule(e,t){this.registry.has(t)||(this.queues.push(t),this.registry.set(t,[])),this.registry.get(t).push(e)},unschedule(e){for(let t=0;t<this.queues.length;t++){const n=this.queues[t],a=this.registry.get(n),i=a.indexOf(e);i>=0&&a.splice(i,1)}},tick:function(){for(let e=0;e<this.queues.length;e++){const t=this.queues[e],n=this.registry.get(t);0!==n.length&&n[this.frameIndex%n.length]()}this.frameIndex++}})},1532:function(e,t){AFRAME.registerComponent("vr-mode-toggle-visibility",{schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.el.sceneEl.is("vr-mode");this.el.setAttribute("visible",e!==this.data.invert)}}),AFRAME.registerComponent("vr-mode-toggle-playing",{multiple:!0,schema:{invert:{type:"boolean",default:!1}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){const e=this.id,t=this.el.sceneEl.is("vr-mode");this.el.components[e][t!==this.data.invert?"play":"pause"]()}}),AFRAME.registerComponent("vr-mode-toggle-class",{multiple:!0,schema:{invert:{type:"boolean",default:!1},class:{type:"string",default:""}},init(){this.updateComponentState=this.updateComponentState.bind(this)},play(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState(){this.el.sceneEl.is("vr-mode")?this.el.classList.add(this.data.class):this.el.classList.remove(this.data.class)}})},1533:function(e,t){AFRAME.registerSystem("permissions",{onPermissionsUpdated(e){window.APP.hubChannel?window.APP.hubChannel.addEventListener("permissions_updated",e):window.addEventListener("hub_channel_ready",()=>window.APP.hubChannel.addEventListener("permissions_updated",e),{once:!0})},can:e=>!!window.APP.hubChannel.can(e),canOrWillIfCreator:e=>!!window.APP.hubChannel.canOrWillIfCreator(e),fetchPermissions:()=>window.APP.hubChannel.fetchPermissions()})},1534:function(e,t){AFRAME.registerSystem("exit-on-blur",{init(){this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onTimeout=this.onTimeout.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.isOculusBrowser=navigator.userAgent.match(/Oculus/),this.enteredVR=!1,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),this.el.addEventListener("enter-vr",this.onEnterVR),this.lastTimeoutCheck=0,this.exitTimeout=null},tick(e){this.isOculusBrowser&&this.enteredVR&&(0===this.lastTimeoutCheck||e-this.lastTimeoutCheck>=1e3)&&(this.lastTimeoutCheck=e,clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onEnterVR(){this.enteredVR=!0},onBlur(){this.el.isMobile&&(clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onFocus(){this.el.isMobile&&clearTimeout(this.exitTimeout)},onTimeout(){window.APP.store.state.preferences.disableIdleDetection||this.el.dispatchEvent(new CustomEvent("exit"))},remove(){clearTimeout(this.exitTimeout),window.removeEventListener("blur",this.onBlur)}})},1535:function(e,t){AFRAME.registerSystem("auto-pixel-ratio",{init(){this.enabled=window.devicePixelRatio>1&&/macintosh/i.test(navigator.userAgent),this.deltas=[],this.secondsSinceMeasurementStart=0,this.secondsSinceSceneVisible=0,this.maxPixelRatio=window.devicePixelRatio,this.pixelRatioToTimesDecreased={},this.disabledByPref=window.APP.store.state.preferences.disableAutoPixelRatio,this.onPreferenceChange=this.onPreferenceChange.bind(this),window.APP.store.addEventListener("statechanged",this.onPreferenceChange)},onPreferenceChange(){this.disabledByPref=window.APP.store.state.preferences.disableAutoPixelRatio},tick(e,t){if(this.enabled&&!this.disabledByPref&&1!==this.maxPixelRatio&&this.el.is("visible"))if(this.secondsSinceSceneVisible<30)this.secondsSinceSceneVisible+=t/1e3;else if("hidden"!==document.visibilityState&&(this.deltas.push(t),this.secondsSinceMeasurementStart+=t/1e3,this.secondsSinceMeasurementStart>5)){this.deltas.sort();const e=1e3/this.deltas[Math.floor(this.deltas.length/2)],t=this.el.renderer.getPixelRatio(),n=t>1&&e<30,a=t<this.maxPixelRatio&&e>48;if(n||a){const i=t+(1*a?1:-1);if(console.info("Hubs auto-pixel-ratio: Median FPS (".concat(e.toFixed(),") was ").concat(a?"above ".concat(48):"below ".concat(30),". ")+"Adjusting pixel ratio to ".concat(i,".")),this.el.renderer.setPixelRatio(i),n){const e=(this.pixelRatioToTimesDecreased[t]||0)+1;this.pixelRatioToTimesDecreased[t]=e,e>=3&&(console.info("Hubs auto-pixel-ratio: Attempts to maintain high frame rate with pixel ratio ".concat(t," failed ").concat(e," times and will not be attempted again. Lowering maximum pixel ratio to ").concat(i,".")),this.maxPixelRatio=i)}}this.deltas.length=0,this.secondsSinceMeasurementStart=0}}})},1536:function(e,t){AFRAME.registerSystem("listed-media",{init:function(){this.els=[]},register:function(e){this.els.push(e),this.el.emit("listed_media_changed")},unregister:function(e){this.els.splice(this.els.indexOf(e),1),this.el.emit("listed_media_changed")}}),AFRAME.registerComponent("listed-media",{init:function(){this.system.register(this.el)},remove:function(){this.system.unregister(this.el)}})},1537:function(e,t){AFRAME.registerComponent("owned-object-limiter",{schema:{counter:{type:"selector"}},init(){this.counter=this.data.counter.components["networked-counter"]},tick(){this._syncCounterRegistration();const e=this.el.sceneEl.systems.interaction.isHeld(this.el);!e&&this.wasHeld&&this.counter.timestamps.has(this.el)&&this.counter.timestamps.set(this.el,performance.now()),this.wasHeld=e},remove(){this.counter.deregister(this.el)},_syncCounterRegistration(){if(!this.el.components.networked)return;const e=this.el.components.pinnable&&this.el.components.pinnable.data.pinned;NAF.utils.isMine(this.el)&&!e?this.counter.register(this.el):this.counter.deregister(this.el)}})},1538:function(e,t){AFRAME.registerComponent("owned-object-cleanup-timeout",{schema:{ttl:{default:0}},init(){this.timeout=performance.now()+1e3*this.data.ttl},tick(){if(!this.el.components.networked||!NAF.utils.isMine(this.el))return;if(this.el.sceneEl.systems.interaction.isHeld(this.el))return void(this.timeout=performance.now()+1e3*this.data.ttl);!(this.el.components.pinnable&&this.el.components.pinnable.data.pinned)&&performance.now()>=this.timeout&&this.el.parentNode.removeChild(this.el)}})},1539:function(e,t,n){const a=n(209).COLLISION_LAYERS;AFRAME.registerComponent("set-unowned-body-kinematic",{init(){this.setBodyKinematic=this.setBodyKinematic.bind(this)},play(){this.el.addEventListener("ownership-lost",this.setBodyKinematic),this.didThisOnce||(this.didThisOnce=!0,this.el.components.networked&&NAF.utils.isMine(this.el)||this.setBodyKinematic())},pause(){this.el.removeEventListener("ownership-lost",this.setBodyKinematic)},setBodyKinematic(){this.el.setAttribute("body-helper",{type:"kinematic",collisionFilterMask:a.UNOWNED_INTERACTABLE}),this.el.components["floaty-object"]&&(this.el.components["floaty-object"].locked=!0)}})},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(203),d=n.n(c);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const p=Object(a.memo)(e=>{let{id:t,htmlFor:n,label:a,error:r,description:o,className:s,fullWidth:c,children:p}=e,m=h(e,["id","htmlFor","label","error","description","className","fullWidth","children"]);return i.a.createElement("div",u({className:l()(d.a.inputField,{[d.a.fullWidth]:c},s)},m),a&&i.a.createElement("label",{id:t,className:d.a.label,htmlFor:n},a),p,r?i.a.createElement("small",{className:d.a.error},r):o?i.a.createElement("small",{className:d.a.info},o):void 0)});p.propTypes={className:o.a.string,children:o.a.node,error:o.a.node,description:o.a.node,fullWidth:o.a.bool}},1540:function(e,t){AFRAME.registerComponent("networked-counter",{schema:{max:{default:3}},init(){this.timestamps=new Map,this.el.object3D.visible=!1},remove(){this.timestamps.clear()},count(){return this.timestamps.size},register(e){this.data.max<=0||this.timestamps.has(e)||(this.timestamps.set(e,performance.now()),this.timestamps.size>this.data.max&&this._destroyOldest())},deregister(e){this.timestamps.has(e)&&this.timestamps.delete(e)},_destroyOldest(){const e=this.el.sceneEl.systems.interaction;let t=null,n=Number.MAX_VALUE;this.timestamps.forEach((a,i)=>{a<n&&!e.isHeld(i)&&NAF.utils.isMine(i)&&(t=i,n=a)}),this._destroy(t)},_destroy(e){e.pause(),this.deregister(e),e.parentNode&&e.parentNode.removeChild(e)}})},1541:function(e,t){AFRAME.registerComponent("set-yxz-order",{init:function(){this.el.object3D.rotation.order="YXZ"}})},1543:function(e,t){AFRAME.registerComponent("drawing-manager",{schema:{penSpawner:{type:"selector"}},init(){this.el.object3D.visible=!1,this.drawingToPen=new Map,this.data.penSpawner.addEventListener("spawned-entity-created",()=>{this.drawingEl||this.createDrawing()})},createDrawing(){return this.createDrawingPromise||(this.createDrawingPromise=new Promise(e=>{this.drawingEl=document.createElement("a-entity"),this.drawingEl.setAttribute("networked","template: #interactable-drawing"),this.el.sceneEl.appendChild(this.drawingEl);const t=n=>{"networked-drawing"===n.detail.name&&(this.drawing=this.drawingEl.components["networked-drawing"],this.drawingEl.removeEventListener("componentinitialized",t),e())};this.drawingEl.addEventListener("componentinitialized",t)})),this.createDrawingPromise},destroyDrawing(e){this.drawing===e&&(this.drawingToPen.delete(this.drawing),this.drawing=null,this.drawingEl=null,this.createDrawingPromise=null,this.getDrawingPromise=null)},getDrawing(e){return this.getDrawingPromise||(this.getDrawingPromise=new Promise((t,n)=>{this.drawingEl?!this.drawing||this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)!==e?n():(this.drawingToPen.set(this.drawing,e),t(this.drawing)):this.createDrawing().then(()=>{this.drawingToPen.set(this.drawing,e),t(this.drawing)})})),this.getDrawingPromise},returnDrawing(e){this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)===e&&this.drawingToPen.delete(this.drawing)}})},155:function(e,t,n){e.exports=n.p+"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3"},158:function(e,t,n){"use strict";function a(e,t){window.APP.componentRegistry=window.APP.componentRegistry||{},window.APP.componentRegistry[t]=window.APP.componentRegistry[t]||[],window.APP.componentRegistry[t].push(e)}function i(e,t){window.APP.componentRegistry&&window.APP.componentRegistry[t]&&window.APP.componentRegistry[t].splice(window.APP.componentRegistry[t].indexOf(e),1)}function r(){if(!(window.APP&&window.APP.componentRegistry&&window.APP.hubChannel&&window.APP.hubChannel.presence))return null;const e=window.APP.componentRegistry["player-info"]||[],t=window.APP.hubChannel.presence.state;for(let n=0;n<e.length;n++){const a=e[n],i=t[a.playerSessionId];if(i&&i.metas[0]&&i.metas[0].streaming)return a}return null}function o(e){return(window.APP.componentRegistry["player-info"]||[]).find(t=>t.playerSessionId===e)}n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}))},16:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f}));var a=n(4),i=n(20);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s={"app-name":"App","editor-name":"Scene Editor","contact-email":"app@company.com","company-name":"Company","share-hashtag":"#app","app-description":"Gather share and collaborate together in a virtual, private and safe space","app-tagline":"Private social VR in your web browser"},l=new Map,c="en",d=s;function u(e){var t=function(e){var t=navigator.languages?o(navigator.languages):navigator.language?[navigator.language]:navigator.userLanguage?[navigator.userLanguage]:void 0;e&&"browser"!==e&&t.unshift(e);for(var n=0;n<t.length;n++){var a=t[n];if(i.a.hasOwnProperty(a))return a;i.b.hasOwnProperty(a)&&i.b.hasOwnProperty(a);var r=a.split("-")[0].toLowerCase();if(i.a.hasOwnProperty(r))return r;if(i.b.hasOwnProperty(r))return i.b[r]}return"en"}(e);"en"===t?(c=t,d=s,window.dispatchEvent(new CustomEvent("locale-updated"))):l.has(t)?(c=t,window.dispatchEvent(new CustomEvent("locale-updated"))):n(132)("./".concat(t,".json")).then((function(e){var n=e.default;c=t,d=n,window.dispatchEvent(new CustomEvent("locale-updated"))}))}var h=window.setInterval((function(){window.APP&&window.APP.store&&(window.clearInterval(h),u(window.APP.store.state.preferences.locale),window.APP.store.addEventListener("statechanged",(function(){u(window.APP.store.state.preferences.locale)})))}),100),p=function(){return c},m=function(e){return d[e]},f=function(){if(l.has(c))return l.get(c);if(a.a.APP_CONFIG&&a.a.APP_CONFIG.translations&&a.a.APP_CONFIG.translations[c]){var e=a.a.APP_CONFIG.translations[c];for(var t in e)e.hasOwnProperty(t)&&e[t]&&(d[t]=e[t])}var n=[];for(var i in d)d.hasOwnProperty(i)&&n.push([i,d[i]]);var o=n.map((function(e){var t=r(e,2);return[t[0],t[1].replace(/%([\w-.]+)%/i,(function(e,t){return d[t]}))]})).reduce((function(e,t){return e[t[0]]=t[1],e}),{});return l.set(c,o),o}},1609:function(e,t,n){"use strict";n.r(t),n.d(t,"remountUI",(function(){return VR})),n.d(t,"getSceneUrlForHub",(function(){return BR})),n.d(t,"updateEnvironmentForHub",(function(){return zR})),n.d(t,"updateUIForHub",(function(){return qR}));var a=n(4);function i({presence:e}){const t=Object.getOwnPropertyNames(e.state).length;document.querySelector("#hud-presence-count").setAttribute("text","value",t.toString())}n(865);var r=n(90),o=(n(866),n(95),n(304),n(1052),n(211)),s=n.n(o),l=n(367),c=n.n(l),d=n(43),u=n(78);AFRAME.utils.device.isMobile=u.a;n(376);var h=n(319),p=(n(1076),n(1610),n(93)),m=n(8),f=n(87);function g(e,t=!0){return(n,a,i)=>{const r={dataType:a,data:i};n&&(r.clientId=n);const o="open"===e.socket.connectionState();if(o||t){if("um"===r.dataType?r.data.d.find(e=>e.isFirstSync):r.data.isFirstSync)o?e.push("naf",r):e.push("naf",AFRAME.utils.clone(r));else{const t=AFRAME.utils.clone(r);if("um"===t.dataType)for(let e=0;e<t.data.d.length;e++)delete t.data.d[e].isFirstSync;else delete t.data.isFirstSync;e.push("nafr",{naf:JSON.stringify(t)})}}}}var v=n(113);function b(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){b(r,a,i,o,s,"next",e)}function s(e){b(r,a,i,o,s,"throw",e)}o(void 0)}))}}const E=function(){var e=y((function*(){const e=Date.now(),t=new Date((yield fetch(document.location.href,{method:"HEAD",cache:"no-cache"})).headers.get("Date")).getTime()+500,n=Date.now();return t+(n-e)/2-n}));return function(){return e.apply(this,arguments)}}(),w=(()=>{let e=0;const t=[];let n=0;const a=function(){var i=y((function*(){t[n%10]=yield E(),n+=1,e=t.reduce((e,t)=>e+t,0)/t.length,10==t.length?setTimeout(a,3e5):a()}));return function(){return i.apply(this,arguments)}}();return a(),()=>e})();NAF.adapters.register("phoenix",class{constructor(){this.handleIncomingNAF=e=>{const t=Object(v.b)(e);t.dataType&&(t.source="phx-reliable",this.frozen?this.storeMessage(t):this.nafMessageReceived(null,t.dataType,t.data,t.source))},this.handleIncomingNAFR=({from_session_id:e,naf:t})=>{const n=JSON.parse(t);n.from_session_id=e,this.handleIncomingNAF(n)},this.refs=new Map,this.frozenUpdates=new Map,this._blockedClients=new Map}setServerUrl(){}setApp(){}setRoom(){}setWebRtcOptions(){}setServerConnectListeners(e,t){this.nafConnectSuccess=e,this.nafConnectFailed=t}setRoomOccupantListener(){}setDataChannelListeners(e,t,n){this.nafOccupantJoined=e,this.nafOccupantLeave=t,this.nafMessageReceived=n}connect(){var e=this;return y((function*(){e.refs.set("naf",e.hubChannel.channel.on("naf",e.handleIncomingNAF)),e.refs.set("nafr",e.hubChannel.channel.on("nafr",e.handleIncomingNAFR)),e.nafConnectSuccess(e.session_id),e.reliableTransport=g(e.hubChannel.channel,!0),e.unreliableTransport=g(e.hubChannel.channel,!1),e.hubChannel.presence.list(e=>e).forEach(e.nafOccupantJoined),e.refs.set("hub:join",e.events.on("hub:join",({key:t})=>e.nafOccupantJoined(t))),e.refs.set("hub:leave",e.events.on("hub:leave",({key:t})=>e.nafOccupantLeave(t)))}))()}shouldStartConnectionTo(){}startStreamConnection(){}closeStreamConnection(){}getConnectStatus(){}getMediaStream(){return Promise.reject("getMediaStream not implemented in phoenix-adapter")}getServerTime(){return Date.now()+w()}sendData(e,t,n){this.unreliableTransport(e,t,n)}sendDataGuaranteed(e,t,n){this.reliableTransport(e,t,n)}broadcastData(e,t){this.unreliableTransport(void 0,e,t)}broadcastDataGuaranteed(e,t){this.reliableTransport(void 0,e,t)}disconnect(){this.hubChannel.presence.list(e=>e).forEach(this.nafOccupantLeave),this.hubChannel.channel.off("naf",this.refs.get("naf")),this.hubChannel.channel.off("nafr",this.refs.get("nafr")),this.events.off("hub:join",this.refs.get("hub:join")),this.events.off("hub:leave",this.refs.get("hub:leave")),this.refs.delete("naf"),this.refs.delete("nafr"),this.refs.delete("hub:join"),this.refs.delete("hub:leave")}toggleFreeze(){this.frozen?this.unfreeze():this.freeze()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1,this.flushPendingUpdates()}flushPendingUpdates(){for(const[e,t]of this.frozenUpdates){const n=this.getPendingData(e,t);if(!n)continue;const a="um"===t.dataType?"u":t.dataType;this.nafMessageReceived(null,a,n,t.source)}this.frozenUpdates.clear()}getPendingData(e,t){if(!t)return null;const n="um"===t.dataType?this.dataForUpdateMultiMessage(e,t):t.data;return n.owner&&this._blockedClients.has(n.owner)?null:n}getPendingDataForNetworkId(e){return this.getPendingData(e,this.frozenUpdates.get(e))}storeMessage(e){if("um"===e.dataType)for(let t=0,n=e.data.d.length;t<n;t++)this.storeSingleMessage(e,t);else this.storeSingleMessage(e)}storeSingleMessage(e,t){const n=void 0!==t?e.data.d[t]:e.data,a=e.dataType,i=n.networkId;if(this.frozenUpdates.has(i)){const t=this.frozenUpdates.get(i),r="um"===t.dataType?this.dataForUpdateMultiMessage(i,t):t.data,o=n.lastOwnerTime<r.lastOwnerTime,s=n.lastOwnerTime===r.lastOwnerTime;if(o||s&&r.owner>n.owner)return;if("r"===a){r&&r.isFirstSync?this.frozenUpdates.delete(i):this.frozenUpdates.set(i,e)}else r.components&&n.components&&Object.assign(r.components,n.components)}else this.frozenUpdates.set(i,e)}dataForUpdateMultiMessage(e,t){for(let n=0,a=t.data.d.length;n<a;n++){const a=t.data.d[n];if(a.networkId===e)return a}return null}block(e){this._blockedClients.set(e,!0)}unblock(e){this._blockedClients.delete(e)}});var _=n(153),S=n(320),x=n(54),A=n.n(x),M=n(599),k=n(600),O=n.n(k),C=n(259),P=n(470),R=n.n(P),T=n(7);function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){D(e,t,n[t])}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function L(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){I(r,a,i,o,s,"next",e)}function s(e){I(r,a,i,o,s,"throw",e)}o(void 0)}))}}const H=Object(C.debug)("naf-dialog-adapter:debug"),N=Object(C.debug)("naf-dialog-adapter:error"),F=Object(C.debug)("naf-dialog-adapter:info"),V={optional:[{googDscp:!0}]},B=[{scaleResolutionDownBy:4,maxBitrate:5e5},{scaleResolutionDownBy:2,maxBitrate:1e6},{scaleResolutionDownBy:1,maxBitrate:5e6}],U=[{dtx:!0,maxBitrate:15e5},{dtx:!0,maxBitrate:6e6}];class z extends R.a{constructor(){super(),this._micShouldBeEnabled=!1,this._micProducer=null,this._cameraProducer=null,this._shareProducer=null,this._localMediaStream=null,this._consumers=new Map,this._pendingMediaRequests=new Map,this._blockedClients=new Map,this._forceTcp=!1,this._forceTurn=!1,this._iceTransportPolicy=null,this.scene=null,this._serverParams={},this._consumerStats={}}get consumerStats(){return this._consumerStats}get downlinkBwe(){return this._downlinkBwe}getIceServers(e,t,n){const a=[];return this._serverUrl="wss://".concat(e,":").concat(t),n&&n.enabled?(n.transports.forEach(t=>{this._forceTcp||a.push({urls:"turns:".concat(e,":").concat(t.port),username:n.username,credential:n.credential}),a.push({urls:"turns:".concat(e,":").concat(t.port,"?transport=tcp"),username:n.username,credential:n.credential})}),a.push({urls:"stun:stun1.l.google.com:19302"})):a.push({urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}),a}getServerStats(){var e=this;return L((function*(){if(!e._protoo.connected)return;const t={};try{var n,a;if(!(null===(n=e._sendTransport)||void 0===n?void 0:n._closed)){const n=t[e._sendTransport.id]={};n.name="Send",n.stats=yield e._protoo.request("getTransportStats",{transportId:e._sendTransport.id}),t[e._sendTransport.id].producers={};for(const n of e._sendTransport._producers){const a=n[0];t[e._sendTransport.id].producers[a]=yield e._protoo.request("getProducerStats",{producerId:a})}}if(!(null===(a=e._recvTransport)||void 0===a?void 0:a._closed)){const n=t[e._recvTransport.id]={};n.name="Receive",n.stats=yield e._protoo.request("getTransportStats",{transportId:e._recvTransport.id}),t[e._recvTransport.id].consumers={};for(const n of e._recvTransport._consumers){const a=n[0];t[e._recvTransport.id].consumers[a]=yield e._protoo.request("getConsumerStats",{consumerId:a})}}return t}catch(t){return e.emitRTCEvent("error","Adapter",()=>"Error getting the server status: ".concat(t)),{error:"Error getting the server status: ".concat(t)}}}))()}iceRestart(e){var t=this;return L((function*(){t.emitRTCEvent("log","RTC",()=>"Restarting ".concat(e.id===t._sendTransport.id?"send":"receive"," transport ICE"));const n=yield t._protoo.request("restartIce",{transportId:e.id});yield e.restartIce({iceParameters:n})}))()}recreateSendTransport(e){var t=this;return L((function*(){t.emitRTCEvent("log","RTC",()=>"Recreating send transport ICE"),yield t.closeSendTransport(),yield t.createSendTransport(e)}))()}restartSendICE(){var e=this;return L((function*(){if(e._protoo&&e._protoo.connected)try{var t;if(null===(t=e._sendTransport)||void 0===t?void 0:t._closed){const{host:t,port:n,turn:a}=e._serverParams,i=e.getIceServers(t,n,a);yield e.recreateSendTransport(i)}else yield e.iceRestart(e._sendTransport)}catch(t){e.emitRTCEvent("error","RTC",()=>"Send transport [recreate] failed: ".concat(t))}}))()}checkSendIceStatus(e){"failed"===e&&this.restartSendICE()}recreateRecvTransport(e){var t=this;return L((function*(){t.emitRTCEvent("log","RTC",()=>"Recreating receive transport ICE"),yield t.closeRecvTransport(),yield t.createRecvTransport(e),yield t._protoo.request("refreshConsumers")}))()}restartRecvICE(){var e=this;return L((function*(){if(e._protoo&&e._protoo.connected)try{var t;if(null===(t=e._recvTransport)||void 0===t?void 0:t._closed){const{host:t,port:n,turn:a}=e._serverParams,i=e.getIceServers(t,n,a);yield e.recreateRecvTransport(i)}else yield e.iceRestart(e._recvTransport)}catch(t){e.emitRTCEvent("error","RTC",()=>"Receive transport [recreate] failed: ".concat(t))}}))()}checkRecvIceStatus(e){"failed"===e&&this.restartRecvICE()}connect({serverUrl:e,roomId:t,joinToken:n,serverParams:a,scene:i,clientId:r,forceTcp:o,forceTurn:s,iceTransportPolicy:l}){var c=this;return L((function*(){c._serverUrl=e,c._roomId=t,c._joinToken=n,c._serverParams=a,c._clientId=r,c.scene=i,c._forceTcp=o,c._forceTurn=s,c._iceTransportPolicy=l;const d=new URL(c._serverUrl);d.searchParams.append("roomId",c._roomId),d.searchParams.append("peerId",c._clientId);const u=new O.a.WebSocketTransport(d.toString(),{retry:{retries:2}});return c._protoo=new O.a.Peer(u),c._protoo.on("disconnected",()=>{c.emitRTCEvent("info","Signaling",()=>"Disconnected"),c.cleanUpLocalState()}),c._protoo.on("failed",e=>{c.emitRTCEvent("error","Signaling",()=>"Failed: ".concat(e,", retrying..."))}),c._protoo.on("close",L((function*(){c.emitRTCEvent("error","Signaling",()=>"Closed"),c._retryConnectWithNewHost()}))),c._protoo.on("request",function(){var e=L((function*(e,t,n){var a;switch(c.emitRTCEvent("info","Signaling",()=>{var t;return"Request [".concat(e.method,"]: ").concat(null===(t=e.data)||void 0===t?void 0:t.id)}),H('proto "request" event [method:%s, data:%o]',e.method,null===(a=e.data)||void 0===a?void 0:a.id),e.method){case"newConsumer":{const{peerId:n,producerId:a,id:i,kind:r,rtpParameters:o,appData:s}=e.data;try{const e=yield c._recvTransport.consume({id:i,producerId:a,kind:r,rtpParameters:o,appData:j({},s,{peerId:n})});if(c._consumers.set(e.id,e),e.on("transportclose",()=>{c.emitRTCEvent("error","RTC",()=>"Consumer transport closed"),c.removeConsumer(e.id)}),"video"===r){const{spatialLayers:t,temporalLayers:n}=M.parseScalabilityMode(e.rtpParameters.encodings[0].scalabilityMode);c._consumerStats[e.id]=c._consumerStats[e.id]||{},c._consumerStats[e.id].spatialLayers=t,c._consumerStats[e.id].temporalLayers=n}t(),c.resolvePendingMediaRequestForTrack(n,e.track),c.emit("stream_updated",n,r)}catch(e){throw c.emitRTCEvent("error","Adapter",()=>"Error: ".concat(e)),N('"newConsumer" request failed:%o',e),e}break}}}));return function(t,n,a){return e.apply(this,arguments)}}()),c._protoo.on("notification",e=>{switch(H('proto "notification" event [method:%s, data:%o]',e.method,e.data),e.method){case"newPeer":break;case"peerClosed":{const{peerId:t}=e.data;c.closePeer(t);break}case"consumerClosed":{const{consumerId:t}=e.data,n=c._consumers.get(t);if(!n){F("consumerClosed event received without related consumer: ".concat(t));break}n.close(),c.removeConsumer(n.id);break}case"peerBlocked":{const{peerId:t}=e.data;document.body.dispatchEvent(new CustomEvent("blocked",{detail:{clientId:t}}));break}case"peerUnblocked":{const{peerId:t}=e.data;document.body.dispatchEvent(new CustomEvent("unblocked",{detail:{clientId:t}}));break}case"downlinkBwe":c._downlinkBwe=e.data;break;case"consumerLayersChanged":{const{consumerId:t,spatialLayer:n,temporalLayer:a}=e.data;if(!c._consumers.get(t)){F("consumerLayersChanged event received without related consumer: ".concat(t));break}c._consumerStats[t]=c._consumerStats[t]||{},c._consumerStats[t].spatialLayer=n,c._consumerStats[t].temporalLayer=a;break}case"consumerScore":{const{consumerId:t,score:n}=e.data;if(!c._consumers.get(t)){F("consumerScore event received without related consumer: ".concat(t));break}c._consumerStats[t]=c._consumerStats[t]||{},c._consumerStats[t].score=n}}}),new Promise((e,t)=>{c._protoo.on("open",L((function*(){c.emitRTCEvent("info","Signaling",()=>"Open");try{yield c._joinRoom(),e(),c.emit("dialog-connection-connected")}catch(e){c.emitRTCEvent("warn","Adapter",()=>"Error during connect: ".concat(N)),t(e),c.emit("dialog-connection-error-fatal")}})))})}))()}_retryConnectWithNewHost(){var e=this;return L((function*(){e.cleanUpLocalState(),e._protoo.removeAllListeners();const t=yield APP.hubChannel.getHost(),{host:n,port:a}=t,i="wss://".concat(n,":").concat(a);if(e._serverUrl===i)return console.error("Reconnect to dialog failed."),void e.emit("dialog-connection-error-fatal");console.log("The Dialog server has changed to ".concat(i,", reconnecting with the new server...")),yield e.connect({serverUrl:i,roomId:e._roomId,joinToken:APP.hubChannel.token,serverParams:t,scene:e.scene,clientId:e._clientId,forceTcp:e._forceTcp,forceTurn:e._forceTurn,iceTransportPolicy:e._iceTransportPolicy})}))()}closePeer(e){const t=this._pendingMediaRequests.get(e);if(t){F("The user disconnected before the media stream was resolved."),t.audio&&t.audio.resolve(null),t.video&&t.video.resolve(null),this._pendingMediaRequests.delete(e)}}resolvePendingMediaRequestForTrack(e,t){const n=this._pendingMediaRequests.get(e);if(n&&n[t.kind]){const e=n[t.kind].resolve;delete n[t.kind],e(new MediaStream([t]))}n&&0===Object.keys(n).length&&this._pendingMediaRequests.delete(e)}removeConsumer(e){this.emitRTCEvent("info","RTC",()=>"Consumer removed: ".concat(e)),this._consumers.delete(e)}getMediaStream(e,t="audio"){let n;if(this._clientId===e?"audio"===t&&this._micProducer?n=this._micProducer.track:"video"===t&&(this._cameraProducer&&!this._cameraProducer.closed?n=this._cameraProducer.track:this._shareProducer&&!this._shareProducer.closed&&(n=this._shareProducer.track)):this._consumers.forEach(a=>{a.appData.peerId===e&&t==a.track.kind&&(n=a.track)}),n)return H("Already had ".concat(t," for ").concat(e)),Promise.resolve(new MediaStream([n]));{H("Waiting on ".concat(t," for ").concat(e)),this._pendingMediaRequests.has(e)||this._pendingMediaRequests.set(e,{});const n=this._pendingMediaRequests.get(e),a=new Promise((e,a)=>n[t]={resolve:e,reject:a});return n[t].promise=a,a.catch(t=>{this.emitRTCEvent("error","Adapter",()=>"getMediaStream error: ".concat(t)),console.warn("".concat(e," getMediaStream Error"),t)}),a}}createSendTransport(e){var t=this;return L((function*(){const n=yield t._protoo.request("createWebRtcTransport",{producing:!0,consuming:!1,sctpCapabilities:void 0});t._sendTransport=t._mediasoupDevice.createSendTransport({id:n.id,iceParameters:n.iceParameters,iceCandidates:n.iceCandidates,dtlsParameters:n.dtlsParameters,sctpParameters:n.sctpParameters,iceServers:e,iceTransportPolicy:t._iceTransportPolicy,proprietaryConstraints:V}),t._sendTransport.on("connect",({dtlsParameters:e},n,a)=>{t.emitRTCEvent("info","RTC",()=>"Send transport [connect]"),t._sendTransport.observer.on("close",()=>{t.emitRTCEvent("info","RTC",()=>"Send transport [close]")}),t._sendTransport.observer.on("newproducer",e=>{t.emitRTCEvent("info","RTC",()=>"Send transport [newproducer]: ".concat(e.id))}),t._sendTransport.observer.on("newconsumer",e=>{t.emitRTCEvent("info","RTC",()=>"Send transport [newconsumer]: ".concat(e.id))}),t._protoo.request("connectWebRtcTransport",{transportId:t._sendTransport.id,dtlsParameters:e}).then(n).catch(a)}),t._sendTransport.on("connectionstatechange",e=>{let n="info";"failed"!==e&&"disconnected"!==e||(n="error"),t.emitRTCEvent(n,"RTC",()=>"Send transport [connectionstatechange]: ".concat(e)),t.checkSendIceStatus(e)}),t._sendTransport.on("produce",function(){var e=L((function*({kind:e,rtpParameters:n,appData:a},i,r){t.emitRTCEvent("info","RTC",()=>"Send transport [produce]: ".concat(e));try{const{id:r}=yield t._protoo.request("produce",{transportId:t._sendTransport.id,kind:e,rtpParameters:n,appData:a});i({id:r})}catch(e){t.emitRTCEvent("error","Signaling",()=>"[produce] error: ".concat(e)),r(e)}}));return function(t,n,a){return e.apply(this,arguments)}}())}))()}closeSendTransport(){var e=this;return L((function*(){var t,n,a,i,r,o;e._micProducer&&(e._micProducer.close(),(null===(a=e._protoo)||void 0===a?void 0:a.connected)&&(null===(i=e._protoo)||void 0===i||i.request("closeProducer",{producerId:e._micProducer.id})),e._micProducer=null);e._videoProducer&&(e._videoProducer.close(),(null===(r=e._protoo)||void 0===r?void 0:r.connected)&&(null===(o=e._protoo)||void 0===o||o.request("closeProducer",{producerId:e._videoProducer.id})),e._videoProducer=null);const s=null===(t=e._sendTransport)||void 0===t?void 0:t.id;if(e._sendTransport&&!e._sendTransport._closed&&(e._sendTransport.close(),e._sendTransport=null),null===(n=e._protoo)||void 0===n?void 0:n.connected)try{yield e._protoo.request("closeWebRtcTransport",{transportId:s})}catch(e){N(e)}}))()}createRecvTransport(e){var t=this;return L((function*(){const n=yield t._protoo.request("createWebRtcTransport",{producing:!1,consuming:!0,sctpCapabilities:void 0});t._recvTransport=t._mediasoupDevice.createRecvTransport({id:n.id,iceParameters:n.iceParameters,iceCandidates:n.iceCandidates,dtlsParameters:n.dtlsParameters,sctpParameters:n.sctpParameters,iceServers:e,iceTransportPolicy:t._iceTransportPolicy}),t._recvTransport.on("connect",({dtlsParameters:e},n,a)=>{t.emitRTCEvent("info","RTC",()=>"Receive transport [connect]"),t._recvTransport.observer.on("close",()=>{t.emitRTCEvent("info","RTC",()=>"Receive transport [close]")}),t._recvTransport.observer.on("newproducer",e=>{t.emitRTCEvent("info","RTC",()=>"Receive transport [newproducer]: ".concat(e.id))}),t._recvTransport.observer.on("newconsumer",e=>{t.emitRTCEvent("info","RTC",()=>"Receive transport [newconsumer]: ".concat(e.id))}),t._protoo.request("connectWebRtcTransport",{transportId:t._recvTransport.id,dtlsParameters:e}).then(n).catch(a)}),t._recvTransport.on("connectionstatechange",e=>{let n="info";"failed"!==e&&"disconnected"!==e||(n="error"),t.emitRTCEvent(n,"RTC",()=>"Receive transport [connectionstatechange]: ".concat(e)),t.checkRecvIceStatus(e)})}))()}closeRecvTransport(){var e=this;return L((function*(){var t,n;const a=null===(t=e._recvTransport)||void 0===t?void 0:t.id;if(e._recvTransport&&!e._recvTransport._closed&&(e._recvTransport.close(),e._recvTransport=null),null===(n=e._protoo)||void 0===n?void 0:n.connected)try{yield e._protoo.request("closeWebRtcTransport",{transportId:a})}catch(e){N(e)}}))()}_joinRoom(){var e=this;return L((function*(){H("_joinRoom()"),e._mediasoupDevice=new M.Device({});const t=yield e._protoo.request("getRouterRtpCapabilities");yield e._mediasoupDevice.load({routerRtpCapabilities:t});const{host:n,port:a,turn:i}=e._serverParams,r=e.getIceServers(n,a,i);yield e.createSendTransport(r),yield e.createRecvTransport(r),yield e._protoo.request("join",{displayName:e._clientId,device:e._device,rtpCapabilities:e._mediasoupDevice.rtpCapabilities,sctpCapabilities:e._useDataChannel?e._mediasoupDevice.sctpCapabilities:void 0,token:e._joinToken}),e._localMediaStream&&(yield e.setLocalMediaStream(e._localMediaStream))}))()}setLocalMediaStream(e){var t=this;return L((function*(){if(!t._sendTransport)return void console.error("Tried to setLocalMediaStream before a _sendTransport existed");t.emitRTCEvent("info","RTC",()=>"Creating missing producers");let n=!1,a=!1;yield Promise.all(e.getTracks().map(function(){var e=L((function*(e){"audio"===e.kind?(n=!0,t._micProducer?t._micProducer.track!==e&&(t._micProducer.track.stop(),t._micProducer.replaceTrack(e)):(t._micProducer=yield t._sendTransport.produce({track:e,pause:!t._micShouldBeEnabled,stopTracks:!1,codecOptions:{opusStereo:!1,opusDtx:!0},zeroRtpOnPause:!0,disableTrackOnPause:!0}),t._micProducer.on("transportclose",()=>{t.emitRTCEvent("info","RTC",()=>"Mic transport closed"),t._micProducer=null}),t.emit("mic-state-changed",{enabled:t.isMicEnabled}))):(a=!0,e._hubs_contentHint===T.a.SCREEN?(yield t.disableCamera(),yield t.enableShare(e)):e._hubs_contentHint===T.a.CAMERA&&(yield t.disableShare(),yield t.enableCamera(e))),t.resolvePendingMediaRequestForTrack(t._clientId,e)}));return function(t){return e.apply(this,arguments)}}())),!n&&t._micProducer&&(t._protoo.request("closeProducer",{producerId:t._micProducer.id}),t._micProducer.close(),t._micProducer=null),a||(t.disableCamera(),t.disableShare()),t._localMediaStream=e}))()}enableCamera(e){var t=this;return L((function*(){t._cameraProducer=yield t._sendTransport.produce({track:e,stopTracks:!1,codecOptions:{videoGoogleStartBitrate:1e3},encodings:B,zeroRtpOnPause:!0,disableTrackOnPause:!0}),t._cameraProducer.on("transportclose",()=>{t.emitRTCEvent("info","RTC",()=>"Camera transport closed"),t.disableCamera()}),t._cameraProducer.observer.on("trackended",()=>{t.emitRTCEvent("info","RTC",()=>"Camera track ended"),t.disableCamera()})}))()}disableCamera(){var e=this;return L((function*(){if(e._cameraProducer){e._cameraProducer.close();try{e._sendTransport.closed||(yield e._protoo.request("closeProducer",{producerId:e._cameraProducer.id}))}catch(e){console.error("disableCamera(): ".concat(e))}e._cameraProducer=null}}))()}enableShare(e){var t=this;return L((function*(){t._shareProducer=yield t._sendTransport.produce({track:e,stopTracks:!1,codecOptions:{videoGoogleStartBitrate:1e3},encodings:U,zeroRtpOnPause:!0,disableTrackOnPause:!0,appData:{share:!0}}),t._shareProducer.on("transportclose",()=>{t.emitRTCEvent("info","RTC",()=>"Desktop Share transport closed"),t.disableShare()}),t._shareProducer.observer.on("trackended",()=>{t.emitRTCEvent("info","RTC",()=>"Desktop Share transport track ended"),t.disableShare()})}))()}disableShare(){var e=this;return L((function*(){if(e._shareProducer){e._shareProducer.close();try{e._sendTransport.closed||(yield e._protoo.request("closeProducer",{producerId:e._shareProducer.id}))}catch(e){console.error("disableShare(): ".concat(e))}e._shareProducer=null}}))()}toggleMicrophone(){this.isMicEnabled?this.enableMicrophone(!1):this.enableMicrophone(!0)}enableMicrophone(e){this._micProducer?(e&&!this.isMicEnabled?(this._micProducer.resume(),this._protoo.request("resumeProducer",{producerId:this._micProducer.id})):!e&&this.isMicEnabled&&(this._micProducer.pause(),this._protoo.request("pauseProducer",{producerId:this._micProducer.id})),this._micShouldBeEnabled=e,this.emit("mic-state-changed",{enabled:this.isMicEnabled})):console.error("Tried to toggle mic but there's no producer.")}get isMicEnabled(){return this._micProducer&&!this._micProducer.paused}cleanUpLocalState(){this._sendTransport&&this._sendTransport.close(),this._sendTransport=null,this._recvTransport&&this._recvTransport.close(),this._recvTransport=null,this._micProducer=null,this._shareProducer=null,this._cameraProducer=null}disconnect(){H("disconnect()"),this.cleanUpLocalState(),this._protoo&&(this._protoo.removeAllListeners(),this._protoo.connected&&(this._protoo.close(),this.emitRTCEvent("info","Signaling",()=>"[close]")))}kick(e){return this._protoo.request("kick",{room_id:this.room,user_id:e,token:this._joinToken}).then(()=>{document.body.dispatchEvent(new CustomEvent("kicked",{detail:{clientId:e}}))})}block(e){return this._protoo.request("block",{whom:e}).then(()=>{this._blockedClients.set(e,!0),document.body.dispatchEvent(new CustomEvent("blocked",{detail:{clientId:e}}))})}unblock(e){return this._protoo.request("unblock",{whom:e}).then(()=>{this._blockedClients.delete(e),document.body.dispatchEvent(new CustomEvent("unblocked",{detail:{clientId:e}}))})}emitRTCEvent(e,t,n){if(!window.APP.store.state.preferences.showRtcDebugPanel)return;const a=(new Date).toLocaleTimeString("en-US",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"});this.scene.emit("rtc_event",{level:e,tag:t,time:a,msg:n()})}}function W(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){W(r,a,i,o,s,"next",e)}function s(e){W(r,a,i,o,s,"throw",e)}o(void 0)}))}}function G(){document.querySelectorAll("[pinnable]").forEach(e=>{e.components.pinnable.data.pinned&&e.parentNode.removeChild(e)}),document.querySelectorAll("#objects-scene .Room_Objects").forEach(e=>{e.children.length||e.parentNode.parentNode.removeChild(e.parentNode)})}function Y(e){const t=document.querySelector("#objects-scene"),n=Object(m.j)("/".concat(e,"/objects.gltf")),a=document.createElement("a-entity");a.setAttribute("gltf-model-plus",{src:n,useCache:!1,inflate:!0}),t.appendChild(a)}function K(e){return X.apply(this,arguments)}function X(){return(X=q((function*(e,t=!0){if(e===APP.hub.hub_id)return void console.log("Change hub called with the current hub id. This is a noop.");APP.hideHubPresenceEvents=!0;const n=AFRAME.scenes[0];let a;try{a=yield APP.hubChannel.migrateToHub(e)}catch(t){return console.warn("Failed to join hub ".concat(e,": ").concat(t.reason,"|").concat(t.message)),void APP.messageDispatch.log("joinFailed",{message:t.message})}const i=a.hubs[0];if(t&&window.history.pushState(null,null,Object(m.n)(e,{},i.slug)),APP.hub=i,qR(i,APP.hubChannel),n.emit("hub_updated",{hub:i}),APP.subscriptions.setSubscribed(a.subscriptions.web_push),VR({hubIsBound:a.hub_requires_oauth,initialIsFavorited:a.subscriptions.favorites}),NAF.entities.removeRemoteEntities(),yield NAF.connection.adapter.disconnect(),yield APP.dialog.disconnect(),G(),NAF.connection.connectedClients={},NAF.connection.activeDataChannels={},NAF.room=i.hub_id,document.querySelector("#environment-scene").childNodes[0].components["gltf-model-plus"].data.src!==(yield BR(i))){document.getElementById("viewing-camera").components.fader.fadeOut().then(()=>{n.emit("reset_scene"),zR(i,APP.entryManager)})}APP.retChannel.push("change_hub",{hub_id:i.hub_id}),yield Promise.all([APP.dialog.connect({serverUrl:"wss://".concat(i.host,":").concat(i.port),roomId:i.hub_id,joinToken:a.perms_token,serverParams:{host:i.host,port:i.port,turn:i.turn},scene:n,clientId:APP.dialog._clientId,forceTcp:APP.dialog._forceTcp,forceTurn:APP.dialog._forceTurn,iceTransportPolicy:APP.dialog._iceTransportPolicy}),NAF.connection.adapter.connect()]),Y(e),APP.hubChannel.sendEnteredEvent(),APP.messageDispatch.receive({type:"hub_changed",hubName:i.name,showLineBreak:!0})}))).apply(this,arguments)}window.changeHub=K,window.addEventListener("popstate",(function(){if(!APP.store.state.preferences.fastRoomSwitching)return;const e=new URLSearchParams(location.search).get("hub_id")||document.location.pathname.substring(1).split("/")[0];e!==APP.hub.hub_id&&K(e,!1)}));n(594);var Q=n(25);const J=function(e,t,n){if(e&&e.length)for(const a of e)t.length&&t.forEach(e=>{a.addEventListener(e,n)})},Z=function(e,t,n){if(e&&e.length)for(const a of e)t.length&&t.forEach(e=>{a.removeEventListener(e,n)})};AFRAME.registerComponent("mute-mic",{schema:{eventSrc:{type:"selectorAll"},toggleEvents:{type:"array"},muteEvents:{type:"array"},unmuteEvents:{type:"array"}},init:function(){this.onToggle=this.onToggle.bind(this),this.onMute=this.onMute.bind(this),this.onUnmute=this.onUnmute.bind(this)},play:function(){const{eventSrc:e,toggleEvents:t,muteEvents:n,unmuteEvents:a}=this.data;J(e,t,this.onToggle),J(e,n,this.onMute),J(e,a,this.onUnmute)},pause:function(){const{eventSrc:e,toggleEvents:t,muteEvents:n,unmuteEvents:a}=this.data;Z(e,t,this.onToggle),Z(e,n,this.onMute),Z(e,a,this.onUnmute)},onToggle:function(){APP.mediaDevicesManager.toggleMic(),this.el.sceneEl.is("entered")&&this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.w)},onMute:function(){APP.mediaDevicesManager.micEnabled=!1},onUnmute:function(){APP.mediaDevicesManager.micEnabled=!0}});n(1133);const $=[];class ee{tick(){for(let e=0;e<$.length;e++){const t=$[e],n=t.el.object3D,{visible:a,scale:i}=n,{updateWhileInvisible:r}=t.data;(a!==t.lastVisible||r)&&(!a||1===i.x&&1===i.y&&1===i.z?a||1e-8===i.x&&1e-8===i.y&&1e-8===i.z||(i.setScalar(1e-8),n.matrixNeedsUpdate=!0):(i.setScalar(1),n.matrixNeedsUpdate=!0),r&&n.matrixNeedsUpdate&&n.updateMatrixWorld(!0,!0)),t.lastVisible=a}}updateMatrices(){for(let e=0;e<$.length;e++){const t=$[e].el.object3D;t.matrixNeedsUpdate&&t.updateMatrixWorld()}}}AFRAME.registerComponent("bone-visibility",{schema:{updateWhileInvisible:{type:"boolean",default:!1}},play(){$.push(this)},pause(){$.splice($.indexOf(this),1)}});n(1134);AFRAME.registerComponent("in-world-hud",{init(){this.mic=this.el.querySelector(".mic"),this.spawn=this.el.querySelector(".spawn"),this.pen=this.el.querySelector(".penhud"),this.cameraBtn=this.el.querySelector(".camera-btn"),this.inviteBtn=this.el.querySelector(".invite-btn"),this.background=this.el.querySelector(".bg"),this.onMicStateChanged=()=>{this.mic.setAttribute("mic-button","active",APP.dialog.isMicEnabled)},APP.dialog.on("mic-state-changed",this.onMicStateChanged),this.updateButtonStates=()=>{this.mic.setAttribute("mic-button","active",APP.dialog.isMicEnabled),this.pen.setAttribute("icon-button","active",this.el.sceneEl.is("pen")),this.cameraBtn.setAttribute("icon-button","active",this.el.sceneEl.is("camera")),window.APP.hubChannel&&(this.spawn.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_and_move_media")),this.pen.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_drawing")),this.cameraBtn.setAttribute("icon-button","disabled",!window.APP.hubChannel.can("spawn_camera")))},this.onStateChange=e=>{"frozen"!==e.detail&&"pen"!==e.detail&&"camera"!==e.detail||this.updateButtonStates()},this.onMicClick=()=>{APP.mediaDevicesManager.toggleMic()},this.onSpawnClick=()=>{window.APP.hubChannel.can("spawn_and_move_media")&&this.el.emit("action_spawn")},this.onPenClick=e=>{window.APP.hubChannel.can("spawn_drawing")&&(this.el.emit("spawn_pen",{object3D:e.object3D}),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.q))},this.onCameraClick=()=>{window.APP.hubChannel.can("spawn_camera")&&this.el.emit("action_toggle_camera")},this.onInviteClick=()=>{this.el.emit("action_invite")},this.onHubUpdated=e=>{this.inviteBtn.object3D.visible="invite"!==e.detail.hub.entry_mode}},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates),this.el.sceneEl.addEventListener("hub_updated",this.onHubUpdated),this.updateButtonStates(),this.mic.object3D.addEventListener("interact",this.onMicClick),this.spawn.object3D.addEventListener("interact",this.onSpawnClick),this.pen.object3D.addEventListener("interact",this.onPenClick),this.cameraBtn.object3D.addEventListener("interact",this.onCameraClick),this.inviteBtn.object3D.addEventListener("interact",this.onInviteClick)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),window.APP.hubChannel.removeEventListener("permissions_updated",this.updateButtonStates),this.el.sceneEl.removeEventListener("hub_updated",this.onHubUpdated),this.mic.object3D.removeEventListener("interact",this.onMicClick),this.spawn.object3D.removeEventListener("interact",this.onSpawnClick),this.pen.object3D.removeEventListener("interact",this.onPenClick),this.cameraBtn.object3D.removeEventListener("interact",this.onCameraClick),this.inviteBtn.object3D.removeEventListener("interact",this.onInviteClick)}});var te=n(17),ne=n(763),ae=n.n(ne),ie=n(764),re=n.n(ie),oe=n(765),se=n.n(oe),le=n(766),ce=n.n(le),de=n(767),ue=n.n(de),he=n(768),pe=n.n(he),me=n(769),fe=n.n(me),ge=n(770),ve=n.n(ge),be=n(771),ye=n.n(be),Ee=n(772),we=n.n(Ee),_e=n(773),Se=n.n(_e),xe=n(774),Ae=n.n(xe),Me=n(775),ke=n.n(Me),Oe=n(776),Ce=n.n(Oe);function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Te=[{id:"smile",model:ve.a,particle:ae.a},{id:"laugh",model:ye.a,particle:re.a},{id:"clap",model:we.a,particle:se.a},{id:"heart",model:Se.a,particle:ce.a},{id:"wave",model:Ae.a,particle:ue.a},{id:"angry",model:ke.a,particle:pe.a},{id:"cry",model:Ce.a,particle:fe.a}].map(e=>{let{model:t,particle:n}=e;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Pe(e,t,n[t])}))}return e}({},Re(e,["model","particle"]),{model:new URL(t,window.location).href,particleEmitterConfig:{src:new URL(n,window.location).href,resolve:!1,particleCount:20,startSize:.01,endSize:.2,sizeRandomness:.05,lifetime:1,lifetimeRandomness:.2,ageRandomness:1,startVelocity:{x:0,y:1,z:0},endVelocity:{x:0,y:.25,z:0},startOpacity:1,middleOpacity:1,endOpacity:0}})});function je({model:e,particleEmitterConfig:t}){const{entity:n}=Object(te.c)(e,"#interactable-emoji");n.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-1.5}}),n.addEventListener("model-loaded",()=>{n.querySelector(".particle-emitter").setAttribute("particle-emitter",t),n.setAttribute("emoji",{particleEmitterConfig:t})})}AFRAME.registerComponent("emoji",{schema:{emitDecayTime:{default:1.5},emitFadeTime:{default:.5},emitEndTime:{default:0},particleEmitterConfig:{default:null,parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.data.emitEndTime=performance.now()+1e3*this.data.emitDecayTime,this.physicsSystem=this.el.sceneEl.systems["hubs-systems"].physicsSystem},play(){const e=this.el.components["media-loader"];-1!==Te.find(t=>t.model!==e.data.src)?(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(Q.p,this.el.object3D),this.particleEmitter=this.el.querySelector(".particle-emitter")):this.el.parentNode.removeChild(this.el)},update(){!this.particleConfig&&this.data.particleEmitterConfig&&(this.particleConfig=Object.assign({},this.data.particleEmitterConfig),this.originalParticleCount=this.particleConfig.particleCount)},tick(){const e=this.el.components.networked.initialized&&this.el.components.networked.isMine();if(this.particleConfig&&e){const e=performance.now();this.el.sceneEl.systems.interaction.isHeld(this.el)&&(this.data.emitEndTime=e+1e3*this.data.emitDecayTime);const t=1e3*this.data.emitFadeTime;if(e<this.data.emitEndTime&&this.particleConfig.startOpacity<1)this.particleConfig.particleCount=this.originalParticleCount,this.particleConfig.startOpacity=1,this.particleConfig.middleOpacity=1,this.particleEmitter.setAttribute("particle-emitter",this.particleConfig,!0);else if(e>=this.data.emitEndTime&&this.particleConfig.startOpacity>.001){const n=1-Math.min(e-this.data.emitEndTime,t)/t,a=n<.001&&this.particleConfig.particleCount>0?0:this.originalParticleCount;this.particleConfig.particleCount=a,this.particleConfig.startOpacity=n,this.particleConfig.middleOpacity=n,this.particleEmitter.setAttribute("particle-emitter",this.particleConfig,!0)}}}});var De=n(27);const Ie=n(209).COLLISION_LAYERS;function Le(e,t,n,a,i){const r=1&e?-1:1;i.y=0,t%2==0?(i.x=(a/2+n/2+Math.floor(e/2)*(n+a))*r,i.z=Math.floor(e/2)*n/2):0!==e&&(i.x=(n+a)*Math.floor((e+1)/2)*-r,i.z=Math.floor((e+1)/2)*n/2)}AFRAME.registerComponent("emoji-hud",{schema:{spawnerScale:{default:.1},spawnedScale:{default:.5},camera:{type:"selector",default:"#avatar-pov-node"},hudAngle:{default:-.5},minHudAngle:{default:-.2},maxHudAngle:{default:.7},hudDistance:{default:.4},spawnerPlatformWidth:{default:.0625},spawnerPlatformSpacing:{default:.021}},init:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(){this._onFrozen=this._onFrozen.bind(this),this._onThaw=this._onThaw.bind(this);const n=this.data.spawnerPlatformWidth,a=this.data.spawnerPlatformSpacing;this.spawnerEntities=[];for(let i=0;i<Te.length;i++){const r=document.createElement("a-entity");r.setAttribute("media-loader",{src:Te[i].model}),r.setAttribute("hoverable-visuals",""),r.setAttribute("scale",{x:this.data.spawnerScale,y:this.data.spawnerScale,z:this.data.spawnerScale}),r.setAttribute("is-remote-hover-target",""),r.setAttribute("tags",{isHandCollisionTarget:!1}),r.setAttribute("visibility-while-frozen",{requireHoverOnNonMobile:!1,withPermission:"spawn_emoji"}),r.setAttribute("css-class","interactable"),r.setAttribute("body-helper",{mass:0,type:De.TYPE.STATIC,collisionFilterGroup:Ie.INTERACTABLES,collisionFilterMask:Ie.DEFAULT_SPAWNER}),r.addEventListener("spawned-entity-created",t=>{if(this.el.sceneEl.is("vr-mode"))return;const n=t.detail.target.object3D,a=this.data.camera.object3D;n.updateMatrices(),a.getWorldPosition(e),n.lookAt(e.x,n.position.y,e.z),n.matrixNeedsUpdate=!0}),r.addEventListener("spawned-entity-loaded",e=>{const t=Te[i].particleEmitterConfig;e.detail.target.querySelector(".particle-emitter").setAttribute("particle-emitter",t),e.detail.target.setAttribute("emoji",{particleEmitterConfig:t})}),r.setAttribute("super-spawner",{src:Te[i].model,template:"#interactable-emoji",spawnScale:{x:this.data.spawnedScale,y:this.data.spawnedScale,z:this.data.spawnedScale}}),Le(i,Te.length,n,a,t),r.object3D.position.copy(t),r.object3D.matrixNeedsUpdate=!0,this.el.appendChild(r),this.spawnerEntities.push(r)}}})(),play(){this.el.sceneEl.addEventListener("stateadded",this._onFrozen),this.el.sceneEl.addEventListener("stateremoved",this._onThaw),this._updateOffset()},pause(){this.el.sceneEl.removeEventListener("stateadded",this._onFrozen),this.el.sceneEl.removeEventListener("stateremoved",this._onThaw)},_onFrozen(e){if("frozen"===e.detail){this._updateOffset();for(let e=0;e<this.spawnerEntities.length;e++)this.spawnerEntities[e].components.tags.data.isHandCollisionTarget=!0}},_onThaw(e){if("frozen"===e.detail)for(let e=0;e<this.spawnerEntities.length;e++)this.spawnerEntities[e].components.tags.data.isHandCollisionTarget=!1},_updateOffset:function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3(1,0,0);return function(){const r=this.el.object3D,o=this.data.camera.object3D;o.updateMatrices(),t.set(0,0,-1),t.transformDirection(o.matrixWorld),n.set(0,0,-1),n.transformDirection(o.matrixWorld),n.projectOnPlane(THREE.Object3D.DefaultUp).normalize();const s=Math.sign(THREE.Object3D.DefaultUp.dot(t))*n.angleTo(t),l=s-Math.max(this.data.minHudAngle,Math.min(this.data.maxHudAngle,s));a.set(0,0,-1),a.applyAxisAngle(i,this.data.hudAngle-l),a.multiplyScalar(this.data.hudDistance),o.localToWorld(a),r.parent.worldToLocal(a),r.position.copy(a),r.updateMatrices(!0),o.getWorldPosition(e),r.lookAt(e),r.matrixNeedsUpdate=!0}}()});var He=n(601),Ne=n.n(He),Fe=n(99),Ve=n.n(Fe);function Be(e,t){t.parentNode.insertBefore(e,t.nextSibling)}AFRAME.registerComponent("virtual-gamepad-controls",{schema:{},init(){this.characterController=this.el.sceneEl.systems["hubs-systems"].characterController,this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this),this.onFirstInteraction=this.onFirstInteraction.bind(this),this.onMoveJoystickChanged=this.onMoveJoystickChanged.bind(this),this.onMoveJoystickEnd=this.onMoveJoystickEnd.bind(this),this.onLookJoystickChanged=this.onLookJoystickChanged.bind(this),this.onLookJoystickEnd=this.onLookJoystickEnd.bind(this),this.mockJoystickContainer=document.createElement("div"),this.mockJoystickContainer.classList.add(Ve.a.mockJoystickContainer),this.leftMock=document.createElement("div"),this.leftMock.classList.add(Ve.a.mockJoystick),this.leftMockSmall=document.createElement("div"),this.leftMockSmall.classList.add(Ve.a.mockJoystick,Ve.a.inner),this.leftMock.appendChild(this.leftMockSmall),this.mockJoystickContainer.appendChild(this.leftMock),this.rightMock=document.createElement("div"),this.rightMock.classList.add(Ve.a.mockJoystick),this.rightMockSmall=document.createElement("div"),this.rightMockSmall.classList.add(Ve.a.mockJoystick,Ve.a.inner),this.rightMock.appendChild(this.rightMockSmall),this.mockJoystickContainer.appendChild(this.rightMock),this.enableLeft=window.APP.store.state.preferences.enableOnScreenJoystickLeft,this.enableRight=window.APP.store.state.preferences.enableOnScreenJoystickRight,(this.enableLeft||this.enableRight)&&Be(this.mockJoystickContainer,this.el.sceneEl.canvas),this.enableLeft?this.createLeftStick():(this.leftMock.classList.add(Ve.a.hidden),this.leftMockSmall.classList.add(Ve.a.hidden)),this.enableRight?this.createRightStick():(this.rightMock.classList.add(Ve.a.hidden),this.rightMockSmall.classList.add(Ve.a.hidden)),this.onPreferenceChange=this.onPreferenceChange.bind(this),window.APP.store.addEventListener("statechanged",this.onPreferenceChange),this.inVr=!1,this.moving=!1,this.rotating=!1,this.displacement=new THREE.Vector3,this.lookDy=0,this.lookDx=0,this.el.sceneEl.addEventListener("enter-vr",this.onEnterVr),this.el.sceneEl.addEventListener("exit-vr",this.onExitVr)},onPreferenceChange(){const e=window.APP.store.state.preferences.enableOnScreenJoystickLeft,t=window.APP.store.state.preferences.enableOnScreenJoystickRight;(this.enableLeft!==e||this.enableRight!==t)&&(!this.enableLeft&&e?this.createLeftStick():this.enableLeft&&!e&&(this.leftMock.classList.add(Ve.a.hidden),this.leftMockSmall.classList.add(Ve.a.hidden),this.leftStick.destroy(),this.leftTouchZone.parentNode.removeChild(this.leftTouchZone),this.leftStick=null,this.leftTouchZone=null),!this.enableRight&&t?this.createRightStick():this.enableRight&&!t&&(this.rightMock.classList.add(Ve.a.hidden),this.rightMockSmall.classList.add(Ve.a.hidden),this.rightStick.destroy(),this.rightTouchZone.parentNode.removeChild(this.rightTouchZone),this.rightStick=null,this.rightTouchZone=null),this.enableLeft=e,this.enableRight=t,this.enableLeft&&(this.leftMock.classList.remove(Ve.a.hidden),this.leftMockSmall.classList.remove(Ve.a.hidden),this.leftStick.on("start",this.onFirstInteraction)),this.enableRight&&(this.rightMock.classList.remove(Ve.a.hidden),this.rightMockSmall.classList.remove(Ve.a.hidden),this.rightStick.on("start",this.onFirstInteraction)),!this.enableLeft&&!this.enableRight||this.mockJoystickContainer.parentNode||Be(this.mockJoystickContainer,this.el.sceneEl.canvas),this.enableLeft||this.enableRight||this.mockJoystickContainer.parentNode&&this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer))},createRightStick(){this.rightTouchZone=document.createElement("div"),this.rightTouchZone.classList.add(Ve.a.touchZone,Ve.a.right),Be(this.rightTouchZone,this.mockJoystickContainer),this.rightStick=Ne.a.create({zone:this.rightTouchZone,color:"white",fadeTime:0}),this.rightStick.on("start",this.onFirstInteraction),this.rightStick.on("move",this.onLookJoystickChanged),this.rightStick.on("end",this.onLookJoystickEnd)},createLeftStick(){this.leftTouchZone=document.createElement("div"),this.leftTouchZone.classList.add(Ve.a.touchZone,Ve.a.left),Be(this.leftTouchZone,this.mockJoystickContainer),this.leftStick=Ne.a.create({zone:this.leftTouchZone,color:"white",fadeTime:0}),this.leftStick.on("start",this.onFirstInteraction),this.leftStick.on("move",this.onMoveJoystickChanged),this.leftStick.on("end",this.onMoveJoystickEnd)},onFirstInteraction(){this.leftStick&&this.leftStick.off("start",this.onFirstInteraction),this.rightStick&&this.rightStick.off("start",this.onFirstInteraction),this.mockJoystickContainer.parentNode&&this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer)},onMoveJoystickChanged(e,t){if(window.APP.preferenceScreenIsVisible)return;const n=t.angle.radian,a=t.force<1?t.force:1;this.displacement.set(Math.cos(n),0,-Math.sin(n)).multiplyScalar(1.85*a),this.moving=!0},onMoveJoystickEnd(){this.moving=!1,this.displacement.set(0,0,0)},onLookJoystickChanged(e,t){if(window.APP.preferenceScreenIsVisible)return;const n=t.angle.radian,a=t.force<1?t.force:1;this.rotating=!0,this.lookDy=-Math.cos(n)*a*.05,this.lookDx=Math.sin(n)*a*.05},onLookJoystickEnd(){this.rotating=!1,this.lookDx=0,this.lookDy=0,this.el.sceneEl.emit("rotateX",this.lookDx)},tick(){this.inVr||(this.moving&&this.characterController.enqueueRelativeMotion(this.displacement),this.rotating&&(this.characterController.enqueueInPlaceRotationAroundWorldUp(this.lookDy),this.el.sceneEl.emit("rotateX",this.lookDx)))},onEnterVr(){this.inVr=!0,this.leftTouchZone&&(this.leftTouchZone.style.display="none"),this.rightTouchZone&&(this.rightTouchZone.style.display="none")},onExitVr(){this.inVr=!1,this.leftTouchZone&&(this.leftTouchZone.style.display="block"),this.rightTouchZone&&(this.rightTouchZone.style.display="block")},remove(){this.el.sceneEl.removeEventListener("entervr",this.onEnterVr),this.el.sceneEl.removeEventListener("exitvr",this.onExitVr),this.mockJoystickContainer.parentNode&&this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer),this.leftTouchZone&&this.leftTouchZone.parentNode.removeChild(this.leftTouchZone),this.rightTouchZone&&this.rightTouchZone.parentNode.removeChild(this.rightTouchZone)}});var Ue=n(13);const{Vector3:ze,Quaternion:We,Matrix4:qe,Euler:Ge}=THREE;AFRAME.registerComponent("ik-root",{schema:{camera:{type:"string",default:".camera"},leftController:{type:"string",default:".left-controller"},rightController:{type:"string",default:".right-controller"}},update(e){this.data.camera!==e.camera&&(this.camera=this.el.querySelector(this.data.camera)),this.data.leftController!==e.leftController&&(this.leftController=this.el.querySelector(this.data.leftController)),this.data.rightController!==e.rightController&&(this.rightController=this.el.querySelector(this.data.rightController))}});const Ye={left:(new qe).makeRotationFromEuler(new Ge(-Math.PI/2,Math.PI/2,0)),right:(new qe).makeRotationFromEuler(new Ge(-Math.PI/2,-Math.PI/2,0))},Ke=function(){const e=new THREE.Vector3(0,-1,0),t=new THREE.Vector3,n=new THREE.Vector3;return function(a,i){return t.setFromMatrixColumn(a,2).projectOnPlane(e),n.setFromMatrixColumn(i,2).projectOnPlane(e),t.angleTo(n)}}();AFRAME.registerComponent("ik-controller",{schema:{leftEye:{type:"string",default:"LeftEye"},rightEye:{type:"string",default:"RightEye"},head:{type:"string",default:"Head"},neck:{type:"string",default:"Neck"},leftHand:{type:"string",default:"LeftHand"},rightHand:{type:"string",default:"RightHand"},chest:{type:"string",default:"Spine"},rotationSpeed:{default:8},maxLerpAngle:{default:90*THREE.Math.DEG2RAD},alwaysUpdate:{type:"boolean",default:!1}},init(){this._runScheduledWork=this._runScheduledWork.bind(this),this._updateIsInView=this._updateIsInView.bind(this),this.flipY=(new qe).makeRotationY(Math.PI),this.cameraForward=new qe,this.headTransform=new qe,this.hipsPosition=new ze,this.invHipsToHeadVector=new ze,this.middleEyeMatrix=new qe,this.middleEyePosition=new ze,this.invMiddleEyeToHead=new qe,this.cameraYRotation=new Ge,this.cameraYQuaternion=new We,this.invHipsQuaternion=new We,this.headQuaternion=new We,this.rootToChest=new qe,this.invRootToChest=new qe,this.ikRoot=function(e){for(;e&&(!e.components||!e.components["ik-root"]);)e=e.parentNode;return e&&e.components["ik-root"]}(this.el),this.isInView=!0,this.hasConvergedHips=!1,this.lastCameraTransform=new THREE.Matrix4,Object(Ue.b)().then(()=>{this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")}),this.el.sceneEl.systems["frame-scheduler"].schedule(this._runScheduledWork,"ik"),this.forceIkUpdate=!0},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._runScheduledWork,"ik")},update(e){this.avatar=this.el.object3D,this.data.leftEye!==e.leftEye&&(this.leftEye=this.el.object3D.getObjectByName(this.data.leftEye)),this.data.rightEye!==e.rightEye&&(this.rightEye=this.el.object3D.getObjectByName(this.data.rightEye)),this.data.head!==e.head&&(this.head=this.el.object3D.getObjectByName(this.data.head)),this.data.neck!==e.neck&&(this.neck=this.el.object3D.getObjectByName(this.data.neck)),this.data.leftHand!==e.leftHand&&(this.leftHand=this.el.object3D.getObjectByName(this.data.leftHand)),this.data.rightHand!==e.rightHand&&(this.rightHand=this.el.object3D.getObjectByName(this.data.rightHand)),this.data.chest!==e.chest&&(this.chest=this.el.object3D.getObjectByName(this.data.chest)),this.middleEyePosition.addVectors(this.leftEye.position,this.rightEye.position),this.middleEyePosition.divideScalar(2),this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x,this.middleEyePosition.y,this.middleEyePosition.z),this.invMiddleEyeToHead=this.middleEyeMatrix.copy(this.middleEyeMatrix).invert(),this.invHipsToHeadVector.addVectors(this.chest.position,this.neck.position).add(this.head.position).negate()},tick(e,t){if(!this.ikRoot)return;const n=this.ikRoot.el.object3D;n.updateMatrices();const{camera:a,leftController:i,rightController:r}=this.ikRoot;a.object3D.updateMatrix();const o=!this.lastCameraTransform.equals(a.object3D.matrix);if(this.data.alwaysUpdate||this.forceIkUpdate||this.isInView&&(o||!this.hasConvergedHips)){o&&this.lastCameraTransform.copy(a.object3D.matrix);const{avatar:e,head:i,neck:r,chest:d,cameraForward:u,headTransform:h,invMiddleEyeToHead:p,invHipsToHeadVector:m,flipY:f,cameraYRotation:g,cameraYQuaternion:v,invHipsQuaternion:b,rootToChest:y,invRootToChest:E}=this;if(u.multiplyMatrices(a.object3D.matrix,f),h.multiplyMatrices(u,p),e.position.setFromMatrixPosition(h).add(m),e.matrixNeedsUpdate=!0,g.setFromRotationMatrix(u,"YXZ"),g.x=0,g.z=0,v.setFromEuler(g),this._hadFirstTick){a.object3D.updateMatrices(),e.updateMatrices();Math.PI-Ke(a.object3D.matrixWorld,e.matrixWorld)>this.data.maxLerpAngle?e.quaternion.copy(v):e.quaternion.slerpQuaternions(e.quaternion,v,this.data.rotationSpeed*t/1e3)}else e.quaternion.copy(v);this.hasConvergedHips=(s=1e-4,l=v,c=e.quaternion,Math.abs(l.x-c.x)<s&&Math.abs(l.y-c.y)<s&&Math.abs(l.z-c.z)<s&&Math.abs(l.w-c.w)<s||Math.abs(-l.x-c.x)<s&&Math.abs(-l.y-c.y)<s&&Math.abs(-l.z-c.z)<s&&Math.abs(-l.w-c.w)<s),b.copy(e.quaternion).invert(),i.quaternion.setFromRotationMatrix(h).premultiply(b),e.updateMatrix(),y.multiplyMatrices(e.matrix,d.matrix),E.copy(y).invert(),n.matrixNeedsUpdate=!0,r.matrixNeedsUpdate=!0,i.matrixNeedsUpdate=!0,d.matrixNeedsUpdate=!0}var s,l,c;const{leftHand:d,rightHand:u}=this;d&&this.updateHand(Ye.left,d,i.object3D,!0,this.isInView),u&&this.updateHand(Ye.right,u,r.object3D,!1,this.isInView),this.forceIkUpdate=!1,this._hadFirstTick||(this.ikRoot.el.object3D.visible=!0,this._hadFirstTick=!0,this.el.emit("ik-first-tick"))},updateHand(e,t,n,a,i){const r=t.matrix,o=t.el.components["personal-space-invader"];o?o.setAlwaysHidden(!n.visible):t.visible=n.visible,n.visible&&(i||this.forceIkUpdate||this.data.alwaysUpdate)&&(r.multiplyMatrices(this.invRootToChest,n.matrix),r.multiply(e),t.position.setFromMatrixPosition(r),t.rotation.setFromRotationMatrix(r),t.matrixNeedsUpdate=!0)},_runScheduledWork(){this.forceIkUpdate=!0,this._updateIsInView()},_updateIsInView:function(){const e=new THREE.Frustum,t=new THREE.Matrix4,n=new THREE.Vector3,a=(n,a)=>(t.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),e.setFromProjectionMatrix(t),e.containsPoint(a));return function(){if(!this.playerCamera)return;if(this.ikRoot.camera.object3D.getWorldPosition(n),this.isInView=a(this.playerCamera,n),!this.isInView){const e=this.el.sceneEl.systems["camera-tools"];e&&e.ifMyCameraRenderingViewfinder(e=>{this.isInView=this.isInView||a(e.camera,n)})}}}()});var Xe=n(2);const Qe="open",Je="point",Ze="fist",$e="thumbUp",et="thumbDown",tt="indexDown",nt="pinch",at="mrpDown";AFRAME.registerComponent("hand-controls2",{schema:{default:"left"},init(){this.pose=Qe},poseForFingers:(e,t,n)=>e||t||n?e&&t&&n?Ze:!e&&t&&n?$e:e||t||!n?e||!t||n?!e||t||n?e&&t&&!n?nt:e&&!t&&n?Je:(console.warn("Did not find matching pose for thumb ".concat(e,", index ").concat(t,", middleRingPinky ").concat(n)),Qe):et:tt:at:Qe,tick(){const e=this.data,t=AFRAME.scenes[0].systems.userinput,n="left"===e?Xe.a.actions.leftHand:Xe.a.actions.rightHand,a=t.get(n.thumb),i=t.get(n.index),r=t.get(n.middleRingPinky),o=this.poseForFingers(a,i,r);o!==this.pose&&(this.el.emit("hand-pose",{previous:this.pose,current:o}),this.pose=o)}});n(356);AFRAME.registerComponent("hover-visuals",{schema:{hand:{type:"string"}},init(){this.handleLeftVisuals=this.handleLeftVisuals.bind(this),this.handleRightVisuals=this.handleRightVisuals.bind(this),this.hadLeftVisualLastFrame=!1,this.hadRightVisualLastFrame=!1,this.uniforms=null,this.sweepParams=[0,1]},remove(){this.uniforms=null},tick(){this.uniforms&&this.uniforms.length&&("left"===this.data.hand?this.handleLeftVisuals():this.handleRightVisuals())},handleLeftVisuals:function(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.leftHand.held||e.state.leftHand.hovered,n=!t||!Object(v.d)(t);if(n&&!this.hadLeftVisualLastFrame)return;this.hadLeftVisualLastFrame=!n;const a=this.el.object3D.matrixWorld.elements;for(let e=0,t=this.uniforms.length;e<t;e++){const t=this.uniforms[e];t.hubs_HighlightInteractorOne.value=!n,t.hubs_InteractorOnePos.value[0]=a[12],t.hubs_InteractorOnePos.value[1]=a[13],t.hubs_InteractorOnePos.value[2]=a[14]}},handleRightVisuals:function(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.rightHand.held||e.state.rightHand.hovered,n=!t||!Object(v.d)(t);if(n&&!this.hadRightVisualLastFrame)return;this.hadRightVisualLastFrame=!n;const a=this.el.object3D.matrixWorld.elements;for(let e=0,t=this.uniforms.length;e<t;e++){const t=this.uniforms[e];t.hubs_SweepParams.value=this.sweepParams,t.hubs_HighlightInteractorTwo.value=!n,t.hubs_InteractorTwoPos.value[0]=a[12],t.hubs_InteractorTwoPos.value[1]=a[13],t.hubs_InteractorTwoPos.value[2]=a[14]}}}),AFRAME.registerComponent("offset-relative-to",{schema:{target:{type:"selector"},offset:{type:"vec3"},on:{type:"string"},orientation:{default:1},selfDestruct:{default:!1},lookAt:{default:!1}},init(){this.updateOffset=this.updateOffset.bind(this),Object(Ue.b)().then(()=>{this.data.on?this.el.sceneEl.addEventListener(this.data.on,this.updateOffset):this.updateOffset()})},updateOffset:function(){const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,0,-1),n=Math.PI/2,a=new THREE.Vector3,i=new THREE.Vector3;return function(){const r=this.el.object3D,o=this.data.target.object3D;switch(a.copy(this.data.offset),o.localToWorld(a),r.parent&&r.parent.worldToLocal(a),r.position.copy(a),this.data.lookAt?(o.getWorldPosition(i),r.updateMatrices(!0),r.lookAt(i)):o.getWorldQuaternion(r.quaternion),this.data.orientation){case 8:r.rotateOnAxis(t,3*n);break;case 7:r.rotateOnAxis(t,3*n),r.rotateOnAxis(e,2*n);break;case 6:r.rotateOnAxis(t,n);break;case 5:r.rotateOnAxis(t,n),r.rotateOnAxis(e,2*n);break;case 4:r.rotateOnAxis(t,2*n),r.rotateOnAxis(e,2*n);break;case 3:r.rotateOnAxis(t,2*n);break;case 2:r.rotateOnAxis(e,2*n)}r.matrixNeedsUpdate=!0,this.data.selfDestruct&&(this.data.on&&this.el.sceneEl.removeEventListener(this.data.on,this.updateOffset),this.el.removeAttribute("offset-relative-to"))}}()});var it=n(84),rt=n(158),ot=n(59),st=n.n(ot),lt=n(11),ct=n(24);function dt(e){const{nodes:t}=e;if(!t.some(e=>"Head"===e.name)){const n=e.scenes[e.scene].nodes[0];t.push({name:"LeftEye",extensions:{MOZ_hubs_components:{}}}),t.push({name:"RightEye",extensions:{MOZ_hubs_components:{}}}),t.push({name:"Head",children:[n,t.length-1,t.length-2],extensions:{MOZ_hubs_components:{"scale-audio-feedback":""}}}),t.push({name:"Neck",children:[t.length-1]}),t.push({name:"Spine",children:[t.length-1]}),t.push({name:"Hips",children:[t.length-1]}),t.push({name:"AvatarRoot",children:[t.length-1]}),e.scenes[e.scene].nodes[0]=t.length-1}return e}AFRAME.registerComponent("player-info",{schema:{avatarSrc:{type:"string"},avatarType:{type:"string",default:it.a.SKINNABLE},muted:{default:!1},isSharingAvatarCamera:{default:!1}},init(){this.applyProperties=this.applyProperties.bind(this),this.handleModelError=this.handleModelError.bind(this),this.handleRemoteModelError=this.handleRemoteModelError.bind(this),this.update=this.update.bind(this),this.onPresenceUpdated=this.onPresenceUpdated.bind(this),this.onMicStateChanged=this.onMicStateChanged.bind(this),this.onAvatarModelLoaded=this.onAvatarModelLoaded.bind(this),this.isLocalPlayerInfo="avatar-rig"===this.el.id,this.playerSessionId=null,this.isLocalPlayerInfo||NAF.utils.getNetworkedEntity(this.el).then(e=>{this.playerSessionId=NAF.utils.getCreator(e);const t=window.APP.hubChannel.presence.state[this.playerSessionId];t&&this.updateFromPresenceMeta(t.metas[0])}),Object(rt.d)(this,"player-info")},remove(){const e=this.el.querySelector("[avatar-audio-source]");APP.isAudioPaused.delete(e),Object(rt.a)(this,"player-info")},onAvatarModelLoaded(e){this.applyProperties(e);const t=this.el.querySelector(".model");if(this.isLocalPlayerInfo&&e.target===t){let e=!1;t.object3D.traverse((function(t){if(t.isSkinnedMesh){const n=Object(lt.f)(t);n&&(e=!0,t.parent.add(n))}})),e||t.object3D.traverse((function(e){e.isMesh&&e.layers.set(ct.a.CAMERA_LAYER_THIRD_PERSON_ONLY)}))}},play(){this.el.addEventListener("model-loaded",this.onAvatarModelLoaded),this.el.sceneEl.addEventListener("presence_updated",this.onPresenceUpdated),this.isLocalPlayerInfo?this.el.querySelector(".model").addEventListener("model-error",this.handleModelError):this.el.querySelector(".model").addEventListener("model-error",this.handleRemoteModelError),window.APP.store.addEventListener("statechanged",this.update),this.el.sceneEl.addEventListener("stateadded",this.update),this.el.sceneEl.addEventListener("stateremoved",this.update),this.isLocalPlayerInfo&&APP.dialog.on("mic-state-changed",this.onMicStateChanged)},pause(){this.el.removeEventListener("model-loaded",this.onAvatarModelLoaded),this.el.sceneEl.removeEventListener("presence_updated",this.onPresenceUpdated),this.isLocalPlayerInfo?this.el.querySelector(".model").removeEventListener("model-error",this.handleModelError):this.el.querySelector(".model").removeEventListener("model-error",this.handleRemoteModelError),this.el.sceneEl.removeEventListener("stateadded",this.update),this.el.sceneEl.removeEventListener("stateremoved",this.update),window.APP.store.removeEventListener("statechanged",this.update),this.isLocalPlayerInfo&&APP.dialog.off("mic-state-changed",this.onMicStateChanged)},onPresenceUpdated(e){this.updateFromPresenceMeta(e.detail)},updateFromPresenceMeta(e){!this.playerSessionId&&this.isLocalPlayerInfo&&(this.playerSessionId=NAF.clientId),this.playerSessionId&&this.playerSessionId===e.sessionId&&(this.permissions=e.permissions)},update(e){this.data.muted!==e.muted&&this.el.emit("remote_mute_updated",{muted:this.data.muted}),this.applyProperties()},can(e){return!!this.permissions&&this.permissions[e]},applyProperties(e){const t=this.el.querySelector(".model");if(this.data.avatarSrc&&t&&(t.components["gltf-model-plus"].jsonPreprocessor=dt,t.setAttribute("gltf-model-plus","src",this.data.avatarSrc)),!e||e.target===t){const e=Object(te.m)(this.el.object3D);this.el.querySelectorAll("[hover-visuals]").forEach(t=>{t.components["hover-visuals"].uniforms=e})}const n=t.querySelectorAll("[video-texture-target]"),a=this.isLocalPlayerInfo?NAF.clientId:this.playerSessionId;for(const e of Array.from(n))e.setAttribute("video-texture-target",{src:this.data.isSharingAvatarCamera?"hubs://clients/".concat(a,"/video"):""}),this.isLocalPlayerInfo&&e.setAttribute("emit-scene-event-on-remove","event:".concat(T.b.VIDEO_SHARE_ENDED));const i=this.el.querySelector("[avatar-audio-source]");this.data.muted?APP.isAudioPaused.add(i):APP.isAudioPaused.delete(i)},handleModelError(){window.APP.store.resetToRandomDefaultAvatar()},handleRemoteModelError(){this.data.avatarSrc=st.a,this.applyProperties()},onMicStateChanged({enabled:e}){this.el.setAttribute("player-info",{muted:!e})}});var ut=n(212),ht=n(472),pt=n.n(ht),mt=n(12),ft=n(103),gt=n(777),vt=n.n(gt);function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){yt(e,t,n[t])}))}return e}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Et(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const wt=Object(mt.a)("debug"),_t={duration:400,easing:"easeOutQuart",elasticity:400,loop:0,round:!1},St=new d.THREE.PlaneBufferGeometry(1,.025),xt=new d.THREE.MeshBasicMaterial({color:"#7ED320"}),At=new d.THREE.CircleBufferGeometry(.01,6),Mt=te.o.load(vt.a),kt=Object(lt.g)(.2,.2,1,1,Mt.flipY),Ot=new d.THREE.MeshBasicMaterial({transparent:!0,map:Mt});AFRAME.registerComponent("name-tag",{schema:{},init(){this.store=window.APP.store,this.displayName=null,this.identityName=null,this.isTalking=!1,this.isTyping=!1,this.isOwner=!1,this.isRecording=!1,this.isHandRaised=!1,this.volumeAvg=new pt.a(128),this.shouldBeVisible=!0,this.size=new d.THREE.Vector3,this.avatarAABB=new d.THREE.Box3,this.avatarAABBSize=new d.THREE.Vector3,this.avatarAABBCenter=new d.THREE.Vector3,this.nametagHeight=0,this.isAvatarReady=!1,this.lastUpdateTime=Date.now(),this.onPresenceUpdated=this.onPresenceUpdated.bind(this),this.onModelLoading=this.onModelLoading.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onModelIkFirstTick=this.onModelIkFirstTick.bind(this),this.onStateChanged=this.onStateChanged.bind(this),this.nametag=this.el.object3D,this.nametagIdentityName=this.el.querySelector(".identityName").object3D,this.nametagBackground=this.el.querySelector(".nametag-background").object3D,this.nametagStatusBorder=this.el.querySelector(".nametag-status-border").object3D,this.recordingBadge=this.el.querySelector(".recordingBadge").object3D,this.modBadge=this.el.querySelector(".modBadge").object3D,this.nametagText=this.el.querySelector(".nametag-text").object3D,this.handRaised=new d.THREE.Mesh(kt,Ot),this.handRaised.position.set(0,-.3,.001),this.el.object3D.add(this.handRaised),this.nametagVolume=new d.THREE.Mesh(St,xt),this.nametagVolume.position.set(0,-.075,.001),this.nametagVolume.visible=!1,this.el.object3D.add(this.nametagVolume),this.nametagTyping=new d.THREE.Group,this.nametagTyping.position.set(0,-.075,.001);for(let e=0;e<5;e++){const t=new d.THREE.Mesh(At,new d.THREE.MeshBasicMaterial({transparent:!0,color:16777215,depthWrite:!1}));t.position.x=.035*e-.07,this.nametagTyping.add(t)}this.el.object3D.add(this.nametagTyping),this.updateTheme(),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.playerSessionId=NAF.utils.getCreator(e);const t=window.APP.hubChannel.presence.state[this.playerSessionId];t&&this.updateFromPresenceMeta(t.metas[0])}),wt&&(this.avatarAABBHelper=new d.THREE.Box3Helper(this.avatarAABB,16776960),this.el.sceneEl.object3D.add(this.avatarAABBHelper)),this.onStateChanged()},remove(){wt&&this.el.sceneEl.object3D.remove(this.avatarAABBHelper)},tick:(()=>{let e=0;const t=new d.THREE.Vector3,n=new d.THREE.Matrix4;return function(a){this.isAvatarReady?(this.wasTalking=this.isTalking,this.isTalking=this.audioAnalyzer.avatarIsTalking,this.shouldBeVisible?(this.nametag.visible=!0,this.isTalking!==this.wasTalking&&this.resizeNameTag(),this.isTalking?(this.nametagVolume.visible=this.isTalking,this.nametagVolume.scale.setX(this.audioAnalyzer.volume*this.size.x),this.nametagVolume.matrixNeedsUpdate=!0,this.nametagTyping.visible=!1):this.isTyping?(this.nametagTyping.visible=!0,e=a,this.nametagTyping.traverse(t=>{t.material&&(t.material.opacity=(Math.sin(e/150)+1)/2,e-=150)})):this.nametagTyping.visible=!1,this.nametagStatusBorder.visible=this.isTyping||this.isTalking||this.isHandRaised,this.recordingBadge.visible=this.isRecording,this.modBadge.visible=this.isOwner&&!this.isRecording,this.handRaised.visible=this.isHandRaised,this.neck.getWorldPosition(t),t.setY(this.nametagElPosY+this.ikRoot.position.y),n.setPosition(t),Object(lt.n)(this.nametag,n)):this.nametag.visible=!1,wt&&(this.updateAvatarModelAABB(),this.avatarAABBHelper.matrixNeedsUpdate=!0,this.avatarAABBHelper.updateMatrixWorld(!0))):this.nametag.visible=!1}})(),play(){this.el.parentEl.addEventListener("model-loading",this.onModelLoading),this.el.parentEl.addEventListener("model-loaded",this.onModelLoaded),this.el.parentEl.addEventListener("ik-first-tick",this.onModelIkFirstTick),this.el.sceneEl.addEventListener("presence_updated",this.onPresenceUpdated),window.APP.store.addEventListener("statechanged",this.onStateChanged),this.el.sceneEl.systems["hubs-systems"].nameTagSystem.register(this)},pause(){this.el.parentEl.removeEventListener("model-loading",this.onModelLoading),this.el.parentEl.removeEventListener("model-loaded",this.onModelLoaded),this.el.parentEl.removeEventListener("ik-first-tick",this.onModelIkFirstTick),this.el.sceneEl.removeEventListener("presence_updated",this.onPresenceUpdated),window.APP.store.removeEventListener("statechanged",this.onStateChanged),this.el.sceneEl.systems["hubs-systems"].nameTagSystem.unregister(this)},onPresenceUpdated({detail:e}){e.sessionId===this.playerSessionId&&this.updateFromPresenceMeta(e)},updateFromPresenceMeta(e){this.displayName=e.profile.displayName,this.identityName=e.profile.identityName,this.isRecording=!(!e.streaming&&!e.recording),this.isOwner=!(!e.roles||!e.roles.owner),this.isTyping=!!e.typing,this.isHandRaised=!!e.hand_raised,this.isAvatarReady&&(this.updateDisplayName(),this.updateHandRaised(),this.resizeNameTag())},updateDisplayName(){this.displayName&&this.displayName!==this.prevDisplayName&&(this.nametagText.el.addEventListener("text-updated",()=>{this.nametagText.el&&(this.nametagText.el.components.text.getSize(this.size),this.size.x=Math.max(this.size.x,.6),this.resizeNameTag())},{once:!0}),this.displayName.length>18&&(this.displayName=this.displayName.slice(0,18).concat("...")),this.nametagText.el.setAttribute("text",{value:this.displayName}),this.prevDisplayName=this.displayName),this.identityName&&(this.identityName.length>18&&(this.identityName=this.identityName.slice(0,18).concat("...")),this.nametagIdentityName.el.setAttribute("text",{value:this.identityName}))},onModelLoading(){this.model=null,this.isAvatarReady=!1},onModelLoaded({detail:{model:e}}){this.model=e},onModelIkFirstTick(){var e,t=this;return(e=function*(){yield Object(_.a)(),t.ikRoot=Object(ft.a)(t.el,"ik-root").object3D,t.neck=t.ikRoot.el.querySelector(".Neck").object3D,t.audioAnalyzer=t.ikRoot.el.querySelector(".AvatarRoot").components["networked-audio-analyser"],t.updateAvatarModelAABB();const e=new d.THREE.Vector3;t.nametagHeight=Math.abs(e.subVectors(t.ikRoot.position,t.avatarAABBCenter).y)+t.avatarAABBSize.y/2+.2,t.nametagElPosY=t.nametagHeight+(t.isHandRaised?.2:0),t.nametagText.el.components.text.getSize(t.size),t.size.x=Math.max(t.size.x,.6),t.isAvatarReady=!0,t.updateDisplayName(),t.updateHandRaised(),t.resizeNameTag()},function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Et(r,a,i,o,s,"next",e)}function s(e){Et(r,a,i,o,s,"throw",e)}o(void 0)}))})()},updateTheme(){this.nametagStatusBorder.el.setAttribute("slice9","color",Object(r.b)(this.isHandRaised?"nametag-border-color-raised-hand":"nametag-border-color")),xt.color.set(Object(r.b)("nametag-volume-color")),this.nametagBackground.el.setAttribute("slice9","color",Object(r.b)("nametag-color")),this.nametagText.el.setAttribute("text","color",Object(r.b)("nametag-text-color"))},onStateChanged(){this.updateTheme()},resizeNameTag(){this.nametagBackground.el.setAttribute("slice9",{width:this.size.x+.1,height:.25}),this.nametagStatusBorder.el.setAttribute("slice9",{width:this.size.x+.1+.035,height:.25+.035})},updateHandRaised(){this.nametagStatusBorder.el.setAttribute("slice9","color",Object(r.b)(this.isHandRaised?"nametag-border-color-raised-hand":"nametag-border-color"));const e=this.isHandRaised?1:0;Object(ut.default)(bt({},_t,{targets:{x:this.handRaised.scale.x,y:this.handRaised.scale.y,z:this.handRaised.scale.z},x:e,y:e,z:e,update:e=>{this.handRaised.scale.set(e.animatables[0].target.x,e.animatables[0].target.y,e.animatables[0].target.z),this.handRaised.matrixNeedsUpdate=!0}})),Object(ut.default)(bt({},_t,{targets:{y:this.nametagElPosY},y:this.nametagHeight+(this.isHandRaised?.2:0),update:e=>{this.nametagElPosY=e.animatables[0].target.y}}))},updateAvatarModelAABB(){this.model&&(this.avatarAABB.setFromObject(this.model),this.avatarAABB.getSize(this.avatarAABBSize),this.avatarAABB.getCenter(this.avatarAABBCenter))}});n(540);var Ct=n(602);const Pt={open:"allOpen",thumbDown:"thumbDown",indexDown:"indexDown",mrpDown:"mrpDown",thumbUp:"thumbsUp",point:"point",fist:"allGrip",pinch:"pinch"},Rt=["allOpen","thumbDown","indexDown","mrpDown","thumbsUp","point","allGrip","pinch"];AFRAME.registerComponent("hand-pose",{multiple:!0,init(){this.pose=0,this.animatePose=this.animatePose.bind(this);const e=Object(ft.a)(this.el,"animation-mixer"),t="left"==this.id?"_L":"_R";if(this.mixer=e&&e.components["animation-mixer"].mixer,!this.mixer||!this.mixer.clipAction(Pt.open+t))return console.warn("Avatar does not an 'allOpen' animation, disabling hand animations"),void this.el.removeAttribute("hand-pose");this.from=this.to=this.mixer.clipAction(Pt.open+t),this.from.play(),this.networkField="".concat(this.id,"_hand_pose");const n=e=>{if(!e)return void window.setTimeout(()=>{n(this.el)},1e3);const t=e.components&&e.components["networked-avatar"];return t||n(e.parentEl)};this.networkedAvatar=n(this.el)},tick(){this.networkedAvatar&&this.networkedAvatar.data&&this.networkedAvatar.data[this.networkField]!==this.pose&&(this.animatePose(Rt[this.pose],Rt[this.networkedAvatar.data[this.networkField]]),this.pose=this.networkedAvatar.data[this.networkField])},animatePose(e,t){this.from&&this.from.stop(),this.to&&this.to.stop();const n="left"==this.id?"_L":"_R";this.from=this.mixer.clipAction(e+n),this.to=this.mixer.clipAction(t+n),this.from&&(this.from.setLoop(Ct.a,-1),this.from.clampWhenFinished=!0,this.from.fadeOut(.065),this.from.play()),this.to&&(this.to.setLoop(Ct.a,-1),this.to.clampWhenFinished=!0,this.to.fadeIn(.065),this.to.play()),this.mixer.update(.001)}}),AFRAME.registerComponent("hand-pose-controller",{multiple:!0,schema:{eventSrc:{type:"selector"},networkedAvatar:{type:"selector"}},init:function(){this.setHandPose=this.setHandPose.bind(this)},play:function(){this.data.eventSrc.addEventListener("hand-pose",this.setHandPose)},pause:function(){this.data.eventSrc.removeEventListener("hand-pose",this.setHandPose)},setHandPose:function(e){this.data.networkedAvatar.setAttribute("networked-avatar","".concat(this.id,"_hand_pose"),Rt.indexOf(Pt[e.detail.current]))}});var Tt=n(140);const jt=2*Math.PI;AFRAME.registerComponent("hud-controller",{schema:{head:{type:"selector"},offset:{default:.7},lookCutoff:{default:20},animRange:{default:30},yawCutoff:{default:50}},init(){this.onChildHovered=this.onChildHovered.bind(this),this.removeHoverEvents=this.removeHoverEvents.bind(this),this.isYLocked=!1,this.lockedHeadPositionY=0,this.lookDir=new THREE.Vector3,this.lookEuler=new THREE.Euler,this.store=window.APP.store,this.hoverableChildren=this.el.querySelectorAll("[is-remote-hover-target]")},tick(){const e=this.el.object3D,t=this.data.head.object3DMap.camera,{offset:n,lookCutoff:a,animRange:i,yawCutoff:r}=this.data,o=t.rotation.x*THREE.Math.RAD2DEG,s=function(e,t){const n=Math.abs(t-e)%jt;return n>Math.PI?jt-n:n}(t.rotation.y,e.rotation.y)*THREE.Math.RAD2DEG,l=!this.store.state.activity.hasHoveredInWorldHud;let c=1-THREE.Math.clamp(a-o,0,i)/i;l&&(c=1),1===c?(this.lockedHeadPositionY=t.position.y,this.hudLocked=!0):this.hudLocked&&o<a-i/2&&(this.hudLocked=!1),this.hudLocked&&(c=1);const d=s>=r||o<a-i/2;d&&(this.lookDir.set(0,0,-1),this.lookDir.applyQuaternion(t.quaternion),this.lookDir.add(t.position),e.position.x=this.lookDir.x,e.position.z=this.lookDir.z,e.rotation.copy(t.rotation),e.rotation.x=0,e.rotation.z=0),e.visible=(!d||l)&&this.el.sceneEl.systems["hubs-systems"].cameraSystem.mode===Tt.a,e.position.y=(this.isYLocked?this.lockedHeadPositionY:t.position.y)+n+(1-c)*n,e.rotation.x=(1-c)*THREE.Math.DEG2RAD*90,e.matrixNeedsUpdate=!0},play(){for(let e=0;e<this.hoverableChildren.length;e++)this.hoverableChildren[e].object3D.addEventListener("hovered",this.onChildHovered)},pause(){this.removeHoverEvents()},removeHoverEvents(){for(let e=0;e<this.hoverableChildren.length;e++)this.hoverableChildren[e].object3D.removeEventListener("hovered",this.onChildHovered)},onChildHovered(){this.store.state.activity.hasHoveredInWorldHud||(this.store.update({activity:{hasHoveredInWorldHud:!0}}),this.removeHoverEvents())}}),AFRAME.registerComponent("freeze-controller",{init:function(){this.onToggle=this.onToggle.bind(this)},tick:function(){const e=this.el.sceneEl;if(!e.is("entered"))return;if(e.systems["hubs-systems"].cameraSystem.mode===Tt.b)this.el.is("frozen")&&this.onToggle(),NAF.connection.adapter.frozen||NAF.connection.adapter.toggleFreeze(),this.wasInspecting=!0;else if(this.wasInspecting)NAF.connection.adapter.frozen&&NAF.connection.adapter.toggleFreeze(),this.wasInspecting=!1;else{const t=e.systems.userinput,n=t.get(Xe.a.actions.ensureFrozen),a=t.get(Xe.a.actions.thaw),i=t.get(Xe.a.actions.toggleFreeze);(this.el.is("frozen")&&a||!this.el.is("frozen")&&n||i)&&this.onToggle()}},onToggle:function(){window.APP.store.update({activity:{hasFoundFreeze:!0}}),NAF.connection.adapter&&(NAF.connection.adapter.toggleFreeze(),NAF.connection.adapter.frozen?(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.e),this.el.addState("frozen")):(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.v),this.el.removeState("frozen")))}});n(1135),n(1136),n(1137),n(1138),n(1139),n(1140),n(1141),n(1142),n(1143),n(1144);const Dt=AFRAME.utils.device.isMobile();AFRAME.registerComponent("visibility-while-frozen",{schema:{withinDistance:{type:"number"},visible:{type:"boolean",default:!0},requireHoverOnNonMobile:{type:"boolean",default:!0},withPermission:{type:"string"},withoutPermission:{type:"string"},visibleIfOwned:{type:"boolean",default:!0}},init(){this.updateVisibility=this.updateVisibility.bind(this),this.camWorldPos=new THREE.Vector3,this.objWorldPos=new THREE.Vector3,Object(Ue.b)().then(()=>{this.cameraEl=document.getElementById("viewing-camera"),this.updateVisibility()});let e=this.el;for(;e!==document;){if(null!==e.getAttribute("is-remote-hover-target")){this.hoverable=e;break}e=e.parentNode}!this.hoverable&&this.data.requireHoverOnNonMobile&&console.error("Didn't find a remote hover target."),this.data.visibleIfOwned||NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e}).then(()=>{}),this.onStateChange=e=>{"frozen"!==!e.detail&&this.updateVisibility()},this.updateVisibility()},tick(){const e=this.el.sceneEl.is("frozen"),t=this.el.object3D.visible,n=e===!this.data.visible;!t&&n||this.updateVisibility()},updateVisibility(){if(!this.cameraEl)return;const e=this.el.sceneEl.is("frozen");let t=!0;const n=this.el.object3D.visible;this.data.withinDistance&&(n||this.el.object3D.updateMatrices(!0,!0),Object(lt.j)(this.cameraEl.object3DMap.camera,this.camWorldPos),this.objWorldPos.copy(this.el.object3D.position),this.el.object3D.localToWorld(this.objWorldPos),t=this.camWorldPos.distanceToSquared(this.objWorldPos)<this.data.withinDistance*this.data.withinDistance);const a=this.el.sceneEl.systems["transform-selected-object"].transforming,i=this.el.sceneEl.systems.interaction.isHoldingAnything();if(this.data.withPermission&&this.data.withoutPermission)throw new Error("only withPermission or withoutPermission can be speciifed on visibility-while-frozen, not both.");let r=!!(!this.data.withPermission&&!this.data.withoutPermission||this.data.withPermission&&window.APP.hubChannel&&window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission)||this.data.withoutPermission&&window.APP.hubChannel&&!window.APP.hubChannel.canOrWillIfCreator(this.data.withoutPermission))&&(e&&this.data.visible||!e&&!this.data.visible)&&t&&!a&&!i;this.data.requireHoverOnNonMobile&&!Dt&&(r=r&&(this.hoverable&&(this.el.sceneEl.systems.interaction.state.rightRemote.hovered===this.hoverable||this.el.sceneEl.systems.interaction.state.leftRemote.hovered===this.hoverable)||n)),this.data.visibleIfOwned||(r=r&&this.networkedEl&&!NAF.utils.isMine(this.networkedEl)),n!==r&&this.el.setAttribute("visible",r)},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.hoverable&&(this.hoverable.object3D.addEventListener("hovered",this.updateVisibility),this.hoverable.object3D.addEventListener("unhovered",this.updateVisibility))},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),this.hoverable&&(this.hoverable.object3D.addEventListener("hovered",this.updateVisibility),this.hoverable.object3D.addEventListener("unhovered",this.updateVisibility))}}),AFRAME.registerComponent("ui-class-while-frozen",{init(){this.onStateChange=e=>{"frozen"!==!e.detail&&this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},play(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}});n(1145);function It(e){let t=null;return{update:function(){t("renderer.info.memory.geometries").set(e.info.memory.geometries),t("renderer.info.programs").set(e.info.programs.length),t("renderer.info.memory.textures").set(e.info.memory.textures),t("renderer.info.render.calls").set(e.info.render.calls),t("renderer.info.render.triangles").set(e.info.render.triangles),t("renderer.info.render.points").set(e.info.render.points)},start:function(){},end:function(){},attach:function(e){t=e},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e5},"renderer.info.render.points":{caption:"Points"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],fractions:[]}}AFRAME.registerComponent("stats-plus",{schema:{default:!1},init(){this.onExpand=this.onExpand.bind(this),this.onCollapse=this.onCollapse.bind(this),this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this);const e=this.el.sceneEl;if(this.stats=function(e){const t=e.isMobile?[]:[new It(e.renderer)];return new window.rStats({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf","physics"]}],plugins:t})}(e),this.statsEl=document.querySelector(".rs-base"),!this.statsEl)return;const t=document.createElement("div");t.classList.add("rs-header");const n=document.createElement("h1");n.innerHTML="Stats",t.appendChild(n);const a=document.createElement("div");a.classList.add("rs-collapse-btn"),a.innerHTML="X",a.addEventListener("click",this.onCollapse),t.appendChild(a),this.statsEl.insertBefore(t,this.statsEl.firstChild),this.fpsEl=document.createElement("div"),this.fpsEl.addEventListener("click",this.onExpand),this.fpsEl.classList.add("rs-fps-counter"),document.body.appendChild(this.fpsEl),this.lastFpsUpdate=performance.now(),this.lastFps=0,this.frameCount=0,this.inVR=e.is("vr-mode"),this.showFPSCounter=window.APP.store.state.preferences.showFPSCounter,this.fpsEl.style.display=this.showFPSCounter?"block":"none",e.isMobile&&(this.statsEl.classList.add("rs-mobile"),this.fpsEl.classList.add("rs-mobile")),e.addEventListener("enter-vr",this.onEnterVr),e.addEventListener("exit-vr",this.onExitVr),this.vrStatsEnabled=Object(mt.a)("vrstats"),this.vrStatsEnabled&&this.initVRStats(),this.lastUpdate=0},initVRStats(){this.vrPanel=document.createElement("a-entity"),this.vrPanel.setAttribute("text",{maxWidth:.5,value:"_",anchorY:"bottom"}),this.vrPanel.addEventListener("loaded",()=>this.vrPanel.object3D.traverse(e=>{e.material&&(e.material.depthTest=!1)}),{once:!0}),this.el.append(this.vrPanel);const e=new THREE.Mesh(new THREE.PlaneBufferGeometry(.1,.12),new THREE.MeshBasicMaterial({color:3355443,depthTest:!1}));e.position.set(-.2,.055,0),this.el.object3D.add(e)},toggleVRStats(){this.vrStatsEnabled?(this.el.object3D.visible=!1,this.vrStatsEnabled=!1):(this.vrPanel||this.initVRStats(),this.el.object3D.visible=!0,this.vrStatsEnabled=!0)},update(e){e!==this.data&&(this.data?(this.statsEl.classList.remove("a-hidden"),this.fpsEl.classList.add("a-hidden")):(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.remove("a-hidden")))},tick(e){const t=this.stats;if(this.statsEl&&(this.showFPSCounter!==window.APP.store.state.preferences.showFPSCounter&&(this.showFPSCounter=window.APP.store.state.preferences.showFPSCounter,this.fpsEl.style.display=this.showFPSCounter?"block":"none"),this.showFPSCounter)){if(this.data||this.vrStatsEnabled){t("rAF").tick(),t("FPS").frame(),t("physics").set(this.el.sceneEl.systems["hubs-systems"].physicsSystem.stepDuration);const e=this.el.sceneEl.systems["hubs-systems"].batchManagerSystem;if(e.batchingEnabled){const n=e.batchManager;t("batchdraws").set(n.batches.length),t("batchinstances").set(n.instanceCount),t("batchatlassize").set(n.atlas.arrayDepth)}t().update()}else if(!this.inVR){const e=performance.now();if(this.frameCount++,e>=this.lastFpsUpdate+1e3){const t=Math.round(this.frameCount/((e-this.lastFpsUpdate)/1e3));t!==this.lastFps&&(this.fpsEl.innerHTML=Math.round(t)+" FPS",this.lastFps=t),this.lastFpsUpdate=e,this.frameCount=0}}this.vrStatsEnabled&&e-this.lastUpdate>100&&(this.vrPanel.setAttribute("text","value",["f ".concat(t("fps").value().toFixed(0)),"r ".concat(t("raf").value().toFixed(0)),"p ".concat(t("physics").value().toFixed(0)),"c ".concat(this.el.sceneEl.renderer.info.render.calls),"t ".concat((this.el.sceneEl.renderer.info.render.triangles/1e3).toFixed(0),"k")].join("\n")),this.lastUpdate=e)}},onEnterVr(){this.inVR=!0,this.el.sceneEl.isMobile&&(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.add("a-hidden"))},onExitVr(){this.inVR=!1,this.el.sceneEl.isMobile&&(this.data?this.statsEl.classList.remove("a-hidden"):this.fpsEl.classList.remove("a-hidden"))},onExpand(){this.el.setAttribute(this.name,!0)},onCollapse(){this.el.setAttribute(this.name,!1)},remove(){this.el.sceneEl.removeEventListener("enter-vr",this.hide),this.el.sceneEl.removeEventListener("exit-vr",this.show),this.statsEl&&(this.statsEl.parentNode.removeChild(this.statsEl),this.fpsEl.parentNode.removeChild(this.fpsEl))}});n(1146);var Lt=n(778),Ht=n.n(Lt),Nt=n(291),Ft=n.n(Nt),Vt=n(603),Bt=n(37),Ut=n(19),zt=n(779);function Wt(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function qt(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Wt(r,a,i,o,s,"next",e)}function s(e){Wt(r,a,i,o,s,"throw",e)}o(void 0)}))}}let Gt;function Yt(){Gt=Gt||document.querySelector("#media-mirror-target");const e=Gt.firstChild;return e&&e.components["media-loader"]&&e.components["media-loader"].data.linkedEl}function Kt(){return(Kt=qt((function*(){const e=Yt();if(!e)return;yield Object(te.f)();const{entity:t}=Object(te.e)(e,"#linked-media",e.components["media-loader"].data.src,!1,!0,Gt);t.object3D.scale.set(.75,.75,.75),t.object3D.matrixNeedsUpdate=!0;const n=t.querySelector("[refresh-media-button]");n&&n.parentNode.removeChild(n);const a=t.querySelector("[local-refresh-media-button]");a&&a.parentNode.removeChild(a),Gt.parentEl.components["follow-in-fov"].reset(),Gt.parentEl.object3D.visible=!0}))).apply(this,arguments)}var Xt=n(780),Qt=n.n(Xt),Jt=n(97),Zt=n(38),$t=n(10),en=n(781),tn=n.n(en);const nn=new Image;nn.src=tn.a;const an=new THREE.Texture(nn);function rn(e,t){const n=Math.min(1,1/t),a=Math.min(1,t);e.object3DMap.mesh.scale.set(n,a,1),e.object3DMap.mesh.matrixNeedsUpdate=!0}nn.onload=()=>{an.needsUpdate=!0};var on=n(230);function sn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function ln(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){sn(r,a,i,o,s,"next",e)}function s(e){sn(r,a,i,o,s,"throw",e)}o(void 0)}))}}const cn={once:!0},dn={type:"image/png"},un=Object(u.b)(),hn=(new Jt.a).load(Ht.a),pn=[];for(let e=0;e<=20;e++){let t="[";for(let n=1;n<=20;n++)t+=e>=n?"|":" ";t+="]",pn[e]=t}function mn(e){let t=Math.floor(e),n=Math.floor(t/3600);t-=3600*n;let a=Math.floor(t/60);return t-=60*a,n<10&&(n="0".concat(n)),a<10&&(a="0".concat(a)),t<10&&(t="0".concat(t)),"00"===n?"".concat(a,":").concat(t):"".concat(n,":").concat(a,":").concat(t)}AFRAME.registerComponent("media-video",{schema:{src:{type:"string"},audioSrc:{type:"string"},contentType:{type:"string"},loop:{type:"boolean",default:!0},hidePlaybackControls:{type:"boolean",default:!1},videoPaused:{type:"boolean"},projection:{type:"string",default:"flat"},time:{type:"number"},tickRate:{default:1e3},syncTolerance:{default:2},linkedVideoTexture:{default:null},linkedAudioSource:{default:null},linkedMediaElementAudioSource:{default:null}},init(){APP.gainMultipliers.set(this.el,1),this.onPauseStateChange=this.onPauseStateChange.bind(this),this.updateHoverMenu=this.updateHoverMenu.bind(this),this.tryUpdateVideoPlaybackState=this.tryUpdateVideoPlaybackState.bind(this),this.ensureOwned=this.ensureOwned.bind(this),this.isMineOrLocal=this.isMineOrLocal.bind(this),this.updateSrc=this.updateSrc.bind(this),this.seekForward=this.seekForward.bind(this),this.seekBack=this.seekBack.bind(this),this.volumeUp=this.volumeUp.bind(this),this.volumeDown=this.volumeDown.bind(this),this.snap=this.snap.bind(this),this.changeVolumeBy=this.changeVolumeBy.bind(this),this.togglePlaying=this.togglePlaying.bind(this),this.setupAudio=this.setupAudio.bind(this),this.audioSystem=this.el.sceneEl.systems["hubs-systems"].audioSystem,this.lastUpdate=0,this.videoMutedAt=0,this.localSnapCount=0,this.isSnapping=!1,this.videoIsLive=null,this.onSnapImageLoaded=()=>this.isSnapping=!1,this.hasAudioTracks=!1,this.el.setAttribute("hover-menu__video",{template:"#video-hover-menu",isFlat:!0}),this.el.components["hover-menu__video"].getHoverMenu().then(e=>{this.el.parentNode&&(this.hoverMenu=e,this.playbackControls=this.el.querySelector(".video-playback"),this.playPauseButton=this.el.querySelector(".video-playpause-button"),this.volumeUpButton=this.el.querySelector(".video-volume-up-button"),this.volumeDownButton=this.el.querySelector(".video-volume-down-button"),this.seekForwardButton=this.el.querySelector(".video-seek-forward-button"),this.seekBackButton=this.el.querySelector(".video-seek-back-button"),this.snapButton=this.el.querySelector(".video-snap-button"),this.timeLabel=this.el.querySelector(".video-time-label"),this.volumeLabel=this.el.querySelector(".video-volume-label"),this.linkButton=this.el.querySelector(".video-link-button"),this.playPauseButton.object3D.addEventListener("interact",this.togglePlaying),this.seekForwardButton.object3D.addEventListener("interact",this.seekForward),this.seekBackButton.object3D.addEventListener("interact",this.seekBack),this.volumeUpButton.object3D.addEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.addEventListener("interact",this.volumeDown),this.snapButton.object3D.addEventListener("interact",this.snap),this.updateVolumeLabel(),this.updateHoverMenu(),this.updatePlaybackState())}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,Object(v.a)(this.networkedEl.components.networked.data.networkId),this.updatePlaybackState(),this.networkedEl.addEventListener("pinned",this.updateHoverMenu),this.networkedEl.addEventListener("unpinned",this.updateHoverMenu),window.APP.hubChannel.addEventListener("permissions_updated",this.updateHoverMenu),un||"scene"!==NAF.utils.getNetworkOwner(this.networkedEl)||setTimeout(()=>{"scene"===NAF.utils.getNetworkOwner(this.networkedEl)&&NAF.utils.takeOwnership(this.networkedEl)},2e3+Math.floor(2e3*Math.random()))}).catch(()=>{this.updatePlaybackState()});let e=APP.store.state.preferences.disableLeftRightPanning;this.onPreferenceChanged=()=>{const t=APP.store.state.preferences.disableLeftRightPanning,n=e!==t&&this.audio&&this.mediaElementAudioSource;e=t,n&&this.setupAudio()},APP.store.addEventListener("statechanged",this.onPreferenceChanged),this.el.addEventListener("audio_type_changed",this.setupAudio)},play(){this.el.components["listed-media"]&&this.el.sceneEl.emit("listed_media_changed")},isMineOrLocal(){return!this.el.components.networked||this.networkedEl&&NAF.utils.isMine(this.networkedEl)},ensureOwned(){return!this.el.components.networked||this.networkedEl&&NAF.utils.isMine(this.networkedEl)||NAF.utils.takeOwnership(this.networkedEl)},seekForward(){!this.videoIsLive&&this.ensureOwned()&&(this.video.currentTime+=30,this.el.setAttribute("media-video","time",this.video.currentTime))},seekBack(){!this.videoIsLive&&this.ensureOwned()&&(this.video.currentTime-=10,this.el.setAttribute("media-video","time",this.video.currentTime))},changeVolumeBy(e){let t=APP.gainMultipliers.get(this.el);t=THREE.Math.clamp(t+e,0,2),APP.gainMultipliers.set(this.el,t),this.updateVolumeLabel();const n=APP.audios.get(this.el);n&&Object(Zt.d)(this.el,n)},volumeUp(){this.changeVolumeBy(.2)},volumeDown(){this.changeVolumeBy(-.2)},snap(){var e=this;return ln((function*(){if(e.isSnapping)return;e.isSnapping=!0,e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.b);const t=document.createElement("canvas");t.width=e.video.videoWidth,t.height=e.video.videoHeight,t.getContext("2d").drawImage(e.video,0,0,t.width,t.height);const n=yield new Promise(e=>t.toBlob(e)),a=new File([n],"snap.png",dn);e.localSnapCount++;const{entity:i}=Object(te.b)(e.el,a,"photo-snapshot",e.localSnapCount);i.addEventListener("image-loaded",e.onSnapImageLoaded,cn)}))()},togglePlaying(){un&&this.video.paused&&this.isMineOrLocal()?this.video.play():this.ensureOwned()&&this.tryUpdateVideoPlaybackState(!this.data.videoPaused)},onPauseStateChange(){un&&this.video.paused&&this.isMineOrLocal()||this._ignorePauseStateChanges||(this.el.setAttribute("media-video","videoPaused",this.video.paused),this.video.paused?APP.isAudioPaused.add(this.el):APP.isAudioPaused.delete(this.el),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this.el.emit("owned-video-state-changed"))},updatePlaybackState(e){this.updateHoverMenu(),this.video&&(e||this.networkedEl&&!NAF.utils.isMine(this.networkedEl))&&(Math.abs(this.data.time-this.video.currentTime)>this.data.syncTolerance?this.tryUpdateVideoPlaybackState(this.data.videoPaused,this.data.time):this.tryUpdateVideoPlaybackState(this.data.videoPaused))},tryUpdateVideoPlaybackState(e,t){this._playbackStateChangeTimeout&&(clearTimeout(this._playbackStateChangeTimeout),delete this._playbackStateChangeTimeout),!1===this.videoIsLive&&void 0!==t&&(this.video.currentTime=t),this.hoverMenu&&this.playPauseButton.setAttribute("icon-button","active",e),e?this.video.pause():this.video.play().catch(()=>{e===this.data.videoPaused&&(this._playbackStateChangeTimeout=setTimeout(()=>this.tryUpdateVideoPlaybackState(e,t),1e3))})},update(e){this.updatePlaybackState();this.data.src&&this.data.src!==e.src&&this.updateSrc(e)},setupAudio(){this.removeAudio(),APP.sourceType.set(this.el,$t.g.MEDIA_VIDEO),this.data.videoPaused?APP.isAudioPaused.add(this.el):APP.isAudioPaused.delete(this.el);const{audioType:e}=Object(Zt.a)(this.el),t=this.el.sceneEl.audioListener;e===$t.a.PannerNode?this.audio=new THREE.PositionalAudio(t):this.audio=new THREE.Audio(t),this.audioSystem.addAudio({sourceType:$t.g.MEDIA_VIDEO,node:this.audio}),this.audio.setNodeSource(this.mediaElementAudioSource),this.el.setObject3D("sound",this.audio),this.audio.updateMatrixWorld(),APP.audios.set(this.el,this.audio),Object(Zt.d)(this.el,this.audio)},updateSrc(e){var t=this;return ln((function*(){const{src:n,linkedVideoTexture:a,linkedAudioSource:i,linkedMediaElementAudioSource:r}=t.data;let o,s;t.cleanUp(),t.mesh&&t.mesh.material&&(t.mesh.material.map=null,t.mesh.material.needsUpdate=!0);try{if(a?(o=a,s=i):(t.el.emit("video-loading"),({texture:o,audioSourceEl:s}=yield t.createVideoTextureAudioSourceEl()),Yt()===t.el&&(yield function(){return Kt.apply(this,arguments)}())),t.hasAudioTracks=Object(te.l)(s),t.data.src!==n)return void Object(Bt.b)(o);if(t.mediaElementAudioSource=null,n.startsWith("hubs://")||un&&!Qt.a.satisfies(Object(p.detect)().version,">=13.1.2")||(t.mediaElementAudioSource=r||t.el.sceneEl.audioListener.context.createMediaElementSource(s),t.hasAudioTracks&&t.setupAudio()),t.video=o.image,t.video.loop=t.data.loop,t.video.addEventListener("pause",t.onPauseStateChange),t.video.addEventListener("play",t.onPauseStateChange),o.hls){const e=()=>{o.hls.currentLevel>=0&&(t.videoIsLive=o.hls.levels[o.hls.currentLevel].details.live,t.updateHoverMenu())};o.hls.on(Ft.a.Events.LEVEL_LOADED,e),o.hls.on(Ft.a.Events.LEVEL_SWITCHED,e),o.hls.currentLevel>=0&&e()}else t.videoIsLive=t.video.duration===1/0,t.updateHoverMenu();if(un){const e=document.getElementById("video-unmute");t.el.appendChild(document.importNode(e.content,!0)),t.el.setAttribute("position-at-border__unmute-ui",{target:".unmute-ui",isFlat:!0})}t.videoTexture=o,t.audioSource=s}catch(e){console.error("Error loading video",t.data.src,e),o=an,t.videoTexture=t.audioSource=null}const l=t.data.projection;if(!t.mesh||l!==e.projection){const e=new THREE.MeshBasicMaterial;let n;if(e.toneMapped=!1,"360-equirectangular"===l)n=new THREE.SphereBufferGeometry(1,64,32),n.scale(-1,1,1);else{const t=o.isVideoTexture?o.flipY:hn.flipY;n=Object(lt.g)(void 0,void 0,void 0,void 0,t),e.side=THREE.DoubleSide}t.mesh=new THREE.Mesh(n,e),t.el.setObject3D("mesh",t.mesh)}o.isVideoTexture?(t.mesh.material.map=o,"flat"===l&&rn(t.el,(o.image.videoHeight||o.image.height)/(o.image.videoWidth||o.image.width))):t.mesh.material.map=hn,t.mesh.material.needsUpdate=!0,t.updatePlaybackState(!0),t.video&&t.video.muted&&(t.videoMutedAt=performance.now()),t.el.emit("video-loaded",{projection:l})}))()},createVideoTextureAudioSourceEl(){var e=this;return ln((function*(){const t=e.data.src,n=e.data.contentType;let i;return new Promise(function(){var r=ln((function*(r,o){e._audioSyncInterval&&(clearInterval(e._audioSyncInterval),e._audioSyncInterval=null);let s=!1;const l=function(e){s||(s=!0,clearTimeout(i),o(e))},c=Object(te.i)("video");let d,u,h;if(n.startsWith("audio/")?(d=new THREE.Texture,d.image=c,h=()=>c.readyState>0):(d=new THREE.VideoTexture(c),d.minFilter=THREE.LinearFilter,d.encoding=THREE.sRGBEncoding,/firefox/i.test(navigator.userAgent)&&(d.format=THREE.RGBAFormat),h=()=>{if(d.hls&&d.hls.streamController.audioOnly){u=c;const e=d.hls;return d=new THREE.Texture,d.image=c,d.hls=e,!0}return(d.image.videoHeight||d.image.height)&&(d.image.videoWidth||d.image.width)}),t.startsWith("hubs://")){const n=t.substring(7).split("/")[1],a=yield APP.dialog.getMediaStream(n,"video");e._onStreamUpdated&&APP.dialog.off("stream_updated",e._onStreamUpdated),e._onStreamUpdated=function(){var e=ln((function*(e,t){if(e===n&&"video"===t){const t=yield APP.dialog.getMediaStream(e,"video").catch(t=>{console.error("Error getting video stream for ".concat(e),t)});t&&(c.srcObject=new MediaStream(t))}}));return function(t,n){return e.apply(this,arguments)}}(),APP.dialog.on("stream_updated",e._onStreamUpdated,e),c.srcObject=new MediaStream(a.getVideoTracks())}else if(n.startsWith("application/dash")){const e=Object(Vt.MediaPlayer)().create();e.extend("RequestModifier",(function(){return{modifyRequestHeader:e=>e,modifyRequestURL:Ut.j}})),e.on(Vt.MediaPlayer.events.ERROR,l),e.initialize(c,t),e.setTextDefaultEnabled(!1),e.clearDefaultUTCTimingSources(),e.addUTCTimingSource("urn:mpeg:dash:utc:http-xsdate:2014",Object(Ut.j)("https://time.akamai.com/?iso")),d.dash=e}else if(AFRAME.utils.material.isHLS(t,n))if(Ft.a.isSupported()){const e="https://".concat(a.a.CORS_PROXY_SERVER,"/"),n=t.startsWith(e)?t.substring(e.length):t;(()=>{d.hls&&(d.hls.stopLoad(),d.hls.detachMedia(),d.hls.destroy(),d.hls=null);const a=new Ft.a({debug:Object(mt.a)("hlsDebug"),xhrSetup:(t,a)=>{a.startsWith(e)&&(a=a.substring(e.length)),a.startsWith("http")||(a=Object(zt.buildAbsoluteURL)(n,a.startsWith("/")?a:"/".concat(a))),t.open("GET",Object(Ut.j)(a),!0)}});d.hls=a,a.loadSource(t),a.attachMedia(c),a.on(Ft.a.Events.ERROR,(function(e,t){if(t.fatal)switch(t.type){case Ft.a.ErrorTypes.NETWORK_ERROR:a.startLoad();break;case Ft.a.ErrorTypes.MEDIA_ERROR:a.recoverMediaError();break;default:return void l(e)}}))})()}else c.canPlayType(n)?(c.src=t,c.onerror=l):l("HLS unsupported");else c.src=t,Object(on.a)()?c.onerror=ln((function*(){c.onerror=l;try{const e=yield fetch(t);c.srcObject=yield e.blob()}catch(e){l(e)}})):c.onerror=l,e.data.audioSrc&&(c.muted=!0,u=Object(te.i)("audio"),u.src=e.data.audioSrc,u.onerror=l,e._audioSyncInterval=setInterval(()=>{Math.abs(u.currentTime-c.currentTime)>=.33&&(u.currentTime=c.currentTime),c.paused!==u.paused&&(c.paused?u.pause():u.play(),u.currentTime=c.currentTime)},1e3));const p=()=>{h()?(s=!0,r({texture:d,audioSourceEl:u||d.image})):i=setTimeout(p,500)};p()}));return function(e,t){return r.apply(this,arguments)}}())}))()},updateHoverMenu(){if(!this.hoverMenu)return;const e=this.el.components["media-loader"].data,t=e.linkedEl||this.el,n=t.components.pinnable&&t.components.pinnable.data.pinned;this.playbackControls.object3D.visible=!this.data.hidePlaybackControls&&!!this.video,this.timeLabel.object3D.visible=!this.data.hidePlaybackControls,this.volumeLabel.object3D.visible=this.volumeUpButton.object3D.visible=this.volumeDownButton.object3D.visible=this.hasAudioTracks&&!this.data.hidePlaybackControls&&!!this.video,this.snapButton.object3D.visible=!!this.video&&!this.data.contentType.startsWith("audio/")&&window.APP.hubChannel.can("spawn_and_move_media"),this.seekForwardButton.object3D.visible=!!this.video&&!this.videoIsLive;const a=!!this.video&&!this.videoIsLive&&(!n||window.APP.hubChannel.can("pin_objects"));this.playPauseButton.object3D.visible=this.seekForwardButton.object3D.visible=this.seekBackButton.object3D.visible=a,this.linkButton.object3D.visible=!!e.mediaOptions.href,this.videoIsLive&&this.timeLabel.setAttribute("text","value","LIVE")},updateVolumeLabel(){const e=APP.gainMultipliers.get(this.el);this.volumeLabel.setAttribute("text","value",0===e?"MUTE":pn[Math.floor(e/.1)])},tick:function(){if(!this.video)return;const e=this.el.sceneEl.systems.userinput,t=this.el.sceneEl.systems.interaction,n=e.get(Xe.a.actions.cursor.right.mediaVolumeMod);t.state.rightRemote.hovered===this.el&&n&&this.changeVolumeBy(n);const a=e.get(Xe.a.actions.cursor.left.mediaVolumeMod);t.state.leftRemote.hovered===this.el&&a&&this.changeVolumeBy(a);const i=t.isHeld(this.el);if(this.wasHeld&&!i&&(this.localSnapCount=0),this.wasHeld=i,this.hoverMenu&&this.hoverMenu.object3D.visible&&!this.videoIsLive&&this.timeLabel.setAttribute("text","value","".concat(mn(this.video.currentTime)," / ").concat(mn(this.video.duration))),!this.data.videoPaused&&!1===this.videoIsLive&&this.networkedEl&&NAF.utils.isMine(this.networkedEl)){const e=performance.now();e-this.lastUpdate>this.data.tickRate&&(this.el.setAttribute("media-video","time",this.video.currentTime),this.lastUpdate=e)}},cleanUp(){this.videoTexture&&!this.data.linkedVideoTexture&&Object(Bt.b)(this.videoTexture)},remove(){this.cleanUp(),APP.isAudioPaused.delete(this.el),this.mesh&&this.el.removeObject3D("mesh"),this._audioSyncInterval&&(clearInterval(this._audioSyncInterval),this._audioSyncInterval=null),APP.gainMultipliers.delete(this.el),APP.audios.delete(this.el),APP.sourceType.delete(this.el),APP.supplementaryAttenuation.delete(this.el),this.removeAudio(),this.networkedEl&&(this.networkedEl.removeEventListener("pinned",this.updateHoverMenu),this.networkedEl.removeEventListener("unpinned",this.updateHoverMenu)),window.APP.hubChannel.removeEventListener("permissions_updated",this.updateHoverMenu),this.video&&(this.video.removeEventListener("pause",this.onPauseStateChange),this.video.removeEventListener("play",this.onPauseStateChange),APP.dialog.off("stream_updated",this._onStreamUpdated)),this.hoverMenu&&(this.playPauseButton.object3D.removeEventListener("interact",this.togglePlaying),this.volumeUpButton.object3D.removeEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.removeEventListener("interact",this.volumeDown),this.seekForwardButton.object3D.removeEventListener("interact",this.seekForward),this.seekBackButton.object3D.removeEventListener("interact",this.seekBack),this.snapButton.object3D.removeEventListener("interact",this.snap)),window.APP.store.removeEventListener("statechanged",this.onPreferenceChanged),this.el.addEventListener("audio_type_changed",this.setupAudio)},removeAudio(){this.audio&&(this.el.removeObject3D("sound"),this.audioSystem.removeAudio({node:this.audio}),delete this.audio)}});var fn=n(604),gn=n.n(fn);function vn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function bn(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){vn(r,a,i,o,s,"next",e)}function s(e){vn(r,a,i,o,s,"throw",e)}o(void 0)}))}}const yn={once:!0},En={type:"image/png"};gn.a.GlobalWorkerOptions.workerSrc=n(1332),AFRAME.registerComponent("media-pdf",{schema:{src:{type:"string"},projection:{type:"string",default:"flat"},contentType:{type:"string"},index:{default:0},batch:{default:!1}},init(){this.snap=this.snap.bind(this),this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.localSnapCount=0,this.isSnapping=!1,this.onSnapImageLoaded=()=>this.isSnapping=!1,this.texture=new THREE.CanvasTexture(this.canvas),this.texture.encoding=THREE.sRGBEncoding,this.texture.minFilter=THREE.LinearFilter,this.el.addEventListener("pager-snap-clicked",()=>this.snap())},play(){this.el.components["listed-media"]&&this.el.sceneEl.emit("listed_media_changed")},snap(){var e=this;return bn((function*(){if(e.isSnapping)return;e.isSnapping=!0,e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.b);const t=yield new Promise(t=>e.canvas.toBlob(t)),n=new File([t],"snap.png",En);e.localSnapCount++;const{entity:a}=Object(te.b)(e.el,n,"photo-snapshot",e.localSnapCount,!1,1);a.addEventListener("image-loaded",e.onSnapImageLoaded,yn)}))()},remove(){this.data.batch&&this.mesh&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.mesh)},update(e){var t=this;return bn((function*(){let n,a=1;try{const{src:i,index:r}=t.data;if(!i)return;if(t.renderTask&&(yield t.renderTask.promise,i!==t.data.src||r!==t.data.index))return;if(t.el.emit("pdf-loading"),i!==e.src){const e=t.data.src,n=yield gn.a.getDocument(i);if(e!==t.data.src)return;t.pdf=n,t.el.setAttribute("media-pager",{maxIndex:t.pdf.numPages-1})}const o=yield t.pdf.getPage(r+1);if(i!==t.data.src||r!==t.data.index)return;const s=o.getViewport({scale:3}),l=s.width,c=s.height;if(n=t.texture,a=c/l,t.canvas.width=l,t.canvas.height=c,t.renderTask=o.render({canvasContext:t.canvasContext,viewport:s}),yield t.renderTask.promise,t.renderTask=null,i!==t.data.src||r!==t.data.index)return}catch(e){console.error("Error loading PDF",t.data.src,e),n=an}if(!t.mesh){const e=new THREE.MeshBasicMaterial,a=Object(lt.g)(1,1,1,1,n.flipY);e.side=THREE.DoubleSide,t.mesh=new THREE.Mesh(a,e),t.el.setObject3D("mesh",t.mesh)}t.mesh.material.transparent=n==an,t.mesh.material.map=n,t.mesh.material.map.needsUpdate=!0,t.mesh.material.needsUpdate=!0,rn(t.el,a),n!==an&&t.data.batch&&t.el.sceneEl.systems["hubs-systems"].batchManagerSystem.addObject(t.mesh),t.el.components["media-pager"]&&t.el.components["media-pager"].data.index!==t.data.index&&t.el.setAttribute("media-pager",{index:t.data.index}),t.el.emit("pdf-loaded",{src:t.data.src})}))()}});var wn=n(289),_n=n(287);const Sn=new THREE.LoadingManager;let xn,An;Sn.setURLModifier(Ut.k);var Mn=n(213),kn=n(782),On=n.n(kn);function Cn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Pn(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Cn(r,a,i,o,s,"next",e)}function s(e){Cn(r,a,i,o,s,"throw",e)}o(void 0)}))}}class Rn extends THREE.Texture{constructor(e,t,n){super(document.createElement("canvas")),this.image.width=e[0].width,this.image.height=e[0].height,this._ctx=this.image.getContext("2d"),this.generateMipmaps=!1,this.isVideoTexture=!0,this.minFilter=THREE.NearestFilter,this.frames=e,this.delays=t,this.disposals=n,this.frame=0,this.frameStartTime=Date.now()}update(){if(!this.frames||!this.delays||!this.disposals)return;const e=Date.now();e-this.frameStartTime>this.delays[this.frame]&&(2===this.disposals[this.frame]&&this._ctx.clearRect(0,0,this.image.width,this.image.width),this.frame=(this.frame+1)%this.frames.length,this.frameStartTime=e,this._ctx.drawImage(this.frames[this.frame],0,0,this.image.width,this.image.height),this.needsUpdate=!0)}}const Tn=Object(Mn.a)(new On.a);function jn(){return(jn=Pn((function*(e){return new Promise((t,n)=>{fetch(e,{mode:"cors"}).then(e=>e.arrayBuffer()).then(e=>Tn(e,[e])).then(n=>{const{frames:a,delayTimes:i,disposals:r}=n;let o=0;for(let n=0;n<a.length;n++){const s=new Image;s.onload=s=>{if(o++,a[n]=s.target,o===a.length){const n=new Rn(a,i,r);n.image.src=e,n.encoding=THREE.sRGBEncoding,n.minFilter=THREE.LinearFilter,t(n)}},s.src=a[n]}}).catch(n)})}))).apply(this,arguments)}function Dn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const In=new class{constructor(){this.cache=new Map}key(e,t){return"".concat(e,"_").concat(t)}set(e,t,n){const a=n.image;return this.cache.set(this.key(e,t),{texture:n,ratio:(a.videoHeight||a.height)/(a.videoWidth||a.width),count:0}),this.retain(e,t)}has(e,t){return this.cache.has(this.key(e,t))}get(e,t){return this.cache.get(this.key(e,t))}retain(e,t){const n=this.cache.get(this.key(e,t));return n.count++,n}release(e,t){const n=this.cache.get(this.key(e,t));n?(n.count--,n.count<=0&&(Object(Bt.b)(n.texture),this.cache.delete(this.key(e,t)))):console.error("Releasing uncached texture src ".concat(e))}},Ln=new Map,Hn={texture:an,ratio:1400/1200};AFRAME.registerComponent("media-image",{schema:{src:{type:"string"},version:{type:"number"},projection:{type:"string",default:"flat"},contentType:{type:"string"},batch:{default:!1},alphaMode:{type:"string",default:void 0},alphaCutoff:{type:"number"}},play(){this.el.components["listed-media"]&&this.el.sceneEl.emit("listed_media_changed")},remove(){this.data.batch&&this.mesh&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.mesh),this.currentSrcIsRetained&&(In.release(this.data.src,this.data.version),this.currentSrcIsRetained=!1)},update(e){var t,n=this;return(t=function*(){let t,a=1;const i=n.el.sceneEl.systems["hubs-systems"].batchManagerSystem;try{const{src:i,version:o,contentType:s}=n.data;if(!i)return;let l;if(n.el.emit("image-loading"),n.mesh&&n.mesh.material.map&&(i!==e.src||o!==e.version)&&(n.mesh.material.map=null,n.mesh.material.needsUpdate=!0,n.mesh.material.map!==an&&(In.release(e.src,e.version),n.currentSrcIsRetained=!1)),In.has(i,o))l=n.currentSrcIsRetained?In.get(i,o):In.retain(i,o);else{const e=In.key(i,o);if("error"===i)l=Hn;else if(Ln.has(e))yield Ln.get(e),l=In.retain(i,o);else{let n;if(s.includes("image/gif"))n=function(e){return jn.apply(this,arguments)}(i);else if(s.includes("image/basis"))r=i,An||(An=new _n.a(Sn).detectSupport(AFRAME.scenes[0].renderer)),n=new Promise((e,t)=>{An.load(r,(function(t){t.encoding=THREE.sRGBEncoding,t.onUpdate=function(){t.mipmaps.length=0},e(t)}),void 0,(function(e){console.error(e),t(new Error("'".concat(r,"' could not be fetched (Error: ").concat(e)))}))});else if(s.includes("image/ktx2"))n=function(e){return xn||(xn=new wn.a(Sn).detectSupport(AFRAME.scenes[0].renderer)),new Promise((t,n)=>{xn.load(e,(function(e){e.encoding=THREE.sRGBEncoding,e.onUpdate=function(){e.mipmaps.length=0},e.anisotropy=4,t(e)}),void 0,(function(t){console.error(t),n(new Error("'".concat(e,"' could not be fetched (Error: ").concat(t)))}))})}(i);else{if(!s.startsWith("image/"))throw new Error("Unknown image content type: ".concat(s));n=Object(te.h)(i)}Ln.set(e,n),t=yield n,Ln.delete(e),l=In.set(i,o,t)}if(n.data.src!==i||n.data.version!==o||!n.el.parentNode)return void In.release(i,o)}t=l.texture,a=l.ratio,n.currentSrcIsRetained=!0}catch(e){console.error("Error loading image",n.data.src,e),t=an,n.currentSrcIsRetained=!1}var r;const o=n.data.projection;if(n.mesh&&n.data.batch&&i.removeObject(n.mesh),!n.mesh||o!==e.projection){const e=new THREE.MeshBasicMaterial;let a;if(e.toneMapped=!1,"360-equirectangular"===o){if(a=new THREE.SphereBufferGeometry(1,64,32),a.scale(-1,1,1),!t.flipY){const e=a.attributes.uv.array;for(let t=1;t<e.length;t+=2)e[t]=1-e[t]}}else a=Object(lt.g)(1,1,1,1,t.flipY),e.side=THREE.DoubleSide;n.mesh=new THREE.Mesh(a,e),n.el.setObject3D("mesh",n.mesh)}if(t==an)n.mesh.material.transparent=!0;else switch(n.data.alphaMode){case"opaque":n.mesh.material.transparent=!1;break;case"blend":n.mesh.material.transparent=!0,n.mesh.material.alphaTest=0;break;case"mask":n.mesh.material.transparent=!1,n.mesh.material.alphaTest=n.data.alphaCutoff;break;default:n.mesh.material.transparent=!n.data.batch||n.data.contentType.includes("image/gif")||!(!t.image||!t.image.hasAlpha),n.mesh.material.alphaTest=0}n.mesh.material.map=t,n.mesh.material.needsUpdate=!0,"flat"===o&&rn(n.el,a),t!==an&&n.data.batch&&!t.isCompressedTexture&&i.addObject(n.mesh),n.el.emit("image-loaded",{src:n.data.src,projection:o})},function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(e){Dn(r,a,i,o,s,"next",e)}function s(e){Dn(r,a,i,o,s,"throw",e)}o(void 0)}))})()}});function Nn(e){return Math.min(20,e<=1.001?Math.floor(e/(1/10.5)):Math.floor(10.5+(e-1)/(7/10.5)))}function Fn(e,t,n){const a=APP.store.state.preferences.avatarVoiceLevels||{};a[e]={gainMultiplier:t,muted:n},APP.store.update({preferences:{avatarVoiceLevels:a}})}AFRAME.registerComponent("avatar-volume-controls",{init(){this.volumeUp=this.volumeUp.bind(this),this.volumeDown=this.volumeDown.bind(this),this.volumeUpButton=this.el.querySelector(".avatar-volume-up-button"),this.volumeDownButton=this.el.querySelector(".avatar-volume-down-button"),this.muteButton=this.el.querySelector(".avatar-mute-button"),this.volumeLabel=this.el.querySelector(".avatar-volume-label"),this.volumeUpButton.object3D.addEventListener("interact",this.volumeUp),this.volumeDownButton.object3D.addEventListener("interact",this.volumeDown),this.update=this.update.bind(this),this.normalizer=null,window.APP.store.addEventListener("statechanged",this.update),this.audioEl=this.el.parentEl.parentEl.querySelector("[avatar-audio-source]"),this.playerInfo=Object(ft.a)(this.el,"player-info").components["player-info"],this.onRemoteMuteUpdated=this.onRemoteMuteUpdated.bind(this),this.playerInfo.el.addEventListener("remote_mute_updated",this.onRemoteMuteUpdated),this.muteButton.object3D.visible=this.playerInfo.data.muted;const e=(t=this.playerInfo.displayName,null===(n=APP.store.state.preferences.avatarVoiceLevels)||void 0===n?void 0:n[t]);var t,n;this.updateGainMultiplier(void 0===e?1:e.gainMultiplier),this.updateLocalMuted(void 0!==e&&e.muted)},remove(){APP.gainMultipliers.delete(this.audioEl),window.APP.store.removeEventListener("statechanged",this.update),this.playerInfo.el.removeEventListener("remote_mute_updated",this.onRemoteMuteUpdated)},updateGainMultiplier(e,t=!1){APP.gainMultipliers.set(this.audioEl,e);const n=APP.audios.get(this.audioEl);n&&Object(Zt.d)(this.audioEl,n),this.updateVolumeLabel(),this.el.emit("gain_multiplier_updated",{gainMultiplier:e});const a=APP.mutedState.has(this.audioEl);t&&Fn(this.playerInfo.displayName,e,a)},updateLocalMuted(e,t=!1){!0===e?APP.mutedState.add(this.audioEl):APP.mutedState.delete(this.audioEl);const n=APP.audios.get(this.audioEl);n&&Object(Zt.d)(this.audioEl,n),this.updateVolumeLabel(),this.el.emit("local_muted_updated",{muted:e});const a=APP.gainMultipliers.get(this.audioEl),i=APP.mutedState.has(this.audioEl);t&&Fn(this.playerInfo.displayName,a,i)},volumeUp(){let e=APP.gainMultipliers.get(this.audioEl);const t=function(e){return e>1-1/10.5?7/10.5:1/10.5}(e);e=THREE.Math.clamp(e+t,0,8),this.updateGainMultiplier(e,!0)},volumeDown(){let e=APP.gainMultipliers.get(this.audioEl);const t=-function(e){return e>1+1/10.5?7/10.5:1/10.5}(e);e=THREE.Math.clamp(e+t,0,8),this.updateGainMultiplier(e,!0)},updateVolumeLabel(){const e=APP.gainMultipliers.get(this.audioEl),t=APP.mutedState.has(this.audioEl),n=Nn(e);this.volumeLabel.setAttribute("text","value",0===e||t?"Muted":pn[n])},onRemoteMuteUpdated({detail:{muted:e}}){this.el.sceneEl.systems.permissions.canOrWillIfCreator("mute_users")&&this.muteButton.object3D.traverse(t=>{t.visible=!e})}}),AFRAME.registerComponent("pinch-to-move",{schema:{speed:{default:.25}},init(){this.axis=[0,0]},tick(){const e=AFRAME.scenes[0].systems.userinput.get(Xe.a.device.touchscreen.pinchDelta);e&&(this.axis[1]=e*this.data.speed,this.el.emit("move",{axis:this.axis}))}});const Vn=function(){const e=new THREE.Quaternion,t=new THREE.Quaternion,n=new THREE.Quaternion,a=new THREE.Quaternion,i=new THREE.Quaternion,r=new THREE.Quaternion,o=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3(0,1,0);return function(c,d,u){c.parent.updateMatrices(),c.updateMatrices(),c.parent.getWorldQuaternion(e),c.getWorldQuaternion(t),n.copy(c.quaternion),s.set(0,1,0).applyQuaternion(n);const h=s.dot(l);s.set(0,0,1).applyQuaternion(n);const p=Math.abs(s.dot(l));o.set(1,0,0).applyQuaternion(t),a.setFromAxisAngle(o,d),i.setFromAxisAngle(l,u),r.copy(t).premultiply(a).premultiply(i).premultiply(e.invert()),s.set(0,1,0).applyQuaternion(r);const m=s.dot(l);s.set(0,0,1).applyQuaternion(r);const f=Math.abs(s.dot(l));f>.9&&f>p||m<0&&m<h||(c.quaternion.copy(r),c.matrixNeedsUpdate=!0,c.updateMatrices())}}();let Bn,Un;AFRAME.registerComponent("pitch-yaw-rotator",{init(){this.pendingXRotation=0,this.el.sceneEl.addEventListener("rotateX",e=>{this.pendingXRotation+=e.detail}),this.on=!0},tick(){if(this.on){const e=AFRAME.scenes[0],t=e.systems.userinput;Bn=Bn||document.getElementById("ui-root"),Un=Un||document.getElementById("scene-preview-node");const n=!e.is("entered"),a=n&&Bn&&Bn.firstChild&&Bn.firstChild.classList.contains("isGhost"),i=t.get(n?Xe.a.actions.lobbyCameraDelta:Xe.a.actions.cameraDelta);i?Vn(n&&!a?Un.object3D:this.el.object3D,this.pendingXRotation+i[1],i[0]):this.pendingXRotation&&Vn(n&&!a?Un.object3D:this.el.object3D,this.pendingXRotation,0)}this.pendingXRotation=0}});var zn=n(116);const Wn=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI),qn=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a,i,r,o){n.updateMatrices();const s=a.min,l=a.max;i.addVectors(s,l).multiplyScalar(.5).applyMatrix4(n.matrixWorld),t.setFromMatrixScale(n.matrixWorld),r.subVectors(l,s).multiplyScalar(.5).multiply(t),e.setFromMatrixPosition(n.matrixWorld),o.subVectors(i,e)}}(),Gn=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Matrix4;return function(r,o,s,l,c){s?n.subVectors(r,l).normalize():n.set(0,0,1).applyMatrix4(o).normalize(),t.set(0,1,0),a.copy(n).multiplyScalar(-1),e.crossVectors(a,t).normalize(),t.crossVectors(e,a),i.makeBasis(e,t,n),c.setFromRotationMatrix(i)}}(),Yn=[];AFRAME.registerComponent("position-at-border",{multiple:!0,schema:{target:{type:"string"},isFlat:{default:!1},animate:{default:!0},scale:{default:!0}},init(){this.ready=!1,this.didInit=!1,this.tick2=this.tick2.bind(this),this.doInit=this.doInit.bind(this),Yn.push(this)},doInit(){if(this.didInit=!0,this.cam=document.getElementById("viewing-camera").object3DMap.camera,!this.data.target)return void console.error("No target for position-at-border on element:",this.el);const e=this.el.querySelector(this.data.target);e?(this.data.animate&&(this.didRegisterWithAnimationSystem=!0,this.el.sceneEl.systems["hubs-systems"].menuAnimationSystem.register(this,e,this.data.scale)),this.target=e.object3D,this.wasVisible=!1,this.previousMesh=null,this.meshLocalBoundingBox=new THREE.Box3,this.meshCenter=new THREE.Vector3,this.meshHalfExtents=new THREE.Vector3,this.meshOffsetToCenter=new THREE.Vector3,this.isTargetBoundingBoxDirty=!0,this.targetLocalBoundingBox=new THREE.Box3,this.targetCenter=new THREE.Vector3,this.targetHalfExtents=new THREE.Vector3,this.targetOffsetToCenter=new THREE.Vector3,this.ready=!0):console.error("Could not find ".concat(this.data.target," underneath element:"),this.el)},remove(){this.didRegisterWithAnimationSystem&&this.el.sceneEl.systems["hubs-systems"].menuAnimationSystem.unregister(this),Yn.splice(Yn.indexOf(this),1)},markDirty(){this.isTargetBoundingBoxDirty=!0},tick2:function(){const e=new THREE.Vector3,t=new THREE.Matrix4,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Quaternion,s=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Matrix4,d=new THREE.Vector3,u=new THREE.Matrix4,h=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3;return function(){if(this.didInit||this.doInit(),!this.ready)return;const f=this.el.getObject3D("mesh");if(!f)return;const g=this.target.visible,v=g&&!this.wasVisible;if(this.wasVisible=g,!v)return;if(this.isTargetBoundingBoxDirty){if(Object(zn.a)(this.target,this.targetLocalBoundingBox,!0),this.targetLocalBoundingBox.min.x===1/0)return;this.isTargetBoundingBoxDirty=!1}qn(this.target,this.targetLocalBoundingBox,this.targetCenter,this.targetHalfExtents,this.targetOffsetToCenter);f!==this.previousMesh&&(Object(zn.a)(f,this.meshLocalBoundingBox,!0),this.previousMesh=f),qn(f,this.meshLocalBoundingBox,this.meshCenter,this.meshHalfExtents,this.meshOffsetToCenter),u.extractRotation(f.matrixWorld),p.set(0,0,-1).applyMatrix4(u),this.cam.updateMatrices(),e.setFromMatrixPosition(this.cam.matrixWorld),t.extractRotation(this.cam.matrixWorld),n.subVectors(e,this.meshCenter);const b=this.data.isFlat&&p.dot(n)>0,y=this.el.sceneEl.systems.interaction.getActiveIntersection(),E=.5*m.subVectors(this.meshLocalBoundingBox.max,this.meshLocalBoundingBox.min).multiply(h.setFromMatrixScale(f.matrixWorld)).length();if(this.data.isFlat)i.copy(this.meshCenter).add(d.set(0,0,this.meshHalfExtents.z+this.targetHalfExtents.z+.02).multiplyScalar(b?-1:1).applyMatrix4(u));else if(E+2>n.length())i.lerpVectors(e,y?y.point:this.meshCenter,y?.8:.25);else if(y){const t=n.length()-E;a.subVectors(y.point,e),i.copy(e).add(a.normalize().multiplyScalar(t))}else n.normalize().multiplyScalar(E),i.copy(this.meshCenter).add(n);if(this.data.scale){const t=n.subVectors(e,i).length();l.setScalar(THREE.Math.clamp(.45*t,.05,4))}else l.setFromMatrixScale(this.target.matrixWorld);this.data.scale?r.copy(i).sub(this.targetOffsetToCenter.divide(s.setFromMatrixScale(this.target.matrixWorld)).multiply(l)):r.copy(this.meshCenter).add(d.set(0,0,this.meshHalfExtents.z+this.targetHalfExtents.z+.02).multiplyScalar(b?-1:1).applyMatrix4(u)),this.data.isFlat?(o.setFromRotationMatrix(u),b&&o.multiply(Wn)):Gn(e,t,this.el.sceneEl.is("vr-mode"),r,o),c.compose(r,o,l),Object(lt.n)(this.target,c)}}()});class Kn{constructor(){}tick(){for(let e=0;e<Yn.length;e++)Yn[e].tick2()}}n(1333);function Xn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Qn(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Xn(r,a,i,o,s,"next",e)}function s(e){Xn(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Jn(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Zn(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Jn(r,a,i,o,s,"next",e)}function s(e){Jn(r,a,i,o,s,"throw",e)}o(void 0)}))}}AFRAME.registerComponent("pin-networked-object-button",{schema:{tipSelector:{type:"string"},labelSelector:{type:"string"}},init(){this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),this.tipEl=this.el.parentNode.querySelector(this.data.tipSelector),this.labelEl=this.el.parentNode.querySelector(this.data.labelSelector),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)}),this.onHovered=()=>{this.hovering=!0,this._updateUI()},this.onUnhovered=()=>{this.hovering=!1,this._updateUI()},this.onClick=()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;window.APP.pinningHelper.setPinned(this.targetEl,!e),e||this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.m)},APP.store.addEventListener("themechanged",this._updateUI)},play(){this.el.object3D.addEventListener("interact",this.onClick),this.el.object3D.addEventListener("hovered",this.onHovered),this.el.object3D.addEventListener("unhovered",this.onUnhovered)},pause(){this.el.object3D.removeEventListener("interact",this.onClick),this.el.object3D.removeEventListener("hovered",this.onHovered),this.el.object3D.removeEventListener("unhovered",this.onUnhovered)},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_discordBridges:()=>window.APP.hubChannel.discordBridges(),_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){const{fileIsOwned:e,fileId:t}=this.targetEl.components["media-loader"].data,n=window.APP.hubChannel.can("pin_objects")&&!!(e||t&&Object(te.k)(t));this.el.object3D.visible=n,this.labelEl.object3D.visible=n;const a=this.targetEl.getAttribute("pinnable")&&this.targetEl.getAttribute("pinnable").pinned,i=this._discordBridges();this.tipEl.object3D.visible=!!(n&&!a&&this.hovering&&i.length>0),n&&(this.labelEl.setAttribute("text","value",a?"un-pin":"pin"),Object(r.a)(this.el,a))}}),AFRAME.registerComponent("mirror-media-button",{init(){var e=this;this.updateSrc=()=>{this.targetEl.parentNode&&(this.src=this.targetEl.components["media-loader"].data.src)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()}),this.onClick=Qn((function*(){const t=document.querySelector("#media-mirror-target");yield Object(te.f)();const{entity:n}=Object(te.e)(e.targetEl,"#linked-media",e.src,!1,!0,t);n.object3D.scale.set(.75,.75,.75),n.object3D.matrixNeedsUpdate=!0,t.parentEl.components["follow-in-fov"].reset(),t.parentEl.object3D.visible=!0}))},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("close-mirrored-media-button",{init(){var e=this;this.onClick=Zn((function*(){e.el.object3D.visible=!1,yield Object(te.f)(),e.el.object3D.visible=!0}))},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});n(1334);function $n(e,t){(NAF.utils.isMine(t)||NAF.utils.takeOwnership(t))&&(t.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),t.addEventListener("animationcomplete",()=>{e.systems["hubs-systems"].cameraSystem.uninspect(),NAF.utils.takeOwnership(t),t.parentNode.removeChild(t)}))}AFRAME.registerComponent("remove-networked-object-button",{init(){this.onClick=()=>{$n(this.el.sceneEl,this.targetEl),this.el.parentNode.removeAttribute("visibility-while-frozen"),this.el.parentNode.setAttribute("visible",!1)},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("camera-focus-button",{schema:{track:{default:!1},selector:{default:null}},init(){this.cameraSystem=this.el.sceneEl.systems["camera-tools"],NAF.utils.getNetworkedEntity(this.el).then(e=>{this.data.selector?this.targetEl=e.querySelector(this.data.selector):this.targetEl=e}),this.onClick=()=>{const e=this.cameraSystem.getMyCamera();e&&e.components["camera-tool"].focus(this.targetEl,this.data.track)},this.menuPlacementRoots=Object(ft.b)(this.el,"position-at-border")},tick(){const e=this.el.object3D.visible,t=!(!this.cameraSystem||!this.cameraSystem.getMyCamera());if(e!==t){this.el.setAttribute("visible",t);for(let e=0;e<this.menuPlacementRoots.length;e++)this.menuPlacementRoots[e].markDirty()}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("unmute-video-button",{init(){this.onClick=()=>{const e=Object(ft.a)(this.el,"media-video").components["media-video"];e&&e.video&&e.videoMutedAt&&(performance.now()-e.videoMutedAt<3e3||e.video.muted&&(e.video.muted=!1,this.el.setAttribute("visible",!1)))}},play(){document.addEventListener("touchstart",this.onClick)},pause(){document.removeEventListener("touchstart",this.onClick)}}),AFRAME.registerComponent("destroy-at-extreme-distances",{schema:{xMin:{default:-1e3},xMax:{default:1e3},yMin:{default:-1e3},yMax:{default:1e3},zMin:{default:-1e3},zMax:{default:1e3}},init(){this._checkForDestroy=this._checkForDestroy.bind(this),this.el.sceneEl.systems["frame-scheduler"].schedule(this._checkForDestroy,"media-components")},remove(){this.el.sceneEl.systems["frame-scheduler"].unschedule(this._checkForDestroy,"media-components")},_checkForDestroy:function(){const e=new THREE.Vector3;return function(){const{xMin:t,xMax:n,yMin:a,yMax:i,zMin:r,zMax:o}=this.data;Object(lt.j)(this.el.object3D,e),(e.x<t||e.x>n||e.y<a||e.y>i||e.z<r||e.z>o)&&(this.el.components.networked&&!NAF.utils.isMine(this.el)||this.el.parentNode.removeChild(this.el))}}()});n(1335);var ea=n(181),ta=n(80),na=n(171),aa=n(783),ia=n.n(aa);function ra(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function oa(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){ra(r,a,i,o,s,"next",e)}function s(e){ra(r,a,i,o,s,"throw",e)}o(void 0)}))}}const{detect:sa}=n(93),la="firefox"===sa().name,ca=Object(Ue.b)().then(()=>Object(na.b)(ia.a)),da={"player-right-controller":{takeSnapshot:Xe.a.actions.rightHand.takeSnapshot},"player-left-controller":{takeSnapshot:Xe.a.actions.leftHand.takeSnapshot},"right-cursor":{takeSnapshot:Xe.a.actions.cursor.right.takeSnapshot},"left-cursor":{takeSnapshot:Xe.a.actions.cursor.left.takeSnapshot}},ua=AFRAME.utils.device.isMobileVR(),ha=["h264","vp9,opus","vp8,opus","vp9","vp8"].find(e=>window.MediaRecorder&&MediaRecorder.isTypeSupported("video/webm; codecs=".concat(e))),pa=ha?"video/webm; codecs=".concat(ha):null,ma=!!document.createElement("canvas").getContext("webgl2"),fa=!!pa&&ma,ga=navigator.userAgent.match(/Oculus/),va=ua&&!ga?640:1280,ba=ua&&!ga?360:720,ya=[3,7,15,30,60,1/0],Ea=document.createElement("canvas");function wa(){return(wa=oa((function*(e,t,n){Ea.width=t,Ea.height=n;const a=Ea.getContext("2d"),i=a.createImageData(t,n);i.data.set(e);const r=yield Object(ea.a)(i);a.scale(1,-1),a.drawImage(r,0,-n);const o=yield new Promise(e=>Ea.toBlob(e));return new File([o],"snap.png",{type:"image/png"})}))).apply(this,arguments)}AFRAME.registerComponent("camera-tool",{schema:{captureDuration:{default:7},captureAudio:{default:!1},isSnapping:{default:!1},isRecording:{default:!1},label:{default:""}},init(){this.el.object3D.visible=!1,this.lastUpdate=performance.now(),this.localSnapCount=0,this.showCameraViewfinder=!ua,this.renderTarget=new THREE.WebGLRenderTarget(1280,720,{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.GammaEncoding,depth:!1,stencil:!1}),this.camera=new THREE.PerspectiveCamera(50,1280/720,.1,3e4),this.camera.layers.enable(ct.a.CAMERA_LAYER_VIDEO_TEXTURE_TARGET),this.camera.layers.enable(ct.a.CAMERA_LAYER_THIRD_PERSON_ONLY),this.camera.rotation.set(0,Math.PI,0),this.camera.position.set(0,0,.05),this.camera.matrixNeedsUpdate=!0,this.el.setObject3D("camera",this.camera);const e=new THREE.MeshBasicMaterial({map:this.renderTarget.texture});e.toneMapped=!1,e.map.isVideoTexture=!0,e.map.update=()=>{this.showCameraViewfinder&&(this.viewfinderInViewThisFrame=!0)},this.el.sceneEl.addEventListener("stateadded",()=>this.updateUI()),this.el.sceneEl.addEventListener("stateremoved",()=>this.updateUI()),ca.then(t=>{const n=Object(lt.e)(t.scene);n.scale.set(2,2,2),n.matrixNeedsUpdate=!0,this.el.setObject3D("mesh",n),this.el.object3D.visible=!0,this.el.object3D.scale.set(.5,.5,.5),this.el.object3D.matrixNeedsUpdate=!0;const a=this.el.object3D,i=function(){const e={};return function(t){const n=t.animatables[0].target;n.x=Math.max(Number.MIN_VALUE,n.x),n.y=Math.max(Number.MIN_VALUE,n.y),n.z=Math.max(Number.MIN_VALUE,n.z),n.x===e.x&&n.y===e.y&&n.z===e.z||(e.x=n.x,e.y=n.y,e.z=n.z,a.scale.set(n.x,n.y,n.z),a.matrixNeedsUpdate=!0)}}(),r={duration:200,easing:"easeOutQuad",elasticity:400,loop:0,round:!1,x:1,y:1,z:1,targets:[{x:.5,y:.5,z:.5}],update:e=>i(e),complete:e=>i(e)};Object(ut.default)(r);const o=new THREE.PlaneBufferGeometry(.28,.28/this.camera.aspect);this.screen=new THREE.Mesh(o,e),this.screen.rotation.set(0,Math.PI,0),this.screen.position.set(0,0,-.042),this.screen.matrixNeedsUpdate=!0,this.el.setObject3D("screen",this.screen),this.selfieScreen=new THREE.Mesh(o,e),this.selfieScreen.position.set(0,.4,0),this.selfieScreen.scale.set(-2,2,2),this.selfieScreen.matrixNeedsUpdate=!0,this.el.setObject3D("selfieScreen",this.selfieScreen),this.label=this.el.querySelector(".label"),this.labelActionBackground=this.el.querySelector(".label-action-background"),this.labelBackground=this.el.querySelector(".label-background"),this.durationLabel=this.el.querySelector(".duration"),this.recordIcon=this.el.querySelector(".record-icon"),this.recordAlphaIcon=this.el.querySelector(".record-alpha-icon"),this.label.object3D.visible=!1,this.durationLabel.object3D.visible=!1,this.snapMenu=this.el.querySelector(".camera-snap-menu"),this.snapButton=this.el.querySelector(".snap-button"),this.recordButton=this.el.querySelector(".record-button"),this.cancelButton=this.el.querySelector(".cancel-button"),this.nextDurationButton=this.el.querySelector(".next-duration"),this.prevDurationButton=this.el.querySelector(".prev-duration"),this.snapButton.object3D.addEventListener("interact",()=>this.snapClicked(!0)),this.recordButton.object3D.addEventListener("interact",()=>this.snapClicked(!1)),this.cancelButton.object3D.addEventListener("interact",()=>this.cancelSnapping()),this.nextDurationButton.object3D.addEventListener("interact",()=>this.changeDuration(1)),this.prevDurationButton.object3D.addEventListener("interact",()=>this.changeDuration(-1)),this.stopButton=this.el.querySelector(".stop-button"),this.stopButton.object3D.addEventListener("interact",()=>this.stopRecording()),this.captureAudioButton=this.el.querySelector(".capture-audio"),this.captureAudioIcon=this.el.querySelector(".capture-audio-icon"),this.captureAudioButton.object3D.addEventListener("interact",()=>this.el.setAttribute("camera-tool","captureAudio",!this.data.captureAudio)),this.updateUI(),this.updateRenderTargetNextTick=!0,this.cameraSystem=this.el.sceneEl.systems["camera-tools"],this.cameraSystem.register(this.el),Object(Ue.b)().then(()=>{this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")})})},remove(){this.cameraSystem.deregister(this.el),this.stopRecording()},updateViewfinder(){this.updateRenderTargetNextTick=!0},changeDuration(e){const t=ya.findIndex(e=>this.data.captureDuration==e),n=0===t&&-1===e?ya.length-1:(t+e)%ya.length;this.el.setAttribute("camera-tool","captureDuration",ya[n])},focus(e,t){this.trackTarget=t?e:null,this.lookAt(e)},lookAt:function(){const e=new THREE.Vector3;return function(t){e.setFromMatrixPosition(t.object3D.matrixWorld),this.el.object3D.lookAt(e),this.el.object3D.matrixNeedsUpdate=!0}}(),snapClicked(e){var t=this;this.data.isSnapping||(NAF.utils.isMine(this.el)||NAF.utils.takeOwnership(this.el))&&(this.el.setAttribute("camera-tool","isSnapping",!0),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.a),this.snapCountdown=3,this.el.setAttribute("camera-tool","label","".concat(this.snapCountdown)),this.countdownInterval=setInterval(oa((function*(){if(!NAF.utils.isMine(t.el)&&!NAF.utils.takeOwnership(t.el))return clearInterval(t.countdownInterval),void(t.countdownInterval=null);t.snapCountdown--,0===t.snapCountdown?(clearInterval(t.countdownInterval),t.countdownInterval=null,e?(t.el.setAttribute("camera-tool",{label:"",isSnapping:!1}),t.takeSnapshotNextTick=!0):t.beginRecording(t.data.captureDuration)):(t.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.a),t.el.setAttribute("camera-tool","label","".concat(t.snapCountdown)))})),1e3))},cancelSnapping(){clearInterval(this.countdownInterval),this.stopRecording(!0),this.updateUI()},update(){this.updateUI()},updateUI(){if(!this.label)return;const e=this.data.label,t=this.el.sceneEl.is("frozen"),n=this.data.captureDuration!==1/0,a=!n&&this.data.isRecording&&this.videoRecorder;this.label.object3D.visible=!!e&&!a;const i=this.label.object3D.visible&&this.data.isRecording&&!a;this.label.setAttribute("text",{value:e,color:i?"#fafafa":"#ff3464"}),this.labelActionBackground.object3D.visible=i,this.labelBackground.object3D.visible=this.label.object3D.visible&&!i,this.stopButton.object3D.visible=a,n&&this.durationLabel.setAttribute("text","value","".concat(this.data.captureDuration)),this.durationLabel.object3D.visible=n&&!this.data.isSnapping&&!t&&fa,this.recordIcon.object3D.visible=!n&&!t&&fa,this.recordAlphaIcon.object3D.visible=n&&!t&&fa,this.snapButton.object3D.visible=!this.data.isSnapping&&!t,this.recordButton.object3D.visible=!this.data.isSnapping&&!t&&fa,this.cancelButton.object3D.visible=this.data.isSnapping&&!t,this.prevDurationButton.object3D.visible=this.nextDurationButton.object3D.visible=!this.data.isSnapping&&fa&&!t&&fa,this.captureAudioIcon.setAttribute("icon-button","active",this.data.captureAudio)},beginRecording(e){var t=this;return oa((function*(){t.videoContext||(t.videoCanvas=document.createElement("canvas"),t.videoCanvas.width=va,t.videoCanvas.height=ba,t.videoContext=t.videoCanvas.getContext("2d"),t.videoImageData=t.videoContext.createImageData(va,ba),t.videoPixels=new Uint8Array(va*ba*4),t.videoImageData.data.set(t.videoPixels));const n=new MediaStream,a=t.videoCanvas.captureStream(25).getVideoTracks()[0],i=()=>{if(la){const e=THREE.AudioContext.getContext(),t=e.createOscillator(),a=e.createGain(),i=e.createMediaStreamDestination();a.gain.setValueAtTime(1e-4,e.currentTime),t.connect(i),a.connect(i),n.addTrack(i.stream.getAudioTracks()[0])}};if(t.data.captureAudio){const e=yield APP.dialog.getMediaStream(NAF.clientId,"audio");if(e&&e.getAudioTracks().length>0){const a=THREE.AudioContext.getContext(),i=a.createMediaStreamDestination(),r=t.el.sceneEl.audioListener;r&&r.getInput().connect(i),a.createMediaStreamSource(e).connect(i);const o=i.stream.getAudioTracks()[0];n.addTrack(o)}else i()}else i();n.addTrack(a),t.videoRecorder=new MediaRecorder(n,{mimeType:pa});const r=[],o=performance.now();t.videoRecorder.ondataavailable=e=>r.push(e.data),t.updateRenderTargetNextTick=!0,t.videoRecorder.start(),t.el.setAttribute("camera-tool",{isRecording:!0,label:" "}),t.el.sceneEl.emit("action_camera_recording_started"),e!==1/0&&(t.videoCountdown=t.data.captureDuration,t.el.setAttribute("camera-tool","label","".concat(t.videoCountdown)),t.videoCountdownInterval=setInterval(()=>{t.videoCountdown--,0===t.videoCountdown?(t.stopRecording(),t.videoCountdownInterval=null):t.el.setAttribute("camera-tool","label","".concat(t.videoCountdown))},1e3)),t.videoRecorder._free=()=>r.length=0,t.videoRecorder.onstop=oa((function*(){if(t.el.sceneEl.emit("action_camera_recording_ended"),0===r.length)return;const e=r[0].type,n=performance.now()-o,a=new Blob(r,{type:e});r.length=0;const{entity:i,orientation:s}=Object(te.b)(t.el,new File([a],"capture",{type:e.split(";")[0]}),"video-camera",t.localSnapCount,!!t.playerIsBehindCamera);i.addEventListener("video-loaded",()=>{(t.data.captureAudio||n<=31e3)&&setTimeout(()=>{(NAF.utils.isMine(i)||NAF.utils.takeOwnership(i))&&i.components["media-video"].tryUpdateVideoPlaybackState(!0)},t.data.captureAudio?0:3*n+100)},{once:!0}),t.localSnapCount++,s.then(()=>t.el.sceneEl.emit("object_spawned",{objectType:ta.b.CAMERA}))}))}))()},stopRecording(e){this.videoRecorder&&(e&&(this.videoRecorder.onstop=()=>{},this.videoRecorder._free(),this.el.sceneEl.emit("action_camera_recording_ended")),this.videoRecorder.stop(),this.videoRecorder=null,e||this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.b)),clearInterval(this.videoCountdownInterval),this.videoCountdownInterval=null,this.el.setAttribute("camera-tool",{label:" ",isRecording:!1,isSnapping:!1})},tick(){const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput,n=e.state.leftHand.held===this.el,a=e.state.rightHand.held===this.el,i=e.state.rightRemote.held===this.el,r=n&&t.get(e.options.leftHand.grabPath)||a&&t.get(e.options.rightHand.grabPath)||i&&t.get(e.options.rightRemote.grabPath),o=n||a||i;this.updateSnapMenuOrientation(),r&&(this.localSnapCount=0),this.showCameraViewfinder=o||!ua||this.data.isSnapping||this.videoRecorder,this.screen&&this.selfieScreen&&(this.screen.visible=this.selfieScreen.visible=!!this.showCameraViewfinder),(o||this.data.isSnapping||this.videoRecorder)&&performance.now()-this.lastUpdate>=1e3/(this.videoRecorder?25:6)&&(this.updateRenderTargetNextTick=!0);const s=this.isHoldingSnapshotTrigger();window.APP.hubChannel.can("spawn_camera")&&(!s||this.data.isSnapping||this.snapTriggerTimeout?s||this.data.isSnapping||!this.snapTriggerTimeout||(clearTimeout(this.snapTriggerTimeout),this.snapTriggerTimeout=null,this.takeSnapshotNextTick=!0):this.snapTriggerTimeout=setTimeout(()=>{if(this.isHoldingSnapshotTrigger()){this.el.setAttribute("camera-tool","isSnapping",!0),this.beginRecording(1/0);const e=setInterval(()=>{this.isHoldingSnapshotTrigger()||(this.stopRecording(),clearInterval(e))},500)}this.snapTriggerTimeout=null},500))},tock:function(){const e=this.el.sceneEl,t=this.renderer||e.renderer,n=performance.now();if(this.trackTarget&&(this.trackTarget.parentNode?(this.lookAt(this.trackTarget),this.object3D.updateMatrixWorld()):this.trackTarget=null),!this.playerHud){const e=document.getElementById("player-hud");this.playerHud=e&&e.object3D}if(this.takeSnapshotNextTick||this.updateRenderTargetNextTick&&(this.viewfinderInViewThisFrame||this.videoRecorder)){let a=!1;if(this.playerHud&&(a=this.playerHud.visible,this.playerHud.visible=!1,this.el.sceneEl.systems["hubs-systems"]))for(const e of Object.values(this.el.sceneEl.systems["hubs-systems"].spriteSystem.meshes))e.visible=!1;const i=this.el.sceneEl.systems["personal-space-bubble"],r=this.el.sceneEl.systems["hubs-systems"].boneVisibilitySystem;if(i){for(let e=0,t=i.invaders.length;e<t;e++)i.invaders[e].disable();r.tick(),r.updateMatrices()}const o=t.xr.enabled,s=e.object3D.onAfterRender,l=e.object3D.autoUpdate;if(delete e.object3D.onAfterRender,t.xr.enabled=!1,e.object3D.autoUpdate=!1,fa&&this.videoRecorder&&!this.videoRenderTarget&&(this.videoRenderTarget=new THREE.WebGLRenderTarget(va,ba,{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.sRGBEncoding,depth:!1,stencil:!1}),t.setRenderTarget(this.videoRenderTarget)),t.setRenderTarget(this.renderTarget),t.render(e.object3D,this.camera),t.setRenderTarget(null),t.xr.enabled=o,e.object3D.onAfterRender=s,e.object3D.autoUpdate=l,this.playerHud&&(this.playerHud.visible=a,this.el.sceneEl.systems["hubs-systems"]))for(const e of Object.values(this.el.sceneEl.systems["hubs-systems"].spriteSystem.meshes))e.visible=!0;if(i){for(let e=0,t=i.invaders.length;e<t;e++)i.invaders[e].enable();r.tick(),r.updateMatrices()}this.lastUpdate=n,this.videoRecorder&&(ga||function(e,t,n,a,i,r,o,s,l,c,d){const u=e.getContext(),h=e.properties.get(t).__webglFramebuffer,p=e.properties.get(o).__webglFramebuffer;h&&p&&(u.bindFramebuffer(u.READ_FRAMEBUFFER,h),u.bindFramebuffer(u.DRAW_FRAMEBUFFER,p),u.checkFramebufferStatus(u.READ_FRAMEBUFFER)===u.FRAMEBUFFER_COMPLETE&&u.blitFramebuffer(n,a,i,r,s,l,c,d,u.COLOR_BUFFER_BIT,u.LINEAR))}(t,this.renderTarget,0,0,1280,720,this.videoRenderTarget,0,ba,va,0),t.readRenderTargetPixels(ga?this.renderTarget:this.videoRenderTarget,0,0,va,ba,this.videoPixels),ga&&this.flipPixelsY(this.videoPixels,va,ba),this.videoImageData.data.set(this.videoPixels),this.videoContext.putImageData(this.videoImageData,0,0)),this.updateRenderTargetNextTick=!1,this.viewfinderInViewThisFrame=!1}this.takeSnapshotNextTick&&(this.snapPixels||(this.snapPixels=new Uint8Array(3686400)),t.readRenderTargetPixels(this.renderTarget,0,0,1280,720,this.snapPixels),function(e,t,n){return wa.apply(this,arguments)}(this.snapPixels,1280,720).then(e=>{const{orientation:t}=Object(te.b)(this.el,e,"photo-camera",this.localSnapCount,!!this.playerIsBehindCamera);t.then(()=>{this.el.sceneEl.emit("object_spawned",{objectType:ta.b.CAMERA})})}),e.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.b),this.takeSnapshotNextTick=!1,this.localSnapCount++)},flipPixelsY(e,t,n){const a=n/2|0,i=4*t,r=new Uint8Array(4*t);for(let t=0;t<a;++t){const a=t*i,o=(n-t-1)*i;r.set(e.subarray(a,a+i)),e.copyWithin(a,o,o+i),e.set(r,o)}},isHoldingSnapshotTrigger:function(){const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput,n=e.state.leftHand.held===this.el,a=e.state.rightHand.held===this.el,i=e.state.rightRemote.held===this.el,r=e.state.leftRemote.held===this.el;let o;if(a?o="player-right-controller":n?o="player-left-controller":i?o="right-cursor":r&&(o="left-cursor"),o){const e=da[o];if(t.get(e.takeSnapshot))return!0}return!!t.get(Xe.a.actions.takeSnapshot)},updateSnapMenuOrientation:function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3;return function(){if(!this.playerCamera)return;this.el.object3D.getWorldPosition(t),this.playerCamera.getWorldPosition(e),n.subVectors(e,t),a.set(0,0,1),this.el.object3D.localToWorld(a),i.subVectors(a,t),i.normalize(),n.normalize();const r=i.dot(n)<0;this.playerIsBehindCamera!==r&&(this.playerIsBehindCamera=r,this.snapMenu.object3D.rotation.set(0,this.playerIsBehindCamera?Math.PI:0,0),this.snapMenu.object3D.matrixNeedsUpdate=!0)}}()});n(1336),n(1337),n(1338),n(1339),n(1340);AFRAME.registerComponent("clone-media-button",{init(){this.updateSrc=()=>{if(!this.targetEl.parentNode)return;const e=this.src=this.targetEl.components["media-loader"].data.src,t=e&&"video/vnd.hubs-webrtc"!==Object(Ut.c)(e);this.el.object3D.visible=!!t},NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()}),this.onClick=()=>{const{entity:e}=Object(te.e)(this.targetEl,"#interactable-media",this.src);e.object3D.scale.copy(this.targetEl.object3D.scale),e.object3D.matrixNeedsUpdate=!0,e.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-1.5*this.targetEl.object3D.scale.z}})}},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});var _a=n(174),Sa=n(98),xa=n.n(Sa);function Aa(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Ma(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Aa(r,a,i,o,s,"next",e)}function s(e){Aa(r,a,i,o,s,"throw",e)}o(void 0)}))}}let ka=!1,Oa=null;const Ca=AFRAME.utils.device.isMobileVR(),Pa=()=>new Promise(e=>{const t=document.querySelector("a-scene");t.addEventListener("2d-interstitial-gesture-complete",e,{once:!0}),t.emit("2d-interstitial-gesture-required")});function Ra(e,t,n){return Ta.apply(this,arguments)}function Ta(){return(Ta=Ma((function*(e,t,n){const a=document.querySelector("a-scene");if(a.is("vr-mode"))if(ka=!0,Oa=t,Ca)yield a.exitVR(),n||(yield Pa(),yield Object(_a.a)());else{const t=document.querySelector(".vr-notice");t.object3D.visible=!0,t.setAttribute("follow-in-fov",{angle:e?39:-15})}else Ca&&Object(_a.c)()&&(yield Pa(),yield Object(_a.a)())}))).apply(this,arguments)}function ja(e){return Da.apply(this,arguments)}function Da(){return(Da=Ma((function*(e){if(!e&&!ka)return;ka=!1,document.querySelector(".vr-notice").object3D.visible=!1;const t=document.querySelector("a-scene");Ca?xa.a.isFullscreen?(yield xa.a.exit(),yield Pa(),yield t.enterVR()):yield t.enterVR():t.is("vr-mode")||(yield t.enterVR())}))).apply(this,arguments)}function Ia(){return ka}function La(){return(La=Ma((function*(){ka&&(Oa&&(Oa(),Oa=null),yield ja())}))).apply(this,arguments)}function Ha(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Na(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Ha(r,a,i,o,s,"next",e)}function s(e){Ha(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Fa(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Va(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Fa(r,a,i,o,s,"next",e)}function s(e){Fa(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Ba(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Ua(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Ba(r,a,i,o,s,"next",e)}function s(e){Ba(r,a,i,o,s,"throw",e)}o(void 0)}))}}AFRAME.registerComponent("open-media-button",{schema:{onlyOpenLink:{type:"boolean"}},init(){var e=this;this.label=this.el.querySelector("[text]"),this.updateSrc=Na((function*(){if(!e.targetEl.parentNode)return;const t=e.targetEl.components["media-loader"].data,n=e.src=t.mediaOptions&&t.mediaOptions.href||t.src,a=n&&"video/vnd.hubs-webrtc"!==Object(Ut.c)(n),i=e.el.sceneEl.systems.permissions.canOrWillIfCreator("update_hub");if(e.el.object3D.visible=!!a,a){let t="open link";if(!e.data.onlyOpenLink){let e;if(yield Object(Ut.f)(n))t="use avatar";else if((yield Object(Ut.g)(n))&&i)t="use scene";else if(e=yield Object(Ut.e)(n)){t=new URL(n).hash&&window.APP.hub.hub_id===e?"go to":"visit room"}}e.label.setAttribute("text","value",t)}})),this.onClick=Na((function*(){const t=e.el.sceneEl.systems.permissions.canOrWillIfCreator("update_hub"),n=function(){var e=Na((function*(){return yield Ra(!1,()=>{},!0)}));return function(){return e.apply(this,arguments)}}();let a;if(e.data.onlyOpenLink)yield n(),window.open(e.src);else if(yield Object(Ut.f)(e.src)){const t=new URL(e.src).pathname.split("/").pop();window.APP.store.update({profile:{avatarId:t}}),e.el.sceneEl.emit("avatar_updated")}else if((yield Object(Ut.g)(e.src))&&t)e.el.sceneEl.emit("scene_media_selected",e.src);else if(a=yield Object(Ut.e)(e.src)){const t=new URL(e.src);t.hash&&window.APP.hub.hub_id===a?window.history.replaceState(null,null,window.location.href.split("#")[0]+t.hash):APP.store.state.preferences.fastRoomSwitching&&Object(Ut.h)(e.src)?K(a):(yield n(),location.href=e.src)}else yield n(),window.open(e.src)})),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("local-refresh-media-button",{init(){var e=this;this.onClick=Va((function*(){if(e.targetEl){const t=e.targetEl.components;t["media-video"]&&t["media-video"].videoTexture&&t["media-video"].videoTexture.hls?t["media-video"].videoTexture.hls.recoverMediaError():t["media-loader"]&&t["media-loader"].update(t["media-loader"].data,!0)}})),NAF.utils.getNetworkedEntity(this.el).then(e=>this.targetEl=e).catch(()=>this.el.parentNode.removeChild(this.el))},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}}),AFRAME.registerComponent("refresh-media-button",{init(){var e=this;this.updateVisibility=this.updateVisibility.bind(this),this.onClick=Va((function*(){const t=e.el.sceneEl.systems["hubs-systems"].soundEffectsSystem;if(e.targetEl){e.targetEl.components["media-loader"].refresh(),e.el.object3D.visible=!1;const n=t.playPositionalSoundFollowing(Q.h,e.targetEl.object3D,!0);e.targetEl.addEventListener("media_refreshed",()=>{t.stopPositionalAudio(n),e.el.object3D.visible=!0,e.updateVisibility()},{once:!0})}})),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,window.APP.hubChannel.addEventListener("permissions_updated",this.updateVisibility),this.targetEl&&(this.targetEl.addEventListener("pinned",this.updateVisibility),this.targetEl.addEventListener("unpinned",this.updateVisibility)),this.updateVisibility()})},updateVisibility(){if(!this.targetEl)return;const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned;this.el.object3D.visible=!e&&window.APP.hubChannel.can("spawn_and_move_media")||window.APP.hubChannel.can("pin_objects")},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},remove(){window.APP.hubChannel.removeEventListener("permissions_updated",this.updateVisibility),this.targetEl&&(this.targetEl.removeEventListener("pinned",this.updateVisibility),this.targetEl.removeEventListener("unpinned",this.updateVisibility))}}),AFRAME.registerComponent("tweet-media-button",{init(){NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}).catch(()=>{this.el.object3D.visible=!1}),this.onClick=()=>{const e="Taken in ".concat(location.hostname," "),{src:t,contentSubtype:n}=this.targetEl.components["media-loader"].data;this.el.sceneEl.emit("action_media_tweet",{mediaUrl:t,contentSubtype:n,initialTweet:e})}},play(){a.a.integration("twitter")?this.el.object3D.addEventListener("interact",this.onClick):this.el.object3D.visible=!1},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});AFRAME.registerComponent("remix-avatar-button",{init(){var e=this;this.label=this.el.querySelector("[text]"),this.label.setAttribute("text","value","save avatar"),this.updateSrc=Ua((function*(){e.src=e.targetEl.components["media-loader"].data.src;try{e.avatar=yield Object(it.d)(Object(Ut.d)(e.src)),e.el.object3D.visible=e.avatar&&e.avatar.allow_remixing&&"avatar_listing"===e.avatar.type}catch(t){console.error(t),e.el.object3D.visible=!1}})),this.onClick=Ua((function*(){if(!e.copying&&e.avatar){try{e.copying=!0,e.label.setAttribute("text","value","Saving..."),yield Object(it.h)(e.avatar.avatar_id,e.avatar.name),e.label.setAttribute("text","value","Saved!")}catch(t){e.label.setAttribute("text","value","Error")}setTimeout(()=>{e.label.setAttribute("text","value","save avatar"),e.copying=!1},2e3)}})),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this.targetEl.addEventListener("media_resolved",this.updateSrc,{once:!0}),this.updateSrc()})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)}});const za={type:"kinematic",collisionFilterMask:n(209).COLLISION_LAYERS.HANDS},Wa={AXIS:"axis",PUPPET:"puppet",CURSOR:"cursor",ALIGN:"align",SCALE:"scale"},qa=Math.PI/10,Ga=new THREE.Quaternion,Ya=new THREE.Vector3,Ka=new THREE.Quaternion,Xa=new THREE.Vector3,Qa=new THREE.Vector3,Ja=new THREE.Quaternion,Za=new THREE.Quaternion;AFRAME.registerComponent("transform-button",{schema:{mode:{type:"string",oneof:Object.values(Wa),default:Wa.CURSOR},axis:{type:"vec3",default:null}},init(){let e,t;NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e}),Object(Ue.b)().then(()=>{e=document.getElementById("player-left-controller"),t=document.getElementById("player-right-controller")}),this.onGrabStart=n=>{e&&t&&this.targetEl&&(NAF.utils.isMine(this.targetEl)||NAF.utils.takeOwnership(this.targetEl))&&(this.targetEl.body&&this.targetEl.setAttribute("body-helper",za),this.transformSystem=this.transformSystem||AFRAME.scenes[0].systems["transform-selected-object"],this.transformSystem.startTransform(this.targetEl.object3D,"right-cursor"===n.object3D.el.id?t.object3D:"left-cursor"===n.object3D.el.id?e.object3D:n.object3D,this.data))},this.onGrabEnd=()=>{this.transformSystem=this.transformSystem||AFRAME.scenes[0].systems["transform-selected-object"],this.transformSystem.stopTransform()}},play(){this.el.object3D.addEventListener("interact",this.onGrabStart),this.el.object3D.addEventListener("holdable-button-down",this.onGrabStart),this.el.object3D.addEventListener("holdable-button-up",this.onGrabEnd)},pause(){this.el.object3D.removeEventListener("interact",this.onGrabStart),this.el.object3D.removeEventListener("holdable-button-down",this.onGrabStart),this.el.object3D.removeEventListener("holdable-button-up",this.onGrabEnd)}}),AFRAME.registerSystem("transform-selected-object",{init(){this.target=null,this.mode=null,this.transforming=!1,this.axis=new THREE.Vector3,this.store=window.APP.store,this.startQ=new THREE.Quaternion,this.dxStore=0,this.dxApplied=0,this.dyAll=0,this.dyStore=0,this.dyApplied=0,this.raycasters={},this.puppet={initialControllerOrientation:new THREE.Quaternion,initialControllerOrientation_inverse:new THREE.Quaternion,initialObjectOrientation:new THREE.Quaternion,currentControllerOrientation:new THREE.Quaternion,controllerOrientationDelta:new THREE.Quaternion},this.planarInfo={plane:new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!1,wireframe:!0,side:THREE.DoubleSide,transparent:!0,opacity:.3})),normal:new THREE.Vector3,intersections:[],previousPointOnPlane:new THREE.Vector3,currentPointOnPlane:new THREE.Vector3,deltaOnPlane:new THREE.Vector3,finalProjectedVec:new THREE.Vector3},this.el.object3D.add(this.planarInfo.plane)},stopTransform:function(){const e=new THREE.Quaternion,t=new THREE.Quaternion(0,1,0,0),n=new THREE.Quaternion;return function(){var a,i;this.transforming=!1,this.mode===Wa.CURSOR&&(this.target.getWorldQuaternion(e),a=e,i=this.startQ,Math.abs(a.x-i.x)<.001&&Math.abs(a.y-i.y)<.001&&Math.abs(a.z-i.z)<.001&&Math.abs(a.w-i.w)<.001&&(e.multiply(t),this.target.parent.getWorldQuaternion(n),n.invert(),this.target.quaternion.copy(n).multiply(e),this.target.matrixNeedsUpdate=!0))}}(),startPlaneCasting(){const{plane:e,intersections:t,previousPointOnPlane:n}=this.planarInfo;this.el.camera.getWorldQuaternion(Ga),e.quaternion.copy(Ga),this.target.getWorldPosition(e.position),e.matrixNeedsUpdate=!0,e.updateMatrixWorld(!0),t.length=0,this.raycasters.right=this.raycasters.right||document.getElementById("right-cursor-controller").components["cursor-controller"].raycaster,this.raycasters.left=this.raycasters.left||document.getElementById("left-cursor-controller").components["cursor-controller"].raycaster;const a="player-left-controller"===this.hand.el.id?this.raycasters.left:this.raycasters.right,i=a.far;a.far=1e3,e.raycast(a,t),a.far=i,this.transforming=!!t[0],this.transforming&&(n.copy(t[0].point),this.target.getWorldQuaternion(Ka),Xa.set(0,0,-1).applyQuaternion(Ga),Qa.set(0,0,-1).applyQuaternion(Ka),this.sign=Xa.dot(Qa)>0?1:-1,Xa.set(0,1,0),Qa.set(0,1,0).applyQuaternion(Ka),this.sign2=Xa.dot(Qa)>0?1:-1,this.dyAll=0,this.dyStore=0,this.dyApplied=0,this.dxAll=0,this.dxStore=0,this.dxApplied=0)},startTransform(e,t,n){if(this.target=e,this.hand=t,this.mode=n.mode,this.transforming=!0,this.mode!==Wa.ALIGN){if(this.store.update({activity:{hasRotated:!0}}),this.mode===Wa.CURSOR&&this.target.getWorldQuaternion(this.startQ),this.mode===Wa.PUPPET)return this.target.getWorldQuaternion(this.puppet.initialObjectOrientation),this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation),void this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).invert();this.mode===Wa.AXIS&&this.axis.copy(n.axis),this.startPlaneCasting()}else this.store.update({activity:{hasRecentered:!0}})},puppetingTick(){const{currentControllerOrientation:e,controllerOrientationDelta:t,initialControllerOrientation_inverse:n,initialObjectOrientation:a}=this.puppet;this.hand.getWorldQuaternion(e),t.copy(n).premultiply(e),this.target.quaternion.copy(a).premultiply(t).premultiply(t),this.target.matrixNeedsUpdate=!0},cursorAxisOrScaleTick(){const{plane:e,normal:t,intersections:n,previousPointOnPlane:a,currentPointOnPlane:i,deltaOnPlane:r,finalProjectedVec:o}=this.planarInfo;this.target.getWorldPosition(e.position),this.el.camera.getWorldPosition(Xa),e.matrixNeedsUpdate=!0;const s=Xa.sub(e.position).length();n.length=0;const l="player-left-controller"===this.hand.el.id?this.raycasters.left:this.raycasters.right,c=l.far;l.far=1e3,e.raycast(l,n),l.far=c;const d=n[0];if(!d)return;t.set(0,0,-1).applyQuaternion(e.quaternion),i.copy(d.point),r.copy(i).sub(a);if(o.copy(r).projectOnPlane(t).applyQuaternion(Ja.copy(e.quaternion).invert()).multiplyScalar(10/s),this.mode===Wa.CURSOR){const e=AFRAME.scenes[0].systems.userinput.get(Xe.a.actions.transformModifier);this.dyAll=this.dyStore+o.y,this.dyApplied=e?this.dyAll:Math.round(this.dyAll/qa)*qa,this.dyStore=this.dyAll-this.dyApplied,this.dxAll=this.dxStore+o.x,this.dxApplied=e?this.dxAll:Math.round(this.dxAll/qa)*qa,this.dxStore=this.dxAll-this.dxApplied,this.mode===Wa.CURSOR&&(this.target.getWorldQuaternion(Ka),Xa.set(1,0,0).applyQuaternion(e?Ga:Ka),Ja.setFromAxisAngle(Xa,e?-this.dyApplied:this.sign2*this.sign*-this.dyApplied),e?Xa.set(0,1,0).applyQuaternion(Ga):Xa.set(0,1,0),Za.setFromAxisAngle(Xa,this.dxApplied),this.target.quaternion.premultiply(Ja).premultiply(Za)),this.target.matrixNeedsUpdate=!0}else this.mode===Wa.AXIS&&(this.dxAll=this.dxStore+o.x,this.dxApplied=Math.round(this.dxAll/qa)*qa,this.dxStore=this.dxAll-this.dxApplied,this.target.quaternion.multiply(Ja.setFromAxisAngle(this.axis,-this.sign*this.dxApplied)),this.target.matrixNeedsUpdate=!0);a.copy(i)},tick(){if(this.transforming&&this.mode!==Wa.SCALE)return this.mode===Wa.ALIGN?(this.el.camera.getWorldPosition(Ya),this.target.lookAt(Ya),void(this.transforming=!1)):void(this.mode!==Wa.PUPPET?this.cursorAxisOrScaleTick():this.puppetingTick())}}),AFRAME.registerComponent("transform-button-selector",{tick(){this.userinput=this.userinput||this.el.sceneEl.systems.userinput;this.userinput.get(Xe.a.actions.rightHand.pose)||this.userinput.get(Xe.a.actions.leftHand.pose)?this.el.components["transform-button"].data.mode!==Wa.PUPPET&&this.el.setAttribute("transform-button","mode",Wa.PUPPET):this.el.components["transform-button"].data.mode!==Wa.CURSOR&&this.el.setAttribute("transform-button","mode",Wa.CURSOR)}});const $a=new THREE.Vector3(0,0,1),ei=2*Math.PI;AFRAME.registerComponent("visible-if-transforming",{schema:{hand:{type:"string"}},init(){},tick(e){const t=AFRAME.scenes[0].systems["transform-selected-object"].transforming&&-1!==AFRAME.scenes[0].systems["transform-selected-object"].hand.el.id.indexOf(this.data.hand);this.el.getAttribute("visible")!==t&&this.el.setAttribute("visible",AFRAME.scenes[0].systems["transform-selected-object"].transforming),t&&(this.el.object3D.quaternion.setFromAxisAngle($a,ei*Math.sin(e/1e3)),this.el.object3D.matrixNeedsUpdate=!0)}});const ti=function(){const e=new THREE.Matrix4,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3;return function(o,s){return o.updateMatrices(),r.setFromMatrixPosition(o.matrixWorld),s.updateMatrices(),i.setFromMatrixPosition(s.matrixWorld),n.subVectors(i,r),n.y=0,n.normalize(),t.set(0,1,0),a.crossVectors(n,t),e.makeBasis(a,t,n.multiplyScalar(-1)),e.elements[12]=i.x,e.elements[13]=i.y,e.elements[14]=i.z,e}}(),ni=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!0,wireframe:!1,side:THREE.DoubleSide,transparent:!0,opacity:.3})),ai=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,2,2),new THREE.MeshBasicMaterial({visible:!0,wireframe:!1,side:THREE.DoubleSide,transparent:!0,opacity:.3}));AFRAME.registerComponent("scale-button",{init(){this.isScaling=!1,this.planeRotation=new THREE.Matrix4,this.planeUp=new THREE.Vector3,this.planeRight=new THREE.Vector3,this.intersections=[],this.initialIntersectionPoint=new THREE.Vector3,this.intersectionPoint=new THREE.Vector3,this.initialObjectScale=new THREE.Vector3,this.desiredObjectScale=new THREE.Vector3,this.deltaScale=new THREE.Vector3,this.objectMatrix=new THREE.Matrix4,this.dragVector=new THREE.Vector3,this.currentObjectScale=new THREE.Vector3,NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.objectToScale=e.object3D});const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;this.startScaling=a=>{if(this.isScaling||!this.objectToScale)return;if(!NAF.utils.isMine(this.networkedEl)&&!NAF.utils.takeOwnership(this.networkedEl))return;this.didGetObjectReferences||(this.didGetObjectReferences=!0,this.leftEventer=document.getElementById("left-cursor").object3D,this.leftCursorController=document.getElementById("left-cursor-controller"),this.leftRaycaster=this.leftCursorController.components["cursor-controller"].raycaster,this.rightCursorController=document.getElementById("right-cursor-controller"),this.rightRaycaster=this.rightCursorController.components["cursor-controller"].raycaster,this.viewingCamera=document.getElementById("viewing-camera").object3DMap.camera),this.plane=a.object3D===this.leftEventer?ni:ai,Object(lt.n)(this.plane,ti(this.viewingCamera,this.el.object3D)),this.planeRotation.extractRotation(this.plane.matrixWorld),this.planeUp.set(0,1,0).applyMatrix4(this.planeRotation),this.planeRight.set(1,0,0).applyMatrix4(this.planeRotation),this.raycaster=a.object3D===this.leftEventer?this.leftRaycaster:this.rightRaycaster;const i=this.raycastOnPlane();i&&(this.isScaling=!0,this.initialIntersectionPoint.copy(i.point),this.objectToScale.updateMatrices(),this.initialObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld),this.initialDistanceToObject=n.subVectors(e.setFromMatrixPosition(this.viewingCamera.matrixWorld),t.setFromMatrixPosition(this.el.object3D.matrixWorld)).length(),window.APP.store.update({activity:{hasScaled:!0}}),this.transformSelectedObjectSystem=this.transformSelectedObjectSystem||this.el.sceneEl.systems["transform-selected-object"],this.transformSelectedObjectSystem.transforming=!0,this.transformSelectedObjectSystem.mode=Wa.SCALE,this.transformSelectedObjectSystem.target=this.objectToScale,this.transformSelectedObjectSystem.hand=a.object3D===this.leftEventer?this.leftCursorController.object3D:this.rightCursorController.object3D)},this.endScaling=e=>{this.isScaling&&(e.object3D===this.leftEventer&&this.raycaster===this.leftRaycaster||e.object3D!==this.leftEventer&&this.raycaster===this.rightRaycaster)&&(this.isScaling=!1,this.transformSelectedObjectSystem=this.transformSelectedObjectSystem||this.el.sceneEl.systems["transform-selected-object"],this.transformSelectedObjectSystem.transforming=!1)},this.el.object3D.addEventListener("holdable-button-down",this.startScaling),this.el.object3D.addEventListener("holdable-button-up",this.endScaling)},raycastOnPlane(){this.intersections.length=0;const e=this.raycaster.far;return this.raycaster.far=1e3,this.plane.raycast(this.raycaster,this.intersections),this.raycaster.far=e,this.intersections[0]},tick(){if(!this.isScaling)return;const e=this.raycastOnPlane();if(!e)return;this.intersectionPoint.copy(e.point),this.dragVector.subVectors(this.intersectionPoint,this.initialIntersectionPoint);const t=(this.dragVector.dot(this.planeUp)+this.dragVector.dot(this.planeRight))/this.initialDistanceToObject;let n=1;t>0?n=1+t:t<0&&(n=1/(1+Math.abs(t))),this.desiredObjectScale.copy(this.initialObjectScale).multiplyScalar(n),this.objectToScale.updateMatrices(),this.currentObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld),this.deltaScale.set(this.desiredObjectScale.x/this.currentObjectScale.x,this.desiredObjectScale.y/this.currentObjectScale.y,this.desiredObjectScale.z/this.currentObjectScale.z),this.objectMatrix.copy(this.objectToScale.matrixWorld),this.objectMatrix.scale(this.deltaScale),Object(lt.n)(this.objectToScale,this.objectMatrix)}});n(1341),n(1342);function ii(e){return e.map((function(e){return e.getObject3D("mesh")})).filter((function(e){return e}))}const ri=te.o.load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAQCAYAAADXnxW3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAADJJREFUeNpEx7ENgDAAAzArK0JA6f8X9oewlcWStU1wBGdwB08wgjeYm79jc2nbYH0DAC/+CORJxO5fAAAAAElFTkSuQmCC");const oi=new THREE.Vector3(0,1,0);class si extends THREE.Mesh{constructor(e,t){super(new THREE.BufferGeometry,new THREE.MeshBasicMaterial({side:THREE.DoubleSide,toneMapped:!1,transparent:!0})),this.setPoint=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;return function(i,r){let o=18*i;e.copy(r).add(this.direction),t.copy(r).sub(this.direction),n.set(0===i?e.x:this.vertices[o-3],0===i?e.y:this.vertices[o-2],0===i?e.z:this.vertices[o-1]),a.set(0===i?t.x:this.vertices[o-6],0===i?t.y:this.vertices[o-5],0===i?t.z:this.vertices[o-4]),this.vertices[o++]=e.x,this.vertices[o++]=e.y,this.vertices[o++]=e.z,this.vertices[o++]=n.x,this.vertices[o++]=n.y,this.vertices[o++]=n.z,this.vertices[o++]=a.x,this.vertices[o++]=a.y,this.vertices[o++]=a.z,this.vertices[o++]=a.x,this.vertices[o++]=a.y,this.vertices[o++]=a.z,this.vertices[o++]=t.x,this.vertices[o++]=t.y,this.vertices[o++]=t.z,this.vertices[o++]=e.x,this.vertices[o++]=e.y,this.vertices[o++]=e.z,this.geometry.attributes.position.needsUpdate=!0}}(),this.vertices=new Float32Array(3*e*6),this.width=t,this.geometry.setAttribute("position",new THREE.BufferAttribute(this.vertices,3).setUsage(THREE.DynamicDrawUsage)),this.frustumCulled=!1,this.direction=new THREE.Vector3,this.numPoints=e}setDirection(e){this.direction.copy(e).cross(oi).normalize().multiplyScalar(this.width/2)}setWidth(e){this.width=e}}function li(e,t,n,a){return a.x=e.x+t.x*n,a.y=e.y+t.y*n-4.9*n*n,a.z=e.z+t.z*n,a}const ci=function(){const e=new THREE.Vector3;return function(t,n,a,i,r,o,s){e.copy(n).sub(t);const l=e.length();i.far=l,i.set(t,e.normalize());const c=i.intersectObjects(a,!0);return!!(c.length>0&&function(e,t,n){const a=t.angleTo(e);return THREE.Math.RAD2DEG*a<=n}(c[0].face.normal,r,o))&&(s.copy(c[0].point),!0)}}(),di=new THREE.Vector3(0,0,-1),ui=new THREE.Vector3(0,1,0),hi=new THREE.Quaternion,pi=new THREE.Vector3,mi=new THREE.Vector3;let fi;AFRAME.registerComponent("teleporter",{schema:{start:{type:"string"},confirm:{type:"string"},speed:{default:12},collisionEntities:{default:""},hitCylinderColor:{type:"color",default:"#99ff99"},hitCylinderRadius:{default:.25,min:0},outerRadius:{default:.6,min:0},hitCylinderHeight:{default:.3,min:0}},init(){this.characterController=this.el.sceneEl.systems["hubs-systems"].characterController,this.isTeleporting=!1,this.rayCurve=new si(20,.025),this.rayCurve.visible=!1,this.el.sceneEl.object3D.add(this.rayCurve),this.p0=new THREE.Vector3,this.v0=new THREE.Vector3,this.parabola=Array.from(new Array(this.rayCurve.numPoints),()=>new THREE.Vector3),this.hit=!1,this.hitPoint=new THREE.Vector3,this.meshes=[],this.raycaster=new THREE.Raycaster,this.rigWorldPosition=new THREE.Vector3,this.newRigWorldPosition=new THREE.Vector3,this.teleportOriginWorldPosition=new THREE.Vector3,this.teleportEventDetail={oldPosition:this.rigWorldPosition,newPosition:this.newRigWorldPosition,hitPoint:this.hitPoint},this.prevHitHeight=0,this.direction=new THREE.Vector3,this.hitEntity=this.createHitEntity(),this.hitEntity.visible=!1,this.el.sceneEl.object3D.add(this.hitEntity),this.queryCollisionEntities()},queryCollisionEntities:function(){this.collisionEntities=[].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities)),this.meshes=ii(this.collisionEntities)},remove(){this.stopPlayingTeleportSound()},stopPlayingTeleportSound(){if(this.teleportingSound){this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.stopSoundNode(this.teleportingSound.source),this.teleportingSound=null}},tick(e,t){fi=fi||document.getElementById("ui-root");const n=this.el.sceneEl.is("entered"),a=!n&&fi&&fi.firstChild&&fi.firstChild.classList.contains("isGhost");if(!n&&!a)return;const i=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem,r=AFRAME.scenes[0].systems.userinput,{start:o,confirm:s,speed:l}=this.data,c=this.el.object3D;if(this.isTeleporting||!r.get(o)||this.characterController.isTeleportingDisabled||window.APP.store.state.preferences.disableTeleporter||(this.isTeleporting=!0,this.timeTeleporting=0,this.hit=!1,this.rayCurve.visible=!0,this.rayCurve.updateMatrixWorld(),this.rayCurve.material.opacity=.1,this.rayCurve.material.color.set(16711680),this.rayCurve.material.needsUpdate=!0,this.teleportingSound=i.playSoundLoopedWithGain(Q.u),this.teleportingSound&&(this.teleportingSound.gain.gain.value=.005)),!this.isTeleporting)return;if(this.teleportingSound&&(this.teleportingSound.gain.gain.value=Math.min(.025,this.teleportingSound.gain.gain.value+2e-5*t)),r.get(s)){if(this.hitEntity.visible=!1,this.isTeleporting=!1,this.rayCurve.visible=!1,this.teleportingSound&&this.stopPlayingTeleportSound(),!this.hit||this.timeTeleporting<400)return;return this.characterController.teleportTo(this.hitPoint),void i.playSoundOneShot(Q.t)}this.timeTeleporting+=t,c.updateMatrixWorld(),c.matrixWorld.decompose(this.p0,hi,pi),this.direction.copy(di).applyQuaternion(hi).normalize(),this.rayCurve.setDirection(this.direction),this.el.object3D.updateMatrices();const d=mi.setFromMatrixColumn(this.characterController.avatarPOV.object3D.matrixWorld,1).length();this.v0.copy(this.direction).multiplyScalar(l*Math.sqrt(d));let u=this.rayCurve.numPoints-1;this.hit=!1,this.parabola[0].copy(this.p0);const h=1/(this.rayCurve.numPoints-1);for(let e=1;e<this.rayCurve.numPoints;e++){const t=e*h;if(li(this.p0,this.v0,t,pi),this.parabola[e].copy(pi),ci(this.parabola[e-1],this.parabola[e],this.meshes,this.raycaster,ui,45,this.hitPoint)){this.hit=!0,u=e;break}}this.characterController.isTeleportingDisabled&&(this.hit=!1);const p=this.timeTeleporting>400?1:this.timeTeleporting/400,m=p*(u/(this.rayCurve.numPoints-1))/(this.rayCurve.numPoints-1);for(let e=0;e<this.rayCurve.numPoints;e++){const t=e*m;li(this.p0,this.v0,t,pi),this.rayCurve.setPoint(e,pi)}const f=this.hit?10092441:16711680,g=this.hit&&this.timeTeleporting>=400?.3:.1;if(this.rayCurve.material.color.set(f),this.rayCurve.material.opacity=g,this.hitEntity.visible=this.hit,this.hit){this.hitEntity.position.copy(this.hitPoint),this.hitEntity.matrixNeedsUpdate=!0;const e=this.data.outerRadius-this.data.hitCylinderRadius,t=(this.data.outerRadius-function(e){return e*e}(p)*e)/this.data.outerRadius;this.outerTorus.scale.set(t,t,1),this.outerTorus.matrixNeedsUpdate=!0;const n=.3*function(e){return e<.5?.5*((e=2*e-1)*e*e+1):.5*(e=2*e-1)*e*e+.5}(p);this.torus.material.opacity=n,this.cylinder.material.opacity=n}},createHitEntity(){const e=this.data,t=new THREE.Group;return this.torus=new THREE.Mesh(new THREE.TorusBufferGeometry(e.hitCylinderRadius,.01,16,18,360*THREE.Math.DEG2RAD),new THREE.MeshBasicMaterial({color:e.hitCylinderColor,side:THREE.DoubleSide,transparent:!0,toneMapped:!1,depthTest:!1})),this.torus.rotation.x=90*THREE.Math.DEG2RAD,t.add(this.torus),this.cylinder=new THREE.Mesh(new THREE.CylinderBufferGeometry(e.hitCylinderRadius,e.hitCylinderRadius,e.hitCylinderHeight,16,1,!0),new THREE.MeshBasicMaterial({color:e.hitCylinderColor,side:THREE.DoubleSide,map:ri,toneMapped:!1,transparent:!0,depthTest:!1})),this.cylinder.position.y=e.hitCylinderHeight/2,ri.flipY||(this.cylinder.rotation.z=180*THREE.Math.DEG2RAD),t.add(this.cylinder),this.outerTorus=new THREE.Mesh(new THREE.TorusBufferGeometry(e.outerRadius,.01,16,18,360*THREE.Math.DEG2RAD),new THREE.MeshBasicMaterial({color:e.hitCylinderColor,side:THREE.DoubleSide,opacity:.3,transparent:!0,depthTest:!1})),this.outerTorus.rotation.x=90*THREE.Math.DEG2RAD,t.add(this.outerTorus),t}});n(1343),n(1344),n(1345);var gi=n(167);n(1346),n(1347),n(1348);const vi=(new THREE.Matrix4).makeRotationY(Math.PI),bi=(new THREE.Matrix4).makeTranslation(0,-.25,0),yi=new THREE.Matrix4;AFRAME.registerComponent("inspect-pivot-offset-from-camera",{tick(){const e=this.el.object3D.parent;e.updateMatrices(),Object(lt.n)(this.el.object3D,Object(lt.a)(e.matrixWorld,yi).multiply(bi).multiply(vi))}});n(1349);function Ei(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function wi(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Ei(r,a,i,o,s,"next",e)}function s(e){Ei(r,a,i,o,s,"throw",e)}o(void 0)}))}}const _i="Failed to initialize avatar-audio-source.",Si=/chrome/i.test(navigator.userAgent);function xi(e){return Ai.apply(this,arguments)}function Ai(){return(Ai=wi((function*(e){const t=yield NAF.utils.getNetworkedEntity(e).catch(e=>{console.error(_i,"Could not find networked el.",e)});return t?t.components.networked.data.owner:null}))).apply(this,arguments)}function Mi(e){return ki.apply(this,arguments)}function ki(){return(ki=wi((function*(e){const t=yield xi(e);if(!t)return console.error(_i,"Networked component has no owner."),null;const n=yield APP.dialog.getMediaStream(t).catch(e=>{console.error(_i,"Error getting media stream for ".concat(t),e)});return n||null}))).apply(this,arguments)}var Oi;AFRAME.registerComponent("avatar-audio-source",{createAudio:(Oi=wi((function*(){this.removeAudio(),this.isCreatingAudio=!0;const e=yield Mi(this.el);this.isCreatingAudio=!1;const t=!this.el.parentNode;if(!e||t)return;APP.sourceType.set(this.el,$t.g.AVATAR_AUDIO_SOURCE);const{audioType:n}=Object(Zt.a)(this.el),a=this.el.sceneEl.audioListener;let i=this.el.getObject3D(this.attrName);i=n===$t.a.PannerNode?new THREE.PositionalAudio(a):new THREE.Audio(a),this.audioSystem.addAudio({sourceType:$t.g.AVATAR_AUDIO_SOURCE,node:i}),Si&&function(e){const t=new Audio;t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline"),t.srcObject=e,t.volume=0}(e),this.destination=i.context.createMediaStreamDestination(),this.mediaStreamSource=i.context.createMediaStreamSource(e);const r=i.context.createMediaStreamSource(this.destination.stream);this.mediaStreamSource.connect(this.destination),i.setNodeSource(r),this.el.setObject3D(this.attrName,i),this.el.emit("sound-source-set",{soundSource:r}),APP.audios.set(this.el,i),Object(Zt.d)(this.el,i)})),function(){return Oi.apply(this,arguments)}),removeAudio(){const e=this.el.getObject3D(this.attrName);e&&(this.audioSystem.removeAudio({node:e}),this.el.removeObject3D(this.attrName))},init(){this.createAudio=this.createAudio.bind(this),this.audioSystem=this.el.sceneEl.systems["hubs-systems"].audioSystem,APP.dialog.on("stream_updated",this._onStreamUpdated,this),this.createAudio();let e=APP.store.state.preferences.disableLeftRightPanning;this.onPreferenceChanged=()=>{const t=APP.store.state.preferences.disableLeftRightPanning,n=e!==t&&!this.isCreatingAudio;e=t,n&&this.createAudio()},APP.store.addEventListener("statechanged",this.onPreferenceChanged),this.el.addEventListener("audio_type_changed",this.createAudio)},_onStreamUpdated(e,t){var n=this;return wi((function*(){const a=n.el.getObject3D(n.attrName);if(!a)return;a.source.mediaStream&&xi(n.el).then(function(){var i=wi((function*(i){if(i===e&&"audio"===t){const t=yield APP.dialog.getMediaStream(e,"audio").catch(t=>{console.error(_i,"Error getting media stream for ".concat(e),t)});t&&(n.mediaStreamSource.disconnect(),n.mediaStreamSource=a.context.createMediaStreamSource(t),n.mediaStreamSource.connect(n.destination))}}));return function(e){return i.apply(this,arguments)}}())}))()},remove:function(){APP.dialog.off("stream_updated",this._onStreamUpdated),window.APP.store.removeEventListener("statechanged",this.onPreferenceChanged),this.el.removeEventListener("audio_type_changed",this.createAudio),APP.audios.delete(this.el),APP.sourceType.delete(this.el),APP.supplementaryAttenuation.delete(this.el),this.removeAudio()}});const Ci=new THREE.Vector3;AFRAME.registerComponent("zone-audio-source",{schema:{onlyMods:{default:!0},muteSelf:{default:!0},debug:{default:!1}},init(){const e=this.el.sceneEl.audioListener.context;this.gainFilter=e.createGain(),this.data.debug&&(this.whiteNoise=function(e,t){const n=2*e.sampleRate,a=e.createBuffer(1,n,e.sampleRate),i=a.getChannelData(0);for(let e=0;e<n;e++)i[e]=(2*Math.random()-1)*t;const r=e.createBufferSource();return r.buffer=a,r.loop=!0,r.start(0),r}(e,.01),this.setInput(this.whiteNoise)),this.el.object3D.updateMatrixWorld();const t=this.el.object3D.matrixWorld.getMaxScaleOnAxis();this.boundingRadiusSquared=t*t,this.data.debug&&this.el.setObject3D("debug",new THREE.LineSegments(new THREE.WireframeGeometry(new THREE.SphereBufferGeometry(1,10,10))))},setInput(e){this.input&&(this.input.disconnect(this.gainFilter),this.input=null),e&&(e.connect(this.gainFilter),this.input=e)},getGainFilter(){return this.gainFilter},tick(){if(this.el.object3D.getWorldPosition(Ci),this.trackingEl){this.trackingEl.object3D.position.distanceToSquared(Ci)>this.boundingRadiusSquared&&(this.trackingEl=null,this.setInput(this.whiteNoise))}else{const e=window.APP.componentRegistry["player-info"];for(let t=0;t<e.length;t++){const n=e[t],a=n.el;if(this.data.onlyMods&&!n.can("amplify_audio"))continue;a.object3D.position.distanceToSquared(Ci)<this.boundingRadiusSquared&&(this.trackingEl=a,this.data.muteSelf&&"avatar-rig"===this.trackingEl.id?this.setInput(null):Mi(this.trackingEl).then(e=>{const t=this.el.sceneEl.audioListener.context.createMediaStreamSource(e);this.setInput(t)}))}}}}),AFRAME.registerComponent("audio-target",{schema:{minDelay:{default:.01},maxDelay:{default:.13},srcEl:{type:"selector"},debug:{default:!1}},init(){this.audioSystem=this.el.sceneEl.systems["hubs-systems"].audioSystem,this.createAudio(),setTimeout(()=>{this.connectAudio()},0),this.el.setAttribute("audio-zone-source"),this.createAudio=this.createAudio.bind(this),this.el.addEventListener("audio_type_changed",this.createAudio)},remove:function(){APP.supplementaryAttenuation.delete(this.el),APP.audios.delete(this.el),APP.sourceType.delete(this.el),this.removeAudio(),this.el.removeAttribute("audio-zone-source"),this.el.removeEventListener("audio_type_changed",this.createAudio)},createAudio:function(){this.removeAudio(),APP.sourceType.set(this.el,$t.g.AUDIO_TARGET);const e=this.el.sceneEl.audioListener,{audioType:t}=Object(Zt.a)(this.el);let n=this.el.getObject3D(this.attrName);if(n=t===$t.a.PannerNode?new THREE.PositionalAudio(e):new THREE.Audio(e),this.audioSystem.addAudio({sourceType:$t.g.AVATAR_AUDIO_SOURCE,node:n}),this.data.maxDelay>0){const e=n.context.createDelay(this.data.maxDelay);e.delayTime.value=THREE.Math.randFloat(this.data.minDelay,this.data.maxDelay),n.setFilters([e])}this.el.setObject3D(this.attrName,n),n.matrixNeedsUpdate=!0,n.updateMatrixWorld(),n.updateMatrixWorld(),APP.audios.set(this.el,n),Object(Zt.d)(this.el,n)},connectAudio(){const e=this.data.srcEl,t=e&&e.components["zone-audio-source"],n=t&&t.getGainFilter();if(n){const e=this.el.getObject3D(this.attrName);e&&e.setNodeSource(n)}else console.warn("Failed to get audio from source for ".concat(this.el.className),e)},removeAudio(){this.el.getObject3D(this.attrName)&&(this.audioSystem.removeAudio({node:this.audio}),this.el.removeObject3D(this.attrName))}});n(1350);AFRAME.registerComponent("video-texture-source",{schema:{resolution:{type:"vec2",default:[1280,720]},fps:{default:15}},init(){if(this.camera=Object(lt.i)(this.el.object3D,e=>e.isCamera),this.camera.layers.enable(ct.a.CAMERA_LAYER_THIRD_PERSON_ONLY),!this.camera)return void console.warn("video-texture-source added to an entity without a camera");this.camera.aspect=this.data.resolution[0]/this.data.resolution[1],this.renderTarget=new THREE.WebGLRenderTarget(this.data.resolution[0],this.data.resolution[1],{format:THREE.RGBAFormat,minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,encoding:THREE.GammaEncoding,depth:!1,stencil:!1});const e=this.renderTarget.texture;e.matrixAutoUpdate=!1,e.matrix.scale(1,-1),e.matrix.translate(0,1),this.textureNeedsUpdate=!1},remove(){Object(Bt.b)(this.renderTarget.texture),this.renderTarget.dispose()},tock(e){if(!this.renderTarget||!this.textureNeedsUpdate)return;if(e<this.lastRenderTime+1e3/this.data.fps)return;const t=this.el.sceneEl,n=this.renderer||t.renderer,a=n.xr.enabled,i=t.object3D.onAfterRender;delete t.object3D.onAfterRender,n.xr.enabled=!1;const r=t.object3D.autoUpdate;t.object3D.autoUpdate=!1,n.setRenderTarget(this.renderTarget),n.render(t.object3D,this.camera),n.setRenderTarget(null),t.object3D.autoUpdate=r,n.xr.enabled=a,t.object3D.onAfterRender=i,this.lastRenderTime=e,this.textureNeedsUpdate=!1}}),AFRAME.registerComponent("video-texture-target",{schema:{src:{type:"string"},srcEl:{type:"selector"},targetBaseColorMap:{type:"boolean",default:!0},targetEmissiveMap:{type:"boolean",default:!1}},getMaterial(){return this.el.object3DMap.skinnedmesh&&this.el.object3DMap.skinnedmesh.material||this.el.object3DMap.mesh&&this.el.object3DMap.mesh.material||this.el.object3D.material},init(){this.el.object3D.traverse(e=>{e.layers.mask1=e.layers.mask,e.layers.set(ct.a.CAMERA_LAYER_VIDEO_TEXTURE_TARGET)});const e=this.getMaterial();e||console.warn("video-texture-target added to an entity without a material"),this.originalMap=e&&e.map,this.originalEmissiveMap=e&&e.emissiveMap},update(e){const t=this.getMaterial();if(!t)return;const n=this.data.src;if("el"===n){if(e.srcEl===this.data.srcEl)return;if(this.data.srcEl){const e=this.data.srcEl.components["video-texture-source"],n=e.renderTarget.texture;this.applyTexture(n),t.map.isVideoTexture=!0,t.map.update=()=>{e.textureNeedsUpdate=!0}}else t.map=this.originalMap,t.emissiveMap=this.originalEmissiveMap,t.needsUpdate=!0}else if(n&&n.startsWith("hubs://")){if(e.src===n)return;const t=n.substring(7).split("/")[1];APP.dialog.getMediaStream(t,"video").then(e=>{if(n!==this.data.src)return;const t=Object(te.i)("video");t.srcObject=e;const a=new THREE.VideoTexture(t);a.flipY=!1,a.minFilter=THREE.LinearFilter,a.encoding=THREE.sRGBEncoding,this.applyTexture(a)})}else t.map&&t.map!==this.originalMap&&Object(Bt.b)(t.map),t.emissiveMap&&t.emissiveMap!==this.originalEmissiveMap&&Object(Bt.b)(t.emissiveMap),t.map=this.originalMap,t.emissiveMap=this.originalEmissiveMap,t.needsUpdate=!0},applyTexture(e){const t=this.getMaterial(),n=this.originalMap||this.originalEmissiveMap;n&&(e.wrapS=n.wrapS,e.wrapT=n.wrapT),this.data.targetBaseColorMap&&(t.map=e),this.data.targetEmissiveMap&&(t.emissiveMap=e),t.needsUpdate=!0},remove(){if(this.el.object3D.traverse(e=>{e.layers.mask1&&(e.layers.mask=e.layers.mask1,delete e.layers.mask1)}),"el"===this.data.src)return;const e=this.getMaterial();e&&e.map&&e.map!==this.originalMap&&Object(Bt.b)(e.map),e.emissiveMap&&e.emissiveMap!==this.originalEmissiveMap&&Object(Bt.b)(e.emissiveMap)}});var Pi=n(784);const Ri=new d.THREE.PlaneBufferGeometry,Ti=window.innerWidth*window.devicePixelRatio,ji=window.innerHeight*window.devicePixelRatio;AFRAME.registerComponent("mirror",{schema:{color:{type:"color",default:"#7f7f7f"}},init(){var e,t;const n=(null===(e=this.el.object3DMap)||void 0===e||null===(t=e.mesh)||void 0===t?void 0:t.geometry)||Ri,a=new Pi.a(n,{color:this.data.color,textureWidth:Ti,textureHeight:ji});this.el.setObject3D("mesh",a);const i=a.onBeforeRender;a.onBeforeRender=function(e,t,n){const r=e.render;e.render=function(t,n){n.layers.enable(ct.a.CAMERA_LAYER_THIRD_PERSON_ONLY),n.layers.enable(ct.a.CAMERA_LAYER_VIDEO_TEXTURE_TARGET),a.onBeforeRender=i,r.call(e,t,n)},i(e,t,n),e.render=r}}});var Di=n(53),Ii=n.n(Di),Li=n(0),Hi=n.n(Li),Ni=n(833),Fi=n(619),Vi=n(36),Bi=n(1),Ui=n.n(Bi),zi=n(5),Wi=n.n(zi),qi=n(315),Gi=n.n(qi),Yi=n(6);function Ki(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Xi(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Ki(r,a,i,o,s,"next",e)}function s(e){Ki(r,a,i,o,s,"throw",e)}o(void 0)}))}}const{detect:Qi}=n(93),Ji=Qi(),Zi="yes",$i="no",er="maybe";function tr(e){return/\WAndroid\W/.test(e)}function nr(e){return/\WAndroid\W/.test(e)}const ar=[/cardboard/i];function ir(){return rr.apply(this,arguments)}function rr(){return(rr=Xi((function*(){const e=navigator.userAgent,t="chrome"===Ji.name&&/SamsungBrowser/.test(e),n=AFRAME.utils.device.isMobile(),a=AFRAME.utils.device.isMobileVR(),i=window.hasNativeWebVRImplementation,r=window.hasNativeWebXRImplementation,o=!(!i||"chrome"!==Ji.name||t),s=Object(u.b)(),l="firefox"===Ji.name,c=void 0===navigator.mediaDevices,d=s?c?er:Zi:$i,h=!(!n||s||"chrome"!==Ji.name||t);let p=[];try{("chrome"!==Ji.name||n)&&(p=i||h?yield navigator.getVRDisplays():[])}catch(e){console.warn("navigator.getVRDisplays() failed",e)}const m=/Oculus/.test(e),f=a?$i:s&&c?er:Zi;let g=n||!i&&l?$i:er,v=$i,b=$i;tr(e)&&(b=m?Zi:er);let y=nr(e)&&!a?er:$i;if(v=h&&p.find(e=>e.capabilities.canPresent&&/cardboard/i.test(e.displayName))?Zi:$i,i){g=p.find(e=>e.capabilities.canPresent&&!ar.find(t=>t.test(e.displayName)))?Zi:$i;p.find(e=>/daydream/i.test(e.displayName))?(y=Zi,g=$i):o&&(y=$i)}return r&&(g=!0),{screen:f,generic:g,gearvr:b,daydream:y,cardboard:v,safari:d}}))).apply(this,arguments)}const or={screen:Zi,generic:$i,gearvr:$i,daydream:$i,cardboard:$i,safari:$i},sr=AFRAME.utils.device.isMobileVR();function lr(){return navigator.share&&!sr}function cr(e){if(lr())return navigator.share(e);{const{title:t,url:n}=e,a=550,i=420,r=(screen.width-a)/2,o=(screen.height-i)/2,s="scrollbars=no,menubar=no,toolbar=no,status=no,width=".concat(a,",height=").concat(i,",top=").concat(o,",left=").concat(r),l="https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(n),"&text=").concat(encodeURIComponent(t));return window.open(l,"_blank",s),Promise.resolve()}}var dr=n(479),ur=n.n(dr),hr=n(169),pr=n.n(hr);const mr=Hi.a.createContext({});function fr(){return(fr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function gr(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}Ui.a.object,Ui.a.string;class vr extends Hi.a.Component{render(){const e=this.props,{history:t,stateKey:n,stateValue:a}=e,i=gr(e,["history","stateKey","stateValue"]);return!t.location.state&&!a||t.location.state&&(t.location.state[n]===a||!t.location.state[n]&&!a)?Hi.a.createElement(Ni.a,fr({path:"/"},i)):null}}vr.propTypes={stateKey:Ui.a.string,stateValue:Ui.a.string,history:Ui.a.object};var br=vr;const yr=(()=>{const e=new Map,t=[],n=[];return function(){if(!window.APP||!window.APP.componentRegistry)return null;const a=AFRAME.scenes[0];n.length=0;const i=window.APP.componentRegistry["player-info"];if(i)for(let r=0;r<i.length;r++){const o=i[r],s=o.playerSessionId;let l=!1;if(o.isLocalPlayerInfo&&(l=a.systems["local-audio-analyser"].volume>1e-5),-1===t.indexOf(s)&&t.push(s),n.push(s),e.has(s)){const t=e.get(s);t.muted=o.data.muted,t.talking=l}else e.set(s,{muted:o.data.muted,talking:l})}const r=window.APP.componentRegistry["networked-audio-analyser"];if(r)for(let t=0;t<r.length;t++){const n=r[t];e.has(n.playerSessionId)&&n.volume>1e-5&&(e.get(n.playerSessionId).talking=!0)}for(let a=t.length-1;a>=0;a--){const i=t[a];-1===n.indexOf(i)&&(e.delete(i),t.splice(a,1))}return e}})();var Er=n(329),wr=n.n(Er);function _r({title:e,beforeTitle:t,afterTitle:n,children:a,contentClassName:i,className:r,disableOverflowScroll:o}){return Hi.a.createElement("div",{className:Wi()(wr.a.sidebar,r)},(e||t||n)&&Hi.a.createElement("div",{className:wr.a.header},Hi.a.createElement("div",{className:wr.a.beforeTitle},t),Hi.a.createElement("h5",null,e),Hi.a.createElement("div",{className:wr.a.afterTitle},n)),Hi.a.createElement("div",{className:Wi()(wr.a.content,o?"":wr.a.overflowY,i)},a))}_r.propTypes={title:Ui.a.node,beforeTitle:Ui.a.node,afterTitle:Ui.a.node,children:Ui.a.node,className:Ui.a.string,contentClassName:Ui.a.string,disableOverflowScroll:Ui.a.bool},_r.defaultProps={disableOverflowScroll:!1};var Sr=n(48),xr=n(785),Ar=n.n(xr),Mr=n(57);function kr(){return(kr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Or(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Cr(e){var t=e.title,n=e.titleId,a=Or(e,["title","titleId"]);return Li.createElement("svg",kr({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M14 3l-7 7 7 7",stroke:a.color,strokeWidth:2.25,strokeLinecap:"round",strokeLinejoin:"round"}))}Cr.defaultProps={color:"#000",title:"Chevron Back"};function Pr(){return(Pr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Rr(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Tr(e){let{className:t}=e,n=Rr(e,["className"]);return Hi.a.createElement(Mr.a,Pr({className:Wi()(Ar.a.backButton,t)},n),Hi.a.createElement(Cr,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"back-button",defaultMessage:"Back"})))}Tr.propTypes={className:Ui.a.string,children:Ui.a.node};var jr=n(14),Dr=n(607),Ir=n.n(Dr),Lr=n(141),Hr=n(22);function Nr(){return(Nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Fr(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Vr(e){let{displayName:t,displayNameInputRef:n,disableDisplayNameInput:a,onChangeDisplayName:i,avatarPreview:r,displayNamePattern:o,onChangeAvatar:s}=e,l=Fr(e,["displayName","displayNameInputRef","disableDisplayNameInput","onChangeDisplayName","avatarPreview","displayNamePattern","onChangeAvatar"]);return Hi.a.createElement(Hr.a,Nr({as:"form",className:Ir.a.content},l),Hi.a.createElement(Lr.a,{disabled:a,label:Hi.a.createElement(Yi.a,{id:"avatar-settings-content.display-name-label",defaultMessage:"Display Name"}),value:t,pattern:o,spellCheck:"false",required:!0,onChange:i,description:Hi.a.createElement(Yi.a,{id:"avatar-settings-content.display-name-description",defaultMessage:"Alphanumerics, hyphens, underscores, and tildes. At least 3 characters, no more than 32"}),ref:n}),Hi.a.createElement("div",{className:Ir.a.avatarPreviewContainer},r||Hi.a.createElement("div",null),Hi.a.createElement(jr.c,{type:"button",preset:"basic",onClick:s},Hi.a.createElement(Yi.a,{id:"avatar-settings-content.change-avatar-button",defaultMessage:"Change Avatar"}))),Hi.a.createElement(jr.a,{preset:"accept",type:"submit"}))}function Br(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ur(e){let{className:t,showBackButton:n,onBack:a,onClose:i}=e,r=Br(e,["className","showBackButton","onBack","onClose"]);return Hi.a.createElement(_r,{title:Hi.a.createElement(Yi.a,{id:"avatar-settings-sidebar.title",defaultMessage:"Avatar Settings"}),beforeTitle:n?Hi.a.createElement(Tr,{onClick:a}):Hi.a.createElement(Sr.a,{onClick:i}),className:t},Hi.a.createElement(Vr,r))}Vr.propTypes={className:Ui.a.string,displayName:Ui.a.string,displayNameInputRef:Ui.a.func,disableDisplayNameInput:Ui.a.bool,displayNamePattern:Ui.a.string,onChangeDisplayName:Ui.a.func,avatarPreview:Ui.a.node,onChangeAvatar:Ui.a.func},Ur.propTypes={showBackButton:Ui.a.bool,className:Ui.a.string,onBack:Ui.a.func,onClose:Ui.a.func};var zr=n(47);function Wr(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function qr(e){let{className:t,onBack:n}=e,a=Wr(e,["className","onBack"]);return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"avatar-setup-sidebar.title",defaultMessage:"Avatar Setup"}),beforeTitle:Hi.a.createElement(Tr,{onClick:n}),className:t},Hi.a.createElement(Vr,a))}qr.propTypes={className:Ui.a.string,onBack:Ui.a.func};var Gr=n(323);function Yr(){return(Yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Kr(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Xr(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Kr(r,a,i,o,s,"next",e)}function s(e){Kr(r,a,i,o,s,"throw",e)}o(void 0)}))}}class Qr extends Li.Component{constructor(e){var t;super(e),t=this,this.state={avatarId:null,displayName:null,avatar:null},this.getStateFromProfile=()=>{const{displayName:e,avatarId:t}=this.props.store.state.profile;return{displayName:e,avatarId:t}},this.storeUpdated=()=>this.setState(this.getStateFromProfile()),this.saveStateAndFinish=e=>{e&&e.preventDefault();const{displayName:t}=this.props.store.state.profile,{hasChangedName:n}=this.props.store.state.activity,a=n||this.state.displayName!==t;this.props.store.update({activity:{hasChangedName:a,hasAcceptedProfile:!0},profile:{displayName:this.state.displayName,avatarId:this.state.avatarId}}),this.props.finished(),this.scene.emit("avatar_updated")},this.stopPropagation=e=>{e.stopPropagation()},this.setAvatarFromMediaResult=({detail:{entry:e,selectAction:t}})=>{"avatar"!==e.type&&"avatar_listing"!==e.type||"use"!==t||(this.setState({avatarId:e.id}),Object(Vi.f)(this.props.history,this.props.history.location.state.key,"profile",{avatarId:e.id}))},this.refetchAvatar=Xr((function*(){const e=yield Object(it.d)(t.state.avatarId);t.state.avatarId===e.avatar_id&&t.setState({avatar:e})})),this.state=this.getStateFromProfile(),e.avatarId&&(this.state.avatarId=e.avatarId),this.props.store.addEventListener("statechanged",this.storeUpdated),this.scene=document.querySelector("a-scene")}componentDidMount(){this.nameInput&&(this.nameInput.addEventListener("keydown",this.stopPropagation),this.nameInput.addEventListener("keypress",this.stopPropagation),this.nameInput.addEventListener("keyup",this.stopPropagation)),this.scene.addEventListener("action_selected_media_result_entry",this.setAvatarFromMediaResult),this.scene.addEventListener("action_avatar_saved",this.refetchAvatar),this.refetchAvatar()}componentDidUpdate(e,t){t.avatarId!==this.state.avatarId&&this.refetchAvatar()}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated),this.nameInput&&(this.nameInput.removeEventListener("keydown",this.stopPropagation),this.nameInput.removeEventListener("keypress",this.stopPropagation),this.nameInput.removeEventListener("keyup",this.stopPropagation)),this.scene.removeEventListener("action_selected_media_result_entry",this.setAvatarFromMediaResult),this.scene.removeEventListener("action_avatar_saved",this.refetchAvatar)}render(){const e={displayNameInputRef:e=>this.nameInput=e,disableDisplayNameInput:!!this.props.displayNameOverride,displayName:this.props.displayNameOverride?this.props.displayNameOverride:this.state.displayName,displayNamePattern:this.props.store.schema.definitions.profile.properties.displayName.pattern,onChangeDisplayName:e=>this.setState({displayName:e.target.value}),avatarPreview:Hi.a.createElement(Gr.a,{avatarGltfUrl:this.state.avatar&&this.state.avatar.gltf_url}),onChangeAvatar:e=>{e.preventDefault(),this.props.mediaSearchStore.sourceNavigateWithNoNav("avatars","use")},onSubmit:this.saveStateAndFinish,onClose:this.props.onClose,onBack:this.props.onBack};return"sidebar"===this.props.containerType?Hi.a.createElement(Ur,Yr({},e,{showBackButton:this.props.showBackButton})):Hi.a.createElement(qr,e)}}Qr.propTypes={containerType:Ui.a.oneOf(["sidebar","modal"]),displayNameOverride:Ui.a.string,store:Ui.a.object,mediaSearchStore:Ui.a.object,messages:Ui.a.object,finished:Ui.a.func,history:Ui.a.object,avatarId:Ui.a.string,onClose:Ui.a.func,onBack:Ui.a.func,showBackButton:Ui.a.bool},Qr.defaultProps={containerType:"modal"};var Jr=n(9),Zr=n(173),$r=n(214),eo=n(288);function to({onSubmit:e,onClose:t}){const{handleSubmit:n,register:a}=Object(eo.a)();return Hi.a.createElement(zr.a,{title:"Custom Avatar URL",beforeTitle:Hi.a.createElement(Sr.a,{onClick:t})},Hi.a.createElement(Hr.a,{as:"form",padding:!0,center:!0,onSubmit:n(e)},Hi.a.createElement(Lr.a,{name:"url",label:Hi.a.createElement(Yi.a,{id:"avatar-url-modal.avatar-url-label",defaultMessage:"Avatar GLB URL"}),placeholder:"https://example.com/avatar.glb",type:"url",required:!0,ref:a,description:Hi.a.createElement("a",{href:"https://hubs.mozilla.com/docs/intro-avatars.html",target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement(Yi.a,{id:"avatar-url-modal.custom-avatar-docs-link",defaultMessage:"Learn more about custom avatars"}))}),Hi.a.createElement(jr.b,{type:"submit"})))}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){ao(e,t,n[t])}))}return e}function ao(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function io({store:e,scene:t,onClose:n}){const a=Object(Li.useCallback)(({url:a})=>{e.update({profile:no({},e.state.profile,{avatarId:a})}),t.emit("avatar_updated"),n()},[e,t,n]);return Hi.a.createElement(to,{onSubmit:a,onClose:n})}function ro({enableSpoke:e,editorName:t,onValidateUrl:n,onSubmit:a,onClose:i}){const{isSubmitting:r,handleSubmit:o,register:s,errors:l}=Object(eo.a)();return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"scene-url-modal.title",defaultMessage:"Custom Scene URL"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:i})},Hi.a.createElement(Hr.a,{as:"form",padding:!0,center:!0,onSubmit:o(a)},Hi.a.createElement("p",null,e?Hi.a.createElement(Yi.a,{id:"scene-url-modal.message-with-spoke",defaultMessage:"Paste a URL to a {editorName} scene or a URL to a <glblink>GLB</glblink>.",values:{editorName:Hi.a.createElement("a",{href:"/spoke",target:"_blank",rel:"noopener noreferrer"},t),glblink:e=>Hi.a.createElement("a",{href:"https://en.wikipedia.org/wiki/GlTF#GLB",target:"_blank",rel:"noopener noreferrer"},e)}}):Hi.a.createElement(Yi.a,{id:"scene-url-modal.message",defaultMessage:"Paste a URL to a scene or a URL to a <glblink>GLB</glblink>.",values:{glblink:e=>Hi.a.createElement("a",{href:"https://en.wikipedia.org/wiki/GlTF#GLB",target:"_blank",rel:"noopener noreferrer"},e)}})),Hi.a.createElement(Lr.a,{name:"url",label:Hi.a.createElement(Yi.a,{id:"scene-url-modal.url-input",defaultMessage:"Scene URL"}),placeholder:"https://example.com/scene.glb",type:"url",required:!0,ref:s({validate:n}),error:l.url&&l.url.message}),Hi.a.createElement(jr.c,{type:"submit",preset:"accept",disabled:r},Hi.a.createElement(Yi.a,{id:"scene-url-modal.change-scene-button",defaultMessage:"Change Scene"})),e&&Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"scene-url-modal.create-in-spoke",defaultMessage:"Or, create a new scene using {editorName}.",values:{editorName:t}})),Hi.a.createElement(jr.c,{as:"a",preset:"primary",href:"/spoke/new",target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement(Yi.a,{id:"scene-url-modal.new-spoke-project-button",defaultMessage:"Launch {editorName}",values:{editorName:t}})))))}function oo(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function so(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){oo(r,a,i,o,s,"next",e)}function s(e){oo(r,a,i,o,s,"throw",e)}o(void 0)}))}}function lo(e){return co.apply(this,arguments)}function co(){return(co=so((function*(e){return fetch(e).then(function(){var e=so((function*(e){const t=e.body.getReader();let n="";return yield t.read().then((function e({done:a,value:i}){if(n+=String.fromCharCode.apply(null,i.slice(0,4)),!a&&n.length<4)return t.read().then(e);t.cancel()})),n.startsWith("glTF")}));return function(t){return e.apply(this,arguments)}}())}))).apply(this,arguments)}function uo(e){return ho.apply(this,arguments)}function ho(){return(ho=so((function*(e){return""!==e.trim()&&(!!e.startsWith("http")&&(!!(yield Object(Ut.g)(e))||lo(Object(Ut.j)(e))))}))).apply(this,arguments)}to.propTypes={onSubmit:Ui.a.func,onClose:Ui.a.func},io.propTypes={store:Ui.a.object.isRequired,scene:Ui.a.object.isRequired,onClose:Ui.a.func},ro.propTypes={enableSpoke:Ui.a.bool,editorName:Ui.a.string,onSubmit:Ui.a.func,onClose:Ui.a.func,onValidateUrl:Ui.a.isRequired};var po=n(364);function mo(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function fo({hubChannel:e,onClose:t}){const n=Object(po.a)(),i=Object(Li.useCallback)(function(){var e,t=(e=function*(e){return(yield uo(e.trim()))||n.formatMessage("scene-url-modal.invalid-scene-url")},function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){mo(r,a,i,o,s,"next",e)}function s(e){mo(r,a,i,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[n]),r=Object(Li.useCallback)(({url:n})=>{e.updateScene(n),t()},[e,t]);return Hi.a.createElement(ro,{enableSpoke:a.a.feature("enable_spoke"),editorName:a.a.translation("editor-name"),onValidateUrl:i,onSubmit:r,onClose:t})}function go(){return(go=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function vo(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bo(e){var t=e.title,n=e.titleId,a=vo(e,["title","titleId"]);return Li.createElement("svg",go({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M8.44 7.5v5.62a1.565 1.565 0 003.131 0l.005-7.366A2.656 2.656 0 007.9 3.274a2.654 2.654 0 00-1.631 2.48v7.415a3.73 3.73 0 107.46 0V6.24",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}))}fo.propTypes={hubChannel:Ui.a.object.isRequired,onClose:Ui.a.func},bo.defaultProps={color:"#000",title:"Attach"};var yo=n(480),Eo=n.n(yo);function wo({showModelCollectionLink:e,modelCollectionUrl:t,onSubmit:n,onClose:a}){const{handleSubmit:i,register:r,watch:o,setValue:s}=Object(eo.a)();Object(Li.useEffect)(()=>{r("url")},[r]);const l=o("file"),c=l&&l.length>0,d=c?l[0].name:void 0,u=Object(Li.useCallback)(()=>{c?s("file",void 0):s("url","")},[c,s]),h=Object(Li.useCallback)(e=>{c||s("url",e.target.value)},[c,s]),p=o("url",""),m=c||p.length>0;return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"object-url-modal.title",defaultMessage:"Custom Object"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:a})},Hi.a.createElement(Hr.a,{as:"form",padding:!0,center:!0,onSubmit:i(n)},Hi.a.createElement("p",null,e?Hi.a.createElement(Yi.a,{id:"object-url-modal.message-with-collection",defaultMessage:"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink> or our <collectionlink>collection</collectionlink>.",values:{sketchfablink:e=>Hi.a.createElement("a",{href:"https://sketchfab.com/search?features=downloadable&type=models",target:"_blank",rel:"noopener noreferrer"},e),collectionlink:e=>Hi.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},e)}}):Hi.a.createElement(Yi.a,{id:"object-url-modal.message",defaultMessage:"Upload or paste a URL to an image, video, model, or scene. Models can be found on <sketchfablink>Sketchfab</sketchfablink>.",values:{sketchfablink:e=>Hi.a.createElement("a",{href:"https://sketchfab.com/search?features=downloadable&type=models",target:"_blank",rel:"noopener noreferrer"},e)}})),Hi.a.createElement(Lr.a,{name:"url",label:Hi.a.createElement(Yi.a,{id:"object-url-modal.url-field-label",defaultMessage:"Object URL or File"}),placeholder:"https://example.com/avatar.glb",type:c?"text":"url",value:d||p||"",onChange:h,afterInput:Hi.a.createElement(Hi.a.Fragment,null,m&&Hi.a.createElement(Sr.a,{onClick:u}),Hi.a.createElement(Mr.a,{as:"label",className:Wi()({[Eo.a.hidden]:m},Eo.a.urlInput),htmlFor:"file"},Hi.a.createElement(bo,null),Hi.a.createElement("input",{id:"file",className:Eo.a.hidden,name:"file",type:"file",ref:r}))),description:Hi.a.createElement(Yi.a,{id:"object-url-modal.url-field-description",defaultMessage:"Accepts glb, png, jpg, gif, mp4, and mp3 files"})}),Hi.a.createElement(jr.c,{type:"submit",preset:"accept"},Hi.a.createElement(Yi.a,{id:"object-url-modal.create-object-button",defaultMessage:"Create Object"}))))}wo.propTypes={isMobile:Ui.a.bool,showModelCollectionLink:Ui.a.bool,modelCollectionUrl:Ui.a.string,onSubmit:Ui.a.func,onClose:Ui.a.func};var _o=n(473),So=n.n(_o);const xo=AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR();function Ao({scene:e,onClose:t}){const n=Object(Li.useCallback)(({file:n,url:a})=>{e.emit("add_media",n&&n.length>0&&n[0]||a||So.a),t()},[e,t]);return Hi.a.createElement(wo,{isMobile:xo,showModelCollectionLink:a.a.feature("show_model_collection_link"),modelCollectionUrl:a.a.link("model_collection","https://sketchfab.com/mozillareality"),onSubmit:n,onClose:t})}Ao.propTypes={scene:Ui.a.object.isRequired,onClose:Ui.a.func};var Mo=n(234),ko=n.n(Mo),Oo=n(318),Co=n(229),Po=n(258);function Ro(){return(Ro=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function To(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function jo(e){var t=e.title,n=e.titleId,a=To(e,["title","titleId"]);return Li.createElement("svg",Ro({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M10.469 4.375L16.094 10l-5.625 5.625",stroke:a.color,strokeWidth:2.25,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M15.313 10H3.905",stroke:a.color,strokeWidth:2.25,strokeLinecap:"round",strokeLinejoin:"round"}))}jo.defaultProps={color:"#000",title:"Arrow Forward"};function Do(){return(Do=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Io(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Lo(e){var t=e.title,n=e.titleId,a=Io(e,["title","titleId"]);return Li.createElement("svg",Do({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M9.531 15.625L3.906 10l5.625-5.625",stroke:a.color,strokeWidth:2.25,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M4.688 10h11.406",stroke:a.color,strokeWidth:2.25,strokeLinecap:"round",strokeLinejoin:"round"}))}Lo.defaultProps={color:"#000",title:"Arrow Back"};var Ho=n(330),No=n.n(Ho);function Fo({className:e,headerLeft:t,headerCenter:n,headerRight:a,contentClassName:i,children:r}){return Hi.a.createElement("div",{className:Wi()(No.a.fullscreenLayout,e)},Hi.a.createElement("div",{className:No.a.header},Hi.a.createElement("div",{className:No.a.headerLeft},t),Hi.a.createElement("div",{className:No.a.headerCenter},n),Hi.a.createElement("div",{className:No.a.headerRight},a)),Hi.a.createElement("div",{className:Wi()(No.a.content,i)},r))}Fo.propTypes={className:Ui.a.string,headerLeft:Ui.a.node,headerCenter:Ui.a.node,headerRight:Ui.a.node,contentClassName:Ui.a.string,children:Ui.a.node};var Vo=n(357);const Bo=Object(Jr.b)({youtube:{id:"media-browser.nav_title.youtube",defaultMessage:"YouTube"},videos:{id:"media-browser.nav_title.videos",defaultMessage:"Videos"},images:{id:"media-browser.nav_title.images",defaultMessage:"Images"},gifs:{id:"media-browser.nav_title.gifs",defaultMessage:"GIFs"},scenes:{id:"media-browser.nav_title.scenes",defaultMessage:"Scenes"},avatars:{id:"media-browser.nav_title.avatars",defaultMessage:"Avatars"},sketchfab:{id:"media-browser.nav_title.sketchfab",defaultMessage:"Sketchfab"},twitch:{id:"media-browser.nav_title.twitch",defaultMessage:"Twitch"}});function Uo({onClose:e,browserRef:t,searchInputRef:n,autoFocusSearch:a,searchPlaceholder:i,searchDescription:r,onSearchKeyDown:o,onClearSearch:s,mediaSources:l,selectedSource:c,onSelectSource:d,activeFilter:u,facets:h,onSelectFacet:p,query:m,onChangeQuery:f,headerRight:g,hasNext:v,hasPrevious:b,onNextPage:y,onPreviousPage:E,noResultsMessage:w,children:_}){const S=Object(po.a)();return Hi.a.createElement(Fo,{headerLeft:Hi.a.createElement(Mr.a,{onClick:e},Hi.a.createElement(Po.a,null)),headerCenter:Hi.a.createElement(Hi.a.Fragment,null,"favorites"===c?Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Co.a,{className:ko.a.favoriteIcon}),Hi.a.createElement("h3",null,Hi.a.createElement(Yi.a,{id:"media-browser.favorites-header",defaultMessage:"Favorite Rooms"}))):Hi.a.createElement(Lr.a,{value:m,onChange:f,autoFocus:a,ref:n,placeholder:i,onKeyDown:o,beforeInput:Hi.a.createElement(Oo.a,{className:ko.a.searchIcon}),afterInput:Hi.a.createElement(Mr.a,{onClick:s},Hi.a.createElement(Po.a,{height:16,width:16})),description:r})),headerRight:g},l&&Hi.a.createElement("div",{className:ko.a.buttonNav},l.map(e=>Hi.a.createElement(jr.c,{sm:!0,key:e,preset:c===e?"primary":"transparent",onClick:()=>d(e)},S.formatMessage(Bo[e])))),h&&Hi.a.createElement("div",{className:Wi()(ko.a.buttonNav,ko.a.facetsNav)},h.map((e,t)=>Hi.a.createElement(jr.c,{sm:!0,key:t,preset:u===e.params.filter?"primary":"transparent",onClick:()=>p(e)},e.text))),Hi.a.createElement("div",{className:ko.a.content},Hi.a.createElement(Hr.a,{grow:!0,ref:t},_?Hi.a.createElement(Vo.a,{isVariableWidth:"gifs"===c||"images"===c,sm:"avatars"===c},_):Hi.a.createElement("div",{className:ko.a.noResults},w),(v||b)&&Hi.a.createElement("div",{className:ko.a.pager},Hi.a.createElement("button",{type:"button",className:ko.a.pagerButton,disabled:!b,onClick:E},Hi.a.createElement(Lo,null)),Hi.a.createElement("button",{type:"button",className:ko.a.pagerButton,disabled:!v,onClick:y},Hi.a.createElement(jo,null))))))}function zo(){return(zo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Wo(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}Uo.propTypes={onClose:Ui.a.func,browserRef:Ui.a.any,searchInputRef:Ui.a.any,autoFocusSearch:Ui.a.bool,searchPlaceholder:Ui.a.string,searchDescription:Ui.a.node,onSearchKeyDown:Ui.a.func,onClearSearch:Ui.a.func,mediaSources:Ui.a.array,selectedSource:Ui.a.string,onSelectSource:Ui.a.func,activeFilter:Ui.a.string,facets:Ui.a.array,onSelectFacet:Ui.a.func,query:Ui.a.string,onChangeQuery:Ui.a.func,headerRight:Ui.a.node,hasNext:Ui.a.bool,hasPrevious:Ui.a.bool,onNextPage:Ui.a.func,onPreviousPage:Ui.a.func,noResultsMessage:Ui.a.node,children:Ui.a.node},Uo.defaultProps={noResultsMessage:"No Results"};var qo=Li.createElement("path",{d:"M12.5 14.367h2.969c2.148 0 3.906-1.14 3.906-3.265s-2.07-3.183-3.75-3.266C15.278 4.514 12.852 2.492 10 2.492c-2.695 0-4.431 1.79-5 3.563C2.656 6.278.625 7.769.625 10.21c0 2.442 2.11 4.156 4.688 4.156H7.5"}),Go=Li.createElement("path",{d:"M12.5 9.992l-2.5-2.5-2.5 2.5"}),Yo=Li.createElement("path",{d:"M10 17.509V8.117"}),Ko=Li.createElement("defs",null,Li.createElement("clipPath",{id:"Upload_svg__clip0"},Li.createElement("rect",{width:20,height:20,fill:"#fff"})));function Xo(e){var t=e.title,n=e.titleId,a=Wo(e,["title","titleId"]);return Li.createElement("svg",zo({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("g",{clipPath:"url(#Upload_svg__clip0)",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"},qo,Go,Yo),Ko)}Xo.defaultProps={color:"#000",title:"Upload"};function Qo(){return(Qo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Jo(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Zo(e){var t=e.title,n=e.titleId,a=Jo(e,["title","titleId"]);return Li.createElement("svg",Qo({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.851 11.038a2.906 2.906 0 104.11 4.11l1.768-1.768a.844.844 0 011.194 1.193l-1.768 1.768a4.594 4.594 0 11-6.497-6.496l1.768-1.768A.844.844 0 016.619 9.27l-1.768 1.768zm3.227-4.42a.844.844 0 010-1.193l1.767-1.767a4.594 4.594 0 016.497 6.496l-1.768 1.768a.844.844 0 11-1.193-1.193l1.768-1.768a2.906 2.906 0 00-4.11-4.11L9.27 6.619a.844.844 0 01-1.193 0zm-1.236 5.345a.844.844 0 001.194 1.193l5.176-5.176a.844.844 0 00-1.193-1.194l-5.177 5.177z",fill:a.color}))}Zo.defaultProps={color:"#000",title:"Link"};var $o=n(290),es=n(35);function ts(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function ns(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){ts(r,a,i,o,s,"next",e)}function s(e){ts(r,a,i,o,s,"throw",e)}o(void 0)}))}}const as=AFRAME.utils.device.isMobile(),is=AFRAME.utils.device.isMobileVR(),rs={videos:"https://privacy.microsoft.com/en-us/privacystatement",images:"https://privacy.microsoft.com/en-us/privacystatement",gifs:"https://tenor.com/legal-privacy",sketchfab:"https://sketchfab.com/privacy",youtube:"https://policies.google.com/privacy",twitch:"https://www.twitch.tv/p/legal/privacy-policy/"},os={sketchfab:[{text:"Featured",params:{filter:"featured"}},{text:"Animals",params:{filter:"animals-pets"}},{text:"Architecture",params:{filter:"architecture"}},{text:"Art",params:{filter:"art-abstract"}},{text:"Vehicles",params:{filter:"cars-vehicles"}},{text:"Characters",params:{filter:"characters-creatures"}},{text:"Culture",params:{filter:"cultural-heritage-history"}},{text:"Gadgets",params:{filter:"electronics-gadgets"}},{text:"Fashion",params:{filter:"fashion-style"}},{text:"Food",params:{filter:"food-drink"}},{text:"Furniture",params:{filter:"furniture-home"}},{text:"Music",params:{filter:"music"}},{text:"Nature",params:{filter:"nature-plants"}},{text:"News",params:{filter:"news-politics"}},{text:"People",params:{filter:"people"}},{text:"Places",params:{filter:"places-travel"}},{text:"Science",params:{filter:"science-technology"}},{text:"Sports",params:{filter:"sports-fitness"}},{text:"Weapons",params:{filter:"weapons-military"}}],avatars:[{text:"Featured",params:{filter:"featured"}},{text:"My Avatars",params:{filter:"my-avatars"}},{text:"Newest",params:{filter:""}}],favorites:[],scenes:[{text:"Featured",params:{filter:"featured"}},{text:"My Scenes",params:{filter:"my-scenes"}}]},ss=Object(Jr.b)({images:{id:"media-browser.powered_by.images",defaultMessage:"Search by Bing"},videos:{id:"media-browser.powered_by.videos",defaultMessage:"Search by Bing"},youtube:{id:"media-browser.powered_by.youtube",defaultMessage:"Search by Google"},gifs:{id:"media-browser.powered_by.gifs",defaultMessage:"Search by Tenor"},sketchfab:{id:"media-browser.powered_by.sketchfab",defaultMessage:"Search by Sketchfab"},twitch:{id:"media-browser.powered_by.twitch",defaultMessage:"Search by Twitch"},scenes:{id:"media-browser.powered_by.scenes",defaultMessage:"Made with {editorName}"}}),ls=Object(Jr.b)({object:{id:"media-browser.add_custom_object",defaultMessage:"Custom URL or File"},scene:{id:"media-browser.add_custom_scene",defaultMessage:"Custom Scene"},avatar:{id:"media-browser.add_custom_avatar",defaultMessage:"Avatar GLB URL"}}),cs=Object(Jr.b)({scenes:{id:"media-browser.search-placeholder.scenes",defaultMessage:"Search Scenes..."},avatars:{id:"media-browser.search-placeholder.avatars",defaultMessage:"Search Avatars..."},videos:{id:"media-browser.search-placeholder.videos",defaultMessage:"Search for Videos..."},images:{id:"media-browser.search-placeholder.images",defaultMessage:"Search for Images..."},youtube:{id:"media-browser.search-placeholder.youtube",defaultMessage:"Search for Youtube videos..."},gifs:{id:"media-browser.search-placeholder.gifs",defaultMessage:"Search for GIFs..."},twitch:{id:"media-browser.search-placeholder.twitch",defaultMessage:"Search for Twitch streams..."},sketchfab:{id:"media-browser.search-placeholder.sketchfab",defaultMessage:"Search Sketchfab Models..."},default:{id:"media-browser.search-placeholder.default",defaultMessage:"Search..."}}),ds=Object(Jr.b)({favorites:{id:"media-browser.empty.favorites",defaultMessage:"You don't have any favorites. Click a  to add to your favorites."},default:{id:"media-browser.empty.default",defaultMessage:"No results. Try entering a new search above."}});class us extends Li.Component{constructor(e){var t;super(e),t=this,this.state={query:"",facets:[],showNav:!0,selectNextResult:!1,clearStashedQueryOnClose:!1},this.storeUpdated=()=>{const e=this.getStoreAndHistoryState(this.props);this.setState(e),this.state.selectNextResult&&(e.result&&e.result.entries.length>0?this.selectEntry(e.result.entries[0]):this.close())},this.sourceChanged=()=>{!this.inputRef||as||is||this.inputRef.focus()},this.getUrlSource=e=>e.get("media_source")||Object(Vi.g)(this.props.history.location).substring(7),this.getStoreAndHistoryState=e=>{const t=new URLSearchParams(e.history.location.search),n=e.mediaSearchStore.result,a={result:n,query:this.state.query||t.get("q")||""},i=this.getUrlSource(t);return a.showNav=!("false"===t.get("media_nav")),a.selectAction=t.get("selectAction")||"spawn",n&&n.suggestions&&n.suggestions.length>0?a.facets=n.suggestions.map(e=>({text:e,params:{q:e}})):a.facets=os[i]||[],a},this.handleQueryUpdated=(e,t)=>{this.setState({result:null}),this._sendQueryTimeout&&(clearTimeout(this._sendQueryTimeout),this._sendQueryTimeout=null),t?this.props.mediaSearchStore.filterQueryNavigate("",e):this._sendQueryTimeout=setTimeout(()=>{this.props.mediaSearchStore.filterQueryNavigate("",e),this._sendQueryTimeout=null},500),this.setState({query:e})},this.handleEntryClicked=(e,t)=>{e.preventDefault(),t.lucky_query?(this.setState({clearStashedQueryOnClose:!0}),this.handleQueryUpdated(t.lucky_query,!0)):this.selectEntry(t)},this.onShowSimilar=(e,t)=>{this.handleFacetClicked({params:{similar_to:e,similar_name:t}})},this.selectEntry=e=>{this.props.onMediaSearchResultEntrySelected&&(this.props.onMediaSearchResultEntrySelected(e,this.state.selectAction),this.close())},this.handleSourceClicked=e=>{this.props.mediaSearchStore.sourceNavigate(e)},this.handleFacetClicked=e=>{this.setState({query:""},()=>{const t=this.getSearchClearedSearchParams(!0,!0,!0);for(const[n,a]of Object.entries(e.params))t.set(n,a);Object(Vi.d)(this.props.history,this.props.history.location.pathname,t.toString())})},this.getSearchClearedSearchParams=(e,t,n)=>this.props.mediaSearchStore.getSearchClearedSearchParams(this.props.history.location,e,t,n),this.pushExitMediaBrowserHistory=(e=!0)=>{this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history,e)},this.showCustomMediaDialog=e=>{const{scene:t,store:n,hubChannel:a}=this.props,i="avatars"===e;this.pushExitMediaBrowserHistory(!i),"scenes"===e?this.props.showNonHistoriedDialog(fo,{hubChannel:a}):i?this.props.showNonHistoriedDialog(io,{scene:t,store:n}):this.props.showNonHistoriedDialog(Ao,{scene:t})},this.close=()=>{Object(_a.b)();const e=this.getUrlSource(new URLSearchParams(this.props.history.location.search));this.pushExitMediaBrowserHistory("avatars"!==e&&"favorites"!==e),this.state.clearStashedQueryOnClose&&this.props.mediaSearchStore.clearStashedQuery()},this.handlePager=e=>{this.setState({result:null}),this.props.mediaSearchStore.pageNavigate(e),this.browserDiv.scrollTop=0},this.handleCopyAvatar=(e,n)=>{e.preventDefault(),this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,ns((function*(){yield Object(it.h)(n.id,n.name),t.handleFacetClicked({params:{filter:"my-avatars"}})})),es.b.remixAvatar)},this.handleCopyScene=function(){var e=ns((function*(e,n){e.preventDefault(),t.props.performConditionalSignIn(()=>t.props.hubChannel.signedIn,ns((function*(){yield Object(m.e)("/api/v1/scenes","POST",{parent_scene_id:n.id}),t.handleFacetClicked({params:{filter:"my-scenes"}})})),es.b.remixScene)}));return function(t,n){return e.apply(this,arguments)}}(),this.onCreateAvatar=()=>{window.dispatchEvent(new CustomEvent("action_create_avatar"))},this.processThumbnailUrl=(e,t,n)=>"mp4"===e.images.preview.type?Object(Ut.j)(e.images.preview.url):Object(Ut.l)(e.images.preview.url,t,n),this.state=this.getStoreAndHistoryState(e),this.props.mediaSearchStore.addEventListener("statechanged",this.storeUpdated),this.props.mediaSearchStore.addEventListener("sourcechanged",this.sourceChanged)}componentDidMount(){}componentWillUnmount(){this.props.mediaSearchStore.removeEventListener("statechanged",this.storeUpdated),this.props.mediaSearchStore.removeEventListener("sourcechanged",this.sourceChanged)}render(){const e=this.props.intl,t=new URLSearchParams(this.props.history.location.search),n=this.getUrlSource(t),i="scenes"===n,r=!("favorites"===n)&&(!i||this.props.hubChannel.canOrWillIfCreator("update_hub")),o=this.state.result&&this.state.result.entries||[],s="favorites"===n,l="avatars"!==n&&"scenes"!==n,c=this.state.facets&&this.state.facets.length>0?this.state.facets:void 0;if(this.state.selectNextResult)return Hi.a.createElement("div",null);const d=e=>{"avatars"===e?this.showCustomMediaDialog(e):this.props.performConditionalSignIn(()=>!i||this.props.hubChannel.can("update_hub"),()=>this.showCustomMediaDialog(e),es.b.changeScene)},u=t.get("filter")||t.get("similar_to")&&"similar"||!t.get("q")&&"",h=this.state.result&&this.state.result.meta,p=!(!h||!h.next_cursor),f=!!t.get("cursor"),g=this.state.result&&i?"scene":"avatars"===n?"avatar":"object";let v;return s||"scenes"===n||"avatars"===n||"favorites"===n?"scenes"===n&&(v=Hi.a.createElement(Hi.a.Fragment,null,a.a.feature("enable_spoke")&&Hi.a.createElement(Hi.a.Fragment,null,e.formatMessage(ss.scenes,{editorName:Hi.a.createElement("a",{href:"/spoke",target:"_blank",rel:"noreferrer noopener"},a.a.translation("editor-name"))})),a.a.feature("enable_spoke")&&a.a.feature("show_issue_report_link")&&" | ",a.a.feature("show_issue_report_link")&&Hi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:a.a.link("issue_report","https://hubs.mozilla.com/docs/help.html")},Hi.a.createElement(Yi.a,{id:"media-browser.report-issue",defaultMessage:"Report Issue"})))):v=Hi.a.createElement(Hi.a.Fragment,null,ss[n]?e.formatMessage(ss[n]):"",ss[n]&&rs[n]?" | ":"",rs[n]&&Hi.a.createElement("a",{href:rs[n],target:"_blank",rel:"noreferrer noopener"},Hi.a.createElement(Yi.a,{id:"media-browser.privacy_policy",defaultMessage:"Privacy Policy"}))),Hi.a.createElement(Uo,{browserRef:e=>this.browserDiv=e,onClose:this.close,searchInputRef:e=>this.inputRef=e,autoFocusSearch:!as&&!is,query:this.state.query,onChangeQuery:e=>this.handleQueryUpdated(e.target.value),onSearchKeyDown:e=>{"Enter"===e.key&&e.ctrlKey?o.length>0&&!this._sendQueryTimeout?this.handleEntryClicked(e,o[0]):""!==this.state.query.trim()?(this.handleQueryUpdated(this.state.query,!0),this.setState({selectNextResult:!0})):this.close():("Escape"===e.key||"Enter"===e.key&&as)&&e.target.blur()},onClearSearch:()=>this.handleQueryUpdated("",!0),mediaSources:"favorites"===n?void 0:$r.a,selectedSource:n,onSelectSource:this.handleSourceClicked,activeFilter:u,facets:c,onSelectFacet:this.handleFacetClicked,searchPlaceholder:cs[n]?e.formatMessage(cs[n]):e.formatMessage(cs.default),searchDescription:v,headerRight:r&&Hi.a.createElement(Mr.a,{lg:!0,onClick:()=>d(n)},["scenes","avatars"].includes(n)?Hi.a.createElement(Zo,null):Hi.a.createElement(Xo,null),Hi.a.createElement("p",null,e.formatMessage(ls[g]))),hasNext:p,hasPrevious:f,onNextPage:()=>this.handlePager(1),onPreviousPage:()=>this.handlePager(-1),noResultsMessage:ds[n]?e.formatMessage(ds[n]):e.formatMessage(ds.default)},this.props.mediaSearchStore.isFetching||this._sendQueryTimeout||o.length>0||!l?Hi.a.createElement(Hi.a.Fragment,null,"avatars"===n&&Hi.a.createElement($o.a,{type:"avatar",onClick:this.onCreateAvatar,label:Hi.a.createElement(Yi.a,{id:"media-browser.create-avatar",defaultMessage:"Create Avatar"})}),"scenes"===n&&a.a.feature("enable_spoke")&&Hi.a.createElement($o.a,{as:"a",href:"/spoke/new",rel:"noopener noreferrer",target:"_blank",type:"scene",label:Hi.a.createElement(Yi.a,{id:"media-browser.create-scene",defaultMessage:"Create Scene with {editorName}",values:{editorName:a.a.translation("editor-name")}})}),o.map((e,t)=>{const n="avatar"===e.type||"avatar_listing"===e.type,a="scene"===e.type||"scene_listing"===e.type,i="avatar_listing"===e.type?t=>{t.preventDefault(),this.onShowSimilar(e.id,e.name)}:void 0;let r,o;return"avatar"===e.type?r=t=>{t.preventDefault(),Object(Vi.e)(this.props.history,"overlay","avatar-editor",{avatarId:e.id})}:"scene"===e.type&&(r=t=>{t.preventDefault();const n=Object(m.j)("/spoke/projects/".concat(e.project_id));window.open(n)}),n?o=t=>this.handleCopyAvatar(t,e):a&&(o=t=>this.handleCopyScene(t,e)),Hi.a.createElement($o.b,{key:"".concat(e.id,"_").concat(t),entry:e,processThumbnailUrl:this.processThumbnailUrl,onClick:t=>this.handleEntryClicked(t,e),onEdit:r,onShowSimilar:i,onCopy:o})})):null)}}us.propTypes={mediaSearchStore:Ui.a.object,history:Ui.a.object,intl:Ui.a.object,hubChannel:Ui.a.object,onMediaSearchResultEntrySelected:Ui.a.func,performConditionalSignIn:Ui.a.func,showNonHistoriedDialog:Ui.a.func.isRequired,scene:Ui.a.object.isRequired,store:Ui.a.object.isRequired};var hs=Object(Zr.c)(us);class ps extends Li.Component{componentDidMount(){this.props.entering&&this.props.onEnteringCanceled()}render(){return null}}ps.propTypes={entering:Ui.a.bool,onEnteringCanceled:Ui.a.func};var ms=n(474),fs=n.n(ms),gs=n(475),vs=n.n(gs),bs=n(365),ys=n(608),Es=n(60),ws=n(360),_s=n(786),Ss=n.n(_s);function xs(){return(xs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function As(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Ms(e,t,n[t])}))}return e}function Ms(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ks(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Os(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){ks(r,a,i,o,s,"next",e)}function s(e){ks(r,a,i,o,s,"throw",e)}o(void 0)}))}}const Cs=Object(Jr.a)({id:"avatar-editor.delist-avatar-info",defaultMessage:"Other users already using this avatar will still be able to use it, but it will be removed from 'My Avatars' and search results."}),Ps=[{name:"Quilt",url:"https://tryquilt.io/?gltf=$AVATAR_GLTF"}],Rs=[...Ps,{name:"Skindex Editor",url:"https://www.minecraftskins.com/skin-editor"},{name:"MinecraftSkins.net Editor",url:"https://www.minecraftskins.net/skineditor"}],Ts=function(){var e=Os((function*(e){const{avatars:t}=yield Object(m.e)("".concat("/api/v1/avatars","/").concat(e));return t[0]}));return function(t){return e.apply(this,arguments)}}();class js{constructor(e){this.parser=e,this.gltf=null,this.bin=null}beforeRoot(){const e=this.parser,{body:t}=e.extensions.KHR_binary_glTF,n=JSON.stringify(Object(it.c)(e.json));this.gltf=new File([n],"file.gltf",{type:"model/gltf"}),this.bin=new File([t],"file.bin",{type:"application/octet-stream"}),e.json={asset:{version:"2.0"}}}afterRoot(e){e.files=e.files||{},e.files.gltf=this.gltf,e.files.bin=this.bin}}class Ds extends Li.Component{constructor(e){var t;super(e),t=this,this.state={baseAvatarResults:[],editorLinks:Ps,previewGltfUrl:null},this.componentDidMount=Os((function*(){if(t.props.avatarId){const e=yield Ts(t.props.avatarId);e.creatorAttribution=e.attributions&&e.attributions.creator||"",Object.assign(t.inputFiles,e.files),t.setState({avatar:e,previewGltfUrl:e.base_gltf_url})}else{const{entries:e}=yield Object(m.e)("/api/v1/media/search?filter=base&source=avatar_listings"),n=e.map(e=>({id:e.id,name:e.name,gltfs:e.gltfs,images:e.images}));if(n.length){const e=n[Math.floor(Math.random()*n.length)];t.setState({baseAvatarResults:n,avatar:{name:"My Avatar",files:{},base_gltf_url:e.gltfs.base,parent_avatar_listing_id:e.id},previewGltfUrl:e.gltfs.avatar})}else t.setState({avatar:{name:"My Avatar",files:{}}})}})),this.createOrUpdateAvatar=e=>Object(m.e)(e.avatar_id?"".concat("/api/v1/avatars","/").concat(e.avatar_id):"/api/v1/avatars",e.avatar_id?"PUT":"POST",{avatar:e}).then(({avatars:e})=>e[0]),this.uploadAvatar=function(){var e=Os((function*(e){if(e.preventDefault(),t.inputFiles.glb&&t.inputFiles.glb instanceof File){const e=(new THREE.GLTFLoader).register(e=>new js(e)),n=URL.createObjectURL(t.inputFiles.glb),a=console.log;yield new Promise((i,r)=>{e.load(n,e=>{t.inputFiles.gltf=e.files.gltf,t.inputFiles.bin=e.files.bin,i(e)},a,r)}),URL.revokeObjectURL(n)}t.inputFiles.thumbnail=new File([yield t.preview.snapshot()],"thumbnail.png",{type:"image/png"});const n=["gltf","bin","base_map","emissive_map","normal_map","orm_map","thumbnail"].filter(e=>null===t.inputFiles[e]||t.inputFiles[e]instanceof File);t.setState({uploading:!0});const a=yield Promise.all(n.map(e=>t.inputFiles[e]&&Object(te.p)(t.inputFiles[e]))),i=As({},t.state.avatar,{attributions:{creator:t.state.avatar.creatorAttribution},files:a.map((e,t)=>[n[t],e&&[e.file_id,e.meta.access_token,e.meta.promotion_token]]).reduce((e,[t,n])=>As({},e,{[t]:n}),{})});yield t.createOrUpdateAvatar(i),t.setState({uploading:!1}),t.props.onSave&&t.props.onSave()}));return function(t){return e.apply(this,arguments)}}(),this.deleteAvatar=function(){var e=Os((function*(e){e.preventDefault(),yield Object(m.e)("".concat("/api/v1/avatars","/").concat(t.state.avatar.avatar_id),"DELETE"),t.props.onSave&&t.props.onSave()}));return function(t){return e.apply(this,arguments)}}(),this.fileField=(e,t,n,a=!1,i)=>Hi.a.createElement("div",{className:Wi()("file-input-row",{disabled:a}),key:e,title:i},Hi.a.createElement("label",{htmlFor:"avatar-file_".concat(e)},Hi.a.createElement("div",{className:"img-box"}),Hi.a.createElement("span",null,t)),Hi.a.createElement("input",{id:"avatar-file_".concat(e),type:"file",accept:n,disabled:a,onChange:t=>{const n=t.target.files[0];t.target.value=null,this.inputFiles[e]=n,URL.revokeObjectURL(this.state.previewGltfUrl);const a=URL.createObjectURL(this.inputFiles.glb);this.setState({previewGltfUrl:a,avatar:As({},this.state.avatar,{files:As({},this.state.avatar.files,{[e]:URL.createObjectURL(n)})})})}}),this.state.avatar.files[e]&&Hi.a.createElement("a",{onClick:()=>{this.inputFiles[e]=null,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:As({},this.state.avatar,{files:As({},this.state.avatar.files,{[e]:null})})},()=>this.setState({previewGltfUrl:this.getPreviewUrl()}))}},Hi.a.createElement("i",null,Hi.a.createElement(Es.a,{icon:bs.faTimes})))),this.mapField=(e,t,n,a=!1,i)=>Hi.a.createElement("div",{className:"file-input-row",key:e,title:i},Hi.a.createElement("label",{htmlFor:"avatar-file_".concat(e)},Hi.a.createElement("div",{className:"img-box"},this.state.avatar.files[e]?Hi.a.createElement("img",{src:this.state.avatar.files[e]}):Hi.a.createElement(Es.a,{icon:ys.faCloudUploadAlt})),Hi.a.createElement("span",null,t)),Hi.a.createElement("input",{id:"avatar-file_".concat(e),type:"file",accept:n,disabled:a,onChange:t=>{const n=t.target.files[0];t.target.value=null,this.inputFiles[e]=n,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:As({},this.state.avatar,{files:As({},this.state.avatar.files,{[e]:URL.createObjectURL(n)})})})}}),this.state.avatar.files[e]&&Hi.a.createElement("a",{onClick:()=>{this.inputFiles[e]=null,URL.revokeObjectURL(this.state.avatar.files[e]),this.setState({avatar:As({},this.state.avatar,{files:As({},this.state.avatar.files,{[e]:null})})})}},Hi.a.createElement("i",null,Hi.a.createElement(Es.a,{icon:bs.faTimes})))),this.textField=(e,t,n,a)=>Hi.a.createElement("div",{className:"text-field-container"},Hi.a.createElement("label",{htmlFor:"#avatar-".concat(e)},t),Hi.a.createElement("input",{id:"avatar-".concat(e),type:"text",disabled:n,required:a,placeholder:t,className:"text-field",value:this.state.avatar[e]||"",onChange:t=>this.setState({avatar:As({},this.state.avatar,{[e]:t.target.value})})})),this.getPreviewUrl=e=>{if(e){const t=this.state.baseAvatarResults.find(t=>t.id===e);if(t)return t.gltfs.avatar}return this.inputFiles.glb?URL.createObjectURL(this.inputFiles.glb):this.state.avatar.base_gltf_url},this.selectListingField=(e,n)=>Hi.a.createElement("div",{className:"select-container"},Hi.a.createElement("label",{htmlFor:"#avatar-".concat(e)},n),Hi.a.createElement("select",{id:"avatar-".concat(e),value:this.state.avatar[e]||"",onChange:function(){var n=Os((function*(n){const a=n.target.value;t.setState({avatar:As({},t.state.avatar,{[e]:a}),previewGltfUrl:t.getPreviewUrl(a)})}));return function(e){return n.apply(this,arguments)}}(),placeholder:n,className:"select"},this.state.baseAvatarResults.map(e=>Hi.a.createElement("option",{key:e.id,value:e.id},e.name)),Hi.a.createElement("option",{value:""},Hi.a.createElement(Yi.a,{id:"avatar-editor.custom-avatar-option",defaultMessage:"Custom GLB..."}))),Hi.a.createElement("img",{className:"arrow",src:fs.a,srcSet:vs.a+" 2x"})),this.selectListingGrid=(e,t)=>Hi.a.createElement("div",{className:"select-grid-container"},Hi.a.createElement("label",{htmlFor:"#avatar-".concat(e)},t),Hi.a.createElement("div",{className:"select-grid"},this.state.baseAvatarResults.map(t=>Hi.a.createElement("div",{onClick:()=>this.setState({avatar:As({},this.state.avatar,{[e]:t.id}),previewGltfUrl:this.getPreviewUrl(t.id)}),key:t.id,className:Wi()("item",{selected:t.id===this.state.avatar[e]}),style:{paddingBottom:"".concat(t.images.preview.width/t.images.preview.height*100,"%")}},Hi.a.createElement("img",{src:t.images.preview.url})))),Hi.a.createElement("input",{id:"avatar-file_glb",type:"file",accept:"model/gltf+binary,.glb",onChange:t=>{const n=t.target.files[0];t.target.value=null,this.inputFiles.glb=n,URL.revokeObjectURL(this.state.avatar.files.glb),this.setState({avatar:As({},this.state.avatar,{[e]:"",files:As({},this.state.avatar.files,{glb:URL.createObjectURL(n)})}),previewGltfUrl:this.getPreviewUrl("")})}}),Hi.a.createElement("label",{htmlFor:"avatar-file_glb",className:Wi()("item","custom",{selected:""===this.state.avatar[e]})},Hi.a.createElement(Yi.a,{id:"avatar-editor.upload-custom-avatar-button",defaultMessage:"{icon} Custom GLB",values:{icon:Hi.a.createElement(Es.a,{icon:ys.faCloudUploadAlt})}}))),this.textarea=(e,t,n)=>Hi.a.createElement("div",null,Hi.a.createElement("textarea",{id:"avatar-".concat(e),disabled:n,placeholder:t,className:"textarea",value:this.state.avatar[e]||"",onChange:t=>this.setState({avatar:As({},this.state.avatar,{[e]:t.target.value})})})),this.checkbox=(e,t,n,a)=>Hi.a.createElement("div",{className:"checkbox-container",title:t},Hi.a.createElement("input",{id:"avatar-".concat(e),type:"checkbox",className:"checkbox",disabled:a,checked:!!this.state.avatar[e],onChange:t=>this.setState({avatar:As({},this.state.avatar,{[e]:t.target.checked})})}),Hi.a.createElement("label",{htmlFor:"#avatar-".concat(e)},n)),this.handleGltfLoaded=e=>{const t=e.parser.json.extensions&&e.parser.json.extensions.MOZ_hubs_avatar;let n=t&&t.editors||Ps;n=n.filter(e=>Rs.some(t=>t.name===e.name&&t.url===e.url)),this.setState({editorLinks:n})},this.inputFiles={}}render(){const{debug:e,intl:t}=this.props,{avatar:n}=this.state;return Hi.a.createElement("div",{className:Wi()(Ss.a.avatarEditor,this.props.className)},this.props.onClose&&Hi.a.createElement("a",{className:"close-button",onClick:this.props.onClose},Hi.a.createElement("i",null,Hi.a.createElement(Es.a,{icon:bs.faTimes}))),this.state.avatar?Hi.a.createElement("form",{onSubmit:this.uploadAvatar,className:"center"},this.textField("name","Name",!1,!0),Hi.a.createElement("div",{className:"split"},Hi.a.createElement("div",{className:"form-body"},e&&this.textField("avatar_id",t.formatMessage({id:"avatar-editor.field.avatar-id",defaultMessage:"Avatar ID"}),!0),e&&this.textField("parent_avatar_id",t.formatMessage({id:"avatar-editor.field.parent-avatar-id",defaultMessage:"Parent Avatar ID"})),e&&this.textField("parent_avatar_listing_id",t.formatMessage({id:"avatar-editor.field.parent-avatar-listing-id",defaultMessage:"Parent Avatar Listing ID"})),e&&this.textarea("description",t.formatMessage({id:"avatar-editor.field.description",defaultMessage:"Description"})),!this.props.avatarId&&this.selectListingGrid("parent_avatar_listing_id",t.formatMessage({id:"avatar-editor.field.model",defaultMessage:"Model"})),Hi.a.createElement("label",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.skin-section",defaultMessage:"Skin"})),this.mapField("base_map",t.formatMessage({id:"avatar-editor.field.base-map",defaultMessage:"Base Map"}),"image/*"),Hi.a.createElement("details",null,Hi.a.createElement("summary",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.advanced-section",defaultMessage:"Advanced"})),this.mapField("emissive_map",t.formatMessage({id:"avatar-editor.field.emissive-map",defaultMessage:"Emissive Map"}),"image/*"),this.mapField("normal_map",t.formatMessage({id:"avatar-editor.field.normal-map",defaultMessage:"Normal Map"}),"image/*"),this.mapField("orm_map",t.formatMessage({id:"avatar-editor.field.orm-map",defaultMessage:"ORM Map"}),"image/*",!1,t.formatMessage({id:"avatar-editor.field.orm-map-info",defaultMessage:"Occlussion (r), Roughness (g), Metallic (b)"}))),Hi.a.createElement("label",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.share-settings",defaultMessage:"Share Settings"})),this.checkbox("allow_promotion",t.formatMessage({id:"avatar-editor.field.allow-promotion",defaultMessage:"Allow {companyName} to promote your avatar, and show it in search results."},{companyName:a.a.translation("company-name")}),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.field.allow-promotion-checkbox",defaultMessage:"Allow <a>Promotion</a>",values:{a:e=>Hi.a.createElement("a",{href:a.a.link("promotion","https://github.com/mozilla/hubs/blob/master/PROMOTION.md"),target:"_blank",rel:"noopener noreferrer"},e)}}))),this.checkbox("allow_remixing",t.formatMessage({id:"avatar-editor.field.allow-remixing",defaultMessage:"Allow others to edit and re-publish your avatar as long as they give you credit."}),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.field.allow-remixing-checkbox",defaultMessage:"Allow <a>Remixing</a> <license>(under <licenselink>CC-BY 3.0</licenselink>)</license>",values:{a:e=>Hi.a.createElement("a",{href:a.a.link("remixing","https://github.com/mozilla/hubs/blob/master/REMIXING.md"),target:"_blank",rel:"noopener noreferrer"},e),license:e=>Hi.a.createElement("span",{className:"license"},e),licenselink:e=>Hi.a.createElement("a",{href:"https://creativecommons.org/licenses/by/3.0/",target:"_blank",rel:"noopener noreferrer"},e)}}))),this.textField("creatorAttribution",t.formatMessage({id:"avatar-editor.field.creator-attribution",defaultMessage:"Attribution (optional)"}),!1,!1)),Hi.a.createElement(Gr.a,xs({className:"preview",avatarGltfUrl:this.state.previewGltfUrl,onGltfLoaded:this.handleGltfLoaded},this.inputFiles,{ref:e=>this.preview=e}))),Hi.a.createElement("div",{className:"info"},Hi.a.createElement(ws.a,{name:"show_avatar_editor_link"},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.external-editor-info",defaultMessage:"Create a custom skin for this avatar:"})," ",this.state.editorLinks.map(({name:e,url:t})=>Hi.a.createElement("a",{key:e,target:"_blank",rel:"noopener noreferrer",href:t.replace("$AVATAR_GLTF",encodeURIComponent(this.state.previewGltfUrl))},e)))),Hi.a.createElement(ws.a,{name:"show_avatar_pipelines_link"},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.info",defaultMessage:"Find more custom avatar resources <a>here</a>",values:{a:e=>Hi.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/MozillaReality/hubs-avatar-pipelines"},e)}})))),Hi.a.createElement("div",null,Hi.a.createElement("button",{disabled:this.state.uploading,className:"form-submit",type:"submit"},this.state.uploading?Hi.a.createElement(Yi.a,{id:"avatar-editor.submit-button.uploading",defaultMessage:"Uploading..."}):Hi.a.createElement(Yi.a,{id:"avatar-editor.submit-button.save",defaultMessage:"Save"}))),!this.props.hideDelete&&Hi.a.createElement("div",{className:"delete-avatar"},this.state.confirmDelete?Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"avatar-editor.delete-avatar.confirmation-prompt",defaultMessage:"Are you sure?"})," ",Hi.a.createElement("a",{onClick:this.deleteAvatar},Hi.a.createElement(Yi.a,{id:"avatar-editor.delete-avatar.confirm",defaultMessage:"yes"}))," ","/"," ",Hi.a.createElement("a",{onClick:()=>this.setState({confirmDelete:!1})},Hi.a.createElement(Yi.a,{id:"avatar-editor.delete-avatar.cancel",defaultMessage:"no"}))):Hi.a.createElement("a",{onClick:()=>this.setState({confirmDelete:!0}),title:n.has_listings?t.formatMessage(Cs):""},n.has_listings?Hi.a.createElement(Yi.a,{id:"avatar-editor.delist-avatar-button",defaultMessage:"Delist Avatar"}):Hi.a.createElement(Yi.a,{id:"avatar-editor.delete-avatar-button",defaultMessage:"Delete Avatar"})))):Hi.a.createElement("div",{className:"loader"},Hi.a.createElement("div",{className:"loader-center"})))}}Ds.propTypes={avatarId:Ui.a.string,onSave:Ui.a.func,onClose:Ui.a.func,hideDelete:Ui.a.bool,debug:Ui.a.bool,className:Ui.a.string,intl:Ui.a.object.isRequired};var Is=Object(Zr.c)(Ds),Ls=n(787),Hs=n(788),Ns=n(44),Fs=n.n(Ns),Vs=n(20),Bs=n(21);function Us(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function zs(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Us(r,a,i,o,s,"next",e)}function s(e){Us(r,a,i,o,s,"throw",e)}o(void 0)}))}}const Ws=AFRAME.utils.device.isMobile(),qs=Object(u.b)(),Gs=[/\Wvive\W/i,/\Wrift\W/i],Ys="sinkId"in HTMLMediaElement.prototype,Ks=Object(p.detectOS)(navigator.userAgent),Xs=Object(p.detect)(),Qs=!(["iOS","Mac OS"].includes(Ks)&&["safari","ios"].includes(Xs.name));class Js extends P.EventEmitter{constructor(e,t,n){super(),this.onDeviceChange=()=>{this.fetchMediaDevices().then(()=>{this.changeAudioOutput(this.selectedSpeakersDeviceId),this.emit(T.b.DEVICE_CHANGE,null)})},this._scene=e,this._store=t,this._micDevices=[],this._videoDevices=[],this._outputDevices=[],this._deviceId=null,this._audioTrack=null,this.audioSystem=n,this._mediaStream=n.outboundStream,this._permissionsStatus={[T.a.MICROPHONE]:T.d.PROMPT,[T.a.SPEAKERS]:T.d.PROMPT,[T.a.CAMERA]:T.d.PROMPT,[T.a.SCREEN]:T.d.PROMPT},this.onDeviceChange=this.onDeviceChange.bind(this),navigator.mediaDevices.addEventListener("devicechange",this.onDeviceChange)}static get isAudioOutputSelectEnabled(){return Ys}static get isAudioInputSelectEnabled(){return Qs}get deviceId(){return this._deviceId}set deviceId(e){this._deviceId=e}get audioTrack(){return this._audioTrack}set audioTrack(e){this._audioTrack=e}get defaultInputDeviceId(){return this._micDevices.length>0?this._micDevices[0].value:T.c}get defaultOutputDeviceId(){return this._outputDevices.length>0?this._outputDevices[0].value:T.c}get defaultVideoDeviceId(){return this._videoDevices.length>0?this._videoDevices[0].value:T.c}get micDevicesOptions(){return this._micDevices.length>0?this._micDevices:[{value:T.c,label:"None"}]}get videoDevicesOptions(){return this._videoDevices.length>0?this._videoDevices:[{value:T.c,label:"None"}]}get outputDevicesOptions(){return this._outputDevices.length>0?this._outputDevices:[{value:T.c,label:"None"}]}get mediaStream(){return this._mediaStream}set mediaStream(e){this._mediaStream=e}get selectedMicLabel(){return this.micLabelForAudioTrack(this.audioTrack)}get selectedMicDeviceId(){return Js.isAudioInputSelectEnabled&&this._permissionsStatus[T.a.MICROPHONE]!==T.d.GRANTED?T.c:this.deviceIdForMicDeviceLabel(this.selectedMicLabel)}get selectedSpeakersDeviceId(){const{preferredSpeakers:e}=this._store.state.preferences;return this._outputDevices.some(t=>t.value===e)?e:this.defaultOutputDeviceId}get isMicShared(){return null!==this.audioTrack&&this.getPermissionsStatus(T.a.MICROPHONE)===T.d.GRANTED}get isVideoShared(){var e;return(null===(e=this._mediaStream)||void 0===e?void 0:e.getVideoTracks().length)>0}get isWebcamShared(){return this._mediaStream.getVideoTracks().some(e=>{e._hubs_contentHint,T.a.CAMERA})}get isScreenShared(){return this._mediaStream.getVideoTracks().some(e=>{e._hubs_contentHint,T.a.SCREEN})}set micEnabled(e){APP.dialog.enableMicrophone(e)}get isMicEnabled(){return APP.dialog.isMicEnabled}toggleMic(){APP.dialog.toggleMicrophone()}getPermissionsStatus(e){return this._permissionsStatus[e]}updatePermissions(){const e=0===this._micDevices.length?T.d.PROMPT:T.d.GRANTED;this._permissionsStatus[T.a.MICROPHONE]=e,this.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:T.a.MICROPHONE,status:e});const t=0===this._videoDevices.length?T.d.PROMPT:T.d.GRANTED;this._permissionsStatus[T.a.CAMERA]=t,this.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:T.a.CAMERA,status:t});const n=0===this._micDevices.length?T.d.PROMPT:T.d.GRANTED;this._permissionsStatus[T.a.SPEAKERS]=n,this.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:T.a.SPEAKERS,status:n})}fetchMediaDevices(){var e=this;return zs((function*(){return console.log("Fetching media devices"),new Promise(t=>{navigator.mediaDevices.enumerateDevices().then(n=>{n=n.filter(e=>""!==e.label),e._micDevices=n.filter(e=>"default"!==e.deviceId&&"audioinput"===e.kind).map(e=>({value:e.deviceId,label:e.label||"Mic Device (".concat(e.deviceId.substring(0,9),")")})),e._videoDevices=n.filter(e=>"default"!==e.deviceId&&"videoinput"===e.kind).map(e=>({value:e.deviceId,label:e.label||"Camera Device (".concat(e.deviceId.substring(0,9),")")})),Js.isAudioOutputSelectEnabled&&(e._outputDevices=n.filter(e=>"default"!==e.deviceId&&"audiooutput"===e.kind).map(e=>({value:e.deviceId,label:e.label||"Audio Output (".concat(e.deviceId.substring(0,9),")")}))),e.updatePermissions(),t()})})}))()}changeAudioOutput(e){this._store.update({preferences:{preferredSpeakers:e}})}startMicShare({deviceId:e,unmute:t,updatePrefs:n=!0}){var a=this;return zs((function*(){if(a.isMicShared&&a.selectedMicDeviceId===e)return;if(console.log("Starting microphone sharing"),!e){const{preferredMic:t}=a._store.state.preferences;e=t!==T.c?t:void 0}let i={audio:{}};e&&(i={audio:{deviceId:{ideal:[e]}}});const r=yield a._startMicShare(i);if(yield a.fetchMediaDevices(),a.audioTrack){const e=a.deviceIdForMicDeviceLabel(a.micLabelForAudioTrack(a.audioTrack));e&&(n&&a._store.update({preferences:{preferredMic:e,preferredSpeakers:a.selectedSpeakersDeviceId}}),console.log("Selected input device: ".concat(a.micLabelForDeviceId(e))))}else console.log("No available audio tracks");return yield APP.dialog.setLocalMediaStream(a._mediaStream),t&&APP.dialog.enableMicrophone(!0),r?(a._permissionsStatus[T.a.MICROPHONE]=T.d.GRANTED,a._scene.emit(T.b.MIC_SHARE_STARTED),a.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:T.a.MICROPHONE,status:T.d.GRANTED})):(a._permissionsStatus[T.a.MICROPHONE]=T.d.DENIED,a._scene.emit(T.b.MIC_SHARE_ENDED),a.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:T.a.MICROPHONE,status:T.d.DENIED})),r}))()}_startMicShare(e={audio:{}}){var t=this;return zs((function*(){t.audioTrack&&t.audioTrack.stop(),e.audio.echoCancellation=!t._store.state.preferences.disableEchoCancellation,e.audio.noiseSuppression=!t._store.state.preferences.disableNoiseSuppression,e.audio.autoGainControl=!t._store.state.preferences.disableAutoGainControl;try{console.log("Adding microphone media stream");const n=yield navigator.mediaDevices.getUserMedia(e);if(t.audioSystem.addStreamToOutboundAudio("microphone",n),t.audioTrack=n.getAudioTracks()[0],t.audioTrack.addEventListener("ended",zs((function*(){t._scene.emit(T.b.MIC_SHARE_ENDED),t.startMicShare({unmute:t.isMicEnabled})}))),/Oculus/.test(navigator.userAgent)){const n=function(){var a=zs((function*(){console.warn("Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.");const a=yield navigator.mediaDevices.getUserMedia(e);t.audioTrack=a.getAudioTracks()[0],t.audioSystem.addStreamToOutboundAudio("microphone",a),t._scene.emit(T.b.MIC_SHARE_STARTED),t.audioTrack.addEventListener("ended",n,{once:!0})}));return function(){return a.apply(this,arguments)}}();t.audioTrack.addEventListener("ended",n,{once:!0})}return!0}catch(e){return console.error("Error during getUserMedia: ",e),t.audioTrack=null,!1}}))()}stopMicShare(){var e=this;return zs((function*(){var t;e.audioSystem.removeStreamFromOutboundAudio("microphone"),null===(t=e.audioTrack)||void 0===t||t.stop(),e.audioTrack=null,yield APP.dialog.setLocalMediaStream(e._mediaStream),APP.dialog.enableMicrophone(!1)}))()}startVideoShare({isDisplayMedia:e,target:t,success:n,error:a}){var i=this;return zs((function*(){let r,o=!1;try{r=e?yield navigator.mediaDevices.getDisplayMedia({video:{width:screen.width/screen.height*720,height:720,frameRate:30},audio:{echoCancellation:!0!==window.APP.store.state.preferences.disableEchoCancellation,noiseSuppression:!0!==window.APP.store.state.preferences.disableNoiseSuppression,autoGainControl:!0!==window.APP.store.state.preferences.disableAutoGainControl}}):yield navigator.mediaDevices.getUserMedia({video:{width:qs?{max:1280}:{max:1280,ideal:720},frameRate:30}});if((r?r.getVideoTracks():[]).length>0){o=!0,r.getVideoTracks().forEach(t=>{t._hubs_contentHint=e?T.a.SCREEN:T.a.CAMERA,t.addEventListener("ended",zs((function*(){i._scene.emit(T.b.VIDEO_SHARE_ENDED)}))),i._mediaStream.addTrack(t)}),r&&r.getAudioTracks().length>0&&i.audioSystem.addStreamToOutboundAudio("screenshare",r),yield APP.dialog.setLocalMediaStream(i._mediaStream);const t=e?T.a.SCREEN:T.a.CAMERA;i._permissionsStatus[t]=T.d.GRANTED,i._scene.emit(T.b.VIDEO_SHARE_STARTED),i.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:t,status:T.d.GRANTED})}}catch(t){a(t);const n=e?T.a.SCREEN:T.a.CAMERA;return i._permissionsStatus[n]=T.d.DENIED,i._scene.emit(T.b.VIDEO_SHARE_ENDED),void i.emit(T.b.PERMISSIONS_STATUS_CHANGED,{mediaDevice:n,status:T.d.DENIED})}n(e,o,t)}))()}stopVideoShare(){var e=this;return zs((function*(){if(e._mediaStream){for(const t of e._mediaStream.getVideoTracks())t.stop(),e._mediaStream.removeTrack(t);e.audioSystem.removeStreamFromOutboundAudio("screenshare"),yield APP.dialog.setLocalMediaStream(e._mediaStream)}}))()}shouldShowHmdMicWarning(){var e=this;return zs((function*(){return!Ws&&!AFRAME.utils.device.isMobileVR()&&(!!e.state.enterInVR&&(!!e.hasHmdMicrophone()&&!Gs.find(t=>e.selectedMicLabel.match(t))))}))()}micLabelForAudioTrack(e){const t=e&&e.label||"";return t.indexOf("Default - ")<0?t:t.substring(10)}deviceIdForMicDeviceLabel(e){return this._micDevices.filter(t=>t.label===e).map(e=>e.value)[0]||this.defaultInputDeviceId}deviceIdForSpeakersDeviceLabel(e){return this._outputDevices.filter(t=>t.label===e).map(e=>e.value)[0]||this.defaultOutputDeviceId}micLabelForDeviceId(e){return this._micDevices.filter(t=>t.value===e).map(e=>e.label)[0]}speakersLabelForDeviceId(e){return this._outputDevices.filter(t=>t.value===e).map(e=>e.label)[0]}hasHmdMicrophone(){return!!this.state._micDevices.find(e=>Gs.find(t=>e.label.match(t)))}videoDeviceIdForMicLabel(e){return this._videoDevices.filter(t=>t.label===e).map(e=>e.value)[0]}videoLabelForDeviceId(e){return this._videoDevices.filter(t=>t.value===e).map(e=>e.label)[0]}}var Zs=n(432),$s=n.n(Zs);function el(){return(el=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function tl(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function nl(e,t,n){if(e){const a=((parseFloat(e.value)-t)/(n-t)).toFixed(2);e.style.backgroundImage=function(e,t,n){return["-webkit-gradient(","linear, ","left top, ","right top, ","color-stop("+e+", "+t+"), ","color-stop("+e+", "+n+")",")"].join("")}(a,Zs.trackColor,"transparent")}}const al=Object(Li.memo)(e=>{let{min:t,max:n,step:a,value:i,onChange:r,disabled:o,className:s}=e,l=tl(e,["min","max","step","value","onChange","disabled","className"]);const c=Object(Li.useRef)();return Object(Li.useEffect)(()=>{nl(c.current,t,n)}),Hi.a.createElement("div",{className:Wi()($s.a.numberWithRange,s)},Hi.a.createElement("div",{className:Wi()($s.a.rangeSlider),disabled:o},Hi.a.createElement("input",el({ref:c,type:"range",step:a,min:t,max:n,value:i,disabled:o,onChange:e=>{void 0===i&&nl(c.current,t,n),r&&r(parseFloat(e.target.value))}},l))))});function il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){rl(e,t,n[t])}))}return e}function rl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}al.propTypes={min:Ui.a.number,max:Ui.a.number,step:Ui.a.number,value:Ui.a.number,disabled:Ui.a.bool,onChange:Ui.a.func,className:Ui.a.string},al.defaultProps={min:0,max:100,step:1,disabled:!1};function ol(){return Hi.a.createElement("i",{className:Fs.a.flex},Hi.a.createElement(Es.a,{className:Fs.a.warnIcon,icon:Hs.faExclamationTriangle}))}function sl({onClick:e}){const t=Object(po.a)().formatMessage({id:"preferences-screen.reset-to-default",defaultMessage:"Reset preference to default"});return Hi.a.createElement("button",{className:Fs.a.noDefaultButtonStyle,title:t,"aria-label":t,onClick:e},Hi.a.createElement("i",{className:Fs.a.flex},Hi.a.createElement(Es.a,{className:Wi()(Fs.a.resetToDefaultButton),icon:Ls.faUndo})))}function ll(){return Hi.a.createElement("div",{className:Fs.a.resetToDefaultButtonPlaceholder})}function cl(e){const t=(e=e.replace(/[^0-9.]/g,"")).split(".");return t.length>1?"".concat(t.shift(),".").concat(t.join("")):e}function dl(e){const t=e.split(".");return t.length>1&&t[1].length||0}sl.propTypes={onClick:Ui.a.func};class ul extends Li.Component{constructor(e){super(e),this.state={isFocused:!1,displayValue:"",digitsFromUser:0},this.storeUpdated=this.storeUpdated.bind(this)}storeUpdated(){if(!this.state.isFocused){const e=Math.max(this.state.digitsFromUser,this.props.digits);this.setState({displayValue:this.props.store.state.preferences[this.props.storeKey].toFixed(e)})}this.forceUpdate()}componentDidMount(){this.props.store.addEventListener("statechanged",this.storeUpdated),this.setState({displayValue:this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits)})}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated)}render(){return Hi.a.createElement("div",{className:Wi()(Fs.a.numberWithRange)},Hi.a.createElement("div",{className:Wi()(Fs.a.numberInNumberWithRange)},Hi.a.createElement("input",{type:"text",value:this.state.displayValue,onClick:e=>{e.target.focus(),e.target.select()},onBlur:e=>{const t=cl(e.target.value),n=isNaN(parseFloat(t))?void 0:parseFloat(t);this.setState({displayValue:void 0===n?this.props.store.state.preferences[this.props.storeKey].toFixed(this.props.digits):Math.min(Math.max(this.props.min,n),this.props.max).toFixed(this.props.digits),isFocused:!1})},onFocus:()=>{this.setState({isFocused:!0})},onChange:e=>{const t=cl(e.target.value),n=isNaN(parseFloat(t))?void 0:parseFloat(t),a=Math.min(Math.max(this.props.min,n),this.props.max);this.setState({displayValue:void 0===n?"":a,digitsFromUser:dl(t)}),this.props.setValue(void 0===n?parseFloat(this.props.store.state.preferences[this.props.storeKey]):a)}})),Hi.a.createElement(al,{step:this.props.step,min:this.props.min,max:this.props.max,value:this.props.store.state.preferences[this.props.storeKey],onChange:e=>{const t=e.toFixed(this.props.digits);this.setState({displayValue:t,digitsFromUser:0}),this.props.setValue(parseFloat(t))}}))}}function hl(){return Hi.a.createElement("div",{className:Fs.a.checkboxPlaceholder})}function pl({store:e,storeKey:t,setValue:n}){const a=e.state.preferences[t];return Hi.a.createElement("input",{tabIndex:"0",type:"checkbox",checked:a,onChange:()=>{n(!a)}})}function ml({store:e,storeKey:t,defaultValue:n,text:a}){const i=e.state.preferences[t],r=i?Object.keys(i).length:n;return Hi.a.createElement("span",{className:Fs.a.preferenceLabel},r," ",a)}ul.propTypes={min:Ui.a.number,max:Ui.a.number,step:Ui.a.number,digits:Ui.a.number,store:Ui.a.object,storeKey:Ui.a.string,setValue:Ui.a.func},pl.propTypes={store:Ui.a.object,storeKey:Ui.a.string,setValue:Ui.a.func},ml.propTypes={store:Ui.a.object,storeKey:Ui.a.string,defaultValue:Ui.a.number,text:Ui.a.string};class fl extends Hi.a.Component{render(){return Hi.a.createElement("div",{className:Fs.a.dropdown},Hi.a.createElement("select",{value:this.props.value,tabIndex:"0",onChange:this.props.onChange},this.props.children),Hi.a.createElement("img",{className:Fs.a.dropdownArrow,src:fs.a,srcSet:vs.a+" 2x"}))}}fl.propTypes={children:Ui.a.node.isRequired,value:Ui.a.string,onChange:Ui.a.func};class gl extends Hi.a.Component{constructor(){super()}render(){const e=this.props.options.map(({text:e,value:t},n)=>Hi.a.createElement("option",{key:"option_".concat(this.props.storeKey,"_").concat(n),value:t},e));return Hi.a.createElement(fl,{value:this.props.store.state.preferences[this.props.storeKey],onChange:e=>{this.props.setValue(e.target.value),this.props.onChanged&&this.props.onChanged(e.target.value)}},e)}}gl.propTypes={options:Ui.a.array,store:Ui.a.object,storeKey:Ui.a.string,setValue:Ui.a.func,onChanged:Ui.a.func};const vl=1,bl=2,yl=3,El=4,wl=5;class _l extends Li.Component{render(){const e=()=>{const e=parseInt(document.getElementById("maxResolutionWidth").value),t=parseInt(document.getElementById("maxResolutionHeight").value);this.props.store.update({preferences:{maxResolutionWidth:e||0,maxResolutionHeight:t||0}})};return Hi.a.createElement("div",{className:Wi()(Fs.a.maxResolutionPreferenceItem)},Hi.a.createElement("input",{id:"maxResolutionWidth",tabIndex:"0",type:"number",step:"1",min:"0",value:void 0===this.props.store.state.preferences.maxResolutionWidth?window.screen.width:this.props.store.state.preferences.maxResolutionWidth,onClick:e=>{e.preventDefault(),e.target.focus(),e.target.select()},onChange:e}),"","x","",Hi.a.createElement("input",{id:"maxResolutionHeight",tabIndex:"0",type:"number",step:"1",min:"0",value:void 0===this.props.store.state.preferences.maxResolutionHeight?window.screen.height:this.props.store.state.preferences.maxResolutionHeight,onClick:e=>{e.preventDefault(),e.target.focus(),e.target.select()},onChange:e}))}}function Sl({children:e,disabled:t,indent:n}){return Hi.a.createElement("div",{className:Wi()(Fs.a.listItem,{disabled:t,indent:n})},e)}_l.propTypes={store:Ui.a.object},Sl.propTypes={children:Ui.a.node.isRequired,disabled:Ui.a.bool,indent:Ui.a.bool};const xl=Object(Jr.b)({preferredCamera:{id:"preferences-screen.preference.preferred-camera",defaultMessage:"Preferred camera"},preferredMic:{id:"preferences-screen.preference.preferred-mic",defaultMessage:"Preferred mic"},preferredSpeakers:{id:"preferences-screen.preference.preferred-speakers",defaultMessage:"Preferred speakers"},globalVoiceVolume:{id:"preferences-screen.preference.global-voice-volume",defaultMessage:"Incoming Voice Volume"},globalMediaVolume:{id:"preferences-screen.preference.global-media-volume",defaultMessage:"Media Volume"},globalSFXVolume:{id:"preferences-screen.preference.global-sfx-volume",defaultMessage:"SFX Volume"},avatarVoiceLevels:{id:"preferences-screen.preference.avatar-volumes",defaultMessage:"Stored avatar volumes"},disableSoundEffects:{id:"preferences-screen.preference.disable-sound-effects",defaultMessage:"Disable Sound Effects"},disableEchoCancellation:{id:"preferences-screen.preference.disable-echo-cancellation",defaultMessage:"Disable microphone echo cancellation"},disableNoiseSuppression:{id:"preferences-screen.preference.disable-noise-suppression",defaultMessage:"Disable microphone noise supression"},disableAutoGainControl:{id:"preferences-screen.preference.disable-auto-gain-control",defaultMessage:"Disable microphone automatic gain control"},snapRotationDegrees:{id:"preferences-screen.preference.snap-rotation-degrees",defaultMessage:"Rotation per snap (in degrees)"},disableMovement:{id:"preferences-screen.preference.disable-movement",defaultMessage:"Disable movement"},disableBackwardsMovement:{id:"preferences-screen.preference.disable-backwards-movement",defaultMessage:"Disable backwards movement"},disableStrafing:{id:"preferences-screen.preference.disable-strafing",defaultMessage:"Disable strafing"},disableTeleporter:{id:"preferences-screen.preference.disable-teleporter",defaultMessage:"Disable teleporter"},movementSpeedModifier:{id:"preferences-screen.preference.movement-speed-modifier",defaultMessage:"Movement speed modifier"},enableOnScreenJoystickLeft:{id:"preferences-screen.preference.enable-on-screen-joystick-left",defaultMessage:"Enable left on-screen joystick for moving around"},enableOnScreenJoystickRight:{id:"preferences-screen.preference.enable-on-screen-joystick-right",defaultMessage:"Enable right on-screen joystick for looking around"},enableGyro:{id:"preferences-screen.preference.enable-gyro",defaultMessage:"Enable gyroscope (when supported by browser/device)"},invertTouchscreenCameraMove:{id:"preferences-screen.preference.invert-touchscreen-camera-move",defaultMessage:"Invert direction of camera movement for touchscreens"},locale:{id:"preferences-screen.preference.locale",defaultMessage:"Language"},animateWaypointTransitions:{id:"preferences-screen.preference.animate-waypoint-transitions",defaultMessage:"Animate waypoint transitions"},showFPSCounter:{id:"preferences-screen.preference.show-fps-counter",defaultMessage:"Show FPS Counter"},maxResolution:{id:"preferences-screen.preference.max-resolution",defaultMessage:"Max Resolution"},materialQualitySetting:{id:"preferences-screen.preference.material-quality-setting",defaultMessage:"Material quality"},enableDynamicShadows:{id:"preferences-screen.preference.enable-dynamic-shadows",defaultMessage:"Enable Real-time Shadows"},disableAutoPixelRatio:{id:"preferences-screen.preference.disable-auto-pixel-ratio",defaultMessage:"Disable automatic pixel ratio adjustments"},allowMultipleHubsInstances:{id:"preferences-screen.preference.allow-multiple-hubs-instances",defaultMessage:"Disable auto-exit when multiple hubs instances are open"},disableIdleDetection:{id:"preferences-screen.preference.disable-idle-detection",defaultMessage:"Disable auto-exit when idle or backgrounded"},preferMobileObjectInfoPanel:{id:"preferences-screen.preference.prefer-mobile-object-info-panel",defaultMessage:"Prefer Mobile Object Info Panel"},showRtcDebugPanel:{id:"preferences-screen.preference.show-rtc-debug-panel",defaultMessage:"Show RTC Panel"},showAudioDebugPanel:{id:"preferences-screen.preference.show-audio-debug-panel",defaultMessage:"Show Audio Debug Panel"},enableAudioClipping:{id:"preferences-screen.preference.enable-audio-clipping",defaultMessage:"Enable Audio Clipping"},audioClippingThreshold:{id:"preferences-screen.preference.audio-clipping-threshold",defaultMessage:"Audio Clipping Threshold"},theme:{id:"preferences-screen.preference.theme",defaultMessage:"Theme"},fastRoomSwitching:{id:"preferences-screen.preference.fast-room-switching",defaultMessage:"Enable Fast Room Switching"},lazyLoadSceneMedia:{id:"preferences-screen.preference.lazy-load-scene-media",defaultMessage:"Enable Scene Media Lazy Loading"},disableLeftRightPanning:{id:"preferences-screen.preference.disable-panning",defaultMessage:"Disable audio left/right panning"},cursorSize:{id:"preferences-screen.preference.cursor-size",defaultMessage:"Cursor Size"},nametagVisibility:{id:"preferences-screen.preference.nametag-visibility",defaultMessage:"Show Nametag"},nametagVisibilityDistance:{id:"preferences-screen.preference.nametag-visibility-distance",defaultMessage:"Nametag visibility distance"}});class Al extends Li.Component{constructor(...e){super(...e),this.storeUpdated=()=>{this.forceUpdate()}}componentDidMount(){this.props.store.addEventListener("statechanged",this.storeUpdated),window.addEventListener("locale-updated",this.storeUpdated)}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated),window.removeEventListener("locale-updated",this.storeUpdated)}render(){const e=this.props.intl,t=this.props.itemProps.prefType===vl,n=window.innerWidth<600,a=Hi.a.createElement("span",{className:Fs.a.preferenceLabel},e.formatMessage(xl[this.props.storeKey])),i=this.props.store.schema.definitions.preferences.properties,r=(this.props.itemProps.prefType===El?void 0!==this.props.store.state.preferences.maxResolutionWidth||void 0!==this.props.store.state.preferences.maxResolutionHeight:this.props.store.state.preferences[this.props.storeKey]!==i[this.props.storeKey].default)?Hi.a.createElement(sl,{onClick:()=>{switch(this.props.itemProps.prefType){case El:this.props.store.update({preferences:{maxResolutionWidth:void 0,maxResolutionHeight:void 0}});break;default:this.props.setValue(i[this.props.storeKey].default)}this.forceUpdate()}}):Hi.a.createElement(ll,null),o=this.props.itemProps.disableIfTrue&&this.props.store.state.preferences[this.props.itemProps.disableIfTrue]||this.props.itemProps.disableIfFalse&&!this.props.store.state.preferences[this.props.itemProps.disableIfFalse],s=this.props.itemProps.disableIfTrue||this.props.itemProps.disableIfFalse;return t?Hi.a.createElement(Sl,{disabled:o,indent:s},Hi.a.createElement("div",{className:Fs.a.row},Hi.a.createElement(Tl,{itemProps:this.props.itemProps,store:this.props.store,setValue:this.props.setValue}),a,Hi.a.createElement("div",{className:Fs.a.rowRight},r))):n?Hi.a.createElement(Sl,{disabled:o,indent:s},Hi.a.createElement("div",{className:Fs.a.column},Hi.a.createElement("div",{className:Fs.a.row},Hi.a.createElement(hl,null),a),Hi.a.createElement("div",{className:Fs.a.row},Hi.a.createElement("div",{className:Fs.a.rowCenter},Hi.a.createElement(Tl,{itemProps:this.props.itemProps,store:this.props.store,setValue:this.props.setValue})),Hi.a.createElement("div",{className:Fs.a.rowRight},r)))):Hi.a.createElement(Sl,{disabled:o,indent:s},Hi.a.createElement("div",{className:Fs.a.row},Hi.a.createElement(hl,null),a,Hi.a.createElement("div",{className:Fs.a.rowRight},Hi.a.createElement(Tl,{itemProps:this.props.itemProps,store:this.props.store,setValue:this.props.setValue})),Hi.a.createElement("div",{className:Fs.a.rowRight},r)))}}Al.propTypes={intl:Ui.a.object,store:Ui.a.object,storeKey:Ui.a.string,setValue:Ui.a.func,itemProps:Ui.a.object};const Ml=Object(Zr.c)(Al),kl=[0,1,2],Ol=Object(Jr.b)({0:{id:"preferences-screen.category.audio",defaultMessage:"Audio"},1:{id:"preferences-screen.category.controls",defaultMessage:"Controls"},2:{id:"preferences-screen.category.misc",defaultMessage:"Misc"},3:{id:"preferences-screen.category.movement",defaultMessage:"Movement"},4:{id:"preferences-screen.category.touchscreen",defaultMessage:"Touchscreen"},5:{id:"preferences-screen.category.accessibility",defaultMessage:"Accessibility"}});function Cl({ariaLabel:e,title:t,onClick:n,selected:a}){return Hi.a.createElement("button",{"aria-label":e,className:Wi()(Fs.a.navItem,{[Fs.a.selected]:a}),onClick:n},t)}function Pl({onClick:e}){const t=Object(po.a)();return Hi.a.createElement("button",{autoFocus:!0,"aria-label":t.formatMessage({id:"preferences-screen.close-button",defaultMessage:"Close Preferences Menu"}),className:Wi()(Fs.a.closeButton),onClick:e},Hi.a.createElement("i",{className:Fs.a.flex},Hi.a.createElement(Es.a,{className:Fs.a.icon,icon:bs.faTimes})))}Cl.propTypes={ariaLabel:Ui.a.string,title:Ui.a.string,onClick:Ui.a.func,selected:Ui.a.bool},Pl.propTypes={onClick:Ui.a.func};const Rl=new Map([[vl,pl],[El,_l],[bl,gl],[yl,ul],[wl,ml]]);function Tl({itemProps:e,store:t,setValue:n}){const a=Rl.get(e.prefType);return Hi.a.createElement(a,il({store:t,storeKey:e.key,setValue:n},e))}function jl({name:e,items:t},n){return Hi.a.createElement("div",{key:"section-".concat(n),className:Fs.a.section},e&&Hi.a.createElement("div",{className:Fs.a.sectionTitle},e),t)}Tl.propTypes={itemProps:Ui.a.object,store:Ui.a.object,setValue:Ui.a.func},jl.propTypes={name:Ui.a.string,items:Ui.a.node.isRequired};class Dl extends Li.Component{render(){const{children:e}=this.props;return Hi.a.createElement("div",{className:Fs.a.navContainer},Hi.a.createElement("div",{className:Wi()(Fs.a.nav)},e))}}Dl.propTypes={children:Ui.a.node.isRequired,selected:Ui.a.number};class Il extends Hi.a.Component{constructor(){super(),this.ref=Hi.a.createRef()}componentDidMount(){this.props.reportHeight(window.getComputedStyle(this.ref.current).height)}render(){return Hi.a.createElement("div",{ref:this.ref,className:Fs.a.toast},Hi.a.createElement("div",{className:Fs.a.row},Hi.a.createElement(ol,null),Hi.a.createElement("div",{className:Fs.a.refreshPrompt},Hi.a.createElement(Yi.a,{id:"preferences-screen.prompt-for-refresh",defaultMessage:"Your preferences are saved, but some of your changes will not take effect until you refresh the page."})),Hi.a.createElement("div",{className:Fs.a.warnIconPlaceholder})),Hi.a.createElement("button",{className:Fs.a.refreshNowButton,onClick:()=>{const e=location.href;location.href=e}},Hi.a.createElement(Yi.a,{id:"preferences-screen.refresh-now",defaultMessage:"Refresh Now"})))}}Il.propTypes={reportHeight:Ui.a.func};class Ll extends Li.Component{constructor(){super(),this.onMediaDevicesUpdated=()=>{const e=this.mediaDevicesManager.selectedSpeakersDeviceId;this.props.store.state.preferences.preferredSpeakers!==e&&this.props.store.update({preferences:{preferredSpeakers:e}}),this.updateMediaDevices()},this.updateMediaDevices=()=>{const e=this.mediaDevicesManager.micDevicesOptions.map(e=>({value:e.value,text:e.label})),t=il({},this.state.preferredMic);t.options=e;const n=this.mediaDevicesManager.outputDevicesOptions.map(e=>({value:e.value,text:e.label})),a=il({},this.state.preferredSpeakers);a.options=(null==n?void 0:n.length)>0?n:[{value:"none",text:"None"}];const i=this.mediaDevicesManager.videoDevicesOptions.map(e=>({value:e.value,text:e.label})),r=il({},this.state.preferredCamera);r.options=[{value:"user",text:this.props.intl.formatMessage({id:"preferences-screen.preferred-camera.user-facing",defaultMessage:"User-Facing"})},{value:"environment",text:this.props.intl.formatMessage({id:"preferences-screen.preferred-camera.environment",defaultMessage:"Environment"})},{value:"default",text:this.props.intl.formatMessage({id:"preferences-screen.preferred-camera.default",defaultMessage:"Default"})}],r.options.push(...i),this.setState({preferredMic:t,preferredSpeakers:a,preferredCamera:r})},this.storeUpdated=this.storeUpdated.bind(this),this.mediaDevicesManager=APP.mediaDevicesManager,this.state=il({category:0,toastHeight:"150px",preferredMic:{key:"preferredMic",prefType:bl,options:[{value:"none",text:"None"}]},preferredCamera:{key:"preferredCamera",prefType:bl,options:[{value:"none",text:"None"}]}},Js.isAudioOutputSelectEnabled&&{preferredSpeakers:{key:"preferredSpeakers",prefType:bl,options:[{value:"none",text:"None"}]}})}componentDidMount(){this.props.store.addEventListener("statechanged",this.storeUpdated),this.mediaDevicesManager.on(T.b.DEVICE_CHANGE,this.onMediaDevicesUpdated),this.mediaDevicesManager.fetchMediaDevices().then(this.updateMediaDevices)}componentWillUnmount(){this.props.store.removeEventListener("statechanged",this.storeUpdated),this.mediaDevicesManager.off(T.b.DEVICE_CHANGE,this.onMediaDevicesUpdated)}storeUpdated(){const{preferredMic:e}=this.props.store.state.preferences;e!==this.mediaDevicesManager.selectedMicDeviceId&&this.mediaDevicesManager.startMicShare({updatePrefs:!1}).then(this.updateMediaDevices)}createSections(){const e=this.props.intl,t=e.formatMessage({id:"preferences-screen.browser-default",defaultMessage:"Browser Default"}),n=[{value:"browser",text:t}];for(const e in Vs.a)n.push({value:e,text:Vs.a[e]});const a=[{value:null,text:t}];for(const e of Bs.b){const{id:t,name:n}=e;a.push({value:t,text:n})}const i=new Map([[4,[{key:"enableOnScreenJoystickLeft",prefType:vl},{key:"enableOnScreenJoystickRight",prefType:vl},{key:"enableGyro",prefType:vl},{key:"invertTouchscreenCameraMove",prefType:vl}]],[3,[{key:"snapRotationDegrees",prefType:yl,min:0,max:90,step:5,digits:0},{key:"disableMovement",prefType:vl},{key:"disableBackwardsMovement",prefType:vl},{key:"disableStrafing",prefType:vl},{key:"disableTeleporter",prefType:vl},{key:"movementSpeedModifier",prefType:yl,min:0,max:2,step:.1,digits:1}]],[0,[...Js.isAudioInputSelectEnabled?[this.state.preferredMic]:[],...Js.isAudioOutputSelectEnabled?[this.state.preferredSpeakers]:[],{key:"globalVoiceVolume",prefType:yl,min:0,max:200,step:5,digits:0},{key:"globalMediaVolume",prefType:yl,min:0,max:200,step:5,digits:0},{key:"globalSFXVolume",prefType:yl,min:0,max:200,step:5,digits:0},{key:"avatarVoiceLevels",prefType:wl,defaultValue:0,text:e.formatMessage({id:"preferences-screen.preference.avatar-volumes.entries",defaultMessage:"Entries"})},{key:"disableSoundEffects",prefType:vl},{key:"disableEchoCancellation",prefType:vl,promptForRefresh:!0},{key:"disableNoiseSuppression",prefType:vl,promptForRefresh:!0},{key:"disableAutoGainControl",prefType:vl,promptForRefresh:!0},{key:"enableAudioClipping",prefType:vl},{key:"audioClippingThreshold",prefType:yl,min:0,max:.1,step:.001,digits:3},{key:"showAudioDebugPanel",prefType:vl}]],[2,[{key:"locale",prefType:bl,options:n},{key:"theme",prefType:bl,options:a},{key:"maxResolution",prefType:El},{key:"nametagVisibility",prefType:bl,options:[{value:"showAll",text:e.formatMessage({id:"preferences-screen.nametag-visibility.show-all",defaultMessage:"Always"})},{value:"showNone",text:e.formatMessage({id:"preferences-screen.nametag-visibility.show-none",defaultMessage:"Never"})},{value:"showFrozen",text:e.formatMessage({id:"preferences-screen.nametag-visibility.show-frozen",defaultMessage:"Only in Frozen state"})},{value:"showSpeaking",text:e.formatMessage({id:"preferences-screen.nametag-visibility.show-speaking",defaultMessage:"Only speaking"})},{value:"showClose",text:e.formatMessage({id:"preferences-screen.nametag-visibility.show-close",defaultMessage:"Close to me"})}]},{key:"nametagVisibilityDistance",prefType:yl,min:1,max:20,step:1,digits:2},this.state.preferredCamera,{key:"materialQualitySetting",prefType:bl,options:[{value:"low",text:e.formatMessage({id:"preferences-screen.material-quality-setting.low",defaultMessage:"Low"})},{value:"medium",text:e.formatMessage({id:"preferences-screen.material-quality-setting.medium",defaultMessage:"Medium"})},{value:"high",text:e.formatMessage({id:"preferences-screen.material-quality-setting.high",defaultMessage:"High"})}],promptForRefresh:!0},{key:"enableDynamicShadows",prefType:vl,defaultBool:!1},{key:"disableAutoPixelRatio",prefType:vl},{key:"allowMultipleHubsInstances",prefType:vl},{key:"disableIdleDetection",prefType:vl},{key:"fastRoomSwitching",prefType:vl},{key:"lazyLoadSceneMedia",prefType:vl},{key:"preferMobileObjectInfoPanel",prefType:vl},{key:"animateWaypointTransitions",prefType:vl},{key:"showFPSCounter",prefType:vl},{key:"showRtcDebugPanel",prefType:vl},{key:"cursorSize",prefType:yl,min:1,max:5,step:.5,digits:1}]],[5,[{key:"disableLeftRightPanning",prefType:vl}]]]),r=e=>function(e,t){return Hi.a.createElement(Ml,{key:e.key,itemProps:e,store:t,storeKey:e.key,setValue:n=>{e.promptForRefresh?t.update({preferences:{[e.key]:n,shouldPromptForRefresh:!0}}):t.update({preferences:{[e.key]:n}})},onChanged:e.onChanged})}(e,this.props.store),o=new Map;for(const[e,t]of i)o.set(e,t.map(r));return new Map([[0,[{items:o.get(0)},{name:e.formatMessage(Ol[5]),items:o.get(5)}]],[1,[{name:e.formatMessage(Ol[3]),items:o.get(3)},{name:e.formatMessage(Ol[4]),items:o.get(4)}]],[2,[{items:o.get(2)}]]])}render(){const e=this.props.intl,t=this.props.store.state.preferences.shouldPromptForRefresh;return Hi.a.createElement("div",{className:Wi()(Fs.a.preferencesPanel)},t&&Hi.a.createElement(Il,{reportHeight:e=>{this.setState({toastHeight:e})}}),Hi.a.createElement(Pl,{onClick:this.props.onClose}),Hi.a.createElement(Dl,{selected:this.state.category},kl.map(t=>Hi.a.createElement(Cl,{key:"category-".concat(t,"-header"),title:e.formatMessage(Ol[t]),onClick:()=>{this.setState({category:t})},ariaLabel:e.formatMessage({id:"preferences-screen.select-category ",defaultMessage:"Select category {categoryName}"},{categoryName:e.formatMessage(Ol[t])}),selected:t===this.state.category}))),Hi.a.createElement("div",{className:Fs.a.contentContainer},Hi.a.createElement("div",{className:Fs.a.scrollingContent},this.createSections().get(this.state.category).map(jl),t&&Hi.a.createElement("div",{style:{width:"100%",minHeight:"".concat(this.state.toastHeight)}}))))}}Ll.propTypes={intl:Ui.a.object,onClose:Ui.a.func,store:Ui.a.object,scene:Ui.a.object};var Hl=Object(Zr.c)(Ll),Nl=n(51),Fl=n.n(Nl);function Vl(){return(Vl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Bl(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ul(e){var t=e.title,n=e.titleId,a=Bl(e,["title","titleId"]);return Li.createElement("svg",Vl({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.838 5.213L5.213 7.838l3.052 3.052 2.625-2.625-3.053-3.052z",fill:a.color}),Li.createElement("path",{d:"M11.774 9.149l-2.625 2.625 6.945 6.976 2.656-2.656-6.976-6.945z",fill:a.color}),Li.createElement("path",{d:"M4.375 6.875H1.25v1.25h3.125v-1.25z",fill:a.color}),Li.createElement("path",{d:"M3.525 2.642l-.883.884 2.21 2.21.883-.884-2.21-2.21z",fill:a.color}),Li.createElement("path",{d:"M8.125 1.25h-1.25v3.125h1.25V1.25z",fill:a.color}),Li.createElement("path",{d:"M11.48 2.643l-2.21 2.21.884.883 2.21-2.21-.884-.883z",fill:a.color}),Li.createElement("path",{d:"M4.851 9.27l-2.21 2.21.884.884 2.21-2.21-.884-.883z",fill:a.color}))}Ul.defaultProps={color:"#000",title:"Wand"};function zl(){return(zl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Wl(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ql(e){var t=e.title,n=e.titleId,a=Wl(e,["title","titleId"]);return Li.createElement("svg",zl({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M3.418 14.844c.046-.171-.057-.409-.155-.58-.03-.052-.063-.101-.099-.149a7.805 7.805 0 01-1.289-4.297c-.014-4.385 3.622-7.943 8.118-7.943 3.921 0 7.194 2.717 7.96 6.323.114.534.172 1.08.172 1.626 0 4.391-3.496 8.005-7.992 8.005-.715 0-1.68-.18-2.206-.327a14.835 14.835 0 01-1.187-.395 1.215 1.215 0 00-.906.014l-2.65.957a.623.623 0 01-.182.047.373.373 0 01-.374-.38.618.618 0 01.023-.129l.767-2.772z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}))}ql.defaultProps={color:"#000",title:"Chat"};function Gl(){return(Gl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Yl(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Kl(e){var t=e.title,n=e.titleId,a=Yl(e,["title","titleId"]);return Li.createElement("svg",Gl({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M18.617 8.871l-.007-.003-16.682-6.92a.92.92 0 00-.868.085.963.963 0 00-.435.804v4.426a.937.937 0 00.762.92l9.1 1.683a.157.157 0 010 .307l-9.1 1.682a.937.937 0 00-.762.92v4.426a.921.921 0 00.414.77.936.936 0 00.888.08l16.682-6.88.008-.003a1.25 1.25 0 000-2.297z",fill:a.color}))}Kl.defaultProps={color:"#000",title:"Send"};function Xl(){return(Xl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ql(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Jl(e){var t=e.title,n=e.titleId,a=Ql(e,["title","titleId"]);return Li.createElement("svg",Xl({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.188 10a.937.937 0 100-1.875.937.937 0 000 1.875z",fill:a.color}),Li.createElement("path",{d:"M10.002 15.001c-1.774 0-3.266-1.153-3.739-2.728a.312.312 0 01.306-.397h6.863a.314.314 0 01.311.254.311.311 0 01-.006.143c-.468 1.575-1.96 2.728-3.735 2.728z",fill:a.color}),Li.createElement("path",{d:"M12.813 10a.937.937 0 100-1.875.937.937 0 000 1.875z",fill:a.color}),Li.createElement("path",{d:"M10 18.125a8.125 8.125 0 100-16.25 8.125 8.125 0 000 16.25z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}))}Jl.defaultProps={color:"#000",title:"Reaction"};var Zl=n(834),$l=n(269),ec=n(789),tc=n.n(ec);function nc(){return(nc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ac(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const ic=Object(Li.forwardRef)((e,t)=>{let{className:n}=e,a=ac(e,["className"]);return Hi.a.createElement($l.a,nc({className:Wi()(tc.a.textarea,n)},a,{as:Zl.a,ref:t}))});ic.propTypes={className:Ui.a.string};var rc=n(271),oc=n.n(rc);function sc(){return(sc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function lc(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const cc=Object(Li.forwardRef)((e,t)=>{let{preset:n,className:a,iconContainerClassName:i,children:r,icon:o,label:s,selected:l,large:c,statusColor:d,type:u}=e,h=lc(e,["preset","className","iconContainerClassName","children","icon","label","selected","large","statusColor","type"]);return Hi.a.createElement("button",sc({ref:t,className:Wi()(oc.a.toolbarButton,oc.a[n],oc.a[u],{[oc.a.selected]:l,[oc.a.large]:c},a)},h),Hi.a.createElement("div",{className:Wi()(oc.a.iconContainer,i),"aria-hidden":"true"},o,d&&Hi.a.createElement("div",{className:Wi()(oc.a.statusIndicator,oc.a["status-"+d])}),r),s&&Hi.a.createElement("label",null,s))});cc.propTypes={icon:Ui.a.node,label:Ui.a.node,selected:Ui.a.bool,preset:Ui.a.oneOf(["basic","transparent","accept","cancel","accent1","accent2","accent3","accent4","accent5"]),statusColor:Ui.a.oneOf(["recording","unread","enabled","disabled"]),large:Ui.a.bool,className:Ui.a.string,iconContainerClassName:Ui.a.string,children:Ui.a.node,type:Ui.a.oneOf(["none","left","middle","right"])},cc.defaultProps={preset:"basic"};var dc=n(1626),uc=n(218),hc=n.n(uc),pc=n(228);function mc(){return(mc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fc({arrowClass:e}){return Hi.a.createElement("svg",{width:"25",height:"11",viewBox:"0 0 25 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Hi.a.createElement("path",{d:"M1 1L11.1176 9.51209C11.8908 10.1626 13.1092 10.1626 13.8824 9.51209L24 1",strokeWidth:"2",className:Wi()(hc.a.arrowBg,e)}),Hi.a.createElement("path",{d:"M11.1176 9.51209L1 1H24L13.8824 9.51209C13.1092 10.1626 11.8908 10.1626 11.1176 9.51209Z",className:Wi()(hc.a.arrowBorder,e)}),Hi.a.createElement("path",{d:"M0 1H25",strokeWidth:"2",className:Wi()(hc.a.arrowBg,e)}))}function gc({content:e,children:t,title:n,showHeader:a,placement:i,offsetSkidding:r,offsetDistance:o,initiallyVisible:s,disableFullscreen:l,isVisible:c,onChangeVisible:d,popoverApiRef:u,popoverClass:h,arrowClass:p}){const[m,f]=Object(Li.useState)(s),g=void 0===c?m:c,v=d||f,[b,y]=Object(Li.useState)(null),[E,w]=Object(Li.useState)(null),[_,S]=Object(Li.useState)(null),{styles:{popper:x,arrow:A},attributes:M}=Object(dc.a)(b,E,{placement:i,modifiers:[{name:"arrow",options:{element:_}},{name:"offset",options:{offset:[r,o]}}]}),k=Object(pc.useCssBreakpoints)(),O=!l&&("sm"===k||"md"===k),C=Object(Li.useCallback)(()=>v(!0),[v]),P=Object(Li.useCallback)(()=>v(!1),[v]),R=Object(Li.useCallback)(()=>v(e=>!e),[v]);return Object(Li.useEffect)(()=>{u&&(u.current={openPopover:C,closePopover:P,togglePopover:R})},[u,C,P,R]),Object(Li.useEffect)(()=>{const e=e=>{b&&b.contains(e.target)||E&&E.contains(e.target)||v(!1)},t=e=>{"Escape"===e.key&&v(!1)};return g&&(window.addEventListener("mousedown",e),window.addEventListener("keydown",t)),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("keydown",t)}},[g,E,b,v]),Object(Li.useEffect)(()=>(g&&O?document.body.classList.add(hc.a.fullscreenBody):document.body.classList.remove(hc.a.fullscreenBody),()=>{document.body.classList.remove(hc.a.fullscreenBody)}),[O,g]),Hi.a.createElement(Hi.a.Fragment,null,t({togglePopover:R,openPopover:C,closePopover:P,popoverVisible:g,triggerRef:y}),g&&Object(Di.createPortal)(Hi.a.createElement("div",mc({ref:w,className:Wi()(hc.a.popover,{[hc.a.fullscreen]:O},h),style:O?void 0:x},M.popper),a&&Hi.a.createElement("div",{className:hc.a.header},Hi.a.createElement(Sr.a,{onClick:P}),Hi.a.createElement("h5",null,n)),Hi.a.createElement("div",{className:hc.a.content},"function"==typeof e?Hi.a.createElement(e,{fullscreen:O,closePopover:P}):e),!O&&Hi.a.createElement("div",{ref:S,className:hc.a.arrow,style:A},Hi.a.createElement(fc,{arrowClass:p}))),document.body))}fc.propTypes={arrowClass:Ui.a.string},gc.propTypes={initiallyVisible:Ui.a.bool,placement:Ui.a.string,title:Ui.a.node.isRequired,children:Ui.a.func.isRequired,content:Ui.a.oneOfType([Ui.a.func,Ui.a.node]),disableFullscreen:Ui.a.bool,popoverApiRef:Ui.a.object,popoverClass:Ui.a.string},gc.defaultProps={initiallyVisible:!1,placement:"auto",offsetSkidding:0,offsetDistance:8,showHeader:!0};var vc=n(832),bc=n(791),yc=n.n(bc),Ec=n(792),wc=n.n(Ec),_c=n(793),Sc=n.n(_c),xc=n(794),Ac=n.n(xc);n(1353);function Mc(){return(Mc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const kc={16:yc.a,20:wc.a,32:Sc.a,64:Ac.a};function Oc(e){return Hi.a.createElement(vc.a,Mc({title:"Pick an emoji!",color:"var(--tab-highlight-color)",backgroundImageFn:(e,t)=>kc[t]},e))}var Cc=n(105),Pc=n.n(Cc),Rc=n(795),Tc=n.n(Rc),jc=n(609);const Dc=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/;function Ic(e,{emojiClassName:t}={}){const n=e.length>=750?750:e.length,a=e.startsWith("`")&&e.endsWith("`"),i=(a?e.substring(1,n-1):e.substring(0,n)).trim(),r=i.split("\n").map((e,n)=>Hi.a.createElement("p",{key:n},Hi.a.createElement(Tc.a,{properties:{target:"_blank",rel:"noopener referrer"}},Object(jc.toArray)(e,{className:t})))),o=r.length>1;let s=!1;if(1===r.length){const e=Object(jc.toArray)(i);s=1===e.length&&e[0].props&&e[0].props.children.match&&e[0].props.children.match(Dc)}return{formattedBody:Hi.a.createElement(Hi.a.Fragment,null,r),multiline:o,monospace:a,emoji:s}}var Lc=n(625);function Hc(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Nc(){return(Nc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Fc(e){return Hi.a.createElement(Mr.a,Nc({className:Pc.a.chatInputIcon},e),Hi.a.createElement(Ul,null))}function Vc(e){return Hi.a.createElement(Mr.a,Nc({className:Pc.a.chatInputIcon},e),Hi.a.createElement(Kl,null))}const Bc=Hi.a.memo(({onSelectEmoji:e})=>{const t=Object(Li.useRef)(!1);return Object(Li.useEffect)(()=>{const e=e=>{"Shift"===e.key&&(t.current=!0)},n=e=>{"Shift"===e.key&&(t.current=!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[]),Hi.a.createElement(gc,{title:"",content:({closePopover:n})=>Hi.a.createElement(Oc,{onSelect:a=>{const i=t.current;e({emoji:a,pickerRemainedOpen:i}),i||n()}}),placement:"top",offsetDistance:28},({togglePopover:e,popoverVisible:t,triggerRef:n})=>Hi.a.createElement(Mr.a,{ref:n,className:Pc.a.chatInputIcon,selected:t,onClick:e},Hi.a.createElement(Jl,null)))});function Uc(e){return Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Mr.a,{as:"label",className:Pc.a.chatInputIcon},Hi.a.createElement(bo,null),Hi.a.createElement("input",Nc({type:"file"},e))))}function zc({messageLength:e,maxLength:t}){return Hi.a.createElement("p",{className:Wi()(Pc.a.chatInputWarning,{[Pc.a.warningTextColor]:e>t})},Hi.a.createElement(Yi.a,{id:"chat-message-input.warning-max-characters",defaultMessage:"Max characters"})," (".concat(e,"/").concat(t,")"))}Bc.propTypes={onSelectEmoji:Ui.a.func.isRequired},zc.propTypes={messageLength:Ui.a.number,maxLength:Ui.a.number};const Wc=Object(Li.forwardRef)((e,t)=>{let{warning:n,isOverMaxLength:a}=e,i=Hc(e,["warning","isOverMaxLength"]);const r=Object(po.a)();return Hi.a.createElement("div",{className:Pc.a.chatInputContainer},Hi.a.createElement(ic,Nc({ref:t,textInputStyles:Pc.a.chatInputTextAreaStyles,className:Wi()({[Pc.a.warningBorder]:a}),placeholder:r.formatMessage({id:"chat-sidebar.input.placeholder",defaultMessage:"Message..."})},i)),n)});Wc.propTypes={onSpawn:Ui.a.func,warning:Ui.a.node,isOverMaxLength:Ui.a.bool};const qc=Object(Jr.b)({room:{id:"chat-sidebar.system-message.entered-room",defaultMessage:"{name} entered the room."},lobby:{id:"chat-sidebar.system-message.entered-lobby",defaultMessage:"{name} entered the lobby."}}),Gc=Object(Jr.b)({lobby:{id:"chat-sidebar.system-message.joined-lobby",defaultMessage:"{name} joined the lobby."},room:{id:"chat-sidebar.system-message.joined-room",defaultMessage:"{name} joined the room."}}),Yc={roomEntryRequired:"roomEntryRequired",flyModeDisabled:"flyModeDisabled",flyModeEnabled:"flyModeEnabled",unauthorizedSceneChange:"unauthorizedSceneChange",invalidSceneUrl:"invalidSceneUrl",unauthorizedRoomRename:"unauthorizedRoomRename",captureUnavailable:"captureUnavailable",captureStopped:"captureStopped",captureStarted:"captureStarted",captureAlreadyStopped:"captureAlreadyStopped",captureAlreadyRunning:"captureAlreadyRunning",positionalAudioEnabled:"positionalAudioEnabled",positionalAudioDisabled:"positionalAudioDisabled",setAudioNormalizationFactor:"setAudioNormalizationFactor",audioNormalizationDisabled:"audioNormalizationDisabled",audioNormalizationNaN:"audioNormalizationNaN",invalidAudioNormalizationRange:"invalidAudioNormalizationRange",audioSuspended:"audioSuspended",audioResumed:"audioResumed",joinFailed:"joinFailed",avatarChanged:"avatarChanged"},Kc=Object(Jr.b)({[Yc.roomEntryRequired]:{id:"chat-sidebar.log-message.room-entry-required",defaultMessage:"You must enter the room to use this command."},[Yc.flyModeDisabled]:{id:"chat-sidebar.log-message.fly-mode-disabled",defaultMessage:"Fly mode disabled."},[Yc.flyModeEnabled]:{id:"chat-sidebar.log-message.fly-mode-enabled",defaultMessage:"Fly mode enabled."},[Yc.unauthorizedSceneChange]:{id:"chat-sidebar.log-message.unauthorized-scene-change",defaultMessage:"You do not have permission to change the scene."},[Yc.invalidSceneUrl]:{id:"chat-sidebar.log-message.invalid-scene-url",defaultMessage:"This URL does not point to a scene or valid GLB."},[Yc.unauthorizedRoomRename]:{id:"chat-sidebar.log-message.unauthorized-room-rename",defaultMessage:"You do not have permission to rename this room."},[Yc.captureUnavailable]:{id:"chat-sidebar.log-message.capture-unavailable",defaultMessage:"Capture unavailable."},[Yc.captureStopped]:{id:"chat-sidebar.log-message.capture-stopped",defaultMessage:"Capture stopped."},[Yc.captureStarted]:{id:"chat-sidebar.log-message.capture-started",defaultMessage:"Capture started."},[Yc.captureAlreadyStopped]:{id:"chat-sidebar.log-message.capture-already-stopped",defaultMessage:"Capture already stopped."},[Yc.captureAlreadyRunning]:{id:"chat-sidebar.log-message.capture-already-running",defaultMessage:"Capture already running."},[Yc.positionalAudioEnabled]:{id:"chat-sidebar.log-message.positional-audio-enabled",defaultMessage:"Positional audio enabled."},[Yc.positionalAudioDisabled]:{id:"chat-sidebar.log-message.positional-audio-disabled",defaultMessage:"Positional audio disabled."},[Yc.setAudioNormalizationFactor]:{id:"chat-sidebar.log-message.set-audio-normalization-factor",defaultMessage:"audioNormalization factor is set to {factor}."},[Yc.audioNormalizationDisabled]:{id:"chat-sidebar.log-message.audio-normalization-disabled",defaultMessage:"audioNormalization is disabled."},[Yc.audioNormalizationNaN]:{id:"chat-sidebar.log-message.audio-normalization-nan",defaultMessage:"audioNormalization command needs a valid number parameter."},[Yc.invalidAudioNormalizationRange]:{id:"chat-sidebar.log-message.invalid-audio-normalization-range",defaultMessage:"audioNormalization command needs a base volume number between 0 [no normalization] and 255. Default is 0. The recommended value is 4, if you would like to enable normalization."},[Yc.audioSuspended]:{id:"chat-sidebar.log-message.audio-suspended",defaultMessage:"Audio has been suspended, click somewhere in the room to resume the audio."},[Yc.audioResumed]:{id:"chat-sidebar.log-message.audio-resumed",defaultMessage:"Audio has been resumed."},[Yc.joinFailed]:{id:"chat-sidebar.log-message.join-failed",defaultMessage:"Failed to join room: {message}"},[Yc.avatarChanged]:{id:"chat-sidebar.log-message.avatar-changed",defaultMessage:"Your avatar has been changed."}});function Xc(e,t){switch(e.type){case"join":return t.formatMessage(Gc[e.presence],{name:Hi.a.createElement("b",null,e.name)});case"entered":return t.formatMessage(qc[e.presence],{name:Hi.a.createElement("b",null,e.name)});case"leave":return Hi.a.createElement(Yi.a,{id:"chat-sidebar.system-message.leave",defaultMessage:"{name} left.",values:{name:Hi.a.createElement("b",null,e.name)}});case"display_name_changed":return Hi.a.createElement(Yi.a,{id:"chat-sidebar.system-message.name-change",defaultMessage:"{oldName} is now known as {newName}",values:{oldName:Hi.a.createElement("b",null,e.oldName),newName:Hi.a.createElement("b",null,e.newName)}});case"scene_changed":return Hi.a.createElement(Yi.a,{id:"chat-sidebar.system-message.scene-change",defaultMessage:"{name} changed the scene to {sceneName}",values:{name:Hi.a.createElement("b",null,e.name),sceneName:Hi.a.createElement("b",null,e.sceneName)}});case"hub_name_changed":return Hi.a.createElement(Yi.a,{id:"chat-sidebar.system-message.hub-name-change",defaultMessage:"{name} changed the name of the room to {hubName}",values:{name:Hi.a.createElement("b",null,e.name),hubName:Hi.a.createElement("b",null,e.hubName)}});case"hub_changed":return Hi.a.createElement(Yi.a,{id:"chat-sidebar.system-message.hub-change",defaultMessage:"You are now in {hubName}",values:{hubName:Hi.a.createElement("b",null,e.hubName)}});case"log":return t.formatMessage(Kc[e.messageType],e.props);default:return null}}function Qc(e){const t=Object(po.a)();return Hi.a.createElement("li",{className:Wi()(Pc.a.messageGroup,Pc.a.systemMessage)},e.showLineBreak&&Hi.a.createElement("hr",null),Hi.a.createElement("p",{className:Pc.a.messageGroupLabel},Hi.a.createElement("i",null,Xc(e,t)),Hi.a.createElement("span",null,Hi.a.createElement(Lc.a,{updateIntervalInSeconds:10,value:(e.timestamp-Date.now())/1e3}))))}function Jc({media:e,monospace:t,emoji:n,children:a}){return Hi.a.createElement("div",{className:Wi()(Pc.a.messageBubble,{[Pc.a.media]:e,[Pc.a.emoji]:n,[Pc.a.monospace]:t})},a)}function Zc({sent:e,sender:t,timestamp:n,messages:a}){return Hi.a.createElement("li",{className:Wi()(Pc.a.messageGroup,{[Pc.a.sent]:e})},Hi.a.createElement("p",{className:Pc.a.messageGroupLabel},t," | ",Hi.a.createElement(Lc.a,{updateIntervalInSeconds:10,value:(n-Date.now())/1e3})),Hi.a.createElement("ul",{className:Pc.a.messageGroupMessages},a.map(e=>function(e){switch(e.type){case"chat":{const{formattedBody:t,monospace:n,emoji:a}=Ic(e.body);return Hi.a.createElement(Jc,{key:e.id,monospace:n,emoji:a},t)}case"video":return Hi.a.createElement(Jc,{key:e.id,media:!0},Hi.a.createElement("video",{controls:!0,src:e.body.src}));case"image":case"photo":return Hi.a.createElement(Jc,{key:e.id,media:!0},Hi.a.createElement("img",{src:e.body.src}));default:return null}}(e))))}Qc.propTypes={timestamp:Ui.a.any,showLineBreak:Ui.a.bool},Jc.propTypes={media:Ui.a.bool,monospace:Ui.a.bool,emoji:Ui.a.oneOfType([Ui.a.bool,Ui.a.array]),children:Ui.a.node},Zc.propTypes={sent:Ui.a.bool,sender:Ui.a.string,timestamp:Ui.a.any,messages:Ui.a.array};const $c=Object(Li.forwardRef)((e,t)=>{let{children:n}=e,a=Hc(e,["children"]);return Hi.a.createElement("ul",Nc({},a,{className:Pc.a.messageList,ref:t}),n)});function ed(e){let{onClose:t,children:n}=e,a=Hc(e,["onClose","children"]);return Hi.a.createElement(_r,Nc({title:Hi.a.createElement(Yi.a,{id:"chat-sidebar.title",defaultMessage:"Chat"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:t}),contentClassName:Pc.a.content,disableOverflowScroll:!0},a),n)}function td(e){return Hi.a.createElement(cc,Nc({},e,{icon:Hi.a.createElement(ql,null),preset:"accent4",label:Hi.a.createElement(Yi.a,{id:"chat-toolbar-button",defaultMessage:"Chat"})}))}$c.propTypes={children:Ui.a.node},ed.propTypes={onClose:Ui.a.func,onScrollList:Ui.a.func,children:Ui.a.node,listRef:Ui.a.func};var nd=n(796),ad=n.n(nd);function id(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function rd(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){id(r,a,i,o,s,"next",e)}function s(e){id(r,a,i,o,s,"throw",e)}o(void 0)}))}}const od=new Jt.a,sd=(e,t,n,a,i)=>{const{formattedBody:r,multiline:o,monospace:s,emoji:l}=Ic(e,{emojiClassName:i}),c=o?Fl.a.messageWrapMulti:Fl.a.messageWrap,d={[Fl.a.messageBody]:!0,[Fl.a.messageBodyMulti]:o,[Fl.a.messageBodyMono]:s},u=a&&n&&history&&NAF.clientId!==n,h=u?()=>a(n):()=>{};return{content:Hi.a.createElement("div",{className:c},t&&Hi.a.createElement("div",{onClick:h,className:Wi()({[Fl.a.messageSource]:!0,[Fl.a.messageSourceLink]:u})},t,":"),Hi.a.createElement("div",{className:Wi()(d)},r)),multiline:o,emoji:l}};function ld(e,t,n){const{content:a,emoji:i,multiline:r}=sd(e,t,null,null,Fl.a.emoji),o=n&&i,s=document.createElement("div");s.setAttribute("class","".concat(Fl.a.presenceLog," ").concat(Fl.a.presenceLogSpawn)),document.body.appendChild(s);const l=Hi.a.createElement("div",{className:Wi()({[Fl.a.presenceLogEntry]:!o,[Fl.a.presenceLogEntryOneLine]:!o&&!r,[Fl.a.presenceLogEmoji]:o})},a);return new Promise((e,t)=>{Ii.a.render(l,s,()=>{const n=s.offsetWidth,a=s.offsetHeight,i=a/n,r=1024*Math.min(1,1/i)/s.offsetWidth;ad()(s,{backgroundColor:null,scale:r,logging:!1}).then(t=>{t.toBlob(t=>e([t,n,a]),"image/png"),s.remove()}).catch(t)})})}function cd(){return(cd=rd((function*({name:e,type:t,body:n}){if("chat"!==t)return;const[a,i,r]=yield ld(n,e,!1),o=document.createElement("a-entity"),s=document.createElement("a-entity");document.querySelector("a-scene").appendChild(o),o.appendChild(s),o.setAttribute("class","ui"),o.setAttribute("is-remote-hover-target",{}),o.setAttribute("follow-in-fov",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-.8}});const l=URL.createObjectURL(a);s.setAttribute("animation__float",{property:"position",dur:1e4,from:{x:0,y:0,z:0},to:{x:0,y:.05,z:-.05},easing:"easeOutQuad"}),o.setAttribute("animation__spawn",{property:"scale",dur:200,from:{x:.1,y:.1,z:.1},to:{x:1,y:1,z:1},easing:"easeOutElastic"}),s.setAttribute("animation__opacity",{property:"meshMaterial.opacity",isRawProperty:!0,delay:3e3,dur:8e3,from:1,to:0,easing:"easeInQuad"}),s.addEventListener("animationcomplete__opacity",()=>{o.parentNode.removeChild(o)}),od.load(l,e=>{const t=new THREE.MeshBasicMaterial;t.transparent=!0,t.map=e,t.generateMipmaps=!1,t.needsUpdate=!0;const n=Object(lt.g)(1,1,1,1,e.flipY),a=new THREE.Mesh(n,t);s.setObject3D("mesh",a),s.meshMaterial=t;s.object3DMap.mesh.scale.set(i/400,r/400,1)})}))).apply(this,arguments)}function dd(e,t){return ud.apply(this,arguments)}function ud(){return(ud=rd((function*(e,t){if(0===e.length)return;try{if(new URL(Object(te.g)(e)).host)return void document.querySelector("a-scene").emit("add_media",e)}catch(e){}const[n]=yield ld(e,t,!0);document.querySelector("a-scene").emit("add_media",new File([n],"message.png",{type:"image/png"}))}))).apply(this,arguments)}function hd(e){const{content:t}=sd(e.body,e.name,e.sessionId,e.onViewProfile);return Hi.a.createElement("div",{className:e.className},e.maySpawn&&Hi.a.createElement("button",{className:Wi()(Fl.a.iconButton,Fl.a.spawnMessage),onClick:()=>dd(e.body)}),t)}function pd({name:e,body:{src:t},className:n,maySpawn:i,hubId:r}){const o=Object(po.a)(),s=Object(m.g)(t),l=cr.bind(null,{url:s,title:o.formatMessage({id:"photo-message.default-tweet",defaultMessage:"Taken in {shareHashtag}"},{shareHashtag:a.a.translation("share-hashtag"),url:"https://".concat(a.a.SHORTLINK_DOMAIN,"/").concat(r)})});return Hi.a.createElement("div",{className:n},i&&Hi.a.createElement("button",{className:Wi()(Fl.a.iconButton,Fl.a.share),onClick:l}),Hi.a.createElement("div",{className:Fl.a.mediaBody},Hi.a.createElement(Yi.a,{id:"photo-message.body",defaultMessage:"{name} took a <a>photo</a>.",values:{name:Hi.a.createElement("b",null,e),a:e=>Hi.a.createElement("b",null,Hi.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},e))}})),Hi.a.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement("img",{src:t})))}function md({name:e,body:{src:t},className:n,maySpawn:i,hubId:r}){const o=Object(po.a)(),s=cr.bind(null,{url:t,title:o.formatMessage({id:"video-message.default-tweet",defaultMessage:"Taken in {shareHashtag}"},{shareHashtag:a.a.translation("share-hashtag"),url:"https://".concat(a.a.SHORTLINK_DOMAIN,"/").concat(r)})});return Hi.a.createElement("div",{className:n},i&&Hi.a.createElement("button",{className:Wi()(Fl.a.iconButton,Fl.a.share),onClick:s}),Hi.a.createElement("div",{className:Fl.a.mediaBody},Hi.a.createElement(Yi.a,{id:"video-message.body",defaultMessage:"{name} took a <a>video</a>.",values:{name:Hi.a.createElement("b",null,e),a:e=>Hi.a.createElement("b",null,Hi.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},e))}})))}function fd({name:e,body:{src:t},className:n,maySpawn:a}){return Hi.a.createElement("div",{className:n},a&&Hi.a.createElement("button",{className:Wi()(Fl.a.iconButton,Fl.a.spawnMessage),onClick:()=>function(e){document.querySelector("a-scene").emit("add_media",e)}(t)}),Hi.a.createElement("div",{className:Fl.a.mediaBody},e&&Hi.a.createElement("div",{className:Fl.a.messageSource},e,":")),Hi.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement("img",{src:Object(Ut.j)(t)})))}hd.propTypes={name:Ui.a.string,maySpawn:Ui.a.bool,body:Ui.a.string,sessionId:Ui.a.string,className:Ui.a.string,onViewProfile:Ui.a.func},pd.propTypes={name:Ui.a.string,maySpawn:Ui.a.bool,body:Ui.a.object,className:Ui.a.string,hubId:Ui.a.string},md.propTypes={name:Ui.a.string,maySpawn:Ui.a.bool,body:Ui.a.object,className:Ui.a.string,hubId:Ui.a.string},fd.propTypes={name:Ui.a.string,maySpawn:Ui.a.bool,body:Ui.a.object,className:Ui.a.string};class gd extends Li.Component{constructor(e){super(e),this.domForEntry=e=>{const t={[Fl.a.presenceLogEntry]:!0,[Fl.a.presenceLogEntryWithButton]:("chat"===e.type||"image"===e.type)&&e.maySpawn,[Fl.a.presenceLogChat]:"chat"===e.type,[Fl.a.expired]:!!e.expired},n=!!(e.sessionId?Object(m.h)(this.props.presences,e.sessionId):{}).discord;switch(e.type){case"chat":return Hi.a.createElement(hd,{key:e.key,name:e.name,className:Wi()(t),body:e.body,maySpawn:e.maySpawn,sessionId:e.sessionId,includeFromLink:this.props.inRoom&&!n,history:this.props.history,onViewProfile:this.props.onViewProfile});case"image":return Hi.a.createElement(fd,{key:e.key,name:e.name,className:Wi()(t,Fl.a.media),body:e.body,maySpawn:e.maySpawn});case"photo":return Hi.a.createElement(pd,{key:e.key,name:e.name,className:Wi()(t,Fl.a.media),body:e.body,maySpawn:e.maySpawn,hubId:this.props.hubId});case"video":return Hi.a.createElement(md,{key:e.key,name:e.name,className:Wi()(t,Fl.a.media),body:e.body,maySpawn:e.maySpawn,hubId:this.props.hubId});default:{const n=Xc(e,this.props.intl);return n&&Hi.a.createElement("div",{key:e.key,className:Wi()(t)},Hi.a.createElement("div",null,n))}}}}render(){const e={[Fl.a.presenceLog]:!0,[Fl.a.presenceLogInRoom]:this.props.inRoom};return Hi.a.createElement("div",{className:Wi()(e)},this.props.entries.map(this.domForEntry))}}gd.propTypes={entries:Ui.a.array,inRoom:Ui.a.bool,hubId:Ui.a.string,history:Ui.a.object,presences:Ui.a.object,onViewProfile:Ui.a.func,intl:Ui.a.object};var vd=Object(Zr.c)(gd),bd=n(331),yd=n.n(bd);const Ed=AFRAME.utils.device.isMobile();class wd extends Li.Component{render(){const e=Hi.a.createElement(Yi.a,{id:"preload-overlay.load-button",defaultMessage:"Load Room"});return Hi.a.createElement("div",{className:yd.a.treatment},Hi.a.createElement("div",{className:yd.a.screenshot},this.props.hubScene&&Hi.a.createElement("img",{className:yd.a.screenshot,src:this.props.hubScene.screenshot_url})),Hi.a.createElement("a",{href:"/",target:"_blank",rel:"noopener noreferrer",className:yd.a.logo},Hi.a.createElement("img",{src:a.a.image("logo"),alt:Hi.a.createElement(Yi.a,{id:"preload-overlay.logo-alt",defaultMessage:"Logo"})})),Hi.a.createElement("div",{className:yd.a.mainPanel},Hi.a.createElement("div",{className:yd.a.hubName},this.props.hubName),this.props.onLoadClicked&&(Ed?Hi.a.createElement(jr.c,{preset:"primary",as:"a",href:this.props.baseUrl,target:"_blank",rel:"noreferrer noopener"},e):Hi.a.createElement(jr.c,{preset:"primary",onClick:this.props.onLoadClicked},e))))}}function _d(){return(_d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Sd(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}wd.propTypes={hubName:Ui.a.string,hubScene:Ui.a.object,baseUrl:Ui.a.string,onLoadClicked:Ui.a.func};function xd(e,t,n,a){const i=t.reduce((e,t)=>e+t,0),r=e.canvas.width/i,o=Math.max.apply(Math,n),s=e.canvas.height/o;t=t.map(e=>e*r),n=n.map(e=>e*s),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle=a,e.strokeStyle=a,e.lineWidth=1;let l=0;for(let a=0;a<t.length;a++){const i=l+t[a],r=e.canvas.height-n[a],o=e.canvas.height-(0===a||a===n.length-1?n[a]:n[a+1]);e.beginPath(),e.moveTo(l,r),e.lineTo(i,o),e.lineTo(i,e.canvas.height),e.lineTo(l,e.canvas.height),e.closePath(),e.fill(),e.stroke(),l=i}}const Ad=e=>{const{options:t,data:n,color:a,xAxis:i,yAxis:r}=e,o=Sd(e,["options","data","color","xAxis","yAxis"]),{context:s}=t,l=((e,t,n,a,i={})=>{const r=Hi.a.useRef(null);return Object(Li.useEffect)(()=>{const o=r.current.getContext(i.context||"2d");let s;const l=()=>{e(o,n,a,t),s=window.requestAnimationFrame(l)};return l(),()=>{window.cancelAnimationFrame(s)}},[i.context,n,a,t,e]),r})(xd,a,n.map(e=>e[i]),n.map(e=>e[r]),{context:s});return Hi.a.createElement("canvas",_d({ref:l},o))};Ad.propTypes={options:Ui.a.object,data:Ui.a.array,xAxis:Ui.a.string,yAxis:Ui.a.string,color:Ui.a.string};var Md=n(610),kd=n.n(Md);function Od(e){const t=[];for(const n in e){let a=e[n];"number"==typeof a&&a%1?(a=a.toFixed(2),t.push(Hi.a.createElement(Cd,{key:n,propKey:n,propValue:a}))):"object"==typeof a?(t.push(Hi.a.createElement(Cd,{key:n,propKey:n,propValue:"-"})),t.push(Od(a))):t.push(Hi.a.createElement(Cd,{key:n,propKey:n,propValue:a}))}return t}function Cd({propKey:e,propValue:t}){return void 0!==e&&void 0!==t&&Hi.a.createElement("p",{className:Wi()(kd.a.rtcTileText)},"".concat(e,": "),Hi.a.createElement("span",{className:Wi()(kd.a.rtcValueText)},"".concat(t)))||null}Cd.propTypes={propKey:Ui.a.string,propValue:Ui.a.any};var Pd=n(611),Rd=n.n(Pd);function Td({graphData:e,speed:t,width:n,height:a,data:i,xAxis:r,yAxis:o,title:s,children:l,color:c,backgroundColor:d}){return Hi.a.createElement("div",{className:Wi()(Rd.a.dataTile),style:{backgroundColor:d}},Hi.a.createElement("p",{className:Wi()(Rd.a.dataTileTitle)},s),e&&Hi.a.createElement("div",{style:{position:"relative",width:n||"auto",height:a||"auto",alignSelf:"center",flex:"0 0 auto"}},Hi.a.createElement(Ad,{width:n||"auto",height:a||"auto",options:{context:"2d"},data:e,color:c||"rgb(0, 0, 255)",xAxis:r,yAxis:o})),t&&Hi.a.createElement(Cd,{propKey:"speed",propValue:"".concat(t," Kb/sec")}),Od(i),l)}Td.propTypes={graphData:Ui.a.array,speed:Ui.a.string,data:Ui.a.object,xAxis:Ui.a.string,yAxis:Ui.a.string,title:Ui.a.node,children:Ui.a.node,width:Ui.a.string,height:Ui.a.string,color:Ui.a.string,backgroundColor:Ui.a.string};var jd=n(235),Dd=n.n(jd);function Id({title:e,border:t,row:n,wrap:a,grow:i,url:r,isRoot:o,children:s,data:l,collapsed:c,onCollapse:d,backgroundColor:u,clear:h,download:p}){const m=Wi()(t?Dd.a.borderTile:Dd.a.borderlessTile),f={flexGrow:i?1:0,backgroundColor:u},g=Wi()(o?"".concat(Dd.a.collapsibleContentRoot," ").concat(!c?"":"collapsed"):"".concat(Dd.a.collapsibleContent," ").concat(!c?"":"collapsed")),v=Wi()("".concat(Dd.a.collapseButton," ").concat(!c?"":"collapsed")),b={flexFlow:(n?"row ":"column ")+(a?"wrap":"nowrap")};return Hi.a.createElement("div",{className:m,style:f},Hi.a.createElement("div",{className:Dd.a.collapsibleHeader},e&&Hi.a.createElement("button",{className:Wi()(v),onClick:t=>{const n=function(e){var t,n,a,i;return e.target.classList.toggle("collapsed"),null===(t=e.target.parentElement)||void 0===t||null===(n=t.nextSibling)||void 0===n||n.classList.toggle("collapsed"),null===(a=e.target.parentElement)||void 0===a||null===(i=a.nextSibling)||void 0===i?void 0:i.classList.contains("collapsed")}(t);d&&d(e,n)}},e),r&&Hi.a.createElement("button",{className:Wi()(Dd.a.logButton),onClick:()=>function(e){window.open(e,"_blank").focus()}(r)},"?"),(h||p)&&Hi.a.createElement("div",{className:Dd.a.collapsibleRightButtons},p&&Hi.a.createElement("button",{className:Wi()(Dd.a.logButton),onClick:p},""),h&&Hi.a.createElement("button",{className:Wi()(Dd.a.logButton),onClick:h},""))),Hi.a.createElement("div",{className:g,style:b},Od(l),s))}Id.propTypes={children:Ui.a.node,title:Ui.a.node,border:Ui.a.bool,row:Ui.a.bool,grow:Ui.a.bool,wrap:Ui.a.bool,url:Ui.a.string,isRoot:Ui.a.bool,data:Ui.a.object,collapsed:Ui.a.bool,onCollapse:Ui.a.func,backgroundColor:Ui.a.string,clear:Ui.a.func,download:Ui.a.func};var Ld=n(236),Hd=n.n(Ld),Nd=n(106),Fd=n.n(Nd),Vd=n(154),Bd=n(332),Ud=n.n(Bd);function zd(){return(zd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Wd(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function qd(e){var t=e.title,n=e.titleId,a=Wd(e,["title","titleId"]);return Li.createElement("svg",zd({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M3.828 7.424l5.46 6.372a.938.938 0 001.424 0l5.46-6.372a.938.938 0 00-.712-1.548H4.538c-.8 0-1.233.94-.71 1.548z",fill:a.color}))}qd.defaultProps={color:"#000",title:"Caret Down"};var Gd=n(835);function Yd(){return(Yd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Kd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xd(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Qd(e){return"object"==typeof e?e.value:e}function Jd(e,t){const n=Qd(e);return t.length>0&&"object"==typeof t[0]?t.find(e=>e.value===n):n}function Zd(e){return"object"==typeof e?e.label||e.value:e}function $d(e){let{className:t,error:n,description:a,inputClassName:i,buttonClassName:r,label:o,onChange:s,value:l,options:c,fullWidth:d}=e,u=Xd(e,["className","error","description","inputClassName","buttonClassName","label","onChange","value","options","fullWidth"]);const{isOpen:h,selectedItem:p,getToggleButtonProps:m,getMenuProps:f,getLabelProps:g,highlightedIndex:v,getItemProps:b}=Object(Gd.a)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Kd(e,t,n[t])}))}return e}({items:c,selectedItem:Jd(l,c)},u,{onSelectedItemChange:({selectedItem:e})=>{s&&s(Qd(e))}})),y=Zd(p);return Hi.a.createElement(Vd.a,Yd({},g(),{className:t,label:o,error:n,description:a,fullWidth:d}),Hi.a.createElement("div",{className:Wi()(Ud.a.selectInput,{[Ud.a.open]:h},i)},Hi.a.createElement("button",Yd({className:Wi()(Ud.a.dropdownButton,r),type:"button"},m()),Hi.a.createElement("span",null,void 0!==y?y:Hi.a.createElement(Yi.a,{id:"select-input-field.placeholder",defaultMessage:"Select..."})),Hi.a.createElement(qd,null)),c.length>0&&Hi.a.createElement("ul",Yd({},f(),{className:Ud.a.dropdown}),h&&c.map((e,t)=>Hi.a.createElement("li",Yd({className:Wi()(Ud.a.dropdownItem,{[Ud.a.highlightedItem]:v===t}),key:Qd(e)},b({item:e,index:t})),Zd(e))))))}$d.propTypes={className:Ui.a.string,label:Ui.a.node,error:Ui.a.node,description:Ui.a.node,labelClassName:Ui.a.string,inputClassName:Ui.a.string,buttonClassName:Ui.a.string,value:Ui.a.any,options:Ui.a.arrayOf(Ui.a.oneOfType([Ui.a.string,Ui.a.number,Ui.a.shape({label:Ui.a.string,value:Ui.a.any.isRequired})])).isRequired,onChange:Ui.a.func,fullWidth:Ui.a.bool},$d.defaultProps={options:[]};function eu({defaultValue:e,options:t,onChange:n,children:a}){const[i,r]=Object(Li.useState)(e);return Hi.a.createElement("div",{className:Wi()(Fd.a.audioDebugRow)},Hi.a.createElement("span",{style:{flex:"none",padEnd:"10px"}},a),Hi.a.createElement($d,{value:i,options:t,onChange:e=>{r(e),n(e)}}))}function tu({defaultValue:e,step:t,min:n,max:a,onChange:i,children:r}){return Hi.a.createElement("div",{className:Wi()(Fd.a.audioDebugRow)},Hi.a.createElement("span",{style:{flex:"none",padEnd:"10px"}},r),Hi.a.createElement("input",{type:"range",step:t,min:n,max:a,value:e,onChange:e=>{const t=parseFloat(e.target.value);i(t)}}),Hi.a.createElement("span",{className:Wi()(Fd.a.valueText)},e))}function nu(){return{enableAudioClipping:APP.store.state.preferences.enableAudioClipping,audioClippingThreshold:APP.store.state.preferences.audioClippingThreshold,globalVoiceVolume:APP.store.state.preferences.globalVoiceVolume,globalMediaVolume:APP.store.state.preferences.globalMediaVolume,globalSFXVolume:APP.store.state.preferences.globalSFXVolume}}function au({isNarrow:e,collapsed:t,onCollapsed:n}){const[a,i]=Object(Li.useState)(Object(Zt.b)($t.g.MEDIA_VIDEO)),[r,o]=Object(Li.useState)(Object(Zt.b)($t.g.AVATAR_AUDIO_SOURCE)),s=(e,t)=>{const n=Object.assign({},APP.audioDebugPanelOverrides.get(e),t);APP.audioDebugPanelOverrides.set(e,n),e===$t.g.MEDIA_VIDEO?i(Object(Zt.b)($t.g.MEDIA_VIDEO)):o(Object(Zt.b)($t.g.AVATAR_AUDIO_SOURCE));for(const[e,t]of APP.audios.entries())Object(Zt.d)(e,t)},[l,c]=Object(Li.useState)(nu()),d=Object(Li.useCallback)(()=>{c(nu())},[c]);return Object(Li.useEffect)(()=>(d(),APP.store.addEventListener("statechanged",d),()=>{APP.store.removeEventListener("statechanged",d),APP.audioDebugPanelOverrides.delete($t.g.MEDIA_VIDEO),APP.audioDebugPanelOverrides.delete($t.g.AVATAR_AUDIO_SOURCE);for(const[e,t]of APP.audios.entries())Object(Zt.d)(e,t)}),[d]),Hi.a.createElement("div",{className:Wi()(Fd.a.audioDebugContainer),style:{height:e&&!t&&"80%",maxHeight:e&&!t&&"80%"}},Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"audio-debug-panel.audio-debug-title",defaultMessage:"Audio Debug"}),isRoot:!0,border:!0,collapsed:t,onCollapse:n},Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"audio-debug-panel.audio-debug-global-title",defaultMessage:"Globals"}),border:!0,grow:!0},Hi.a.createElement("div",{style:{display:"flex",alignItems:"center"}},Hi.a.createElement("input",{tabIndex:"0",type:"checkbox",checked:l.enableAudioClipping,onChange:()=>{APP.store.update({preferences:{enableAudioClipping:!l.enableAudioClipping}})},style:{marginLeft:"10px"}}),Hi.a.createElement(tu,{defaultValue:l.audioClippingThreshold,step:.001,min:0,max:.1,onChange:e=>{APP.store.update({preferences:{audioClippingThreshold:e}})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.global.clippingThreshold",defaultMessage:"Clipping"})))),Hi.a.createElement(tu,{defaultValue:l.globalVoiceVolume,step:5,min:0,max:200,onChange:e=>{APP.store.update({preferences:{globalVoiceVolume:e}})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.global.voiceVolume",defaultMessage:"Voice Volume"}))),Hi.a.createElement(tu,{defaultValue:l.globalMediaVolume,step:5,min:0,max:200,onChange:e=>{APP.store.update({preferences:{globalMediaVolume:e}})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.global.mediaVolume",defaultMessage:"Media Volume"}))),Hi.a.createElement(tu,{defaultValue:l.globalSFXVolume,step:5,min:0,max:200,onChange:e=>{APP.store.update({preferences:{globalSFXVolume:e}})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.global.sfxVolume",defaultMessage:"SFX Volume"})))),Hi.a.createElement("div",{style:{display:"flex"}},Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"audio-debug-panel.audio-debug-avatar-title",defaultMessage:"Avatar"}),border:!0,grow:!0},Hi.a.createElement(eu,{defaultValue:r.distanceModel,options:$t.c,onChange:e=>{const t={distanceModel:e};e===$t.d.Linear&&r.rolloffFactor>1&&(t.rolloffFactor=1),s($t.g.AVATAR_AUDIO_SOURCE,t)}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.distanceModel",defaultMessage:"Distance Model"}))),Hi.a.createElement(tu,{defaultValue:r.rolloffFactor,step:r.distanceModel===$t.d.Linear?.01:.5,min:(r.distanceModel,$t.d.Linear,0),max:r.distanceModel===$t.d.Linear?1:20,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{rolloffFactor:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.rolloffFactor",defaultMessage:"Rolloff"}))),Hi.a.createElement(tu,{defaultValue:r.refDistance,step:1,min:1,max:100,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{refDistance:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.refDistance",defaultMessage:"Ref Distance"}))),Hi.a.createElement(tu,{defaultValue:r.maxDistance,step:1,min:1,max:100,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{maxDistance:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.maxDistance",defaultMessage:"Max Distance"}))),Hi.a.createElement(tu,{defaultValue:r.coneInnerAngle,step:1,min:0,max:360,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{coneInnerAngle:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.innerAngle",defaultMessage:"Inner Angle"}))),Hi.a.createElement(tu,{defaultValue:r.coneOuterAngle,step:1,min:0,max:360,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{coneOuterAngle:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.outerAngle",defaultMessage:"Outer Angle"}))),Hi.a.createElement(tu,{defaultValue:r.coneOuterGain,step:.1,min:0,max:1,onChange:e=>{s($t.g.AVATAR_AUDIO_SOURCE,{coneOuterGain:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.avatar.outerGain",defaultMessage:"Outer Gain"})))),Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"audio-debug-panel.audio-debug-media-title",defaultMessage:"Media"}),border:!0,grow:!0},Hi.a.createElement(eu,{defaultValue:a.distanceModel,options:$t.c,onChange:e=>{const t={distanceModel:e};e===$t.d.Linear&&a.rolloffFactor>1&&(t.rolloffFactor=1),s($t.g.MEDIA_VIDEO,t)}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.distanceModel",defaultMessage:"Distance Model"}))),Hi.a.createElement(tu,{defaultValue:a.rolloffFactor,step:a.distanceModel===$t.d.Linear?.01:.5,min:(a.distanceModel,$t.d.Linear,0),max:a.distanceModel===$t.d.Linear?1:20,onChange:e=>{s($t.g.MEDIA_VIDEO,{rolloffFactor:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.rolloffFactor",defaultMessage:"Rolloff"}))),Hi.a.createElement(tu,{defaultValue:a.refDistance,step:1,min:1,max:100,onChange:e=>{s($t.g.MEDIA_VIDEO,{refDistance:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.refDistance",defaultMessage:"Ref Distance"}))),Hi.a.createElement(tu,{defaultValue:a.maxDistance,step:1,min:1,max:100,onChange:e=>{s($t.g.MEDIA_VIDEO,{maxDistance:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.maxDistance",defaultMessage:"Max Distance"}))),Hi.a.createElement(tu,{defaultValue:a.coneInnerAngle,step:1,min:0,max:360,onChange:e=>{s($t.g.MEDIA_VIDEO,{coneInnerAngle:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.innerAngle",defaultMessage:"Inner Angle"}))),Hi.a.createElement(tu,{defaultValue:a.coneOuterAngle,step:1,min:0,max:360,onChange:e=>{s($t.g.MEDIA_VIDEO,{coneOuterAngle:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.outerAngle",defaultMessage:"Outer Angle"}))),Hi.a.createElement(tu,{defaultValue:a.coneOuterGain,step:.1,min:0,max:1,onChange:e=>{s($t.g.MEDIA_VIDEO,{coneOuterGain:e})}},Hi.a.createElement("p",{className:Wi()(Fd.a.propText)},Hi.a.createElement(Yi.a,{id:"audio-debug-view.media.outerGain",defaultMessage:"Outer Gain"})))))))}function iu(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function ru(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){iu(r,a,i,o,s,"next",e)}function s(e){iu(r,a,i,o,s,"throw",e)}o(void 0)}))}}function ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){su(e,t,n[t])}))}return e}function su(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lu(){return(lu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function cu(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}eu.propTypes={defaultValue:Ui.a.string,options:Ui.a.array,onChange:Ui.a.func,children:Ui.a.node},tu.propTypes={defaultValue:Ui.a.number,step:Ui.a.number,min:Ui.a.number,max:Ui.a.number,onChange:Ui.a.func,children:Ui.a.node},au.propTypes={isNarrow:Ui.a.bool,collapsed:Ui.a.bool,onCollapsed:Ui.a.func,children:Ui.a.node};const du=AFRAME.utils.device.isMobile(),uu="send_transport",hu="receive_transport",pu="inbound-rtp",mu="outbound-rtp",fu="local-candidate",gu="remote-candidate",vu="candidate-pair",bu="transport",yu="https://mediasoup.org/documentation/v3/libmediasoupclient/api/",Eu="https://developer.mozilla.org/en-US/docs/Web/API/",wu={width:"auto",alignSelf:"center",margin:"5px",padding:"4px 18px",fontSize:"12px",minWidth:"120px"},_u=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;function Su(e){return e?e.replace(/\b\w/g,e=>e.toUpperCase()):""}function xu(e){let{children:t}=e,n=cu(e,["children"]);return Hi.a.createElement(jr.c,lu({},n,{style:wu}),t)}function Au({title:e,data:t,xAxis:n,yAxis:a,stats:i}){var r;const o={id:t.id,opened:t.opened,paused:t.paused,kind:t.kind,codec:t.codec};var s,l,c;"video"===t.kind&&((void 0!==t.spatialLayer||void 0!==t.temporalLayer)&&(o.currentLayers="S[".concat(t.spatialLayer,"] T[").concat(t.temporalLayer,"]")),null!=t.score&&(o.score="S[".concat(null===(s=t.score)||void 0===s?void 0:s.score,"] P[").concat(null===(l=t.score)||void 0===l?void 0:l.producerScore,"][").concat(null===(c=t.score)||void 0===c?void 0:c.producerScores,"]")),null!=t.frameRate&&(o.frameRate="".concat(t.frameRate)),null!=t.width&&(o.width="".concat(t.width)),null!=t.height&&(o.height="".concat(t.height)));const d=t.opened&&(null==i?void 0:i.speed)?null:"#8b1c00";return Hi.a.createElement(Td,{title:e,data:o,backgroundColor:d},(null==t?void 0:t.track)&&Hi.a.createElement(Td,{key:t.id,data:t.track,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.track-panel-title",defaultMessage:"Track"})}),i&&Hi.a.createElement(Td,{key:null===(r=i.rtpStats)||void 0===r?void 0:r.id,graphData:i.graph.slice(),width:"120px",height:"50px",color:"green",speed:i.speed,data:i.rtpStats,xAxis:n,yAxis:a,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.stats-panel-title",defaultMessage:"Stats"})}))}function Mu({title:e,data:t,candidates:n,producers:a,consumers:i,isButtonEnabled:r,onRestart:o}){const s=(null==a?void 0:a.some(e=>{var t,n,a,i;return!(null===(t=e.props)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.opened)||!(null===(a=e.props)||void 0===a||null===(i=a.stats)||void 0===i?void 0:i.speed)}))?"#8b1c00":null;return Hi.a.createElement(Id,{key:e,title:e,border:!0,url:"".concat(yu,"#Transport"),data:t},Hi.a.createElement(xu,{onClick:o,disabled:!r,preset:"accept"},Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.restart-ice-button",defaultMessage:"Restart ICE"})),Hi.a.createElement(Id,{key:"Candidates",title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.local-candidates-panel-title",defaultMessage:"Candidates"}),row:!0,url:"".concat(Eu,"RTCIceCandidate"),border:!0,backgroundColor:0===(null==n?void 0:n.length)&&"connected"===(null==t?void 0:t.state)&&(null==t?void 0:t.opened)?"#8b1c00":null},(null==n?void 0:n.length)&&n||Hi.a.createElement("p",{className:Wi()(Hd.a.rtcLogMsg)},Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.local-no-candidates-message",defaultMessage:"No Candidates"}))),(null==a?void 0:a.length)&&Hi.a.createElement(Id,{key:"Local producers",title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.local-producers-panel-title",defaultMessage:"Local Producers"}),row:!0,url:"".concat(yu,"#Producer"),border:!0,collapsed:!0,backgroundColor:s},a)||null,i||null)}function ku({data:e,onConnect:t,onDisconnect:n}){return Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.signaling-panel-title",defaultMessage:"Signaling"}),border:!0,data:e},Hi.a.createElement(xu,{onClick:()=>{e.connected?n():t()},disabled:!1,preset:"accept"},e.connected?Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.disconnect-signaling-button",defaultMessage:"Disconnect"}):Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.connect-signaling-button",defaultMessage:"Connect"})))}xu.propTypes={children:Ui.a.node},Au.propTypes={title:Ui.a.node,data:Ui.a.object,xAxis:Ui.a.string,yAxis:Ui.a.string,stats:Ui.a.object,backgroundColor:Ui.a.string},Mu.propTypes={candidates:Ui.a.array,producers:Ui.a.array,consumers:Ui.a.array,data:Ui.a.object,onRestart:Ui.a.func,title:Ui.a.node,isButtonEnabled:Ui.a.bool},ku.propTypes={data:Ui.a.object,onConnect:Ui.a.func,onDisconnect:Ui.a.func};class Ou extends Li.Component{constructor(){super(),this.logEvent=e=>{const t=this.state.log.slice(-200)||[];t.push(e.detail),this.setState({log:t})},this.storeUpdated=()=>{const e=this.props.store.state.preferences.showRtcDebugPanel;this.setState({showPanel:e})},this.restartSendICE=()=>{APP.dialog.restartSendICE()},this.restartRecvICE=()=>{APP.dialog.restartRecvICE()},this.connectSignaling=()=>{APP.dialog.connect({serverUrl:APP.dialog._serverUrl,roomId:APP.dialog._roomId,joinToken:APP.hubChannel.token,serverParams:APP.dialog._serverParams,scene:APP.dialog.scene,clientId:APP.dialog._clientId,forceTcp:APP.dialog._forceTcp,forceTurn:APP.dialog._forceTurn,iceTransportPolicy:APP.dialog._iceTransportPolicy})},this.disconnectSignaling=()=>{APP.dialog.disconnect()},this.colorForLevel=e=>{switch(e){case"error":return"red";case"warn":return"orange";default:return"white"}},this.createLogMsgs=()=>{var e;const t=[];return null===(e=this.state.log)||void 0===e||e.slice().reverse().forEach((e,n)=>{t.push(Hi.a.createElement("span",{key:n<<2,className:Wi()(Hd.a.rtcLogTime)},"[".concat(e.time,"] "))),t.push(Hi.a.createElement("span",{key:n<<2|1,className:Wi()(Hd.a.rtcLogTag)},"[".concat(e.tag,"] "))),t.push(Hi.a.createElement("span",{key:n<<2|2,className:Wi()(Hd.a.rtcLogMsg),style:{color:this.colorForLevel(e.level)}},e.msg)),t.push(Hi.a.createElement("br",{key:n<<2|3}))}),t},this.createLog=()=>{var e;const t=[];return null===(e=this.state.log)||void 0===e||e.slice().reverse().forEach(e=>{t.push("[".concat(e.time,"] [").concat(e.tag,"] ").concat(e.msg))}),t.join("\r")},this.onCollapse=(e,t)=>{const n=null==e?void 0:e.props.defaultMessage,a=ou({},this.state.collapsed);if(du||window.innerWidth<500)for(const e of Object.keys(a))n===e?a[e]=t:t||(a[e]=!0);else a[n]=t;this.setState({collapsed:a})},this.state={log:[],collapsed:{Local:!1,Log:du,Remote:!0,Audio:!0}}}componentDidMount(){this.props.scene.addEventListener("rtc_event",this.logEvent),this.props.store.addEventListener("statechanged",this.storeUpdated),this.runStats(!0)}componentWillUnmount(){this.props.scene.removeEventListener("rtc_event",this.logEvent),this.props.store.removeEventListener("statechanged",this.storeUpdated),this.runStats(!1)}getDeviceData(){let e={};const t=APP.dialog._mediasoupDevice;var n;t&&(e.loaded=!t._closed,e.codecs=null===(n=t._recvRtpCapabilities)||void 0===n?void 0:n.codecs.map(e=>"["+e.mimeType+"/"+e.clockRate+"]"),e=ou({},e,APP.dialog.downlinkBwe));return e}getCandidatesData(e){return ru((function*(){const t={},n=yield e.getStats();let a=null;if(!_u)for(const e of n.values())e.type===bu&&(a=e.selectedCandidatePairId);for(const e of n.values())if(e.type===vu){const i=e;let r=!1;if(r=_u?i&&i.selected&&"succeeded"===i.state:i.id===a,r)for(const e of n.values())i.localCandidateId===e.id?t[fu]=e:i.remoteCandidateId===e.id&&(t[gu]=e)}return t}))()}getTransportData(e){var t=this;return ru((function*(){const n={};let a;e===uu?a=APP.dialog._sendTransport:e===hu&&(a=APP.dialog._recvTransport);const i=!(!a||a._closed);return n.opened=i,a&&(n.state=i?a._connectionState:"closed",n.id=a._id,n.producers=[],n.consumers=[],a._producers.forEach(e=>{n.producers.push(t.getProducerConsumerData(e))}),a._consumers.forEach(e=>{n.consumers.push(t.getProducerConsumerData(e))}),i&&(n.candidates=yield t.getCandidatesData(a))),n}))()}profileFromPresence([,e]){return e.metas[e.metas.length-1].profile}profileFromConsumer(e){return Object.entries(this.props.presences||{}).filter(([t])=>t===e._appData.peerId).map(this.profileFromPresence).shift()}getProducerConsumerData(e){const t={};if(t.opened=!e._closed,e){const n=Object.entries(this.props.presences||{}).filter(([t])=>t===e._appData.peerId).map(this.profileFromPresence).shift();t.id=e._id,t.paused=e._paused,t.track=this.getTrackData(e),t.kind=e._kind||t.track.kind,t.codec=e.rtpParameters.codecs[0].mimeType.split("/")[1],t.name=n?n.displayName:"N/A",t.peerId=e._appData.peerId;const a=APP.dialog.consumerStats[e._id];"video"===t.kind&&a&&(t.spatialLayer=a.spatialLayer,t.temporalLayer=a.temporalLayer,t.score=a.score)}return t}getTrackData(e){const t={};return t.id=e._track.id,t.enabled=!(null===e._track||!e._track.enabled),t.kind=e._track.kind,t.muted=e._track.muted,t.state=e._track.readyState,t}getSignalingData(){return{connected:APP.dialog._protoo&&APP.dialog._protoo.connected}}getServerData(){return ru((function*(){return yield APP.dialog.getServerStats()}))()}getRtpStatsData(e,t){return ru((function*(){const n=yield e.getStats();for(const e of n.values())if(e.type===t)return e;return{}}))()}getGraphData(e,t){var n,a,i,r,o,s,l,c,d;let u=null===(n=this.state.statsData)||void 0===n||null===(a=n[e])||void 0===a?void 0:a.last;const h=(null==t?void 0:t.bytesSent)||0,p=(null==t?void 0:t.bytesReceived)||0,m=(null==t?void 0:t.packetsSent)||0,f=(null==t?void 0:t.packetsReceived)||0,g=(null==t?void 0:t.timestamp)||0,v=h-(null===(i=u)||void 0===i?void 0:i.bytesSent)||0,b=p-(null===(r=u)||void 0===r?void 0:r.bytesReceived)||0,y=m-(null===(o=u)||void 0===o?void 0:o.packetsSent)||0,E=f-(null===(s=u)||void 0===s?void 0:s.packetsReceived)||0,w=g-(null===(l=u)||void 0===l?void 0:l.timestamp)||0;let _=null===(c=this.state.statsData)||void 0===c||null===(d=c[e])||void 0===d?void 0:d.graph;if(!_){const e=new Array(20);e.fill({bytesSent:0,bytesReceived:0,packetsSent:0,packetsReceived:0,timeDelta:0}),_=e}return _.shift(),_.push({bytesSent:v,bytesReceived:b,packetsSent:y,packetsReceived:E,timeDelta:w}),u={bytesSent:h,bytesReceived:p,packetsSent:m,packetsReceived:f,timestamp:g},{lastStats:u,graphData:_}}getPeerSpeed(e,t){var n,a;let i="0.00";const r=null===(n=this.state.statsData)||void 0===n||null===(a=n[e])||void 0===a?void 0:a.graph;if(r){const e=r[r.length-1];e&&(i=(e[t]/1024*(1/(e.timeDelta/1e3))||0).toFixed(2))}return i}runStats(e){var t=this;return ru((function*(){if(e&&t.state){const e=setInterval(()=>{ru((function*(){try{const e=t.getDeviceData(),n=t.state.collapsed.Remote?{}:yield t.getServerData(),a=t.getSignalingData(),i={};i[uu]=yield t.getTransportData(uu),i[hu]=yield t.getTransportData(hu);const r={};if(APP.dialog._micProducer){const e=APP.dialog._micProducer.id,n=APP.dialog._micProducer,a=t.getPeerSpeed(e,"bytesSent"),i=yield t.getRtpStatsData(n,mu),{lastStats:o,graphData:s}=t.getGraphData(e,i);r[e]={},r[e].speed=a,r[e].graph=s,r[e].last=o,r[e].rtpStats=i}if(APP.dialog._cameraProducer){const e=APP.dialog._cameraProducer.id,n=APP.dialog._cameraProducer,a=t.getPeerSpeed(e,"bytesSent"),i=yield t.getRtpStatsData(n,mu),{lastStats:o,graphData:s}=t.getGraphData(e,i);r[e]={},r[e].speed=a,r[e].graph=s,r[e].last=o,r[e].rtpStats=i}if(APP.dialog._shareProducer){const e=APP.dialog._shareProducer.id,n=APP.dialog._shareProducer,a=t.getPeerSpeed(e,"bytesSent"),i=yield t.getRtpStatsData(n,mu),{lastStats:o,graphData:s}=t.getGraphData(e,i);r[e]={},r[e].speed=a,r[e].graph=s,r[e].last=o,r[e].rtpStats=i}for(const e of APP.dialog._consumers){const n=e[0],a=e[1],i=t.getPeerSpeed(n,"bytesReceived"),o=yield t.getRtpStatsData(a,pu),{lastStats:s,graphData:l}=t.getGraphData(n,o);r[n]={},r[n].speed=i,r[n].graph=l,r[n].last=s,r[n].rtpStats=o}t.setState({signalingData:a,serverData:n,deviceData:e,statsData:r,transportsData:i})}catch(e){console.log("Run Stats error: ".concat(e))}}))()},2e3);t.setState({taskId:e})}else clearInterval(t.state.taskId)}))()}createCandidates(e){const t=[];return e&&(e[fu]&&t.push(Hi.a.createElement(Td,{key:fu,data:e[fu],title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.local-candidate-panel-title",defaultMessage:"Local Candidate"})})),e[gu]&&t.push(Hi.a.createElement(Td,{key:gu,data:e[gu],title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.remote-candidate-panel-title",defaultMessage:"Remote Candidate"})}))),t}createProducers(e=[],t){return e.map(e=>Hi.a.createElement(Au,{key:e.id,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.producer-panel-title",defaultMessage:"{kind} Producer",values:{kind:Su(null==e?void 0:e.kind)}}),data:e,xAxis:"timeDelta",yAxis:"bytesSent",stats:t[e.id]}))}createConsumers(e,t){const n=(null==e?void 0:e.reduce((e,t)=>(e[t.peerId]=e[t.peerId]||{},e[t.peerId].name=t.name,e[t.peerId].peerId=t.peerId,e[t.peerId].consumers=e[t.peerId].consumers||[],e[t.peerId].consumers.push(t),e),[]))||[],a=[];for(const[,e]of Object.entries(n)){var i;const n=e.consumers.map(e=>Hi.a.createElement(Au,{key:e.id,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.consumer-panel-title",defaultMessage:"{kind} Consumer",values:{kind:Su(null==e?void 0:e.kind)}}),data:e,xAxis:"timeDelta",yAxis:"bytesReceived",stats:t[e.id]})),r=(null==e||null===(i=e.consumers)||void 0===i?void 0:i.some(e=>{var n;return!e.opened||!(null===(n=t[e.id])||void 0===n?void 0:n.speed)}))?"#8b1c00":null;a.push(Hi.a.createElement(Id,{key:e.name,title:e.name,url:"".concat(yu,"#Consumer"),data:{peerId:e.peerId},border:!0,collapsed:!0,backgroundColor:r},Hi.a.createElement(Id,{row:!0},n)))}return a}createRemoteTransports(e){const t=[];if(e)for(const n in e){const a=e[n],i=[];if(null==a?void 0:a.producers)for(const e in a.producers){a.producers[e].forEach((t,n)=>{i.push(Hi.a.createElement(Td,{key:"".concat(e).concat(n),data:t,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.producer-transport-stats-title",defaultMessage:"{kind} Stats",values:{kind:Su(t.kind)}})}))})}const r=[];if(null==a?void 0:a.consumers)for(const e in a.consumers){a.consumers[e].forEach((t,n)=>{r.push(Hi.a.createElement(Td,{key:"".concat(e).concat(n),data:t,title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.consumer-transport-stats-title",defaultMessage:"{kind} Stats",values:{kind:Su(t.kind)}})}))})}t.push(Hi.a.createElement(Id,{key:n,title:"".concat(a.name," Transport"),url:"".concat(Eu,"RTCStatsReport"),data:{id:n},border:!0},(null==i?void 0:i.length)&&Hi.a.createElement(Id,{key:"producers",title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.producer-transport-stats-panel-title",defaultMessage:"Producer Stats"}),row:!0,wrap:!0,url:"".concat(Eu,"RTCStatsReport"),border:!0},i)||null,(null==r?void 0:r.length)&&Hi.a.createElement(Id,{key:"consumers",title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.consumer-transport-stats-panel-title",defaultMessage:"Consumer Stats"}),row:!0,wrap:!0,url:"".concat(Eu,"RTCStatsReport"),border:!0},r)||null))}return t}render(){var e,t,n,a,i,r,o,s,l,c,d,u;const{signalingData:h,serverData:p,statsData:m,deviceData:f,transportsData:g,collapsed:v}=this.state,b=du||window.innerWidth<500;return Hi.a.createElement("div",null,Hi.a.createElement("div",{className:Wi()(Hd.a.rtcDebugPanelRoot)},Hi.a.createElement("div",{className:Wi()(Hd.a.rtcStatusContainerLeft),style:{height:b&&!v.Local&&"80%",maxHeight:b&&!v.Local&&"80%"}},this.props.showRtcDebug&&Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.local-panel-title",defaultMessage:"Local"}),isRoot:!0,border:!0,grow:!0,collapsed:v.Local,onCollapse:this.onCollapse},f&&Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.device-panel-title",defaultMessage:"Device"}),border:!0,url:"".concat(yu,"#Device"),data:f}),h&&Hi.a.createElement(ku,{data:h,onConnect:this.connectSignaling,onDisconnect:this.disconnectSignaling}),Hi.a.createElement("div",{style:{display:"flex",flexFlow:"column"}},Hi.a.createElement(Mu,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.send-transport-panel-title",defaultMessage:"Send Transport"}),data:{id:null==g||null===(e=g[uu])||void 0===e?void 0:e.id,opened:null==g||null===(t=g[uu])||void 0===t?void 0:t.opened,state:null==g||null===(n=g[uu])||void 0===n?void 0:n.state},candidates:this.createCandidates(null==g||null===(a=g[uu])||void 0===a?void 0:a.candidates),producers:this.createProducers(null==g||null===(i=g[uu])||void 0===i?void 0:i.producers,m),onRestart:this.restartSendICE,isButtonEnabled:null==g||null===(r=g[uu])||void 0===r?void 0:r.opened})),Hi.a.createElement("div",{style:{display:"flex",flexFlow:"column"}},Hi.a.createElement(Mu,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.receive-transport-panel-title",defaultMessage:"Receive Transport"}),data:{id:null==g||null===(o=g[hu])||void 0===o?void 0:o.id,opened:null==g||null===(s=g[hu])||void 0===s?void 0:s.opened,state:null==g||null===(l=g[hu])||void 0===l?void 0:l.state},candidates:this.createCandidates(null==g||null===(c=g[hu])||void 0===c?void 0:c.candidates),consumers:this.createConsumers(null==g||null===(d=g[hu])||void 0===d?void 0:d.consumers,m),onRestart:this.restartRecvICE,isButtonEnabled:null==g||null===(u=g[hu])||void 0===u?void 0:u.opened})))),Hi.a.createElement("div",{className:Wi()(Hd.a.statusContainerMiddle)},this.props.showAudioDebug&&Hi.a.createElement(au,{isNarrow:!0,collapsed:v.Audio,onCollapsed:this.onCollapse}),this.props.showRtcDebug&&Hi.a.createElement("div",{className:Wi()(Hd.a.rtcLogContainer),style:{height:b&&!v.Log&&"80%",maxHeight:b&&!v.Log&&"80%"}},Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.log-panel-title",defaultMessage:"Log"}),isRoot:!0,border:!0,grow:!0,collapsed:v.Log,onCollapse:this.onCollapse,clear:()=>{this.setState({log:[]})},download:()=>{!function(e,t){const n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("rtc_log.txt",this.createLog())}},Hi.a.createElement("p",{className:Wi()(Hd.a.rtcLogMsgContainer)},this.createLogMsgs())))),Hi.a.createElement("div",{className:Wi()(Hd.a.rtcStatusContainerRight),style:{height:b&&!v.Remote&&"80%",maxHeight:b&&!v.Remote&&"80%"}},this.props.showRtcDebug&&Hi.a.createElement(Id,{title:Hi.a.createElement(Yi.a,{id:"rtc-debug-panel.remote-panel-title",defaultMessage:"Remote"}),isRoot:!0,border:!0,grow:!0,collapsed:v.Remote,onCollapse:this.onCollapse},this.createRemoteTransports(p)))))}}Ou.propTypes={avatarId:Ui.a.string,store:Ui.a.object,scene:Ui.a.object,intl:Ui.a.object,presences:Ui.a.object,history:Ui.a.object,sessionId:Ui.a.string,showRtcDebug:Ui.a.bool,showAudioDebug:Ui.a.bool};var Cu=n(109),Pu=n(434),Ru=n.n(Pu),Tu=n(139);function ju({center:e,bottom:t}){return Hi.a.createElement("div",{className:Ru.a.loadingScreenLayout},Hi.a.createElement(Hr.a,{center:!0,padding:!0,gap:"lg",className:Ru.a.center},Hi.a.createElement(Tu.a,{className:Ru.a.logo}),e),t&&Hi.a.createElement(Hr.a,{center:!0,className:Ru.a.bottom},t))}ju.propTypes={center:Ui.a.node,bottom:Ui.a.node};var Du=n(257);function Iu({message:e,infoMessages:t}){const n=function(e,t=5e3){const n=Object(Li.useRef)(),[a,i]=Object(Li.useState)(Math.round(Math.random()*(e.length-1))),r=Object(Li.useCallback)(()=>{n.current=setTimeout(()=>{i(t=>(t+1)%e.length),r()},t)},[i,e,t]);return Object(Li.useEffect)(()=>(r(),()=>{clearTimeout(n.current)}),[r]),e[a]}(t);return Hi.a.createElement(ju,{center:Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Du.a,null),Hi.a.createElement("p",null,e)),bottom:Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("h3",null,n.heading),Hi.a.createElement("p",null,n.message))})}function Lu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Hu(e,t,n[t])}))}return e}function Hu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nu(e,t){switch(t.type){case"object-loading":return Lu({},e,{objectCount:e.objectCount+1,messageKey:"loadingObjects"});case"object-loaded":return Lu({},e,{loadedCount:e.loadedCount+1});case"all-objects-loaded":return Lu({},e,{allObjectsLoaded:!0,loading:!(e.environmentLoaded&&e.networkConnected),messageKey:e.environmentLoaded?"enteringRoom":"loadingObjects"});case"environment-loaded":{const t=e.lazyLoadMedia?e.networkConnected&&e.dialogConnected:e.allObjectsLoaded&&e.networkConnected&&e.dialogConnected;return Lu({},e,{environmentLoaded:!0,loading:!t,messageKey:e.lazyLoadMedia?t?"enteringRoom":"connectingScene":t?"enteringRoom":"loadingObjects"})}case"network-connected":return Lu({},e,{networkConnected:!0,loading:e.lazyLoadMedia?!(e.environmentLoaded&&e.dialogConnected):!(e.environmentLoaded&&e.allObjectsLoaded&&e.dialogConnected)});case"dialog-connected":return Lu({},e,{dialogConnected:!0,loading:e.lazyLoadMedia?!(e.environmentLoaded&&e.networkConnected):!(e.environmentLoaded&&e.allObjectsLoaded&&e.networkConnected)})}}Iu.propTypes={message:Ui.a.node,infoMessages:Ui.a.arrayOf(Ui.a.shape({heading:Ui.a.node.isRequired,message:Ui.a.node.isRequired}))},Iu.defaultProps={infoMessages:[]};const Fu=Object(Jr.b)({default:{id:"loading-screen.default",defaultMessage:"Loading scene..."},loadingObjects:{id:"loading-screen.loading-objects",defaultMessage:"Loading objects {loadedCount}/{objectCount}"},connectingScene:{id:"loading-screen.connecting",defaultMessage:"Connecting to the scene..."},enteringRoom:{id:"loading-screen.entering-room",defaultMessage:"Entering room..."}});function Vu({onLoaded:e,scene:t}){const n=Object(po.a)(),{loading:a,message:i}=function(e){const t=Object(Li.useRef)(),n=APP.store.state.preferences.lazyLoadSceneMedia,[{loading:a,messageKey:i,objectCount:r,loadedCount:o},s]=Object(Li.useReducer)(Nu,{loading:!e.is("loaded"),messageKey:"default",objectCount:0,loadedCount:0,allObjectsLoaded:!1,environmentLoaded:!1,networkConnected:!1,dialogConnected:!1,lazyLoadMedia:n}),l=Object(Li.useCallback)(()=>{clearTimeout(t.current),s({type:"object-loading"})},[s]),c=Object(Li.useCallback)(()=>{clearTimeout(t.current),s({type:"object-loaded"}),t.current=setTimeout(()=>{s({type:"all-objects-loaded"})},1500)},[s]),d=Object(Li.useCallback)(()=>{s({type:"environment-loaded"})},[s]),u=Object(Li.useCallback)(()=>{s({type:"network-connected"})},[s]),h=Object(Li.useCallback)(()=>{s({type:"dialog-connected"})},[s]);Object(Li.useEffect)(()=>(a&&(n||(e.addEventListener("model-loading",l),e.addEventListener("image-loading",l),e.addEventListener("pdf-loading",l),e.addEventListener("video-loading",l),e.addEventListener("model-loaded",c),e.addEventListener("image-loaded",c),e.addEventListener("pdf-loaded",c),e.addEventListener("video-loaded",c),e.addEventListener("model-error",c)),e.addEventListener("environment-scene-loaded",d),e.addEventListener("didConnectToNetworkedScene",u),e.addEventListener("didConnectToDialog",h)),()=>{n||(e.removeEventListener("model-loading",l),e.removeEventListener("image-loading",l),e.removeEventListener("pdf-loading",l),e.removeEventListener("video-loading",l),e.removeEventListener("model-loaded",c),e.removeEventListener("image-loaded",c),e.removeEventListener("pdf-loaded",c),e.removeEventListener("video-loaded",c),e.removeEventListener("model-error",c)),e.removeEventListener("environment-scene-loaded",d),e.removeEventListener("didConnectToNetworkedScene",u),e.removeEventListener("didConnectToDialog",h)}),[e,a,c,l,d,u,h,n]);const p=Object(po.a)().formatMessage(Fu[i],{loadedCount:Math.min(o,r),objectCount:r});return Object(Li.useEffect)(()=>{a||e.addState("loaded")},[e,a]),Object(Li.useEffect)(()=>{},[]),{loading:a,message:p}}(t);Object(Li.useEffect)(()=>{a||e()},[a,e]);const r=Object(Li.useMemo)(()=>[{heading:n.formatMessage({id:"loading-screen.heading.tip",defaultMessage:"Tip:"}),message:n.formatMessage({id:"loading-screen.message.keyboard-controls",defaultMessage:"Press the Q & E keys to turn left and right."})},{heading:n.formatMessage({id:"loading-screen.heading.whats-new",defaultMessage:"What's New?"}),message:n.formatMessage({id:"loading-screen.message.whats-new",defaultMessage:"You can now set the default locale in your preferences. <a>Read More</a>"},{a:e=>Hi.a.createElement("a",{href:"/whats-new",target:"_blank"},e)})}],[n]);return Hi.a.createElement(Iu,{message:i,infoMessages:r})}Vu.propTypes={scene:Ui.a.object.isRequired,onLoaded:Ui.a.func.isRequired};var Bu=n(175),Uu=n.n(Bu),zu=n(292),Wu=n.n(zu);function qu(){return(qu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Gu(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Yu(e){let{className:t,left:n,center:a,right:i}=e,r=Gu(e,["className","left","center","right"]);return Hi.a.createElement("div",qu({className:Wi()(Wu.a.toolbar,t)},r),Hi.a.createElement("div",{className:Wi()(Wu.a.content,Wu.a.leftContent,pr.a.showLg)},n),Hi.a.createElement("div",{className:Wi()(Wu.a.content,Wu.a.centerContent)},a),Hi.a.createElement("div",{className:Wi()(Wu.a.content,Wu.a.rightContent,pr.a.showLg)},i))}function Ku(){return(Ku=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xu(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Qu(e){let{className:t,viewportClassName:n,sidebar:a,sidebarClassName:i,toolbarLeft:r,toolbarCenter:o,toolbarRight:s,toolbarClassName:l,modal:c,viewport:d,objectFocused:u,streaming:h,viewportRef:p}=e,m=Xu(e,["className","viewportClassName","sidebar","sidebarClassName","toolbarLeft","toolbarCenter","toolbarRight","toolbarClassName","modal","viewport","objectFocused","streaming","viewportRef"]);return Hi.a.createElement("div",Ku({className:Wi()(Uu.a.roomLayout,{[Uu.a.objectFocused]:u},t)},m),a&&Hi.a.createElement("div",{className:Wi()(Uu.a.sidebar,i)},a),Hi.a.createElement("div",{className:Wi()(Uu.a.modalContainer,Uu.a.viewport)},c),(r||o||s)&&Hi.a.createElement(Yu,{className:Wi()(Uu.a.main,Uu.a.toolbar,l),left:r,center:o,right:s}),Hi.a.createElement("div",{className:Wi()(Uu.a.main,Uu.a.viewport,{[Uu.a.streaming]:h},n),ref:p},d))}Yu.propTypes={className:Ui.a.string,left:Ui.a.node,center:Ui.a.node,right:Ui.a.node,hideLeft:Ui.a.string,hideRight:Ui.a.string},Qu.propTypes={className:Ui.a.string,viewportClassName:Ui.a.string,sidebar:Ui.a.node,sidebarClassName:Ui.a.string,toolbarLeft:Ui.a.node,toolbarCenter:Ui.a.node,toolbarRight:Ui.a.node,toolbarClassName:Ui.a.string,modal:Ui.a.node,viewport:Ui.a.node,objectFocused:Ui.a.bool,streaming:Ui.a.bool,viewportRef:Ui.a.any};var Ju=n(422);function Zu(){return(Zu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function $u(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function eh(e){let{store:t,scene:n}=e,a=$u(e,["store","scene"]);const i=Object(Li.useRef)();return Object(Ju.a)(i,t,n),Hi.a.createElement(Qu,Zu({viewportRef:i},a))}eh.propTypes={store:Ui.a.object.isRequired,scene:Ui.a.object.isRequired};var th=n(166);function nh(){return(nh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ah(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ih(e){var t=e.title,n=e.titleId,a=ah(e,["title","titleId"]);return Li.createElement("svg",nh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M6.875 6.875V5.312A1.563 1.563 0 018.438 3.75h8.124a1.563 1.563 0 011.563 1.562v9.375a1.562 1.562 0 01-1.563 1.563H8.438a1.562 1.562 0 01-1.562-1.563v-1.562",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10.625 13.125L13.75 10l-3.125-3.125",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M1.875 10h11.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}ih.defaultProps={color:"#000",title:"Enter"};function rh(){return(rh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function oh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function sh(e){var t=e.title,n=e.titleId,a=oh(e,["title","titleId"]);return Li.createElement("svg",rh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.714 4H2.033C1.466 4 1 4.466 1 5.033v9.506c0 .567.466 1.032 1.033 1.032h4.464c.557 0 1.043-.354 1.215-.88l1.063-3.18c.395-1.173 2.045-1.173 2.44 0l1.063 3.18c.172.526.668.88 1.225.88h4.464c.567 0 1.033-.465 1.033-1.032V5.286C19 4.577 18.423 4 17.714 4zM6.477 11.471c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 01-.72.72zm9 0c-1.782.891-3.553-.87-2.663-2.662.152-.314.405-.567.72-.719 1.781-.89 3.553.87 2.662 2.662a1.643 1.643 0 01-.72.72z",fill:a.color}))}sh.defaultProps={color:"#000",title:"Vr"};function lh(){return(lh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ch(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function dh(e){var t=e.title,n=e.titleId,a=ch(e,["title","titleId"]);return Li.createElement("svg",lh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M9.987 4.375c-3.045 0-6.168 1.762-8.626 5.286a.625.625 0 00-.011.695c1.89 2.957 4.97 5.27 8.637 5.27 3.626 0 6.77-2.32 8.663-5.284a.63.63 0 000-.683c-1.896-2.93-5.064-5.284-8.663-5.284z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 13.125a3.125 3.125 0 100-6.25 3.125 3.125 0 000 6.25z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}))}dh.defaultProps={color:"#000",title:"Show"};function uh(){return(uh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function hh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ph(e){var t=e.title,n=e.titleId,a=hh(e,["title","titleId"]);return Li.createElement("svg",uh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.84 9.464L16.823 9.3a.313.313 0 01-.258-.267c-.02-.125-.039-.25-.066-.371a.315.315 0 01.152-.337l.902-.5a.314.314 0 00.152-.388l-.156-.43a.31.31 0 00-.367-.195l-1.012.195a.313.313 0 01-.335-.16 7.177 7.177 0 00-.188-.329.319.319 0 01.028-.372l.675-.779a.313.313 0 00.012-.415l-.293-.351a.308.308 0 00-.41-.06l-.886.533a.312.312 0 01-.367-.035 8.649 8.649 0 00-.289-.243.312.312 0 01-.098-.356l.367-.966a.312.312 0 00-.126-.397l-.399-.23a.312.312 0 00-.406.086l-.65.814a.28.28 0 01-.332.097s-.218-.09-.383-.145a.312.312 0 01-.213-.3l.015-1.034a.315.315 0 00-.257-.329l-.453-.078a.315.315 0 00-.356.22l-.336.978a.312.312 0 01-.304.211h-.383a.315.315 0 01-.304-.211l-.336-.978a.315.315 0 00-.355-.22l-.453.078a.315.315 0 00-.258.33l.016 1.033a.312.312 0 01-.215.3c-.09.036-.285.11-.379.146-.109.039-.238.007-.343-.114l-.645-.795a.313.313 0 00-.406-.084l-.399.23a.31.31 0 00-.129.395l.368.967a.315.315 0 01-.098.355c-.098.079-.195.16-.29.243a.312.312 0 01-.366.035l-.873-.54a.312.312 0 00-.41.059l-.293.351a.313.313 0 00.012.415l.675.78a.312.312 0 01.027.371 3.948 3.948 0 00-.187.329.317.317 0 01-.336.16l-1.011-.195a.312.312 0 00-.367.195l-.156.43a.314.314 0 00.152.387l.9.501a.31.31 0 01.153.337c-.023.125-.047.247-.066.372a.316.316 0 01-.258.266l-1.019.164a.316.316 0 00-.277.31v.457a.307.307 0 00.277.31l1.019.164a.312.312 0 01.258.266c.02.125.039.25.066.372a.315.315 0 01-.152.336l-.902.502a.314.314 0 00-.153.387l.157.43a.31.31 0 00.367.195l1.011-.195a.313.313 0 01.336.16c.058.11.12.22.187.33a.319.319 0 01-.027.371l-.676.78a.313.313 0 00-.011.415l.292.351a.308.308 0 00.41.06l.887-.533a.313.313 0 01.367.035c.093.082.191.164.289.243a.313.313 0 01.097.356l-.367.966a.312.312 0 00.13.396l.398.23a.313.313 0 00.405-.086l.656-.806c.082-.101.215-.144.32-.101.133.054.223.085.387.14a.313.313 0 01.215.302l-.016 1.033a.315.315 0 00.258.329l.453.078a.316.316 0 00.355-.22l.336-.976a.313.313 0 01.304-.211h.383a.315.315 0 01.304.211l.336.977a.316.316 0 00.356.219l.453-.078a.315.315 0 00.257-.33l-.015-1.032a.312.312 0 01.214-.302c.164-.055.274-.098.375-.137.102-.039.227-.039.325.082l.663.818a.312.312 0 00.408.086l.398-.231a.31.31 0 00.13-.396l-.368-.966a.315.315 0 01.098-.357c.097-.078.195-.16.289-.242a.312.312 0 01.367-.035l.883.534a.312.312 0 00.41-.06l.293-.35a.312.312 0 00-.012-.416l-.676-.779a.312.312 0 01-.027-.372c.066-.105.129-.214.188-.328a.318.318 0 01.335-.16l1.012.195a.312.312 0 00.367-.196l.156-.43a.315.315 0 00-.152-.387l-.902-.5a.31.31 0 01-.153-.337c.024-.125.047-.247.067-.372a.315.315 0 01.257-.266l1.02-.164a.316.316 0 00.277-.31v-.458a.323.323 0 00-.284-.302zM10 4.375A5.618 5.618 0 0115.446 8.6a.626.626 0 01-.606.776h-4.111a.625.625 0 01-.544-.316L8.15 5.477a.625.625 0 01.385-.914 5.74 5.74 0 011.467-.188zM4.377 10A5.625 5.625 0 016.08 5.96a.625.625 0 01.983.136l2.04 3.592a.625.625 0 010 .62L7.048 13.89a.625.625 0 01-.983.13A5.624 5.624 0 014.376 10zM10 15.625a5.744 5.744 0 01-1.492-.193.626.626 0 01-.381-.916l2.054-3.576a.625.625 0 01.542-.313h4.117a.625.625 0 01.606.777A5.62 5.62 0 0110 15.625z",fill:a.color}))}ph.defaultProps={color:"#000",title:"Settings"};var mh=n(368),fh=n.n(mh);function gh(){return(gh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function vh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bh(e){let{className:t,roomName:n,showJoinRoom:a,onJoinRoom:i,showEnterOnDevice:r,onEnterOnDevice:o,showSpectate:s,onSpectate:l,showOptions:c,onOptions:d}=e,u=vh(e,["className","roomName","showJoinRoom","onJoinRoom","showEnterOnDevice","onEnterOnDevice","showSpectate","onSpectate","showOptions","onOptions"]);const h=Object(pc.useCssBreakpoints)();return Hi.a.createElement(zr.a,gh({className:Wi()(fh.a.roomEntryModal,t),disableFullscreen:!0},u),Hi.a.createElement(Hr.a,{center:!0,className:fh.a.content},"sm"!==h&&"md"!==h&&Hi.a.createElement("div",{className:fh.a.logoContainer},Hi.a.createElement(Tu.a,null)),Hi.a.createElement("div",{className:fh.a.roomName},Hi.a.createElement("h5",null,Hi.a.createElement(Yi.a,{id:"room-entry-modal.room-name-label",defaultMessage:"Room Name"})),Hi.a.createElement("p",null,n)),Hi.a.createElement(Hr.a,{center:!0,className:fh.a.buttons},a&&Hi.a.createElement(jr.c,{preset:"accent4",onClick:i},Hi.a.createElement(ih,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"room-entry-modal.join-room-button",defaultMessage:"Join Room"}))),r&&Hi.a.createElement(jr.c,{preset:"accent5",onClick:o},Hi.a.createElement(sh,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"room-entry-modal.enter-on-device-button",defaultMessage:"Enter On Device"}))),s&&Hi.a.createElement(jr.c,{preset:"accent2",onClick:l},Hi.a.createElement(dh,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"room-entry-modal.spectate-button",defaultMessage:"Observe"}))),c&&"sm"!==h&&Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("hr",{className:pr.a.showLg}),Hi.a.createElement(jr.c,{preset:"transparent",className:pr.a.showLg,onClick:d},Hi.a.createElement(ph,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"room-entry-modal.options-button",defaultMessage:"Options"})))))))}bh.propTypes={className:Ui.a.string,roomName:Ui.a.string.isRequired,showJoinRoom:Ui.a.bool,onJoinRoom:Ui.a.func,showEnterOnDevice:Ui.a.bool,onEnterOnDevice:Ui.a.func,showSpectate:Ui.a.bool,onSpectate:Ui.a.func,showOptions:Ui.a.bool,onOptions:Ui.a.func},bh.defaultProps={showJoinRoom:!0,showEnterOnDevice:!0,showSpectate:!0,showOptions:!0};var yh=n(481),Eh=n.n(yh);function wh(){return(wh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Sh(e){let{className:t,shortUrl:n,loadingCode:a,code:i,headsetConnected:r,unsupportedBrowser:o,onEnterOnConnectedHeadset:s,onBack:l}=e,c=_h(e,["className","shortUrl","loadingCode","code","headsetConnected","unsupportedBrowser","onEnterOnConnectedHeadset","onBack"]);const d=Object(po.a)();return Hi.a.createElement(zr.a,wh({title:Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.title",defaultMessage:"Enter on Device"}),beforeTitle:Hi.a.createElement(Tr,{onClick:l}),className:t},c),Hi.a.createElement(Hr.a,{center:!a||"both",padding:!0,grow:!0},a?Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.generating-code",defaultMessage:"Generating join code..."})):Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.heading",defaultMessage:"Enter on Wireless Headset / Phone"})),Hi.a.createElement("small",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.short-url-directions",defaultMessage:"In your device's web browser, go to:"})),Hi.a.createElement("div",{className:Eh.a.shortUrlContainer},n),Hi.a.createElement("small",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.code-directions",defaultMessage:"Then, enter this one-time code:"})),Hi.a.createElement("div",{className:Eh.a.codeContainer},i.split("").map((e,t)=>Hi.a.createElement("div",{key:t,className:Eh.a.codeLetter},e))),Hi.a.createElement("strong",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.data-transfer",defaultMessage:"Your account and avatar will be transferred to the device."})),Hi.a.createElement("strong",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.keep-page-open",defaultMessage:"Keep this page open to use this code."})),r&&Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("hr",{"data-or-text":d.formatMessage({id:"enter-on-device-modal.divider-label",defaultMessage:"or"})}),Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.headset-connected-heading",defaultMessage:"Enter on Connected Headset"})),o?Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("small",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.unsupported-browser",defaultMessage:"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox."})),Hi.a.createElement(jr.c,{as:"a",preset:"accent2",href:"https://www.mozilla.org/firefox/",target:"_blank",rel:"noreferrer noopener"},Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.download-firefox-button",defaultMessage:"Download Firefox"})))):Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("small",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.headset-connected-message",defaultMessage:"You have a VR headset connected to this device."})),Hi.a.createElement(jr.c,{preset:"accent5",onClick:s},Hi.a.createElement(sh,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"enter-on-device-modal.enter-in-vr-button",defaultMessage:"Enter in VR"}))))))))}function xh(){return(xh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ah(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}Sh.propTypes={className:Ui.a.string,shortUrl:Ui.a.string.isRequired,loadingCode:Ui.a.bool,code:Ui.a.string,headsetConnected:Ui.a.bool,unsupportedBrowser:Ui.a.bool,onEnterOnConnectedHeadset:Ui.a.func,onBack:Ui.a.func};var Mh=Li.createElement("rect",{x:8,y:8.7,width:4,height:0,fill:"#7ED320"});function kh(e){var t=e.title,n=e.titleId,a=Ah(e,["title","titleId"]);return Li.createElement("svg",xh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.5 17.5h5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Mh,Li.createElement("path",{d:"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 14.376v3.125",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 2.5A2.487 2.487 0 007.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}kh.defaultProps={color:"#000",title:"Microphone"};function Oh(){return(Oh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ch(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Ph=Li.createElement("rect",{x:8,y:8.7,width:4,height:0,fill:"#7ED320"});function Rh(e){var t=e.title,n=e.titleId,a=Ch(e,["title","titleId"]);return Li.createElement("svg",Oh({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.5 17.5h5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Ph,Li.createElement("path",{d:"M15 8.126v1.25c0 2.75-2.25 5-5 5s-5-2.25-5-5v-1.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 14.376v3.125",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 2.5A2.487 2.487 0 007.5 5v4.336c0 1.375 1.133 2.54 2.5 2.54s2.5-1.133 2.5-2.54V5c0-1.406-1.094-2.5-2.5-2.5z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M16.875 15.625L3.75 2.5",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}))}Rh.defaultProps={color:"#000",title:"Microphone Muted"};function Th(){return(Th=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Dh(e){var t=e.title,n=e.titleId,a=jh(e,["title","titleId"]);return Li.createElement("svg",Th({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M9.283 7.498h-2.72a.313.313 0 00-.313.313v4.375a.312.312 0 00.312.312h2.721c.144 0 .284.05.396.142l3.573 2.93a.312.312 0 00.498-.253V4.68a.313.313 0 00-.498-.252L9.68 7.357a.625.625 0 01-.396.141z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Dh.defaultProps={color:"#000",title:"Volume Off"};function Ih(){return(Ih=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Lh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Hh(e){var t=e.title,n=e.titleId,a=Lh(e,["title","titleId"]);return Li.createElement("svg",Ih({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M9.688 2.502a7.188 7.188 0 100 14.376 7.188 7.188 0 000-14.376z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M8.594 8.594h1.25v4.532",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.125 13.281h3.437",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}),Li.createElement("path",{d:"M9.687 5.08a1.016 1.016 0 100 2.03 1.016 1.016 0 000-2.03z",fill:a.color}))}Hh.defaultProps={color:"#000",title:"Info"};var Nh=n(88),Fh=n.n(Nh),Vh=n(293),Bh=n.n(Vh);function Uh(){return(Uh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Wh=Object(Li.memo)(Object(Li.forwardRef)((e,t)=>{let{className:n,label:a,description:i,disabled:r}=e,o=zh(e,["className","label","description","disabled"]);return Hi.a.createElement("label",{className:Wi()(Bh.a.toggleInput,{[Bh.a.disabled]:r},n)},Hi.a.createElement("input",Uh({type:"checkbox",disabled:r,ref:t},o)),Hi.a.createElement("div",{className:Wi()(Bh.a.track)},Hi.a.createElement("div",{className:Bh.a.button})),a&&Hi.a.createElement("div",{className:Bh.a.labelContainer},Hi.a.createElement("p",{className:Bh.a.label},a),i&&Hi.a.createElement("p",{className:Bh.a.description},i)))}));Wh.propTypes={label:Ui.a.node,description:Ui.a.node,checked:Ui.a.bool,disabled:Ui.a.bool,className:Ui.a.string};var qh=n(482),Gh=n.n(qh);function Yh({className:e,level:t}){const n=Object(Li.useCallback)(e=>{if(e){const n=100*t;e.clientWidth>e.clientHeight?e.style.clipPath="polygon(0% 100%, ".concat(n,"% 100%, ").concat(n,"% 0%, 0% 0%)"):e.style.clipPath="polygon(0% 100%, 100% 100%, 100% ".concat(100-n,"%, 0% ").concat(100-n,"%)")}},[t]);return Hi.a.createElement("div",{className:Wi()(Gh.a.levelBarContainer,e)},Hi.a.createElement("div",{className:Gh.a.levelBarBorder}),Hi.a.createElement("div",{ref:n,className:Gh.a.levelBar}))}function Kh(){return(Kh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xh(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Qh(e){let{className:t,microphoneOptions:n,onChangeMicrophone:a,speakerOptions:i,onChangeSpeaker:r,isMicrophoneEnabled:o,micLevel:s,speakerLevel:l,onPlaySound:c,isMicrophoneMuted:d,onChangeMicrophoneMuted:u,onEnterRoom:h,onBack:p,permissionStatus:m}=e,f=Xh(e,["className","microphoneOptions","onChangeMicrophone","speakerOptions","onChangeSpeaker","isMicrophoneEnabled","micLevel","speakerLevel","onPlaySound","isMicrophoneMuted","onChangeMicrophoneMuted","onEnterRoom","onBack","permissionStatus"]);const g=o?Fh.a.iconEnabled:Fh.a.iconDisabled;return Hi.a.createElement(zr.a,Kh({title:Hi.a.createElement(Yi.a,{id:"mic-setup-modal.title",defaultMessage:"Microphone Setup"}),beforeTitle:Hi.a.createElement(Tr,{onClick:p}),className:t},f),Hi.a.createElement(Hr.a,{center:!0,padding:!0,grow:!0,className:Fh.a.content},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"mic-setup-modal.check-mic",defaultMessage:"Check your microphone and audio before entering."})),Hi.a.createElement("div",{className:Fh.a.audioCheckContainer},Hi.a.createElement("div",{className:Fh.a.audioIoContainer},Hi.a.createElement("div",{className:Fh.a.iconContainer},Hi.a.createElement("div",null,m===T.d.PROMPT&&Hi.a.createElement("div",{className:Fh.a.spinnerContainer},Hi.a.createElement(Du.a,null)),m!==T.d.GRANTED||d?Hi.a.createElement(Rh,{className:g}):Hi.a.createElement(kh,{className:g})),m===T.d.GRANTED&&Hi.a.createElement(Yh,{className:Fh.a.levelBar,level:!o||d?0:s})),Hi.a.createElement("div",{className:Fh.a.actionContainer},m===T.d.GRANTED?Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Wh,{label:Hi.a.createElement(Yi.a,{id:"mic-setup-modal.mute-mic-toggle-v2",defaultMessage:"Mute"}),checked:d,onChange:u}),Hi.a.createElement(gc,{title:"Info",content:Hi.a.createElement(Hr.a,{className:Fh.a.popoverContent},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.mute-mic-info",defaultMessage:"You can mute anytime after you enter the room"})),placement:"top",showHeader:!1,disableFullscreen:!0,popoverClass:Fh.a.popover,arrowClass:Fh.a.popoverArrow},({openPopover:e,closePopover:t,triggerRef:n})=>Hi.a.createElement("div",{ref:n},Hi.a.createElement(Hh,{className:Fh.a.infoIcon,onMouseEnter:e,onMouseLeave:t})))):m===T.d.PROMPT&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"mic-setup-modal.mic-permission-prompt",defaultMessage:"Requesting access to your microphone..."}))||m===T.d.DENIED&&Hi.a.createElement("p",null,Hi.a.createElement("span",{className:Fh.a.errorTitle},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.error-title",defaultMessage:"Microphone access was blocked.",className:Fh.a.errorTitle}))," ",Hi.a.createElement(Yi.a,{id:"mic-setup-modal.error-description",defaultMessage:"To talk in Hubs you will need to allow microphone access."}))),m===T.d.GRANTED&&Js.isAudioInputSelectEnabled&&Hi.a.createElement("div",{className:Fh.a.selectionContainer},Hi.a.createElement("p",{style:{alignSelf:"start"}},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.microphone-text",defaultMessage:"Microphone"})),Hi.a.createElement($d,Kh({className:Fh.a.selectionInput,buttonClassName:Fh.a.selectionInput,onChange:a},n)))),Hi.a.createElement("div",{className:Fh.a.audioIoContainer},Hi.a.createElement("div",{className:Fh.a.iconContainer},Hi.a.createElement(Dh,{className:Fh.a.iconEnabled,style:{marginRight:"5px"}}),Hi.a.createElement(Yh,{className:Fh.a.levelBar,level:l})),Hi.a.createElement("div",{className:Fh.a.actionContainer},Hi.a.createElement(jr.c,{preset:"basic",onClick:c,sm:!0},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.test-audio-button",defaultMessage:"Test Audio"}))),m===T.d.GRANTED&&Js.isAudioOutputSelectEnabled&&Hi.a.createElement("div",{className:Fh.a.selectionContainer},Hi.a.createElement("p",{style:{alignSelf:"start"}},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.speakers-text",defaultMessage:"Speakers"})),Hi.a.createElement($d,Kh({onChange:r,className:Fh.a.selectionInput,buttonClassName:Fh.a.selectionInput},i))))),Hi.a.createElement(jr.c,{preset:"primary",onClick:h},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.enter-room-button",defaultMessage:"Enter Room"}))))}function Jh(e){const t=APP.mediaDevicesManager,[n,a]=Object(Li.useState)(!t.isMicEnabled),[i,r]=Object(Li.useState)(APP.mediaDevicesManager.isMicShared),[o,s]=Object(Li.useState)(t.getPermissionsStatus(T.a.MICROPHONE));Object(Li.useEffect)(()=>{const n=({enabled:e})=>{a(!e)};APP.dialog.on("mic-state-changed",n);const i=()=>{r(!0)},o=()=>{r(!1)};e.addEventListener(T.b.MIC_SHARE_ENDED,o),e.addEventListener(T.b.MIC_SHARE_STARTED,i);const l=({mediaDevice:e,status:t})=>{e===T.a.MICROPHONE&&s(t)};return t.on(T.b.PERMISSIONS_STATUS_CHANGED,l),()=>{APP.dialog.off("mic-state-changed",n),e.removeEventListener(T.b.MIC_SHARE_ENDED,o),e.removeEventListener(T.b.MIC_SHARE_STARTED,i),t.off(T.b.PERMISSIONS_STATUS_CHANGED,l)}},[a,r,s,e,t]);return{isMicMuted:n,toggleMute:Object(Li.useCallback)(()=>{t.isMicShared?t.toggleMic():t.startMicShare({unmute:!0})},[t]),isMicEnabled:i,permissionStatus:o}}function Zh(e){const t=APP.mediaDevicesManager,[n,a]=Object(Li.useState)({value:t.selectedMicDeviceId,options:t.micDevicesOptions});Object(Li.useEffect)(()=>{const n=()=>{a({value:t.selectedMicDeviceId,options:t.micDevicesOptions})},i=()=>{a({value:t.selectedMicDeviceId,options:t.micDevicesOptions})};e.addEventListener(T.b.MIC_SHARE_ENDED,i),e.addEventListener(T.b.MIC_SHARE_STARTED,n);const r=({mediaDevice:e})=>{e===T.a.MICROPHONE&&a({value:t.selectedMicDeviceId,options:t.micDevicesOptions})};t.on(T.b.PERMISSIONS_STATUS_CHANGED,r);const o=()=>{a({value:t.selectedMicDeviceId,options:t.micDevicesOptions})};return t.on(T.b.DEVICE_CHANGE,o),a({value:t.selectedMicDeviceId,options:t.micDevicesOptions}),()=>{e.removeEventListener(T.b.MIC_SHARE_ENDED,i),e.removeEventListener(T.b.MIC_SHARE_STARTED,n),t.off(T.b.PERMISSIONS_STATUS_CHANGED,r),t.off(T.b.DEVICE_CHANGE,o)}},[a,e,t]);return{micDeviceChanged:Object(Li.useCallback)(e=>{a({value:t.selectedMicDeviceId,options:t.micDevicesOptions}),t.startMicShare({deviceId:e})},[t]),micDevices:n}}Yh.propTypes={className:Ui.a.string,level:Ui.a.number},Qh.propTypes={className:Ui.a.string,onPlaySound:Ui.a.func,micLevel:Ui.a.number,speakerLevel:Ui.a.number,isMicrophoneEnabled:Ui.a.bool,isMicrophoneMuted:Ui.a.bool,onChangeMicrophoneMuted:Ui.a.func,microphoneOptions:Ui.a.object,onChangeMicrophone:Ui.a.func,speakerOptions:Ui.a.object,onChangeSpeaker:Ui.a.func,onEnterRoom:Ui.a.func,onBack:Ui.a.func,permissionStatus:Ui.a.string},Qh.defaultProps={micLevel:0,speakerLevel:0,permissionStatus:T.d.PROMPT};function $h(e,t){const n=((e,t)=>{e.getByteTimeDomainData(t);let n=0;for(let e=0;e<t.length;e++){const a=(t[e]-128)/128;n+=a*a}return Math.sqrt(n/t.length)})(e,t.levels),a=Math.log(THREE.Math.mapLinear(n,0,1,1,Math.E));t.volume=a<.08?0:a;const i=t.volume>t.prevVolume?.35:.3;t.volume=i*t.volume+(1-i)*t.prevVolume,t.prevVolume=t.volume}function ep({analyser:e,updateRate:t=50}){const n=Object(Li.useRef)(),a=Object(Li.useRef)({levels:[],volume:0,prevVolume:0,max:0}),[i,r]=Object(Li.useState)(0);return Object(Li.useEffect)(()=>{n.current||(n.current=pt()(2*t)),e.fftSize=32,a.current.levels=new Uint8Array(e.fftSize);const i=setInterval(()=>{$h(e,a.current),a.current.max=Math.max(a.current.volume,a.current.max),n.current.push(Date.now(),a.current.volume);const t=n.current.movingAverage(),i=0===a.current.max?0:t/a.current.max;r(e=>Math.max(Math.abs(e-i)>.05?i:e,.1))},t);return()=>{clearInterval(i)}},[e,t]),{volume:i}}function tp({scene:e,updateRate:t=50,sound:n}){const a=e.systems["hubs-systems"].soundEffectsSystem,i=Object(Li.useRef)(e.systems["hubs-systems"].audioSystem.mixerAnalyser),{volume:r}=ep({analyser:i.current,updateRate:t});return{playSound:Object(Li.useCallback)(()=>{a.playSoundOneShot(n).connect(i.current)},[n,a]),soundVolume:r}}function np(){const e=APP.mediaDevicesManager,[t,n]=Object(Li.useState)({value:e.selectedSpeakersDeviceId,options:e.outputDevicesOptions});Object(Li.useEffect)(()=>{const t=({mediaDevice:t})=>{t===T.a.MICROPHONE&&n({value:e.selectedSpeakersDeviceId,options:e.outputDevicesOptions})};e.on(T.b.PERMISSIONS_STATUS_CHANGED,t);const a=()=>{n({value:e.selectedSpeakersDeviceId,options:e.outputDevicesOptions})};return e.on(T.b.DEVICE_CHANGE,a),n({value:e.selectedSpeakersDeviceId,options:e.outputDevicesOptions}),()=>{e.off(T.b.PERMISSIONS_STATUS_CHANGED,t),e.off(T.b.DEVICE_CHANGE,a)}},[n,e]);return{speakerDeviceChanged:Object(Li.useCallback)(t=>{e.changeAudioOutput(t),n({value:e.selectedSpeakersDeviceId,options:e.outputDevicesOptions})},[e]),speakerDevices:t}}function ap(){return(ap=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ip(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function rp(e){let{scene:t}=e,n=ip(e,["scene"]);const{volume:a}=ep({analyser:t.systems["hubs-systems"].audioSystem.outboundAnalyser}),{isMicEnabled:i,permissionStatus:r}=Jh(t),{micDeviceChanged:o,micDevices:s}=Zh(t),{speakerDeviceChanged:l,speakerDevices:c}=np(),{playSound:d,soundVolume:u}=tp({scene:t,sound:Q.r}),[h,p]=Object(Li.useState)(APP.store.state.preferences.muteMicOnEntry),m=Object(Li.useCallback)(({target:{checked:e}})=>{p(e),APP.store.update({preferences:{muteMicOnEntry:e}})},[]);return Hi.a.createElement(Qh,ap({micLevel:a,speakerLevel:u,onPlaySound:d,isMicrophoneEnabled:i,isMicrophoneMuted:h,permissionStatus:r,microphoneOptions:s,speakerOptions:c,onChangeMicrophone:o,onChangeSpeaker:l,onChangeMicrophoneMuted:m},n))}rp.propTypes={scene:Ui.a.object.isRequired};var op=n(797),sp=n.n(op),lp=n(798),cp=n(799),dp=n.n(cp);function up(){return(up=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function hp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const pp=Object(Jr.a)({id:"copyable-text-input-field.copy-label",defaultMessage:"Copy"}),mp=Object(Jr.a)({id:"copyable-text-input-field.copied-label",defaultMessage:"Copied"});function fp(e){let{buttonPreset:t}=e,n=hp(e,["buttonPreset"]);const a=Object(lp.useClipboard)({copiedTimeout:600}),i=Object(po.a)(),r=i.formatMessage(pp),o=i.formatMessage(mp),s=Math.max(r.length,o.length);return Hi.a.createElement(Lr.a,up({ref:a.target,afterInput:a.isSupported()?Hi.a.createElement(jr.c,{preset:t,onClick:a.copy,className:dp.a.copyButton,style:{width:"".concat(s,"ch")}},a.copied?o:r):void 0},n))}function gp(){return(gp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function vp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bp(e){var t=e.title,n=e.titleId,a=vp(e,["title","titleId"]);return Li.createElement("svg",gp({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M16.563 3.751H3.438c-.863 0-1.563.7-1.563 1.562v9.375c0 .863.7 1.563 1.563 1.563h13.124c.863 0 1.563-.7 1.563-1.563V5.313c0-.862-.7-1.562-1.563-1.562z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M4.375 6.251L10 10.626l5.625-4.375",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}fp.propTypes={buttonPreset:Ui.a.string},bp.defaultProps={color:"#000",title:"Invite"};var yp=n(328),Ep=n.n(yp);function wp({fetchingInvite:e,inviteUrl:t,onRevokeInvite:n}){const a=Object(po.a)(),[i,r]=Object(Li.useState)(!1),o=Object(Li.useCallback)(()=>{r(!0)},[]),s=Object(Li.useCallback)(()=>{r(!1)},[]),l=Object(Li.useCallback)(()=>{n(),r(!1)},[n]);return Hi.a.createElement(fp,{label:Hi.a.createElement(Yi.a,{id:"invite-link-input-field.label",defaultMessage:"Invite link"}),disabled:e,value:e?a.formatMessage({id:"invite-link-input-field.generating-invite",defaultMessage:"Generating invite..."}):t,buttonPreset:"primary",description:!e&&(i?Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Yi.a,{id:"invite-link-input-field.revoke-confirm",defaultMessage:"are you sure?"})," ",Hi.a.createElement(Mr.a,{className:Ep.a.confirmRevokeButton,onClick:l},Hi.a.createElement(Yi.a,{id:"invite-link-input-field.revoke-confirm-yes",defaultMessage:"yes"}))," ","/"," ",Hi.a.createElement(Mr.a,{className:Ep.a.confirmRevokeButton,onClick:s},Hi.a.createElement(Yi.a,{id:"invite-link-input-field.revoke-confirm-no",defaultMessage:"no"}))):Hi.a.createElement(Mr.a,{className:Ep.a.confirmRevokeButton,onClick:o},Hi.a.createElement(Yi.a,{id:"invite-link-input-field.revoke",defaultMessage:"revoke"}))),fullWidth:!0})}function _p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sp(){return(Sp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function xp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ap({url:e,embed:t,inviteRequired:n,fetchingInvite:a,inviteUrl:i,revokeInvite:r}){return Hi.a.createElement(Hr.a,{center:!0,padding:!0,grow:!0,gap:"lg",className:sp.a.invitePopover},n?Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(wp,{fetchingInvite:a,inviteUrl:i,onRevokeInvite:r})):Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(fp,{label:Hi.a.createElement(Yi.a,{id:"invite-popover.room-link",defaultMessage:"Room Link"}),value:e,buttonPreset:"accent3"}),Hi.a.createElement(fp,{label:Hi.a.createElement(Yi.a,{id:"invite-popover.embed-code",defaultMessage:"Embed Code"}),value:t,buttonPreset:"accent5"})))}wp.propTypes={fetchingInvite:Ui.a.bool,inviteUrl:Ui.a.string,onRevokeInvite:Ui.a.func.isRequired},Ap.propTypes={url:Ui.a.string.isRequired,embed:Ui.a.string.isRequired,inviteRequired:Ui.a.bool,fetchingInvite:Ui.a.bool,inviteUrl:Ui.a.string,revokeInvite:Ui.a.func};const Mp=Object(Jr.a)({id:"invite-popover.title",defaultMessage:"Invite"});function kp(e){let{url:t,embed:n,initiallyVisible:a,popoverApiRef:i,inviteRequired:r,fetchingInvite:o,inviteUrl:s,revokeInvite:l}=e,c=xp(e,["url","embed","initiallyVisible","popoverApiRef","inviteRequired","fetchingInvite","inviteUrl","revokeInvite"]);const d=Object(po.a)().formatMessage(Mp);return Hi.a.createElement(gc,{title:d,content:()=>Hi.a.createElement(Ap,{url:t,embed:n,inviteRequired:r,fetchingInvite:o,inviteUrl:s,revokeInvite:l}),placement:"top-start",offsetDistance:28,initiallyVisible:a,popoverApiRef:i},({togglePopover:e,popoverVisible:t,triggerRef:n})=>Hi.a.createElement(cc,Sp({ref:n,icon:Hi.a.createElement(bp,null),selected:t,onClick:e,label:d},c)))}function Op(e,t=!1){const[n,a]=Object(Li.useState)();Object(Li.useEffect)(()=>{a(void 0),t||e.fetchInvite().then(({hub_invite_id:e})=>{t||a(e)}).catch(e=>{console.error("Error fetching invite",e)})},[e,t]);const i=Object(Li.useCallback)(()=>{a(void 0),t||e.revokeInvite(n).then(({hub_invite_id:e})=>{t||a(e)}).catch(e=>{console.error("Error revoking invite",e)})},[n,e,t]),r=Object(Li.useMemo)(()=>{if(n&&!t){const e=Object(m.n)();return e.searchParams.set("hub_invite_id",n),e.toString()}},[n,t]);return{fetchingInvite:!n&&!t,inviteUrl:r,revokeInvite:i}}function Cp(){return(Cp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Pp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Rp(e){let{hub:t,hubChannel:n,scene:i}=e,r=Pp(e,["hub","hubChannel","scene"]);const o="https://".concat(a.a.SHORTLINK_DOMAIN),s="".concat(o,"/").concat(t.hub_id),l=Object(m.n)(t.hub_id,{embed_token:t.embed_token}),c='<iframe src="'.concat(l,'" style="width: 1024px; height: 768px;" allow="microphone; camera; vr; speaker;"></iframe>'),d=Object(Li.useRef)();Object(Li.useEffect)(()=>{function e(){Ra(!0,()=>{}).then(()=>{d.current.openPopover()})}return i.addEventListener("action_invite",e),()=>{i.removeEventListener("action_invite",e)}},[i,d]);const u="invite"===t.entry_mode,h=n.can("update_hub"),{fetchingInvite:p,inviteUrl:f,revokeInvite:g}=Op(n,!u||!h);return u&&!h?null:Hi.a.createElement(kp,Cp({inviteRequired:u,fetchingInvite:p,inviteUrl:f,revokeInvite:g,url:s,embed:c,popoverApiRef:d},r))}kp.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){_p(e,t,n[t])}))}return e}({initiallyVisible:Ui.a.bool,popoverApiRef:Ui.a.object},Ap.propTypes),Rp.propTypes={hub:Ui.a.object.isRequired,scene:Ui.a.object.isRequired,hubChannel:Ui.a.object.isRequired};var Tp=n(333),jp=n.n(Tp);function Dp(){return(Dp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ip(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Lp(e){var t=e.title,n=e.titleId,a=Ip(e,["title","titleId"]);return Li.createElement("svg",Dp({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M10 12.25a2 2 0 100-4 2 2 0 000 4z",fill:a.color}),Li.createElement("path",{d:"M10 18.5a2 2 0 100-4 2 2 0 000 4z",fill:a.color}),Li.createElement("path",{d:"M10 6a2 2 0 100-4 2 2 0 000 4z",fill:a.color}))}Lp.defaultProps={color:"#000",title:"More"};function Hp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Np(){return(Np=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Fp({item:e,closePopover:t}){const n=e.icon;return Hi.a.createElement("li",{onClick:t},e.href?Hi.a.createElement("a",{className:jp.a.moreMenuItemTarget,href:e.href,target:e.target||"_blank",rel:"noopener noreferrer"},Hi.a.createElement(n,null),Hi.a.createElement("span",null,e.label)):Hi.a.createElement("button",{className:jp.a.moreMenuItemTarget,onClick:t=>e.onClick(e,t)},Hi.a.createElement(n,null),Hi.a.createElement("span",null,e.label)))}function Vp({group:e,closePopover:t}){return Hi.a.createElement("li",null,Hi.a.createElement("h1",{className:jp.a.moreMenuGroupLabel},e.label),Hi.a.createElement("ul",{className:jp.a.moreMenuItemList},e.items.map(e=>Hi.a.createElement(Fp,{key:e.id,item:e,closePopover:t}))))}function Bp({menu:e,closePopover:t}){return Hi.a.createElement("div",{className:jp.a.moreMenuPopover},Hi.a.createElement("ul",null,e.map(e=>Hi.a.createElement(Vp,{key:e.id,group:e,closePopover:t}))))}Fp.propTypes={item:Ui.a.shape({href:Ui.a.string,target:Ui.a.string,icon:Ui.a.elementType.isRequired,label:Ui.a.node.isRequired,onClick:Ui.a.func}).isRequired,closePopover:Ui.a.func.isRequired},Vp.propTypes={group:Ui.a.object.isRequired,closePopover:Ui.a.func.isRequired},Bp.propTypes={menu:Ui.a.array.isRequired,closePopover:Ui.a.func.isRequired};const Up=Object(Li.createContext)([!1,()=>{}]);function zp({initiallyVisible:e,children:t}){const n=Object(Li.useState)(e||!1);return Hi.a.createElement(Up.Provider,{value:n},t)}zp.propTypes={initiallyVisible:Ui.a.bool,children:Ui.a.node};const Wp=Object(Jr.a)({id:"more-menu-popover.title",defaultMessage:"More"});function qp({menu:e}){const t=Object(po.a)(),[n,a]=Object(Li.useContext)(Up),i=t.formatMessage(Wp);return Hi.a.createElement(gc,{title:i,content:t=>Hi.a.createElement(Bp,Np({menu:e},t)),placement:"top-end",offsetDistance:28,isVisible:n,onChangeVisible:a},({togglePopover:e,popoverVisible:t,triggerRef:n})=>Hi.a.createElement(cc,{ref:n,icon:Hi.a.createElement(Lp,null),selected:t,onClick:e,label:i}))}function Gp(e){let{className:t}=e,n=Hp(e,["className"]);const a=Object(po.a)(),[,i]=Object(Li.useContext)(Up);return Hi.a.createElement("button",Np({className:Wi()(jp.a.compactButton,t),"aria-label":a.formatMessage(Wp),onClick:e=>{e.stopPropagation(),i(!0)}},n),Hi.a.createElement(Lp,null))}function Yp(){return(Yp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Kp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Xp(e,t,n[t])}))}return e}function Xp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qp(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}qp.propTypes={menu:Ui.a.array.isRequired},Gp.propTypes={className:Ui.a.string};const Jp=Object(Li.createContext)({messageGroups:[],sendMessage:()=>{}});let Zp=0;function $p(e,t){switch(t.type){case"join":case"entered":case"leave":case"display_name_changed":case"scene_changed":case"hub_name_changed":case"hub_changed":case"log":return[...e,Kp({id:Zp++,systemMessage:!0,timestamp:Date.now()},t)];case"chat":case"image":case"photo":case"video":return function(e,t){const n=Date.now(),{name:a,sent:i,sessionId:r}=t,o=Qp(t,["name","sent","sessionId"]);if(function(e,t,n){if(0===e.length)return!0;const a=e[e.length-1];return a.senderSessionId!==t.sessionId||n-a.messages[a.messages.length-1].timestamp>6e4}(e,t,n))return[...e,{id:Zp++,timestamp:n,sent:i,sender:a,senderSessionId:r,messages:[Kp({id:Zp++,timestamp:n},o)]}];const s=e.pop();return s.messages=[...s.messages,Kp({id:Zp++,timestamp:n},o)],[...e,Kp({},s)]}(e,t);default:return e}}function em({messageDispatch:e,children:t}){const[n,a]=Object(Li.useState)([]),[i,r]=Object(Li.useState)(!1);Object(Li.useEffect)(()=>{function t(e){const t=e.detail;a(e=>$p(e,t)),"chat"!==t.type&&"image"!==t.type&&"photo"!==t.type&&"video"!==t.type||r(!0)}return e&&e.addEventListener("message",t),()=>{e&&e.removeEventListener("message",t)}},[e,a,r]);const o=Object(Li.useCallback)(t=>{e&&e.dispatch(t)},[e]),s=Object(Li.useCallback)(()=>{r(!1)},[r]);return Hi.a.createElement(Jp.Provider,{value:{messageGroups:n,unreadMessages:i,sendMessage:o,setMessagesRead:s}},t)}function tm({scene:e,canSpawnMessages:t,presences:n,occupantCount:a,inputEffect:i,onClose:r}){const{messageGroups:o,sendMessage:s,setMessagesRead:l}=Object(Li.useContext)(Jp),[c,d,u]=function(e){const t=Object(Li.useRef)(),[n,a]=Object(Li.useState)(!0),i=Object(Li.useCallback)(e=>{const t=e.target;a(t.scrollHeight-t.scrollTop===t.clientHeight)},[a]);return Object(Li.useEffect)(()=>{if(n){const e=t.current;e.scrollTop!==e.scrollHeight&&(e.scrollTop=e.scrollHeight)}},[e,n]),[i,t,n]}(o),[h,p]=Object(Li.useState)(""),f=Object(Li.useRef)(),g=Object(po.a)(),v=Object(Li.useRef)(),b=Object(Li.useCallback)(e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&r():(e.preventDefault(),e.target.value.length<=750&&(s(e.target.value),p(""),e.target.value.startsWith("/")&&r())),clearTimeout(f.current),f.current=setTimeout(()=>window.APP.hubChannel.endTyping(),500),window.APP.hubChannel.beginTyping()},[s,p,r]),y=Object(Li.useCallback)(()=>{s(h.substring(0,750)),p("")},[h,s,p]),E=Object(Li.useCallback)(t=>{for(const n of t.target.files)e.emit("add_media",n)},[e]),w=Object(Li.useCallback)(({emoji:e,pickerRemainedOpen:t})=>{p(t=>t+e.native),t||v.current.select()},[p,v]);Object(Li.useEffect)(()=>i(v.current),[i,v]),Object(Li.useEffect)(()=>{u&&l()},[o,u,l]);const _=Object(m.d)(n),S=_.map(e=>"#"+e).join(", ");let x;x=a<=1?0===_.length?g.formatMessage({id:"chat-sidebar-container.input-placeholder.empty-room",defaultMessage:"Nobody is here yet..."}):g.formatMessage({id:"chat-sidebar-container.input-placeholder.empty-room-bot",defaultMessage:"Send message to {discordChannels}"},{discordChannels:S}):0===_.length?g.formatMessage({id:"chat-sidebar-container.input-placeholder.occupants",defaultMessage:"{occupantCount, plural, one {Send message to one other...} other {Send message to {occupantCount} others...} }"},{discordChannels:S,occupantCount:a-1}):g.formatMessage({id:"chat-sidebar-container.input-placeholder.occupants-and-bot",defaultMessage:"{occupantCount, plural, one {Send message to one other and {discordChannels}...} other {Send message to {occupantCount} others and {discordChannels}...} }"},{discordChannels:S,occupantCount:a-1});const A=AFRAME.utils.device.isMobile(),M=h.length>750;return Hi.a.createElement(ed,{onClose:r},Hi.a.createElement($c,{ref:d,onScroll:c},o.map(e=>{let{id:t,systemMessage:n}=e,a=Qp(e,["id","systemMessage"]);return n?Hi.a.createElement(Qc,Yp({key:t},a)):Hi.a.createElement(Zc,Yp({key:t},a))})),Hi.a.createElement(Wc,{id:"chat-input",ref:v,onKeyDown:b,onChange:e=>p(e.target.value),placeholder:x,value:h,isOverMaxLength:M,warning:Hi.a.createElement(Hi.a.Fragment,null,h.length+50>750&&Hi.a.createElement(zc,{messageLength:h.length,maxLength:750})),afterInput:Hi.a.createElement(Hi.a.Fragment,null,!A&&Hi.a.createElement(Bc,{onSelectEmoji:w}),0===h.length&&t?Hi.a.createElement(Uc,{onChange:E}):Hi.a.createElement(Vc,{onClick:y,disabled:0===h.length||M}),t&&Hi.a.createElement(Fc,{disabled:0===h.length||M,onClick:()=>{dd(h),p("")}}))}))}function nm(e){const{unreadMessages:t}=Object(Li.useContext)(Jp);return Hi.a.createElement(td,Yp({},e,{statusColor:t?"unread":void 0}))}function am(e,t){return Li.Children.toArray(e).reduce((e,n)=>null===e?n:Hi.a.createElement(Hi.a.Fragment,null,e,t(),n),null)}em.propTypes={children:Ui.a.node,messageDispatch:Ui.a.object},tm.propTypes={canSpawnMessages:Ui.a.bool,presences:Ui.a.object.isRequired,occupantCount:Ui.a.number.isRequired,scene:Ui.a.object.isRequired,onClose:Ui.a.func.isRequired,inputEffect:Ui.a.func.isRequired};var im=n(435),rm=n.n(im);function om(){return(om=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function sm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function lm(e){var t=e.title,n=e.titleId,a=sm(e,["title","titleId"]);return Li.createElement("svg",om({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.152 1.791a1.466 1.466 0 011.449 0l3.424 1.948c.163.093.298.226.393.386.094.16.143.341.144.526v3.76c0 .037-.003.075-.007.113.17.028.334.086.485.171l3.423 1.948c.163.093.299.226.393.386.094.16.144.341.144.526v3.76c0 .184-.05.366-.144.526-.094.16-.229.293-.392.386l-3.424 1.948a1.468 1.468 0 01-1.449 0l-3.424-1.948A1.086 1.086 0 0110 16.11a1.083 1.083 0 01-.166.117L6.41 18.175a1.468 1.468 0 01-1.45 0l-3.423-1.948a1.07 1.07 0 01-.393-.386A1.038 1.038 0 011 15.315v-3.76c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L4.96 8.695c.079-.044.161-.082.246-.111a1.033 1.033 0 01-.014-.173V4.65c0-.185.05-.366.144-.526.094-.16.23-.293.393-.386L9.152 1.79zm.364 8.672L6.41 8.695a1.462 1.462 0 00-.477-.17.345.345 0 01-.02-.115V4.837l3.604 2.072v3.554zm4.265-1.859c-.065.026-.13.056-.19.091l-3.354 1.908V6.91l3.604-2.072V8.41a.347.347 0 01-.06.194zm-8.206.613a.73.73 0 00-.252.087L2.097 11.14l3.588 2.063 3.414-1.963-3.37-1.917a1.082 1.082 0 01-.154-.106zm5.204 1.953l3.536 2.033 3.589-2.063-3.227-1.836a.732.732 0 00-.506-.08c-.045.036-.094.07-.146.099l-3.246 1.847zm-.903-8.866a.732.732 0 00-.362.096L6.288 4.235 9.877 6.3l3.588-2.064L10.238 2.4a.732.732 0 00-.362-.096zm-.246 13.01v-3.562l-3.585 2.061v3.754h.002l3.423-1.948a.356.356 0 00.165-.206 1.034 1.034 0 01-.005-.098zm.769.176a.35.35 0 01-.034-.077c.003-.033.005-.066.005-.098v-3.563l3.585 2.061v3.754h-.002l-3.423-1.948a.357.357 0 01-.131-.129zm-5.074-1.677L1.72 11.741v3.574a.346.346 0 00.178.304l3.424 1.947.002.001v-3.754zm9.35 3.754h.002l3.424-1.948a.356.356 0 00.178-.304V11.74l-3.603 2.072v3.754z",fill:a.color}))}lm.defaultProps={color:"#000",title:"Objects"};var cm=n(316);function dm(){return(dm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function um(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function hm(e){let{active:t,children:n}=e,a=um(e,["active","children"]);return Hi.a.createElement("button",dm({className:Wi()(rm.a.contentMenuButton,{[rm.a.active]:t})},a),n)}function pm(e){return Hi.a.createElement(hm,e,Hi.a.createElement(lm,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"content-menu.objects-menu-button",defaultMessage:"Objects"})))}function mm(e){return Hi.a.createElement(hm,e,Hi.a.createElement(cm.a,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"content-menu.people-menu-button",defaultMessage:"People ({presenceCount})",values:{presenceCount:e.presencecount}})))}function fm({children:e}){return Hi.a.createElement("div",{className:rm.a.contentMenu},am(e,()=>Hi.a.createElement("div",{className:rm.a.separator})))}function gm(){return(gm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function vm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bm(e){var t=e.title,n=e.titleId,a=vm(e,["title","titleId"]);return Li.createElement("svg",gm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M13.693 5.807l-1.04-1.643a1.126 1.126 0 00-.856-.414H8.203c-.337 0-.637.159-.856.414l-1.04 1.643c-.22.256-.502.443-.838.443H3.125a1.25 1.25 0 00-1.25 1.25V15a1.25 1.25 0 001.25 1.25h13.75a1.25 1.25 0 001.25-1.25V7.5a1.25 1.25 0 00-1.25-1.25H14.57c-.338 0-.658-.187-.877-.443z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 13.75a3.125 3.125 0 100-6.25 3.125 3.125 0 000 6.25z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M4.844 6.171v-.86h-.938v.86",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}hm.propTypes={children:Ui.a.node,active:Ui.a.bool},mm.propTypes={presencecount:Ui.a.number},fm.propTypes={children:Ui.a.node},bm.defaultProps={color:"#000",title:"Camera"};function ym(){return(ym=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Em(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var wm=Li.createElement("path",{d:"M9.688 3.75a1.563 1.563 0 100-3.126 1.563 1.563 0 000 3.125z"}),_m=Li.createElement("path",{d:"M7.785 11.547l-1.187 6.727a.937.937 0 001.46.93.928.928 0 00.38-.606l.82-4.683v.007s.203-1.27.683-1.27h.121c.489 0 .684 1.27.684 1.27v-.004l.82 4.684a.935.935 0 001.84-.328l-1.187-6.727-.192-1.16c-.113-.707-.164-1.86.02-2.332.156-.406.552-.555.906-.555h3.61a.937.937 0 000-1.875H3.438a.937.937 0 100 1.875H7.05c.36 0 .75.149.906.555.184.473.133 1.625.02 2.332l-.192 1.16z"}),Sm=Li.createElement("defs",null,Li.createElement("clipPath",{id:"Avatar_svg__clip0"},Li.createElement("rect",{width:20,height:20,fill:"#fff"})));function xm(e){var t=e.title,n=e.titleId,a=Em(e,["title","titleId"]);return Li.createElement("svg",ym({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("g",{clipPath:"url(#Avatar_svg__clip0)",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10},wm,_m),Sm)}xm.defaultProps={color:"#000",title:"Avatar"};var Am=n(317);function Mm(){return(Mm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function km(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Om(e){var t=e.title,n=e.titleId,a=km(e,["title","titleId"]);return Li.createElement("svg",Mm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M4.375 4.375l.781 12.5c.037.723.563 1.25 1.25 1.25h7.188c.69 0 1.206-.527 1.25-1.25l.781-12.5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M3.125 4.375h13.75",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}),Li.createElement("path",{d:"M7.5 4.375V2.813a.935.935 0 01.938-.938h3.124a.935.935 0 01.938.938v1.562",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 6.876v8.75",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M7.188 6.876l.312 8.75",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M12.813 6.876l-.313 8.75",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Om.defaultProps={color:"#000",title:"Delete"};function Cm(){return(Cm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Pm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Rm(e){var t=e.title,n=e.titleId,a=Pm(e,["title","titleId"]);return Li.createElement("svg",Cm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.188 5.2h10.78",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M7.188 10.2h10.78",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M7.188 15.2h10.78",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M4.516 6.562a.127.127 0 01-.074-.023l-1.005-.715-1.005.715a.127.127 0 01-.192-.062.12.12 0 010-.077l.393-1.14-1.016-.683a.123.123 0 01-.049-.138.123.123 0 01.045-.062.127.127 0 01.074-.024H2.94l.378-1.143a.123.123 0 01.046-.062.127.127 0 01.192.062l.378 1.143h1.253c.027 0 .053.008.075.024a.123.123 0 01.044.14.123.123 0 01-.048.06l-1.016.684.392 1.14a.12.12 0 01-.061.148.127.127 0 01-.057.013z",fill:a.color}),Li.createElement("path",{d:"M4.516 11.562a.126.126 0 01-.074-.023l-1.005-.715-1.005.715a.126.126 0 01-.192-.062.12.12 0 010-.077l.393-1.14-1.016-.683a.123.123 0 01-.049-.138.123.123 0 01.045-.062.127.127 0 01.074-.024H2.94l.378-1.143a.123.123 0 01.046-.062.127.127 0 01.192.062l.378 1.143h1.253c.027 0 .053.008.075.024a.123.123 0 01.044.14.123.123 0 01-.048.06l-1.016.684.392 1.14a.12.12 0 01-.061.148.127.127 0 01-.057.013z",fill:a.color}),Li.createElement("path",{d:"M4.516 16.562a.126.126 0 01-.074-.023l-1.005-.715-1.005.715a.126.126 0 01-.192-.062.12.12 0 010-.077l.393-1.14-1.016-.683a.12.12 0 01-.004-.2.127.127 0 01.074-.024H2.94l.378-1.143a.126.126 0 01.238 0l.378 1.143h1.253c.027 0 .053.008.075.024a.12.12 0 01-.003.2l-1.017.684.392 1.14a.12.12 0 01-.061.148.127.127 0 01-.057.013z",fill:a.color}))}Rm.defaultProps={color:"#000",title:"Favorites"};function Tm(){return(Tm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Dm(e){var t=e.title,n=e.titleId,a=jm(e,["title","titleId"]);return Li.createElement("svg",Tm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M18.75 8.125h-6.719L10 1.875l-2.031 6.25H1.25l5.469 3.75-2.11 6.25L10 14.219l5.39 3.906-2.109-6.25 5.469-3.75z",stroke:a.color,strokeWidth:1.5,strokeLinejoin:"round"}))}Dm.defaultProps={color:"#000",title:"Star Outline"};function Im(){return(Im=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Lm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Hm(e){var t=e.title,n=e.titleId,a=Lm(e,["title","titleId"]);return Li.createElement("svg",Im({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.5 10c0-4.14-3.36-7.5-7.5-7.5-4.14 0-7.5 3.36-7.5 7.5 0 4.14 3.36 7.5 7.5 7.5 4.14 0 7.5-3.36 7.5-7.5z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M9.776 6.487L10 11.25l.224-4.763a.223.223 0 00-.226-.235v0a.224.224 0 00-.222.235v0z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 14.371a.782.782 0 110-1.563.782.782 0 010 1.563z",fill:a.color}))}Hm.defaultProps={color:"#000",title:"Warning Circle"};function Nm(){return(Nm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Fm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Vm(e){var t=e.title,n=e.titleId,a=Fm(e,["title","titleId"]);return Li.createElement("svg",Nm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M3.125 8.28v9.22a.625.625 0 00.625.625H7.5v-5.313a.937.937 0 01.938-.937h3.124a.938.938 0 01.938.937v5.313h3.75a.625.625 0 00.625-.625V8.28",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M18.75 10l-8.325-7.968c-.195-.206-.652-.209-.85 0L1.25 10",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M15.625 6.992V2.5H13.75v2.695",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Vm.defaultProps={color:"#000",title:"Home"};function Bm(){return(Bm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Um(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function zm(e){var t=e.title,n=e.titleId,a=Um(e,["title","titleId"]);return Li.createElement("svg",Bm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M16.25 8.643v7.608a1.875 1.875 0 01-1.875 1.875h-8.75A1.875 1.875 0 013.75 16.25V3.75a1.875 1.875 0 011.875-1.875h3.857c.332 0 .65.131.884.366l5.518 5.518c.234.234.366.552.366.883z",stroke:a.color,strokeWidth:1.5,strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 2.188v4.688a1.25 1.25 0 001.25 1.25h4.688",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M6.875 11.25h6.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M6.875 14.376h6.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}zm.defaultProps={color:"#000",title:"Text Document"};function Wm(){return(Wm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function qm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Gm(e){var t=e.title,n=e.titleId,a=qm(e,["title","titleId"]);return Li.createElement("svg",Wm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M10 18.125a8.125 8.125 0 100-16.25 8.125 8.125 0 000 16.25z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 13.125a3.125 3.125 0 100-6.25 3.125 3.125 0 000 6.25z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.125 2.11l.313 5.156",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M11.563 7.266l.312-5.157",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.125 17.892l.313-5.157",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M11.563 12.735l.312 5.157",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M17.89 8.125l-5.156.313",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M12.734 11.562l5.157.313",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M2.11 8.125l5.156.313",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M7.266 11.562l-5.157.313",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Gm.defaultProps={color:"#000",title:"Support"};function Ym(){return(Ym=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Km(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Xm(e){var t=e.title,n=e.titleId,a=Km(e,["title","titleId"]);return Li.createElement("svg",Ym({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M18.09 4.39C14.597 3.763 13.153 3.3 10 1.875 6.847 3.3 5.403 3.763 1.91 4.39 1.277 14.42 9.398 17.883 10 18.125c.602-.242 8.723-3.706 8.09-13.735z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Xm.defaultProps={color:"#000",title:"Shield"};function Qm(){return(Qm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Jm(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Zm(e){var t=e.title,n=e.titleId,a=Jm(e,["title","titleId"]);return Li.createElement("svg",Qm({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M8.246 8.55c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 .01-.548-.405-.998-.918-.998zm3.285 0c-.513 0-.918.45-.918 1 0 .549.414.999.918.999.513 0 .918-.45.918-1 0-.548-.405-.998-.918-.998z",fill:a.color}),Li.createElement("path",{d:"M15.905 1H3.845A1.85 1.85 0 002 2.854v12.168a1.85 1.85 0 001.845 1.854h10.206l-.477-1.665 1.152 1.071 1.089 1.008L17.75 19V2.854A1.85 1.85 0 0015.905 1zm-3.474 11.754s-.324-.387-.594-.729c1.179-.333 1.629-1.071 1.629-1.071a5.15 5.15 0 01-1.035.531c-.45.189-.882.315-1.305.387a6.305 6.305 0 01-2.331-.009 7.555 7.555 0 01-1.323-.387 5.274 5.274 0 01-.657-.306c-.027-.018-.054-.027-.081-.045-.018-.009-.027-.018-.036-.027-.162-.09-.252-.153-.252-.153s.432.72 1.575 1.062c-.27.342-.603.747-.603.747-1.989-.063-2.745-1.368-2.745-1.368 0-2.898 1.296-5.247 1.296-5.247 1.296-.972 2.529-.945 2.529-.945l.09.108c-1.62.468-2.367 1.179-2.367 1.179s.198-.108.531-.261c.963-.423 1.728-.54 2.043-.567.054-.009.099-.018.153-.018a7.336 7.336 0 014.527.846s-.711-.675-2.241-1.143l.126-.144s1.233-.027 2.529.945c0 0 1.296 2.349 1.296 5.247 0 0-.765 1.305-2.754 1.368z",fill:a.color}))}Zm.defaultProps={color:"#000",title:"Discord"};function $m(){return($m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ef(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function tf(e){var t=e.title,n=e.titleId,a=ef(e,["title","titleId"]);return Li.createElement("svg",$m({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M13.5 6.875V5.312a1.563 1.563 0 00-1.563-1.562h-7.5a1.562 1.562 0 00-1.562 1.562v9.375a1.562 1.562 0 001.563 1.563h7.5a1.562 1.562 0 001.562-1.563v-1.562",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M16 6.875L19.125 10 16 13.125",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.46 10h10.665",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}tf.defaultProps={color:"#000",title:"Leave"};var nf=n(483),af=n.n(nf);function rf(){return(rf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function of(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function sf(e){var t=e.title,n=e.titleId,a=of(e,["title","titleId"]);return Li.createElement("svg",rf({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.122 3H2.979C2.328 3 1.8 3.528 1.8 4.179v9.428c0 .651.528 1.179 1.179 1.179h14.143c.65 0 1.178-.528 1.178-1.179V4.18C18.3 3.528 17.772 3 17.122 3z",stroke:a.color,strokeLinejoin:"round"}),Li.createElement("path",{d:"M11.818 17.142l-.295-2.357H8.577l-.295 2.357h3.536z",fill:a.color}),Li.createElement("path",{d:"M14.175 17.142h-8.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M1.8 11.839v1.768a1.182 1.182 0 001.179 1.178h14.143a1.182 1.182 0 001.178-1.178v-1.768H1.8zm8.25 2.357a.59.59 0 110-1.18.59.59 0 010 1.18z",fill:a.color}))}sf.defaultProps={color:"#000",title:"Desktop"};function lf(){return(lf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function cf(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var df=Li.createElement("path",{d:"M13.125.625h-6.25C5.839.625 5 1.465 5 2.5v15c0 1.035.84 1.875 1.875 1.875h6.25c1.036 0 1.875-.84 1.875-1.875v-15c0-1.036-.84-1.875-1.875-1.875z"}),uf=Li.createElement("path",{d:"M6.875.625h.938a.312.312 0 01.312.312.625.625 0 00.625.625h2.5a.625.625 0 00.625-.625.312.312 0 01.313-.312h.937"}),hf=Li.createElement("defs",null,Li.createElement("clipPath",{id:"Phone_svg__clip0"},Li.createElement("rect",{width:20,height:20,fill:"#fff"})));function pf(e){var t=e.title,n=e.titleId,a=cf(e,["title","titleId"]);return Li.createElement("svg",lf({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("g",{clipPath:"url(#Phone_svg__clip0)",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"},df,uf),hf)}pf.defaultProps={color:"#000",title:"Phone"};function mf(){return(mf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ff(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function gf(e){var t=e.title,n=e.titleId,a=ff(e,["title","titleId"]);return Li.createElement("svg",mf({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M4.922 7.501H2.188a.312.312 0 00-.313.313v4.375a.313.313 0 00.313.312h2.72a.623.623 0 01.396.138l3.573 2.926a.313.313 0 00.498-.251V4.689a.313.313 0 00-.498-.252L5.304 7.363a.586.586 0 01-.382.138z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M12.5 12.5c.38-.758.625-1.596.625-2.5 0-.918-.234-1.736-.625-2.5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M14.375 14.374c.76-1.325 1.25-2.502 1.25-4.375 0-1.872-.469-3.036-1.25-4.375",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M16.25 16.248c1.172-1.797 1.875-3.571 1.875-6.25 0-2.678-.703-4.414-1.875-6.25",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}gf.defaultProps={color:"#000",title:"Volume High"};function vf(){return(vf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function bf(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function yf(e){var t=e.title,n=e.titleId,a=bf(e,["title","titleId"]);return Li.createElement("svg",vf({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M16.25 16.876L2.5 3.126",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}),Li.createElement("path",{d:"M8.75 5.349v1.32c0 .041.017.08.046.11l.937.938a.156.156 0 00.267-.11V4.71a.958.958 0 00-.495-.849.934.934 0 00-1.024.092L7.234 4.974a.156.156 0 00-.012.232l.666.666a.156.156 0 00.21.01l.652-.533z",fill:a.color}),Li.createElement("path",{d:"M8.75 14.652L5.7 12.155a1.25 1.25 0 00-.792-.28H2.5v-3.75h1.981a.156.156 0 00.11-.267l-.937-.937a.156.156 0 00-.11-.046H2.187a.937.937 0 00-.937.938v4.375a.937.937 0 00.938.937h2.724l3.57 2.922a.934.934 0 001.392-.27.957.957 0 00.126-.486v-1.96a.156.156 0 00-.046-.11l-.937-.937a.157.157 0 00-.24.023.157.157 0 00-.027.087v2.258z",fill:a.color}),Li.createElement("path",{d:"M13.75 10c0-.959-.227-1.87-.693-2.783a.625.625 0 00-1.114.567c.375.734.557 1.46.557 2.217 0 .104-.004.21-.012.317a.312.312 0 00.09.244l.768.769a.156.156 0 00.264-.079c.093-.41.14-.83.14-1.252z",fill:a.color}),Li.createElement("path",{d:"M16.25 10.001c0-2-.511-3.277-1.335-4.69a.625.625 0 00-1.08.63C14.573 7.206 15 8.276 15 10c0 .93-.129 1.675-.366 2.37a.313.313 0 00.074.322l.655.655a.156.156 0 00.255-.05c.4-.958.632-1.972.632-3.297z",fill:a.color}),Li.createElement("path",{d:"M18.75 10c0-2.9-.789-4.73-1.973-6.586a.625.625 0 10-1.055.673C16.79 5.757 17.5 7.403 17.5 10c0 1.854-.348 3.208-.922 4.414a.156.156 0 00.03.178l.697.697a.157.157 0 00.25-.039c.839-1.647 1.195-3.258 1.195-5.25z",fill:a.color}))}yf.defaultProps={color:"#000",title:"Volume Muted"};function Ef(){return(Ef=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function wf(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var _f=Li.createElement("style",{type:"text/css",id:"style869"},".HandRaised_svg__st0{fill:#ffd3b6}"),Sf=Li.createElement("path",{className:"HandRaised_svg__st0",d:"M220.8 196.584",id:"HandRaised_svg__path871"}),xf=Li.createElement("style",{type:"text/css",id:"style1042"},".HandRaised_svg__st0{fill:#ffd3b6}"),Af=Li.createElement("g",{id:"HandRaised_svg__g1059",transform:"matrix(.05125 0 0 .05125 -14.217 -12.843)"},Li.createElement("path",{className:"HandRaised_svg__st0",d:"M288.372 256.007",id:"HandRaised_svg__path1044",strokeWidth:.039}),Li.createElement("path",{d:"M294.69 257.645c-.424-.378-1.361-.899-3.287.953-.358.342-.572.467-.844.762v-9.134c0-.591-.467-1.074-1.062-1.074-.596 0-1.078.483-1.078 1.074v5.419c0 .506-.654.549-.767.132v-6.465c0-.592-.466-1.074-1.062-1.074-.595 0-1.077.478-1.077 1.074v6.485c-.082.397-.665.381-.708-.047v-5.664a1.06 1.06 0 00-1.062-1.07c-.596 0-1.078.478-1.078 1.07v5.575c-.004.007-.004.02-.004.039 0 .486-.626.529-.74.136v-3.992a1.06 1.06 0 00-1.061-1.07c-.595 0-1.078.479-1.078 1.07v9.392a4.768 4.768 0 002.739 4.314v1.525c0 .591.482 1.074 1.074 1.074h4.295c.591 0 1.073-.483 1.073-1.074v-1.081a2.517 2.517 0 001.755-1.031.313.313 0 00.031-.047c.035-.039.078-.109.128-.21.028-.047.051-.093.074-.144.494-1 1.623-3.708 3.646-5.458.416-.417.517-1.082.093-1.46z",id:"HandRaised_svg__path1046",strokeWidth:.039,fill:"#ffd469"}),Li.createElement("path",{d:"M288.726 266.013H285.4l.007-.007h-.871a4.774 4.774 0 01-2.027-.451v1.361c.194.102.38.168.54.168h5.373c.156 0 .339-.051.53-.133v-.949l-.226.012z",id:"HandRaised_svg__path1048",strokeWidth:.039,fill:"#ffb636"}));function Mf(e){var t=e.title,n=e.titleId,a=wf(e,["title","titleId"]);return Li.createElement("svg",Ef({id:"HandRaised_svg__Layer_1",x:0,y:0,viewBox:"0 0 1.025 0.782",xmlSpace:"preserve",width:20,height:20,xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,_f,Sf,xf,Af)}Mf.defaultProps={color:"#000",title:"Hand Raised"};var kf=n(270),Of=n.n(kf);function Cf(){return(Cf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Pf(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Rf=Object(Li.forwardRef)((e,t)=>{let{className:n,children:a}=e,i=Pf(e,["className","children"]);return Hi.a.createElement("ul",Cf({},i,{className:Wi()(Of.a.list,n),ref:t}),a)});function Tf(e){let{className:t,children:n}=e,a=Pf(e,["className","children"]);return Hi.a.createElement("li",{className:Of.a.listItem},Hi.a.createElement("button",Cf({},a,{className:Wi()(Of.a.listItemContent,Of.a.buttonListItem,t)}),n))}function jf(e,t){if(e){if(e.hmd)return t.formatMessage({id:"people-sidebar.device-label.vr",defaultMessage:"VR"});if(e.discord)return t.formatMessage({id:"people-sidebar.device-label.discord",defaultMessage:"Discord Bot"});if(e.mobile)return t.formatMessage({id:"people-sidebar.device-label.mobile",defaultMessage:"Mobile"})}return t.formatMessage({id:"people-sidebar.device-label.desktop",defaultMessage:"Desktop"})}function Df(e,t){if(e){if(e.talking)return t.formatMessage({id:"people-sidebar.voice-label.talking",defaultMessage:"Talking"});if(e.muted)return t.formatMessage({id:"people-sidebar.voice-label.muted",defaultMessage:"Muted"})}return t.formatMessage({id:"people-sidebar.voice-label.not-talking",defaultMessage:"Not Talking"})}function If({people:e,onSelectPerson:t,onClose:n,showMuteAll:a,onMuteAll:i}){const r=Object(po.a)();return Hi.a.createElement(_r,{title:Hi.a.createElement(Yi.a,{id:"people-sidebar.title",defaultMessage:"People ({numPeople})",values:{numPeople:e.length}}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:n}),afterTitle:a?Hi.a.createElement(Mr.a,{onClick:i},Hi.a.createElement(Yi.a,{id:"people-sidebar.mute-all-button",defaultMessage:"Mute All"})):void 0},Hi.a.createElement(Rf,null,e.map(e=>{const n=function(e){if(e){if(e.hmd)return sh;if(e.discord)return Zm;if(e.mobile)return pf}return sf}(e.context),a=function(e){if(e){if(e.muted)return yf;if(e.talking)return gf}return Dh}(e.micPresence);return Hi.a.createElement(Tf,{className:af.a.person,key:e.id,type:"button",onClick:n=>t(e,n)},e.hand_raised&&Hi.a.createElement(Mf,null),Hi.a.createElement(n,{title:jf(e.context,r)}),!e.context.discord&&a&&Hi.a.createElement(a,{title:Df(e.micPresence,r)}),Hi.a.createElement("p",null,function(e,t){const n=t.formatMessage({id:"people-sidebar.person-name.you",defaultMessage:"You"});return e.profile.displayName+(e.isMe?" (".concat(n,")"):"")}(e,r)),e.roles.owner&&Hi.a.createElement(Co.a,{title:r.formatMessage({id:"people-sidebar.moderator-label",defaultMessage:"Moderator"}),className:af.a.moderatorIcon,width:12,height:12}),Hi.a.createElement("p",{className:af.a.presence},function(e,t){switch(e){case"lobby":return t.formatMessage({id:"people-sidebar.presence.in-lobby",defaultMessage:"In Lobby"});case"room":return t.formatMessage({id:"people-sidebar.presence.in-room",defaultMessage:"In Room"});case"entering":return t.formatMessage({id:"people-sidebar.presence.entering",defaultMessage:"Entering Room"});default:return}}(e.presence,r)))})))}function Lf({onClose:e,onConfirm:t,displayName:n}){return Hi.a.createElement(zr.a,{title:"Promote User",beforeTitle:Hi.a.createElement(Sr.a,{onClick:e})},Hi.a.createElement(Hr.a,{center:!0,padding:!0},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"promote-client-modal.message",defaultMessage:"Promoting a user will grant full access to room settings and moderation tools.{linebreak}Are you sure?",values:{linebreak:Hi.a.createElement("br",null)}})),Hi.a.createElement(jr.c,{preset:"accept",onClick:t},Hi.a.createElement(Yi.a,{id:"promote-client-modal.confirm-prefix",defaultMessage:"Yes, promote {name}",values:{name:n}})),Hi.a.createElement(jr.d,{preset:"cancel",onClick:e})))}Rf.propTypes={className:Ui.a.string,children:Ui.a.node},Ui.a.string,Ui.a.node,Tf.propTypes={className:Ui.a.string,children:Ui.a.node},If.propTypes={people:Ui.a.array,onSelectPerson:Ui.a.func,showMuteAll:Ui.a.bool,onMuteAll:Ui.a.func,onClose:Ui.a.func},If.defaultProps={people:[],onSelectPerson:()=>{}},Lf.propTypes={displayName:Ui.a.string.isRequired,onConfirm:Ui.a.func,onClose:Ui.a.func};var Hf=n(484),Nf=n.n(Hf);function Ff(){return(Ff=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vf(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Bf(e){let{className:t,userId:n,displayName:a,identityName:i,avatarPreview:r,hasMicPresence:o,isSignedIn:s,canPromote:l,onPromote:c,canDemote:d,onDemote:u,isHidden:h,onToggleHidden:p,canMute:m,isNetworkMuted:f,onMute:g,canKick:v,onKick:b,showBackButton:y,onBack:E,onClose:w}=e,_=Vf(e,["className","userId","displayName","identityName","avatarPreview","hasMicPresence","isSignedIn","canPromote","onPromote","canDemote","onDemote","isHidden","onToggleHidden","canMute","isNetworkMuted","onMute","canKick","onKick","showBackButton","onBack","onClose"]);const S=Object(po.a)(),[x,A,M,k]=function(e,t){const n=Object(rt.c)(e),a=null==n?void 0:n.el.querySelector("[avatar-volume-controls]"),i=null==a?void 0:a.components["avatar-volume-controls"],[r,o]=Object(Li.useState)(0),[s,l]=Object(Li.useState)(!1),c=Object(Li.useCallback)(({detail:{gainMultiplier:e}})=>{o(e),t&&t(e)},[t]),d=Object(Li.useCallback)(e=>{i&&(o(e),i.updateGainMultiplier(e,!0))},[i]),u=Object(Li.useCallback)(({detail:{muted:e}})=>{l(e)},[]),h=Object(Li.useCallback)(e=>{i&&(l(!!e),i.updateLocalMuted(!!e,!0))},[i]);return Object(Li.useEffect)(()=>{if(!a)return;a.addEventListener("gain_multiplier_updated",c),a.addEventListener("local_muted_updated",u);const e=APP.gainMultipliers.get(i.audioEl);c({detail:{gainMultiplier:e}});const t=APP.mutedState.has(i.audioEl);return l(t),()=>{a.removeEventListener("gain_multiplier_updated",c),a.removeEventListener("local_muted_updated",u)}},[i,a,c,u]),[r,d,s,h]}(n),O=Object(Li.useCallback)(e=>{A(function(e){return Math.min(8,e<=10.5?e*(1/10.5):1+7/10.5*(e-10.5))}(e))},[A]),C=Nn(x);return Hi.a.createElement(_r,Ff({title:i?"".concat(a," (").concat(i,")"):a,beforeTitle:y?Hi.a.createElement(Tr,{onClick:E}):Hi.a.createElement(Sr.a,{onClick:w}),className:t},_),Hi.a.createElement(Hr.a,{center:!0,padding:!0},Hi.a.createElement("div",{className:Nf.a.avatarPreviewContainer},r||Hi.a.createElement("div",null)),o&&Hi.a.createElement("div",{className:Nf.a.sliderContainer},Hi.a.createElement(cc,{icon:f||M?Hi.a.createElement(yf,null):Hi.a.createElement(gf,null),selected:f||M,preset:"accent4",style:{display:"block"},onClick:()=>{k(!M)},disabled:f}),Hi.a.createElement(al,{min:0,max:20,step:1,value:C,onChange:O,className:Nf.a.sliderInputContainer,disabled:f||M})),l&&Hi.a.createElement(jr.c,{preset:"accept",disabled:!s,title:s?S.formatMessage({id:"user-profile-sidebar.promote-button",defaultMessage:"Promote"}):S.formatMessage({id:"user-profile-sidebar.promote-button-disabled-label",defaultMessage:"{displayName} is signed out."},{displayName:a}),onClick:c},Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.promote-button",defaultMessage:"Promote"})),d&&Hi.a.createElement(jr.c,{preset:"cancel",disabled:!s,title:s?S.formatMessage({id:"user-profile-sidebar.demote-button",defaultMessage:"Demote"}):S.formatMessage({id:"user-profile-sidebar.demote-button-disabled-label",defaultMessage:"{displayName} is signed out."},{displayName:a}),onClick:u},Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.demote-button",defaultMessage:"Demote"})),Hi.a.createElement(jr.c,{onClick:p},h?Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.unhide-button",defaultMessage:"Unhide"}):Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.hide-button",defaultMessage:"Hide"})),m&&Hi.a.createElement(jr.c,{preset:"cancel",onClick:g},Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.mute-button",defaultMessage:"Mute"})),v&&Hi.a.createElement(jr.c,{preset:"cancel",onClick:b},Hi.a.createElement(Yi.a,{id:"user-profile-sidebar.kick-button",defaultMessage:"Kick"}))))}function Uf(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function zf(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Uf(r,a,i,o,s,"next",e)}function s(e){Uf(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Wf({user:e,hubChannel:t,performConditionalSignIn:n,showBackButton:a,onBack:i,onClose:r,onCloseDialog:o,showNonHistoriedDialog:s}){var l;const[c,d]=Object(Li.useState)(),{id:u,profile:{displayName:h,identityName:p,avatarId:m},roles:f}=e,g=t.canOrWillIfCreator("kick_users"),v=!!e.micPresence,b=null===(l=e.micPresence)||void 0===l?void 0:l.muted,y=!b&&t.canOrWillIfCreator("mute_users"),[E,w]=Object(Li.useState)(!!f.owner),_=!!f.creator,S=!!f.signed_in,x=t.canOrWillIfCreator("update_roles")&&!E&&!_,A=t.canOrWillIfCreator("update_roles")&&E&&!_,[M,k]=Object(Li.useState)(t.isHidden(e.id));Object(Li.useEffect)(()=>{m&&Object(it.f)(m).then(e=>d(e))},[m,d,e]);const O=Object(Li.useCallback)(()=>{n(()=>t.can("update_roles"),zf((function*(){var e;s(Lf,{displayName:h,onConfirm:(e=zf((function*(){w(!0),yield t.addOwner(u),o()})),function(){return e.apply(this,arguments)})})})),es.b.addOwner)},[n,t,s,u,o,h]),C=Object(Li.useCallback)(()=>{n(()=>t.can("update_roles"),zf((function*(){w(!1),yield t.removeOwner(u)})),es.b.removeOwner)},[n,t,u]),P=Object(Li.useCallback)(()=>{M?t.unhide(u):t.hide(u),k(!M)},[M,u,t]),R=Object(Li.useCallback)(()=>{n(()=>t.can("mute_users"),zf((function*(){return yield t.mute(u)})),es.b.muteUser)},[n,t,u]),T=Object(Li.useCallback)(()=>{n(()=>t.can("kick_users"),zf((function*(){return yield t.kick(u)})),es.b.kickUser),r?r():i&&i()},[n,t,u,r,i]);return Hi.a.createElement(Bf,{userId:e.id,displayName:h,identityName:p,avatarPreview:Hi.a.createElement("img",{src:c}),isSignedIn:S,canPromote:x,onPromote:O,canDemote:A,onDemote:C,isHidden:M,onToggleHidden:P,canMute:y,isNetworkMuted:b,onMute:R,canKick:g,onKick:T,showBackButton:a,onClose:r,onBack:i,hasMicPresence:v})}function qf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gf(e,t,n,a){const i=t.metas[t.metas.length-1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){qf(e,t,n[t])}))}return e}({id:e,isMe:a===e,micPresence:n.get(e)},i)}function Yf({hubChannel:e,people:t,onSelectPerson:n,onClose:a}){const i=Object(Li.useCallback)(()=>{for(const n of t)"room"===n.presence&&n.permissions&&!n.permissions.mute_users&&e.mute(n.id)},[t,e]);return Hi.a.createElement(If,{people:t,onSelectPerson:n,onClose:a,onMuteAll:i,showMuteAll:e.can("mute_users")})}function Kf({hubChannel:e,presences:t,mySessionId:n,displayNameOverride:a,store:i,mediaSearchStore:r,performConditionalSignIn:o,onCloseDialog:s,showNonHistoriedDialog:l,onClose:c}){const d=function(e,t,n=500){const[a,i]=Object(Li.useState)([]);return Object(Li.useEffect)(()=>{let a;return function r(){const o=yr();i(Object.entries(e).map(([e,n])=>Gf(e,n,o,t))),a=setTimeout(r,n)}(),()=>{clearTimeout(a)}},[e,n,i,t]),a}(t,n),[u,h]=Object(Li.useState)(null),p=d.find(e=>e.id===u),m=Object(Li.useCallback)(e=>{h(e.id)},[h]);return p?p.id===n?Hi.a.createElement(Qr,{containerType:"sidebar",displayNameOverride:a,store:i,mediaSearchStore:r,finished:()=>h(null),history:history,showBackButton:!0,onBack:()=>h(null)}):Hi.a.createElement(Wf,{user:p,hubChannel:e,performConditionalSignIn:o,showBackButton:!0,onBack:()=>h(null),onCloseDialog:s,showNonHistoriedDialog:l}):Hi.a.createElement(Yf,{onSelectPerson:m,onClose:c,hubChannel:e,people:d})}Bf.propTypes={className:Ui.a.string,userId:Ui.a.string,displayName:Ui.a.string,identityName:Ui.a.string,avatarPreview:Ui.a.node,hasMicPresence:Ui.a.bool,isSignedIn:Ui.a.bool,canPromote:Ui.a.bool,onPromote:Ui.a.func,canDemote:Ui.a.bool,onDemote:Ui.a.func,isHidden:Ui.a.bool,onToggleHidden:Ui.a.func,canMute:Ui.a.bool,isNetworkMuted:Ui.a.bool,onMute:Ui.a.func,canKick:Ui.a.bool,onKick:Ui.a.func,showBackButton:Ui.a.bool,onBack:Ui.a.func,onClose:Ui.a.func},Wf.propTypes={user:Ui.a.object.isRequired,hubChannel:Ui.a.object,performConditionalSignIn:Ui.a.func,showBackButton:Ui.a.bool,onBack:Ui.a.func,onClose:Ui.a.func,onCloseDialog:Ui.a.func.isRequired,showNonHistoriedDialog:Ui.a.func},Yf.propTypes={onSelectPerson:Ui.a.func.isRequired,hubChannel:Ui.a.object.isRequired,onClose:Ui.a.func.isRequired,people:Ui.a.array.isRequired},Kf.propTypes={displayNameOverride:Ui.a.string,store:Ui.a.object.isRequired,mediaSearchStore:Ui.a.object.isRequired,hubChannel:Ui.a.object.isRequired,history:Ui.a.object.isRequired,onClose:Ui.a.func.isRequired,mySessionId:Ui.a.string.isRequired,presences:Ui.a.object.isRequired,performConditionalSignIn:Ui.a.func.isRequired,onCloseDialog:Ui.a.func.isRequired,showNonHistoriedDialog:Ui.a.func.isRequired};var Xf=n(800),Qf=n(801),Jf=n(802),Zf=n(803),$f=n(804),eg=n(805);function tg(e){return e.components["media-video"]&&e.components["media-video"].data.contentType.startsWith("audio/")?1:e.components["media-video"]?0:e.components["media-image"]?2:e.components["media-pdf"]?3:e.components["gltf-model-plus"]?4:5}function ng(e,t){return tg(e)-tg(t)}new Map([[0,Xf.faVideo],[1,Qf.faMusic],[2,Jf.faImage],[3,Zf.faNewspaper],[5,$f.faQuestion],[4,eg.faCube]]);const ag={0:"video",1:"audio",2:"image",3:"pdf",4:"model"};function ig(e){const t=tg(e);return ag[t]}function rg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function og(e){const t=e.components["media-loader"]&&e.components["media-loader"].data.src||"",n=t.split("/"),a=n[n.length-1].split("?")[0];let i=-1;for(let e=0;e<n.length;e++)-1!==n[e].indexOf("http")&&(i=e);let r="",o="";if(-1!==i&&n.length>i+3){r=n[i+2];const e=r.split(".");e.length>1&&(o="".concat(e[e.length-2],".").concat(e[e.length-1]))}const s=-1!==t.indexOf("sketchfab.com")?"Sketchfab":-1!==t.indexOf("youtube.com")?"YouTube":o;return"".concat(s," ... ").concat(a.substr(0,4))}const sg=Object(Li.createContext)({objects:[],focusedObject:null,selectedObject:null,focusObject:()=>{},unfocusObject:()=>{},inspectObject:()=>{},uninspectObject:()=>{}});function lg(e,t,n){const a=e.systems["hubs-systems"].cameraSystem;n(t),t.el.object3D!==a.inspectable&&(a.inspectable&&a.uninspect(!1),a.inspect(t.el,1.5,!1))}function cg(e,t,n){const a=e.systems["hubs-systems"].cameraSystem;n(null),a.uninspect(!1),t&&a.inspect(t.el,1.5,!1)}function dg({scene:e,children:t}){const[n,a]=Object(Li.useState)([]),[i,r]=Object(Li.useState)(null),[o,s]=Object(Li.useState)(null),l=e.systems["hubs-systems"].cameraSystem,[c,d]=Object(Li.useState)(l.lightsEnabled);Object(Li.useEffect)(()=>{function t(){const t=e.systems["listed-media"].els.sort(ng).map(e=>({id:e.object3D.id,name:og(e),type:ig(e),el:e}));a(t)}let n;return e.addEventListener("listed_media_changed",(function(){n=setTimeout(()=>t(),0)})),t(),()=>{e.removeEventListener("listed_media_changed",t),clearTimeout(n)}},[e,a]),Object(Li.useEffect)(()=>{function t(){const t=e.systems["hubs-systems"].cameraSystem,a=t.inspectable&&t.inspectable.el;if(a){const e=n.find(e=>e.el===a);s(e||{id:a.object3D.id,name:og(a),type:ig(a),el:a})}else s(null)}return e.addEventListener("inspect-target-changed",t),()=>{e.removeEventListener("inspect-target-changed",t)}},[e,s,n]),Object(Li.useEffect)(()=>{function t(){const t=e.systems["hubs-systems"].cameraSystem;d(t.lightsEnabled)}return e.addEventListener("inspect-lights-changed",t),()=>{e.removeEventListener("inspect-lights-changed",t)}},[e]);const u=Object(Li.useCallback)(t=>lg(e,t,s),[e,s]),h=Object(Li.useCallback)(()=>cg(e,i,s),[e,s,i]),p=Object(Li.useCallback)(t=>lg(e,t,r),[e,r]),m=Object(Li.useCallback)(()=>cg(e,o,r),[e,r,o]),f=Object(Li.useCallback)(()=>{const e=n.indexOf(o);if(-1!==e){const t=(e+1)%n.length;u(n[t])}},[u,n,o]),g=Object(Li.useCallback)(()=>{const e=n.indexOf(o);if(-1!==e){const t=0===e?n.length-1:e-1;u(n[t])}},[u,n,o]),v=Object(Li.useCallback)(()=>{e.systems["hubs-systems"].cameraSystem.toggleLights()},[e]),b={objects:n,activeObject:i||o,focusedObject:i,selectedObject:o,focusObject:p,unfocusObject:m,selectObject:u,deselectObject:h,selectPrevObject:g,selectNextObject:f,toggleLights:v,lightsEnabled:c};return Hi.a.createElement(sg.Provider,{value:b},Li.Children.map(t,e=>Object(Li.cloneElement)(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){rg(e,t,n[t])}))}return e}({},b))))}function ug(){return Object(Li.useContext)(sg)}dg.propTypes={scene:Ui.a.object.isRequired,children:Ui.a.node};var hg=n(613),pg=n.n(hg);function mg(){return(mg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function gg(e){var t=e.title,n=e.titleId,a=fg(e,["title","titleId"]);return Li.createElement("svg",mg({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.5 13.336v-6.67a1.25 1.25 0 00-.62-1.079l-5.938-3.455a1.873 1.873 0 00-1.885 0L3.121 5.587A1.25 1.25 0 002.5 6.666v6.67a1.25 1.25 0 00.62 1.08l5.938 3.455a1.875 1.875 0 001.885 0l5.937-3.456a1.249 1.249 0 00.62-1.079z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M2.695 6.016L10 10.313l7.305-4.297",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 18.125v-7.812",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}gg.defaultProps={color:"#000",title:"Object"};function vg(){return(vg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function bg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function yg(e){var t=e.title,n=e.titleId,a=bg(e,["title","titleId"]);return Li.createElement("svg",vg({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M16.25 3.125H3.75c-1.035 0-1.875.84-1.875 1.875v10c0 1.036.84 1.875 1.875 1.875h12.5c1.036 0 1.875-.839 1.875-1.874V5c0-1.036-.84-1.876-1.875-1.876z",stroke:a.color,strokeWidth:1.5,strokeLinejoin:"round"}),Li.createElement("path",{d:"M13.125 8.125a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M11.875 13.116L8.334 9.581a1.25 1.25 0 00-1.714-.05l-4.745 4.218",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.75 16.875l4.818-4.818a1.25 1.25 0 011.684-.078l2.873 2.396",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}yg.defaultProps={color:"#000",title:"Image"};function Eg(){return(Eg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function wg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _g(e){var t=e.title,n=e.titleId,a=wg(e,["title","titleId"]);return Li.createElement("svg",Eg({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M14.64 12.061l3.231 2.275a.625.625 0 00.879-.572v-7.53a.625.625 0 00-.879-.57l-3.23 2.274a.625.625 0 00-.266.51v3.102a.624.624 0 00.265.511z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10.469 14.998H3.28a2.037 2.037 0 01-2.031-2.03V7.03a2.037 2.037 0 012.031-2.031h7.207A2.019 2.019 0 0112.5 7.01v5.956a2.037 2.037 0 01-2.031 2.031z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}))}_g.defaultProps={color:"#000",title:"Video"};function Sg(){return(Sg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function xg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ag(e){var t=e.title,n=e.titleId,a=xg(e,["title","titleId"]);return Li.createElement("svg",Sg({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M7.5 8.516V8.28c0-.58.39-1.054.947-1.195l6.82-1.823a.782.782 0 01.983.753v.86",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M16.25 11.559v3.125c0 .543-.349 1-.86 1.171l-.859.313c-1.011.34-2.031-.407-2.031-1.484a1.304 1.304 0 01.898-1.25l1.993-.71c.51-.171.859-.622.859-1.165zm0 0V2.264a.392.392 0 00-.492-.375l-7.79 2.094a.644.644 0 00-.468.625v8.828c0 .543-.349 1-.86 1.172l-2.03.703c-.543.183-.86.672-.86 1.25 0 1.077 1.036 1.818 2.031 1.484l.86-.312c.51-.172.859-.628.859-1.172v-3.125",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Ag.defaultProps={color:"#000",title:"Audio"};function Mg(){return(Mg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function kg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Og=Object(Jr.b)({video:{id:"objects-sidebar.object-type.video",defaultMessage:"Video"},audio:{id:"objects-sidebar.object-type.audio",defaultMessage:"Audio"},image:{id:"objects-sidebar.object-type.image",defaultMessage:"Image"},pdf:{id:"objects-sidebar.object-type.pdf",defaultMessage:"PDF"},model:{id:"objects-sidebar.object-type.model",defaultMessage:"Model"},default:{id:"objects-sidebar.object-type.default",defaultMessage:"Object"}});function Cg(e){let{selected:t,object:n}=e,a=kg(e,["selected","object"]);const i=Object(po.a)(),r=function(e){switch(e){case"video":return _g;case"audio":return Ag;case"image":return yg;case"pdf":return zm;case"model":default:return gg}}(n.type);return Hi.a.createElement(Tf,Mg({},a,{className:Wi()(pg.a.object,{[Of.a.selected]:t}),type:"button","aria-label":i.formatMessage({id:"objects-sidebar.object-label",defaultMessage:"{objectType}: {objectName}"},{objectType:i.formatMessage(Og[n.type]||Og.default),objectName:n.name})}),Hi.a.createElement(r,null),Hi.a.createElement("p",null,n.name))}function Pg({canAddObjects:e}){return Hi.a.createElement("li",{className:pg.a.noObjects},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"objects-sidebar.no-objects",defaultMessage:"There are no objects in the room."})),e&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"objects-sidebar.place-menu-tip",defaultMessage:"Use the place menu to add objects."})))}function Rg({children:e,objectCount:t,onClose:n}){return Hi.a.createElement(_r,{title:Hi.a.createElement(Yi.a,{id:"objects-sidebar.title",defaultMessage:"Objects ({objectCount})",values:{objectCount:t}}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:n})},Hi.a.createElement("ul",null,e))}function Tg({onClose:e,hubChannel:t}){const n=Object(Li.useRef)(),{objects:a,selectedObject:i,selectObject:r,unfocusObject:o,focusObject:s}=ug(),l=Object(Li.useCallback)(e=>{e.relatedTarget!==n.current&&n.current.contains(e.relatedTarget)||o()},[o,n]);return Hi.a.createElement(Rg,{objectCount:a.length,onClose:e},a.length>0?Hi.a.createElement(Rf,{ref:n},a.map(e=>Hi.a.createElement(Cg,{selected:i===e,object:e,key:e.id,onClick:()=>r(e),onMouseOver:()=>s(e),onFocus:()=>s(e),onMouseOut:l,onBlur:l}))):Hi.a.createElement(Pg,{canAddObjects:t.can("spawn_and_move_media")}))}Cg.propTypes={selected:Ui.a.bool,object:Ui.a.shape({id:Ui.a.any.isRequired,name:Ui.a.string.isRequired,type:Ui.a.string})},Pg.propTypes={canAddObjects:Ui.a.bool},Rg.propTypes={objectCount:Ui.a.number.isRequired,children:Ui.a.node,onClose:Ui.a.func},Rg.defaultProps={objectCount:0},Tg.propTypes={hubChannel:Ui.a.object.isRequired,onClose:Ui.a.func};var jg=n(219),Dg=n.n(jg);function Ig(){return(Ig=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Lg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Hg(e){var t=e.title,n=e.titleId,a=Lg(e,["title","titleId"]);return Li.createElement("svg",Ig({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M11.25 18.125h-2.5a.625.625 0 100 1.25h2.5a.625.625 0 000-1.25z",fill:a.color}),Li.createElement("path",{d:"M11.875 16.25h-3.75a.625.625 0 000 1.25h3.75a.625.625 0 100-1.25z",fill:a.color}),Li.createElement("path",{d:"M14.43 2.449A6.214 6.214 0 0010 .625a6.235 6.235 0 00-6.25 6.25c0 1.821.698 3.525 1.914 4.674l.17.16c.704.657 1.666 1.558 1.666 2.354V15a.625.625 0 00.625.625h.938a.313.313 0 00.312-.312v-4.578a.313.313 0 00-.2-.291 5.104 5.104 0 01-1.022-.561.625.625 0 11.726-1.016c.289.205.845.508 1.121.508s.832-.304 1.122-.508a.625.625 0 01.725 1.016 5.102 5.102 0 01-1.022.56.313.313 0 00-.2.291v4.579a.313.313 0 00.313.312h.937A.625.625 0 0012.5 15v-.937c0-.777.952-1.677 1.646-2.335l.192-.182c1.251-1.194 1.912-2.811 1.912-4.67a6.216 6.216 0 00-1.82-4.427z",fill:a.color}))}Hg.defaultProps={color:"#000",title:"Lightbulb"};function Ng(){return(Ng=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Fg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Vg(e){var t=e.title,n=e.titleId,a=Fg(e,["title","titleId"]);return Li.createElement("svg",Ng({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M11.875 15v-.937c0-1.133 1.232-2.204 2.031-2.969 1.127-1.077 1.719-2.523 1.719-4.218A5.595 5.595 0 0010 1.25a5.61 5.61 0 00-5.625 5.625c0 1.634.618 3.179 1.719 4.218.795.75 2.031 1.825 2.031 2.97V15",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.75 18.75h2.5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M8.125 16.875h3.75",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 15v-5",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M11.484 9.375S10.644 10 10 10s-1.484-.625-1.484-.625",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Vg.defaultProps={color:"#000",title:"Lightbulb Outline"};function Bg(){return(Bg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ug(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function zg(e){let{children:t,className:n}=e,a=Ug(e,["children","className"]);return Hi.a.createElement(Mr.a,Bg({compactSm:!0,className:Wi()(Dg.a.objectMenuButton,n)},a),t)}function Wg({children:e,title:t,onClose:n,onBack:a,onPrevObject:i,onNextObject:r,currentObjectIndex:o,objectCount:s,onToggleLights:l,lightsEnabled:c}){return Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Mr.a,{className:Dg.a.backButton,onClick:a},Hi.a.createElement(Cr,{width:24,height:24})),Hi.a.createElement(Mr.a,{className:Dg.a.lightsButton,onClick:l},c?Hi.a.createElement(Vg,{title:"Turn Lights Off",width:24,height:24}):Hi.a.createElement(Hg,{title:"Turn Lights On",width:24,height:24})),Hi.a.createElement("div",{className:Dg.a.objectMenuContainer},Hi.a.createElement("div",{className:Dg.a.objectMenu},Hi.a.createElement("div",{className:Dg.a.header},Hi.a.createElement(Mr.a,{className:Dg.a.closeButton,onClick:n},Hi.a.createElement(Po.a,{width:16,height:16})),Hi.a.createElement("h5",null,t),Hi.a.createElement(Mr.a,{className:Dg.a.lightsHeaderButton,onClick:l},c?Hi.a.createElement(Vg,{title:"Turn Lights Off",width:16,height:16}):Hi.a.createElement(Hg,{title:"Turn Lights On",width:16,height:16}))),Hi.a.createElement("div",{className:Dg.a.menu},am(e,()=>Hi.a.createElement("div",{className:Dg.a.separator})))),Hi.a.createElement("div",{className:Dg.a.pagination},Hi.a.createElement(Mr.a,{onClick:i},Hi.a.createElement(Lo,{width:24,height:24})),Hi.a.createElement("p",null,o+1,"/",s),Hi.a.createElement(Mr.a,{onClick:r},Hi.a.createElement(jo,{width:24,height:24})))))}function qg(e){return!(!e.components.pinnable||!e.components.pinnable.data.pinned)}function Gg(e){return!(!e.components.tags||!e.components.tags.data.isStatic)}function Yg(e){return!!e.el.components["networked-avatar"]}function Kg(){return(Kg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Qg(e){var t=e.title,n=e.titleId,a=Xg(e,["title","titleId"]);return Li.createElement("svg",Kg({width:22,height:22,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.463 12.668a.751.751 0 01-.07.08l-5.08 5.081a.75.75 0 11-1.061-1.06l5.08-5.081a.758.758 0 01.081-.07l-.386-.386-2.536-2.537a1.12 1.12 0 01-.331-.8c0-.266.092-.542.285-.753a4.598 4.598 0 013.593-1.516h.193a2.74 2.74 0 002.739-2.739v-.67c0-.304.119-.589.33-.8a1.143 1.143 0 011.608 0l5.68 5.68c.211.21.33.495.33.799 0 .625-.514 1.14-1.13 1.14h-.67a2.74 2.74 0 00-2.74 2.738V11.986a4.995 4.995 0 01-1.47 3.528 1.143 1.143 0 01-1.608 0l-2.536-2.546-.3-.3zm-.486-5.544l.03.002h.224a4.24 4.24 0 004.233-4.032L18.91 7.54a4.24 4.24 0 00-4.031 4.234V11.986c0 .798-.28 1.574-.787 2.197l-2.266-2.273-.001-.002-1.737-1.737-2.276-2.275a3.098 3.098 0 012.165-.772z",fill:a.color}))}zg.propTypes={className:Ui.a.string,children:Ui.a.node},Wg.propTypes={currentObjectIndex:Ui.a.number.isRequired,objectCount:Ui.a.number.isRequired,onPrevObject:Ui.a.func,onNextObject:Ui.a.func,children:Ui.a.node,title:Ui.a.node,onClose:Ui.a.func,onBack:Ui.a.func,onToggleLights:Ui.a.func,lightsEnabled:Ui.a.bool},Qg.defaultProps={color:"#000",title:"Pin"};function Jg(){return(Jg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Zg(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function $g(e){var t=e.title,n=e.titleId,a=Zg(e,["title","titleId"]);return Li.createElement("svg",Jg({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M12.274 18.84l-2.218-4.482-1.753-2.242a2.844 2.844 0 01-.396-1.447V5.624h.612a1.57 1.57 0 011.572 1.571v7.163",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M4.996 11.446v-2.91s1.456-2.912 2.911-2.912",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M14.457 10.719l-2.582-1.696",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M6.661 18.684l2.09-3.06",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10.09 4.169a1.455 1.455 0 100-2.911 1.455 1.455 0 000 2.91z",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}$g.defaultProps={color:"#000",title:"Go To"};function ev(){return(ev=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function tv(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function nv(e){var t=e.title,n=e.titleId,a=tv(e,["title","titleId"]);return Li.createElement("svg",ev({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M16.875 17.5a.623.623 0 01-.442-.183L2.683 3.567a.625.625 0 01.884-.883l13.75 13.75a.624.624 0 01-.442 1.066z",fill:a.color}),Li.createElement("path",{d:"M9.987 15c-1.62 0-3.184-.48-4.646-1.426-1.33-.859-2.528-2.09-3.464-3.554v-.003c.779-1.116 1.632-2.06 2.548-2.821a.078.078 0 00.006-.115l-.779-.777a.078.078 0 00-.105-.005C2.573 7.12 1.67 8.126.848 9.304a1.247 1.247 0 00-.025 1.388c1.032 1.615 2.36 2.975 3.84 3.932 1.665 1.08 3.458 1.626 5.324 1.626a9.34 9.34 0 002.96-.491.079.079 0 00.05-.096.079.079 0 00-.02-.034l-.842-.842a.156.156 0 00-.15-.04A8 8 0 019.987 15z",fill:a.color}),Li.createElement("path",{d:"M19.173 9.32C18.14 7.722 16.8 6.364 15.296 5.393c-1.663-1.075-3.5-1.643-5.31-1.643a8.88 8.88 0 00-2.925.5.078.078 0 00-.03.13l.843.842a.156.156 0 00.151.039A7.532 7.532 0 019.987 5c1.59 0 3.147.485 4.63 1.445 1.356.875 2.569 2.105 3.507 3.555a.005.005 0 010 .006 12.136 12.136 0 01-2.505 2.84.078.078 0 00-.023.089c.004.01.01.02.017.027l.777.777a.078.078 0 00.106.005 13.42 13.42 0 002.681-3.066 1.258 1.258 0 00-.004-1.358z",fill:a.color}),Li.createElement("path",{d:"M10 6.25c-.281 0-.561.03-.835.093a.078.078 0 00-.039.132l4.398 4.397a.078.078 0 00.132-.039A3.75 3.75 0 0010 6.249z",fill:a.color}),Li.createElement("path",{d:"M6.476 9.128a.078.078 0 00-.132.039 3.75 3.75 0 004.492 4.492.077.077 0 00.059-.054.078.078 0 00-.02-.078l-4.4-4.4z",fill:a.color}))}nv.defaultProps={color:"#000",title:"Hide"};function av({onOpenProfile:e}){return Hi.a.createElement(zg,{onClick:e},Hi.a.createElement(xm,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"object-menu.edit-avatar-button",defaultMessage:"Edit Avatar"})))}function iv({hubChannel:e,activeObject:t,deselectObject:n}){const a=function(e,t){return Object(Li.useCallback)(()=>{if(t.components.networked){const n=t.components.networked.data.owner;n&&n!==NAF.clientId&&e.hide(n)}},[e,t])}(e,t.el);return Hi.a.createElement(zg,{onClick:()=>{n(),a()}},Hi.a.createElement(nv,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"object-menu.hide-avatar-button",defaultMessage:"Hide"})))}function rv({hubChannel:e,scene:t,activeObject:n,deselectObject:a,onGoToObject:i}){const{canPin:r,isPinned:o,togglePinned:s}=function(e,t,n){const[a,i]=Object(Li.useState)(qg(n.el)),r=Object(Li.useCallback)(()=>{const e=n.el;(NAF.utils.isMine(e)||NAF.utils.takeOwnership(e))&&window.APP.pinningHelper.setPinned(e,!0)},[n]),o=Object(Li.useCallback)(()=>{const e=n.el;(NAF.utils.isMine(e)||NAF.utils.takeOwnership(e))&&window.APP.pinningHelper.setPinned(e,!1)},[n]),s=Object(Li.useCallback)(()=>{a?o():r()},[a,r,o]);Object(Li.useEffect)(()=>{const e=n.el;function t(){i(qg(e))}return e.addEventListener("pinned",t),e.addEventListener("unpinned",t),i(qg(e)),()=>{e.removeEventListener("pinned",t),e.removeEventListener("unpinned",t)}},[n]);const l=n.el;let c=!1;if(l.components["media-loader"]){const{fileIsOwned:e,fileId:t}=l.components["media-loader"].data;c=e||t&&Object(te.k)(t)}return{canPin:!(!t.is("entered")||Yg(n)||Gg(l)||!e.can("pin_objects")||!c),isPinned:a,togglePinned:s,pinObject:r,unpinObject:o}}(e,t,n),{canRemoveObject:l,removeObject:c}=function(e,t,n){const a=Object(Li.useCallback)(()=>{$n(t,n.el)},[t,n]),i=n.el;return{removeObject:a,canRemoveObject:!(!t.is("entered")||Yg(n)||qg(i)||Gg(i)||!e.can("spawn_and_move_media"))}}(e,t,n),{canGoTo:d,goToSelectedObject:u}=function(e,t){const n=Object(Li.useCallback)(()=>{const t=document.getElementById("viewing-camera"),n=new THREE.Matrix4,a=new THREE.Matrix4;t.object3DMap.camera.updateMatrices(),n.copy(t.object3DMap.camera.matrixWorld),Object(lt.a)(n,n),a.makeTranslation(0,-1.6,.15),n.multiply(a),Object(lt.m)(n,Math.PI,n),e.systems["hubs-systems"].characterController.enqueueWaypointTravelTo(n,!0,{willDisableMotion:!1,willDisableTeleporting:!1,snapToNavMesh:!1,willMaintainInitialOrientation:!1})},[e]),a=Object(Li.useMemo)(()=>document.getElementById("ui-root"),[]);return{canGoTo:!(a&&a.firstChild&&a.firstChild.classList.contains("isGhost"))&&!Yg(t),goToSelectedObject:n}}(t,n),h=function(e){const t=e.el.components["media-loader"],n=t&&(t.data.mediaOptions&&t.data.mediaOptions.href||t.data.src);return n&&!n.startsWith("hubs://")?n:null}(n);return Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(zg,{disabled:!r,onClick:s},Hi.a.createElement(Qg,null),Hi.a.createElement("span",null,o?Hi.a.createElement(Yi.a,{id:"object-menu.unpin-object-button",defaultMessage:"Unpin"}):Hi.a.createElement(Yi.a,{id:"object-menu.pin-object-button",defaultMessage:"Pin"}))),h&&Hi.a.createElement(zg,{as:"a",href:h,target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement(Zo,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"object-menu.object-link-button",defaultMessage:"Link"}))),Hi.a.createElement(zg,{disabled:!d,onClick:()=>{u(),a(),i()}},Hi.a.createElement($g,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"object-menu.view-object-button",defaultMessage:"View"}))),Hi.a.createElement(zg,{disabled:!l,onClick:()=>{c(),a()}},Hi.a.createElement(Om,null),Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"object-menu.delete-object-button",defaultMessage:"Delete"}))))}function ov({hubChannel:e,scene:t,onOpenProfile:n,onGoToObject:a}){const{objects:i,activeObject:r,deselectObject:o,selectNextObject:s,selectPrevObject:l,toggleLights:c,lightsEnabled:d}=ug();let u;return u="avatar-rig"===r.el.id?Hi.a.createElement(av,{onOpenProfile:n}):Yg(r)?Hi.a.createElement(iv,{hubChannel:e,activeObject:r,deselectObject:o}):Hi.a.createElement(rv,{hubChannel:e,scene:t,activeObject:r,deselectObject:o,onGoToObject:a}),Hi.a.createElement(Wg,{title:Hi.a.createElement(Yi.a,{id:"object-menu.title",defaultMessage:"Object"}),currentObjectIndex:i.indexOf(r),objectCount:i.length,onClose:o,onBack:o,onNextObject:s,onPrevObject:l,onToggleLights:c,lightsEnabled:d},u)}av.propTypes={onOpenProfile:Ui.a.func.isRequired},iv.propTypes={hubChannel:Ui.a.object.isRequired,activeObject:Ui.a.object.isRequired,deselectObject:Ui.a.func.isRequired},rv.propTypes={hubChannel:Ui.a.object.isRequired,scene:Ui.a.object.isRequired,activeObject:Ui.a.object.isRequired,deselectObject:Ui.a.func.isRequired,onGoToObject:Ui.a.func.isRequired},ov.propTypes={hubChannel:Ui.a.object.isRequired,scene:Ui.a.object.isRequired,onOpenProfile:Ui.a.func.isRequired,onGoToObject:Ui.a.func.isRequired};var sv=n(215);function lv(){return(lv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function cv(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function dv(e){var t=e.title,n=e.titleId,a=cv(e,["title","titleId"]);return Li.createElement("svg",lv({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.25 15.375a1.125 1.125 0 01-1.125-1.125v-9c0-.621.504-1.125 1.125-1.125h13.5c.621 0 1.125.504 1.125 1.125v9c0 .621-.504 1.125-1.125 1.125H3.25zM1 14.25a2.25 2.25 0 002.25 2.25h13.5A2.25 2.25 0 0019 14.25v-9A2.25 2.25 0 0016.75 3H3.25A2.25 2.25 0 001 5.25v9zm7.958-2.558c-.204.244-.492.434-.865.57-.373.133-.786.2-1.239.2-.476 0-.894-.103-1.254-.31a2.105 2.105 0 01-.83-.906c-.194-.395-.294-.86-.299-1.393v-.374c0-.55.092-1.024.276-1.424.186-.403.453-.71.8-.922.35-.214.76-.32 1.228-.32.652 0 1.162.156 1.53.468.367.31.585.761.653 1.356H7.855c-.05-.315-.162-.546-.336-.692-.171-.146-.408-.219-.71-.219-.385 0-.679.145-.88.435-.201.29-.303.72-.306 1.291v.352c0 .576.11 1.012.329 1.306.219.295.54.442.963.442.425 0 .729-.09.91-.272v-.948H6.794v-.834h2.164v2.194zm2.126.695H9.951V6.888h1.133v5.499zm2.187-2.247h2.175v-.914H13.27v-1.42h2.447v-.918h-3.58v5.499h1.133V10.14z",fill:a.color}))}dv.defaultProps={color:"#000",title:"Gif"};function uv(){return(uv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function hv(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function pv(e){var t=e.title,n=e.titleId,a=hv(e,["title","titleId"]);return Li.createElement("svg",uv({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M10 1.874a8.125 8.125 0 100 16.25 8.125 8.125 0 000-16.25z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M10 1.874C7.73 1.874 5.599 5.512 5.599 10s2.132 8.125 4.4 8.125c2.27 0 4.402-3.638 4.402-8.125S12.268 1.874 10 1.874z",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M4.583 4.583C6.077 5.643 7.958 6.276 10 6.276c2.043 0 3.923-.633 5.417-1.693",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M15.417 15.417c-1.494-1.06-3.374-1.693-5.417-1.693-2.042 0-3.923.633-5.417 1.693",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10 1.874v16.25",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}),Li.createElement("path",{d:"M18.125 9.999H1.875",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10}))}pv.defaultProps={color:"#000",title:"Scene"};var mv=n(614),fv=n.n(mv);function gv({fullscreen:e,items:t,closePopover:n}){return Hi.a.createElement("div",{className:Wi()(fv.a.buttonGridPopover,{[fv.a.fullscreen]:e})},t.map(e=>{const t=e.icon;return Hi.a.createElement(cc,{key:e.id,icon:Hi.a.createElement(t,null),preset:e.color,onClick:()=>{e.onSelect&&e.onSelect(e),n()},label:e.label,selected:e.selected})}))}function vv(){return(vv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}gv.propTypes={fullscreen:Ui.a.bool,items:Ui.a.arrayOf(Ui.a.shape({id:Ui.a.string.isRequired,icon:Ui.a.elementType.isRequired,color:Ui.a.string,label:Ui.a.element.isRequired,onSelect:Ui.a.func})).isRequired,closePopover:Ui.a.func.isRequired};const bv=Object(Jr.a)({id:"place-popover.title",defaultMessage:"Place"});function yv({items:e}){const t=Object(po.a)(),n=e.filter(e=>!!e);if(0===n.length)return null;const a=t.formatMessage(bv);return Hi.a.createElement(gc,{title:a,content:e=>Hi.a.createElement(gv,vv({items:n},e)),placement:"top",offsetDistance:28},({togglePopover:e,popoverVisible:t,triggerRef:n})=>Hi.a.createElement(cc,{ref:n,icon:Hi.a.createElement(gg,null),selected:t,onClick:e,label:a,preset:"accent3"}))}function Ev({scene:e,mediaSearchStore:t,showNonHistoriedDialog:n,hubChannel:i}){const[r,o]=Object(Li.useState)([]);return Object(Li.useEffect)(()=>{function r(){const r=!!e.systems["camera-tools"].getMyCamera(),s=!!e.systems["pen-tools"].getMyPen();let l=[i.can("spawn_drawing")&&{id:"pen",icon:sv.a,color:"accent5",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.pen",defaultMessage:"Pen"}),onSelect:()=>e.emit("penButtonPressed"),selected:s},i.can("spawn_camera")&&{id:"camera",icon:bm,color:"accent5",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.camera",defaultMessage:"Camera"}),onSelect:()=>e.emit("action_toggle_camera"),selected:r}];i.can("spawn_and_move_media")&&(l=[...l,a.a.integration("tenor")&&{id:"gif",icon:dv,color:"accent2",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.gif",defaultMessage:"GIF"}),onSelect:()=>t.sourceNavigate("gifs")},a.a.integration("sketchfab")&&{id:"model",icon:gg,color:"accent2",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.model",defaultMessage:"3D Model"}),onSelect:()=>t.sourceNavigate("sketchfab")},{id:"avatar",icon:xm,color:"accent1",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.avatar",defaultMessage:"Avatar"}),onSelect:()=>t.sourceNavigate("avatars")},{id:"scene",icon:pv,color:"accent1",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.scene",defaultMessage:"Scene"}),onSelect:()=>t.sourceNavigate("scenes")},{id:"upload",icon:Xo,color:"accent3",label:Hi.a.createElement(Yi.a,{id:"place-popover.item-type.upload",defaultMessage:"Upload"}),onSelect:()=>n(Ao,{scene:e})}]),o(l)}function s(e){"camera"!==e.detail&&"pen"!==e.detail||r()}return i.addEventListener("permissions_updated",r),r(),e.addEventListener("stateadded",s),e.addEventListener("stateremoved",s),()=>{i.removeEventListener("permissions_updated",r),e.removeEventListener("stateadded",s),e.removeEventListener("stateremoved",s)}},[i,t,n,e]),Hi.a.createElement(yv,{items:r})}function wv(){return(wv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _v(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Sv(e){var t=e.title,n=e.titleId,a=_v(e,["title","titleId"]);return Li.createElement("svg",wv({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M17.545 4H2.555C1.863 4 1.3 4.562 1.3 5.255v8.114c0 .694.562 1.256 1.256 1.256h14.989c.693 0 1.255-.562 1.255-1.255V5.255C18.8 4.562 18.238 4 17.545 4z",stroke:a.color,strokeWidth:1.5,strokeLinejoin:"round"}),Li.createElement("path",{d:"M5.05 16.502h10",stroke:a.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}),Li.createElement("path",{d:"M12.697 9.325L10.123 6.75 7.55 9.325",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),Li.createElement("path",{d:"M10.123 11.415V6.752",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}yv.propTypes={items:Ui.a.array.isRequired},Ev.propTypes={hubChannel:Ui.a.object.isRequired,scene:Ui.a.object.isRequired,mediaSearchStore:Ui.a.object.isRequired,showNonHistoriedDialog:Ui.a.func.isRequired},Sv.defaultProps={color:"#000",title:"Share"};function xv(){return(xv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}const Av=Object(Jr.a)({id:"share-popover.title",defaultMessage:"Share"});function Mv({items:e}){const t=Object(po.a)().formatMessage(Av),n=e.filter(e=>!!e);if(0===n.length)return null;const a=n.find(e=>e.active);if(1===n.length||a){const e=n[0],i=e.icon;return Hi.a.createElement(cc,{icon:Hi.a.createElement(i,null),onClick:()=>{e.onSelect&&e.onSelect(e)},label:t,preset:"accent5",statusColor:a&&"recording"})}return Hi.a.createElement(gc,{title:t,content:e=>Hi.a.createElement(gv,xv({items:n},e)),placement:"top",offsetDistance:28,disableFullscreen:!0},({togglePopover:e,popoverVisible:n,triggerRef:a})=>Hi.a.createElement(cc,{ref:a,icon:Hi.a.createElement(Sv,null),selected:n,onClick:e,label:t,preset:"accent5"}))}function kv(e,t){const n=APP.mediaDevicesManager,[a,i]=Object(Li.useState)(null),[r,o]=Object(Li.useState)(!1),[s,l]=Object(Li.useState)(!1),[c,d]=Object(Li.useState)(!1),{hasVideoTextureTarget:u}=function(){const[e,t]=Object(Li.useState)({hasVideoTextureTarget:!1});return Object(Li.useEffect)(()=>{const e=document.querySelector("#avatar-rig .model");function n(){const n=!!e.querySelector("[video-texture-target]");t({hasVideoTextureTarget:n})}return n(),e.addEventListener("model-loaded",n),()=>{e.removeEventListener("model-loaded",n)}},[]),e}();Object(Li.useEffect)(()=>{function a(e){i(e.detail.source)}function r(){i(null)}function s(){t.can("spawn_and_move_media")?(navigator.mediaDevices.enumerateDevices().then(e=>{const t=e.some(e=>"videoinput"===e.kind);o(t),d(t&&u)}).catch(()=>{o(!1),d(!1)}),l(!!navigator.mediaDevices.getDisplayMedia)):(l(!1),o(!1),d(!1))}return e.addEventListener("share_video_enabled",a),e.addEventListener("share_video_disabled",r),e.addEventListener("share_video_failed",r),t.addEventListener("permissions_updated",s),s(),i(n.isVideoShared?n.isWebcamShared?T.a.CAMERA:T.a.SCREEN:null),()=>{e.removeEventListener("share_video_enabled",a),e.removeEventListener("share_video_disabled",r),e.removeEventListener("share_video_failed",r),t.removeEventListener("permissions_updated",s)}},[e,t,u,n]);const h=Object(Li.useCallback)(()=>{a?e.emit(T.b.VIDEO_SHARE_ENDED):e.emit("action_share_camera")},[e,a]),p=Object(Li.useCallback)(()=>{a?e.emit(T.b.V):e.emit("action_share_screen")},[e,a]),m=Object(Li.useCallback)(()=>{a?e.emit(T.b.VIDEO_SHARE_ENDED):e.emit("action_share_camera",{target:"avatar"})},[e,a]);return{sharingSource:a,canShareCamera:r,canShareCameraToAvatar:c,canShareScreen:s,toggleShareCamera:h,toggleShareCameraToAvatar:m,toggleShareScreen:p}}function Ov({scene:e,hubChannel:t}){const{sharingSource:n,canShareCamera:a,toggleShareCamera:i,canShareScreen:r,toggleShareScreen:o,canShareCameraToAvatar:s,toggleShareCameraToAvatar:l}=kv(e,t),c=[a&&{id:"camera",icon:_g,color:"accent5",label:Hi.a.createElement(Yi.a,{id:"share-popover.source.camera",defaultMessage:"Camera"}),onSelect:i,active:n===T.a.CAMERA},r&&{id:"screen",icon:sf,color:"accent5",label:Hi.a.createElement(Yi.a,{id:"share-popover.source.screen",defaultMessage:"Screen"}),onSelect:o,active:n===T.a.SCREEN},s&&{id:"camera-to-avatar",icon:xm,color:"accent5",label:Hi.a.createElement(Yi.a,{id:"share-popover.source.avatar-camera",defaultMessage:"Avatar Camera"}),onSelect:l,active:"camera-to-avatar"===n}];return Hi.a.createElement(Mv,{items:c})}Mv.propTypes={items:Ui.a.array.isRequired},Ov.propTypes={hubChannel:Ui.a.object.isRequired,scene:Ui.a.object.isRequired};var Cv=n(191),Pv=n.n(Cv),Rv=n(369),Tv=n.n(Rv);const jv=({children:e,padding:t,gap:n,spaceBetween:a,breakpointColumn:i,topMargin:r,flexClassName:o,flexBasis:s,noWrap:l=!1,childrenMarginR:c,className:d})=>{const u=!0===t?pr.a.lgPadding:pr.a["".concat(t,"Padding")],h=!0===n?pr.a.mdGap:pr.a["".concat(n,"Gap")],p=!0===i?"":Tv.a["".concat(i,"BreakpointColumn")],m=r?pr.a["".concat(r,"WrapMargin")]:"",f=s?pr.a["flexBasis".concat(s)]:"",g=c?Tv.a["".concat(c,"ChildrenMarginR")]:"";return Hi.a.createElement("div",{className:Wi()(u,h,d)},Hi.a.createElement("div",{className:Wi()(Tv.a.flexRow,p,m,g,{[Tv.a.spaceBetween]:a,[Tv.a.noFlexWrap]:l},o,f)},e))};jv.propTypes={children:Ui.a.node,padding:Ui.a.oneOfType([Ui.a.string,Ui.a.bool]),gap:Ui.a.oneOfType([Ui.a.string,Ui.a.bool]),topMargin:Ui.a.oneOfType([Ui.a.string,Ui.a.bool]),breakpointColumn:Ui.a.oneOfType([Ui.a.string,Ui.a.bool]),childrenMarginR:Ui.a.string,spaceBetween:Ui.a.bool,className:Ui.a.string,flexClassName:Ui.a.string,flexBasis:Ui.a.oneOf([10,20,30,40,50,60,70,80,90]),noWrap:Ui.a.bool};var Dv=n(806),Iv=n.n(Dv);const Lv=({margin:e=!1})=>{const t=!1===e?"":pr.a["".concat(e,"MarginY")];return Hi.a.createElement("div",{className:Wi()(Iv.a.divider,t)})};function Hv(){return(Hv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}Lv.propTypes={margin:Ui.a.oneOf(["xs","sm","md","lg","xl"])};const Nv=({micLevel:e,microphoneOptions:t,onChangeMicrophone:n,isMicrophoneEnabled:a,isMicrophoneMuted:i,onChangeMicrophoneMuted:r,speakerOptions:o,onChangeSpeaker:s,speakerLevel:l,onPlaySound:c})=>{const d=a?Pv.a.iconEnabled:Pv.a.iconDisabled;return Hi.a.createElement(Hr.a,{padding:!0,grow:!0,gap:"lg",className:Pv.a.audioToolbarPopover},Hi.a.createElement("p",{style:{alignSelf:"start"}},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.microphone-text",defaultMessage:"Microphone"})),Js.isAudioInputSelectEnabled&&Hi.a.createElement($d,Hv({className:Pv.a.selectionInput,buttonClassName:Pv.a.selectionInput,onChange:n},t)),Hi.a.createElement(jv,{noWrap:!0},a&&!i?Hi.a.createElement(kh,{className:d,style:{marginRight:"12px"}}):Hi.a.createElement(Rh,{className:d,style:{marginRight:"12px"}}),Hi.a.createElement(Yh,{className:Pv.a.levelBar,level:!a||i?0:e})),Hi.a.createElement(jv,{nowrap:!0},Hi.a.createElement(Wh,{label:Hi.a.createElement(Yi.a,{id:"mic-setup-modal.mute-mic-toggle-v2",defaultMessage:"Mute"}),checked:i,onChange:r})),Hi.a.createElement(Lv,null),Hi.a.createElement("p",{style:{alignSelf:"start"}},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.speakers-text",defaultMessage:"Speakers"})),Js.isAudioOutputSelectEnabled&&Hi.a.createElement($d,Hv({className:Pv.a.selectionInput,buttonClassName:Pv.a.selectionInput,onChange:s},o)),Hi.a.createElement(jv,{noWrap:!0},Hi.a.createElement(Dh,{className:d,style:{marginRight:"12px"}}),Hi.a.createElement(Yh,{className:Pv.a.levelBar,level:l})),Hi.a.createElement(jr.c,{preset:"basic",onClick:c,sm:!0},Hi.a.createElement(Yi.a,{id:"mic-setup-modal.test-audio-button",defaultMessage:"Test Audio"})))};Nv.propTypes={isSoundPlaying:Ui.a.bool,onPlaySound:Ui.a.func,micLevel:Ui.a.number,speakerLevel:Ui.a.number,isMicrophoneEnabled:Ui.a.bool,isMicrophoneMuted:Ui.a.bool,onChangeMicrophoneMuted:Ui.a.func,microphoneOptions:Ui.a.object,onChangeMicrophone:Ui.a.func,speakerOptions:Ui.a.object,onChangeSpeaker:Ui.a.func};const Fv=({scene:e})=>{const{isMicMuted:t,toggleMute:n,isMicEnabled:a}=Jh(e),{micDeviceChanged:i,micDevices:r}=Zh(e),{volume:o}=ep({analyser:e.systems["hubs-systems"].audioSystem.outboundAnalyser}),{speakerDeviceChanged:s,speakerDevices:l}=np(),{playSound:c,soundVolume:d}=tp({scene:e,sound:Q.r});return Hi.a.createElement(Nv,{micLevel:o,microphoneOptions:r,onChangeMicrophone:i,isMicrophoneEnabled:a,isMicrophoneMuted:t,onChangeMicrophoneMuted:n,speakerOptions:l,onChangeSpeaker:s,speakerLevel:d,onPlaySound:c})};function Vv(){return(Vv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Bv(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Uv(e){var t=e.title,n=e.titleId,a=Bv(e,["title","titleId"]);return Li.createElement("svg",Vv({width:16,height:10,viewBox:"0 0 16 10",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},a),t?Li.createElement("title",{id:n},t):null,Li.createElement("path",{d:"M1.25 8.375L8 1.625l6.75 6.75",stroke:a.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}Fv.propTypes={scene:Ui.a.object.isRequired},Uv.defaultProps={color:"#000",title:"Arrow"};const zv=Object(Jr.a)({id:"audio-toolbar-popover.title",defaultMessage:"Audio Settings"}),Wv=({initiallyVisible:e,content:t,isMicrophoneMuted:n,isMicrophoneEnabled:a,micLevel:i,onChangeMicrophoneMuted:r})=>{const o=Object(po.a)().formatMessage(zv),s=Object(Li.useRef)(),l=Object(Li.useCallback)(e=>{if(null!==e){const t=e.querySelector("rect");i<=.1?t.setAttribute("height",0):i<.3?(t.setAttribute("y",8),t.setAttribute("height",4)):(t.setAttribute("y",4),t.setAttribute("height",8))}},[i]);return Hi.a.createElement(gc,{title:o,content:t,placement:"top-start",offsetDistance:28,initiallyVisible:e,popoverApiRef:s},({togglePopover:e,popoverVisible:t,triggerRef:i})=>Hi.a.createElement("div",{className:Pv.a.buttonsContainer},Hi.a.createElement(cc,{ref:i,icon:Hi.a.createElement(Uv,null),preset:"basic",selected:t,onClick:e,type:"left",className:t?Pv.a.arrowButton:Pv.a.arrowButtonSelected,title:"Audio Settings"}),Hi.a.createElement(cc,{ref:l,icon:n||!a?Hi.a.createElement(Rh,null):Hi.a.createElement(kh,null),label:Hi.a.createElement(Yi.a,{id:"voice-button-container.label",defaultMessage:"Voice"}),preset:"basic",onClick:r,statusColor:n||!a?"disabled":"enabled",type:"right"})))};Wv.propTypes={initiallyVisible:Ui.a.bool,isMicrophoneMuted:Ui.a.bool,isMicrophoneEnabled:Ui.a.bool,micLevel:Ui.a.number,onChangeMicrophoneMuted:Ui.a.func,content:Ui.a.element};const qv=({scene:e,initiallyVisible:t,content:n})=>{const{isMicMuted:a,toggleMute:i,isMicEnabled:r}=Jh(e),{volume:o}=ep({analyser:e.systems["hubs-systems"].audioSystem.outboundAnalyser});return Hi.a.createElement(Wv,{initiallyVisible:t,content:n,isMicrophoneMuted:a,isMicrophoneEnabled:r,micLevel:o,onChangeMicrophoneMuted:i})};qv.propTypes={scene:Ui.a.object.isRequired,initiallyVisible:Ui.a.bool,content:Ui.a.element};const Gv=({scene:e})=>Hi.a.createElement(qv,{scene:e,content:Hi.a.createElement(Fv,{scene:e})});Gv.propTypes={scene:Ui.a.object.isRequired};var Yv=n(615),Kv=n.n(Yv);function Xv({fullscreen:e,items:t,closePopover:n}){return Hi.a.createElement("div",{className:Wi()(Kv.a.imageGridPopover,{[Kv.a.fullscreen]:e})},t.map(e=>Hi.a.createElement("img",{key:e.id,crossOrigin:"anonymous",src:e.src,alt:e.label,onClick:()=>{e.onSelect&&e.onSelect(e),n()}})))}Xv.propTypes={fullscreen:Ui.a.bool,items:Ui.a.arrayOf(Ui.a.shape({id:Ui.a.string.isRequired,src:Ui.a.string.isRequired,label:Ui.a.string.isRequired,onSelect:Ui.a.func})).isRequired,closePopover:Ui.a.func.isRequired};var Qv=n(616),Jv=n.n(Qv);function Zv(){return(Zv=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function $v(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function eb(e){let{active:t,children:n}=e,a=$v(e,["active","children"]);return Hi.a.createElement("button",Zv({className:Wi()(Jv.a.reactionButton,{[Jv.a.active]:t})},a),n)}function tb(e){let{active:t}=e,n=$v(e,["active"]);return Hi.a.createElement(eb,Zv({active:t},n),Hi.a.createElement(Mf,{width:"42px",height:"42px"}),Hi.a.createElement("p",null,t?Hi.a.createElement(Yi.a,{id:"reaction-popover.lower-hand",defaultMessage:"Lower Hand"}):Hi.a.createElement(Yi.a,{id:"reaction-popover.raise-hand",defaultMessage:"Raise Hand"})))}eb.propTypes={children:Ui.a.node,active:Ui.a.bool},tb.propTypes={active:Ui.a.bool};var nb=n(617),ab=n.n(nb);function ib(){return(ib=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function rb(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const ob=Object(Jr.a)({id:"reaction-popover.title",defaultMessage:"React"});function sb(e){let{items:t,presence:n,onToggleHandRaised:a}=e,i=rb(e,["items","presence","onToggleHandRaised"]);return Hi.a.createElement(Hr.a,{padding:"sm",grow:!0,gap:"sm"},Hi.a.createElement(jv,{noWrap:!0},Hi.a.createElement(Xv,ib({items:t},i))),Hi.a.createElement(jv,null,Hi.a.createElement("label",{className:ab.a.label},Hi.a.createElement(Yi.a,{id:"reaction-popover.action",defaultMessage:"Actions"}))),Hi.a.createElement(jv,{nowrap:!0},Hi.a.createElement(tb,{active:n.hand_raised,onClick:a})))}function lb({onToggleHandRaised:e}){return Hi.a.createElement(jv,{nowrap:!0,className:ab.a.popover},Hi.a.createElement(Hr.a,{padding:"xs",grow:!0,gap:"xs"},Hi.a.createElement(Yi.a,{id:"reaction-popover.hand-raised-warning",defaultMessage:"Your hand is raised"})),Hi.a.createElement(Hr.a,{padding:"xs",grow:!0,gap:"xs"},Hi.a.createElement(jr.c,{sm:!0,thin:!0,preset:"primary",onClick:e},Hi.a.createElement(Yi.a,{id:"reaction-popover.lower-hand",defaultMessage:"Lower Hand"}))))}function cb({items:e,presence:t,onToggleHandRaised:n}){const[a,i]=Object(Li.useState)(!1),[r,o]=Object(Li.useState)(!1),s=Object(po.a)().formatMessage(ob),l=Object(Li.useRef)(),c=Object(Li.useCallback)(()=>{o(!1),n()},[n]);return Hi.a.createElement(gc,{title:s,content:a=>r?Hi.a.createElement(lb,{onToggleHandRaised:c}):Hi.a.createElement(sb,ib({items:e,presence:t,onToggleHandRaised:n},a)),placement:"top",offsetDistance:28,popoverApiRef:l,showHeader:!r,isVisible:a||r,onChangeVisible:e=>{e||(i(!1),o(t.hand_raised))},disableFullscreen:r},({togglePopover:e,popoverVisible:n,triggerRef:l})=>Hi.a.createElement(cc,{ref:l,icon:t.hand_raised?Hi.a.createElement(Mf,{width:"32px",height:"32px",style:{marginLeft:"5px"}}):Hi.a.createElement(Jl,null),selected:n,onClick:()=>{i(!a),t.hand_raised?o(!r):(o(!1),e())},label:s,preset:"accent2"}))}function db(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}sb.propTypes={items:Ui.a.array.isRequired,presence:Ui.a.object,onToggleHandRaised:Ui.a.func},lb.propTypes={onToggleHandRaised:Ui.a.func},cb.propTypes={items:Ui.a.array.isRequired,presence:Ui.a.object,onToggleHandRaised:Ui.a.func};const ub=Object(Jr.b)({smile:{id:"reaction-popover.emoji-label.smile",defaultMessage:"Smile"},laugh:{id:"reaction-popover.emoji-label.laugh",defaultMessage:"Laugh"},clap:{id:"reaction-popover.emoji-label.clap",defaultMessage:"Clap"},heart:{id:"reaction-popover.emoji-label.heart",defaultMessage:"Heart"},wave:{id:"reaction-popover.emoji-label.wave",defaultMessage:"Wave"},angry:{id:"reaction-popover.emoji-label.angry",defaultMessage:"Angry"},cry:{id:"reaction-popover.emoji-label.cry",defaultMessage:"Cry"}});function hb({scene:e,initialPresence:t}){const n=Object(po.a)(),a=function(e,t){const[n,a]=Object(Li.useState)(t),i=({detail:e})=>{e.sessionId===NAF.clientId&&a(e)};return Object(Li.useEffect)(()=>(e.addEventListener("presence_updated",i),()=>e.removeEventListener("presence_updated",i)),[e]),n}(e,t),i=Te.map(e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){db(e,t,n[t])}))}return e}({src:e.particleEmitterConfig.src,onSelect:je,label:n.formatMessage(ub[e.id])},e)),r=Object(Li.useCallback)(()=>{a.hand_raised?window.APP.hubChannel.lowerHand():window.APP.hubChannel.raiseHand()},[a]);return Hi.a.createElement(cb,{items:i,presence:a,onToggleHandRaised:r})}function pb(){return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"safari-mic-modal.title",defaultMessage:"Microphone Access Required"})},Hi.a.createElement(Hr.a,{center:!0,padding:!0},Hi.a.createElement(Yi.a,{id:"safari-mic-modal.message",defaultMessage:"<p>Hubs requires microphone permissions in Safari.</p><p>Please reload and allow microphone access to continue.</p>",values:{p:e=>Hi.a.createElement("p",null,e)}}),Hi.a.createElement(jr.c,{preset:"accept",onClick:()=>location.reload()},Hi.a.createElement(Yi.a,{id:"safari-mic-modal.reload-button",defaultMessage:"Reload"}))))}function mb({onClose:e,step:t,onSubmitEmail:n,message:i,onContinue:r}){const[o,s]=Object(Li.useState)();return Hi.a.createElement(es.c,{onClose:e,closeable:!0},t===es.d.submit&&Hi.a.createElement(es.e,{onSubmitEmail:e=>{s(e),n(e)},initialEmail:o,termsUrl:a.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md"),showTerms:a.a.feature("show_terms"),privacyUrl:a.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md"),showPrivacy:a.a.feature("show_privacy"),message:i}),t===es.d.waitForVerification&&Hi.a.createElement(es.f,{onCancel:e,email:o,showNewsletterSignup:a.a.feature("show_newsletter_signup")}),t===es.d.complete&&Hi.a.createElement(es.a,{message:i,onContinue:r}))}hb.propTypes={scene:Ui.a.object,initialPresence:Ui.a.object},mb.propTypes={onClose:Ui.a.func,onSubmitEmail:Ui.a.func,step:Ui.a.string,message:Ui.a.string,onContinue:Ui.a.func};const fb="leaveRoom",gb="joinRoom",vb="createRoom",bb=Object(Jr.b)({[fb]:{id:"leave-room-modal.leave-room.message",defaultMessage:"Are you sure you want to leave the room?"},[gb]:{id:"leave-room-modal.join-room.message",defaultMessage:"Joining a new room will leave this one. Are you sure?"},[vb]:{id:"leave-room-modal.create-room.message",defaultMessage:"Creating a new room will leave this one. Are you sure?"}}),yb=Object(Jr.b)({[fb]:{id:"leave-room-modal.leave-room.confirm",defaultMessage:"Leave Room"},[gb]:{id:"leave-room-modal.join-room.confirm",defaultMessage:"Join Room"},[vb]:{id:"leave-room-modal.create-room.confirm",defaultMessage:"Leave and Create Room"}});function Eb({reason:e,destinationUrl:t,onClose:n}){const a=Object(po.a)();return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"leave-room-modal.title",defaultMessage:"Leave Room"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:n})},Hi.a.createElement(Hr.a,{padding:!0,center:!0,centerMd:"both",grow:!0},Hi.a.createElement("p",null,a.formatMessage(bb[e])),Hi.a.createElement(jr.c,{as:"a",preset:"cancel",href:t,rel:"noopener noreferrer"},a.formatMessage(yb[e]))))}Eb.propTypes={reason:Ui.a.string,destinationUrl:Ui.a.string,onClose:Ui.a.func};var wb=n(176),_b=n.n(wb);function Sb({attribution:e}){const t=Object(po.a)().formatMessage({id:"room-sidebar.unknown",defaultMessage:"unknown"}),n=e.name||e.title||t,a=e.author||t;if(e.url){const t=e.url.includes("sketchfab.com")?"Sketchfab":null;return Hi.a.createElement("li",{className:_b.a.attribution},Hi.a.createElement("div",{className:_b.a.attributionName},Hi.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},n)),Hi.a.createElement("div",{className:_b.a.attributionAuthor},t?Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-attribution-with-source",defaultMessage:"by {author} on {source}",values:{author:a,source:t}}):Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-attribution",defaultMessage:"by {author}",values:{author:a}})))}return e.author?Hi.a.createElement("li",{className:_b.a.attribution},Hi.a.createElement("div",{className:_b.a.attributionName},n),Hi.a.createElement("div",{className:_b.a.attributionAuthor},Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-attribution",defaultMessage:"by {author}",values:{author:a}}))):null}function xb({accountId:e,scene:t,showAttributions:n,canChangeScene:a,onChangeScene:i}){const r=a&&Hi.a.createElement(jr.c,{preset:"primary",onClick:i},Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-info.change-scene-button",defaultMessage:"Change Scene"}));if(!t)return r;const o=function(e,t){return t&&(e&&t.account_id===e||t.allow_promotion||t.allow_remixing)}(e,t),s=t.attributions&&t.attributions.content||[],l=t.attributions&&t.attributions.creator,c=s.filter(e=>e.url||e.author).map((e,t)=>Hi.a.createElement(Sb,{attribution:e,key:t}));return Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("h2",{className:_b.a.sectionTitle},Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-info.title",defaultMessage:"Scene"})),Hi.a.createElement("div",{className:_b.a.sceneScreenshotContainer},o?Hi.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},Hi.a.createElement("img",{className:_b.a.sceneScreenshotImage,src:t.screenshot_url})):Hi.a.createElement("img",{className:_b.a.sceneScreenshotImage,src:t.screenshot_url})),Hi.a.createElement("div",{className:_b.a.sceneInfo},o?Hi.a.createElement("b",{className:_b.a.sceneName},Hi.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},t.name)):Hi.a.createElement("b",{className:_b.a.sceneName},t.name),Hi.a.createElement("div",{className:_b.a.sceneCreator},Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-info.scene-creator",defaultMessage:"by {creator}",values:{creator:l}}))),n&&c.length>0&&Hi.a.createElement(Vd.a,{label:Hi.a.createElement(Yi.a,{id:"room-sidebar.scene-info.attributions",defaultMessage:"Attributions"})},Hi.a.createElement("ul",{className:_b.a.attributions},c)),r)}function Ab({room:e,accountId:t,onClose:n,canEdit:a,onEdit:i,onChangeScene:r}){return Hi.a.createElement(_r,{title:Hi.a.createElement(Yi.a,{id:"room-sidebar.title",defaultMessage:"Room"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:n}),afterTitle:a&&Hi.a.createElement(Mr.a,{onClick:i},Hi.a.createElement(Yi.a,{id:"room-sidebar.edit-button",defaultMessage:"Edit"}))},Hi.a.createElement(Hr.a,{padding:!0},Hi.a.createElement(Vd.a,{label:Hi.a.createElement(Yi.a,{id:"room-sidebar.room-name",defaultMessage:"Name"})},e.name),e.description&&Hi.a.createElement(Vd.a,{label:Hi.a.createElement(Yi.a,{id:"room-sidebar.room-description",defaultMessage:"Description"})},e.description),Hi.a.createElement(xb,{accountId:t,scene:e.scene,showAttributions:!0,canChangeScene:a,onChangeScene:r})))}Ab.propTypes={accountId:Ui.a.string,room:Ui.a.object.isRequired,onClose:Ui.a.func,canEdit:Ui.a.bool,onEdit:Ui.a.func,onChangeScene:Ui.a.func};var Mb=n(201);function kb(){return(kb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ob(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Cb=Object(Li.memo)(Object(Li.forwardRef)((e,t)=>{let{className:n,error:a,description:i,inputClassName:r,label:o,fullWidth:s}=e,l=Ob(e,["className","error","description","inputClassName","label","fullWidth"]);const c=Object(Mb.a)(),d=Object(Mb.a)();return Hi.a.createElement(Vd.a,{id:d,htmlFor:c,className:n,label:o,error:a,description:i,fullWidth:s},Hi.a.createElement(ic,kb({id:c,ref:t,className:r},l)))}));Cb.propTypes={className:Ui.a.string,label:Ui.a.node,error:Ui.a.node,description:Ui.a.node,labelClassName:Ui.a.string,inputClassName:Ui.a.string,fullWidth:Ui.a.bool};var Pb=n(334),Rb=n.n(Pb);function Tb(){return(Tb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function jb(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Db(e){let{className:t,children:n}=e,a=jb(e,["className","children"]);return Hi.a.createElement("div",Tb({className:Wi()(Rb.a.radioInput,t)},a),n)}Db.propTypes={className:Ui.a.string,children:Ui.a.node};const Ib=Object(Li.forwardRef)((e,t)=>{let{label:n,description:a,className:i,labelClassName:r}=e,o=jb(e,["label","description","className","labelClassName"]);return Hi.a.createElement("label",{className:Wi()(Rb.a.option,i)},Hi.a.createElement("input",Tb({className:Rb.a.input,type:"radio",ref:t},o)),Hi.a.createElement("div",{className:Wi()(Rb.a.content,r)},Hi.a.createElement("span",{className:Rb.a.label},n),a&&Hi.a.createElement("span",{className:Rb.a.description},a)))});function Lb(){return(Lb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Hb(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}Ib.propTypes={className:Ui.a.string,label:Ui.a.node.isRequired,description:Ui.a.node,labelClassName:Ui.a.string};const Nb=Object(Li.memo)(e=>{let{className:t,error:n,description:a,inputClassName:i,label:r,children:o,fullWidth:s}=e,l=Hb(e,["className","error","description","inputClassName","label","children","fullWidth"]);return Hi.a.createElement(Vd.a,{className:t,label:r,error:n,description:a,fullWidth:s},Hi.a.createElement(Db,Lb({className:i},l),o))});Nb.propTypes={className:Ui.a.string,label:Ui.a.node,error:Ui.a.node,description:Ui.a.node,labelClassName:Ui.a.string,inputClassName:Ui.a.string,children:Ui.a.node,fullWidth:Ui.a.bool};const Fb=Ib;var Vb=n(807),Bb=n.n(Vb);function Ub(){return(Ub=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zb(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Wb=Object(Li.memo)(Object(Li.forwardRef)((e,t)=>{let{className:n,afterInput:a}=e,i=zb(e,["className","afterInput"]);return Hi.a.createElement($l.a,Ub({inputMode:"numeric"},i,{type:"number",className:Wi()(Bb.a.numericInput,n),ref:t,afterInput:a}))}));function qb(){return(qb=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Gb(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}Wb.propTypes={afterInput:Ui.a.node,className:Ui.a.string};const Yb=Object(Li.memo)(Object(Li.forwardRef)((e,t)=>{let{className:n,error:a,description:i,inputClassName:r,label:o,fullWidth:s}=e,l=Gb(e,["className","error","description","inputClassName","label","fullWidth"]);const c=Object(Mb.a)(),d=Object(Mb.a)();return Hi.a.createElement(Vd.a,{id:d,htmlFor:c,className:n,label:o,error:a,description:i,fullWidth:s},Hi.a.createElement(Wb,qb({id:c,ref:t,className:r},l)))}));function Kb({showBackButton:e,accountId:t,room:n,fetchingInvite:a,inviteUrl:i,onRevokeInvite:r,maxRoomSize:o,showPublicRoomSetting:s,onSubmit:l,onClose:c,canChangeScene:d,onChangeScene:u}){const h=Object(po.a)(),{handleSubmit:p,register:m,watch:f,errors:g,setValue:v}=Object(eo.a)({defaultValues:n}),b=f("entry_mode"),y=f("member_permissions.spawn_and_move_media");return Object(Li.useEffect)(()=>{y||(v("member_permissions.spawn_camera",!1,{shouldDirty:!0}),v("member_permissions.pin_objects",!1,{shouldDirty:!0}))},[y,v]),Hi.a.createElement(_r,{title:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.title",defaultMessage:"Room Settings"}),beforeTitle:e?Hi.a.createElement(Tr,{onClick:c}):Hi.a.createElement(Sr.a,{onClick:c})},Hi.a.createElement(Hr.a,{padding:!0,as:"form",onSubmit:p(l)},Hi.a.createElement(xb,{accountId:t,scene:n.scene,canChangeScene:d,onChangeScene:u}),Hi.a.createElement(Lr.a,{name:"name",type:"text",required:!0,autoComplete:"off",placeholder:h.formatMessage({id:"room-settings-sidebar.name-placeholder",defaultMessage:"Room name"}),minLength:1,maxLength:64,label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.name",defaultMessage:"Room Name"}),ref:m,error:g.name,fullWidth:!0}),Hi.a.createElement(Cb,{name:"description",autoComplete:"off",placeholder:h.formatMessage({id:"room-settings-sidebar.description-placeholder",defaultMessage:"Room Description"}),label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.description",defaultMessage:"Room Description"}),minRows:3,ref:m,error:g.description,fullWidth:!0}),Hi.a.createElement(Yb,{name:"room_size",required:!0,min:0,max:o,placeholder:h.formatMessage({id:"room-settings-sidebar.room-size-placeholder",defaultMessage:"Member Limit"}),label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.room-size",defaultMessage:"Room Size"}),ref:m,error:g.room_size,fullWidth:!0}),Hi.a.createElement(Nb,{label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.room-access",defaultMessage:"Room Access"}),fullWidth:!0},Hi.a.createElement(Fb,{name:"entry_mode",value:"allow",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-shared-link",defaultMessage:"Shared link"}),description:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-shared-link-description",defaultMessage:"Only those with the link can join"}),ref:m,error:g.entry_mode}),Hi.a.createElement(Fb,{name:"entry_mode",value:"invite",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-invite",defaultMessage:"Invite only"}),description:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-invite-description",defaultMessage:"Invite people with a link that can be revoked"}),ref:m,error:g.entry_mode})),"invite"===b&&Hi.a.createElement(wp,{fetchingInvite:a,inviteUrl:i,onRevokeInvite:r}),s&&Hi.a.createElement(Wh,{name:"allow_promotion",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-public",defaultMessage:"Public"}),description:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.access-public-description",defaultMessage:"Listed on the homepage"}),ref:m}),Hi.a.createElement(Vd.a,{label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.permissions",defaultMessage:"Room Member Permissions"}),fullWidth:!0},Hi.a.createElement("div",{className:Ep.a.roomPermissions},Hi.a.createElement(Wh,{name:"member_permissions.spawn_and_move_media",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.spawn-and-move-media",defaultMessage:"Create and move objects"}),ref:m}),Hi.a.createElement("div",{className:Ep.a.permissionsGroup},Hi.a.createElement(Wh,{name:"member_permissions.spawn_camera",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.spawn-camera",defaultMessage:"Create cameras"}),ref:m,disabled:!y}),Hi.a.createElement(Wh,{name:"member_permissions.pin_objects",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.pin-objects",defaultMessage:"Pin objects"}),ref:m,disabled:!y})),Hi.a.createElement(Wh,{name:"member_permissions.spawn_drawing",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.spawn-drawing",defaultMessage:"Create drawings"}),ref:m}),Hi.a.createElement(Wh,{name:"member_permissions.spawn_emoji",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.spawn-emoji",defaultMessage:"Create emoji"}),ref:m}),Hi.a.createElement(Wh,{name:"member_permissions.fly",label:Hi.a.createElement(Yi.a,{id:"room-settings-sidebar.fly",defaultMessage:"Allow flying"}),ref:m}))),Hi.a.createElement(jr.b,{type:"submit"})))}function Xb({showBackButton:e,room:t,hubChannel:n,onChangeScene:i,onClose:r}){const o=a.a.feature("max_room_size"),{fetchingInvite:s,inviteUrl:l,revokeInvite:c}=Op(n),d=Object(Li.useCallback)(e=>{n.updateHub(e),r()},[n,r]);return Hi.a.createElement(Kb,{showBackButton:e,room:t,fetchingInvite:s,inviteUrl:l,onRevokeInvite:c,maxRoomSize:o,showPublicRoomSetting:n.can("update_hub_promotion"),onSubmit:d,canChangeScene:!0,onChangeScene:i,onClose:r})}Yb.propTypes={className:Ui.a.string,label:Ui.a.node,error:Ui.a.node,description:Ui.a.node,labelClassName:Ui.a.string,inputClassName:Ui.a.string,fullWidth:Ui.a.bool},Kb.propTypes={accountId:Ui.a.string,showBackButton:Ui.a.bool,room:Ui.a.object.isRequired,fetchingInvite:Ui.a.bool,inviteUrl:Ui.a.string,onRevokeInvite:Ui.a.func,roomSize:Ui.a.number,maxRoomSize:Ui.a.number,showPublicRoomSetting:Ui.a.bool,onSubmit:Ui.a.func,onClose:Ui.a.func,canChangeScene:Ui.a.bool,onChangeScene:Ui.a.func},Xb.propTypes={showBackButton:Ui.a.bool,room:Ui.a.object.isRequired,hubChannel:Ui.a.object.isRequired,onClose:Ui.a.func.isRequired,onChangeScene:Ui.a.func};const Qb="concurrentSession",Jb="idle",Zb=Object(Jr.b)({[Qb]:{id:"auto-exit-warning-modal.reason.concurrent-session",defaultMessage:"You have started another session."},[Jb]:{id:"auto-exit-warning-modal.reason.idle",defaultMessage:"You have been idle for too long."}});function $b({onCancel:e,reason:t,secondsRemaining:n}){const a=Object(po.a)();return Hi.a.createElement(zr.a,{title:"Warning"},Hi.a.createElement(Hr.a,{padding:!0,center:!0},Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"auto-exit-warning-modal.message",defaultMessage:"Auto-ending session in {secondsRemaining} seconds",values:{secondsRemaining:n}})),Hi.a.createElement("p",null,a.formatMessage(Zb[t])),Hi.a.createElement(jr.d,{onClick:e})))}$b.propTypes={reason:Ui.a.string.isRequired,secondsRemaining:Ui.a.number.isRequired,onCancel:Ui.a.func};const ey={exited:"exited",closed:"closed",denied:"denied",disconnected:"disconnected",left:"left",full:"full",sceneError:"sceneError",connectError:"connectError",versionMismatch:"versionMismatch"},ty=Object(Jr.b)({[ey.exited]:{id:"exited-room-screen.reason.exited",defaultMessage:"Your session has ended. Refresh your browser to start a new one."},[ey.closed]:{id:"exited-room-screen.reason.closed",defaultMessage:"This room is no longer available."},[ey.denied]:{id:"exited-room-screen.reason.denied",defaultMessage:"You are not permitted to join this room. Please request permission from the room creator."},[ey.disconnected]:{id:"exited-room-screen.reason.disconnected",defaultMessage:"You have disconnected from the room. Refresh the page to try to reconnect."},[ey.left]:{id:"exited-room-screen.reason.left",defaultMessage:"You have left the room."},[ey.full]:{id:"exited-room-screen.reason.full",defaultMessage:"This room is full, please try again later."},[ey.sceneError]:{id:"exited-room-screen.reason.scene-error",defaultMessage:"The scene failed to load."},[ey.connectError]:{id:"exited-room-screen.reason.connect-error",defaultMessage:"Unable to connect to this room, please try again later."},[ey.versionMismatch]:{id:"exited-room-screen.reason.version-mismatch",defaultMessage:"The version you deployed is not available yet. Your browser will refresh in 5 seconds."}});function ny({reason:e,showTerms:t,termsUrl:n,showSourceLink:a}){const i=Object(po.a)();let r=null;if(e===ey.closed){const e=i.formatMessage({id:"contact-email"});r=Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.no-longer-available",defaultMessage:"Sorry, this room is no longer available."})),t&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.closed-room-tos",defaultMessage:"A room may be closed by the room owner, or if we receive reports that it violates our <toslink>Terms of Use</toslink>.",values:{toslink:e=>Hi.a.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:n},e)}})),Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.contact-us",defaultMessage:"If you have questions, contact us at {contactEmail}.",values:{contactEmail:Hi.a.createElement("a",{href:"mailto:".concat(e)},e)}})),a&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.source-link",defaultMessage:"If you'd like to run your own server, Hubs's source code is available on <a>GitHub</a>.",values:{a:e=>Hi.a.createElement("a",{href:"https://github.com/mozilla/hubs"},e)}})),Hi.a.createElement(jr.c,{as:"a",preset:"accept",href:"/"},Hi.a.createElement(Yi.a,{id:"exited-room-screen.home-button",defaultMessage:"Back to Home"})))}else{const t=new URL(document.location.toString()),n=new URLSearchParams(t.search);n.set("force_tcp",!0),t.search=n.toString(),r=Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement("b",null,i.formatMessage(ty[e])),e===ey.connectError&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.connect-tcp",defaultMessage:"You can try <a>connecting via TCP</a>, which may work better on some networks.",values:{a:e=>Hi.a.createElement("a",{href:t.toString()},e)}})),![ey.left,ey.disconnected,ey.sceneError].includes(e)&&Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"exited-room-screen.create-room",defaultMessage:"You can also <a>create a new room</a>.",values:{a:e=>Hi.a.createElement("a",{href:"/"},e)}})),Hi.a.createElement(jr.c,{as:"a",preset:"accept",href:window.location.href},Hi.a.createElement(Yi.a,{id:"exited-room-screen.refresh-page-button",defaultMessage:"Refresh Page"})))}return Hi.a.createElement(ju,{center:r})}function ay({roomName:e,onClose:t,onConfirm:n}){const[a,i]=Object(Li.useState)(""),[r,o]=Object(Li.useState)(!1),s=Object(Li.useCallback)(()=>{a.toLowerCase()===e.toLowerCase()?n():o(!0)},[n,a,e]);return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"close-room-modal.title",defaultMessage:"Close Room"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:t})},Hi.a.createElement(Hr.a,{padding:!0,center:!0,centerMd:"both",grow:!0},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"close-room-modal.message",defaultMessage:"Closing this room will remove yourself and others from the room, shutting it down permanently.{linebreak}Are you sure? This action cannot be undone.",values:{linebreak:Hi.a.createElement("br",null)}})),Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"close-room-modal.type-to-confirm",defaultMessage:"Type room name to confirm: {roomName}",values:{roomName:Hi.a.createElement("b",null,e)}})),Hi.a.createElement(Lr.a,{label:Hi.a.createElement(Yi.a,{id:"close-room-modal.confirm-room-name-field",defaultMessage:"Confirm Room Name"}),onChange:e=>i(e.target.value),value:a,error:r&&Hi.a.createElement(Yi.a,{id:"close-room-modal.room-name-match-error",defaultMessage:"Room name does not match"})}),Hi.a.createElement(jr.c,{preset:"accept",onClick:s},Hi.a.createElement(Yi.a,{id:"close-room-modal.confirm",defaultMessage:"Yes, Close Room"})),Hi.a.createElement(jr.d,{onClick:t})))}function iy({onClose:e}){return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"webvr-unsupported-modal.title",defaultMessage:"Enter in VR"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:e})},Hi.a.createElement(Hr.a,{padding:!0,center:!0},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"webvr-unsupported-modal.message",defaultMessage:"WebVR isn't supported in this browser, to enter with Oculus or SteamVR, use Firefox."})),Hi.a.createElement(jr.c,{as:"a",preset:"accent2",href:"https://www.mozilla.org/firefox/",target:"_blank",rel:"noreferrer noopener"},Hi.a.createElement("span",null,Hi.a.createElement(Yi.a,{id:"webvr-unsupported-modal.download-firefox-button",defaultMessage:"Download Firefox"}))),Hi.a.createElement("p",null,Hi.a.createElement("small",null,Hi.a.createElement(Yi.a,{id:"webvr-unsupported-modal.webvr-rocks-link",defaultMessage:"For a list of browsers with experimental VR support, visit <a>WebVR Rocks</a>.",values:{a:e=>Hi.a.createElement("a",{href:"https://webvr.rocks",target:"_blank",rel:"noopener noreferrer"},e)}})))))}ny.propTypes={reason:Ui.a.string.isRequired,showTerms:Ui.a.bool,termsUrl:Ui.a.string,showSourceLink:Ui.a.bool},ay.propTypes={roomName:Ui.a.string,onConfirm:Ui.a.func,onClose:Ui.a.func},iy.propTypes={onClose:Ui.a.func};var ry=n(808),oy=n.n(ry),sy=n(809),ly=n.n(sy),cy=n(810),dy=n.n(cy),uy=n(811),hy=n.n(uy),py=n(476),my=n.n(py),fy=(n(1527),n(1528),n(1529),n(1530),n(335)),gy=n.n(fy);const vy=oy()(),by=ly()(),yy=dy()(),Ey=hy()();function wy({editorState:e,editorRef:t,sending:n,mediaThumbnailUrl:a,contentSubtype:i,onClickEditor:r,onChange:o,onSend:s,onClose:l}){const{EmojiSuggestions:c,EmojiSelect:d}=vy,{CharCounter:u}=Ey,h=e.getCurrentContent().getPlainText().length;return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"tweet-editor-modal.title",defaultMessage:"Tweet"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:l})},Hi.a.createElement(Hr.a,{padding:!0,center:!0},Hi.a.createElement("div",{className:gy.a.media},i&&i.startsWith("video")?Hi.a.createElement("video",{src:a,width:450,height:255,controls:!0}):Hi.a.createElement("img",{src:a,width:450,height:255})),Hi.a.createElement("div",{className:gy.a.editor},Hi.a.createElement("div",{className:gy.a.editorInner,onClick:r},Hi.a.createElement(my.a,{ref:t,editorState:e,onChange:o,plugins:[vy,by,yy,Ey]})),Hi.a.createElement("div",{className:gy.a.emojiButton},Hi.a.createElement(d,null)),Hi.a.createElement("div",{className:gy.a.emojiSuggestions},Hi.a.createElement(c,null)),h>200&&Hi.a.createElement("div",{className:gy.a.counter},Hi.a.createElement(u,{editorState:e,limit:280})," / 280")),Hi.a.createElement(jr.c,{preset:"accent4",disabled:n||h>280,onClick:s},n?Hi.a.createElement(Yi.a,{id:"tweet-editor-modal.sending-tweet",defaultMessage:"Sending Tweet..."}):Hi.a.createElement(Yi.a,{id:"tweet-editor-modal.tweet-button",defaultMessage:"Tweet"}))))}wy.propTypes={editorRef:Ui.a.any,editorState:Ui.a.object.isRequired,onChange:Ui.a.func,sending:Ui.a.bool,mediaThumbnailUrl:Ui.a.string,contentSubtype:Ui.a.string,onClickEditor:Ui.a.func,onSend:Ui.a.func,onClose:Ui.a.func};var _y=n(172);function Sy(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function xy(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Sy(r,a,i,o,s,"next",e)}function s(e){Sy(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Ay({initialTweet:e,mediaUrl:t,contentSubtype:n,onClose:a}){const[i,r]=Object(Li.useState)(()=>Object(py.createEditorStateWithText)(e||"")),o=Object(Li.useRef)();Object(Li.useEffect)(()=>{r(e=>((e,t)=>{const n=t.getCurrentContent(),a=n.createEntity("emoji","IMMUTABLE",{emojiUnicode:e}).getLastCreatedEntityKey(),i=t.getSelection();let r,o=0,s=0;const l=_y.Modifier.removeRange(n,i,"backward"),c=l.getSelectionAfter();r=_y.Modifier.insertText(l,c,e,null,a),o=c.getAnchorOffset();const d=c.getAnchorKey();s=n.getBlockForKey(d).getLength(),o===s&&(r=_y.Modifier.insertText(r,r.getSelectionAfter()," "));const u=_y.EditorState.push(t,r,"insert-emoji");return _y.EditorState.forceSelection(u,r.getSelectionAfter())})("",e))},[]);const[s,l]=Object(Li.useState)(!1),c=Object(Li.useCallback)(xy((function*(){l(!0);try{const e=i.getCurrentContent().getPlainText();yield Object(m.e)("/api/v1/twitter/tweets","POST",{media_stored_file_url:t,body:e})}catch(e){l(!1),console.error(e)}a()})),[t,i,a]),d=Object(Li.useMemo)(()=>n&&!n.startsWith("video")?Object(Ut.l)(t,450,255):t,[n,t]);return Hi.a.createElement(wy,{editorState:i,editorRef:o,onClose:a,sending:s,onSend:c,onChange:r,mediaThumbnailUrl:d,contentSubtype:n})}function My({appName:e,onConnect:t,onClose:n}){return Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"twitter-oauth-modal.title",defaultMessage:"Connect to Twitter"}),beforeTitle:Hi.a.createElement(Sr.a,{onClick:n})},Hi.a.createElement(Hr.a,{padding:!0,center:!0,centerMd:"both",grow:!0},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"twitter-oauth-modal.message",defaultMessage:"Connect to Twitter to send tweets from {appName}.",values:{appName:e}})),Hi.a.createElement(jr.c,{preset:"accent4",onClick:t},Hi.a.createElement(Yi.a,{id:"twitter-oauth-modal.connect-button",defaultMessage:"Connect to Twitter"}))))}function ky(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Oy(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){ky(r,a,i,o,s,"next",e)}function s(e){ky(r,a,i,o,s,"throw",e)}o(void 0)}))}}function Cy({hubChannel:e,onConnected:t,onClose:n,isAdmin:i}){const r=Object(Li.useRef)(),o=Object(Li.useCallback)(Oy((function*(){try{r.current&&r.current.close();const t=yield e.getTwitterOAuthURL(),n=600,a=760,i=(window.innerWidth-n)/2+window.screenLeft,o=(window.innerHeight-a)/2+window.screenTop;window.doingTwitterOAuth=!0;const s=window.open(t,"_blank","resizable=yes,width=".concat(n,",height=").concat(a,",left=").concat(i,",top=").concat(o,"toolbar=no,titlebar=no,menubar=no,scrollbars=yes"));s.focus(),r.current=s}catch(e){console.error(e),"twitter_api_error"===e.message&&i&&console.warn("Twitter might be misconfigured for Hubs Cloud. Check the docs here: https://hubs.mozilla.com/docs/hubs-cloud-third-party-integrations.html#twitter"),n()}})),[e,i,n]);return Object(Li.useEffect)(()=>{function e({data:n}){"oauth-successful"===n&&(t(),r.current=null,delete window.doingTwitterOAuth,window.removeEventListener("message",e))}return window.addEventListener("message",e),()=>{r.current&&r.current.close(),delete window.doingTwitterOAuth,window.removeEventListener("message",e)}},[t]),Hi.a.createElement(My,{appName:a.a.translation("app-name"),onConnect:o,onClose:n})}function Py({hubChannel:e,initialTweet:t,mediaUrl:n,contentSubtype:i,onClose:r,isAdmin:o}){const[s,l]=Object(Li.useState)(e.can("tweet")),c=Object(Li.useCallback)(()=>{l(!0)},[]);return s?Hi.a.createElement(Ay,{initialTweet:t,mediaUrl:n,contentSubtype:i,onClose:r}):Hi.a.createElement(Cy,{appName:a.a.translation("app-name"),hubChannel:e,onConnected:c,onClose:r,isAdmin:o})}Ay.propTypes={mediaUrl:Ui.a.string,contentSubtype:Ui.a.string,initialTweet:Ui.a.object.isRequired,onClose:Ui.a.func},My.propTypes={appName:Ui.a.string.isRequired,onConnect:Ui.a.func,onClose:Ui.a.func},Cy.propTypes={hubChannel:Ui.a.object.isRequired,onConnected:Ui.a.func.isRequired,onClose:Ui.a.func,isAdmin:Ui.a.bool},Py.propTypes={hubChannel:Ui.a.object.isRequired,initialTweet:Ui.a.string,mediaUrl:Ui.a.string,contentSubtype:Ui.a.string,onClose:Ui.a.func,isAdmin:Ui.a.bool};var Ry=n(485),Ty=n.n(Ry);function jy(){return(jy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Dy(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Iy(e){let{className:t,children:n,onDismiss:a,dismissLabel:i}=e,r=Dy(e,["className","children","onDismiss","dismissLabel"]);return Hi.a.createElement("div",jy({className:Wi()(Ty.a.tip,t)},r),Hi.a.createElement("div",{className:Ty.a.content},n),a&&Hi.a.createElement("button",{className:Ty.a.dismissButton,onClick:a},i))}function Ly(){return(Ly=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}Iy.propTypes={className:Ui.a.string,children:Ui.a.node,onDismiss:Ui.a.func,dismissLabel:Ui.a.node};let Hy="W A S D",Ny="Q",Fy="E";void 0!==window.navigator.keyboard&&window.navigator.keyboard.getLayoutMap&&window.navigator.keyboard.getLayoutMap().then((function(e){var t,n;Hy="".concat(e.get("KeyW")||"W"," ").concat(e.get("KeyA")||"A"," ").concat(e.get("KeyS")||"S"," ").concat(e.get("KeyD")||"D").toUpperCase(),Ny=null===(t=e.get("KeyQ"))||void 0===t?void 0:t.toUpperCase(),Fy=null===(n=e.get("KeyE"))||void 0===n?void 0:n.toUpperCase()})).catch((function(e){console.warn("Unable to remap keyboard: ".concat(e))}));const Vy=Object(Jr.b)({"tips.mobile.look":{id:"tips.mobile.look",defaultMessage:"Welcome!  Tap and drag to look around."},"tips.mobile.locomotion":{id:"tips.mobile.locomotion",defaultMessage:"Great! To move, pinch with two fingers."},"tips.mobile.invite":{id:"tips.mobile.invite",defaultMessage:"Use the Invite button in the bottom left to share this room."},"tips.desktop.look":{id:"tips.desktop.look",defaultMessage:"Welcome to {appName}! Let's take a quick tour.  Click and drag to look around."},"tips.desktop.locomotion":{id:"tips.desktop.locomotion",defaultMessage:"Use the {moveKeys} keys to move. Hold shift to boost."},"tips.desktop.turning":{id:"tips.desktop.turning",defaultMessage:"Perfect. Use the {turnLeftKey} and {turnRightKey} keys to rotate."},"tips.desktop.invite":{id:"tips.desktop.invite",defaultMessage:"Nobody else is here. Use the invite button in the bottom left to share this room."}});function By(){return Hi.a.createElement(Yi.a,{id:"tips.dismiss.ok",defaultMessage:"Ok"})}function Uy(){return Hi.a.createElement(Yi.a,{id:"tips.dismiss.skip",defaultMessage:"Skip"})}function zy(e){return Hi.a.createElement(Iy,Ly({},e,{dismissLabel:Hi.a.createElement(By,null)}),Hi.a.createElement(Yi.a,{id:"tips.fullscreen",defaultMessage:"Entered fullscreen mode. Press Escape to show UI."}))}function Wy({hide:e,inLobby:t,inRoom:n,isStreaming:i,isEmbedded:r,scene:o,store:s,hubId:l,presences:c}){const d=Object(po.a)(),[u,h]=Object(Li.useState)(!1),[p,f]=Object(Li.useState)(()=>s.state.confirmedBroadcastedRooms.includes(l)),[g,v]=Object(Li.useState)(!1),[b,y]=Object(Li.useState)(!1),[E,w]=Object(Li.useState)(null),_=Object(Li.useCallback)(()=>{o.systems.tips.skipTips()},[o]);Object(Li.useEffect)(()=>{o.addEventListener("tip-changed",(function({detail:e}){w(e)})),w(o.systems.tips.activeTip)},[o]);const S=c?Object(m.d)(c):[],x=S.length>0;return e?null:t?u?null:Hi.a.createElement(Iy,{onDismiss:()=>h(!0),dismissLabel:Hi.a.createElement(By,null)},Hi.a.createElement(Yi.a,{id:"tips.lobby",defaultMessage:"You're in the lobby. Others cannot see or hear you."})):n?E?Hi.a.createElement(Iy,{onDismiss:_,dismissLabel:Hi.a.createElement(Uy,null)},d.formatMessage(Vy[E],{appName:a.a.translation("app-name"),moveKeys:Hy,turnLeftKey:Ny,turnRightKey:Fy})):i&&!g?Hi.a.createElement(Iy,{onDismiss:()=>v(!0),dismissLabel:Hi.a.createElement(By,null)},Hi.a.createElement(Yi.a,{id:"tips.streaming",defaultMessage:"Now broadcasting to the lobby. Exit streamer mode in the more menu when you're done."})):x&&!p?Hi.a.createElement(Iy,{onDismiss:()=>f(!0),dismissLabel:Hi.a.createElement(By,null)},Hi.a.createElement(Yi.a,{id:"tips.discord",defaultMessage:"Chat in this room is being bridged to {broadcastTarget} on Discord.",values:{broadcastTarget:S.map(e=>"#"+e).join(", ")}})):!r&&!Object(m.l)(c)||b?null:Hi.a.createElement(Iy,{onDismiss:()=>y(!0),dismissLabel:Hi.a.createElement(By,null)},Hi.a.createElement(Yi.a,{id:"tips.embedded",defaultMessage:"This room is embedded, so it may be visible to visitors on other websites."})):null}Wy.propTypes={hide:Ui.a.bool,inLobby:Ui.a.bool,inRoom:Ui.a.bool,isStreaming:Ui.a.bool,isEmbedded:Ui.a.bool,scene:Ui.a.object.isRequired,store:Ui.a.object.isRequired,hubId:Ui.a.string,presences:Ui.a.object};var qy=n(812),Gy=n.n(qy);function Yy({name:e}){return Hi.a.createElement("div",{className:Gy.a.label},Hi.a.createElement("b",null,Hi.a.createElement(Yi.a,{id:"spectating-label.label",defaultMessage:"Spectating"})),Hi.a.createElement("p",null,e))}function Ky(){return(Ky=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){Qy(e,t,n[t])}))}return e}function Qy(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jy(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function Zy(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){Jy(r,a,i,o,s,"next",e)}function s(e){Jy(r,a,i,o,s,"throw",e)}o(void 0)}))}}Yy.propTypes={name:Ui.a.string};const $y=Object(mt.a)("avatarEditorDebug"),eE=["/media"],tE=["media_source"],nE=["/media/scenes","/media/avatars","/media/favorites"],aE=["media_source"],iE=["scenes","avatars","favorites"];function rE(){return(rE=Zy((function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>e.label&&"audioinput"===e.kind).map(e=>e.label)}))).apply(this,arguments)}const oE=AFRAME.utils.device.isMobile(),sE=AFRAME.utils.device.isMobileVR();class lE extends Li.Component{constructor(e){var t;super(e),t=this,this.willCompileAndUploadMaterials=!1,this.state={enterInVR:!1,entered:!1,entering:!1,dialog:null,showShareDialog:!1,linkCode:null,linkCodeCancel:null,miniInviteActivated:!1,didConnectToNetworkedScene:!1,noMoreLoadingUpdates:!1,hideLoader:!1,showPrefs:!1,watching:!1,isStreaming:!1,waitingOnAudio:!1,audioTrackClone:null,autoExitTimerStartedAt:null,autoExitTimerInterval:null,autoExitReason:null,secondsRemainingBeforeAutoExit:1/0,signedIn:!1,videoShareMediaSource:null,showVideoShareFailed:!1,objectInfo:null,objectSrc:"",sidebarId:null,presenceCount:0,chatInputEffect:()=>{}},this.onConcurrentLoad=()=>{Object(mt.a)("allow_multi")||this.props.store.state.preferences.allowMultipleHubsInstances||this.startAutoExitTimer(Qb)},this.onIdleDetected=()=>{this.props.disableAutoExitOnIdle||this.state.isStreaming||this.props.store.state.preferences.disableIdleDetection||this.startAutoExitTimer(Jb)},this.onActivityDetected=()=>{this.state.autoExitTimerInterval&&this.endAutoExitTimer()},this.storeUpdated=()=>{this.forceUpdate()},this.showContextualSignInDialog=()=>{const{signInMessage:e,authChannel:n}=this.props,a=()=>{const{onContinueAfterSignIn:e}=this.props;e&&e()||this.closeDialog()};this.showNonHistoriedDialog(mb,{step:es.d.submit,message:e,onSubmitEmail:function(){var e=Zy((function*(e){const{authComplete:i}=yield n.startAuthentication(e,t.props.hubChannel);t.showNonHistoriedDialog(mb,{step:es.d.waitForVerification,onClose:a}),yield i,t.setState({signedIn:!0}),t.showNonHistoriedDialog(mb,{step:es.d.complete,onClose:a,onContinue:a})}));return function(t){return e.apply(this,arguments)}}(),onClose:a})},this.updateSubscribedState=()=>{const e=this.props.subscriptions&&this.props.subscriptions.isSubscribed();this.setState({isSubscribed:e})},this.toggleFavorited=()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,()=>{const e=this.isFavorited();this.props.hubChannel[e?"unfavorite":"favorite"](),this.setState({isFavorited:!e})},es.b.favoriteRoom)},this.isFavorited=()=>void 0!==this.state.isFavorited?this.state.isFavorited:this.props.initialIsFavorited,this.onLoadingFinished=()=>{console.log("UI root loading has finished"),this.setState({noMoreLoadingUpdates:!0}),this.props.scene.emit("loading_finished"),this.props.onLoaded&&this.props.onLoaded()},this.onSceneLoaded=()=>{console.log("UI root scene has loaded"),this.setState({sceneLoaded:!0})},this.onShareVideoEnabled=e=>{this.setState({videoShareMediaSource:e.detail.source})},this.onShareVideoDisabled=()=>{this.setState({videoShareMediaSource:null})},this.onShareVideoFailed=()=>{this.setState({showVideoShareFailed:!0})},this.shareVideo=e=>{this.props.scene.emit("action_share_".concat(e))},this.endShareVideo=()=>{this.props.scene.emit(T.b.VIDEO_SHARE_ENDED)},this.spawnPen=()=>{this.props.scene.emit("penButtonPressed")},this.onSubscribeChanged=Zy((function*(){t.props.subscriptions&&(yield t.props.subscriptions.toggle(),t.updateSubscribedState())})),this.handleForceEntry=()=>{console.log("Forced entry type: "+this.props.forcedVREntryType),this.props.forcedVREntryType&&(this.props.forcedVREntryType.startsWith("daydream")?this.enterDaydream():this.props.forcedVREntryType.startsWith("vr")?this.enterVR():this.props.forcedVREntryType.startsWith("2d")&&this.enter2D())},this.startAutoExitTimer=e=>{if(this.state.autoExitTimerInterval)return;const t=setInterval(()=>{let e=1/0;if(this.state.autoExitTimerStartedAt){const t=(new Date-this.state.autoExitTimerStartedAt)/1e3;e=Math.max(0,Math.floor(10-t))}this.setState({secondsRemainingBeforeAutoExit:e}),this.checkForAutoExit()},500);this.setState({autoExitTimerStartedAt:new Date,autoExitTimerInterval:t,autoExitReason:e})},this.checkForAutoExit=()=>{0===this.state.secondsRemainingBeforeAutoExit&&(this.endAutoExitTimer(),this.props.exitScene())},this.isWaitingForAutoExit=()=>this.state.secondsRemainingBeforeAutoExit<=10,this.endAutoExitTimer=()=>{clearInterval(this.state.autoExitTimerInterval),this.setState({autoExitTimerStartedAt:null,autoExitTimerInterval:null,autoExitReason:null,secondsRemainingBeforeAutoExit:1/0})},this.performDirectEntryFlow=function(){var e=Zy((function*(e){t.setState({enterInVR:e,waitingOnAudio:!0});(yield function(){return rE.apply(this,arguments)}()).length>0?(t.mediaDevicesManager.isMicShared||(yield t.mediaDevicesManager.startMicShare({})),t.beginOrSkipAudioSetup()):(t.onRequestMicPermission(),t.pushHistoryState("entry_step","audio")),t.setState({waitingOnAudio:!1})}));return function(t){return e.apply(this,arguments)}}(),this.enter2D=Zy((function*(){console.log("Entering in 2D mode"),yield t.performDirectEntryFlow(!1)})),this.enterVR=Zy((function*(){console.log("Entering in VR mode"),t.props.forcedVREntryType||t.props.availableVREntryTypes.generic!==er?yield t.performDirectEntryFlow(!0):t.showNonHistoriedDialog(iy)})),this.enterDaydream=Zy((function*(){console.log("Entering in Daydream mode"),yield t.performDirectEntryFlow(!0)})),this.onRequestMicPermission=Zy((function*(){yield t.mediaDevicesManager.startMicShare({})})),this.beginOrSkipAudioSetup=()=>{this.props.forcedVREntryType&&this.props.forcedVREntryType.endsWith("_now")?(console.log("Skipping audio setup (forcedVREntryType = ".concat(this.props.forcedVREntryType,")")),this.onAudioReadyButton()):(console.log("Starting audio setup"),this.pushHistoryState("entry_step","audio"))},this.shouldShowFullScreen=()=>(oE||AFRAME.utils.device.isMobileVR())&&!Object(u.b)()&&!this.state.enterInVR&&xa.a.enabled,this.onAudioReadyButton=Zy((function*(){t.state.enterInVR||(yield Object(_a.a)()),Object(Vi.a)(t.props.history);const e=t.props.store.state.preferences.muteMicOnEntry;yield t.props.enterScene(t.state.enterInVR,e),t.setState({entered:!0,entering:!1,showShareDialog:!1}),t.mediaDevicesManager.isMicShared&&console.log("Using microphone: ".concat(t.mediaDevicesManager.selectedMicLabel)),t.mediaDevicesManager.isVideoShared&&console.log("Screen sharing enabled.")})),this.attemptLink=Zy((function*(){t.pushHistoryState("entry_step","device");const{code:e,cancel:n,onFinished:a}=yield t.props.linkChannel.generateCode();t.setState({linkCode:e,linkCodeCancel:n}),a.then(()=>{t.setState({log:!1,linkCode:null,linkCodeCancel:null}),t.props.exitScene()})})),this.toggleShareDialog=Zy((function*(){t.props.store.update({activity:{hasOpenedShare:!0}}),t.setState({showShareDialog:!t.state.showShareDialog})})),this.closeDialog=()=>{this.state.dialog&&this.setState({dialog:null});const{onSignInDialogVisibilityChanged:e}=this.props;e&&e(!1),Ia()?ja():Object(_a.b)()},this.showNonHistoriedDialog=(e,t={})=>{const{onSignInDialogVisibilityChanged:n}=this.props;n&&n(!0),this.setState({dialog:Hi.a.createElement(e,Xy({onClose:this.closeDialog},t))})},this.toggleStreamerMode=()=>{const e=!this.state.isStreaming;this.props.scene.systems["hubs-systems"].characterController.fly=e,e?this.props.hubChannel.beginStreaming():this.props.hubChannel.endStreaming(),this.setState({isStreaming:e})},this.renderDialog=(e,t={})=>Hi.a.createElement(e,Xy({onClose:this.closeDialog},t)),this.signOut=Zy((function*(){yield t.props.authChannel.signOut(t.props.hubChannel),t.setState({signedIn:!1})})),this.onMiniInviteClicked=()=>{const e="https://".concat(a.a.SHORTLINK_DOMAIN,"/").concat(this.props.hub.hub_id);this.setState({miniInviteActivated:!0}),setTimeout(()=>{this.setState({miniInviteActivated:!1})},5e3),lr()?navigator.share({title:document.title,url:e}):Gi()(e)},this.sendMessage=e=>{this.props.onSendMessage(e)},this.occupantCount=()=>this.props.presences?Object.entries(this.props.presences).length:0,this.hasEmbedPresence=()=>{if(!this.props.presences)return!1;for(const e of Object.values(this.props.presences))for(const t of e.metas)if(t.context&&t.context.embed)return!0;return!1},this.onTweet=({detail:e})=>{Ra(!0,()=>{}).then(()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,()=>{this.showNonHistoriedDialog(Py,Xy({hubChannel:this.props.hubChannel,isAdmin:a.a.isAdmin()},e))},es.b.tweet)})},this.onChangeScene=()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{Object(_a.a)(),this.props.mediaSearchStore.sourceNavigateWithNoNav("scenes","use")},es.b.changeScene)},this.pushHistoryState=(e,t)=>Object(Vi.e)(this.props.history,e,t),this.onFocusChat=e=>{this.setSidebar("chat",{chatInputEffect:t=>{t.focus(),t.value=e.detail.prefix}})},this.renderInterstitialPrompt=()=>Hi.a.createElement("div",{className:ur.a.interstitial,onClick:()=>this.props.onInterstitialPromptClicked()},Hi.a.createElement("div",null,Hi.a.createElement(Yi.a,{id:"ui-root.interstitial-prompt",defaultMessage:"Continue"}))),this.renderBotMode=()=>Hi.a.createElement("div",{className:"loading-panel"},Hi.a.createElement("img",{className:"loading-panel__logo",src:a.a.image("logo")}),Hi.a.createElement("input",{type:"file",id:"bot-audio-input",accept:"audio/*"}),Hi.a.createElement("input",{type:"file",id:"bot-data-input",accept:"application/json"})),this.onEnteringCanceled=()=>{this.props.hubChannel.sendEnteringCancelledEvent(),this.setState({entering:!1})},this.renderEntryStartPanel=()=>{const{hasAcceptedProfile:e,hasChangedName:t}=this.props.store.state.activity,n=this.props.hubIsBound?!e:!t;return Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(bh,{roomName:this.props.hub.name,showJoinRoom:!this.state.waitingOnAudio&&!this.props.entryDisallowed,onJoinRoom:()=>{n||!this.props.forcedVREntryType?(this.setState({entering:!0}),this.props.hubChannel.sendEnteringEvent(),n?this.pushHistoryState("entry_step","profile"):(this.onRequestMicPermission(),this.pushHistoryState("entry_step","audio"))):this.handleForceEntry()},showEnterOnDevice:!this.state.waitingOnAudio&&!this.props.entryDisallowed&&!sE,onEnterOnDevice:()=>this.attemptLink(),showSpectate:!this.state.waitingOnAudio,onSpectate:()=>this.setState({watching:!0}),showOptions:this.props.hubChannel.canOrWillIfCreator("update_hub"),onOptions:()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>this.setSidebar("room-settings"),es.b.roomSettings)}}),!this.state.waitingOnAudio&&Hi.a.createElement(ps,{hubChannel:this.props.hubChannel,entering:this.state.entering,onEnteringCanceled:this.onEnteringCanceled}))},this.renderDevicePanel=()=>Hi.a.createElement(Sh,{shortUrl:a.a.SHORTLINK_DOMAIN,loadingCode:!this.state.linkCode,code:this.state.linkCode,headsetConnected:this.props.availableVREntryTypes.generic!==$i||this.props.availableVREntryTypes.cardboard!==$i,unsupportedBrowser:this.props.availableVREntryTypes.generic===er,onEnterOnConnectedHeadset:()=>{this.state.linkCodeCancel(),this.setState({linkCode:null,linkCodeCancel:null}),this.enterVR()},onBack:()=>{this.state.linkCodeCancel&&this.state.linkCodeCancel(),this.setState({linkCode:null,linkCodeCancel:null}),this.props.history.goBack()}}),this.renderAudioSetupPanel=()=>Hi.a.createElement(rp,{scene:this.props.scene,onEnterRoom:this.onAudioReadyButton,onBack:()=>this.props.history.goBack()}),this.isInModalOrOverlay=()=>!(!this.state.entered||!eE.find(e=>Object(Vi.g)(this.props.history.location).startsWith(e))&&!tE.find(e=>new URLSearchParams(this.props.history.location.search).get(e)))||(!(this.state.entered||!nE.find(e=>Object(Vi.g)(this.props.history.location).startsWith(e))&&!aE.find((e,t)=>new URLSearchParams(this.props.history.location.search).get(e)===iE[t]))||(!(!this.state.objectInfo||!this.state.objectInfo.object3D)||(null!==this.state.sidebarId||!!(this.props.history&&this.props.history.location.state&&(this.props.history.location.state.modal||this.props.history.location.state.overlay)||this.state.dialog)))),e.mediaSearchStore.setHistory(e.history),this.exitEventHandler=()=>this.props.exitScene(),this.mediaDevicesManager=APP.mediaDevicesManager}componentDidUpdate(e){const{hubChannel:t,showSignInDialog:n}=this.props;if(t){const{signedIn:e}=t;e!==this.state.signedIn&&this.setState({signedIn:e})}if(e.showSignInDialog!==n&&(n?this.showContextualSignInDialog():this.closeDialog()),!this.willCompileAndUploadMaterials&&this.state.noMoreLoadingUpdates&&(this.willCompileAndUploadMaterials=!0,window.requestAnimationFrame(()=>{window.setTimeout(()=>{if(!this.props.isBotMode)try{this.props.scene.renderer.compile(this.props.scene.object3D,this.props.scene.camera),this.props.scene.object3D.traverse(e=>{if(!e.material)return;const t=Array.isArray(e.material)?e.material:[e.material];for(const e of t)for(const t in e)e[t]&&e[t].isTexture&&this.props.scene.renderer.initTexture(e[t])})}catch(e){console.error(e),this.props.exitScene(ey.sceneError)}this.state.hideLoader||this.setState({hideLoader:!0})},0)})),!this.props.selectedObject||!e.selectedObject){const e=this.props.scene;this.props.selectedObject?e.classList.add(Uu.a.sceneSmFullScreen):e.classList.remove(Uu.a.sceneSmFullScreen)}this.state.presenceCount!=this.occupantCount()&&this.setState({presenceCount:this.occupantCount()})}componentDidMount(){window.addEventListener("concurrentload",this.onConcurrentLoad),window.addEventListener("idle_detected",this.onIdleDetected),window.addEventListener("activity_detected",this.onActivityDetected),window.addEventListener("focus_chat",this.onFocusChat),document.querySelector(".a-canvas").addEventListener("mouseup",()=>{this.state.showShareDialog&&this.setState({showShareDialog:!1})}),this.props.scene.addEventListener("loaded",this.onSceneLoaded),this.props.scene.addEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.addEventListener("share_video_disabled",this.onShareVideoDisabled),this.props.scene.addEventListener("share_video_failed",this.onShareVideoFailed),this.props.scene.addEventListener("exit",this.exitEventHandler),this.props.scene.addEventListener("action_exit_watch",()=>{this.state.hide?this.setState({hide:!1,hideUITip:!1}):this.setState({watching:!1})}),this.props.scene.addEventListener("action_toggle_ui",()=>this.setState({hide:!this.state.hide,hideUITip:!1})),this.props.scene.addEventListener("devicechange",()=>{this.forceUpdate()});const e=this.props.scene,t=this.props.history.listen((e,n)=>{const a=e.state;if("POP"===n&&a&&a.entry_step&&this.state.entered)return t(),void Object(Vi.b)(this.props.history)});this.props.history.location.state&&!Object(Vi.g)(this.props.history.location).startsWith("/media")&&Object(Vi.c)(this.props.history),this.setState({audioContext:{playSound:t=>{e.emit(t)},onMouseLeave:()=>{}}}),this.props.forcedVREntryType&&this.props.forcedVREntryType.endsWith("_now")&&this.props.scene.addEventListener("loading_finished",()=>{console.log("Loading has finished. Checking for forced room entry"),setTimeout(()=>this.handleForceEntry(),1e3)},{once:!0}),this.playerRig=e.querySelector("#avatar-rig"),e.addEventListener("action_media_tweet",this.onTweet)}UNSAFE_componentWillMount(){this.props.store.addEventListener("statechanged",this.storeUpdated)}componentWillUnmount(){this.props.scene.removeEventListener("loaded",this.onSceneLoaded),this.props.scene.removeEventListener("exit",this.exitEventHandler),this.props.scene.removeEventListener("share_video_enabled",this.onShareVideoEnabled),this.props.scene.removeEventListener("share_video_disabled",this.onShareVideoDisabled),this.props.scene.removeEventListener("share_video_failed",this.onShareVideoFailed),this.props.scene.removeEventListener("action_media_tweet",this.onTweet),this.props.store.removeEventListener("statechanged",this.storeUpdated),window.removeEventListener("concurrentload",this.onConcurrentLoad),window.removeEventListener("idle_detected",this.onIdleDetected),window.removeEventListener("activity_detected",this.onActivityDetected),window.removeEventListener("focus_chat",this.onFocusChat)}setSidebar(e,t){this.setState(Xy({sidebarId:e,chatInputEffect:()=>{},selectedUserId:null},t))}toggleSidebar(e,t){this.setState(({sidebarId:n})=>Xy({sidebarId:n===e?null:e,selectedUserId:null},t))}getSelectedUser(){const e=this.state.selectedUserId;return Gf(e,this.props.presences[e],yr(),this.props.sessionId)}render(){var e=this;const t=a.a.feature("enable_lobby_ghosts")&&(this.state.watching||this.state.hide||this.props.hide),n=this.state.hide||this.props.hide,i={[ur.a.ui]:!0,"ui-root":!0,"in-modal-or-overlay":this.isInModalOrOverlay(),isGhost:t,hide:n};if(this.props.hide||this.state.hide)return Hi.a.createElement("div",{className:Wi()(i)},Hi.a.createElement(eh,{scene:this.props.scene,store:this.props.store,viewport:!this.state.hideUITip&&Hi.a.createElement(zy,{onDismiss:()=>this.setState({hideUITip:!0})})}));if(this.props.showSafariMicDialog)return Hi.a.createElement("div",{className:Wi()(i)},Hi.a.createElement(eh,{scene:this.props.scene,store:this.props.store,modal:Hi.a.createElement(pb,null)}));const r=this.props.showPreload,o=!r&&!this.state.hideLoader;if(o&&this.state.showPrefs)return Hi.a.createElement("div",null,Hi.a.createElement(Vu,{scene:this.props.scene,onLoaded:this.onLoadingFinished}),Hi.a.createElement(Hl,{onClose:()=>{this.setState({showPrefs:!1})},store:this.props.store,scene:this.props.scene}));if(this.props.isBotMode)return this.renderBotMode();if(o)return Hi.a.createElement(Vu,{scene:this.props.scene,onLoaded:this.onLoadingFinished});if(this.state.showPrefs)return Hi.a.createElement(Hl,{onClose:()=>{this.setState({showPrefs:!1})},store:this.props.store,scene:this.props.scene});if(this.props.showInterstitialPrompt)return this.renderInterstitialPrompt();const s=this.state.entered,l=this.state.watching,c=s||l,d=this.props.store.state.preferences.showRtcDebugPanel,u=this.props.store.state.preferences.showAudioDebugPanel,h=this.props.hubIsBound?Object(m.i)(this.props.presences,this.props.sessionId).displayName:null,p=a.a.feature("enable_lobby_ghosts")&&t&&!n&&this.props.availableVREntryTypes.generic!==$i,f=this.props.availableVREntryTypes&&!r&&(this.isWaitingForAutoExit()?Hi.a.createElement($b,{reason:this.state.autoExitReason,secondsRemaining:this.state.secondsRemainingBeforeAutoExit,onCancel:this.endAutoExitTimer}):Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(br,{stateKey:"entry_step",stateValue:"device",history:this.props.history},this.renderDevicePanel()),Hi.a.createElement(br,{stateKey:"entry_step",stateValue:"audio",history:this.props.history},this.renderAudioSetupPanel()),Hi.a.createElement(br,{stateKey:"entry_step",stateValue:"profile",history:this.props.history,render:e=>Hi.a.createElement(Qr,Ky({},e,{containerType:"modal",displayNameOverride:h,finished:()=>{this.props.forcedVREntryType?(this.pushHistoryState(),this.handleForceEntry()):(this.onRequestMicPermission(),this.pushHistoryState("entry_step","audio"))},showBackButton:!0,onBack:()=>this.pushHistoryState(),store:this.props.store,mediaSearchStore:this.props.mediaSearchStore,avatarId:e.location.state.detail&&e.location.state.detail.avatarId}))}),Hi.a.createElement(br,{stateKey:"entry_step",stateValue:"",history:this.props.history},this.renderEntryStartPanel()))),g=this.props.presenceLogEntries||[],v=this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location),b=v&&(["scenes","avatars","favorites"].includes(v)||this.state.entered),y=this.state.isStreaming,E=c,w=Object(rt.b)(),_=w&&w.displayName,S=!c&&this.props.hub||this.isWaitingForAutoExit(),x=!a.a.feature("disable_room_creation")||a.a.isAdmin(),A=this.props.hubChannel&&!!this.props.hubChannel.canOrWillIfCreator("close_hub"),M=this.props.hubChannel&&this.props.hubChannel.canOrWillIfCreator("kick_users")&&!sE,k=[{id:"user",label:this.state.signedIn?Hi.a.createElement(Yi.a,{id:"more-menu.you-signed-in-as",defaultMessage:"Signed in as: {email}",values:{email:Object(Cu.a)(this.props.store.state.credentials.email)}}):Hi.a.createElement(Yi.a,{id:"more-menu.not-signed-in",defaultMessage:"You are not signed in"}),items:[this.state.signedIn?{id:"sign-out",label:Hi.a.createElement(Yi.a,{id:"more-menu.sign-out",defaultMessage:"Sign Out"}),icon:tf,onClick:(O=Zy((function*(){yield e.props.authChannel.signOut(e.props.hubChannel),e.setState({signedIn:!1})})),function(){return O.apply(this,arguments)})}:{id:"sign-in",label:Hi.a.createElement(Yi.a,{id:"more-menu.sign-in",defaultMessage:"Sign In"}),icon:ih,onClick:()=>this.showContextualSignInDialog()},x&&{id:"create-room",label:Hi.a.createElement(Yi.a,{id:"more-menu.create-room",defaultMessage:"Create Room"}),icon:Am.a,onClick:()=>this.showNonHistoriedDialog(Eb,{destinationUrl:"/",reason:vb})},{id:"user-profile",label:Hi.a.createElement(Yi.a,{id:"more-menu.profile",defaultMessage:"Change Name & Avatar"}),icon:xm,onClick:()=>this.setSidebar("profile")},{id:"favorite-rooms",label:Hi.a.createElement(Yi.a,{id:"more-menu.favorite-rooms",defaultMessage:"Favorite Rooms"}),icon:Rm,onClick:()=>this.props.performConditionalSignIn(()=>this.props.hubChannel.signedIn,()=>{Object(_a.a)(),this.props.mediaSearchStore.sourceNavigateWithNoNav("favorites","use")},es.b.favoriteRooms)},{id:"preferences",label:Hi.a.createElement(Yi.a,{id:"more-menu.preferences",defaultMessage:"Preferences"}),icon:ph,onClick:()=>this.setState({showPrefs:!0})}].filter(e=>e)},{id:"room",label:Hi.a.createElement(Yi.a,{id:"more-menu.room",defaultMessage:"Room"}),items:[{id:"room-info",label:Hi.a.createElement(Yi.a,{id:"more-menu.room-info",defaultMessage:"Room Info and Settings"}),icon:Vm,onClick:()=>this.setSidebar("room-info")},("sm"===this.props.breakpoint||"md"===this.props.breakpoint)&&("invite"!==this.props.hub.entry_mode||this.props.hubChannel.can("update_hub"))&&{id:"invite",label:Hi.a.createElement(Yi.a,{id:"more-menu.invite",defaultMessage:"Invite"}),icon:bp,onClick:()=>this.props.scene.emit("action_invite")},this.isFavorited()?{id:"unfavorite-room",label:Hi.a.createElement(Yi.a,{id:"more-menu.unfavorite-room",defaultMessage:"Unfavorite Room"}),icon:Co.a,onClick:()=>this.toggleFavorited()}:{id:"favorite-room",label:Hi.a.createElement(Yi.a,{id:"more-menu.favorite-room",defaultMessage:"Favorite Room"}),icon:Dm,onClick:()=>this.toggleFavorited()},M&&s&&{id:"streamer-mode",label:y?Hi.a.createElement(Yi.a,{id:"more-menu.exit-streamer-mode",defaultMessage:"Exit Streamer Mode"}):Hi.a.createElement(Yi.a,{id:"more-menu.enter-streamer-mode",defaultMessage:"Enter Streamer Mode"}),icon:bm,onClick:()=>this.toggleStreamerMode()},("sm"===this.props.breakpoint||"md"===this.props.breakpoint)&&s&&{id:"leave-room",label:Hi.a.createElement(Yi.a,{id:"more-menu.enter-leave-room",defaultMessage:"Leave Room"}),icon:tf,onClick:()=>{this.showNonHistoriedDialog(Eb,{destinationUrl:"/",reason:fb})}},A&&{id:"close-room",label:Hi.a.createElement(Yi.a,{id:"more-menu.close-room",defaultMessage:"Close Room"}),icon:Om,onClick:()=>this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>{this.showNonHistoriedDialog(ay,{roomName:this.props.hub.name,onConfirm:()=>{this.props.hubChannel.closeHub()}})},es.b.closeRoom)}].filter(e=>e)},{id:"support",label:Hi.a.createElement(Yi.a,{id:"more-menu.support",defaultMessage:"Support"}),items:[a.a.feature("show_community_link")&&{id:"community",label:Hi.a.createElement(Yi.a,{id:"more-menu.community",defaultMessage:"Community"}),icon:Zm,href:a.a.link("community","https://discord.gg/dFJncWwHun")},a.a.feature("show_issue_report_link")&&{id:"report-issue",label:Hi.a.createElement(Yi.a,{id:"more-menu.report-issue",defaultMessage:"Report Issue"}),icon:Hm,href:a.a.link("issue_report","https://hubs.mozilla.com/docs/help.html")},s&&{id:"start-tour",label:Hi.a.createElement(Yi.a,{id:"more-menu.start-tour",defaultMessage:"Start Tour"}),icon:Gm,onClick:()=>this.props.scene.systems.tips.resetTips()},a.a.feature("show_docs_link")&&{id:"help",label:Hi.a.createElement(Yi.a,{id:"more-menu.help",defaultMessage:"Help"}),icon:Gm,href:a.a.link("docs","https://hubs.mozilla.com/docs")},a.a.feature("show_controls_link")&&{id:"controls",label:Hi.a.createElement(Yi.a,{id:"more-menu.controls",defaultMessage:"Controls"}),icon:Gm,href:a.a.link("controls","https://hubs.mozilla.com/docs/hubs-controls.html")},a.a.feature("show_whats_new_link")&&{id:"whats-new",label:Hi.a.createElement(Yi.a,{id:"more-menu.whats-new",defaultMessage:"What's New"}),icon:Gm,href:"/whats-new"},a.a.feature("show_terms")&&{id:"tos",label:Hi.a.createElement(Yi.a,{id:"more-menu.tos",defaultMessage:"Terms of Service"}),icon:zm,href:a.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md")},a.a.feature("show_privacy")&&{id:"privacy",label:Hi.a.createElement(Yi.a,{id:"more-menu.privacy",defaultMessage:"Privacy Notice"}),icon:Xm,href:a.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md")}].filter(e=>e)}];var O;return Hi.a.createElement(zp,null,Hi.a.createElement(mr.Provider,{value:this.state.audioContext},Hi.a.createElement("div",{className:Wi()(i)},r&&this.props.hub&&Hi.a.createElement(wd,{hubName:this.props.hub.name,hubScene:this.props.hub.scene,baseUrl:Object(m.n)(this.props.hub.hub_id).href,onLoadClicked:this.props.onPreloadLoadClicked}),!this.state.dialog&&Hi.a.createElement(br,{stateKey:"overlay",stateValue:"avatar-editor",history:this.props.history,render:e=>Hi.a.createElement(Is,{className:ur.a.avatarEditor,signedIn:this.state.signedIn,onSignIn:this.showContextualSignInDialog,onSave:()=>{e.location.state.detail&&e.location.state.detail.returnToProfile?this.props.history.goBack():(this.props.history.goBack(),this.props.mediaSearchStore.sourceNavigateWithNoNav("avatars","use")),this.props.onAvatarSaved()},onClose:()=>this.props.history.goBack(),store:this.props.store,debug:$y,avatarId:e.location.state.detail&&e.location.state.detail.avatarId,hideDelete:e.location.state.detail&&e.location.state.detail.hideDelete})}),!this.state.dialog&&b&&Hi.a.createElement(hs,{history:this.props.history,mediaSearchStore:this.props.mediaSearchStore,hubChannel:this.props.hubChannel,onMediaSearchResultEntrySelected:(e,t)=>{"room"===e.type?this.showNonHistoriedDialog(Eb,{destinationUrl:e.url,reason:gb}):this.props.onMediaSearchResultEntrySelected(e,t)},performConditionalSignIn:this.props.performConditionalSignIn,showNonHistoriedDialog:this.showNonHistoriedDialog,store:this.props.store,scene:this.props.scene}),this.props.hub&&Hi.a.createElement(eh,{scene:this.props.scene,store:this.props.store,objectFocused:!!this.props.selectedObject,streaming:y,viewport:Hi.a.createElement(Hi.a.Fragment,null,!this.state.dialog&&S?f:void 0,!this.props.selectedObject&&Hi.a.createElement(Gp,null),(!this.props.selectedObject||"sm"!==this.props.breakpoint&&"md"!==this.props.breakpoint)&&Hi.a.createElement(fm,null,E&&Hi.a.createElement(pm,{active:"objects"===this.state.sidebarId,onClick:()=>this.toggleSidebar("objects")}),Hi.a.createElement(mm,{active:"people"===this.state.sidebarId,onClick:()=>this.toggleSidebar("people"),presencecount:this.state.presenceCount})),!s&&!y&&!oE&&_&&Hi.a.createElement(Yy,{name:_}),this.props.activeObject&&Hi.a.createElement(ov,{hubChannel:this.props.hubChannel,scene:this.props.scene,onOpenProfile:()=>this.setSidebar("profile"),onGoToObject:()=>{"sm"===this.props.breakpoint&&this.setSidebar(null)}}),"chat"!==this.state.sidebarId&&this.props.hub&&Hi.a.createElement(vd,{inRoom:!0,presences:this.props.presences,entries:g,hubId:this.props.hub.hub_id,history:this.props.history,onViewProfile:e=>this.setSidebar("user",{selectedUserId:e})}),Hi.a.createElement(Wy,{hide:this.props.activeObject,inLobby:l,inRoom:s,isEmbedded:this.props.embed,isStreaming:y,hubId:this.props.hub.hub_id,presences:this.props.presences,scene:this.props.scene,store:this.props.store}),(d||u)&&Hi.a.createElement(Ou,{history:this.props.history,store:window.APP.store,scene:this.props.scene,presences:this.props.presences,sessionId:this.props.sessionId,showRtcDebug:d,showAudioDebug:u})),sidebar:this.state.sidebarId?Hi.a.createElement(Hi.a.Fragment,null,"chat"===this.state.sidebarId&&Hi.a.createElement(tm,{presences:this.props.presences,occupantCount:this.occupantCount(),canSpawnMessages:s&&this.props.hubChannel.can("spawn_and_move_media"),scene:this.props.scene,onClose:()=>this.setSidebar(null),inputEffect:this.state.chatInputEffect}),"objects"===this.state.sidebarId&&Hi.a.createElement(Tg,{hubChannel:this.props.hubChannel,onClose:()=>this.setSidebar(null)}),"people"===this.state.sidebarId&&Hi.a.createElement(Kf,{displayNameOverride:h,store:this.props.store,mediaSearchStore:this.props.mediaSearchStore,hubChannel:this.props.hubChannel,history:this.props.history,mySessionId:this.props.sessionId,presences:this.props.presences,onClose:()=>this.setSidebar(null),onCloseDialog:()=>this.closeDialog(),showNonHistoriedDialog:this.showNonHistoriedDialog,performConditionalSignIn:this.props.performConditionalSignIn}),"profile"===this.state.sidebarId&&Hi.a.createElement(Qr,{history:this.props.history,containerType:"sidebar",displayNameOverride:h,finished:()=>this.setSidebar(null),onClose:()=>this.setSidebar(null),store:this.props.store,mediaSearchStore:this.props.mediaSearchStore}),"user"===this.state.sidebarId&&Hi.a.createElement(Wf,{user:this.getSelectedUser(),hubChannel:this.props.hubChannel,performConditionalSignIn:this.props.performConditionalSignIn,onClose:()=>this.setSidebar(null),onCloseDialog:()=>this.closeDialog(),showNonHistoriedDialog:this.showNonHistoriedDialog}),"room-info"===this.state.sidebarId&&Hi.a.createElement(Ab,{accountId:this.props.sessionId,room:this.props.hub,canEdit:this.props.hubChannel.canOrWillIfCreator("update_hub"),onEdit:()=>{this.props.performConditionalSignIn(()=>this.props.hubChannel.can("update_hub"),()=>this.setSidebar("room-info-settings"),es.b.roomSettings)},onClose:()=>this.setSidebar(null),onChangeScene:this.onChangeScene}),"room-info-settings"===this.state.sidebarId&&Hi.a.createElement(Xb,{room:this.props.hub,hubChannel:this.props.hubChannel,showBackButton:!0,onClose:()=>this.setSidebar("room-info"),onChangeScene:this.onChangeScene}),"room-settings"===this.state.sidebarId&&Hi.a.createElement(Xb,{room:this.props.hub,accountId:this.props.sessionId,hubChannel:this.props.hubChannel,onClose:()=>this.setSidebar(null),onChangeScene:this.onChangeScene})):void 0,modal:this.state.dialog,toolbarLeft:Hi.a.createElement(Rp,{hub:this.props.hub,hubChannel:this.props.hubChannel,scene:this.props.scene}),toolbarCenter:Hi.a.createElement(Hi.a.Fragment,null,l&&Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(cc,{icon:Hi.a.createElement(ih,null),label:Hi.a.createElement(Yi.a,{id:"toolbar.join-room-button",defaultMessage:"Join Room"}),preset:"accept",onClick:()=>this.setState({watching:!1})}),p&&Hi.a.createElement(cc,{icon:Hi.a.createElement(sh,null),preset:"accent5",label:Hi.a.createElement(Yi.a,{id:"toolbar.spectate-in-vr-button",defaultMessage:"Spectate in VR"}),onClick:()=>this.props.scene.enterVR()})),s&&Hi.a.createElement(Hi.a.Fragment,null,Hi.a.createElement(Gv,{scene:this.props.scene}),Hi.a.createElement(Ov,{scene:this.props.scene,hubChannel:this.props.hubChannel}),Hi.a.createElement(Ev,{scene:this.props.scene,hubChannel:this.props.hubChannel,mediaSearchStore:this.props.mediaSearchStore,showNonHistoriedDialog:this.showNonHistoriedDialog}),this.props.hubChannel.can("spawn_emoji")&&Hi.a.createElement(hb,{scene:this.props.scene,initialPresence:Object(m.i)(this.props.presences,this.props.sessionId)})),Hi.a.createElement(nm,{onClick:()=>this.toggleSidebar("chat")}),s&&sE&&Hi.a.createElement(cc,{className:pr.a.hideLg,icon:Hi.a.createElement(sh,null),preset:"accept",label:Hi.a.createElement(Yi.a,{id:"toolbar.enter-vr-button",defaultMessage:"Enter VR"}),onClick:()=>ja(!0)})),toolbarRight:Hi.a.createElement(Hi.a.Fragment,null,s&&sE&&Hi.a.createElement(cc,{icon:Hi.a.createElement(sh,null),preset:"accept",label:Hi.a.createElement(Yi.a,{id:"toolbar.enter-vr-button",defaultMessage:"Enter VR"}),onClick:()=>ja(!0)}),s&&Hi.a.createElement(cc,{icon:Hi.a.createElement(tf,null),label:Hi.a.createElement(Yi.a,{id:"toolbar.leave-room-button",defaultMessage:"Leave"}),preset:"cancel",onClick:()=>{this.showNonHistoriedDialog(Eb,{destinationUrl:"/",reason:fb})}}),Hi.a.createElement(qp,{menu:k}))}))))}}function cE(e){Object(th.a)();const t=Object(pc.useCssBreakpoints)();return Object(Li.useEffect)(()=>{const t=document.getElementById("preload-overlay");t.classList.add("loaded");const n=e.scene;n.classList.add(Uu.a.scene);const a=setTimeout(()=>{t.remove()},500);return()=>{clearTimeout(a),n.classList.remove(Uu.a.scene)}},[e.scene]),Hi.a.createElement(em,{messageDispatch:e.messageDispatch},Hi.a.createElement(dg,{scene:e.scene},Hi.a.createElement(lE,Ky({breakpoint:t},e))))}lE.propTypes={enterScene:Ui.a.func,exitScene:Ui.a.func,onSendMessage:Ui.a.func,disableAutoExitOnIdle:Ui.a.bool,forcedVREntryType:Ui.a.string,isBotMode:Ui.a.bool,store:Ui.a.object,mediaSearchStore:Ui.a.object,scene:Ui.a.object,authChannel:Ui.a.object,hubChannel:Ui.a.object,linkChannel:Ui.a.object,hub:Ui.a.object,availableVREntryTypes:Ui.a.object,checkingForDeviceAvailability:Ui.a.bool,environmentSceneLoaded:Ui.a.bool,entryDisallowed:Ui.a.bool,roomUnavailableReason:Ui.a.string,hubIsBound:Ui.a.bool,isSupportAvailable:Ui.a.bool,presenceLogEntries:Ui.a.array,presences:Ui.a.object,sessionId:Ui.a.string,subscriptions:Ui.a.object,initialIsFavorited:Ui.a.bool,showSignInDialog:Ui.a.bool,signInMessage:Ui.a.string,onContinueAfterSignIn:Ui.a.func,onSignInDialogVisibilityChanged:Ui.a.func,showSafariMicDialog:Ui.a.bool,onMediaSearchResultEntrySelected:Ui.a.func,onAvatarSaved:Ui.a.func,location:Ui.a.object,history:Ui.a.object,showInterstitialPrompt:Ui.a.bool,onInterstitialPromptClicked:Ui.a.func,performConditionalSignIn:Ui.a.func,hide:Ui.a.bool,showPreload:Ui.a.bool,onPreloadLoadClicked:Ui.a.func,embed:Ui.a.bool,embedToken:Ui.a.string,onLoaded:Ui.a.func,activeObject:Ui.a.object,selectedObject:Ui.a.object,breakpoint:Ui.a.string},cE.propTypes={scene:Ui.a.object.isRequired,messageDispatch:Ui.a.object,store:Ui.a.object.isRequired};var dE=cE;function uE({reason:e}){return Hi.a.createElement(ny,{showTerms:a.a.feature("show_terms"),termsUrl:a.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md"),showSourceLink:a.a.feature("show_source_link"),reason:e,contactEmail:a.a.translation("contact-email")})}uE.propTypes={reason:Ui.a.string.isRequired};var hE=n(91),pE=n(34),mE=n.n(pE),fE=n(70);function gE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vE(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function bE(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){vE(r,a,i,o,s,"next",e)}function s(e){vE(r,a,i,o,s,"throw",e)}o(void 0)}))}}function yE(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()}const EE=["update_hub","update_hub_promotion","update_roles","close_hub","mute_users","kick_users","amplify_audio"],wE=EE.concat(["tweet","spawn_camera","spawn_drawing","spawn_and_move_media","pin_objects","spawn_emoji","fly"]);class _E extends fE.a{constructor(e,t){var n;super(),n=this,this.setPermissionsFromToken=e=>{this.token=e,this._permissions=mE()(e),a.a.setIsAdmin("ret_admin"===this._permissions.postgrest_role),this.dispatchEvent(new CustomEvent("permissions_updated"));const t=new Date(1e3*this._permissions.exp-6e4)-new Date;this.fetchPermissionsTimeout&&clearTimeout(this.fetchPermissionsTimeout),this.fetchPermissionsTimeout=setTimeout(this.fetchPermissions,t)},this.sendEnteringEvent=bE((function*(){n.channel.push("events:entering",{})})),this.sendEnteringCancelledEvent=bE((function*(){n.channel.push("events:entering_cancelled",{})})),this.sendEnteredEvent=bE((function*(){if(!n.channel)return void console.warn("No phoenix channel initialized before room entry.");let e="Screen";if(navigator.getVRDisplays){const t=(yield navigator.getVRDisplays()).find(e=>e.isPresenting);t&&(e=t.displayName)}const t=n.presence.list((e,t)=>({key:e,entryState:t.metas[t.metas.length-1].presence})).filter(({key:e,entryState:t})=>e!==NAF.clientId&&"room"===t).length,a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){gE(e,t,n[t])}))}return e}({},n.getEntryTimingFlags(),{initialOccupantCount:t,entryDisplayType:e,userAgent:navigator.userAgent});n.channel.push("events:entered",a)})),this.getEntryTimingFlags=()=>{const e={isNewDaily:!0,isNewMonthly:!0,isNewDayWindow:!0,isNewMonthWindow:!0},t=this.store.state.activity.lastEnteredAt;if(!t)return e;const n=new Date,a=new Date(t),i=n-a;var r,o;return e.isNewDaily=!(yE(r=n,o=a)&&r.getDate()==o.getDate()),e.isNewMonthly=!yE(n,a),e.isNewDayWindow=i>864e5,e.isNewMonthWindow=i>2592e6,e},this.sendObjectSpawnedEvent=e=>{if(!this.channel)return void console.warn("No phoenix channel initialized before object spawn.");const t={object_type:e};this.channel.push("events:object_spawned",t)},this.sendProfileUpdate=()=>{this.channel.push("events:profile_updated",{profile:this.store.state.profile})},this.updateScene=e=>{if(!this._permissions.update_hub)return"unauthorized";this.channel.push("update_scene",{url:e})},this.updateHub=e=>{if(!this._permissions.update_hub)return"unauthorized";this.channel.push("update_hub",e)},this.fetchInvite=()=>new Promise(e=>this.channel.push("fetch_invite",{}).receive("ok",e)),this.revokeInvite=e=>new Promise(t=>this.channel.push("revoke_invite",{hub_invite_id:e}).receive("ok",t)),this.closeHub=()=>{if(!this._permissions.close_hub)return"unauthorized";this.channel.push("close_hub",{})},this.subscribe=e=>{this.channel.push("subscribe",{subscription:e})},this.allowNAFTraffic=e=>{this.channel.push(e?"unblock_naf":"block_naf",{})},this.unsubscribe=e=>new Promise(t=>this.channel.push("unsubscribe",{subscription:e}).receive("ok",t)),this.sendMessage=(e,t="chat")=>{e&&this.channel.push("message",{body:e,type:t})},this._getCreatorAssignmentToken=()=>{const e=this.store.state.creatorAssignmentTokens&&this.store.state.creatorAssignmentTokens.find(e=>e.hubId===this.hubId);return e&&e.creatorAssignmentToken},this.signIn=e=>new Promise((t,n)=>{const a=this._getCreatorAssignmentToken();this.channel.push("sign_in",{token:e,creator_assignment_token:a}).receive("ok",({perms_token:e})=>{this.setPermissionsFromToken(e),this._signedIn=!0,t()}).receive("error",e=>{"invalid_token"===e.reason?(console.warn("sign in failed",e),t()):(console.error("sign in failed",e),n())})}),this.signOut=()=>new Promise((e,t)=>{this.channel.push("sign_out").receive("ok",bE((function*(){n._signedIn=!1;const t=n.channel.params();delete t.auth_token,delete t.perms_token,yield n.fetchPermissions(),e()}))).receive("error",t)}),this.getHost=()=>new Promise((e,t)=>{this.channel.push("get_host").receive("ok",t=>{e(t)}).receive("error",t)}),this.getTwitterOAuthURL=()=>new Promise((e,t)=>{this.channel.push("oauth",{type:"twitter"}).receive("ok",t=>{e(t.oauth_url)}).receive("error",e=>t(new Error(e.reason)))}),this.discordBridges=()=>this.presence&&this.presence.state?Object(m.d)(this.presence.state):[],this.pin=(e,t,n,a,i)=>{const r={id:e,gltf_node:t};return n&&i&&(r.file_id=n,r.file_access_token=a,r.promotion_token=i),new Promise((e,t)=>{this.channel.push("pin",r).receive("ok",e).receive("error",t)})},this.unpin=(e,t)=>{const n={id:e};t&&(n.file_id=t),this.channel.push("unpin",n)},this.fetchPermissions=()=>new Promise((e,t)=>{this.channel.push("refresh_perms_token").receive("ok",t=>{this.setPermissionsFromToken(t.perms_token),e({permsToken:t.perms_token,permissions:this._permissions})}).receive("error",t)}),this.mute=e=>this.channel.push("mute",{session_id:e}),this.addOwner=e=>this.channel.push("add_owner",{session_id:e}),this.removeOwner=e=>this.channel.push("remove_owner",{session_id:e}),this.hide=e=>{NAF.connection.adapter.block(e),APP.dialog.block(e),this.channel.push("block",{session_id:e}),this._blockedSessionIds.add(e)},this.unhide=e=>{this._blockedSessionIds.has(e)&&(NAF.connection.adapter.unblock(e),APP.dialog.unblock(e),NAF.connection.entities.completeSync(e),this.channel.push("unblock",{session_id:e}),this._blockedSessionIds.delete(e))},this.isHidden=e=>this._blockedSessionIds.has(e),this.kick=function(){var e=bE((function*(e){APP.dialog.kick(e),n.channel.push("kick",{session_id:e})}));return function(t){return e.apply(this,arguments)}}(),this.requestSupport=()=>this.channel.push("events:request_support",{}),this.favorite=()=>this.channel.push("favorite",{}),this.unfavorite=()=>this.channel.push("unfavorite",{}),this.disconnect=()=>{this.channel&&this.channel.socket.disconnect()},this.store=e,this.hubId=t,this._signedIn=!!this.store.state.credentials.token,this._permissions={},this._blockedSessionIds=new Set,e.addEventListener("profilechanged",this.sendProfileUpdate.bind(this))}get signedIn(){return this._signedIn}can(e){if(!wE.includes(e))throw new Error("Invalid permission name: ".concat(e));return this._permissions&&this._permissions[e]}canOrWillIfCreator(e){return!(!this._getCreatorAssignmentToken()||!EE.includes(e))||this.can(e)}canEnterRoom(e){if(!e)return!1;if(this.canOrWillIfCreator("update_hub"))return!0;return Object.values(this.presence.state).reduce((e,{metas:t})=>{const n=t[t.length-1];return e+("room"===n.presence||n.context&&n.context.entering?1:0)},0)<(void 0!==e.room_size?e.room_size:24)}migrateToSocket(e,t){var n=this;return bE((function*(){let a;n.presence&&(a={onJoin:n.presence.caller.onJoin,onLeave:n.presence.caller.onLeave,onSync:n.presence.caller.onSync},n.presence.onJoin((function(){})),n.presence.onLeave((function(){})),n.presence.onSync((function(){}))),n.channel=yield Object(m.o)(n.channel,e,t),n.presence=new f.a(n.channel),a&&(n.presence.onJoin(a.onJoin),n.presence.onLeave(a.onLeave),n.presence.onSync(a.onSync))}))()}migrateToHub(e){var t=this;return bE((function*(){let n;const a=t.channel.socket.channel("hub:".concat(e),APP.hubChannelParamsForPermsToken()),i=yield Object(m.p)(t.channel,a);return t.presence&&(n={onJoin:t.presence.caller.onJoin,onLeave:t.presence.caller.onLeave,onSync:t.presence.caller.onSync},t.presence.onJoin((function(){})),t.presence.onLeave((function(){})),t.presence.onSync((function(){}))),t.channel=a,t.presence=new f.a(t.channel),t.hubId=i.hubs[0].hub_id,t.setPermissionsFromToken(i.perms_token),n&&(t.presence.onJoin(n.onJoin),t.presence.onLeave(n.onLeave),t.presence.onSync(n.onSync)),i}))()}beginStreaming(){this.channel.push("events:begin_streaming",{})}endStreaming(){this.channel.push("events:end_streaming",{})}beginRecording(){this.channel.push("events:begin_recording",{})}endRecording(){this.channel.push("events:end_recording",{})}raiseHand(){this.channel.push("events:raise_hand",{})}lowerHand(){this.channel.push("events:lower_hand",{})}beginTyping(){this.channel.push("events:begin_typing",{})}endTyping(){this.channel.push("events:end_typing",{})}}var SE=n(429),xE=n(227);function AE(e,t){const n=t.boundingData,a=(n[3]-n[0])*(n[4]-n[1])*(n[5]-n[2]);return!(a<.1)&&(!(e<100)&&e/a>1e3)}function ME(e){if(e.continueGeneration&&e.continueGeneration(),e.count){return!0===AE(e.count,e)||e.count}{const t=ME(e.left);if(!0===t)return!0;const n=ME(e.right);if(!0===n)return!0;const a=t+n;return!0===AE(a,e)||a}}const kE=function(){const e="shape-helper__",t=[];return function(n){const a=n.object3DMap.mesh;for(;t.length>0;){const{id:e,entity:n}=t.pop();n.removeAttribute(e)}if(console.group("traverseMeshesAndAddShapes"),document.querySelector(["[shape-helper__trimesh]","[shape-helper__heightfield]"]))console.log("heightfield or trimesh found on scene");else{console.log("collision not found in scene");let i=!1;a.traverse(e=>{!e.isMesh||THREE.Sky&&e.__proto__==THREE.Sky.prototype||e.name.startsWith("Floor_Plan")||e.name.startsWith("Ground_Plane")||!e.geometry.boundsTree||!function(e){const t=e.boundsTree._roots;for(let e=0;e<t.length;++e)return!0===ME(t[e]);return!1}(e.geometry)||(i=!0)});let r=null;i&&(console.log("mesh contains high triangle density region"),r=document.querySelector("[nav-mesh]")),r?(console.log("mesh density exceeded, using floor plan only"),r.setAttribute(e+"floorPlan",{type:De.SHAPE.MESH,margin:.01,fit:De.FIT.ALL,includeInvisible:!0}),t.push({id:e+"floorPlan",entity:r})):i?(n.setAttribute(e+"defaultFloor",{type:De.SHAPE.BOX,margin:.01,halfExtents:{x:4e3,y:.5,z:4e3},offset:{x:0,y:-.5,z:0},fit:De.FIT.MANUAL}),t.push({id:e+"defaultFloor",entity:n}),console.log("adding default floor collision")):(n.setAttribute(e+"environment",{type:De.SHAPE.MESH,margin:.01,fit:De.FIT.ALL}),t.push({id:e+"environment",entity:n}),console.log("adding mesh shape for all visible meshes"))}console.groupEnd()}}();function OE(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}let CE;class PE extends fE.a{constructor(e,t,n,a,i){var r;super(),r=this,this.log=(e,t)=>{this.receive({type:"log",messageType:e,props:t})},this.dispatch=e=>{if(e.startsWith("/")){const t=e.substring(1).split(/\s+/);this.dispatchCommand(t[0],...t.slice(1)),document.activeElement.blur()}else this.hubChannel.sendMessage(e)},this.dispatchCommand=function(){var e,t=(e=function*(e,...t){const n=r.scene.is("entered");CE=CE||document.getElementById("ui-root");const a=!n&&CE&&CE.firstChild&&CE.firstChild.classList.contains("isGhost");if(!(n||a&&"duck"!==e))return void r.log(Yc.roomEntryRequired);const i=document.querySelector("#avatar-rig"),o=[.0625,.125,.25,.5,1,1.5,3,5,7.5,12.5],s=i.object3D.scale;let l,c;const d=r.scene.systems["capture-system"];switch(e){case"fly":r.scene.systems["hubs-systems"].characterController.fly?(r.scene.systems["hubs-systems"].characterController.enableFly(!1),r.log(Yc.flyModeDisabled)):r.scene.systems["hubs-systems"].characterController.enableFly(!0)&&r.log(Yc.flyModeEnabled);break;case"grow":for(let e=0;e<o.length;e++)if(o[e]>s.x){i.object3D.scale.set(o[e],o[e],o[e]),i.object3D.matrixNeedsUpdate=!0;break}break;case"shrink":for(let e=o.length-1;e>=0;e--)if(s.x>o[e]){i.object3D.scale.set(o[e],o[e],o[e]),i.object3D.matrixNeedsUpdate=!0;break}break;case"leave":r.entryManager.exitScene(),r.remountUI({roomUnavailableReason:ey.left});break;case"duck":dd(Object(Ut.a)(location.href,So.a)),Math.random()<.01?r.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.s):r.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.n);break;case"debug":c=document.querySelector("a-scene").systems["hubs-systems"].physicsSystem,c.setDebug(!c.debugEnabled);break;case"vrstats":document.getElementById("stats").components["stats-plus"].toggleVRStats();break;case"scene":t[0]?(yield uo(t[0]))?(l=r.hubChannel.updateScene(t[0]),"unauthorized"===l&&r.log(Yc.unauthorizedSceneChange)):r.log(Yc.inalidSceneUrl):r.hubChannel.canOrWillIfCreator("update_hub")&&r.mediaSearchStore.sourceNavigateWithNoNav("scenes","use");break;case"rename":l=r.hubChannel.rename(t.join(" ")),"unauthorized"===l&&r.log(Yc.unauthorizedRoomRename);break;case"capture":if(!d.available()){r.log(Yc.captureUnavailable);break}"stop"===t[0]?d.started()?(d.stop(),r.log(Yc.captureStopped)):r.log(Yc.captureAlreadyStopped):d.started()?r.log(Yc.captureAlreadyRunning):(d.start(),r.log(Yc.captureStarted));break;case"audioNormalization":if(1===t.length){const e=Number(t[0]);if(isNaN(e))r.log(Yc.audioNormalizationNaN);else{const t=Math.max(0,Math.min(255,e));window.APP.store.update({preferences:{audioNormalization:t}}),e?r.log(Yc.setAudioNormalizationFactor,{factor:t}):r.log(Yc.audioNormalizationDisabled)}}else r.log(Yc.invalidAudioNormalizationRange)}},function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){OE(r,a,i,o,s,"next",e)}function s(e){OE(r,a,i,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),this.scene=e,this.entryManager=t,this.hubChannel=n,this.remountUI=a,this.mediaSearchStore=i,this.presenceLogEntries=[]}addToPresenceLog(e){e.key=Date.now().toString(),this.presenceLogEntries.push(e),this.remountUI({presenceLogEntries:this.presenceLogEntries}),"chat"===e.type&&this.scene.is("loaded")&&this.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.c),setTimeout(()=>{e.expired=!0,this.remountUI({presenceLogEntries:this.presenceLogEntries}),setTimeout(()=>{this.presenceLogEntries.splice(this.presenceLogEntries.indexOf(e),1),this.remountUI({presenceLogEntries:this.presenceLogEntries})},5e3)},2e4)}receive(e){this.addToPresenceLog(e),this.dispatchEvent(new CustomEvent("message",{detail:e}))}}var RE=n(110);function TE(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function jE(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){TE(r,a,i,o,s,"next",e)}function s(e){TE(r,a,i,o,s,"throw",e)}o(void 0)}))}}const DE=Object(mt.a)("bot"),IE=AFRAME.utils.device.isMobile(),LE=Object(RE.a)(),HE=AFRAME.utils.device.isMobileVR(),NE=Object(mt.a)("debug"),FE=new URLSearchParams(location.search);class VE{constructor(e,t,n){var a=this;this.init=()=>{this.whenSceneLoaded(()=>{console.log("Scene is loaded so setting up controllers"),this.rightCursorController.components["cursor-controller"].enabled=!1,this.leftCursorController.components["cursor-controller"].enabled=!1,this.mediaDevicesManager=APP.mediaDevicesManager,this._setupBlocking()})},this.hasEntered=()=>this._entered,this.enterScene=function(){var e=jE((function*(e,t){console.log("Entering scene..."),document.getElementById("viewing-camera").removeAttribute("scene-preview-camera"),NE&&NAF.connection.adapter.session&&(NAF.connection.adapter.session.options.verbose=!0),e&&(a.scene.addState("vr-entered"),"getVRDisplays"in navigator&&navigator.getVRDisplays(),yield ja(!0));if(a.scene.systems["hubs-systems"].waypointSystem.moveToSpawnPoint(),(IE||LE||Object(mt.a)("force_enable_touchscreen"))&&a.avatarRig.setAttribute("virtual-gamepad-controls",{}),a._setupPlayerRig(),a._setupKicking(),a._setupMedia(),a._setupCamera(),!Object(mt.a)("offline")){if(a._spawnAvatar(),a.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.d),DE)return a._runBot(),a.scene.addState("entered"),void a.hubChannel.sendEnteredEvent();a.scene.classList.remove("hand-cursor"),a.scene.classList.add("no-cursor"),a.rightCursorController.components["cursor-controller"].enabled=!0,a.leftCursorController.components["cursor-controller"].enabled=!0,a._entered=!0,jE((function*(){for(;e&&!a.scene.renderer.xr.isPresenting;)yield Object(_.a)();a.hubChannel.sendEnteredEvent().then(()=>{a.store.update({activity:{lastEnteredAt:(new Date).toISOString()}})})}))(),setTimeout(()=>a.store.bumpEntryCount(),3e4),a.scene.addState("entered"),APP.mediaDevicesManager.micEnabled=!t}}));return function(t,n){return e.apply(this,arguments)}}(),this.whenSceneLoaded=e=>{this.scene.hasLoaded?(console.log("Scene already loaded so callback invoked directly"),e()):(console.log("Scene not yet loaded so callback is deferred"),this.scene.addEventListener("loaded",e))},this.enterSceneWhenLoaded=(e,t)=>{this.whenSceneLoaded(()=>this.enterScene(e,t))},this.exitScene=()=>{this.scene.exitVR(),APP.dialog&&APP.dialog.localMediaStream&&APP.dialog.localMediaStream.getTracks().forEach(e=>e.stop()),this.hubChannel&&this.hubChannel.disconnect(),this.scene.renderer&&this.scene.renderer.setAnimationLoop(null),this.scene.parentNode.removeChild(this.scene)},this._setupPlayerRig=()=>{this._setPlayerInfoFromProfile(),this.scene.addEventListener("avatar_updated",()=>this._setPlayerInfoFromProfile(!0)),this.store.addEventListener("statechanged",()=>this._setPlayerInfoFromProfile());const e=parseInt(FE.get("avatar_scale"),10);e&&this.avatarRig.setAttribute("scale",{x:e,y:e,z:e})},this._setPlayerInfoFromProfile=function(){var e=jE((function*(e=!1){const t=a.store.state.profile.avatarId;if(!e&&a._lastFetchedAvatarId===t)return;a._lastFetchedAvatarId=t;const n=yield Object(it.e)(t);a.avatarRig.setAttribute("player-info",{avatarSrc:n,avatarType:Object(it.g)(t)})}));return function(){return e.apply(this,arguments)}}(),this._setupKicking=()=>{document.body.addEventListener("kicked",({detail:e})=>{const{clientId:t}=e,{entities:n}=NAF.connection.entities;for(const e in n){const a=n[e];NAF.utils.getCreator(a)===t&&(a.components.networked.data.persistent?(NAF.utils.takeOwnership(a),window.APP.pinningHelper.unpinElement(a),a.parentNode.removeChild(a)):NAF.entities.removeEntity(e))}})},this._setupBlocking=()=>{document.body.addEventListener("blocked",e=>{NAF.connection.entities.removeEntitiesOfClient(e.detail.clientId)}),document.body.addEventListener("unblocked",e=>{NAF.connection.entities.completeSync(e.detail.clientId,!0)})},this._setupMedia=()=>{const e={x:0,y:0,z:-1.5},t=(t,n)=>{if(!this.hubChannel.can("spawn_and_move_media"))return;const{entity:a,orientation:i}=Object(te.c)(t,"#interactable-media",n,null,!(t instanceof MediaStream),!0);return i.then(t=>{a.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:e,orientation:t})}),a};let n,i;this.scene.addEventListener("add_media",e=>{const n=e.detail instanceof File?ta.a.FILE:ta.a.URL;t(e.detail,n)}),this.scene.addEventListener("object_spawned",e=>{this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType)}),this.scene.addEventListener("action_spawn",()=>{Ra(!1,()=>window.APP.mediaSearchStore.pushExitMediaBrowserHistory()),window.APP.mediaSearchStore.sourceNavigateToDefaultSource()}),this.scene.addEventListener("action_kick_client",({detail:{clientId:e}})=>{this.performConditionalSignIn(()=>this.hubChannel.can("kick_users"),jE((function*(){return yield window.APP.hubChannel.kick(e)})),es.b.kickUser)}),this.scene.addEventListener("action_mute_client",({detail:{clientId:e}})=>{this.performConditionalSignIn(()=>this.hubChannel.can("mute_users"),()=>window.APP.hubChannel.mute(e),es.b.muteUser)}),this.scene.addEventListener("action_vr_notice_closed",()=>function(){return La.apply(this,arguments)}()),document.addEventListener("paste",e=>{if((e.target.matches("input, textarea")||"true"===e.target.contentEditable)&&document.activeElement===e.target)return;const n=document.querySelector(".ui-root");if(n&&n.classList.contains("in-modal-or-overlay"))return;const a=e.clipboardData.getData("text"),i=e.clipboardData.files&&e.clipboardData.files;if(a)t(a,ta.a.URL);else for(const e of i)t(e,ta.a.CLIPBOARD)}),document.addEventListener("dragover",e=>e.preventDefault()),document.addEventListener("drop",e=>{if(e.preventDefault(),Object(mt.a)("debugLocalScene")){URL.revokeObjectURL(n);const t=URL.createObjectURL(e.dataTransfer.files[0]);return this.hubChannel.updateScene(t),void(n=t)}let a=e.dataTransfer.getData("url");if(!a)try{a=new URL(e.dataTransfer.getData("text")).href}catch(e){}const i=e.dataTransfer.files;if(a)t(a,ta.a.URL);else for(const e of i)t(e,ta.a.FILE)});let r=!1;const o=(e,n,a)=>{r=!1,n&&("avatar"===a?this.avatarRig.setAttribute("player-info",{isSharingAvatarCamera:!0}):(i=t(this.mediaDevicesManager.mediaStream,void 0),i.setAttribute("emit-scene-event-on-remove","event:".concat(T.b.VIDEO_SHARE_ENDED))),this.scene.emit("share_video_enabled",{source:e?T.a.SCREEN:T.a.CAMERA}),this.scene.addState("sharing_video"))},s=e=>{console.error(e),r=!1,this.scene.emit("share_video_failed")};this.scene.addEventListener("action_share_camera",e=>{var t;r||(r=!0,this.mediaDevicesManager.startVideoShare({isDisplayMedia:!1,target:null===(t=e.detail)||void 0===t?void 0:t.target,success:o,error:s}))}),this.scene.addEventListener("action_share_screen",()=>{r||(r=!0,this.mediaDevicesManager.startVideoShare({isDisplayMedia:!0,target:null,success:o,error:s}))}),this.scene.addEventListener(T.b.VIDEO_SHARE_ENDED,jE((function*(){r||(r=!0,i&&i.parentNode&&(NAF.utils.takeOwnership(i),i.parentNode.removeChild(i)),yield a.mediaDevicesManager.stopVideoShare(),i=null,a.avatarRig.setAttribute("player-info",{isSharingAvatarCamera:!1}),a.scene.emit("share_video_disabled"),a.scene.removeState("sharing_video"),r=!1)}))),this.scene.addEventListener(T.b.MIC_SHARE_ENDED,jE((function*(){yield a.mediaDevicesManager.stopMicShare()}))),this.scene.addEventListener("action_selected_media_result_entry",function(){var e=jE((function*(e){const{entry:n,selectAction:a}=e.detail;if("spawn"!==a)return;const i=Ia()&&!HE;yield ja(),i?setTimeout(()=>{t(n.url,ta.a.URL)},3e3):t(n.url,ta.a.URL)}));return function(t){return e.apply(this,arguments)}}()),this.mediaSearchStore.addEventListener("media-exit",()=>{ja()})},this._setupCamera=()=>{this.scene.addEventListener("action_toggle_camera",()=>{if(!this.hubChannel.can("spawn_camera"))return;const e=this.scene.systems["camera-tools"].getMyCamera();if(e)e.parentNode.removeChild(e);else{const e=document.createElement("a-entity");e.setAttribute("networked",{template:"#interactable-camera"}),e.setAttribute("offset-relative-to",{target:"#avatar-pov-node",offset:{x:0,y:0,z:-1.5}}),this.scene.appendChild(e)}}),this.scene.addEventListener("photo_taken",e=>this.hubChannel.sendMessage({src:e.detail},"photo")),this.scene.addEventListener("video_taken",e=>this.hubChannel.sendMessage({src:e.detail},"video"))},this._spawnAvatar=()=>{this.avatarRig.setAttribute("networked","template: #remote-avatar; attachTemplateToLocal: false;"),this.avatarRig.setAttribute("networked-avatar",""),this.avatarRig.emit("entered")},this._runBot=jE((function*(){const e=document.createElement("audio");let t,n;do{t=document.querySelector("#bot-audio-input"),n=document.querySelector("#bot-data-input"),yield Object(_.a)()}while(!t||!n);const i=()=>{e.loop=!0,e.muted=!1,e.crossorigin="anonymous",e.src=URL.createObjectURL(t.files[0]),document.body.appendChild(e)};t.files&&t.files.length>0?i():t.onchange=i;const r=document.querySelector("#avatar-pov-node"),o=document.querySelector("#player-left-controller"),s=document.querySelector("#player-right-controller"),l=()=>{fetch(URL.createObjectURL(n.files[0])).then(e=>e.json()).then(e=>{r.setAttribute("replay",""),r.components.replay.poses=e.camera.poses,o.setAttribute("replay",""),o.components.replay.poses=e.left.poses,o.removeAttribute("visibility-by-path"),o.removeAttribute("track-pose"),o.setAttribute("visible",!0),s.setAttribute("replay",""),s.components.replay.poses=e.right.poses,s.removeAttribute("visibility-by-path"),s.removeAttribute("track-pose"),s.setAttribute("visible",!0)})};n.files&&n.files.length>0?l():n.onchange=l,yield new Promise(t=>e.addEventListener("canplay",t));const c=e.captureStream?e.captureStream():e.mozCaptureStream?e.mozCaptureStream():null;if(c){let e=Number(FE.get("audio_volume")||"1.0");isNaN(e)&&(e=1);const t=THREE.AudioContext.getContext(),n=t.createMediaStreamSource(c),i=t.createMediaStreamDestination(),r=t.createGain();n.connect(r),r.connect(i),r.gain.value=e,a.mediaDevicesManager.mediaStream.addTrack(i.stream.getAudioTracks()[0])}const d=function(){var t=jE((function*(){yield APP.dialog.setLocalMediaStream(a.mediaDevicesManager.mediaStream),e.play()}));return function(){return t.apply(this,arguments)}}();APP.dialog._sendTransport?d():a.scene.addEventListener("didConnectToDialog",d)})),this.hubChannel=e,this.authChannel=t,this.store=window.APP.store,this.mediaSearchStore=window.APP.mediaSearchStore,this.scene=document.querySelector("a-scene"),this.rightCursorController=document.getElementById("right-cursor-controller"),this.leftCursorController=document.getElementById("left-cursor-controller"),this.avatarRig=document.getElementById("avatar-rig"),this._entered=!1,this.performConditionalSignIn=()=>{},this.history=n}}function BE(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function UE(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){BE(r,a,i,o,s,"next",e)}function s(e){BE(r,a,i,o,s,"throw",e)}o(void 0)}))}}function zE(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),a=new Uint8Array(n.length);for(let e=0;e<n.length;++e)a[e]=n.charCodeAt(e);return a}class WE{constructor(e){var t=this;this.setHubChannel=e=>{this.hubChannel=e},this.setRegistration=e=>{console.log("Service worker registered"),this.registration=e},this.setRegistrationFailed=e=>{console.error("Service worker registration failed",e),this.registration=null},this.setVapidPublicKey=e=>{this.vapidPublicKey=e},this.setSubscribed=e=>{this._isSubscribed=e},this.isSubscribed=()=>this._isSubscribed,this.getCurrentEndpoint=UE((function*(){if(!navigator.serviceWorker)return null;const e=performance.now();for(;void 0===t.registration&&performance.now()-e<5e3;)yield Object(_.a)();if(performance.now()-e>=5e3&&console.warn("Service worker registration timed out."),!t.registration||!t.registration.pushManager)return null;for(;void 0===t.vapidPublicKey;)yield Object(_.a)();if(null===t.vapidPublicKey)return null;try{const e=zE(t.vapidPublicKey);if("granted"!==(yield t.registration.pushManager.permissionState({userVisibleOnly:!0,applicationServerKey:e})))return null}catch(e){return null}const n=yield t.registration.pushManager.getSubscription();return n?n.endpoint:null})),this.toggle=UE((function*(){if(t.registration){if(t._isSubscribed){const e=yield t.registration.pushManager.getSubscription(),n=yield t.hubChannel.unsubscribe(e);n&&!1===n.has_remaining_subscriptions&&e.unsubscribe()}else{let e=yield t.registration.pushManager.getSubscription();if(!e){const n=zE(t.vapidPublicKey);e=yield t.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})}t.hubChannel.subscribe(e)}t._isSubscribed=!t._isSubscribed}})),this.hubId=e}register(){if(navigator.serviceWorker)try{navigator.serviceWorker.register("/hub.service.js").then(()=>{navigator.serviceWorker.ready.then(e=>this.setRegistration(e)).catch(e=>this.setRegistrationFailed(e))}).catch(e=>this.setRegistrationFailed(e))}catch(e){this.setRegistrationFailed(e)}else this.setRegistrationFailed("Not supported")}}n(587),n(1531);const qE=new AFRAME.THREE.Vector3,GE=new AFRAME.THREE.Vector3,YE=Object(mt.a)("debug"),KE=AFRAME.utils.device.isMobileVR();function XE(e){const t=new THREE.SphereBufferGeometry(e,10,10),n=new THREE.WireframeGeometry(t),a=new THREE.LineSegments(n);return a.material.opacity=.5,a.material.transparent=!0,a}AFRAME.registerSystem("personal-space-bubble",{schema:{debug:{default:!1},enabled:{default:!0}},init(){this.invaders=[],this.bubbles=[],this.tickCount=0,this._updateInvaders=this._updateInvaders.bind(this)},registerBubble(e){this.bubbles.push(e)},unregisterBubble(e){const t=this.bubbles.indexOf(e);-1!==t&&this.bubbles.splice(t,1)},registerInvader(e){NAF.utils.getNetworkedEntity(e.el).then(t=>{NAF.utils.getNetworkOwner(t)!==NAF.clientId&&this.invaders.push(e)})},unregisterInvader(e){const t=this.invaders.indexOf(e);-1!==t&&this.invaders.splice(t,1)},update(){for(let e=0;e<this.bubbles.length;e++)this.bubbles[e].updateDebug();for(let e=0;e<this.invaders.length;e++)this.invaders[e].updateDebug(),this.data.enabled||this.invaders[e].setInvading(!1);this.data.enabled?this.el.addState("spacebubble"):this.el.removeState("spacebubble")},tick(){this._updateInvaders(),this.tickCount++},_updateInvaders:function(){const e=[],t=(t,n,a)=>{const i=n[t];qE.setFromMatrixPosition(i.el.object3D.matrixWorld);const r=GE.distanceToSquared(qE),o=a.data.radius+i.data.radius;r<o*o&&(e[t]=!0)},n=(t,n)=>{n[t].invading!==e[t]&&n[t].setInvading(e[t])};return function(){if(this.data.enabled&&0!==this.invaders.length){e.length=0;for(let t=0;t<this.invaders.length;t++)this.invaders[t].el.object3D.updateMatrices(),e[t]=!1;for(let e=0;e<this.bubbles.length;e++){const n=this.bubbles[e];if(n.el.object3D.updateMatrices(),GE.setFromMatrixPosition(n.el.object3D.matrixWorld),KE)t(this.tickCount%this.invaders.length,this.invaders,n);else for(let e=0;e<this.invaders.length;e++)t(e,this.invaders,n)}if(KE)n(this.tickCount%this.invaders.length,this.invaders);else for(let e=0;e<this.invaders.length;e++)n(e,this.invaders)}}}()});AFRAME.registerComponent("personal-space-invader",{schema:{radius:{type:"number",default:.1},useMaterial:{default:!1},debug:{default:!1},invadingOpacity:{default:.3}},init(){this.el.sceneEl.systems["personal-space-bubble"].registerInvader(this),this.data.useMaterial&&(this.gltfRootEl=function(e){for(;e&&(!e.components||!e.components["gltf-model-plus"]);)e=e.parentNode;return e}(this.el)),this.invading=!1,this.alwaysHidden=!1},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},setAlwaysHidden(e){this.alwaysHidden=e,this.applyInvasionToMesh(this.invading)},updateDebug(){this.el.sceneEl.systems["personal-space-bubble"].data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",XE(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove(){this.el.sceneEl.systems["personal-space-bubble"].unregisterInvader(this)},setInvading(e){this.invading!==e&&(this.applyInvasionToMesh(e),this.invading=e)},disable(){this.invading&&this.applyInvasionToMesh(!1),this.disabled=!0},enable(){this.disabled=!1,this.applyInvasionToMesh(this.invading)},applyInvasionToMesh(e){this.disabled||(this.gltfRootEl&&this.gltfRootEl.object3DMap.mesh&&!this.alwaysHidden?function e(t,n){if(!1===n(t))return;const a=t.children;for(let t=0;t<a.length;t++)e(a[t],n)}(this.gltfRootEl.object3DMap.mesh,t=>{if(t.el&&t.el.components.tags&&t.el.components.tags.data.ignoreSpaceBubble)return!1;t.material&&Object(Bt.c)(t,t=>{let n=t.userData.originalProps;t.userData.originalProps||(n=t.userData.originalProps={opacity:t.opacity,transparent:t.transparent,format:t.format,blending:t.blending,side:t.side}),t.opacity=e?this.data.invadingOpacity:n.opacity,t.transparent=e||n.transparent,t.format=e?THREE.RGBAFormat:n.format,t.blending=e?THREE.NormalBlending:n.blending,t.side=e?THREE.DoubleSide:n.side})}):this.el.object3D.visible=!e&&!this.alwaysHidden)}}),AFRAME.registerComponent("personal-space-bubble",{schema:{radius:{type:"number",default:.8},debug:{default:!1}},init(){this.system.registerBubble(this)},update(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug(){YE&&(this.system.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",XE(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug"))},remove(){this.system.unregisterBubble(this)}});n(1532),n(1533),n(1534),n(1535);const QE=new URLSearchParams(location.search),JE=1e3*(parseInt(QE.get("idle_timeout"),10)||7200),ZE=Xe.a.actions.characterAcceleration,$E=[Xe.a.actions.startGazeTeleport,Xe.a.actions.rightHand.startTeleport,Xe.a.actions.leftHand.startTeleport,Xe.a.actions.snapRotateRight,Xe.a.actions.snapRotateLeft,Xe.a.actions.cursor.right.grab,Xe.a.actions.cursor.left.grab,Xe.a.actions.rightHand.grab,Xe.a.actions.leftHand.grab,Xe.a.actions.angularVelocity];AFRAME.registerSystem("idle-detector",{init(){this.resetTimeout=this.resetTimeout.bind(this),this.idleTimeout=null,this.lastInputCheck=0;const e=["click","pointerdown","touchstart","keyup"];for(const t of e)window.addEventListener(t,this.resetTimeout);this.resetTimeout()},resetTimeout(){this.idleTimeout&&clearTimeout(this.idleTimeout),this.idleTimeout=setTimeout(this.onIdleTimeout,JE),window.dispatchEvent(new CustomEvent("activity_detected"))},onIdleTimeout(){window.dispatchEvent(new CustomEvent("idle_detected"))},tick(e){if(e-this.lastInputCheck<1e3)return;const t=this.el.systems.userinput;let n=!1;for(const e of $E)n=n||!!t.get(e);const a=t.get(ZE);(n||!(!a||!a[0])||!(!a||!a[1]))&&this.resetTimeout()},remove(){}});AFRAME.registerSystem("camera-tools",{init(){this.cameraEls=[],this.cameraUpdateCount=0,this.ticks=0,this.updateMyCamera=this.updateMyCamera.bind(this),Object(Ue.b)().then(()=>{this.updateMyCamera()})},register(e){this.cameraEls.push(e),e.addEventListener("ownership-changed",this.updateMyCamera),this.updateMyCamera()},deregister(e){this.cameraEls.splice(this.cameraEls.indexOf(e),1),e.removeEventListener("ownership-changed",this.updateMyCamera),this.updateMyCamera()},getMyCamera(){return this.myCamera},ifMyCameraRenderingViewfinder(e){if(!this.myCamera)return;const t=this.myCamera.components["camera-tool"];t&&t.showCameraViewfinder&&t.camera&&e(t)},updateMyCamera(){this.myCamera=this.cameraEls.find(NAF.utils.isMine),this.myCamera?this.sceneEl.addState("camera"):this.sceneEl.removeState("camera")},tick(){if(this.ticks++,this.ticks%10==0){if(0==this.cameraEls.length)return;this.cameraUpdateCount++,this.cameraEls[this.cameraUpdateCount%this.cameraEls.length].components["camera-tool"].updateViewfinder()}}}),AFRAME.registerSystem("pen-tools",{init(){this.penEls=[],this.updateMyPen=this.updateMyPen.bind(this),Object(Ue.b)().then(()=>{this.updateMyPen()})},register(e){this.penEls.push(e),e.addEventListener("ownership-changed",this.updateMyPen),this.updateMyPen()},deregister(e){this.penEls.splice(this.penEls.indexOf(e),1),e.removeEventListener("ownership-changed",this.updateMyPen),this.updateMyPen()},getMyPen(){return this.myPen},updateMyPen(){this.myPen=this.penEls.find(NAF.utils.isMine),this.myPen?this.sceneEl.addState("pen"):this.sceneEl.removeState("pen")}});const ew={global:"global",inputFocused:"inputFocused",rightCursorHoveringOnPen:"rightCursorHoveringOnPen",rightCursorHoveringOnCamera:"rightCursorHoveringOnCamera",rightCursorHoveringOnInteractable:"rightCursorHoveringOnInteractable",rightCursorHoveringOnUI:"rightCursorHoveringOnUI",rightCursorHoveringOnVideo:"rightCursorHoveringOnVideo",rightCursorHoveringOnNothing:"rightCursorHoveringOnNothing",rightCursorHoldingPen:"rightCursorHoldingPen",rightCursorHoldingCamera:"rightCursorHoldingCamera",rightCursorHoldingInteractable:"rightCursorHoldingInteractable",rightCursorHoldingUI:"rightCursorHoldingUI",rightCursorHoldingNothing:"rightCursorHoldingNothing",leftCursorHoveringOnPen:"leftCursorHoveringOnPen",leftCursorHoveringOnCamera:"leftCursorHoveringOnCamera",leftCursorHoveringOnInteractable:"leftCursorHoveringOnInteractable",leftCursorHoveringOnUI:"leftCursorHoveringOnUI",leftCursorHoveringOnVideo:"leftCursorHoveringOnVideo",leftCursorHoveringOnNothing:"leftCursorHoveringOnNothing",leftCursorHoldingPen:"leftCursorHoldingPen",leftCursorHoldingCamera:"leftCursorHoldingCamera",leftCursorHoldingInteractable:"leftCursorHoldingInteractable",leftCursorHoldingUI:"leftCursorHoldingUI",leftCursorHoldingNothing:"leftCursorHoldingNothing",rightHandTeleporting:"rightHandTeleporting",rightHandHoveringOnPen:"rightHandHoveringOnPen",rightHandHoveringOnCamera:"rightHandHoveringOnCamera",rightHandHoveringOnInteractable:"rightHandHoveringOnInteractable",rightHandHoveringOnNothing:"rightHandHoveringOnNothing",rightHandHoldingPen:"rightHandHoldingPen",rightHandHoldingCamera:"rightHandHoldingCamera",rightHandHoldingInteractable:"rightHandHoldingInteractable",leftHandTeleporting:"leftHandTeleporting",leftHandHoveringOnPen:"leftHandHoveringOnPen",leftHandHoveringOnCamera:"leftHandHoveringOnCamera",leftHandHoveringOnInteractable:"leftHandHoveringOnInteractable",leftHandHoldingPen:"leftHandHoldingPen",leftHandHoldingCamera:"leftHandHoldingCamera",leftHandHoldingInteractable:"leftHandHoldingInteractable",leftHandHoveringOnNothing:"leftHandHoveringOnNothing",debugUserInput:"debugUserInput",inspecting:"inspecting"},tw={[WheelEvent.DOM_DELTA_PIXEL]:500,[WheelEvent.DOM_DELTA_LINE]:10,[WheelEvent.DOM_DELTA_PAGE]:2},nw=function(){let e;return function(){return e=e||document.getElementById("ui-root"),e&&e.children[0]&&e.children[0].classList.contains("in-modal-or-overlay")||window.APP.preferenceScreenIsVisible}}();class aw{constructor(){this.events=[],this.coords=[0,0],this.movementXY=[0,0],this.buttonLeft=!1,this.buttonRight=!1,this.buttonMiddle=!1,this.wheel=0;const e=this.events.push.bind(this.events);this.canvas=document.querySelector("canvas"),this.canvas.addEventListener("contextmenu",e=>{if(2===e.button)return e.preventDefault(),e.stopPropagation(),!1}),["mousedown","wheel"].map(t=>this.canvas.addEventListener(t,e,{passive:!1})),["mousemove","mouseup"].map(t=>window.addEventListener(t,e,{passive:!1})),document.addEventListener("wheel",e=>{document.activeElement.classList.contains("a-canvas")&&e.preventDefault()},{passive:!1})}process(e){if("wheel"===e.type)return this.wheel+=(e.deltaX+e.deltaY)/tw[e.deltaMode],!0;const t=0===e.button,n=1===e.button,a=2===e.button;if(this.coords[0]=e.clientX/this.canvas.clientWidth*2-1,this.coords[1]=-e.clientY/this.canvas.clientHeight*2+1,this.movementXY[0]+=e.movementX,this.movementXY[1]+=e.movementY,"mousedown"===e.type&&t)this.mouseDownLeftThisFrame=!0,this.buttonLeft=!0;else if("mousedown"===e.type&&a)this.mouseDownRightThisFrame=!0,this.buttonRight=!0;else if("mousedown"===e.type&&n)this.mouseDownMiddleThisFrame=!0,this.buttonMiddle=!0;else if("mouseup"===e.type&&t){if(this.mouseDownLeftThisFrame)return!1;this.buttonLeft=!1}else if("mouseup"===e.type&&a){if(this.mouseDownRightThisFrame)return!1;this.buttonRight=!1}else if("mouseup"===e.type&&n){if(this.mouseDownMiddleThisFrame)return!1;this.buttonMiddle=!1}return!0}write(e){this.movementXY[0]=0,this.movementXY[1]=0,this.wheel=0,this.didStopProcessingEarly=!1,this.mouseDownLeftThisFrame=!1,this.mouseDownRightThisFrame=!1,this.mouseDownMiddleThisFrame=!1;for(let e=0;e<this.events.length;e++){const t=this.events[e];if(!this.process(t)){this.didStopProcessingEarly=!0,this.events.splice(0,e);break}}this.didStopProcessingEarly||(this.events.length=0),e.setVector2(Xe.a.device.mouse.coords,this.coords[0],this.coords[1]),e.setVector2(Xe.a.device.mouse.movementXY,this.movementXY[0],this.movementXY[1]),e.setValueType(Xe.a.device.mouse.buttonLeft,this.buttonLeft),e.setValueType(Xe.a.device.mouse.buttonRight,this.buttonRight),e.setValueType(Xe.a.device.mouse.buttonMiddle,this.buttonMiddle),e.setValueType(Xe.a.device.mouse.wheel,this.wheel)}}function iw(e){return{items:e||[],has(e){return-1!==this.items.indexOf(e)},add(e){this.has(e)||this.items.push(e)},delete(e){const t=this.items.indexOf(e);-1!==t&&(this.items[t]=this.items[this.items.length-1],this.items.pop())},clear(){this.items.length=0}}}window.oncontextmenu=e=>{nw()||e.preventDefault()};const rw={KeyW:"w",KeyA:"a",KeyS:"s",KeyD:"d",KeyQ:"q",KeyE:"e"};class ow{constructor(){this.seenKeys=new iw,this.keys={},this.events=[],["keydown","keyup"].map(e=>document.addEventListener(e,e=>{if(e.key)return this.events.push(e),"keydown"===e.type&&"/"===e.key&&!["TEXTAREA","INPUT"].includes(document.activeElement&&document.activeElement.nodeName)&&(!document.activeElement||"true"!==document.activeElement.contentEditable)||e.ctrlKey&&("1"===e.key||"2"===e.key||"3"===e.key||"4"===e.key||"5"===e.key||"6"===e.key||"7"===e.key||"8"===e.key||"9"===e.key||"0"===e.key)||"Tab"===e.key&&document.activeElement.classList.contains("a-canvas")?(e.preventDefault(),!1):void 0})),["blur"].map(e=>window.addEventListener(e,this.events.push.bind(this.events)))}write(e){for(let e=0;e<this.events.length;e++){const t=this.events[e];if("blur"===t.type)this.keys={},this.seenKeys.clear();else{let e=t.key.toLowerCase();e=t.code&&rw[t.code]||e,this.keys[e]="keydown"===t.type,this.seenKeys.add(e)}}this.events.length=0;for(let t=0;t<this.seenKeys.items.length;t++){const n=this.seenKeys.items[t],a=Xe.a.device.keyboard.key(n);e.setValueType(a,this.keys[n])}}}class sw{constructor(){this.events=[],document.querySelector("a-scene").addEventListener("penButtonPressed",this.events.push.bind(this.events))}write(e){for(e.setValueType(Xe.a.device.hud.penButton,0!==this.events.length);this.events.length;)this.events.pop()}}class lw{constructor(e){this.gamepad=e,this.buttonMap=[{name:"a",buttonId:0},{name:"b",buttonId:1},{name:"x",buttonId:2},{name:"y",buttonId:3},{name:"leftBumper",buttonId:4},{name:"rightBumper",buttonId:5},{name:"leftTrigger",buttonId:6},{name:"rightTrigger",buttonId:7},{name:"back",buttonId:8},{name:"start",buttonId:9},{name:"leftJoystick",buttonId:10},{name:"rightJoystick",buttonId:11},{name:"dpadUp",buttonId:12},{name:"dpadDown",buttonId:13},{name:"dpadLeft",buttonId:14},{name:"dpadRight",buttonId:15}],this.axisMap=[{name:"leftJoystickHorizontal",axisId:0},{name:"leftJoystickVertical",axisId:1},{name:"rightJoystickHorizontal",axisId:2},{name:"rightJoystickVertical",axisId:3}]}write(e){if(this.gamepad=navigator.getGamepads()[this.gamepad.index],this.gamepad.connected){const t=Xe.a.device.xbox;this.buttonMap.forEach(n=>{const a=t.button(n.name),i=this.gamepad.buttons[n.buttonId];e.setValueType(a.pressed,!!i.pressed),e.setValueType(a.touched,!!i.touched),e.setValueType(a.value,i.value)}),e.setValueType(t.axesSum,0),this.axisMap.forEach(n=>{e.setValueType(t.axis(n.name),this.gamepad.axes[n.axisId]),e.setValueType(t.axesSum,e.get(t.axesSum)+Math.abs(this.gamepad.axes[n.axisId]))}),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(Xe.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}}const cw="undefined"!=typeof window&&window.THREE,dw=cw&&cw.Vector3||function(){},uw=cw&&cw.Quaternion||function(){},hw="undefined"!=typeof window&&window.THREE&&new cw.Vector3(0,0,-1);function pw(){return{position:new dw,direction:new dw,orientation:new uw,fromOriginAndDirection:function(e,t){return this.position=e,this.direction=t,this.orientation=this.orientation.setFromUnitVectors(hw,t),this},fromCameraProjection:function(e,t,n){return this.position.setFromMatrixPosition(e.matrixWorld),this.direction.set(t,n,.5).unproject(e).sub(this.position).normalize(),this.fromOriginAndDirection(this.position,this.direction),this},copy:function(e){this.position.copy(e.position),this.direction.copy(e.direction),this.orientation.copy(e.orientation)}}}const mw=.175,fw=-.3,gw=-.03,vw=0,bw=0,yw=-.175,Ew=function(){const e=new THREE.Euler,t=new THREE.Vector3,n=new THREE.Quaternion,a=new THREE.Vector3;return function(i,r,o,s){return o.updateMatrices(),a.copy(o.position),a.y=a.y-s,t.set(mw*("left"===r?-1:"right"===r?1:0),fw,gw),t.multiplyScalar(s),t.applyAxisAngle(o.up,o.rotation.y),a.add(t),t.set(vw,bw,yw),t.multiplyScalar(s),n.fromArray(i.orientation),e.setFromQuaternion(n),e.set(e.x,e.y,0),t.applyEuler(e),a.add(t),a}}(),ww=function e(t){navigator.getVRDisplays&&navigator.getVRDisplays().then(n=>{n[0]&&n[0].stageParameters&&n[0].stageParameters.sittingToStandingTransform?t.fromArray(n[0].stageParameters.sittingToStandingTransform):setTimeout(()=>{e(t)},1e3)})},_w=new THREE.Vector3(1,1,1),Sw=new THREE.Matrix4,xw=Xe.a.device.oculusgo.touchpad,Aw=Xe.a.device.oculusgo.trigger;class Mw{constructor(e){this.gamepad=e,this.rayObjectRotation=new THREE.Quaternion,this.pose=new pw,this.q=new THREE.Quaternion,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion,Object(Ue.b)().then(()=>{this.rayObject=document.querySelector("#player-right-controller").object3D,this.headObject3D=document.querySelector("#avatar-pov-node").object3D}),navigator.getGamepads()}write(e){if(this.rayObject&&this.headObject3D&&(navigator.getGamepads(),this.gamepad.connected)){e.setValueType(xw.axisX,this.gamepad.axes[0]),e.setValueType(xw.axisY,this.gamepad.axes[1]),e.setValueType(xw.pressed,this.gamepad.buttons[0].pressed),e.setValueType(xw.touched,this.gamepad.buttons[0].touched),e.setValueType(xw.value,this.gamepad.buttons[0].value),e.setValueType(Aw.pressed,this.gamepad.buttons[1].pressed),e.setValueType(Aw.touched,this.gamepad.buttons[1].touched),e.setValueType(Aw.value,this.gamepad.buttons[1].value),this.rayObject.updateMatrices(),this.rayObject.getWorldQuaternion(this.q),e.setValueType(Xe.a.actions.rayObjectRotation,this.q);const t=this.rayObject.matrixWorld;this.rayObjectRotation.setFromRotationMatrix(Sw.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(t),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(Xe.a.device.oculusgo.pose,this.pose),this.gamepad.pose.orientation&&e.setMatrix4(Xe.a.device.oculusgo.matrix,this.matrix.compose(Ew(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),_w).premultiply(this.sittingToStandingMatrix))}}}const kw=new THREE.Vector3(1,1,1),Ow=Xe.a.device.gearVRController.button("touchpad"),Cw=Xe.a.device.gearVRController.button("trigger"),Pw=Xe.a.device.gearVRController.axis("touchpadX"),Rw=Xe.a.device.gearVRController.axis("touchpadY"),Tw=new THREE.Matrix4;class jw{constructor(e){this.gamepad=e,this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1}],this.axisMap=[{name:"touchpadX",axisId:0},{name:"touchpadY",axisId:1}],this.rayObjectRotation=new THREE.Quaternion,this.selector="#player-".concat(e.hand,"-controller"),this.pose=new pw,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion}write(e){if(navigator.getGamepads(),this.gamepad.connected){const t=this.gamepad.buttons[0];e.setValueType(Ow.pressed,!!t.pressed),e.setValueType(Ow.touched,!!t.touched),e.setValueType(Ow.value,!!t.value);const n=this.gamepad.buttons[1];e.setValueType(Cw.pressed,!!n.pressed),e.setValueType(Cw.touched,!!n.touched),e.setValueType(Cw.value,!!n.value),e.setValueType(Pw,this.gamepad.axes[0]),e.setValueType(Rw,this.gamepad.axes[1]),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(Tw.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(Xe.a.device.gearVRController.pose,this.pose),this.headObject3D=this.headObject3D||document.querySelector("#avatar-pov-node").object3D,this.gamepad.pose.orientation&&e.setMatrix4(Xe.a.device.gearVRController.matrix,this.matrix.compose(Ew(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),kw).premultiply(this.sittingToStandingMatrix))}}}const Dw=new THREE.Vector3(1,1,1),Iw=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"x",buttonId:3},{name:"y",buttonId:4}],Lw=[{name:"thumbStick",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"a",buttonId:3},{name:"b",buttonId:4}],Hw=(new THREE.Matrix4).makeTranslation(-.025,-.03,.1),Nw=(new THREE.Matrix4).makeTranslation(.025,-.03,.1),Fw=new THREE.Matrix4;class Vw{constructor(e){this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays();const t={left:Iw,right:Lw},n={left:Xe.a.device.leftOculusTouch,right:Xe.a.device.rightOculusTouch};this.gamepad=e,this.pose=new pw,this.buttonMap=t[e.hand],this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}],this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.path=n[e.hand],this.selector="#player-".concat(e.hand,"-controller"),this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion,this.handOffset="left"===this.gamepad.hand?Hw:Nw}write(e){this.gamepad&&(this.gamepad=navigator.getGamepads()[this.gamepad.index],this.gamepad&&this.gamepad.connected&&(this.buttonMap.forEach(t=>{const n=this.path.button(t.name),a=this.gamepad.buttons[t.buttonId];e.setValueType(n.pressed,!!a.pressed),e.setValueType(n.touched,!!a.touched),e.setValueType(n.value,a.value)}),e.setValueType(this.path.axesSum,0),this.axisMap.forEach(t=>{e.setValueType(this.path.axis(t.name),this.gamepad.axes[t.axisId]),e.setValueType(this.path.axesSum,e.get(this.path.axesSum)+Math.abs(this.gamepad.axes[t.axisId]))}),this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(Fw.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.orientation.copy(this.rayObjectRotation),e.setPose(this.path.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(this.path.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),Dw).premultiply(this.sittingToStandingMatrix).multiply(this.handOffset)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(Xe.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])))}}const Bw=new THREE.Vector3(1,1,1),Uw=(new THREE.Matrix4).makeTranslation(0,0,-.04),zw=new THREE.Matrix4,Ww=Xe.a.device.daydream.button("touchpad"),qw=Xe.a.device.daydream.axis("touchpadX"),Gw=Xe.a.device.daydream.axis("touchpadY"),Yw=Xe.a.device.daydream.pose,Kw=Xe.a.device.daydream.matrix;class Xw{constructor(e){this.gamepad=e,this.rayObjectRotation=new THREE.Quaternion,this.selector="#player-".concat(e.hand||"right","-controller"),this.pose=new pw,this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.orientation=new THREE.Quaternion}write(e){if(this.gamepad=navigator.getGamepads()[0],this.gamepad&&this.gamepad.connected){const t=this.gamepad.buttons[0];e.setValueType(Ww.pressed,!!t.pressed),e.setValueType(Ww.touched,!!t.touched),e.setValueType(Ww.value,!!t.value),e.setValueType(qw,this.gamepad.axes[0]),e.setValueType(Gw,this.gamepad.axes[1]),this.rayObject||(this.rayObject=document.querySelector(this.selector).object3D),this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(zw.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(Yw,this.pose),this.headObject3D=this.headObject3D||document.querySelector("#avatar-pov-node").object3D,this.gamepad.pose.orientation&&e.setMatrix4(Kw,this.matrix.compose(Ew(this.gamepad.pose,this.gamepad.hand,this.headObject3D,1.6),this.orientation.fromArray(this.gamepad.pose.orientation),Bw).premultiply(this.sittingToStandingMatrix).multiply(Uw))}}}const Qw=new THREE.Vector3(1,1,1),Jw=(new THREE.Matrix4).compose(new THREE.Vector3(0,0,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),Zw=new THREE.Quaternion,$w=new THREE.Matrix4;class e_{constructor(e){navigator.getVRDisplays(),this.gamepad=e,"OpenVR Cosmos"===this.gamepad.id?(Zw.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"trigger",buttonId:0},{name:"grip",buttonId:1},{name:"primary",buttonId:2},{name:"secondary",buttonId:3},{name:"joystick",buttonId:4},{name:"bumper",buttonId:5}],this.axisMap=[{name:"joyX",axisId:0},{name:"joyY",axisId:1}]):"HTC Vive Focus Plus Controller"===this.gamepad.id?(Zw.setFromAxisAngle(new THREE.Vector3(1,0,0),Math.PI/15),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1}]):4===this.gamepad.axes.length?(Zw.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"primary",buttonId:3},{name:"secondary",buttonId:4},{name:"joystick",buttonId:5},{name:"index",buttonId:6},{name:"middle",buttonId:7},{name:"ring",buttonId:8},{name:"pinky",buttonId:9}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1},{name:"joyX",axisId:2},{name:"joyY",axisId:3}]):(Zw.setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/12),this.buttonMap=[{name:"touchpad",buttonId:0},{name:"trigger",buttonId:1},{name:"grip",buttonId:2},{name:"primary",buttonId:3}],this.axisMap=[{name:"touchX",axisId:0},{name:"touchY",axisId:1}]),this.pose=new pw,this.rayObjectRotation=new THREE.Quaternion,this.path=Xe.a.device.vive[e.hand||"right"],this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion}write(e){const t=navigator.getGamepads();if(t.length<this.gamepad.index+1)return;if(this.gamepad=t[this.gamepad.index],!this.gamepad.connected)return;if(this.buttonMap.forEach(t=>{const n=this.path.button(t.name),a=this.gamepad.buttons[t.buttonId];e.setValueType(n.pressed,!!a.pressed),e.setValueType(n.touched,!!a.touched),e.setValueType(n.value,a.value)}),e.setValueType(this.path.axesSum,0),this.axisMap.forEach(t=>{e.setValueType(this.path.axis(t.name),this.gamepad.axes[t.axisId]),e.setValueType(this.path.axesSum,e.get(this.path.axesSum)+Math.abs(this.gamepad.axes[t.axisId]))}),!this.selector){if(!this.gamepad.hand)return;this.path=Xe.a.device.vive[this.gamepad.hand],this.selector="#player-".concat(this.gamepad.hand,"-controller"),console.warn("gamepad hand eventually specified")}const n=document.querySelector(this.selector).object3D;n.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix($w.extractRotation(n.matrixWorld)),this.pose.position.setFromMatrixPosition(n.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(Zw).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(this.path.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(this.path.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),Qw).premultiply(this.sittingToStandingMatrix).multiply(Jw)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(Xe.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}const t_=new THREE.Vector3(1,1,1),n_=(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),a_=new THREE.Matrix4;class i_{constructor(e){this.rayObject=null,this.rayObjectRotation=new THREE.Quaternion,navigator.getVRDisplays(),this.gamepad=e,this.pose=new pw,e.hand&&(this.selector="#player-".concat(e.hand,"-controller")),this.sittingToStandingMatrix=(new THREE.Matrix4).makeTranslation(0,1.6,0),ww(this.sittingToStandingMatrix),this.matrix=new THREE.Matrix4,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion}write(e){if(!this.gamepad)return;if(this.gamepad=navigator.getGamepads()[this.gamepad.index],!this.gamepad||!this.gamepad.connected)return;const t=Xe.a.device.wmr[this.gamepad.hand||"right"];if(e.setValueType(t.touchpad.pressed,this.gamepad.buttons[0].pressed),e.setValueType(t.touchpad.touched,this.gamepad.buttons[0].touched),e.setValueType(t.touchpad.value,this.gamepad.buttons[0].value),e.setValueType(t.trigger.pressed,this.gamepad.buttons[1].pressed),e.setValueType(t.trigger.touched,this.gamepad.buttons[1].touched),e.setValueType(t.trigger.value,this.gamepad.buttons[1].value),e.setValueType(t.grip.pressed,this.gamepad.buttons[2].pressed),e.setValueType(t.grip.touched,this.gamepad.buttons[2].touched),e.setValueType(t.grip.value,this.gamepad.buttons[2].value),e.setValueType(t.menu.pressed,this.gamepad.buttons[3].pressed),e.setValueType(t.menu.touched,this.gamepad.buttons[3].touched),e.setValueType(t.menu.value,this.gamepad.buttons[3].value),e.setValueType(t.touchpad.axisX,this.gamepad.axes[0]),e.setValueType(t.touchpad.axisY,this.gamepad.axes[1]),e.setValueType(t.joystick.axisX,this.gamepad.axes[2]),e.setValueType(t.joystick.axisY,this.gamepad.axes[3]),!this.selector){if(!this.gamepad.hand)return;this.selector="#player-".concat(this.gamepad.hand,"-controller")}this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(a_.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.fromOriginAndDirection(this.pose.position,this.pose.direction),e.setPose(t.pose,this.pose),this.gamepad.pose.position&&this.gamepad.pose.orientation&&e.setMatrix4(t.matrix,this.matrix.compose(this.position.fromArray(this.gamepad.pose.position),this.orientation.fromArray(this.gamepad.pose.orientation),t_).premultiply(this.sittingToStandingMatrix).multiply(n_)),this.gamepad.hapticActuators&&this.gamepad.hapticActuators[0]&&e.setValueType(Xe.a.haptics.actuators[this.gamepad.hand],this.gamepad.hapticActuators[0])}}const r_=new THREE.Vector3(1,1,1),o_=(new THREE.Matrix4).makeTranslation(-.025,-.03,.12),s_=(new THREE.Matrix4).makeTranslation(.025,-.03,.12),l_=new THREE.Matrix4;class c_{constructor(e){this.gamepad=e,this.selector="#player-".concat(e.hand,"-controller"),this.rayObject=null,this.rayObjectRotation=new THREE.Quaternion,this.pose=new pw,this.matrix=new THREE.Matrix4,this.position=new THREE.Vector3,this.orientation=new THREE.Quaternion}write(e,t,n){if(!n||!this.gamepad)return;const a=this.gamepad.hand||"right",i=Xe.a.device.webxr[a];this.gamepad.buttons[0]&&(e.setValueType(i.button.trigger.pressed,this.gamepad.buttons[0].pressed),e.setValueType(i.button.trigger.touched,this.gamepad.buttons[0].touched),e.setValueType(i.button.trigger.value,this.gamepad.buttons[0].value)),this.gamepad.buttons[1]&&(e.setValueType(i.button.grip.pressed,this.gamepad.buttons[1].pressed),e.setValueType(i.button.grip.touched,this.gamepad.buttons[1].touched),e.setValueType(i.button.grip.value,this.gamepad.buttons[1].value)),this.gamepad.buttons[2]&&(e.setValueType(i.button.touchpad.pressed,this.gamepad.buttons[2].pressed),e.setValueType(i.button.touchpad.touched,this.gamepad.buttons[2].touched),e.setValueType(i.button.touchpad.value,this.gamepad.buttons[2].value)),this.gamepad.buttons[3]&&(e.setValueType(i.button.thumbStick.pressed,this.gamepad.buttons[3].pressed),e.setValueType(i.button.thumbStick.touched,this.gamepad.buttons[3].touched),e.setValueType(i.button.thumbStick.value,this.gamepad.buttons[3].value)),this.gamepad.buttons[4]&&(e.setValueType(i.button.a.pressed,this.gamepad.buttons[4].pressed),e.setValueType(i.button.a.touched,this.gamepad.buttons[4].touched),e.setValueType(i.button.a.value,this.gamepad.buttons[4].value)),this.gamepad.buttons[5]&&(e.setValueType(i.button.b.pressed,this.gamepad.buttons[5].pressed),e.setValueType(i.button.b.touched,this.gamepad.buttons[5].touched),e.setValueType(i.button.b.value,this.gamepad.buttons[5].value)),this.gamepad.axes.length>=4&&(e.setValueType(i.axis.touchpadX,this.gamepad.axes[0]),e.setValueType(i.axis.touchpadY,this.gamepad.axes[1]),e.setValueType(i.axis.joyX,this.gamepad.axes[2]),e.setValueType(i.axis.joyY,this.gamepad.axes[3])),this.rayObject=this.rayObject||document.querySelector(this.selector).object3D,this.rayObject.updateMatrixWorld(),this.rayObjectRotation.setFromRotationMatrix(l_.extractRotation(this.rayObject.matrixWorld)),this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld),this.pose.direction.set(0,0,-1).applyQuaternion(this.rayObjectRotation),this.pose.orientation.copy(this.rayObjectRotation),e.setPose(i.pose,this.pose);const r=t.frame.getPose(this.gamepad.targetRaySpace,n);r&&r.transform.position&&r.transform.orientation&&(this.position.copy(r.transform.position),this.orientation.copy(r.transform.orientation),this.matrix.compose(this.position,this.orientation,r_),this.matrix.multiply("left"===a?o_:s_),e.setMatrix4(i.matrix,this.matrix))}}const d_=2*Math.PI;class u_{constructor(e){this.items=new Array(e).fill(0),this.writePtr=0}push(e){this.items[this.writePtr]=e,this.writePtr=(this.writePtr+1)%this.items.length}}const h_=Math.abs,p_=(e,t)=>{const n=e-t,a=e+d_-t,i=e-(t+d_);return h_(n)<h_(a)&&h_(n)<h_(i)?n:h_(a)<h_(i)?a:i},m_=e=>{let t=0;for(let n=0;n<e.length;n++){t+=e[n]}return t/e.length};class f_{constructor(){this.hmdEuler=new THREE.Euler,this.hmdQuaternion=new THREE.Quaternion,this.prevX=this.hmdEuler.x,this.prevY=this.hmdEuler.y,this.dXBuffer=new u_(6),this.dYBuffer=new u_(6),this.hasPolyfill=window.webvrpolyfill,this.hasPolyfill&&(this.vrDisplay=window.webvrpolyfill.getPolyfillDisplays()[0],this.frameData=new window.webvrpolyfill.constructor.VRFrameData),this.enableGyro=window.APP.store.state.preferences.enableGyro,window.APP.store.addEventListener("statechanged",()=>{this.enableGyro=window.APP.store.state.preferences.enableGyro})}write(e){if(!(this.enableGyro&&this.hasPolyfill&&this.vrDisplay&&this.frameData))return;const t=this.hmdEuler;if(this.vrDisplay.getFrameData(this.frameData),null!==this.frameData.pose.orientation&&(this.hmdQuaternion.fromArray(this.frameData.pose.orientation),t.setFromQuaternion(this.hmdQuaternion,"YXZ")),t.x<.475*-Math.PI)return;const n=p_(t.x,this.prevX),a=p_(t.y,this.prevY);this.dXBuffer.push(Math.abs(n)<.001?0:n),this.dYBuffer.push(Math.abs(a)<.001?0:a),this.averageDeltaX=m_(this.dXBuffer.items),this.averageDeltaY=m_(this.dYBuffer.items),this.prevX=t.x,this.prevY=t.y,e.setValueType(Xe.a.device.gyro.averageDeltaX,this.averageDeltaX),e.setValueType(Xe.a.device.gyro.averageDeltaY,this.averageDeltaY)}}function g_(e){const t=this.el.sceneEl.systems["hubs-systems"].physicsSystem,n=t.getCollisions(e.uuid);if(n)for(let e=0;e<n.length;e++){const a=t.bodyUuidToData.get(n[e]),i=a&&a.object3D;if(i&&Object(gi.a)(i.el,"isHandCollisionTarget"))return i.el}return null}const v_=new Map,b_=new Map;function y_(e){if(!e)return null;if(v_.get(e))return null;return b_.get(e)||y_(e.parent)}function E_(e){return Object(gi.a)(e,"singleActionButton")||Object(gi.a)(e,"holdableButton")}function w_(e){return e}AFRAME.registerComponent("is-remote-hover-target",{init:function(){b_.set(this.el.object3D,this.el)},remove:function(){b_.delete(this.el.object3D)}}),AFRAME.registerComponent("is-not-remote-hover-target",{init:function(){v_.set(this.el.object3D,this.el)},remove:function(){v_.delete(this.el.object3D)}}),AFRAME.registerSystem("interaction",{updateCursorIntersection:function(e,t){return t?(this.leftRemoteHoverTarget=e&&y_(e.object),this.leftRemoteHoverTarget):(this.rightRemoteHoverTarget=e&&y_(e.object),this.rightRemoteHoverTarget)},getActiveIntersection(){return this.state.rightRemote.hovered&&this.rightCursorControllerEl.components["cursor-controller"].intersection||this.state.leftRemote.hovered&&this.leftCursorControllerEl.components["cursor-controller"].intersection},isHoldingAnything(e=w_){return!!(e(this.state.leftHand.held)||e(this.state.rightHand.held)||e(this.state.rightRemote.held)||e(this.state.leftRemote.held))},isHeld(e){return this.state.leftHand.held===e||this.state.rightHand.held===e||this.state.rightRemote.held===e||this.state.leftRemote.held===e},wasReleasedThisFrame(e){return this.previousState.leftHand.held===e&&!this.state.leftHand.held||this.previousState.rightHand.held===e&&!this.state.rightHand.held||this.previousState.rightRemote.held===e&&!this.state.rightRemote.held||this.previousState.leftRemote.held===e&&!this.state.leftRemote.held},release(e){this.state.leftHand.held===e&&(this.state.leftHand.held=null),this.state.leftHand.hovered===e&&(this.state.leftHand.hovered=null),this.state.leftHand.held===e&&(this.state.leftHand.held=null),this.state.rightHand.hovered===e&&(this.state.rightHand.hovered=null),this.state.rightRemote.held===e&&(this.state.rightRemote.held=null),this.state.rightRemote.hovered===e&&(this.state.rightRemote.hovered=null),this.state.leftRemote.held===e&&(this.state.leftRemote.held=null),this.state.leftRemote.hovered===e&&(this.state.leftRemote.hovered=null)},getRightRemoteHoverTarget(){return this.rightRemoteHoverTarget},getLeftRemoteHoverTarget(){return this.leftRemoteHoverTarget},init:function(){this.options={leftHand:{entity:null,grabPath:Xe.a.actions.leftHand.grab,dropPath:Xe.a.actions.leftHand.drop,hoverFn:g_},rightHand:{entity:null,grabPath:Xe.a.actions.rightHand.grab,dropPath:Xe.a.actions.rightHand.drop,hoverFn:g_},rightRemote:{entity:null,grabPath:Xe.a.actions.cursor.right.grab,dropPath:Xe.a.actions.cursor.right.drop,hoverFn:this.getRightRemoteHoverTarget},leftRemote:{entity:null,grabPath:Xe.a.actions.cursor.left.grab,dropPath:Xe.a.actions.cursor.left.drop,hoverFn:this.getLeftRemoteHoverTarget}},this.state={leftHand:{hovered:null,held:null,spawning:null},rightHand:{hovered:null,held:null,spawning:null},rightRemote:{hovered:null,held:null,spawning:null},leftRemote:{hovered:null,held:null,spawning:null}},this.previousState={leftHand:{hovered:null,held:null,spawning:null},rightHand:{hovered:null,held:null,spawning:null},rightRemote:{hovered:null,held:null,spawning:null},leftRemote:{hovered:null,held:null,spawning:null}},Object(Ue.b)().then(()=>{this.options.leftHand.entity=document.getElementById("player-left-controller"),this.options.rightHand.entity=document.getElementById("player-right-controller"),this.options.rightRemote.entity=document.getElementById("right-cursor"),this.options.leftRemote.entity=document.getElementById("left-cursor"),this.rightCursorControllerEl=document.getElementById("right-cursor-controller"),this.leftCursorControllerEl=document.getElementById("left-cursor-controller"),this.ready=!0})},tickInteractor(e,t){const n=AFRAME.scenes[0].systems.userinput;if(t.held){const a=t.held.components.networked,i=a&&a.data&&a.data.owner!==NAF.clientId;(n.get(e.dropPath)||i)&&(t.held=null)}else if(t.hovered=e.hoverFn.call(this,e.entity.components["body-helper"]&&e.entity.components["body-helper"]?e.entity.components["body-helper"]:null),t.hovered){const a=t.hovered,i=this.el.is("frozen"),r=a.components.pinnable&&a.components.pinnable.data.pinned;Object(gi.a)(a,"isHoldable")&&n.get(e.grabPath)&&(i||!r)&&Object(v.c)(a)&&(t.held=a)}},tick2(){this.el.is("entered")&&(Object.assign(this.previousState.rightHand,this.state.rightHand),Object.assign(this.previousState.rightRemote,this.state.rightRemote),Object.assign(this.previousState.leftHand,this.state.leftHand),Object.assign(this.previousState.leftRemote,this.state.leftRemote),this.options.leftHand.entity.object3D.visible&&!this.state.leftRemote.held&&this.tickInteractor(this.options.leftHand,this.state.leftHand),this.options.rightHand.entity.object3D.visible&&!this.state.rightRemote.held&&this.tickInteractor(this.options.rightHand,this.state.rightHand),this.state.rightHand.held||this.state.rightHand.hovered||this.tickInteractor(this.options.rightRemote,this.state.rightRemote),this.state.leftHand.held||this.state.leftHand.hovered||this.tickInteractor(this.options.leftRemote,this.state.leftRemote))}});class __{constructor(){this.prevButtonLeft=!1,this.clickedOnAnything=!1,this.cursorPose=new pw,this.prevCursorPose=new pw,this.origin=new THREE.Vector3,this.prevOrigin=new THREE.Vector3,this.direction=new THREE.Vector3,this.prevDirection=new THREE.Vector3}write(e){if(this.prevCursorPose.copy(this.cursorPose),this.prevOrigin.copy(this.origin),this.prevDirection.copy(this.prevDirection),!this.cursorController){const e=document.getElementById("right-cursor-controller");e&&e.components&&(this.cursorController=e.components["cursor-controller"])}this.camera||(this.camera=AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.viewingCamera);const t=e.get(Xe.a.device.mouse.buttonLeft),n=e.get(Xe.a.device.mouse.buttonRight);if(t&&!this.prevButtonLeft&&this.cursorController){const e=[];this.cursorController.raycaster.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,e);const t=e.find(e=>e.object.el),n=t&&y_(t.object),a=AFRAME.scenes[0].systems.userinput,i=t&&t.object.el.matches(".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon"),r=n&&n.components.pinnable&&n.components.pinnable.data.pinned,o=AFRAME.scenes[0].is("frozen"),s=n&&n.components.networked&&n.components.networked.data.template,l=s&&"#static-controlled-media"===s,c=s&&"#static-media"===s;this.clickedOnAnything=i&&(o||!r)&&n&&Object(v.c)(n)&&!l&&!c||a.activeSets.includes(ew.rightCursorHoldingPen)||a.activeSets.includes(ew.rightCursorHoldingInteractable)||a.activeSets.includes(ew.rightCursorHoldingCamera)}if(this.prevButtonLeft=t,t||(this.clickedOnAnything=!1),!this.clickedOnAnything&&t||n){const t=e.get(Xe.a.device.mouse.movementXY);t&&e.setVector2(Xe.a.device.smartMouse.cameraDelta,t[0],t[1]),e.setValueType(Xe.a.device.smartMouse.shouldMoveCamera,!0)}if(this.camera){const t=e.get(Xe.a.device.mouse.coords);e.setPose(Xe.a.device.smartMouse.cursorPose,function(e,t,n,a,i){return n.setFromMatrixPosition(e.matrixWorld),a.set(t[0],t[1],.5).unproject(e).sub(n).normalize(),i.fromOriginAndDirection(n,a),i}(this.camera,t,this.origin,this.direction,this.cursorPose))}}}function S_(e,t){return void 0!==t.find(t=>t.touch.identifier===e.identifier)}function x_(e,t){return void 0!==t.find(t=>t.job===e)}function A_(e,t,n){if(S_(e,n)||x_(t,n))return void console.error("cannot reassign touches or jobs. unassign first");const a={job:t,touch:e};return n.push(a),a}function M_(e,t,n){n.splice(n.findIndex((function(n){return n.touch.identifier===e.identifier&&n.job===t})),1)}function k_(e,t){return t.find(t=>t.job===e)}function O_(e,t){return t.find(t=>t.touch.identifier===e.identifier)}var C_=n(322);const P_=[Xe.a.device.touchscreen.tap1,Xe.a.device.touchscreen.tap2,Xe.a.device.touchscreen.tap3,Xe.a.device.touchscreen.tap4,Xe.a.device.touchscreen.tap5];function R_(e,t,n,a){const i=e-n,r=t-a;return Math.sqrt(i*i+r*r)}const T_=function(){return AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.viewingCamera};class j_{constructor(){this.raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3,0,100),this.assignments=[],this.pinch={initialDistance:0,currentDistance:0,delta:0},this.pendingTap={maxTouchCount:0,startedAt:0},this.tapIndexToWriteNextFrame=0,this.canvas=document.querySelector("canvas"),this.events=[],["touchstart","touchend","touchmove","touchcancel"].map(e=>this.canvas.addEventListener(e,this.events.push.bind(this.events))),this.canvasRect=this.canvas.getBoundingClientRect(),new C_.a(()=>this.canvasRect=this.canvas.getBoundingClientRect()).observe(this.canvas)}end(e){if(S_(e,this.assignments)){const t=O_(e,this.assignments);switch(t.job){case"MOVE CURSOR":case"MOVE CAMERA":t.framesUntilGrab>=0?t.framesUntilUnassign=t.framesUntilGrab+2:M_(t.touch,t.job,this.assignments);break;case"FIRST PINCHER":if(M_(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},x_("SECOND PINCHER",this.assignments)){const e=k_("SECOND PINCHER",this.assignments);if(M_(e.touch,e.job,this.assignments),x_("MOVE CAMERA",this.assignments)){const t=A_(e.touch,"FIRST PINCHER",this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}else{const t=A_(e.touch,"MOVE CAMERA",this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}break;case"SECOND PINCHER":if(M_(t.touch,t.job,this.assignments),this.pinch={initialDistance:0,currentDistance:0,delta:0},x_("FIRST PINCHER",this.assignments)&&!x_("MOVE CAMERA",this.assignments)){const e=k_("FIRST PINCHER",this.assignments);M_(e.touch,e.job,this.assignments);const t=A_(e.touch,"MOVE CAMERA",this.assignments);t.clientX=e.clientX,t.clientY=e.clientY,t.delta=[0,0]}}}else console.warn("touch does not have a job",e);0===this.assignments.length&&(this.pendingTap.maxTouchCount>0&&performance.now()-this.pendingTap.startedAt<=125&&(this.tapIndexToWriteNextFrame=this.pendingTap.maxTouchCount),this.pendingTap={maxTouchCount:0})}move(e){if(!S_(e,this.assignments))return void(e.target.classList[0]&&e.target.classList[0].startsWith("virtual-gamepad-controls")||console.warn("touch does not have job",e));const t=O_(e,this.assignments);switch(t.job){case"MOVE CURSOR":t.framesUntilGrab<0&&t.cursorPose.fromCameraProjection(T_(),(e.clientX-this.canvasRect.left)/this.canvasRect.width*2-1,-(e.clientY-this.canvasRect.top)/this.canvasRect.height*2+1);break;case"MOVE CAMERA":t.delta[0]+=e.clientX-t.clientX,t.delta[1]+=e.clientY-t.clientY,t.clientX=e.clientX,t.clientY=e.clientY;break;case"FIRST PINCHER":case"SECOND PINCHER":if(t.clientX=e.clientX,t.clientY=e.clientY,x_("FIRST PINCHER",this.assignments)&&x_("SECOND PINCHER",this.assignments)){const e=k_("FIRST PINCHER",this.assignments),t=k_("SECOND PINCHER",this.assignments),n=R_(e.clientX,e.clientY,t.clientX,t.clientY);this.pinch.delta+=n-this.pinch.currentDistance,this.pinch.currentDistance=n}}}start(e){if(S_(e,this.assignments))return void console.error("touch already has a job");const t=0===this.assignments.length,n=1===this.assignments.length,a=2===this.assignments.length,i=!!k_("SECOND PINCHER",this.assignments);if(t||a&&i){let t;!function(e,t,n){if(!!AFRAME.scenes[0].systems.interaction.state.rightRemote.held)return!0;const a=[];n.setFromCamera({x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1},T_()),n.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,a);const i=a.find(e=>e.object.el),r=i&&i.object.el.matches(".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon"),o=i&&y_(i.object),s=o&&o.components.pinnable&&o.components.pinnable.data.pinned,l=AFRAME.scenes[0].is("frozen"),c=o&&o.components.networked&&o.components.networked.data.template;return r&&(l||!s)&&!(c&&"#static-controlled-media"===c)&&!(c&&"#static-media"===c)&&o&&(Object(v.c)(o)||(d=o).components.tags&&d.components.tags.data.singleActionButton);var d}(e,this.canvasRect,this.raycaster)?(t=A_(e,"MOVE CAMERA",this.assignments),t.delta=[0,0]):(t=A_(e,"MOVE CURSOR",this.assignments),t.framesUntilGrab=8),t.clientX=e.clientX,t.clientY=e.clientY,t.cursorPose=(new pw).fromCameraProjection(T_(),(e.clientX-this.canvasRect.left)/this.canvasRect.width*2-1,-(e.clientY-this.canvasRect.top)/this.canvasRect.height*2+1)}else if(n||a){const t=k_("MOVE CURSOR",this.assignments);if(n&&t&&t.framesUntilGrab<0){const t=A_(e,"FIRST PINCHER",this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}else{if(n){const e=this.assignments[0];M_(e.touch,e.job,this.assignments);const t=A_(e.touch,"FIRST PINCHER",this.assignments);t.clientX=e.clientX,t.clientY=e.clientY}const t=k_("FIRST PINCHER",this.assignments);if(!t){const t=A_(e,"FIRST PINCHER",this.assignments);return t.clientX=e.clientX,void(t.clientY=e.clientY)}{const n=A_(e,"SECOND PINCHER",this.assignments);n.clientX=e.clientX,n.clientY=e.clientY;const a=R_(t.clientX,t.clientY,n.clientX,n.clientY);this.pinch={initialDistance:a,currentDistance:a,delta:0}}}}0===this.pendingTap.maxTouchCount&&this.assignments.length>0&&(this.pendingTap.startedAt=performance.now()),this.pendingTap.maxTouchCount=Math.max(this.pendingTap.maxTouchCount,this.assignments.length)}process(e){switch(e.type){case"touchstart":for(const t of e.changedTouches)this.start(t);break;case"touchmove":for(const t of e.touches)this.move(t);break;case"touchend":case"touchcancel":for(const t of e.changedTouches)this.end(t)}}write(e){this.pinch&&(this.pinch.delta=0);const t=x_("MOVE CAMERA",this.assignments)&&k_("MOVE CAMERA",this.assignments);for(t&&(t.delta[0]=0,t.delta[1]=0),this.events.forEach(e=>{this.process(e)});this.events.length;)this.events.pop();const n=Xe.a.device.touchscreen,a=x_("MOVE CURSOR",this.assignments),i=x_("MOVE CAMERA",this.assignments);if(a||i){e.setValueType(n.isTouching,!0);const t=k_("MOVE CURSOR",this.assignments)||k_("MOVE CAMERA",this.assignments);e.setPose(n.cursorPose,t.cursorPose)}if(e.setValueType(n.isTouchingGrabbable,!1),a){const t=k_("MOVE CURSOR",this.assignments);e.setValueType(n.isTouchingGrabbable,t.framesUntilGrab<=0),t.framesUntilGrab--,t.framesUntilUnassign>=0&&(0===t.framesUntilUnassign&&M_(t.touch,t.job,this.assignments),t.framesUntilUnassign--)}if(i){const t=k_("MOVE CAMERA",this.assignments).delta;e.setVector2(n.touchCameraDelta,t[0]/this.canvas.clientWidth,t[1]/this.canvas.clientHeight)}e.setValueType(n.pinch.delta,this.pinch.delta),e.setValueType(n.pinch.initialDistance,this.pinch.initialDistance),e.setValueType(n.pinch.currentDistance,this.pinch.currentDistance),this.tapIndexToWriteNextFrame&&this.tapIndexToWriteNextFrame<P_.length&&e.setValueType(P_[this.tapIndexToWriteNextFrame-1],!0),this.tapIndexToWriteNextFrame=0,e.setValueType(n.anything,0!==this.assignments.length)}}const D_={noop:function(){},copy:function(e,t,n){e.setValueType(n.value,e.get(t.value))},scale:function(e){return function(t,n,a){void 0!==t.get(n.value)&&t.setValueType(a.value,t.get(n.value)*e)}},scaleExp:function(e,t=1){return function(n,a,i){void 0!==n.get(a.value)&&(1===t?n.setValueType(i.value,n.get(a.value)*e):n.setValueType(i.value,Math.pow(n.get(a.value),t)*e))}},deadzone:function(e){return function(t,n,a){t.setValueType(a.value,Math.abs(t.get(n.value))<e?0:t.get(n.value))}},split_vec2:function(e,t,n){const a=e.get(t.value);void 0!==a&&(e.setValueType(n.x,a[0]),e.setValueType(n.y,a[1]))},compose_vec2:function(e,t,n){const a=e.get(t.x),i=e.get(t.y);void 0!==a&&void 0!==i&&e.setVector2(n.value,a,i)},negate:function(e,t,n){e.setValueType(n.value,-e.get(t.value))},copyIfFalse:function(e,t,n){e.setValueType(n.value,e.get(t.bool)?void 0:e.get(t.value))},copyIfTrue:function(e,t,n){e.setValueType(n.value,e.get(t.bool)?e.get(t.value):void 0)},copyVec2IfTrue:function(e,t,n){if(e.get(t.bool)){const a=e.get(t.value);e.setVector2(n.value,a[0],a[1])}},zeroIfDefined:function(e,t,n){e.setValueType(n.value,void 0!==e.get(t.bool)?0:e.get(t.value))},true:function(e,t,n){e.setValueType(n.value,!0)},rising:function(e,t,n,a){return e.setValueType(n.value,e.get(t.value)&&!1===a),!!e.get(t.value)},risingWithFrameDelay:function(e){return function(t,n,a,i={values:new Array(e)}){return t.setValueType(a.value,i.values.shift()),i.values.push(t.get(n.value)&&!i.prev),i.prev=t.get(n.value),i}},falling:function(e,t,n,a){return e.setValueType(n.value,!e.get(t.value)&&a),!!e.get(t.value)},vec2Zero:function(e,t,n){e.setVector2(n.value,0,0)},poseFromCameraProjection:function(){const e=new pw;return function(t,n,a){const i=AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.viewingCamera,r=t.get(n.value);t.setPose(a.value,e.fromCameraProjection(i,r[0],r[1]))}},vec2dpad:function(e,t=!1,n=!1){const a=e*e;return function(e,i,r){if(!e.get(i.value))return;const[o,s]=e.get(i.value),l=o*o+s*s<a?"center":(c=((c=Math.atan2(t?-o:o,n?-s:s))*THREE.Math.RAD2DEG+180+45)%360)>0&&c<90?"north":c>=90&&c<180?"west":c>=180&&c<270?"south":"east";var c;r[l]&&e.setValueType(r[l],!0)}},always:function(e){return function(t,n,a){t.setValueType(a.value,e)}},wasd_to_vec2:function(e,{w:t,a:n,s:a,d:i},{vec2:r}){let o=0,s=0;e.get(n)&&(o-=1),e.get(i)&&(o+=1),e.get(t)&&(s+=1),e.get(a)&&(s-=1),e.setVector2(r,o,s)},add_vec2:function(e,t,n){const a=e.get(t.first),i=e.get(t.second);a&&i?e.setVector2(n.value,a[0]+i[0],a[1]+i[1]):i?e.setVector2(n.value,i[0],i[1]):a&&e.setVector2(n.value,a[0],a[1])},max_vec2:function(e,t,n){const a=e.get(t.first),i=e.get(t.second);if(a&&i){const t=a[0]*a[0]+a[1]*a[1]>i[0]*i[0]+i[1]*i[1]?a:i;e.setVector2(n.value,t[0],t[1])}else i?e.setVector2(n.value,i[0],i[1]):a&&e.setVector2(n.value,a[0],a[1])},normalize_vec2:function(e,t,n){const a=e.get(t.value);if(a)if(0===a[0]&&0===a[0])e.setVector2(n.value,a[0],a[1]);else{const t=Math.sqrt(a[0]*a[0]+a[1]*a[1]);e.setVector2(n.value,a[0]/t,a[1]/t)}},all:function(e,t,n){for(let a=0,i=t.length;a<i;a++){const i=t[a];if(!e.get(i))return void e.setValueType(n.value,!1)}e.setValueType(n.value,!0)},any:function(e,t,n){for(let a=0,i=t.length;a<i;a++){const i=t[a];if(e.get(i))return void e.setValueType(n.value,!0)}e.setValueType(n.value,!1)},touch_axis_scroll:(e=1,t)=>function(n,a,i,r={value:0,touching:!1}){return(void 0===t||Math.abs(n.get(a.value)-r.value)>=t)&&n.setValueType(i.value,r.touching&&n.get(a.touching)?e*(n.get(a.value)-r.value):0),r.value=n.get(a.value),r.touching=n.get(a.touching),r},diff_vec2:function(e,t,n,a=[0,0]){const i=e.get(t.value);return i&&(e.setVector2(n.value,i[0]-a[0],i[1]-a[1]),a[0]=i[0],a[1]=i[1]),a},invert_vec2_if_preference:e=>function(t,n,a){const i=t.get(n.value);if(i){const n=window.APP&&window.APP.store&&window.APP.store.state&&window.APP.store.state.preferences&&(window.APP.store.state.preferences[e]||void 0===window.APP.store.state.preferences[e])?-1:1;t.setVector2(a.value,i[0]*n,i[1]*n)}}},I_=e=>{for(const t in e)for(const n of e[t])n.sets||(n.sets=[]),n.sets.push(t);return e},L_="/vars/mouse-and-keyboard/drop_pen_with_p",H_="/vars/mouse-and-keyboard/drop_pen_with_hud",N_=new URLSearchParams(location.search),F_=parseFloat(N_.get("izs"))||-10,V_=e=>"/keyboard-mouse-user/keyboard-var/".concat(e),B_=I_({[ew.global]:[{src:{},dest:{value:Xe.a.actions.cursor.right.hideLine},xform:D_.always(!0)},{src:{},dest:{value:Xe.a.actions.cursor.right.wake},xform:D_.always(!0)},{src:{},dest:{value:Xe.a.actions.cursor.left.wake},xform:D_.always(!1)},{src:{w:Xe.a.device.keyboard.key("arrowup"),a:Xe.a.device.keyboard.key("arrowleft"),s:Xe.a.device.keyboard.key("arrowdown"),d:Xe.a.device.keyboard.key("arrowright")},dest:{vec2:"/var/mouse-and-keyboard/arrows_vec2"},xform:D_.wasd_to_vec2},{src:{w:Xe.a.device.keyboard.key("w"),a:Xe.a.device.keyboard.key("a"),s:Xe.a.device.keyboard.key("s"),d:Xe.a.device.keyboard.key("d")},dest:{vec2:"/var/mouse-and-keyboard/wasd_vec2"},xform:D_.wasd_to_vec2},{src:{first:"/var/mouse-and-keyboard/wasd_vec2",second:"/var/mouse-and-keyboard/arrows_vec2"},dest:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},xform:D_.max_vec2},{src:{value:"/var/mouse-and-keyboard/keyboardCharacterAcceleration"},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.normalize_vec2},{src:{value:Xe.a.device.mouse.wheel},dest:{value:Xe.a.actions.dCharSpeed},xform:D_.scale(-.3)},{src:{value:Xe.a.device.keyboard.key("shift")},dest:{value:Xe.a.actions.boost},xform:D_.copy,priority:1},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:Xe.a.actions.camera.exitMirror},xform:D_.falling},{src:{value:Xe.a.device.keyboard.key("q")},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("g")},dest:{value:Xe.a.actions.toggleFly},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("`")},dest:{value:Xe.a.actions.toggleUI},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("e")},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("Tab")},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:Xe.a.actions.ensureFrozen},xform:D_.copy},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:Xe.a.actions.thaw},xform:D_.falling},{src:{value:Xe.a.device.keyboard.key("p")},dest:{value:L_},xform:D_.rising},{src:{value:Xe.a.device.hud.penButton},dest:{value:H_},xform:D_.rising},{src:[H_,L_],dest:{value:"/vars/mouse-and-keyboard/togglePen"},xform:D_.any},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:Xe.a.actions.spawnPen},xform:D_.rising,priority:100},{src:{value:Xe.a.device.keyboard.key("c")},dest:{value:Xe.a.actions.toggleCamera},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("x")},dest:{value:Xe.a.actions.takeSnapshot},xform:D_.copy},{src:{value:Xe.a.device.smartMouse.cursorPose},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:Xe.a.device.mouse.coords},dest:{value:"/var/mouseCoordsDelta"},xform:D_.diff_vec2},{src:{value:"/var/mouseCoordsDelta"},dest:{x:"/var/mouseCoordsX",y:"/var/mouseCoordsY"},xform:D_.split_vec2},{src:{value:"/var/mouseCoordsX"},dest:{value:"/var/mouseCoordsXScaled"},xform:D_.scale(-Math.PI)},{src:{value:"/var/mouseCoordsY"},dest:{value:"/var/mouseCoordsYScaled"},xform:D_.scale(2*Math.PI/3)},{src:{x:"/var/mouseCoordsXScaled",y:"/var/mouseCoordsYScaled"},dest:{value:"/var/actions/cameraDelta"},xform:D_.compose_vec2},{src:{value:"/var/actions/cameraDelta",bool:Xe.a.device.smartMouse.shouldMoveCamera},dest:{value:Xe.a.actions.cameraDelta},xform:D_.copyVec2IfTrue},{src:{value:Xe.a.actions.cameraDelta},dest:{value:Xe.a.actions.lobbyCameraDelta},xform:D_.copy},{src:{value:Xe.a.device.keyboard.key("m")},dest:{value:Xe.a.actions.muteMic},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("t")},dest:{value:Xe.a.actions.focusChat},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("/")},dest:{value:Xe.a.actions.focusChatCommand},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:Xe.a.actions.mediaExit},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/control+1"},xform:D_.copyIfTrue},{src:{value:"/var/control+1"},dest:{value:Xe.a.actions.mediaSearch1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/control+2"},xform:D_.copyIfTrue},{src:{value:"/var/control+2"},dest:{value:Xe.a.actions.mediaSearch2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/control+3"},xform:D_.copyIfTrue},{src:{value:"/var/control+3"},dest:{value:Xe.a.actions.mediaSearch3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/control+4"},xform:D_.copyIfTrue},{src:{value:"/var/control+4"},dest:{value:Xe.a.actions.mediaSearch4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/control+5"},xform:D_.copyIfTrue},{src:{value:"/var/control+5"},dest:{value:Xe.a.actions.mediaSearch5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/control+6"},xform:D_.copyIfTrue},{src:{value:"/var/control+6"},dest:{value:Xe.a.actions.mediaSearch6},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/control+7"},xform:D_.copyIfTrue},{src:{value:"/var/control+7"},dest:{value:Xe.a.actions.mediaSearch7},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("8")},dest:{value:"/var/control+8"},xform:D_.copyIfTrue},{src:{value:"/var/control+8"},dest:{value:Xe.a.actions.mediaSearch8},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("l")},dest:{value:Xe.a.actions.logDebugFrame},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("k")},dest:{value:Xe.a.actions.logInteractionState},xform:D_.rising},{src:{value:Xe.a.device.mouse.buttonRight},dest:{value:Xe.a.actions.startGazeTeleport},xform:D_.rising,priority:100},{src:{value:Xe.a.device.mouse.buttonRight},dest:{value:Xe.a.actions.stopGazeTeleport},xform:D_.falling,priority:100},{src:{value:Xe.a.device.keyboard.key("o")},dest:{value:Xe.a.actions.nextCameraMode},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/notcontrol+1"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+1"},dest:{value:Xe.a.actions.spawnEmoji0},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/notcontrol+2"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+2"},dest:{value:Xe.a.actions.spawnEmoji1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/notcontrol+3"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+3"},dest:{value:Xe.a.actions.spawnEmoji2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/notcontrol+4"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+4"},dest:{value:Xe.a.actions.spawnEmoji3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/notcontrol+5"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+5"},dest:{value:Xe.a.actions.spawnEmoji4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/notcontrol+6"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+6"},dest:{value:Xe.a.actions.spawnEmoji5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/notcontrol+7"},xform:D_.copyIfFalse},{src:{value:"/var/notcontrol+7"},dest:{value:Xe.a.actions.spawnEmoji6},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("i")},dest:{value:Xe.a.actions.startInspectingSelf},xform:D_.rising}],[ew.rightCursorHoldingPen]:[{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.keyboard.key("q")},dest:{value:"/var/shift+q"},xform:D_.copyIfTrue,priority:1},{src:{value:"/var/shift+q"},dest:{value:Xe.a.actions.cursor.right.penPrevColor},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.keyboard.key("e")},dest:{value:"/var/shift+e"},xform:D_.copyIfTrue,priority:1},{src:{value:"/var/shift+e"},dest:{value:Xe.a.actions.cursor.right.penNextColor},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.keyboard.key("q")},dest:{value:"/var/notshift+q"},xform:D_.copyIfFalse,priority:1},{src:{value:"/var/notshift+q"},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.rising,priority:200},{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.keyboard.key("e")},dest:{value:"/var/notshift+e"},xform:D_.copyIfFalse,priority:1},{src:{value:"/var/notshift+e"},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.rising,priority:200},{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.rising,priority:3},{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:3},{src:{value:V_("wheelWithShift")},dest:{value:"/var/cursorScalePenTipWheel"},xform:D_.copy,priority:200},{src:{value:"/var/cursorScalePenTipWheel"},dest:{value:Xe.a.actions.cursor.right.scalePenTip},xform:D_.scale(.03)},{src:{value:Xe.a.device.mouse.buttonRight},dest:{value:"/vars/mouse-and-keyboard/drop_pen_with_RMB"},xform:D_.falling,priority:200},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:"/vars/mouse-and-keyboard/drop_pen_with_esc"},xform:D_.rising},{src:["/vars/mouse-and-keyboard/drop_pen_with_RMB","/vars/mouse-and-keyboard/drop_pen_with_esc",L_,H_],dest:{value:"/vars/mouse-and-keyboard/togglePen"},xform:D_.any},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("z")},dest:{value:Xe.a.actions.cursor.right.undoDrawing},priority:1001,xform:D_.rising},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.rising,priority:200},{src:{value:"/vars/mouse-and-keyboard/togglePen"},dest:{value:Xe.a.actions.pen.remove},xform:D_.rising,priority:200}],[ew.rightCursorHoldingCamera]:[{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.falling,priority:2},{src:{value:V_("wheelWithShift")},dest:{value:Xe.a.actions.cursor.right.scaleGrabbedGrabbable},xform:D_.noop,priority:2}],[ew.rightCursorHoldingInteractable]:[{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.mouse.wheel},dest:{value:V_("wheelWithShift")},xform:D_.copyIfTrue,priority:1},{src:{bool:Xe.a.device.keyboard.key("shift"),value:Xe.a.device.mouse.wheel},dest:{value:V_("wheelWithoutShift")},xform:D_.copyIfFalse,priority:1},{src:{value:V_("wheelWithoutShift")},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.copy},{src:{value:V_("wheelWithShift")},dest:{value:Xe.a.actions.cursor.right.scaleGrabbedGrabbable},xform:D_.copy},{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.falling,priority:2}],[ew.rightCursorHoldingUI]:[{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.falling,priority:3},{src:{value:Xe.a.device.keyboard.key("shift")},dest:{value:Xe.a.actions.transformModifier},xform:D_.copy,priority:1}],[ew.rightCursorHoveringOnInteractable]:[{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising,priority:1},{src:{value:Xe.a.device.mouse.buttonRight},dest:{value:"/vars/mouse-and-keyboard/startInspectingViaMouse"},xform:D_.rising,priority:200},{src:{value:Xe.a.device.keyboard.key("f")},dest:{value:"/vars/mouse-and-keyboard/startInspectingViaKeyboard"},xform:D_.rising,priority:200},{src:["/vars/mouse-and-keyboard/startInspectingViaMouse","/vars/mouse-and-keyboard/startInspectingViaKeyboard"],dest:{value:Xe.a.actions.startInspecting},xform:D_.any,priority:201}],[ew.rightCursorHoveringOnVideo]:[{src:{value:Xe.a.device.mouse.wheel},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.scale(-.3),priority:1}],[ew.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:Xe.a.noop},xform:D_.noop,priority:1e3},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/control+1"},xform:D_.copyIfTrue,priority:1001},{src:{value:"/var/control+1"},dest:{value:Xe.a.actions.mediaSearch1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/control+2"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+2"},dest:{value:Xe.a.actions.mediaSearch2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/control+3"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+3"},dest:{value:Xe.a.actions.mediaSearch3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/control+4"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+4"},dest:{value:Xe.a.actions.mediaSearch4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/control+5"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+5"},dest:{value:Xe.a.actions.mediaSearch5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/control+6"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+6"},dest:{value:Xe.a.actions.mediaSearch6},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/control+7"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+7"},dest:{value:Xe.a.actions.mediaSearch7},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("8")},dest:{value:"/var/control+8"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/control+8"},dest:{value:Xe.a.actions.mediaSearch8},xform:D_.rising}],[ew.rightCursorHoveringOnUI]:[{src:{value:Xe.a.device.mouse.buttonLeft},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising}],[ew.inspecting]:[{src:{value:Xe.a.device.keyboard.key("space")},dest:{value:V_("space-rising")},xform:D_.rising},{src:[Xe.a.device.keyboard.key("Escape"),Xe.a.device.keyboard.key("w"),Xe.a.device.keyboard.key("a"),Xe.a.device.keyboard.key("s"),Xe.a.device.keyboard.key("d"),Xe.a.device.keyboard.key("q"),Xe.a.device.keyboard.key("e"),V_("space-rising")],dest:{value:"/vars/mouse-and-keyboard/stopInspectingViaKeyboard"},xform:D_.any},{src:{value:Xe.a.device.mouse.wheel},dest:{value:Xe.a.actions.inspectZoom},xform:D_.scale(F_),priority:1},{src:{value:Xe.a.device.mouse.movementXY},dest:{x:"/var/movementX",y:"/var/movementY"},xform:D_.split_vec2},{src:{bool:Xe.a.device.mouse.buttonMiddle,value:"/var/movementY"},dest:{value:"/var/middle-mouse-move-y"},xform:D_.copyIfTrue},{src:{value:"/var/middle-mouse-move-y"},dest:{value:Xe.a.actions.inspectPanY},xform:D_.scale(.001)},{src:{value:Xe.a.device.keyboard.key("f")},dest:{value:"/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocus"},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("i")},dest:{value:"/vars/mouse-and-keyboard/stopInspectingSelf"},xform:D_.rising},{src:["/vars/mouse-and-keyboard/stopInspectingViaKeyboard","/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocus","/vars/mouse-and-keyboard/stopInspectingSelf"],dest:{value:Xe.a.actions.stopInspecting},xform:D_.any}],[ew.debugUserInput]:[{src:{value:Xe.a.device.keyboard.key("m")},dest:{value:Xe.a.actions.debugUserInput.describeCurrentMasks},xform:D_.rising,priority:10}]}),U_="/vars/touchscreen/zero",z_=I_({[ew.global]:[{src:{},dest:{value:Xe.a.actions.cursor.right.hideLine},xform:D_.always(!0)},{src:{value:Xe.a.device.touchscreen.pinch.delta},dest:{value:"/vars/touchscreen/pinchDeltaForward"},xform:D_.scale(.25)},{src:{value:Xe.a.device.touchscreen.tap2},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.copy},{src:{},dest:{value:U_},xform:D_.always(0)},{src:{x:U_,y:"/vars/touchscreen/pinchDeltaForward"},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.compose_vec2},{src:{value:Xe.a.device.touchscreen.cursorPose},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:Xe.a.device.touchscreen.touchCameraDelta},dest:{x:"vars/touchscreen/touchCameraDelta/x",y:"vars/touchscreen/touchCameraDelta/y"},xform:D_.split_vec2},{src:{value:"vars/touchscreen/touchCameraDelta/x"},dest:{value:"vars/touchscreen/touchCameraDelta/x/scaled"},xform:D_.scale(-Math.PI)},{src:{value:"vars/touchscreen/touchCameraDelta/y"},dest:{value:"vars/touchscreen/touchCameraDelta/y/scaled"},xform:D_.scale(-Math.PI/2)},{src:{x:"vars/touchscreen/touchCameraDelta/x/scaled",y:"vars/touchscreen/touchCameraDelta/y/scaled"},dest:{value:"vars/touchscreen/touchCameraDelta"},xform:D_.compose_vec2},{src:{value:"vars/touchscreen/touchCameraDelta"},dest:{value:"vars/touchscreen/touchCameraDeltaMaybeInverted"},xform:D_.invert_vec2_if_preference("invertTouchscreenCameraMove")},{src:{value:Xe.a.device.gyro.averageDeltaX},dest:{value:"vars/gyro/gyroCameraDelta/x/scaled"},xform:D_.scale(1)},{src:{value:Xe.a.device.gyro.averageDeltaY},dest:{value:"vars/gyro/gyroCameraDelta/y/scaled"},xform:D_.scale(1)},{src:{x:"vars/gyro/gyroCameraDelta/y/scaled",y:"vars/gyro/gyroCameraDelta/x/scaled"},dest:{value:"vars/gyro/gyroCameraDelta"},xform:D_.compose_vec2},{src:{first:"vars/touchscreen/touchCameraDeltaMaybeInverted",second:"vars/gyro/gyroCameraDelta"},dest:{value:Xe.a.actions.cameraDelta},xform:D_.add_vec2},{src:{value:"vars/touchscreen/touchCameraDeltaMaybeInverted"},dest:{value:Xe.a.actions.lobbyCameraDelta},xform:D_.copy},{src:{value:Xe.a.device.touchscreen.isTouchingGrabbable},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising},{src:{value:Xe.a.device.hud.penButton},dest:{value:"/vars/touchscreen/togglePen"},xform:D_.rising},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:Xe.a.actions.spawnPen},xform:D_.rising,priority:2}],[ew.rightCursorHoldingInteractable]:[{src:{value:Xe.a.device.touchscreen.isTouchingGrabbable},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.falling,priority:1}],[ew.rightCursorHoveringOnPen]:[],[ew.rightCursorHoldingPen]:[{src:{value:Xe.a.device.touchscreen.isTouchingGrabbable},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.risingWithFrameDelay(5),priority:2},{src:{value:Xe.a.device.touchscreen.isTouchingGrabbable},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:2},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.rising,priority:3},{src:{value:"/vars/touchscreen/togglePen"},dest:{value:Xe.a.actions.pen.remove},xform:D_.rising,priority:3}],[ew.inspecting]:[{src:{value:Xe.a.device.touchscreen.pinch.delta},dest:{value:Xe.a.actions.inspectZoom},xform:D_.scale(.025),priority:1}]}),W_=I_({[ew.global]:[{src:{value:Xe.a.device.keyboard.key("l")},dest:{value:Xe.a.actions.logDebugFrame},xform:D_.rising}]}),q_=Xe.a.device.leftOculusTouch.button,G_=Xe.a.device.leftOculusTouch.axis,Y_=Xe.a.device.leftOculusTouch.pose,K_=Xe.a.device.rightOculusTouch.button,X_=Xe.a.device.rightOculusTouch.axis,Q_=Xe.a.device.rightOculusTouch.pose,J_="".concat("/touch/var/","left/wake"),Z_="".concat("/touch/var/","right/wake"),$_="".concat("/touch/var/","left/joy/x/deadzoned"),eS="".concat("/touch/var/","left/joy/y/deadzoned"),tS="".concat("/touch/var/","left/scaledJoyX"),nS="".concat("/touch/var/","left/scaledJoyY"),aS="".concat("/touch/var/","right/cursorDrop2"),iS="".concat("/touch/var/","right/cursorDrop1"),rS="".concat("/touch/var/","left/cursorDrop2"),oS="".concat("/touch/var/","left/cursorDrop1"),sS="".concat("/touch/var/","right/rightHandDrop2"),lS="".concat("/touch/var/","right/grip/RisingGrab"),cS="".concat("/touch/var/","right/trigger/RisingGrab"),dS="".concat("/touch/var/","left/grip/RisingGrab"),uS="".concat("/touch/var/","left/trigger/RisingGrab"),hS="".concat("/touch/var/","rightDpad/north"),pS="".concat("/touch/var/","rightDpad/south"),mS="".concat("/touch/var/","rightDpad/east"),fS="".concat("/touch/var/","rightDpad/west"),gS="".concat("/touch/var/","rightDpad/center"),vS="".concat("/touch/var/","right/joy"),bS="".concat("/touch/var/","right/joyY1"),yS="".concat("/touch/var/","right/joyY2"),ES="".concat("/touch/var/","right/joy/y/deadzoned"),wS="".concat("/touch/var/","leftDpad/north"),_S="".concat("/touch/var/","leftDpad/south"),SS="".concat("/touch/var/","leftDpad/east"),xS="".concat("/touch/var/","leftDpad/west"),AS="".concat("/touch/var/","leftDpad/center"),MS="".concat("/touch/var/","left/joy"),kS="".concat("/touch/var/","characterAcceleration"),OS="".concat("/touch/var/","/right/snap-right"),CS="".concat("/touch/var/","/right/snap-left"),PS="".concat("/touch/var/","/keyboard/snap-right"),RS="".concat("/touch/var/","/keyboard/snap-left"),TS="".concat("/touch/var/","buttons/lower"),jS="".concat("/touch/var/","buttons/upper"),DS="".concat("/touch/var/","buttons/ensureFrozen"),IS="".concat("/touch/var/","keyboard/ensureFrozen"),LS="".concat("/touch/var/","buttons/thaw"),HS="".concat("/touch/var/","keyboard/thaw"),NS=e=>"/oculus-touch-user-vars/"+e,FS=NS("leftGripPressed1"),VS=NS("leftGripPressed2"),BS=NS("rightGripPressed1"),US=NS("rightGripPressed2"),zS=NS("leftTriggerPressed1"),WS=NS("leftTriggerPressed2"),qS=NS("rightTriggerPressed1"),GS=NS("rightTriggerPressed2"),YS=I_({[ew.global]:[{src:{value:Xe.a.device.leftOculusTouch.matrix},dest:{value:Xe.a.actions.leftHand.matrix},xform:D_.copy},{src:{value:Xe.a.device.rightOculusTouch.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:[DS,IS],dest:{value:Xe.a.actions.ensureFrozen},xform:D_.any},{src:[LS,HS],dest:{value:Xe.a.actions.thaw},xform:D_.any},{src:{value:q_("grip").pressed},dest:{value:FS},xform:D_.copy},{src:{value:q_("grip").pressed},dest:{value:VS},xform:D_.copy},{src:{value:FS},dest:{value:Xe.a.actions.leftHand.middleRingPinky},xform:D_.copy},{src:[q_("x").touched,q_("y").touched,q_("thumbStick").touched],dest:{value:Xe.a.actions.leftHand.thumb},xform:D_.any},{src:{value:q_("trigger").pressed},dest:{value:zS},xform:D_.copy},{src:{value:q_("trigger").pressed},dest:{value:WS},xform:D_.copy},{src:{value:zS},dest:{value:Xe.a.actions.leftHand.index},xform:D_.copy},{src:{value:K_("grip").pressed},dest:{value:BS},xform:D_.copy},{src:{value:K_("grip").pressed},dest:{value:US},xform:D_.copy},{src:{value:BS},dest:{value:Xe.a.actions.rightHand.middleRingPinky},xform:D_.copy},{src:[K_("a").touched,K_("b").touched,K_("thumbStick").touched],dest:{value:Xe.a.actions.rightHand.thumb},xform:D_.any},{src:{value:K_("trigger").pressed},dest:{value:qS},xform:D_.copy},{src:{value:K_("trigger").pressed},dest:{value:GS},xform:D_.copy},{src:{value:qS},dest:{value:Xe.a.actions.rightHand.index},xform:D_.copy},{src:{x:G_("joyX"),y:G_("joyY")},dest:{value:MS},xform:D_.compose_vec2},{src:{value:MS},dest:{north:wS,south:_S,east:SS,west:xS,center:AS},xform:D_.vec2dpad(.2,!1,!0)},{src:{value:X_("joyY")},dest:{value:bS},xform:D_.copy},{src:{value:X_("joyY")},dest:{value:yS},xform:D_.copy},{src:{x:X_("joyX"),y:bS},dest:{value:vS},xform:D_.compose_vec2},{src:{value:vS},dest:{north:hS,south:pS,east:mS,west:fS,center:gS},xform:D_.vec2dpad(.2,!1,!0)},{src:{value:mS},dest:{value:OS},xform:D_.rising,priority:1},{src:{value:Xe.a.device.keyboard.key("e")},dest:{value:PS},xform:D_.rising},{src:[OS,PS],dest:{value:Xe.a.actions.snapRotateRight},xform:D_.any},{src:{value:Xe.a.device.keyboard.key("Tab")},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:IS},xform:D_.copy},{src:[q_("x").pressed,K_("a").pressed],dest:{value:TS},xform:D_.any},{src:[q_("y").pressed,K_("b").pressed],dest:{value:jS},xform:D_.any},{src:{value:TS},dest:{value:DS},xform:D_.copy},{src:{value:TS},dest:{value:LS},xform:D_.falling},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:HS},xform:D_.falling},{src:{value:fS},dest:{value:CS},xform:D_.rising,priority:1},{src:{value:Xe.a.device.keyboard.key("q")},dest:{value:RS},xform:D_.rising},{src:[CS,RS],dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.any},{src:{value:G_("joyY")},dest:{value:eS},xform:D_.deadzone(.1)},{src:{value:eS},dest:{value:nS},xform:D_.scale(-1.5)},{src:{value:G_("joyX")},dest:{value:$_},xform:D_.deadzone(.1)},{src:{value:$_},dest:{value:tS},xform:D_.scale(1.5)},{src:{x:tS,y:nS},dest:{value:kS},xform:D_.compose_vec2},{src:{w:Xe.a.device.keyboard.key("arrowup"),a:Xe.a.device.keyboard.key("arrowleft"),s:Xe.a.device.keyboard.key("arrowdown"),d:Xe.a.device.keyboard.key("arrowright")},dest:{vec2:"/var/keyboard/arrows_vec2"},xform:D_.wasd_to_vec2},{src:{w:Xe.a.device.keyboard.key("w"),a:Xe.a.device.keyboard.key("a"),s:Xe.a.device.keyboard.key("s"),d:Xe.a.device.keyboard.key("d")},dest:{vec2:"/var/keyboard/wasd_vec2"},xform:D_.wasd_to_vec2},{src:{first:"/var/keyboard/wasd_vec2",second:"/var/keyboard/arrows_vec2"},dest:{value:"/var/keyboard/characterAcceleration"},xform:D_.max_vec2},{src:{first:kS,second:"/var/keyboard/characterAcceleration"},dest:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration"},xform:D_.max_vec2},{src:{value:"/var/oculus-touch/nonNormalizedCharacterAcceleration",override:"/device/overrides/foo"},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.copy},{src:{value:Xe.a.device.keyboard.key("shift")},dest:{value:"/var/keyboard-oculus/boost"},xform:D_.copy},{src:{value:q_("y").pressed},dest:{value:"/var/left-oculus/boost"},xform:D_.copy},{src:{value:K_("b").pressed},dest:{value:"/var/right-oculus/boost"},xform:D_.copy},{src:{value:q_("thumbStick").pressed},dest:{value:Xe.a.actions.nextCameraMode},xform:D_.rising},{src:{value:K_("thumbStick").pressed},dest:{value:Xe.a.actions.toggleFly},xform:D_.rising},{src:["/var/keyboard-oculus/boost","/var/left-oculus/boost","/var/right-oculus/boost"],dest:{value:Xe.a.actions.boost},xform:D_.any},{src:{value:Xe.a.device.keyboard.key("t")},dest:{value:Xe.a.actions.focusChat},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("/")},dest:{value:Xe.a.actions.focusChatCommand},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:Xe.a.actions.mediaExit},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("p")},dest:{value:Xe.a.actions.spawnPen},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("c")},dest:{value:Xe.a.actions.toggleCamera},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("x")},dest:{value:Xe.a.actions.takeSnapshot},xform:D_.copy},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:Xe.a.actions.mediaSearch1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:Xe.a.actions.mediaSearch2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:Xe.a.actions.mediaSearch3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:Xe.a.actions.mediaSearch4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:Xe.a.actions.mediaSearch5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:Xe.a.actions.mediaSearch6},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:Xe.a.actions.mediaSearch7},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:Xe.a.actions.mediaSearch8},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("l")},dest:{value:Xe.a.actions.logDebugFrame},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("k")},dest:{value:Xe.a.actions.logInteractionState},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("m")},dest:{value:Xe.a.actions.muteMic},xform:D_.rising},{src:{value:Y_},dest:{value:Xe.a.actions.cursor.left.pose},xform:D_.copy},{src:{value:Q_},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:Q_},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy},{src:{value:Y_},dest:{value:Xe.a.actions.leftHand.pose},xform:D_.copy},{src:{value:GS},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling,priority:1},{src:{value:WS},dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.falling,priority:1},{src:[q_("y").pressed,q_("x").pressed,q_("trigger").pressed,q_("grip").pressed],dest:{value:J_},xform:D_.any},{src:{value:J_},dest:{value:Xe.a.actions.cursor.left.wake},xform:D_.rising},{src:[K_("b").pressed,K_("a").pressed,K_("trigger").pressed,K_("grip").pressed],dest:{value:Z_},xform:D_.any},{src:{value:Z_},dest:{value:Xe.a.actions.cursor.right.wake},xform:D_.rising}],[ew.leftHandHoveringOnNothing]:[{src:{value:WS},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnUI]:[{src:{value:GS},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising,priority:2}],[ew.leftCursorHoveringOnUI]:[{src:{value:WS},dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.rising,priority:2}],[ew.rightCursorHoveringOnVideo]:[{src:{value:X_("joyY")},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.scale(-.01)}],[ew.leftCursorHoveringOnVideo]:[{src:{value:G_("joyY")},dest:{value:Xe.a.actions.cursor.left.mediaVolumeMod},xform:D_.scale(-.01)}],[ew.rightCursorHoveringOnNothing]:[{src:{value:GS},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.rising,priority:1}],[ew.leftCursorHoveringOnNothing]:[{src:{value:WS},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.rising,priority:1}],[ew.leftHandHoveringOnInteractable]:[{src:{value:VS},dest:{value:dS},xform:D_.rising,priority:2},{src:[dS],dest:{value:Xe.a.actions.leftHand.grab},xform:D_.any,priority:2},{src:{value:WS},dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.falling,priority:2}],[ew.inspecting]:[{src:{value:jS},dest:{value:Xe.a.actions.stopInspecting},xform:D_.falling}],[ew.leftHandHoldingInteractable]:[{src:{value:VS},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.falling}],[ew.leftHandHoveringOnPen]:[],[ew.leftHandHoldingPen]:[{src:{value:WS},dest:{value:Xe.a.actions.leftHand.startDrawing},xform:D_.rising,priority:3},{src:{value:WS},dest:{value:Xe.a.actions.leftHand.stopDrawing},xform:D_.falling,priority:3},{src:{value:SS,override:"/device/overrides/foo"},dest:{value:Xe.a.actions.leftHand.penNextColor},xform:D_.rising,priority:2},{src:{value:xS,override:"/device/overrides/foo"},dest:{value:Xe.a.actions.leftHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:eS},dest:{value:Xe.a.actions.leftHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:1},{src:{value:q_("y").pressed},dest:{value:Xe.a.actions.leftHand.switchDrawMode},xform:D_.rising,priority:1},{src:{value:q_("x").pressed},dest:{value:Xe.a.actions.leftHand.undoDrawing},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnInteractable]:[{src:{value:US},dest:{value:lS},xform:D_.rising,priority:2},{src:{value:GS},dest:{value:cS},xform:D_.rising,priority:2},{src:[lS],dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.any,priority:2},{src:{value:jS},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.leftCursorHoveringOnInteractable]:[{src:{value:VS},dest:{value:dS},xform:D_.rising,priority:2},{src:{value:WS},dest:{value:uS},xform:D_.rising,priority:2},{src:[dS],dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.any,priority:2},{src:{value:jS},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.rightCursorHoldingUI]:[{src:{value:GS},dest:{value:aS},xform:D_.falling,priority:5}],[ew.leftCursorHoldingUI]:[{src:{value:WS},dest:{value:rS},xform:D_.falling,priority:5}],[ew.rightCursorHoldingInteractable]:[{src:{value:X_("joyY")},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.scale(.1)},{src:{value:US},dest:{value:iS},xform:D_.falling,priority:3},{src:[iS,aS],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.any,priority:2}],[ew.leftCursorHoldingInteractable]:[{src:{value:G_("joyY")},dest:{value:Xe.a.actions.cursor.left.modDelta},xform:D_.scale(.1)},{src:{value:VS},dest:{value:oS},xform:D_.falling,priority:3},{src:[oS,rS],dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.any,priority:2}],[ew.rightCursorHoveringOnPen]:[],[ew.rightCursorHoldingPen]:[{src:{value:GS},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.rising,priority:3},{src:{value:GS},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:3},{src:{value:K_("b").pressed},dest:{value:Xe.a.actions.cursor.right.undoDrawing},xform:D_.rising,priority:1}],[ew.leftCursorHoldingPen]:[{src:{value:WS},dest:{value:Xe.a.actions.cursor.left.startDrawing},xform:D_.rising,priority:3},{src:{value:WS},dest:{value:Xe.a.actions.cursor.left.stopDrawing},xform:D_.falling,priority:3},{src:{value:q_("y").pressed},dest:{value:Xe.a.actions.cursor.left.undoDrawing},xform:D_.rising,priority:1}],[ew.rightHandHoveringOnInteractable]:[{src:{value:US},dest:{value:lS},xform:D_.rising,priority:2},{src:[lS],dest:{value:Xe.a.actions.rightHand.grab},xform:D_.any,priority:2},{src:{value:GS},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling,priority:2}],[ew.rightHandHoldingInteractable]:[{src:{value:US},dest:{value:sS},xform:D_.falling,priority:3},{src:[sS],dest:{value:Xe.a.actions.rightHand.drop},xform:D_.any,priority:2}],[ew.rightHandHoveringOnPen]:[],[ew.rightHandHoldingPen]:[{src:{value:GS},dest:{value:Xe.a.actions.rightHand.startDrawing},xform:D_.rising,priority:3},{src:{value:GS},dest:{value:Xe.a.actions.rightHand.stopDrawing},xform:D_.falling,priority:3},{src:{value:mS},dest:{value:Xe.a.actions.rightHand.penNextColor},xform:D_.rising,priority:2},{src:{value:fS},dest:{value:Xe.a.actions.rightHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:X_("joyY")},dest:{value:ES},xform:D_.deadzone(.1)},{src:{value:ES},dest:{value:Xe.a.actions.rightHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:2},{src:{value:US},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.falling,priority:3},{src:{value:K_("b").pressed},dest:{value:Xe.a.actions.rightHand.switchDrawMode},xform:D_.rising,priority:1},{src:{value:K_("a").pressed},dest:{value:Xe.a.actions.rightHand.undoDrawing},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnCamera]:[],[ew.rightHandHoveringOnCamera]:[],[ew.leftHandHoveringOnCamera]:[],[ew.rightHandHoldingCamera]:[{src:{value:GS},dest:{value:Xe.a.actions.rightHand.takeSnapshot},xform:D_.copy,priority:4}],[ew.leftHandHoldingCamera]:[{src:{value:WS},dest:{value:Xe.a.actions.leftHand.takeSnapshot},xform:D_.copy,priority:4}],[ew.rightCursorHoldingCamera]:[{src:{value:GS},dest:{value:Xe.a.actions.cursor.right.takeSnapshot},xform:D_.copy,priority:4}],[ew.leftCursorHoldingCamera]:[{src:{value:WS},dest:{value:Xe.a.actions.cursor.left.takeSnapshot},xform:D_.copy,priority:4}],[ew.rightHandHoveringOnNothing]:[],[ew.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:Xe.a.noop},xform:D_.noop,priority:1e3}]}),KS=Xe.a.device.webxr.left.button,XS=Xe.a.device.webxr.left.axis,QS=Xe.a.device.webxr.left.pose,JS=Xe.a.device.webxr.right.button,ZS=Xe.a.device.webxr.right.axis,$S=Xe.a.device.webxr.right.pose,ex=e=>"/webxr/var/"+e,tx=ex("left/wake"),nx=ex("right/wake"),ax=ex("left/joy/x/deadzoned"),ix=ex("left/joy/y/deadzoned"),rx=ex("left/scaledJoyX"),ox=ex("left/scaledJoyY"),sx=ex("right/cursorDrop1"),lx=ex("right/cursorDrop2"),cx=ex("right/cursorDrop3"),dx=ex("left/cursorDrop2"),ux=ex("left/cursorDrop1"),hx=ex("right/rightHandDrop2"),px=ex("right/grip/RisingGrab"),mx=ex("left/grip/RisingGrab"),fx=ex("rightDpad/north"),gx=ex("rightDpad/south"),vx=ex("rightDpad/east"),bx=ex("rightDpad/west"),yx=ex("rightDpad/center"),Ex=ex("right/joy"),wx=ex("right/joyY1"),_x=ex("right/joy/y/deadzoned"),Sx=ex("leftDpad/north"),xx=ex("leftDpad/south"),Ax=ex("leftDpad/east"),Mx=ex("leftDpad/west"),kx=ex("leftDpad/center"),Ox=ex("left/joy"),Cx=ex("nonNormalizedCharacterAcceleration"),Px=ex("right/boost"),Rx=ex("left/boost"),Tx=ex("buttons/lower"),jx=ex("buttons/upper"),Dx=ex("leftGripPressed1"),Ix=ex("leftGripPressed2"),Lx=ex("rightGripPressed1"),Hx=ex("rightGripPressed2"),Nx=ex("leftTriggerPressed1"),Fx=ex("leftTriggerPressed2"),Vx=ex("rightTriggerPressed1"),Bx=ex("rightTriggerPressed2"),Ux=ex("touchpad"),zx=ex("touchpad/rising"),Wx=ex("dpadNorth"),qx=ex("dpadSouth"),Gx=ex("dpadEast"),Yx=ex("dpadWest"),Kx=ex("dpadCenter"),Xx=ex("dpadCenterStrip"),Qx=ex("snapRotateRight1"),Jx=ex("snapRotateRight2"),Zx=ex("snapRotateLeft1"),$x=ex("snapRotateLeft2"),eA=ex("centerStripPressed"),tA=ex("touchpadReleased"),nA=ex("lowerButtonsReleased"),aA=I_({[ew.global]:[{src:{value:Xe.a.device.webxr.left.matrix},dest:{value:Xe.a.actions.leftHand.matrix},xform:D_.copy},{src:{value:Xe.a.device.webxr.right.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:{value:KS.grip.pressed},dest:{value:Dx},xform:D_.copy},{src:{value:KS.grip.pressed},dest:{value:Ix},xform:D_.copy},{src:{value:Dx},dest:{value:Xe.a.actions.leftHand.middleRingPinky},xform:D_.copy},{src:[KS.a.touched,KS.b.touched,KS.thumbStick.touched],dest:{value:Xe.a.actions.leftHand.thumb},xform:D_.any},{src:{value:KS.trigger.pressed},dest:{value:Nx},xform:D_.copy},{src:{value:KS.trigger.pressed},dest:{value:Fx},xform:D_.copy},{src:{value:Nx},dest:{value:Xe.a.actions.leftHand.index},xform:D_.copy},{src:{value:JS.grip.pressed},dest:{value:Lx},xform:D_.copy},{src:{value:JS.grip.pressed},dest:{value:Hx},xform:D_.copy},{src:{value:Lx},dest:{value:Xe.a.actions.rightHand.middleRingPinky},xform:D_.copy},{src:[JS.a.touched,JS.b.touched,JS.thumbStick.touched],dest:{value:Xe.a.actions.rightHand.thumb},xform:D_.any},{src:{value:JS.trigger.pressed},dest:{value:Vx},xform:D_.copy},{src:{value:JS.trigger.pressed},dest:{value:Bx},xform:D_.copy},{src:{value:Vx},dest:{value:Xe.a.actions.rightHand.index},xform:D_.copy},{src:{x:XS.joyX,y:XS.joyY},dest:{value:Ox},xform:D_.compose_vec2},{src:{value:Ox},dest:{north:Sx,south:xx,east:Ax,west:Mx,center:kx},xform:D_.vec2dpad(.2,!1,!0)},{src:{value:ZS.joyY},dest:{value:wx},xform:D_.copy},{src:{x:ZS.joyX,y:wx},dest:{value:Ex},xform:D_.compose_vec2},{src:{value:Ex},dest:{north:fx,south:gx,east:vx,west:bx,center:yx},xform:D_.vec2dpad(.2,!1,!0)},{src:{value:vx},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.rising,priority:1},{src:[KS.a.pressed,JS.a.pressed],dest:{value:Tx},xform:D_.any},{src:[KS.b.pressed,JS.b.pressed],dest:{value:jx},xform:D_.any},{src:{value:bx},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.rising,priority:1},{src:{value:XS.joyY},dest:{value:ix},xform:D_.deadzone(.1)},{src:{value:ix},dest:{value:ox},xform:D_.scale(-1.5)},{src:{value:XS.joyX},dest:{value:ax},xform:D_.deadzone(.1)},{src:{value:ax},dest:{value:rx},xform:D_.scale(1.5)},{src:{x:rx,y:ox},dest:{value:Cx},xform:D_.compose_vec2},{src:{value:Cx},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.copy},{src:{value:KS.b.pressed},dest:{value:Rx},xform:D_.copy},{src:{value:JS.b.pressed},dest:{value:Px},xform:D_.copy},{src:{value:KS.thumbStick.pressed},dest:{value:Xe.a.actions.nextCameraMode},xform:D_.rising},{src:{value:JS.thumbStick.pressed},dest:{value:Xe.a.actions.toggleFly},xform:D_.rising},{src:[Rx,Px],dest:{value:Xe.a.actions.boost},xform:D_.any},{src:{value:QS},dest:{value:Xe.a.actions.cursor.left.pose},xform:D_.copy},{src:{value:$S},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:$S},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy},{src:{value:QS},dest:{value:Xe.a.actions.leftHand.pose},xform:D_.copy},{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling,priority:1},{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.falling,priority:1},{src:[KS.b.pressed,KS.a.pressed,KS.trigger.pressed,KS.grip.pressed],dest:{value:tx},xform:D_.any},{src:{value:tx},dest:{value:Xe.a.actions.cursor.left.wake},xform:D_.rising},{src:[JS.b.pressed,JS.a.pressed,JS.trigger.pressed,JS.grip.pressed],dest:{value:nx},xform:D_.any},{src:{value:nx},dest:{value:Xe.a.actions.cursor.right.wake},xform:D_.rising},{src:{x:ZS.touchpadX,y:ZS.touchpadY},dest:{value:Ux},xform:D_.compose_vec2},{src:{value:Ux},dest:{north:Wx,south:qx,east:Gx,west:Yx,center:Kx},xform:D_.vec2dpad(.3)},{src:[Wx,Kx,qx],dest:{value:Xx},xform:D_.any},{src:{value:Xx,bool:JS.touchpad.pressed},dest:{value:eA},xform:D_.copyIfTrue},{src:[eA,Tx],dest:{value:Xe.a.actions.ensureFrozen},xform:D_.any},{src:{value:JS.touchpad.pressed},dest:{value:tA},xform:D_.falling},{src:{value:Tx},dest:{value:nA},xform:D_.falling},{src:[tA,nA],dest:{value:Xe.a.actions.thaw},xform:D_.any},{src:{value:JS.touchpad.pressed},dest:{value:zx},xform:D_.rising},{src:{value:Gx,bool:zx},dest:{value:Qx},xform:D_.copyIfTrue},{src:{value:Yx,bool:zx},dest:{value:Zx},xform:D_.copyIfTrue},{src:{value:vx},dest:{value:Jx},xform:D_.rising,priority:1},{src:{value:bx},dest:{value:$x},xform:D_.rising,priority:1},{src:[Qx,Jx],dest:{value:Xe.a.actions.snapRotateRight},xform:D_.any},{src:[Zx,$x],dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.any}],[ew.leftHandHoveringOnNothing]:[{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnUI]:[{src:{value:Bx},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising,priority:2}],[ew.leftCursorHoveringOnUI]:[{src:{value:Fx},dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.rising,priority:2}],[ew.rightCursorHoveringOnVideo]:[{src:{value:ZS.joyY},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.scale(-.01)}],[ew.leftCursorHoveringOnVideo]:[{src:{value:XS.joyY},dest:{value:Xe.a.actions.cursor.left.mediaVolumeMod},xform:D_.scale(-.01)}],[ew.rightCursorHoveringOnNothing]:[{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.rising,priority:1}],[ew.leftCursorHoveringOnNothing]:[{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.rising,priority:1}],[ew.leftHandHoveringOnInteractable]:[{src:{value:Ix},dest:{value:mx},xform:D_.rising,priority:2},{src:[mx],dest:{value:Xe.a.actions.leftHand.grab},xform:D_.any,priority:2},{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.falling,priority:2}],[ew.inspecting]:[{src:{value:jx},dest:{value:Xe.a.actions.stopInspecting},xform:D_.falling}],[ew.leftHandHoldingInteractable]:[{src:{value:Ix},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.falling}],[ew.leftHandHoveringOnPen]:[],[ew.leftHandHoldingPen]:[{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.startDrawing},xform:D_.rising,priority:3},{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.stopDrawing},xform:D_.falling,priority:3},{src:{value:Ax},dest:{value:Xe.a.actions.leftHand.penNextColor},xform:D_.rising,priority:2},{src:{value:Mx},dest:{value:Xe.a.actions.leftHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:ix},dest:{value:Xe.a.actions.leftHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:1},{src:{value:KS.b.pressed},dest:{value:Xe.a.actions.leftHand.switchDrawMode},xform:D_.rising,priority:1},{src:{value:KS.a.pressed},dest:{value:Xe.a.actions.leftHand.undoDrawing},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnInteractable]:[{src:{value:Hx},dest:{value:px},xform:D_.rising,priority:2},{src:[px,Bx],dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.any,priority:2},{src:{value:jx},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.leftCursorHoveringOnInteractable]:[{src:{value:Ix},dest:{value:mx},xform:D_.rising,priority:2},{src:[mx],dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.any,priority:2},{src:{value:jx},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.rightCursorHoldingUI]:[{src:{value:Bx},dest:{value:lx},xform:D_.falling,priority:5}],[ew.leftCursorHoldingUI]:[{src:{value:Fx},dest:{value:dx},xform:D_.falling,priority:5}],[ew.rightCursorHoldingInteractable]:[{src:{value:ZS.joyY},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.scale(.1)},{src:{value:Hx},dest:{value:sx},xform:D_.falling,priority:3},{src:{value:Bx},dest:{value:cx},xform:D_.falling,priority:4},{src:[sx,lx,cx],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.any,priority:2}],[ew.leftCursorHoldingInteractable]:[{src:{value:XS.joyY},dest:{value:Xe.a.actions.cursor.left.modDelta},xform:D_.scale(.1)},{src:{value:Ix},dest:{value:ux},xform:D_.falling,priority:3},{src:[ux,dx],dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.any,priority:2}],[ew.rightCursorHoveringOnPen]:[],[ew.rightCursorHoldingPen]:[{src:{value:Bx},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.rising,priority:3},{src:{value:Bx},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:3},{src:{value:JS.b.pressed},dest:{value:Xe.a.actions.cursor.right.undoDrawing},xform:D_.rising,priority:1}],[ew.leftCursorHoldingPen]:[{src:{value:Fx},dest:{value:Xe.a.actions.cursor.left.startDrawing},xform:D_.rising,priority:3},{src:{value:Fx},dest:{value:Xe.a.actions.cursor.left.stopDrawing},xform:D_.falling,priority:3},{src:{value:KS.b.pressed},dest:{value:Xe.a.actions.cursor.left.undoDrawing},xform:D_.rising,priority:1}],[ew.rightHandHoveringOnInteractable]:[{src:{value:Hx},dest:{value:px},xform:D_.rising,priority:2},{src:[px],dest:{value:Xe.a.actions.rightHand.grab},xform:D_.any,priority:2},{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling,priority:2}],[ew.rightHandHoldingInteractable]:[{src:{value:Hx},dest:{value:hx},xform:D_.falling,priority:3},{src:[hx],dest:{value:Xe.a.actions.rightHand.drop},xform:D_.any,priority:2}],[ew.rightHandHoveringOnPen]:[],[ew.rightHandHoldingPen]:[{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.startDrawing},xform:D_.rising,priority:3},{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.stopDrawing},xform:D_.falling,priority:3},{src:{value:vx},dest:{value:Xe.a.actions.rightHand.penNextColor},xform:D_.rising,priority:2},{src:{value:bx},dest:{value:Xe.a.actions.rightHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:ZS.joyY},dest:{value:_x},xform:D_.deadzone(.1)},{src:{value:_x},dest:{value:Xe.a.actions.rightHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:2},{src:{value:Hx},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.falling,priority:3},{src:{value:JS.b.pressed},dest:{value:Xe.a.actions.rightHand.switchDrawMode},xform:D_.rising,priority:1},{src:{value:JS.a.pressed},dest:{value:Xe.a.actions.rightHand.undoDrawing},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnCamera]:[],[ew.rightHandHoveringOnCamera]:[],[ew.leftHandHoveringOnCamera]:[],[ew.rightHandHoldingCamera]:[{src:{value:Bx},dest:{value:Xe.a.actions.rightHand.takeSnapshot},xform:D_.copy,priority:4}],[ew.leftHandHoldingCamera]:[{src:{value:Fx},dest:{value:Xe.a.actions.leftHand.takeSnapshot},xform:D_.copy,priority:4}],[ew.rightCursorHoldingCamera]:[{src:{value:Bx},dest:{value:cx},xform:D_.falling,priority:4}],[ew.leftCursorHoldingCamera]:[{src:{value:Fx},dest:{value:Xe.a.actions.cursor.left.takeSnapshot},xform:D_.copy,priority:4}],[ew.rightHandHoveringOnNothing]:[],[ew.inputFocused]:[]}),iA=e=>"/vive-user/vive-var/".concat(e),rA="".concat(name,"left/wake"),oA="".concat(name,"right/wake"),sA=Xe.a.device.vive.left.button,lA=Xe.a.device.vive.left.axis,cA=Xe.a.device.vive.left.pose,dA=iA("left/joy"),uA=iA("left/joy/scaled"),hA=iA("left/joyX/scaled"),pA=iA("left/joyY/scaled"),mA=iA("left/joyY/deadzoned"),fA=iA("left/touch"),gA=iA("left/touch/scaled"),vA=iA("left/touchX/scaled"),bA=iA("left/touchY"),yA=iA("left/touchY/scaled"),EA=iA("left/dpad/north1"),wA=iA("left/dpad/south1"),_A=iA("left/dpad/east1"),SA=iA("left/dpad/west1"),xA=iA("left/dpad/center1"),AA=iA("left/dpad/north2"),MA=iA("left/dpad/south2"),kA=iA("left/dpad/east2"),OA=iA("left/dpad/west2"),CA=iA("left/dpad/center2"),PA=iA("left/trigger/falling/stopDrawing"),RA=iA("left/grip/falling/stopDrawing"),TA=iA("left/trigger/rising/grab"),jA=iA("left/grab/rising/grab"),DA=iA("left/touchpad/rising2"),IA=iA("left/touchpad/rising1"),LA=iA("left/touch/characterAcceleration"),HA=iA("left/characterAcceleration"),NA=iA("nonNormalizedCharacterAcceleration"),FA=iA("left/boost"),VA=iA("left/drawing/undo"),BA=Xe.a.device.vive.right.button,UA=Xe.a.device.vive.right.axis,zA=Xe.a.device.vive.right.pose,WA=iA("right/touch"),qA=iA("right/joy"),GA=iA("right/joyY/deadzoned"),YA=iA("right/dpad/north1"),KA=iA("right/dpad/south1"),XA=iA("right/dpad/east1"),QA=iA("right/dpad/west1"),JA=iA("right/dpad/center"),ZA=iA("right/dpad/north2"),$A=iA("right/dpad/south2"),eM=iA("right/dpad/east2"),tM=iA("right/dpad/west2"),nM=iA("right/dpad/center2"),aM=iA("right/dpad/centerStrip"),iM=iA("right/touchpad/rising"),rM=iA("right/touchpad/falling"),oM=iA("right/boost"),sM=iA("right/trigger/rising/grab"),lM=iA("right/grab/rising/grab"),cM=iA("right/cursorDrop1"),dM=iA("right/cursorDrop2"),uM=iA("left/cursorDrop1"),hM=iA("left/cursorDrop2"),pM=iA("right/trigger/stopTeleport"),mM=iA("right/touchpad/stopTeleport"),fM=iA("right/drawing/undo"),gM=iA("dpad/ensureFrozen"),vM=iA("keyboard/ensureFrozen"),bM=iA("buttons/ensureFrozen"),yM=iA("dpad/thaw"),EM=iA("keyboard/thaw"),wM=iA("buttons/thaw"),_M=iA("buttons/freeze"),SM=iA("buttons/inspect"),xM=iA("right/snap-right"),AM=iA("right/snap-left"),MM=iA("right/snap-right2"),kM=iA("right/snap-left2"),OM=e=>"/vive-user/keyboard-var/".concat(e),CM=OM("snap-right"),PM=OM("snap-left"),RM=OM("characterAcceleration"),TM=OM("wasd_vec2"),jM=OM("arrows_vec2"),DM=OM("boost"),IM=iA("leftGripPressed1"),LM=iA("leftGripPressed2"),HM=iA("rightGripPressed1"),NM=iA("rightGripPressed2"),FM=iA("leftTriggerPressed1"),VM=iA("leftTriggerPressed2"),BM=iA("leftTouchpadPressed1"),UM=iA("leftTouchpadPressed2"),zM=iA("rightTriggerPressed1"),WM=iA("rightTriggerPressed2"),qM=iA("leftTouchpadFallingStopTeleport"),GM=iA("leftTriggerFallingStopTeleport"),YM=iA("leftGripFallingWhileHoldingPen"),KM=I_({[ew.global]:[{src:{value:Xe.a.device.vive.left.matrix},dest:{value:Xe.a.actions.leftHand.matrix},xform:D_.copy},{src:{value:Xe.a.device.vive.right.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:[gM,vM,bM],dest:{value:Xe.a.actions.ensureFrozen},xform:D_.any},{src:[yM,EM,wM],dest:{value:Xe.a.actions.thaw},xform:D_.any},{src:{value:sA("grip").pressed},dest:{value:IM},xform:D_.copy},{src:{value:IM},dest:{value:Xe.a.actions.leftHand.middleRingPinky},xform:D_.copy},{src:{value:sA("grip").pressed},dest:{value:LM},xform:D_.copy},{src:[sA("touchpad").touched,sA("primary").touched],dest:{value:Xe.a.actions.leftHand.thumb},xform:D_.any},{src:{value:FM},dest:{value:Xe.a.actions.leftHand.index},xform:D_.copy},{src:{value:sA("trigger").pressed},dest:{value:FM},xform:D_.copy},{src:{value:sA("trigger").pressed},dest:{value:VM},xform:D_.copy},{src:{value:BA("grip").pressed},dest:{value:HM},xform:D_.copy},{src:{value:BA("grip").pressed},dest:{value:NM},xform:D_.copy},{src:{value:HM},dest:{value:Xe.a.actions.rightHand.middleRingPinky},xform:D_.copy},{src:[BA("touchpad").touched,BA("primary").touched],dest:{value:Xe.a.actions.rightHand.thumb},xform:D_.any},{src:{value:BA("trigger").pressed},dest:{value:zM},xform:D_.copy},{src:{value:BA("trigger").pressed},dest:{value:WM},xform:D_.copy},{src:{value:zM},dest:{value:Xe.a.actions.rightHand.index},xform:D_.copy},{src:{x:lA("touchX"),y:lA("touchY")},dest:{value:fA},xform:D_.compose_vec2},{src:{value:fA},dest:{north:EA,south:wA,east:_A,west:SA,center:xA},xform:D_.vec2dpad(.35)},{src:{value:sA("touchpad").pressed},dest:{value:BM},xform:D_.copy},{src:{value:sA("touchpad").pressed},dest:{value:UM},xform:D_.copy},{src:{x:UA("touchX"),y:UA("touchY")},dest:{value:WA},xform:D_.compose_vec2},{src:{value:WA},dest:{north:YA,south:KA,east:XA,west:QA,center:JA},xform:D_.vec2dpad(.35,!1,!0)},{src:{x:UA("joyX"),y:UA("joyY")},dest:{value:qA},xform:D_.compose_vec2},{src:{value:qA},dest:{north:ZA,south:$A,east:eM,west:tM,center:nM},xform:D_.vec2dpad(.35,!1,!0)},{src:[YA,KA,JA],dest:{value:aM},xform:D_.any},{src:{value:BA("touchpad").pressed},dest:{value:iM},xform:D_.rising},{src:{value:BA("touchpad").pressed},dest:{value:rM},xform:D_.falling},{src:{bool:iM,value:XA},dest:{value:xM},xform:D_.copyIfTrue,priority:1},{src:{value:eM},dest:{value:MM},xform:D_.rising,priority:1},{src:{value:Xe.a.device.keyboard.key("e")},dest:{value:CM},xform:D_.rising},{src:[xM,MM,CM],dest:{value:Xe.a.actions.snapRotateRight},xform:D_.any},{src:{value:Xe.a.device.keyboard.key("Tab")},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:vM},xform:D_.copy},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:EM},xform:D_.falling},{src:{value:Xe.a.device.keyboard.key("p")},dest:{value:Xe.a.actions.spawnPen},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("c")},dest:{value:Xe.a.actions.toggleCamera},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("x")},dest:{value:Xe.a.actions.takeSnapshot},xform:D_.copy},{src:{value:BA("touchpad").pressed,bool:aM},dest:{value:gM},root:"rootForFrozenOverrideWhenHolding",xform:D_.copyIfTrue},{src:{value:rM},dest:{value:yM},xform:D_.copy},{src:{bool:iM,value:QA},dest:{value:AM},xform:D_.copyIfTrue,priority:1},{src:{value:tM},dest:{value:kM},xform:D_.rising,priority:1},{src:{value:Xe.a.device.keyboard.key("q")},dest:{value:PM},xform:D_.rising},{src:[AM,kM,PM],dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.any},{src:{value:lA("touchX")},dest:{value:vA},xform:D_.scale(1.5)},{src:{value:bA},dest:{value:yA},xform:D_.scale(1.5)},{src:{x:vA,y:yA},dest:{value:gA},xform:D_.compose_vec2},{src:{bool:UM,value:gA},dest:{value:LA},xform:D_.copyIfTrue},{src:{value:lA("joyX")},dest:{value:hA},xform:D_.scale(1.5)},{src:{value:lA("joyY")},dest:{value:pA},xform:D_.scale(1.5)},{src:{x:hA,y:pA},dest:{value:uA},xform:D_.compose_vec2},{src:{first:uA,second:LA},dest:{value:HA},xform:D_.max_vec2},{src:{w:Xe.a.device.keyboard.key("arrowup"),a:Xe.a.device.keyboard.key("arrowleft"),s:Xe.a.device.keyboard.key("arrowdown"),d:Xe.a.device.keyboard.key("arrowright")},dest:{vec2:jM},xform:D_.wasd_to_vec2},{src:{w:Xe.a.device.keyboard.key("w"),a:Xe.a.device.keyboard.key("a"),s:Xe.a.device.keyboard.key("s"),d:Xe.a.device.keyboard.key("d")},dest:{vec2:TM},xform:D_.wasd_to_vec2},{src:{value:Xe.a.device.keyboard.key("t")},dest:{value:Xe.a.actions.focusChat},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("/")},dest:{value:Xe.a.actions.focusChatCommand},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:Xe.a.actions.mediaExit},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:Xe.a.actions.mediaSearch1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:Xe.a.actions.mediaSearch2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:Xe.a.actions.mediaSearch3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:Xe.a.actions.mediaSearch4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:Xe.a.actions.mediaSearch5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:Xe.a.actions.mediaSearch6},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:Xe.a.actions.mediaSearch7},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:Xe.a.actions.mediaSearch8},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("l")},dest:{value:Xe.a.actions.logDebugFrame},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("k")},dest:{value:Xe.a.actions.logInteractionState},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("m")},dest:{value:Xe.a.actions.muteMic},xform:D_.rising},{src:{first:TM,second:jM},dest:{value:RM},xform:D_.max_vec2},{src:{first:HA,second:RM},dest:{value:NA},xform:D_.max_vec2},{src:{value:NA},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.normalize_vec2},{src:{value:Xe.a.device.keyboard.key("shift")},dest:{value:DM},xform:D_.copy},{src:{value:sA("primary").pressed},dest:{value:FA},xform:D_.copy},{src:{value:BA("primary").pressed},dest:{value:oM},xform:D_.copy},{src:[DM,FA,oM],dest:{value:Xe.a.actions.boost},xform:D_.any},{src:{value:cA},dest:{value:Xe.a.actions.cursor.left.pose},xform:D_.copy},{src:{value:zA},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:zA},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy},{src:{value:cA},dest:{value:Xe.a.actions.leftHand.pose},xform:D_.copy},{src:[sA("primary").pressed,sA("trigger").pressed,sA("grip").pressed,sA("touchpad").pressed],dest:{value:rA},xform:D_.any},{src:{value:rA},dest:{value:Xe.a.actions.cursor.left.wake},xform:D_.rising},{src:[BA("primary").pressed,BA("trigger").pressed,BA("grip").pressed,BA("touchpad").pressed],dest:{value:oA},xform:D_.any},{src:{value:oA},dest:{value:Xe.a.actions.cursor.right.wake},xform:D_.rising},{src:[BA("secondary").pressed,sA("secondary").pressed,BA("bumper").pressed,sA("bumper").pressed],dest:{value:_M},xform:D_.any},{src:[BA("primary").pressed,sA("primary").pressed],dest:{value:SM},xform:D_.any},{src:{value:_M},dest:{value:bM},xform:D_.copy},{src:{value:_M},dest:{value:wM},xform:D_.falling}],[ew.rightHandTeleporting]:[{src:{value:WM},dest:{value:pM},xform:D_.falling,priority:1},{src:{value:BA("touchpad").pressed},dest:{value:mM},xform:D_.falling},{src:[pM,mM],dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.any}],[ew.leftHandHoveringOnNothing]:[{src:{value:VM},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.rising}],[ew.leftHandTeleporting]:[{src:{value:VM},dest:{value:GM},xform:D_.falling,priority:1},{src:[GM,qM,YM],dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.any}],[ew.rightHandHoveringOnNothing]:[{src:{value:WM},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnNothing]:[],[ew.leftCursorHoveringOnNothing]:[],[ew.rightCursorHoveringOnUI]:[{src:{value:WM},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising,priority:1}],[ew.leftCursorHoveringOnUI]:[{src:{value:VM},dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.rising,priority:1}],[ew.rightCursorHoveringOnVideo]:[{src:{value:UA("touchY"),touching:BA("touchpad").touched},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.touch_axis_scroll(.1)},{src:{value:UA("joyY")},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.scale(.02)}],[ew.leftCursorHoveringOnVideo]:[{src:{value:lA("touchY"),touching:sA("touchpad").touched},dest:{value:Xe.a.actions.cursor.left.mediaVolumeMod},xform:D_.touch_axis_scroll(.1)},{src:{value:lA("joyY")},dest:{value:Xe.a.actions.cursor.left.mediaVolumeMod},xform:D_.scale(.02)}],[ew.leftHandHoveringOnInteractable]:[{src:{value:LM},dest:{value:jA},xform:D_.rising},{src:{value:VM},dest:{value:Xe.a.actions.leftHand.stopTeleport},xform:D_.falling,priority:2},{src:[jA],dest:{value:Xe.a.actions.leftHand.grab},xform:D_.any}],[ew.leftHandHoldingInteractable]:[{src:{value:LM},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.falling,priority:1}],[ew.leftHandHoveringOnPen]:[],[ew.leftHandHoldingPen]:[{src:{value:UM},dest:{value:qM},xform:D_.falling,priority:1},{src:{value:UM},dest:{value:IA},xform:D_.rising,priority:1},{src:{bool:IA,value:xA},dest:{value:Xe.a.actions.leftHand.startTeleport},xform:D_.copyIfTrue,priority:1},{src:{value:VM},dest:{value:Xe.a.actions.leftHand.startDrawing},xform:D_.rising,priority:2},{src:{value:VM},dest:{value:PA},xform:D_.falling,priority:2},{src:{value:LM},dest:{value:RA},xform:D_.falling,priority:1},{src:{value:LM},dest:{value:YM},xform:D_.falling,priority:1},{src:[PA,RA],dest:{value:Xe.a.actions.leftHand.stopDrawing},xform:D_.any},{src:{value:UM},dest:{value:DA},xform:D_.rising,priority:1},{src:{bool:DA,value:EA},dest:{value:Xe.a.actions.leftHand.penNextColor},xform:D_.copyIfTrue,priority:2},{src:{bool:DA,value:wA},dest:{value:Xe.a.actions.leftHand.penPrevColor},xform:D_.copyIfTrue,priority:2},{src:{value:lA("touchX"),touching:sA("touchpad").touched},dest:{value:Xe.a.actions.leftHand.scalePenTip},xform:D_.touch_axis_scroll(.05)},{src:[BA("primary").pressed,sA("secondary").pressed],dest:{value:VA},xform:D_.any,priority:1},{src:{value:VA},dest:{value:Xe.a.actions.leftHand.undoDrawing},xform:D_.rising},{src:{value:sA("primary").pressed},dest:{value:Xe.a.actions.leftHand.switchDrawMode},xform:D_.rising,priority:2}],[ew.rightCursorHoveringOnInteractable]:[{src:{value:NM},dest:{value:lM},xform:D_.rising},{src:{value:WM},dest:{value:sM},xform:D_.rising,priority:1},{src:[lM],dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.any},{src:{value:SM},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.leftCursorHoveringOnInteractable]:[{src:{value:LM},dest:{value:jA},xform:D_.rising},{src:{value:VM},dest:{value:TA},xform:D_.rising,priority:1},{src:[jA],dest:{value:Xe.a.actions.cursor.left.grab},xform:D_.any},{src:{value:SM},dest:{value:Xe.a.actions.startInspecting},xform:D_.rising}],[ew.rightCursorHoldingUI]:[{src:{value:WM},dest:{value:dM},xform:D_.falling,priority:4}],[ew.leftCursorHoldingUI]:[{src:{value:VM},dest:{value:hM},xform:D_.falling,priority:4}],[ew.rightCursorHoldingInteractable]:[{src:{value:UA("touchY"),touching:BA("touchpad").touched},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.touch_axis_scroll(-1)},{src:{value:UA("joyY")},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.scale(-.02)},{src:{value:NM},dest:{value:cM},xform:D_.falling,priority:1},{src:[cM,dM],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.any},{src:{},dest:{value:gM},root:"rootForFrozenOverrideWhenHolding",xform:D_.always(!1)}],[ew.leftCursorHoldingInteractable]:[{src:{value:lA("touchY"),touching:sA("touchpad").touched},dest:{value:Xe.a.actions.cursor.left.modDelta},xform:D_.touch_axis_scroll(-1)},{src:{value:lA("joyY")},dest:{value:Xe.a.actions.cursor.left.modDelta},xform:D_.scale(-.02),priority:1},{src:{value:LM},dest:{value:uM},xform:D_.falling,priority:1},{src:[uM,hM],dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.any},{src:{},dest:{value:gM},root:"rootForFrozenOverrideWhenHolding",xform:D_.always(!1)}],[ew.rightCursorHoveringOnPen]:[],[ew.leftCursorHoveringOnPen]:[],[ew.rightCursorHoldingPen]:[{src:[cM],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.noop,priority:1},{src:[dM],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.noop,priority:1},{src:{value:NM},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.rising,priority:1},{src:{bool:iM,value:JA},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.copyIfTrue,priority:2},{src:{value:WM},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.rising,priority:3},{src:{value:WM},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:3},{src:{value:UA("touchX"),touching:BA("touchpad").touched},dest:{value:Xe.a.actions.cursor.right.scalePenTip},xform:D_.touch_axis_scroll(.1)},{src:{bool:iM,value:YA},dest:{value:Xe.a.actions.cursor.right.penNextColor},xform:D_.copyIfTrue,priority:2},{src:{bool:iM,value:KA},dest:{value:Xe.a.actions.cursor.right.penPrevColor},xform:D_.copyIfTrue,priority:2},{src:{value:BA("primary").pressed},dest:{value:Xe.a.actions.cursor.right.undoDrawing},xform:D_.rising,priority:2}],[ew.leftCursorHoldingPen]:[{src:[uM],dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.noop,priority:1},{src:[hM],dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.noop,priority:1},{src:{value:LM},dest:{value:Xe.a.actions.cursor.left.drop},xform:D_.rising,priority:1},{src:{value:VM},dest:{value:Xe.a.actions.cursor.left.startDrawing},xform:D_.rising,priority:3},{src:{value:VM},dest:{value:Xe.a.actions.cursor.left.stopDrawing},xform:D_.falling,priority:3},{src:{value:lA("touchX"),touching:sA("touchpad").touched},dest:{value:Xe.a.actions.cursor.left.scalePenTip},xform:D_.touch_axis_scroll(.1)},{src:{value:UM},dest:{value:IA},xform:D_.rising,priority:1},{src:{bool:IA,value:EA},dest:{value:Xe.a.actions.cursor.left.penNextColor},xform:D_.copyIfTrue,priority:2},{src:{bool:IA,value:wA},dest:{value:Xe.a.actions.cursor.left.penPrevColor},xform:D_.copyIfTrue,priority:2},{src:{value:sA("primary").pressed},dest:{value:Xe.a.actions.cursor.left.undoDrawing},xform:D_.rising,priority:2}],[ew.rightHandHoveringOnInteractable]:[{src:{value:NM},dest:{value:lM},xform:D_.rising},{src:{value:WM},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling,priority:2},{src:[lM],dest:{value:Xe.a.actions.rightHand.grab},xform:D_.any}],[ew.rightHandHoldingInteractable]:[{src:{value:NM},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.falling,priority:1},{src:{},dest:{value:gM},root:"rootForFrozenOverrideWhenHolding",xform:D_.always(!1)}],[ew.rightHandHoveringOnPen]:[],[ew.rightHandHoldingPen]:[{src:{bool:iM,value:JA},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.copyIfTrue},{src:{value:WM},dest:{value:Xe.a.actions.rightHand.startDrawing},xform:D_.rising,priority:3},{src:{value:WM},dest:{value:Xe.a.actions.rightHand.stopDrawing},xform:D_.falling,priority:3},{src:{bool:iM,value:YA},dest:{value:Xe.a.actions.rightHand.penNextColor},xform:D_.copyIfTrue,priority:2},{src:{bool:iM,value:KA},dest:{value:Xe.a.actions.rightHand.penPrevColor},xform:D_.copyIfTrue,priority:2},{src:{value:UA("touchX"),touching:BA("touchpad").touched},dest:{value:Xe.a.actions.rightHand.scalePenTip},xform:D_.touch_axis_scroll(.05)},{src:[sA("primary").pressed,BA("secondary").pressed],dest:{value:fM},xform:D_.any,priority:1},{src:{value:fM},dest:{value:Xe.a.actions.rightHand.undoDrawing},xform:D_.rising},{src:{value:BA("primary").pressed},dest:{value:Xe.a.actions.rightHand.switchDrawMode},xform:D_.rising,priority:2}],[ew.rightCursorHoveringOnCamera]:[],[ew.leftCursorHoveringOnCamera]:[],[ew.rightHandHoveringOnCamera]:[],[ew.leftHandHoveringOnCamera]:[],[ew.rightHandHoldingCamera]:[{src:{value:WM},dest:{value:Xe.a.actions.rightHand.takeSnapshot},xform:D_.copy,priority:3},{src:{value:WM},dest:{value:Xe.a.noop},xform:D_.falling,priority:3}],[ew.leftHandHoldingCamera]:[{src:{value:sA("trigger").pressed},dest:{value:Xe.a.actions.leftHand.takeSnapshot},xform:D_.copy}],[ew.rightCursorHoldingCamera]:[{src:{value:WM},dest:{value:Xe.a.actions.cursor.right.takeSnapshot},xform:D_.copy,priority:3},{src:{value:WM},dest:{value:Xe.a.noop},xform:D_.falling,priority:3}],[ew.leftCursorHoldingCamera]:[{src:{value:VM},dest:{value:Xe.a.actions.cursor.left.takeSnapshot},xform:D_.copy,priority:3},{src:{value:VM},dest:{value:Xe.a.noop},xform:D_.falling,priority:3}],[ew.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:Xe.a.noop},xform:D_.noop,priority:1e3}],[ew.inspecting]:[{src:{value:SM},dest:{value:Xe.a.actions.stopInspecting},xform:D_.falling}]}),XM=I_({[ew.global]:[{src:{value:lA("touchY")},dest:{value:bA},xform:D_.copy}],[ew.leftHandHoldingPen]:[{src:{value:LM},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.rising,priority:2}],[ew.rightHandHoldingPen]:[{src:{value:NM},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.rising,priority:2}]}),QM=I_({[ew.global]:[{src:{value:lA("touchY")},dest:{value:bA},xform:D_.copy}]}),JM=I_({[ew.global]:[{src:{value:lA("touchY")},dest:{value:bA},xform:D_.negate}],[ew.leftHandHoldingPen]:[{src:{value:LM},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.rising,priority:2}],[ew.rightHandHoldingPen]:[{src:{value:NM},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.rising,priority:2}]}),ZM=I_({[ew.global]:[{src:{value:lA("touchY")},dest:{value:bA},xform:D_.copy}],[ew.leftHandHoldingPen]:[{src:{x:lA("joyX"),y:lA("joyY")},dest:{value:dA},xform:D_.compose_vec2,priority:1},{src:{value:dA},dest:{north:AA,south:MA,east:kA,west:OA,center:CA},xform:D_.vec2dpad(.35,!1,!0)},{src:{value:LM},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.rising,priority:2},{src:{value:kA,override:"/device/overrides/foo"},dest:{value:Xe.a.actions.leftHand.penNextColor},xform:D_.rising,priority:2},{src:{value:OA,override:"/device/overrides/foo"},dest:{value:Xe.a.actions.leftHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:lA("joyY")},dest:{value:mA},xform:D_.deadzone(.1),priority:1},{src:{value:mA},dest:{value:Xe.a.actions.leftHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:1}],[ew.rightHandHoldingPen]:[{src:{value:NM},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.rising,priority:2},{src:{value:eM},dest:{value:Xe.a.actions.rightHand.penNextColor},xform:D_.rising,priority:2},{src:{value:tM},dest:{value:Xe.a.actions.rightHand.penPrevColor},xform:D_.rising,priority:2},{src:{value:UA("joyY")},dest:{value:GA},xform:D_.deadzone(.1)},{src:{value:GA},dest:{value:Xe.a.actions.rightHand.scalePenTip},xform:D_.scaleExp(-.005,5),priority:1}]}),$M=Xe.a.device.wmr.left.grip.pressed,ek=Xe.a.device.wmr.right.grip.pressed,tk=Xe.a.device.wmr.right.trigger.pressed,nk=Xe.a.device.wmr.v("right/joy/north"),ak=Xe.a.device.wmr.v("right/grip/rising"),ik=Xe.a.device.wmr.v("right/trigger/rising"),rk=Xe.a.device.wmr.v("right/grip/falling"),ok=Xe.a.device.wmr.v("right/trigger/falling");function sk(e){return{padWest:Xe.a.device.wmr.v(e+"/pad/west"),padEast:Xe.a.device.wmr.v(e+"/pad/east"),padNorth:Xe.a.device.wmr.v(e+"/pad/north"),padSouth:Xe.a.device.wmr.v(e+"/pad/south"),padCenter:Xe.a.device.wmr.v(e+"/pad/center"),padCenterStrip:Xe.a.device.wmr.v(e+"/pad/centerStrip")}}function lk(e){const{padWest:t,padEast:n,padNorth:a,padSouth:i,padCenter:r,padCenterStrip:o}=sk(e),s=Xe.a.device.wmr.v(e+"/pad");return[{src:{x:Xe.a.device.wmr[e].touchpad.axisX,y:Xe.a.device.wmr[e].touchpad.axisY},dest:{value:s},xform:D_.compose_vec2},{src:{value:s},dest:{west:t,east:n,north:a,south:i,center:r},xform:D_.vec2dpad(.5,!1,!1)},{src:[a,r,i],dest:{value:o},xform:D_.any}]}const ck={src:{},dest:{value:Xe.a.actions.ensureFrozen},xform:D_.always(!1)};function dk(e,t){const n=Xe.a.device.wmr[e].touchpad.axisY,a=Xe.a.device.wmr[e].trigger.pressed,i=Xe.a.device.wmr[e].touchpad.pressed,r=Xe.a.device.wmr[e].touchpad.touched,o=Xe.a.device.wmr.v(e+"/pad/rising"),s=Xe.a.device.wmr.v(e+"/pad/centerStrip/touched"),{padWest:l,padEast:c,padCenter:d,padCenterStrip:u}=sk(e),h=t?Xe.a.actions.cursor[e]:Xe.a.actions[e+"Hand"];return[ck,...lk(e),{src:{value:a},dest:{value:h.startDrawing},xform:D_.rising},{src:{value:a},dest:{value:h.stopDrawing},xform:D_.falling},{src:{value:i},dest:{value:o},xform:D_.rising},{src:{bool:o,value:l},dest:{value:h.penPrevColor},xform:D_.copyIfTrue},{src:{bool:o,value:c},dest:{value:h.penNextColor},xform:D_.copyIfTrue},{src:[u,r],dest:{value:s},xform:D_.all},{src:{value:n,touching:s},dest:{value:h.scalePenTip},xform:D_.touch_axis_scroll(-.05)},{src:[o,d],dest:{value:h.undoDrawing},xform:D_.all}]}function uk(e){const t=Xe.a.device.wmr[e].touchpad.touched,n=Xe.a.device.wmr[e].trigger.pressed,a=Xe.a.device.wmr[e].grip.pressed,i=Xe.a.actions[e+"Hand"];return[{src:{value:t},dest:{value:i.thumb},xform:D_.copy},{src:{value:n},dest:{value:i.index},xform:D_.copy},{src:{value:a},dest:{value:i.middleRingPinky},xform:D_.copy}]}function hk(e,t){const n=t?Xe.a.actions.cursor[e]:Xe.a.actions[e+"Hand"];return[ck,{src:{value:Xe.a.device.wmr[e].trigger.pressed},dest:{value:n.takeSnapshot},xform:D_.copy}]}const pk=I_({[ew.global]:[{src:{value:Xe.a.device.wmr.left.matrix},dest:{value:Xe.a.actions.leftHand.matrix},xform:D_.copy},{src:{value:Xe.a.device.wmr.right.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:{value:Xe.a.device.wmr.left.pose},dest:{value:Xe.a.actions.leftHand.pose},xform:D_.copy},{src:{value:Xe.a.device.wmr.right.pose},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:Xe.a.device.wmr.right.pose},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy},...uk("left"),...uk("right"),...function(){const e=Xe.a.device.wmr.left.touchpad.pressed,t=Xe.a.device.wmr.right.touchpad.pressed,n=Xe.a.device.wmr.v("left/touchpad/falling"),a=Xe.a.device.wmr.v("right/touchpad/falling"),i=Xe.a.device.wmr.k("space/falling");return[{src:[Xe.a.device.keyboard.key(" "),e,t],dest:{value:Xe.a.actions.ensureFrozen},xform:D_.any},{src:{value:Xe.a.device.keyboard.key(" ")},dest:{value:i},xform:D_.falling},{src:{value:Xe.a.device.keyboard.key("Tab")},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.rising},{src:{value:e},dest:{value:n},xform:D_.falling},{src:{value:t},dest:{value:a},xform:D_.falling},{src:[i,n,a],dest:{value:Xe.a.actions.thaw},xform:D_.any}]}(),...function(){const e=Xe.a.device.wmr.v("right/joy"),t=Xe.a.device.wmr.v("right/joy/west"),n=Xe.a.device.wmr.v("right/joy/East"),a=Xe.a.device.wmr.v("right/joy/west/rising"),i=Xe.a.device.wmr.v("right/joy/east/rising"),r=Xe.a.device.wmr.k("q/rising"),o=Xe.a.device.wmr.k("e/rising");return[{src:{x:Xe.a.device.wmr.right.joystick.axisX,y:Xe.a.device.wmr.right.joystick.axisY},dest:{value:e},xform:D_.compose_vec2},{src:{value:e},dest:{north:nk,west:t,east:n},xform:D_.vec2dpad(.2,!1,!1)},{src:{value:nk},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.rising},{src:{value:t},dest:{value:a},xform:D_.rising},{src:{value:n},dest:{value:i},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("q")},dest:{value:r},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("e")},dest:{value:o},xform:D_.rising},{src:[a,r],dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.any},{src:[i,o],dest:{value:Xe.a.actions.snapRotateRight},xform:D_.any}]}(),...function(){const e=Xe.a.device.wmr.k("wasd_vec2"),t=Xe.a.device.wmr.k("arrows_vec2"),n=Xe.a.device.wmr.k("characterAcceleration"),a=Xe.a.device.wmr.v("left/joy/x/deadzoned"),i=Xe.a.device.wmr.v("left/joy/y/deadzoned"),r=Xe.a.device.wmr.v("left/joy/x/scaled"),o=Xe.a.device.wmr.v("left/joy/y/scaled"),s=Xe.a.device.wmr.v("left/characterAcceleration");return[{src:{w:Xe.a.device.keyboard.key("arrowup"),a:Xe.a.device.keyboard.key("arrowleft"),s:Xe.a.device.keyboard.key("arrowdown"),d:Xe.a.device.keyboard.key("arrowright")},dest:{vec2:t},xform:D_.wasd_to_vec2},{src:{w:Xe.a.device.keyboard.key("w"),a:Xe.a.device.keyboard.key("a"),s:Xe.a.device.keyboard.key("s"),d:Xe.a.device.keyboard.key("d")},dest:{vec2:e},xform:D_.wasd_to_vec2},{src:{first:e,second:t},dest:{value:n},xform:D_.max_vec2},{src:{value:Xe.a.device.wmr.left.joystick.axisX},dest:{value:a},xform:D_.deadzone(.2)},{src:{value:a},dest:{value:r},xform:D_.scale(1.5)},{src:{value:Xe.a.device.wmr.left.joystick.axisY},dest:{value:i},xform:D_.deadzone(.2)},{src:{value:i},dest:{value:o},xform:D_.scale(-1.5)},{src:{x:r,y:o},dest:{value:s},xform:D_.compose_vec2},{src:{first:s,second:n},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.max_vec2},{src:[Xe.a.device.wmr.left.trigger.pressed,Xe.a.device.wmr.right.trigger.pressed,Xe.a.device.keyboard.key("shift")],dest:{value:Xe.a.actions.boost},xform:D_.any}]}(),{src:{value:Xe.a.device.keyboard.key("m")},dest:{value:Xe.a.actions.muteMic},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("t")},dest:{value:Xe.a.actions.focusChat},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("/")},dest:{value:Xe.a.actions.focusChatCommand},xform:D_.rising},{src:{value:Xe.a.device.keyboard.key("Escape")},dest:{value:Xe.a.actions.mediaExit},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("1")},dest:{value:"/var/shift+1"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+1"},dest:{value:Xe.a.actions.mediaSearch1},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("2")},dest:{value:"/var/shift+2"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+2"},dest:{value:Xe.a.actions.mediaSearch2},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("3")},dest:{value:"/var/shift+3"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+3"},dest:{value:Xe.a.actions.mediaSearch3},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("4")},dest:{value:"/var/shift+4"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+4"},dest:{value:Xe.a.actions.mediaSearch4},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("5")},dest:{value:"/var/shift+5"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+5"},dest:{value:Xe.a.actions.mediaSearch5},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("6")},dest:{value:"/var/shift+6"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+6"},dest:{value:Xe.a.actions.mediaSearch6},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("7")},dest:{value:"/var/shift+7"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+7"},dest:{value:Xe.a.actions.mediaSearch7},xform:D_.rising},{src:{bool:Xe.a.device.keyboard.key("control"),value:Xe.a.device.keyboard.key("8")},dest:{value:"/var/shift+8"},priority:1001,xform:D_.copyIfTrue},{src:{value:"/var/shift+8"},dest:{value:Xe.a.actions.mediaSearch8},xform:D_.rising}],[ew.leftHandHoveringOnNothing]:[],[ew.rightCursorHoveringOnNothing]:[],[ew.rightHandHoveringOnNothing]:[],[ew.rightHandTeleporting]:[{src:{value:nk},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.falling}],[ew.rightCursorHoveringOnUI]:[{src:{value:tk},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising}],[ew.rightCursorHoveringOnVideo]:[...function(){const e="right",t=Xe.a.device.wmr[e].touchpad.axisY,n=Xe.a.device.wmr[e].touchpad.touched,a=Xe.a.device.wmr.v(e+"/pad/centerStrip/touched"),{padCenterStrip:i}=sk(e);return[...lk(e),{src:[i,n],dest:{value:a},xform:D_.all},{src:{value:t,touching:a},dest:{value:Xe.a.actions.cursor[e].mediaVolumeMod},xform:D_.touch_axis_scroll(-.1)}]}()],[ew.leftHandHoveringOnInteractable]:[{src:{value:$M},dest:{value:Xe.a.actions.leftHand.grab},xform:D_.rising}],[ew.rightCursorHoveringOnInteractable]:[{src:{value:ek},dest:{value:ak},xform:D_.rising},{src:{value:tk},dest:{value:ik},xform:D_.rising},{src:[ak,ik],dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.any}],[ew.rightHandHoveringOnInteractable]:[{src:{value:ek},dest:{value:Xe.a.actions.rightHand.grab},xform:D_.rising}],[ew.leftHandHoldingInteractable]:[ck,{src:{value:$M},dest:{value:Xe.a.actions.leftHand.drop},xform:D_.falling}],[ew.rightCursorHoldingInteractable]:[ck,...function(){const{padNorth:e,padSouth:t}=sk("right"),n=Xe.a.device.wmr.v("right/pad/northOrSouth"),a=Xe.a.device.wmr.v("right/pad/northOrSouth/pressed"),i=Xe.a.device.wmr.v("right/pad/northOrSouthpressed/y");return[...lk("right"),{src:[e,t],dest:{value:n},xform:D_.any},{src:[n,Xe.a.device.wmr.right.touchpad.pressed],dest:{value:a},xform:D_.all},{src:{bool:a,value:Xe.a.device.wmr.right.touchpad.axisY},dest:{value:i},xform:D_.copyIfTrue},{src:{value:i},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.scale(.1)}]}(),{src:{value:ek},dest:{value:rk},xform:D_.falling},{src:{value:tk},dest:{value:ok},xform:D_.falling},{src:[rk,ok],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.any}],[ew.rightHandHoldingInteractable]:[ck,{src:{value:ek},dest:{value:Xe.a.actions.rightHand.drop},xform:D_.falling}],[ew.leftHandHoveringOnPen]:[],[ew.rightCursorHoveringOnPen]:[],[ew.rightHandHoveringOnPen]:[],[ew.leftHandHoldingPen]:dk("left"),[ew.rightCursorHoldingPen]:dk("right",!0),[ew.rightHandHoldingPen]:dk("right"),[ew.leftHandHoveringOnCamera]:[],[ew.rightCursorHoveringOnCamera]:[],[ew.rightHandHoveringOnCamera]:[],[ew.leftHandHoldingCamera]:hk("left"),[ew.rightCursorHoldingCamera]:hk("right",!0),[ew.rightHandHoldingCamera]:hk("right"),[ew.inputFocused]:[{src:{value:"/device/keyboard"},dest:{value:Xe.a.noop},xform:D_.noop,priority:1e3}]}),mk=Xe.a.device.xbox.button,fk=Xe.a.device.xbox.axis,gk=Xe.a.device.xbox.v("scaledRightJoystickVertical"),vk=Xe.a.device.xbox.v("scaledLeftJoystickCursorDelta"),bk=Xe.a.device.xbox.v("scaledRightJoystickHorizontal"),yk=Xe.a.device.xbox.v("deadzonedRightJoystickHorizontal"),Ek=Xe.a.device.xbox.v("deadzonedRightJoystickVertical"),wk=Xe.a.device.xbox.v("deadzonedLeftJoystickHorizontal"),_k=Xe.a.device.xbox.v("deadzonedLeftJoystickVertical"),Sk=Xe.a.device.xbox.v("vec2Zero"),xk=Xe.a.device.xbox.v("zero");function Ak(e){const t=Xe.a.device.xbox.v("scaledLeftJoystickHorizontal"),n=Xe.a.device.xbox.v("scaledLeftJoystickVertical"),a=Xe.a.device.xbox.v("scaledLeftJoystickForwardAcceleration");return[{src:{value:wk},dest:{value:t},xform:D_.scale(1.5)},{src:{value:_k},dest:{value:n},xform:D_.scale(-1.25)},{src:{bool:mk("leftTrigger").pressed,value:n},dest:{value:a},xform:e?D_.copyIfFalse:D_.copy},{src:{x:t,y:a},dest:{value:Xe.a.actions.characterAcceleration},xform:D_.compose_vec2}]}const Mk=I_({[ew.rightCursorHoldingPen]:[{src:{value:mk("rightTrigger").pressed},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.rising,priority:200},{src:{value:mk("rightTrigger").pressed},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.falling,priority:200},{src:{value:mk("b").pressed},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.rising},{src:{value:mk("y").pressed},dest:{value:Xe.a.actions.cursor.right.undoDrawing},xform:D_.rising,priority:200},{src:{value:mk("a").pressed},dest:{value:Xe.a.actions.cursor.right.penNextColor},xform:D_.rising},{src:{value:mk("x").pressed},dest:{value:Xe.a.actions.cursor.right.penPrevColor},xform:D_.rising}],[ew.global]:[{src:{},dest:{value:Xe.a.actions.cursor.right.hideLine},xform:D_.always(!0)},{src:{value:fk("rightJoystickHorizontal")},dest:{value:yk},xform:D_.deadzone(.1)},{src:{value:yk},dest:{value:bk},xform:D_.scale(-.125)},{src:{value:fk("rightJoystickVertical")},dest:{value:Ek},xform:D_.deadzone(.1)},{src:{value:Ek},dest:{value:gk},xform:D_.scale(-.125)},{src:{},dest:{value:xk},xform:D_.always(0)},{src:{x:bk,y:gk},dest:{value:Xe.a.actions.cameraDelta},xform:D_.compose_vec2},{src:{value:Xe.a.actions.cameraDelta},dest:{value:Xe.a.actions.lobbyCameraDelta},xform:D_.copy},{src:{value:fk("leftJoystickHorizontal")},dest:{value:wk},xform:D_.deadzone(.1)},{src:{value:fk("leftJoystickVertical")},dest:{value:_k},xform:D_.deadzone(.1)},{src:{value:mk("leftTrigger").pressed},dest:{value:Xe.a.actions.boost},xform:D_.copy},{src:{value:mk("leftBumper").pressed},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.rising},{src:{value:mk("rightBumper").pressed},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.rising},{src:{},dest:{value:Sk},xform:D_.vec2Zero},{src:{value:Sk},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.poseFromCameraProjection()},{src:{value:mk("y").pressed},dest:{value:Xe.a.actions.spawnPen},xform:D_.rising,priority:100},{src:{value:mk("dpadUp").pressed},dest:{value:Xe.a.actions.ensureFrozen},xform:D_.copy},{src:{value:mk("dpadUp").pressed},dest:{value:Xe.a.actions.thaw},xform:D_.falling},{src:{value:mk("start").pressed},dest:{value:Xe.a.actions.toggleFreeze},xform:D_.rising},{src:{value:mk("a").pressed},dest:{value:Xe.a.actions.startGazeTeleport},xform:D_.rising},{src:{value:mk("a").pressed},dest:{value:Xe.a.actions.stopGazeTeleport},xform:D_.falling}],[ew.rightCursorHoldingNothing]:[...Ak()],[ew.rightCursorHoldingInteractable]:[...Ak(!0),{src:{value:mk("rightTrigger").pressed},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.falling,priority:100},{src:{value:_k},dest:{value:vk},xform:D_.scale(.25)},{src:{bool:mk("leftTrigger").pressed,value:vk},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.copyIfTrue}],[ew.rightCursorHoveringOnUI]:[{src:{value:mk("rightTrigger").pressed},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising}],[ew.rightCursorHoveringOnInteractable]:[...Ak(),{src:{value:mk("rightTrigger").pressed},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.rising,priority:100}]}),kk=e=>"/vars/daydream/".concat(e),Ok=kk("touchpad/axis"),Ck=kk("touchpad/rising"),Pk=kk("touchpad/falling"),Rk=kk("touchpad/pressed"),Tk=kk("dpad/north"),jk=kk("dpad/south"),Dk=kk("dpad/east"),Ik=kk("dpad/west"),Lk=kk("dpad/center"),Hk=kk("brushSizeDelta"),Nk=kk("cursorModDelta"),Fk=kk("dropSouth"),Vk=kk("dropCenter"),Bk=[{src:{value:Lk,bool:Ck},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.copyIfTrue,priority:100}],Uk=[{src:{value:Lk,bool:Ck},dest:{value:Vk},xform:D_.copyIfTrue,priority:100},{src:{value:jk,bool:Ck},dest:{value:Fk},xform:D_.copyIfTrue,priority:100},{src:[Vk,Fk],dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.any}],zk=I_({[ew.global]:[{src:{value:Xe.a.device.daydream.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:{x:Xe.a.device.daydream.axis("touchpadX"),y:Xe.a.device.daydream.axis("touchpadY")},dest:{value:Ok},xform:D_.compose_vec2},{src:{value:Xe.a.device.daydream.button("touchpad").pressed},dest:{value:Ck},xform:D_.rising},{src:{value:Xe.a.device.daydream.button("touchpad").pressed},dest:{value:Pk},xform:D_.falling},{src:{value:Xe.a.device.daydream.button("touchpad").pressed},dest:{value:Rk},xform:D_.copy},{src:{value:Ok},dest:{north:Tk,south:jk,east:Dk,west:Ik,center:Lk},xform:D_.vec2dpad(.5)},{src:{value:Dk,bool:Ck},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.copyIfTrue},{src:{value:Ik,bool:Ck},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.copyIfTrue},{src:{value:Lk,bool:Ck},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.copyIfTrue},{src:{value:Xe.a.device.daydream.pose},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:Xe.a.device.daydream.pose},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy}],[ew.rightCursorHoveringOnInteractable]:Bk,[ew.rightCursorHoveringOnUI]:Bk,[ew.rightCursorHoveringOnVideo]:[{src:{value:Xe.a.device.daydream.axis("touchpadY"),touching:Xe.a.device.daydream.button("touchpad").touched},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.touch_axis_scroll(-.1)}],[ew.rightCursorHoldingInteractable]:[{src:{value:Pk},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.copy},{src:{value:Xe.a.device.daydream.axis("touchpadY"),touching:Xe.a.device.daydream.button("touchpad").touched},dest:{value:Nk},xform:D_.touch_axis_scroll()},{src:{value:Nk},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.copy}],[ew.rightHandTeleporting]:[{src:{value:Pk},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.copy}],[ew.rightCursorHoldingPen]:[{src:{value:Tk,bool:Ck},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.copyIfTrue,priority:100},{src:{value:Pk},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.copy,priority:100},{src:{value:Xe.a.device.daydream.axis("touchpadX"),touching:Xe.a.device.daydream.button("touchpad").touched},dest:{value:Hk},xform:D_.touch_axis_scroll(-.1)},{src:{value:Hk,bool:Rk},dest:{value:Xe.a.actions.cursor.right.scalePenTip},xform:D_.copyIfFalse,priority:100},{src:{value:Dk,bool:Ck},dest:{value:Xe.a.actions.cursor.right.penPrevColor},xform:D_.copyIfTrue,priority:100},{src:{value:Ik,bool:Ck},dest:{value:Xe.a.actions.cursor.right.penNextColor},xform:D_.copyIfTrue,priority:100},{src:{value:Nk,bool:Rk},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.copyIfFalse,priority:100},...Uk],[ew.rightCursorHoldingCamera]:[{src:{value:Pk},xform:D_.noop,priority:100},{src:{value:Tk,bool:Ck},dest:{value:Xe.a.actions.cursor.right.takeSnapshot},xform:D_.copy,priority:100},...Uk]}),Wk=I_({[ew.global]:[{src:{value:Xe.a.device.touchscreen.isTouching},dest:{value:Xe.a.actions.startGazeTeleport},xform:D_.rising},{src:{value:Xe.a.device.touchscreen.isTouching},dest:{value:Xe.a.actions.stopGazeTeleport},xform:D_.falling}]});function qk(e){const t=e.v("touchpad"),n=e.button("touchpad"),a=e.button("trigger"),i=e.axis("touchpadX"),r=e.axis("touchpadXForPen"),o=e.axis("touchpadY"),s=e.axis("touchpadYForPen"),l=e.v("touchpad/rising"),c=e.v("touchpad/falling"),d=e.v("trigger/rising"),u=e.v("trigger/falling"),h=e.v("dpad/north"),p=e.v("dpad/south"),m=e.v("dpad/east"),f=e.v("dpad/west"),g=e.v("dpad/center"),v=e.v("dpad/centerStrip"),b=e.v("dpad/bottomCenterStrip"),y="/vars/oculus-go/togglePen",E={src:{value:d},dest:{value:Xe.a.actions.cursor.right.grab},xform:D_.copy,priority:200},w={src:{value:u},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.copy,priority:200};return I_({[ew.global]:[{src:{value:e.matrix},dest:{value:Xe.a.actions.rightHand.matrix},xform:D_.copy},{src:{value:a.pressed},dest:{value:d},xform:D_.rising},{src:{value:a.pressed},dest:{value:u},xform:D_.falling},{src:{value:n.pressed},dest:{value:l},xform:D_.rising,priority:100},{src:{value:n.pressed},dest:{value:c},xform:D_.falling,priority:100},{src:{x:i,y:o},dest:{value:t},xform:D_.compose_vec2},{src:{value:i},dest:{value:r},xform:D_.copy},{src:{value:o},dest:{value:s},xform:D_.copy},{src:{value:t},dest:{north:h,south:p,east:m,west:f,center:g},xform:D_.vec2dpad(.3)},{src:[g,p],dest:{value:b},xform:D_.any},{src:[h,b],dest:{value:v},xform:D_.any},{src:{value:v,bool:n.pressed},dest:{value:Xe.a.actions.ensureFrozen},priority:100,xform:D_.copyIfTrue},{src:{value:c},dest:{value:Xe.a.actions.thaw},xform:D_.copy},{src:{value:m,bool:l},dest:{value:Xe.a.actions.snapRotateRight},xform:D_.copyIfTrue,priority:100},{src:{value:f,bool:l},dest:{value:Xe.a.actions.snapRotateLeft},xform:D_.copyIfTrue,priority:100},{src:{value:d},dest:{value:Xe.a.actions.rightHand.startTeleport},xform:D_.copy,priority:100},{src:{value:e.pose},dest:{value:Xe.a.actions.cursor.right.pose},xform:D_.copy},{src:{value:e.pose},dest:{value:Xe.a.actions.rightHand.pose},xform:D_.copy},{src:{value:n.touched},dest:{value:Xe.a.actions.rightHand.thumb},xform:D_.copy},{src:{value:a.pressed},dest:{value:Xe.a.actions.rightHand.index},xform:D_.copy},{src:{value:a.pressed},dest:{value:Xe.a.actions.rightHand.middleRingPinky},xform:D_.copy}],[ew.rightCursorHoveringOnInteractable]:[E],[ew.rightCursorHoveringOnUI]:[E],[ew.rightCursorHoldingUI]:[w],[ew.rightCursorHoveringOnVideo]:[{src:{value:o,touching:n.touched},dest:{value:Xe.a.actions.cursor.right.mediaVolumeMod},xform:D_.touch_axis_scroll(-.1)}],[ew.rightCursorHoldingInteractable]:[{src:{value:u},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.copy,priority:200},{src:{value:o,touching:n.touched},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.touch_axis_scroll()},{src:{value:v},priority:200,xform:D_.noop}],[ew.rightHandTeleporting]:[{src:{value:u},dest:{value:Xe.a.actions.rightHand.stopTeleport},xform:D_.copy,priority:100}],[ew.rightCursorHoldingPen]:[{src:{value:d},dest:{value:Xe.a.actions.cursor.right.startDrawing},xform:D_.copy,priority:300},{src:{value:u},dest:{value:Xe.a.actions.cursor.right.stopDrawing},xform:D_.copy,priority:300},{src:{value:r,touching:n.touched},dest:{value:Xe.a.actions.cursor.right.scalePenTip},xform:D_.touch_axis_scroll(.1,.1),priority:200},{src:{value:s,touching:n.touched},dest:{value:Xe.a.actions.cursor.right.modDelta},xform:D_.touch_axis_scroll(1,.1),priority:200},{src:{value:b,bool:c},dest:{value:y},xform:D_.copyIfTrue,priority:300},{src:{value:y},dest:{value:Xe.a.actions.cursor.right.drop},xform:D_.rising,priority:200},{src:{value:y},dest:{value:Xe.a.actions.pen.remove},xform:D_.rising,priority:200},{src:{value:m,bool:l},dest:{value:Xe.a.actions.cursor.right.penPrevColor},xform:D_.copyIfTrue,priority:200},{src:{value:f,bool:l},dest:{value:Xe.a.actions.cursor.right.penNextColor},xform:D_.copyIfTrue,priority:200},{src:{value:h,bool:l},dest:{value:Xe.a.actions.cursor.right.undoDrawing},xform:D_.copyIfTrue,priority:200}],[ew.rightCursorHoldingCamera]:[{src:{value:d},dest:{value:Xe.a.actions.cursor.right.takeSnapshot},xform:D_.copy,priority:300}]})}const Gk=Object(mt.a)("dui");let Yk,Kk;class Xk{constructor(e){this.gamepad=e}write(e){this.gamepad.connected&&(this.gamepad.buttons.forEach((t,n)=>{const a=Xe.a.device.gamepad(this.gamepad.index).button(n);e.setValueType(a.pressed,!!t.pressed),e.setValueType(a.touched,!!t.touched),e.setValueType(a.value,t.value)}),this.gamepad.axes.forEach((t,n)=>{e.setValueType(Xe.a.device.gamepad(this.gamepad.index).axis(n),t)}))}}const Qk={},Jk=qk(Xe.a.device.oculusgo),Zk=qk(Xe.a.device.gearVRController);const $k=(e,t)=>{for(const n in e.dest)if(-1!==e.dest[n].indexOf(t))return!0;return!1},eO=(e,t)=>{for(const n of e)if($k(n,t))return!0;return!1},tO=(e,t)=>{for(const n of Object.values(e.src))if(!n.startsWith("/device/")&&!eO(t,n))return!1;return!0};function nO(e){return""!==e}function aO(e,t){const n=e.split("/").filter(nO),a=t.split("/").filter(nO);if(n.length>a.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==a[e])return!1;return!0}function iO(e,t){if(void 0===e.priority&&(e.priority=0),void 0===t.priority&&(t.priority=0),t.priority>=e.priority)return!1;for(const n in e.src){const a=e.src[n];for(const e in t.src){const n=t.src[e];if(-1!==n.indexOf(a)&&aO(a,n))return!0}}return!1}function rO(e,t){for(let n=0;n<e.sets.length;n++)if(t.includes(e.sets[n]))return!0;return!1}AFRAME.registerSystem("userinput",{get(e){if(this.frame)return this.frame.get(e)},toggleSet(e,t){this.pendingSetChanges.push(e),this.pendingSetChanges.push(!!t)},init(){this.frame={generation:0,values:{},generations:{},get:function(e){if(this.generations[e]===this.generation)return this.values[e]},setValueType:function(e,t){this.values[e]=t,this.generations[e]=this.generation},setVector2:function(e,t,n){const a=this.values[e]||[];a[0]=t,a[1]=n,this.values[e]=a,this.generations[e]=this.generation},setPose:function(e,t){this.setValueType(e,t)},setMatrix4:function(e,t){const n=this.values[e]||new THREE.Matrix4;n.copy(t),this.values[e]=n,this.generations[e]=this.generation}},this.prevActiveSets=[],this.activeSets=[ew.global],this.pendingSetChanges=[],this.xformStates=new Map,this.activeDevices=new iw([new sw]);const e=AFRAME.utils.device.isMobile(),t=AFRAME.utils.device.isMobileVR(),n=Object(RE.a)();e||t||n?t&&!n||(this.activeDevices.add(new j_),this.activeDevices.add(new ow),this.activeDevices.add(new f_)):(this.activeDevices.add(new aw),this.activeDevices.add(new __),this.activeDevices.add(new ow)),this.isMobile=e,this.isMobileVR=t,this.registeredMappings=new Set([W_]),this.registeredMappingsChanged=!0;const a=new Map;a.set(i_,pk),a.set(e_,KM),a.set(Vw,YS),a.set(Mw,Jk),a.set(jw,Zk),a.set(Xw,zk),a.set(c_,aA);const i=new Map;i.set(lw,Mk),i.set(Xk,Qk);const r=e=>{e instanceof e_&&e.gamepad&&("OpenVR Cosmos"===e.gamepad.id?this.registeredMappings.add(ZM):"HTC Vive Focus Plus Controller"===e.gamepad.id?this.registeredMappings.add(JM):4===e.gamepad.axes.length?this.registeredMappings.add(QM):this.registeredMappings.add(XM))},o=e=>{e instanceof e_&&e.gamepad&&(this.registeredMappings.delete(ZM),this.registeredMappings.delete(JM),this.registeredMappings.delete(QM),this.registeredMappings.delete(XM))},s=()=>{const e=this.el.sceneEl.is("vr-mode"),t=AFRAME.utils.device.isMobile(),n=Object(RE.a)();if(e){console.log("Using VR bindings."),this.registeredMappings.delete(t||n?z_:B_);for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e],n=a.get(t.constructor);n&&this.registeredMappings.add(n),r(t)}t&&ir().then(e=>{e.cardboard===Zi&&(this.registeredMappings.add(Wk),this.registeredMappingsChanged=!0)})}else{console.log("Using Non-VR bindings.");for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e];o(t),this.registeredMappings.delete(a.get(t.constructor))}this.registeredMappings.add(t||n?z_:B_)}for(let e=0;e<this.activeDevices.items.length;e++){const t=this.activeDevices.items[e],n=i.get(t.constructor);n&&this.registeredMappings.add(n)}this.registeredMappingsChanged=!0},l=e=>{let t;for(let t=0;t<this.activeDevices.items.length;t++){const n=this.activeDevices.items[t];if(!e.gamepad.isWebXRGamepad&&n.gamepad&&n.gamepad.index===e.gamepad.index)return void console.warn("connected already fired for gamepad",e.gamepad)}t=e.gamepad.isWebXRGamepad?new c_(e.gamepad):e.gamepad.id.startsWith("OpenVR Gamepad")||e.gamepad.id.startsWith("OpenVR Knuckles")||"HTC Vive Focus Plus Controller"===e.gamepad.id||"OpenVR Cosmos"===e.gamepad.id?new e_(e.gamepad):e.gamepad.id.startsWith("Oculus Touch")||e.gamepad.id.startsWith("Pico Neo 2")?new Vw(e.gamepad):e.gamepad.id.startsWith("Spatial Controller")?new i_(e.gamepad):"Oculus Go Controller"===e.gamepad.id||"Pico G2 Controller"===e.gamepad.id?new Mw(e.gamepad):"Gear VR Controller"===e.gamepad.id||"HTC Vive Focus Controller"===e.gamepad.id?new jw(e.gamepad):"Daydream Controller"===e.gamepad.id?new Xw(e.gamepad):"standard"===e.gamepad.mapping?new lw(e.gamepad):new Xk(e.gamepad),this.activeDevices.add(t),s()},c=e=>{for(let t=0;t<this.activeDevices.items.length;t++){const n=this.activeDevices.items[t];if(n.gamepad&&n.gamepad.index===e.gamepad.index)return this.registeredMappings.delete(a.get(n.constructor)||i.get(n.constructor)),void this.activeDevices.delete(n)}s()};window.addEventListener("gamepadconnected",l,!1),window.addEventListener("gamepaddisconnected",c,!1);for(const e of navigator.getGamepads())e&&l({gamepad:e});const d=({added:e,removed:t})=>{for(const e of t)c(e);for(const t of e)t.gamepad.isWebXRGamepad=!0,t.gamepad.targetRaySpace=t.targetRaySpace,t.gamepad.primaryProfile=t.profiles[0],void 0===t.gamepad.hand&&(t.gamepad.hand=t.handedness),l(t)};this.el.sceneEl.addEventListener("enter-vr",()=>{const{xrSession:e}=this.el.sceneEl;e&&(e.addEventListener("inputsourceschange",d),e.requestReferenceSpace("local-floor").then(e=>{this.xrReferenceSpace=e}),e.addEventListener("end",()=>{this.activeDevices.items.filter(e=>e.gamepad&&e.gamepad.isWebXRGamepad).forEach(c)})),s()}),this.el.sceneEl.addEventListener("exit-vr",s),s()},maybeToggleXboxMapping(){if(Object(RE.a)()||this.isMobile||this.isMobileVR)return;const e=(this.get(Xe.a.device.vive.left.axesSum)||0)+(this.get(Xe.a.device.vive.right.axesSum)||0)+(this.get(Xe.a.device.leftOculusTouch.axesSum)||0)+(this.get(Xe.a.device.rightOculusTouch.axesSum)||0),t=this.get(Xe.a.device.mouse.movementXY),n=(t&&(t[0]||t[1]))>2||e>.5,a=this.registeredMappings.has(Mk);n&&a?(this.registeredMappings.delete(Mk),this.registeredMappingsChanged=!0):this.get(Xe.a.device.xbox.axesSum)>.5&&!a&&(this.registeredMappings.add(Mk),this.registeredMappingsChanged=!0)},tick2(){this.frame.generation+=1;const e=this.registeredMappingsChanged;e&&(this.registeredMappingsChanged=!1,this.prevSortedBindings=this.sortedBindings,this.sortedBindings=function(e){const t=[];for(const n of e)for(const e in n)for(const a of n[e])t.push(a);const n=[];for(;t.length>0;){const e=t.shift();tO(e,n)?n.push(e):t.push(e)}return n}(this.registeredMappings),this.prevSortedBindings||(this.prevSortedBindings=this.sortedBindings),this.masks=function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++){const a=t[n]=[],i=e[n];for(let t=0;t<e.length;t++)iO(e[t],i)&&a.push(t)}return t}(this.sortedBindings)),this.prevActiveSets.length=0;for(let e=0;e<this.activeSets.length;e++){const t=this.activeSets[e];this.prevActiveSets.push(t)}!function(){if(Yk=Yk||document.getElementById("player-left-controller")&&document.getElementById("player-left-controller").components.teleporter,Kk=Kk||document.getElementById("player-right-controller")&&document.getElementById("player-right-controller").components.teleporter,!Yk||!Kk)return;const e=AFRAME.scenes[0].systems.userinput,{leftHand:t,rightHand:n,rightRemote:a,leftRemote:i}=AFRAME.scenes[0].systems.interaction.state;e.toggleSet(ew.leftHandHoldingInteractable,t.held),e.toggleSet(ew.rightHandHoldingInteractable,n.held),e.toggleSet(ew.leftCursorHoldingInteractable,i.held),e.toggleSet(ew.rightCursorHoldingInteractable,a.held),e.toggleSet(ew.leftHandHoveringOnNothing,!(i.held||i.hovered||t.held||t.hovered)),e.toggleSet(ew.rightHandHoveringOnNothing,!(a.held||a.hovered||n.held||n.hovered)),e.toggleSet(ew.leftCursorHoveringOnNothing,!(t.held||t.hovered||i.held||i.hovered)),e.toggleSet(ew.rightCursorHoveringOnNothing,!(n.held||n.hovered||a.held||a.hovered)),e.toggleSet(ew.leftHandHoveringOnPen,!t.held&&t.hovered&&t.hovered.components.tags&&t.hovered.components.tags.data.isPen),e.toggleSet(ew.rightHandHoveringOnPen,!n.held&&n.hovered&&n.hovered.components.tags&&n.hovered.components.tags.data.isPen),e.toggleSet(ew.leftCursorHoveringOnPen,!t.held&&!t.hovered&&!i.held&&i.hovered&&i.hovered.components.tags&&i.hovered.components.tags.data.isPen),e.toggleSet(ew.rightCursorHoveringOnPen,!n.held&&!n.hovered&&!a.held&&a.hovered&&a.hovered.components.tags&&a.hovered.components.tags.data.isPen),e.toggleSet(ew.leftHandHoveringOnCamera,!t.held&&t.hovered&&t.hovered.components["camera-tool"]),e.toggleSet(ew.rightHandHoveringOnCamera,!n.held&&n.hovered&&n.hovered.components["camera-tool"]),e.toggleSet(ew.leftCursorHoveringOnCamera,!t.held&&!t.hovered&&!i.held&&i.hovered&&i.hovered.components["camera-tool"]),e.toggleSet(ew.rightCursorHoveringOnCamera,!n.held&&!n.hovered&&!a.held&&a.hovered&&a.hovered.components["camera-tool"]),e.toggleSet(ew.leftHandHoveringOnInteractable,!t.held&&t.hovered&&(t.hovered.components.tags&&t.hovered.components.tags.data.offersHandConstraint||t.hovered.components["super-spawner"])),e.toggleSet(ew.rightHandHoveringOnInteractable,!n.held&&n.hovered&&(n.hovered.components.tags&&n.hovered.components.tags.data.offersHandConstraint||n.hovered.components["super-spawner"])),e.toggleSet(ew.leftCursorHoveringOnInteractable,!t.held&&!t.hovered&&!i.held&&i.hovered&&(i.hovered.components.tags&&i.hovered.components.tags.data.offersRemoteConstraint||i.hovered.components.tags&&i.hovered.components.tags.data.togglesHoveredActionSet||i.hovered.components["super-spawner"])),e.toggleSet(ew.rightCursorHoveringOnInteractable,!n.held&&!n.hovered&&!a.held&&a.hovered&&(a.hovered.components.tags&&a.hovered.components.tags.data.offersRemoteConstraint||a.hovered.components.tags&&a.hovered.components.tags.data.togglesHoveredActionSet||a.hovered.components["super-spawner"])),e.toggleSet(ew.leftHandHoveringOnVideo,!t.held&&t.hovered&&t.hovered.components["media-video"]),e.toggleSet(ew.rightHandHoveringOnVideo,!n.held&&n.hovered&&n.hovered.components["media-video"]),e.toggleSet(ew.leftCursorHoveringOnVideo,!t.held&&!t.hovered&&!i.held&&i.hovered&&i.hovered.components["media-video"]),e.toggleSet(ew.rightCursorHoveringOnVideo,!n.held&&!n.hovered&&!a.held&&a.hovered&&a.hovered.components["media-video"]),e.toggleSet(ew.leftHandHoldingPen,t.held&&t.held.components.tags&&t.held.components.tags.data.isPen),e.toggleSet(ew.rightHandHoldingPen,n.held&&n.held.components.tags&&n.held.components.tags.data.isPen),e.toggleSet(ew.rightCursorHoldingPen,!n.held&&!n.hovered&&a.held&&a.held.components.tags&&a.held.components.tags.data.isPen),e.toggleSet(ew.leftCursorHoldingPen,!t.held&&!t.hovered&&i.held&&i.held.components.tags&&i.held.components.tags.data.isPen),e.toggleSet(ew.leftHandHoldingCamera,t.held&&t.held.components["camera-tool"]),e.toggleSet(ew.rightHandHoldingCamera,n.held&&n.held.components["camera-tool"]),e.toggleSet(ew.leftCursorHoldingCamera,!t.held&&!t.hovered&&i.held&&i.held.components["camera-tool"]),e.toggleSet(ew.rightCursorHoldingCamera,!n.held&&!n.hovered&&a.held&&a.held.components["camera-tool"]),e.toggleSet(ew.leftCursorHoveringOnUI,!t.held&&!t.hovered&&!i.held&&E_(i.hovered)),e.toggleSet(ew.rightCursorHoveringOnUI,!n.held&&!n.hovered&&!a.held&&E_(a.hovered)),e.toggleSet(ew.leftCursorHoldingNothing,!t.held&&!i.held),e.toggleSet(ew.rightCursorHoldingNothing,!n.held&&!a.held),e.toggleSet(ew.leftCursorHoldingUI,!t.held&&!t.hovered&&i.held&&i.held.components.tags&&i.held.components.tags.data.holdableButton),e.toggleSet(ew.rightCursorHoldingUI,!n.held&&!n.hovered&&a.held&&a.held.components.tags&&a.held.components.tags.data.holdableButton),e.toggleSet(ew.leftHandTeleporting,Yk.isTeleporting),e.toggleSet(ew.rightHandTeleporting,Kk.isTeleporting),e.toggleSet(ew.inputFocused,"INPUT"===document.activeElement.nodeName||"TEXTAREA"===document.activeElement.nodeName||"true"===document.activeElement.contentEditable),e.toggleSet(ew.debugUserInput,Gk),AFRAME.scenes[0]&&AFRAME.scenes[0].systems["hubs-systems"]&&e.toggleSet(ew.inspecting,AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.mode===Tt.b)}();for(let e=0,t=this.pendingSetChanges.length;e<t;e+=2){const t=this.pendingSetChanges[e];if(this.pendingSetChanges[e+1])this.activeSets.includes(t)||this.activeSets.push(t);else{const e=this.activeSets.indexOf(t);e>-1&&this.activeSets.splice(e,1)}}const t=function(e,t){if(e.length!==t.length)return!0;for(let n=0,a=e.length;n<a;n++){const a=e[n];let i=!1;for(let e=0,n=t.length;e<n;e++)if(a===t[e]){i=!0;break}if(!i)return!0}return!1}(this.prevActiveSets,this.activeSets);if(this.pendingSetChanges.length=0,e||t||!this.actives&&!this.masked){this.prevActives=this.actives,this.prevMasked=this.masked;const{actives:e,masked:t}=function(e,t,n){const a=new Array(e.length);for(let t=0;t<e.length;t++)a[t]=rO(e[t],n);const i=new Array(e.length);for(let n=0;n<e.length;n++){const r=i[n]=[],o=t[n];for(let t=0;t<e.length;t++)a[t]&&-1!==o.indexOf(t)&&r.push(t)}return{actives:a,masked:i}}(this.sortedBindings,this.masks,this.activeSets);this.actives=e,this.masked=t}for(let e=0;e<this.activeDevices.items.length;e++)this.activeDevices.items[e].write(this.frame,this.el.sceneEl,this.xrReferenceSpace);for(let n=0;n<this.sortedBindings.length;n++){if(!this.actives[n]||this.masked[n].length>0)continue;const a=this.sortedBindings[n];let i=!0;if(!e&&t&&this.prevSortedBindings){const e=this.prevSortedBindings.indexOf(a);i=e>-1&&this.prevActives[e]&&0===this.prevMasked[e].length}i||this.xformStates.delete(a);const{src:r,dest:o,xform:s,debug:l}=a;let c;l&&(c=this.frame.get(o.value));const d=s(this.frame,r,o,this.xformStates.get(a));l&&console.log("".concat(JSON.stringify(r.value)," (").concat(r.value&&JSON.stringify(this.frame.get(r.value)),") to ").concat(JSON.stringify(o),": ").concat(c," -> ").concat(this.frame.get(o.value))),void 0!==d&&this.xformStates.set(a,d)}this.prevSortedBindings=this.sortedBindings,this.maybeToggleXboxMapping()}});const oO=["/actions/","/device/","/var/"],sO=(e,t)=>"number"==typeof t?"".concat(t>=0?"+":"").concat(t.toFixed(3)):t;AFRAME.registerSystem("userinput-debug",{active:!0,tick(){if(!this.active)return;const e=AFRAME.scenes[0].systems.userinput;if(this.userinputFrameStatus){const t=[],{frame:n}=e;for(const e in n.values){if(!n.get(e))continue;if(!oO.some(t=>e.startsWith(t)))continue;let a=JSON.stringify(n.get(e),sO);a&&(a=a.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push("".concat(e," -> ").concat(a))}this.userinputFrameStatus.textContent=t.join("\n")}if(e.get(Xe.a.actions.debugUserInput.describeCurrentMasks)&&console.log(function(e){const t=[];return e.masked.forEach((n,a)=>{let i;e.actives[a]&&(n.length&&(i=JSON.stringify(e.sortedBindings[a],sO),t.push("-----------------------------------"),t.push("Binding #".concat(a,":")),i&&(i=i.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push("".concat(i,"\n"))),n.forEach(n=>{i=JSON.stringify(e.sortedBindings[n],sO),i&&(i=i.replace(/{"(\w{3,})":/g,'{\n  "$1":').replace(/,"(\w{3,})":/g,',\n  "$1":')),t.push("- Masked by #".concat(n,":\n").concat(i))}),n.length&&t.push("\n"))}),t.join("\n")}(e)),e.get(Xe.a.actions.logDebugFrame)){Object(mt.a)("userinput_debug")&&!this.userinputFrameStatus&&(this.userinputFrameStatus=document.createElement("div"),this.userinputFrameStatus.id="userinput-frame-status",this.userinputFrameStatus.style="\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        ",document.body.append(this.userinputFrameStatus)),console.log(e),console.log("sorted",JSON.parse(JSON.stringify(e.sortedBindings))),console.log("actives",JSON.parse(JSON.stringify(e.actives))),console.log("masks",JSON.parse(JSON.stringify(e.masks))),console.log("masked",JSON.parse(JSON.stringify(e.masked))),console.log("devices",e.activeDevices),console.log("activeSets",JSON.parse(JSON.stringify(e.activeSets))),console.log("frame",JSON.parse(JSON.stringify(e.frame))),console.log("xformStates",e.xformStates);const{sortedBindings:t,actives:n,masked:a}=e;for(const e in t){const i=[];if(a[e].length>0)for(const n of a[e])i.push(JSON.stringify(t[n]));this.logBindings&&console.log("binding: ",e,"\n",JSON.parse(JSON.stringify(t[e])),"\n","dest: ",JSON.parse(JSON.stringify(t[e].dest&&Object.values(t[e].dest))),"\n","active: ",JSON.parse(JSON.stringify(n[e])),"\n","maskedBy: ",JSON.parse(JSON.stringify(a[e])),"\n",i.join("\n"),"\n")}}}});const lO=[Xe.a.actions.mediaSearch1,Xe.a.actions.mediaSearch2,Xe.a.actions.mediaSearch3,Xe.a.actions.mediaSearch4,Xe.a.actions.mediaSearch5,Xe.a.actions.mediaSearch6,Xe.a.actions.mediaSearch7,Xe.a.actions.mediaSearch8];AFRAME.registerSystem("ui-hotkeys",{init(){this.mediaSearchStore=window.APP.mediaSearchStore},tick:function(){if(this.userinput||(this.userinput=this.el.systems.userinput),this.userinput.get(Xe.a.actions.focusChat)&&window.dispatchEvent(new CustomEvent("focus_chat",{detail:{prefix:""}})),this.userinput.get(Xe.a.actions.focusChatCommand)&&window.dispatchEvent(new CustomEvent("focus_chat",{detail:{prefix:"/"}})),this.userinput.get(Xe.a.actions.mediaExit)){const e=window.APP.history.location.state&&window.APP.history.location.state.value,t=new Set(["avatar-editor","link","profile","device","audio"]);(!e||!t.has(e))&&this.mediaSearchStore.pushExitMediaBrowserHistory(),this.el.emit("action_exit_watch")}for(let e=0;e<lO.length;e++)this.userinput.get(lO[e])&&window.APP.hubChannel.can("spawn_and_move_media")&&this.mediaSearchStore.sourceNavigate($r.a[e]);this.userinput.get(Xe.a.actions.toggleCamera)&&this.el.emit("action_toggle_camera"),this.userinput.get(Xe.a.actions.toggleUI)&&this.el.emit("action_toggle_ui")}});let cO=null,dO=!1;const uO=AFRAME.utils.device.isMobile(),hO=AFRAME.utils.device.isMobileVR(),pO=()=>hO?"standalone":uO?"mobile":"desktop",mO={desktop:["look","locomotion","turning","invite"],mobile:["look","locomotion","invite"],standalone:[]}[pO()];function fO(e){const t=JSON.parse(localStorage.getItem("__hubs_finished_tips"));t[e]={finished:!0},localStorage.setItem("__hubs_finished_tips",JSON.stringify(t)),cO=null}const gO={look:function(e){return e.get(uO?Xe.a.device.touchscreen.touchCameraDelta:Xe.a.device.smartMouse.cameraDelta)?2:1},locomotion:function(e){const t=e.get(Xe.a.actions.characterAcceleration);return!t||0===t[0]&&0===t[1]?1:2},turning:function(e){return e.get(Xe.a.actions.snapRotateLeft)||e.get(Xe.a.actions.snapRotateRight)?2:1},invite:function(e,t,n){return n&&"invite"===n.entry_mode?0:t.is("copresent")?2:1}};AFRAME.registerSystem("tips",{init:function(){this.activeTip=null,this._performStep=this._performStep.bind(this),null===localStorage.getItem("__hubs_finished_tips")&&localStorage.setItem("__hubs_finished_tips",JSON.stringify({}))},resetTips:function(){localStorage.setItem("__hubs_finished_tips",JSON.stringify({})),cO=null,window.APP.store.resetTipActivityFlags(),window.APP.store.resetConfirmedBroadcastedRooms(),this.activeTip=null,dO=!1},skipTips:function(){for(let e=0;e<mO.length;e++){fO(mO[e])}},tick:function(){if(hO)return;if(!this._userinput&&(this._userinput=this.el.systems.userinput,!this._userinput))return;const e=mO,t=this.activeTip;this._performStep(e),t!==this.activeTip&&this.el.emit("tip-changed",this.activeTip)},_performStep:function(e){if(dO)return;let t=null,n=0;for(let a=0;a<e.length;a++){const i=e[a];if(null===cO&&(cO=JSON.parse(localStorage.getItem("__hubs_finished_tips"))),cO[i]&&cO[i].finished)n++;else{switch(gO[i](this._userinput,this.el,window.APP.hub)){case 2:fO(i);break;case 1:t="tips.".concat(pO(),".").concat(i)}if(t)break}}this.activeTip=t,n===e.length&&(dO=!0)}});const vO=function(){};AFRAME.registerComponent("overwrite-raycast-as-noop",{init(){this.el.object3D.raycast=vO,this.mesh=this.el.getObject3D("mesh"),this.mesh?this.mesh.raycast=vO:this.el.addEventListener("model-loaded",()=>{this.mesh=this.el.getObject3D("mesh"),this.mesh&&(this.mesh.raycast=vO)})}});class bO{constructor(){this.targets=[],this.dirty=!0,this.onMutation=this.onMutation.bind(this),this.onObject3DSet=this.onObject3DSet.bind(this),this.onObject3DRemove=this.onObject3DRemove.bind(this),this.observer=new MutationObserver(this.onMutation),Object(Ue.b)().then(()=>{const e=document.querySelector("a-scene");this.rightRemote=document.getElementById("right-cursor-controller"),this.leftRemote=document.getElementById("left-cursor-controller"),this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),e.addEventListener("object3dset",this.onObject3DSet),e.addEventListener("object3dremove",this.onObject3DRemove)})}tick(e){this.dirty&&(this.populateEntities(this.targets),this.dirty=!1),this.rightRemote&&this.rightRemote.components["cursor-controller"].tick2(e),this.leftRemote&&this.leftRemote.components["cursor-controller"].tick2(e,!0)}onObject3DSet(){this.dirty=!0}onObject3DRemove(){this.dirty=!0}onMutation(e){e.some(e=>"childList"===e.type||"attributes"===e.type&&"class"===e.attributeName)&&(this.dirty=!0)}populateEntities(e){e.length=0;const t=AFRAME.scenes[0].querySelectorAll(".collidable, .interactable, .ui, .drawing, .occupiable-waypoint-icon, .teleport-waypoint-icon, .avatar-inspect-collider");for(let n=0;n<t.length;n++)t[n].object3D&&e.push(t[n].object3D)}remove(){this.observer.disconnect(),AFRAME.scenes[0].removeEventListener("object3dset",this.onObject3DSet),AFRAME.scenes[0].removeEventListener("object3dremove",this.onObject3DRemove)}}var yO=n(314),EO=n(390);function wO(e,t,n,a,i){const r=e.is("vr-mode")&&Object(gi.a)(n.held,"isPen")&&n.held.children[0].components.pen.intersection;return e.is("entered")&&!t.hovered&&!t.held&&!a&&!r&&i}class _O{constructor(){this.wakeLeft=!1,this.wakeRight=!1,Object(Ue.b)().then(()=>{this.domContentLoadedButComponentsMayNotHave=!0})}tick(e,t,n){if(!this.domContentLoadedButComponentsMayNotHave)return;this.gotComponentReferences||(this.gotComponentReferences=!0,this.rightCursorController=document.getElementById("right-cursor-controller").components["cursor-controller"],this.leftCursorController=document.getElementById("left-cursor-controller").components["cursor-controller"],this.rightHandTeleporter=document.getElementById("player-right-controller").components.teleporter,this.leftHandTeleporter=document.getElementById("player-left-controller").components.teleporter,this.gazeTeleporter=document.getElementById("gaze-teleport").components.teleporter);const a=e.state.rightRemote,i=e.state.leftRemote,r=e.state.leftHand,o=e.state.rightHand;t.get(Xe.a.actions.cursor.right.wake)&&(this.wakeRight=!0,i.held||(this.wakeLeft=!1)),t.get(Xe.a.actions.cursor.left.wake)&&(this.wakeLeft=!0,a.held||(this.wakeRight=!1));const s=e.el.systems["hubs-systems"].cameraSystem.mode===Tt.b,l=!s&&wO(n,r,i,this.leftHandTeleporter.isTeleporting||this.gazeTeleporter.isTeleporting,this.wakeLeft),c=AFRAME.utils.device.isMobile()||Object(RE.a)()||!s&&wO(n,o,a,this.rightHandTeleporter.isTeleporting||this.gazeTeleporter.isTeleporting,this.wakeRight);l||(i.hovered=null),c||(a.hovered=null),this.leftCursorController.enabled=l,this.rightCursorController.enabled=c}}var SO=n(233),xO=n(370),AO=n(814);function MO(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const kO=SO.b.MESSAGE_TYPES,OO=SO.b.TYPE,CO=SO.b.BUFFER_CONFIG,PO={debugDrawMode:xO.a.DrawWireframe,gravity:{x:0,y:-9.8,z:0}};class RO{constructor(e){var t=this;this.tick=(()=>{const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Matrix4,a=new THREE.Vector3;return function(){if(this.ready){if(this.debugRequested!==this.debugEnabled&&(this.debugRequested?this.enableDebug():this.disableDebug()),0!==this.objectMatricesFloatArray.buffer.byteLength){for(let i=0;i<this.bodyUuids.length;i++){const r=this.bodyUuids[i],o=this.bodyUuidToData.get(r),s=o.index,l=o.options.type?o.options.type:OO.DYNAMIC,c=o.object3D;l===OO.DYNAMIC&&(n.fromArray(this.objectMatricesFloatArray,s*CO.BODY_DATA_SIZE+CO.MATRIX_OFFSET),c.parent.updateMatrices(),t.copy(c.parent.matrixWorld).invert(),e.multiplyMatrices(t,n),e.decompose(c.position,c.quaternion,a),c.matrixNeedsUpdate=!0),c.updateMatrices(),this.objectMatricesFloatArray.set(c.matrixWorld.elements,s*CO.BODY_DATA_SIZE+CO.MATRIX_OFFSET),o.linearVelocity=this.objectMatricesFloatArray[s*CO.BODY_DATA_SIZE+CO.LINEAR_VELOCITY_OFFSET],o.angularVelocity=this.objectMatricesFloatArray[s*CO.BODY_DATA_SIZE+CO.ANGULAR_VELOCITY_OFFSET],o.collisions.length=0;for(let e=CO.COLLISIONS_OFFSET;e<CO.BODY_DATA_SIZE;e++){const t=this.objectMatricesIntArray[s*CO.BODY_DATA_SIZE+e];-1!==t&&o.collisions.push(this.indexToUuid[t])}}this.ammoWorker.postMessage({type:kO.TRANSFER_DATA,objectMatricesFloatArray:this.objectMatricesFloatArray},[this.objectMatricesFloatArray.buffer])}if(this.debugEnabled){const e=window.Atomics.load(this.debugIndex,0);0!==e&&(this.debugGeometry.attributes.position.needsUpdate=!0,this.debugGeometry.attributes.color.needsUpdate=!0),this.debugGeometry.setDrawRange(0,e),window.Atomics.store(this.debugIndex,0,0)}}}})(),this.ammoWorker=new SO.a,this.workerHelpers=new SO.c(this.ammoWorker),this.bodyHelpers=[],this.shapeHelpers=[],this.bodyUuids=[],this.indexToUuid={},this.bodyUuidToData=new Map,this.debugRequested=!1,this.debugEnabled=!1,this.scene=e,this.stepDuration=0,this.ready=!1,this.nextBodyUuid=0,this.nextShapeUuid=0;const n=new ArrayBuffer(4*CO.BODY_DATA_SIZE*512);this.objectMatricesFloatArray=new Float32Array(n),this.objectMatricesIntArray=new Int32Array(n),this.ammoWorker.postMessage({type:kO.INIT,worldConfig:PO,arrayBuffer:n,maxBodies:512,wasmUrl:new URL(AO,a.a.BASE_ASSETS_PATH||window.location).href},[n]),this.ammoWorker.onmessage=function(){var e,n=(e=function*(e){if(e.data.type===kO.READY){t.ready=!0;for(const e of t.bodyHelpers)e.alive&&e.init2();for(const e of t.shapeHelpers)e.alive&&e.init2();t.shapeHelpers.length=0,t.bodyHelpers.length=0}else if(e.data.type===kO.BODY_READY){const n=e.data.uuid,a=e.data.index;t.bodyUuidToData.has(n)?(t.bodyUuids.push(n),t.bodyUuidToData.get(n).index=a,t.indexToUuid[a]=n):console.warn("Body initialized for uuid: ".concat(n," but body missing."))}else if(e.data.type===kO.SHAPES_READY){const n=e.data.bodyUuid,a=e.data.shapesUuid;t.bodyUuidToData.has(n)?t.bodyUuidToData.get(n).shapes.push(a):console.warn("Shape initialized but body with uuid: ".concat(n," missing."))}else e.data.type===kO.TRANSFER_DATA&&(t.objectMatricesFloatArray=e.data.objectMatricesFloatArray,t.objectMatricesIntArray=new Int32Array(t.objectMatricesFloatArray.buffer),t.stepDuration=e.data.stepDuration)},function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){MO(r,a,i,o,s,"next",e)}function s(e){MO(r,a,i,o,s,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}()}setDebug(e){this.debugRequested=e}enableDebug(){if(!window.SharedArrayBuffer)return console.warn("Physics debug rendering only available in browsers that support SharedArrayBuffers."),void(this.debugRequested=!1);if(this.debugEnabled=!0,!this.debugMesh){this.debugSharedArrayBuffer=new window.SharedArrayBuffer(4+2*xO.b*4),this.debugIndex=new Uint32Array(this.debugSharedArrayBuffer,0,4);const e=new Float32Array(this.debugSharedArrayBuffer,4,xO.b),t=new Float32Array(this.debugSharedArrayBuffer,4+xO.b,xO.b);this.debugGeometry=new THREE.BufferGeometry,this.debugGeometry.addAttribute("position",new THREE.BufferAttribute(e,3)),this.debugGeometry.addAttribute("color",new THREE.BufferAttribute(t,3));const n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!0});this.debugMesh=new THREE.LineSegments(this.debugGeometry,n),this.debugMesh.frustumCulled=!1,this.debugMesh.renderOrder=999}this.debugMesh.parent||(this.scene.add(this.debugMesh),this.workerHelpers.enableDebug(!0,this.debugSharedArrayBuffer))}disableDebug(){this.debugEnabled=!1,this.debugMesh&&(this.scene.remove(this.debugMesh),this.workerHelpers.enableDebug(!1))}addBody(e,t){return this.workerHelpers.addBody(this.nextBodyUuid,e,t),this.bodyUuidToData.set(this.nextBodyUuid,{object3D:e,options:t,collisions:[],linearVelocity:0,angularVelocity:0,index:-1,shapes:[]}),this.nextBodyUuid++}updateBody(e,t){this.bodyUuidToData.has(e)?(this.bodyUuidToData.get(e).options=t,this.workerHelpers.updateBody(e,t)):console.warn("updateBody called for uuid: ".concat(e," but body missing."))}removeBody(e){const t=this.bodyUuids.indexOf(e);this.bodyUuidToData.has(e)&&-1!==t?(delete this.indexToUuid[this.bodyUuidToData.get(e).index],this.bodyUuidToData.delete(e),this.bodyUuids.splice(t,1),this.workerHelpers.removeBody(e)):console.warn("removeBody called for uuid: ".concat(e," but body missing."))}addShapes(e,t,n){if(t){const e=new THREE.Vector3;t.updateMatrices(),e.setFromMatrixScale(t.matrixWorld)}return this.workerHelpers.addShapes(e,this.nextShapeUuid,t,n),this.bodyUuidToData.get(e).shapes.push(this.nextShapeUuid),this.nextShapeUuid++}removeShapes(e,t){if(this.bodyUuidToData.has(e)){this.workerHelpers.removeShapes(e,t);const n=this.bodyUuidToData.get(e).shapes.indexOf(t);-1!==n?this.bodyUuidToData.get(e).shapes.splice(n,1):console.warn("removeShapes called for shapesUuid: ".concat(t," on bodyUuid: ").concat(e," but shapes missing."))}}addConstraint(e,t,n,a){this.workerHelpers.addConstraint(e,t,n,a)}removeConstraint(e){this.workerHelpers.removeConstraint(e)}registerBodyHelper(e){this.ready?e.init2():this.bodyHelpers.push(e)}registerShapeHelper(e){this.ready?e.init2():this.shapeHelpers.push(e)}bodyInitialized(e){return this.bodyUuidToData.has(e)&&-1!==this.bodyUuidToData.get(e).index}getLinearVelocity(e){return this.bodyUuidToData.get(e).linearVelocity}getAngularVelocity(e){return this.bodyUuidToData.get(e).angularVelocity}getCollisions(e){return this.bodyUuidToData.get(e).collisions}resetDynamicBody(e){this.workerHelpers.resetDynamicBody(e)}activateBody(e){this.workerHelpers.activateBody(e)}}const TO=SO.b.ACTIVATION_STATE;class jO{constructor(e){this.prevLeftHand={held:null,spawning:!1},this.prevRightHand={held:null,spawning:!1},this.prevRightRemote={held:null,spawning:!1},this.prevLeftRemote={held:null,spawning:!1},this.physicsSystem=e,this.constraintPairs={}}tickInteractor(e,t,n,a){if(this.physicsSystem)if(a.held!==n.held){if(a.held&&a.held.components.tags&&a.held.components.tags.data[e]){const e=a.held.id;this.constraintPairs[e]&&-1!==this.constraintPairs[e].indexOf(t)&&(this.constraintPairs[e].splice(this.constraintPairs[e].indexOf(t),1),0===this.constraintPairs[e].length&&delete this.constraintPairs[e],this.physicsSystem.removeConstraint(t)),(!this.constraintPairs[e]||this.constraintPairs[e].length<1)&&a.held.setAttribute("body-helper",{activationState:TO.ACTIVE_TAG})}if(!n.spawning&&n.held&&n.held.components.tags.data[e])if(!n.held.components.networked||NAF.utils.isMine(n.held)||NAF.utils.takeOwnership(n.held)){n.held.setAttribute("body-helper",{type:"dynamic",activationState:TO.DISABLE_DEACTIVATION});const e=n.held.id,a=n.held.components["body-helper"].uuid,i=document.querySelector("#".concat(t)).components["body-helper"].uuid;-1!==a&&-1!==i&&(this.physicsSystem.addConstraint(t,a,i,{}),this.constraintPairs[e]||(this.constraintPairs[e]=[]),this.constraintPairs[e].push(t))}else console.log("Failed to obtain ownership while trying to create constraint on networked object.")}else if(!n.spawning&&a.spawning&&n.held&&n.held.components.tags&&n.held.components.tags.data[e]){n.held.setAttribute("body-helper",{type:"dynamic",activationState:TO.DISABLE_DEACTIVATION});const e=n.held.id,a=n.held.components["body-helper"].uuid,i=document.querySelector("#".concat(t)).components["body-helper"].uuid;-1!==a&&-1!==i&&(this.physicsSystem.addConstraint(t,a,i,{}),this.constraintPairs[e]||(this.constraintPairs[e]=[]),this.constraintPairs[e].push(t))}}tick(){const e=AFRAME.scenes[0].systems.interaction;e.ready&&(this.tickInteractor("offersHandConstraint",e.options.leftHand.entity.id,e.state.leftHand,this.prevLeftHand),this.tickInteractor("offersHandConstraint",e.options.rightHand.entity.id,e.state.rightHand,this.prevRightHand),this.tickInteractor("offersRemoteConstraint",e.options.rightRemote.entity.id,e.state.rightRemote,this.prevRightRemote),this.tickInteractor("offersRemoteConstraint",e.options.leftRemote.entity.id,e.state.leftRemote,this.prevLeftRemote),Object.assign(this.prevLeftHand,e.state.leftHand),Object.assign(this.prevRightHand,e.state.rightHand),Object.assign(this.prevRightRemote,e.state.rightRemote),Object.assign(this.prevLeftRemote,e.state.leftRemote))}release(e){this.prevLeftHand.held===e&&(this.prevLeftHand.held=null,this.prevLeftHand.spawning=!1),this.prevLeftHand.held===e&&(this.prevLeftHand.held=null,this.prevLeftHand.spawning=!1),this.prevRightRemote.held===e&&(this.prevRightRemote.held=null,this.prevRightRemote.spawning=!1),this.prevLeftRemote.held===e&&(this.prevLeftRemote.held=null,this.prevLeftRemote.spawning=!1)}}const DO={collisionFilterMask:n(209).COLLISION_LAYERS.HANDS},IO=(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){return n.getWorldPosition(e),a.getWorldPosition(t),e.distanceTo(t)}})();function LO(e,t,n){return e&&(e===t.held||e===n.held)}class HO{constructor(){this.initialScale=new THREE.Vector3}tick(){const e=AFRAME.scenes[0].systems.interaction;if(!e.ready)return;const{leftHand:t,rightHand:n,rightRemote:a,leftRemote:i}=e.state,r=LO(t.held,n,a)||LO(i.held,n,a),o=t.held||i.held;let s,l;r&&(s=t.held?e.options.leftHand.entity.object3D:e.options.leftRemote.entity.object3D,l=n.held?e.options.rightHand.entity.object3D:e.options.rightRemote.entity.object3D,s===this.previousLeftStretcher&&l===this.previousRightStretcher&&o===this.stretched||(this.initialStretchDistance=IO(s,l),this.stretched=o,this.initialScale.copy(this.stretched.object3D.scale),this.stretched.components["ammo-body"]&&this.stretched.setAttribute("ammo-body",DO)),this.stretched.object3D.scale.copy(this.initialScale).multiplyScalar(IO(s,l)/this.initialStretchDistance),this.stretched.object3D.matrixNeedsUpdate=!0),this.previousLeftStretcher=s,this.previousRightStretcher=l}}class NO{tick(){this.didInteractThisFrame=!1;const e=AFRAME.scenes[0].systems.interaction,t=AFRAME.scenes[0].systems.userinput;if(AFRAME.scenes[0].systems["hubs-systems"].cameraSystem.mode===Tt.b)return;const n=e.state.rightRemote.hovered;n&&t.get(e.options.rightRemote.grabPath)&&n.components.tags&&n.components.tags.data.singleActionButton&&(this.didInteractThisFrame=!0,n.object3D.dispatchEvent({type:"interact",object3D:e.options.rightRemote.entity.object3D}));const a=e.state.leftRemote.hovered;a&&t.get(e.options.leftRemote.grabPath)&&a.components.tags&&a.components.tags.data.singleActionButton&&(this.didInteractThisFrame=!0,a.object3D.dispatchEvent({type:"interact",object3D:e.options.leftRemote.entity.object3D}))}}class FO{tick(){const e=AFRAME.scenes[0].systems.interaction,t=e.state.rightRemote.held;this.prevHeld&&this.prevHeld!==t&&this.prevHeld.object3D.dispatchEvent({type:"holdable-button-up",object3D:e.options.rightRemote.entity.object3D}),t&&this.prevHeld!==t&&t.object3D.dispatchEvent({type:"holdable-button-down",object3D:e.options.rightRemote.entity.object3D}),this.prevHeld=t;const n=e.state.leftRemote.held;this.prevHeldLeft&&this.prevHeldLeft!==n&&this.prevHeldLeft.object3D.dispatchEvent({type:"holdable-button-up",object3D:e.options.leftRemote.entity.object3D}),n&&this.prevHeldLeft!==n&&n.object3D.dispatchEvent({type:"holdable-button-down",object3D:e.options.leftRemote.entity.object3D}),this.prevHeldLeft=n}}const VO=function(){const e=["icon-button","text-button","pin-networked-object-button","mic-button","inspect-button"];return function(t){for(let n=0;n<e.length;n++)if(t[e[n]])return!0;return!1}}();function BO(e){if(!e)return null;if(VO(e.components)||e.classList.contains("teleport-waypoint-icon")||e.classList.contains("occupiable-waypoint-icon"))return e;if(e.children)for(let t=0;t<e.children.length;t++)if(VO(e.children[t].components)||e.children[t].classList.contains("teleport-waypoint-icon")||e.children[t].classList.contains("occupiable-waypoint-icon"))return e.children[t];return null}function UO(e,t){if(e.object3D.dispatchEvent(t),e.children)for(let n=0;n<e.children.length;n++)(VO(e.children[n].components)||e.children[n].classList.contains("teleport-waypoint-icon")||e.children[n].classList.contains("occupiable-waypoint-icon"))&&e.children[n].object3D.dispatchEvent(t)}const zO={type:"hovered"},WO={type:"unhovered"};class qO{tick(){const e=AFRAME.scenes[0].systems.interaction,t=BO(e.state.rightRemote.hovered),n=BO(e.state.leftRemote.hovered);this.prevButton&&this.prevButton!==t&&UO(this.prevButton,WO),t&&this.prevButton!==t&&UO(t,zO),this.prevButton=t,this.prevButtonLeft&&this.prevButtonLeft!==n&&UO(this.prevButtonLeft,WO),n&&this.prevButtonLeft!==n&&UO(n,zO),this.prevButtonLeft=n}}class GO{constructor(e){this.scaleMenus=(()=>{const e=new THREE.Vector3;return function(){if(this.drawingMenus&&0!==this.drawingMenus.length){this.camera.object3D.getWorldPosition(e);for(let t=0;t<this.drawingMenus.length;t++){const n=this.drawingMenus[t];if(n.object3D.visible&&!n.getAttribute("animation__show")){const t=e.distanceTo(n.object3D.position);n.object3D.scale.setScalar(this.getMenuScale(t)),n.object3D.matrixNeedsUpdate=!0}}}}})(),this.handleButtons=(()=>{const e=["rightRemote","leftRemote"];return function(){const t=AFRAME.scenes[0].systems.interaction,n=AFRAME.scenes[0].systems.userinput;for(let a=0;a<e.length;a++){const i=e[a];if(t.state[i]){const e=t.state[i].hovered;if(e&&n.get(t.options[i].grabPath)&&e.components.tags&&e.components.tags.data.singleActionButton&&this.buttonMap[e.object3D.uuid]){const t=this.buttonMap[e.object3D.uuid];e.classList.contains("undo-drawing")?(t.components["networked-drawing"].undoDraw(),this.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.l)):e.classList.contains("delete-drawing")?(NAF.utils.takeOwnership(t),this.sceneEl.removeChild(t)):e.classList.contains("serialize-drawing")&&t.components["networked-drawing"].serializeDrawing().then(()=>{const t=this.buttonMap[e.object3D.uuid];NAF.utils.takeOwnership(t),this.sceneEl.removeChild(t)})}}}}})(),this.showMenu=(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){const i=n.children[0];if(!(i.object3D.visible&&(r=.25,o=a,s=this.lastIntersection,Math.abs(o.x-s.x)<r&&Math.abs(o.y-s.y)<r&&Math.abs(o.z-s.z)<r))){this.camera.object3D.getWorldPosition(t),e.subVectors(t,a).normalize().multiplyScalar(.1),i.object3D.position.copy(a).add(e),i.object3D.lookAt(t),i.object3D.matrixNeedsUpdate=!0,i.object3D.visible=!0,this.lastIntersection.copy(a);const r=n.components.networked.isMine();i.querySelector(".undo-drawing").object3D.visible=r,i.querySelector(".serialize-drawing").object3D.visible=r&&window.APP.hubChannel.can("spawn_and_move_media");const o=t.distanceTo(i.object3D.position),s=this.getMenuScale(o);i.removeAttribute("animation__show"),i.setAttribute("animation__show",{property:"scale",dur:300,from:{x:.8*s,y:.8*s,z:.8*s},to:{x:s,y:s,z:s},easing:"easeOutElastic"}),i.addEventListener("animationcomplete",()=>{i.removeAttribute("animation__show")},{once:!0})}var r,o,s}})(),this.sceneEl=e,this.sceneEl.addEventListener("stateremoved",this.hideMenus.bind(this)),this.lastIntersection=new THREE.Vector3,this.drawingMenus=[],this.buttonMap={},Object(Ue.b)().then(()=>{this.cursorControllers=document.querySelectorAll("[cursor-controller]"),this.camera=this.sceneEl.querySelector("#avatar-pov-node")})}tick(){if(this.cursorControllers&&0!==this.cursorControllers.length&&this.camera&&this.sceneEl.is("frozen")&&window.APP.hubChannel.can("spawn_drawing")){const e=this.getHovered();if(e)for(let t=0;t<this.cursorControllers.length;t++)if(this.cursorControllers[t].components["cursor-controller"].intersection){const n=this.cursorControllers[t].components["cursor-controller"].intersection.point;this.showMenu(e,n)}this.handleButtons(),this.scaleMenus()}}getMenuScale(e){return e<=1.5?.5:Math.min(3,e-1)}getHovered(){const e=AFRAME.scenes[0].systems.interaction;let t=null;return e.state.leftRemote&&e.state.leftRemote.hovered&&e.state.leftRemote.hovered.classList.contains("drawing")?t=e.state.leftRemote.hovered:e.state.rightRemote&&e.state.rightRemote.hovered&&e.state.rightRemote.hovered.classList.contains("drawing")&&(t=e.state.rightRemote.hovered),t}hideMenus(){if(this.drawingMenus)for(let e=0;e<this.drawingMenus.length;e++)this.drawingMenus[e].object3D.visible=!1}registerDrawingMenu(e){const t=e.querySelector(".drawing-menu");this.drawingMenus.push(t);const n=t.querySelector(".undo-drawing");this.buttonMap[n.object3D.uuid]=e;const a=t.querySelector(".delete-drawing");this.buttonMap[a.object3D.uuid]=e;const i=t.querySelector(".serialize-drawing");this.buttonMap[i.object3D.uuid]=e}unregisterDrawingMenu(e){const t=e.querySelector(".drawing-menu"),n=this.drawingMenus.indexOf(t);-1!==n&&this.drawingMenus.splice(n,1);const a=t.querySelector(".undo-drawing");delete this.buttonMap[a.object3D.uuid];const i=t.querySelector(".delete-drawing");delete this.buttonMap[i.object3D.uuid];const r=t.querySelector(".serialize-drawing");delete this.buttonMap[r.object3D.uuid]}}function YO(e){return e&&e.components&&(e.components["hover-menu"]||e.components["hover-menu__video"]||e.components["hover-menu__pager"]||e.components["hover-menu__hubs-item"]||e.components["hover-menu__link"]||e.components["hover-menu__photo"])}function KO(e){if(!e)return null;const t=YO(e);if(t)return t;if(!e.components.tags||!e.components.tags.data.isHoverMenuChild)return null;let n=e.parentNode;for(;n&&!YO(n);)n=n.parentNode;return YO(n)}class XO{tick(){const e=AFRAME.scenes[0].systems.interaction,t=KO(e.state.rightRemote.hovered);this.prevHoverMenu&&this.prevHoverMenu!==t&&(this.prevHoverMenu.hovering=!1,this.prevHoverMenu.applyHoverState()),t&&this.prevHoverMenu!==t&&(t.hovering=!0,t.applyHoverState()),this.prevHoverMenu=t;const n=KO(e.state.leftRemote.hovered);this.prevHoverMenu2&&this.prevHoverMenu2!==n&&(this.prevHoverMenu2.hovering=!1,this.prevHoverMenu2.applyHoverState()),n&&this.prevHoverMenu2!==n&&(n.hovering=!0,n.applyHoverState()),this.prevHoverMenu2=n}}class QO{maybeSpawn(e,t){const n=AFRAME.scenes[0].systems.userinput,a=e.hovered&&e.hovered.components["super-spawner"],i=window.APP.hubChannel&&(a&&"#interactable-emoji"===a.data.template?window.APP.hubChannel.can("spawn_emoji"):window.APP.hubChannel.can("spawn_and_move_media"));a&&a.spawnedMediaScale&&!a.cooldownTimeout&&n.get(t)&&i&&this.performSpawn(e,t,n,a)}performSpawn(e,t,n,a){const i=a.data,r=Object(te.c)(i.src,i.template,ta.a.SPAWNER,null,i.resolve,!0,!1,i.mediaOptions).entity;r.components.networked&&!r.components.networked.data&&(r.components.networked.data={}),a.el.object3D.getWorldPosition(r.object3D.position),a.el.object3D.getWorldQuaternion(r.object3D.quaternion),r.object3D.matrixNeedsUpdate=!0,a.el.emit("spawned-entity-created",{target:r}),e.held=r,a.activateCooldown(),e.spawning=!0,r.addEventListener("media-loaded",()=>{r.object3D.scale.copy(a.spawnedMediaScale),r.object3D.matrixNeedsUpdate=!0,e.spawning=!1,a.el.emit("spawned-entity-loaded",{target:r})},{once:!0})}tick(){const e=AFRAME.scenes[0].systems.interaction;e.ready&&(this.maybeSpawn(e.state.leftHand,e.options.leftHand.grabPath),this.maybeSpawn(e.state.rightHand,e.options.rightHand.grabPath),this.maybeSpawn(e.state.rightRemote,e.options.rightRemote.grabPath),this.maybeSpawn(e.state.leftRemote,e.options.leftRemote.grabPath))}}function JO(e,t,n){e.held=t.held,e.hovered=t.hovered,e.isTeleporting=n}const ZO=.1,$O=.2,eC=.2,tC=.08,nC=.05,aC=.2,iC=.08,rC=.2;function oC(e,t,n){return e.held&&!t.held?ZO:!e.held&&t.held?$O:!e.hovered&&t.hovered?tC:n?iC:e.isTeleporting&&!n?rC:0}class sC{constructor(){this.state={rightHand:{held:null,hovered:null,isTeleporting:!1},rightRemote:{held:null,hovered:null,isTeleporting:!1},leftHand:{held:null,hovered:null,isTeleporting:!1},leftRemote:{held:null,hovered:null,isTeleporting:!1}}}tick(e,t,n){const a=AFRAME.scenes[0].systems.userinput,i=a.get(Xe.a.haptics.actuators.left),r=a.get(Xe.a.haptics.actuators.right);if(!i&&!r)return;const o=AFRAME.scenes[0].systems.interaction,{leftHand:s,rightHand:l,rightRemote:c,leftRemote:d}=o.state;this.leftTeleporter=this.leftTeleporter||document.querySelector("#player-left-controller").components.teleporter,this.rightTeleporter=this.rightTeleporter||document.querySelector("#player-right-controller").components.teleporter;const u=oC(this.state.leftHand,s,this.leftTeleporter.isTeleporting),h=oC(this.state.rightHand,l,this.rightTeleporter.isTeleporting),p=oC(this.state.rightRemote,c,!1),m=oC(this.state.leftRemote,d,!1),f=t?eC:0,g=n?eC:0,v=(b=e).stretcherLeft&&b.stretcherRight?THREE.Math.clamp(nC+aC*Math.abs(IO(b.stretcherLeft,b.stretcherRight)-b.initialStretchDistance),0,.5):0;var b;const y=Math.max(u,m,v,f),E=Math.max(h,p,v,g);y&&i&&i.pulse(y,15),E&&r&&r.pulse(E,15),JO(this.state.rightHand,l,this.rightTeleporter.isTeleporting),JO(this.state.leftHand,s,this.leftTeleporter.isTeleporting),JO(this.state.rightRemote,c,!1),JO(this.state.leftRemote,d,!1)}}class lC{constructor(){}get batchingEnabled(){return!1}set batchingEnabled(e){}addObject(){return 0}removeObject(){}tick(){}}var cC=n(423);class dC{constructor(){}tick(e,t,n){const a=e.state,i=e.previousState;(a.leftHand.held!==i.leftHand.held||a.rightHand.held!==i.rightHand.held||a.rightRemote.held!==i.rightRemote.held||E_(a.rightRemote.hovered)&&a.rightRemote.hovered!==i.rightRemote.hovered||a.leftRemote.held!==i.leftRemote.held||E_(a.leftRemote.hovered)&&a.leftRemote.hovered!==i.leftRemote.hovered)&&n.playSoundOneShot(Q.f),t.get(Xe.a.actions.logInteractionState)&&console.log("Interaction System State\nleftHand held",a.leftHand.held,"\nleftHand hovered",a.leftHand.hovered,"\nrightHand held",a.rightHand.held,"\nrightHand hovered",a.rightHand.hovered,"\nrightRemote held",a.rightRemote.held,"\nrightRemote hovered",a.rightRemote.hovered,"\nleftRemote held",a.leftRemote.held,"\nleftRemote hovered",a.leftRemote.hovered)}}var uC=n(618),hC=n(815),pC=n(816),mC=n.n(pC),fC=n(817),gC=n.n(fC),vC=n(818),bC=n.n(vC),yC=n(819),EC=n.n(yC),wC=n(820),_C=n.n(wC);function SC(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const xC=Object(Mn.a)(new _C.a);function AC(e){return function(){var t,n=(t=function*(t,n,a){const i=t.getImageData(0,0,n,a),o="action"===e?Object(r.b)("action-color"):Object(r.b)("notice-background-color"),s=yield xC(i.data.buffer,[i.data.buffer],{type:e,color:o});t.putImageData(new ImageData(s,n,a),0,0)},function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(e){SC(r,a,i,o,s,"next",e)}function s(e){SC(r,a,i,o,s,"throw",e)}o(void 0)}))});return function(e,t,a){return n.apply(this,arguments)}}()}const MC=["action","notice"],kC={action:mC.a,notice:gC.a},OC=new Array(64).fill(0),CC=e=>uC.frames[e.data.name]?"action":"notice",PC=e=>!!e.visible&&(!e.parent||PC(e.parent));AFRAME.registerComponent("sprite",{schema:{name:{type:"string"}},tick(){if(!this.didRegisterWithSystem&&!this.didFailToRegister&&this.el.sceneEl.systems["hubs-systems"]){const e=this.el.sceneEl.systems["hubs-systems"].spriteSystem.add(this);this.didRegisterWithSystem=e>0,this.didFailToRegister=e<0}},update(){this.didRegisterWithSystem&&this.el.sceneEl.systems["hubs-systems"].spriteSystem.updateUVs(this)},remove(){this.didRegisterWithSystem&&this.el.sceneEl.systems["hubs-systems"].spriteSystem.remove(this)}});const RC=function(){const e=new Map;return function(t,n){let a=e.get(t);if(a)return a;{if(!n.frames[t])return a={x:0,y:0,w:0,h:0},e.set(t,a),a;const i=n.meta.size,r=n.frames[t].frame;return a={x:r.x/i.w,y:r.y/i.h,w:r.w/i.w,h:r.h/i.h},e.set(t,a),a}}}(),TC=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r={distance:0,point:i,object:null};return function(o,s){this.updateMatrices(),e.set(-.5,.5,0).applyMatrix4(this.matrixWorld),t.set(.5,.5,0).applyMatrix4(this.matrixWorld),n.set(-.5,-.5,0).applyMatrix4(this.matrixWorld);let l=o.ray.intersectTriangle(e,n,t,!1,i);if(null===l&&(a.set(.5,-.5,0).applyMatrix4(this.matrixWorld),l=o.ray.intersectTriangle(t,n,a,!1,i),null===l))return;const c=o.ray.origin.distanceTo(i);c<o.near||c>o.far||(r.distance=c,r.point=i,r.object=this,s.push(r))}}(),jC=e=>e&&e.components?e.components["hoverable-visuals"]?e.components["hoverable-visuals"]:jC(e.parentEl):null,DC=e=>{const t=jC(e.el);if(!t)return!1;const n=t.el.components.pinnable&&t.el.components.pinnable.data.pinned,a=!!t.el.components["super-spawner"],i=t.el.sceneEl.is("frozen"),r=!a&&n&&!i;return t.data.enableSweepingEffect&&!r},IC=e=>{const t=new THREE.BufferGeometry,n=new Float32Array(3*e*4);for(let t=0;t<e;t++)n[3*t*4+0]=-.5,n[3*t*4+1]=.5,n[3*t*4+2]=0,n[3*t*4+3]=.5,n[3*t*4+4]=.5,n[3*t*4+5]=0,n[3*t*4+6]=-.5,n[3*t*4+7]=-.5,n[3*t*4+8]=0,n[3*t*4+9]=.5,n[3*t*4+10]=-.5,n[3*t*4+11]=0;t.setAttribute("position",new THREE.BufferAttribute(n,3,!1)),t.setAttribute("a_hubs_EnableSweepingEffect",new THREE.BufferAttribute(new Float32Array(4*e),1,!1)),t.setAttribute("a_hubs_SweepParams",new THREE.BufferAttribute(new Float32Array(4*e*2),2,!1)),t.setAttribute("a_uvs",new THREE.BufferAttribute(new Float32Array(2*e*4),2,!1)),t.setAttribute("a_mv",new THREE.BufferAttribute(new Float32Array(16*e*4),16,!1));const a=new Uint16Array(3*e*2);for(let t=0;t<e;t++)a[3*t*2+0]=4*t+0,a[3*t*2+1]=4*t+2,a[3*t*2+2]=4*t+1,a[3*t*2+3]=4*t+1,a[3*t*2+4]=4*t+2,a[3*t*2+5]=4*t+3;return t.setIndex(new THREE.BufferAttribute(a,1)),t.drawRange.count=0,t},LC=e=>new THREE.RawShaderMaterial({uniforms:{u_spritesheet:{value:e},hubs_Time:{value:0}},vertexShader:bC.a,fragmentShader:EC.a,side:THREE.DoubleSide,transparent:!0});class HC{raycast(e,t){for(const n of MC){const a=this.sprites[n];for(const n of a){const a=n.el.object3D;PC(a)&&TC.call(a,e,t)}}return t}constructor(e){this.sprites={action:[],notice:[]},this.indicesFromSprites={action:new WeakMap,notice:new WeakMap},this.meshes={action:null,notice:null},Object(Ue.b)().then(()=>{for(const t in kC){const n=kC[t];Object(te.h)(n,AC(t)).then(n=>{const a=IC(1024),i=LC(n),r=this.meshes[t]=new THREE.Mesh(a,i),o=document.createElement("a-entity");o.classList.add("ui"),e.appendChild(o),o.setObject3D("mesh",r),r.frustumCulled=!1,r.renderOrder=window.APP.RENDER_ORDER.HUD_ICONS,r.raycast=this.raycast.bind(this)})}}),APP.store.addEventListener("themechanged",()=>{for(const e in kC){const t=kC[e];this.meshes[e]&&Object(te.h)(t,AC(e)).then(t=>{const n=this.meshes[e].material.uniforms.u_spritesheet.value;this.meshes[e].material.uniforms.u_spritesheet.value=t,this.meshes[e].material.uniformsNeedUpdate=!0,Object(Bt.b)(n)})}})}tick(e){for(let t=0,n=MC.length;t<n;t++){const n=MC[t],a=this.meshes[n];if(!a)continue;a.material.uniforms.hubs_Time.value=e,a.material.uniformsNeedUpdate=!0;const i=a.geometry,r=i.getAttribute("a_mv"),o=i.getAttribute("a_hubs_EnableSweepingEffect"),s=i.getAttribute("a_hubs_SweepParams"),l=this.sprites[n];let c=!1,d=!1;for(let e=0,t=l.length;e<t;e++){const t=l[e];if(PC(t.el.object3D)){const n=DC(t)?1:0;if(o.array[4*e+0]=n,o.array[4*e+1]=n,o.array[4*e+2]=n,o.array[4*e+3]=n,c=!0,n){const n=jC(t.el),a=n.sweepParams[0],i=n.sweepParams[1];s.setXY(4*e+0,a,i),s.setXY(4*e+1,a,i),s.setXY(4*e+2,a,i),s.setXY(4*e+3,a,i),d=!0}t.el.object3D.updateMatrices();const a=t.el.object3D.matrixWorld;r.array.set(a.elements,4*e*16),r.array.set(a.elements,16*(4*e+1)),r.array.set(a.elements,16*(4*e+2)),r.array.set(a.elements,16*(4*e+3))}else r.array.set(OC,4*e*16)}r.needsUpdate=!0,r.updateRange.count=4*l.length*16,c&&(o.needsUpdate=!0,o.updateRange.count=4*l.length),d&&(s.needsUpdate=!0,s.updateRange.count=4*l.length*2)}}updateUVs(e){const t=CC(e),n=this.meshes[t];if(!n)return;const a=this.indicesFromSprites[t];if(!a.has(e))return;const i=a.get(e),r=n.material.uniforms.u_spritesheet.value.flipY,o=RC(e.data.name,"action"===t?uC:hC),s=n.geometry.getAttribute("a_uvs");s.setXY(4*i+0,o.x,r?1-o.y:o.y),s.setXY(4*i+1,o.x+o.w,r?1-o.y:o.y),s.setXY(4*i+2,o.x,r?1-o.y-o.h:o.y+o.h),s.setXY(4*i+3,o.x+o.w,r?1-o.y-o.h:o.y+o.h),s.needsUpdate=!0,s.updateRange.count=4*this.sprites[t].length*2}add(e){const t=CC(e),n=this.meshes[t];if(!n)return 0;const a=this.sprites[t],i=this.indicesFromSprites[t];if(i.has(e))return console.error("This sprite is already added"),-1;if(a.length>=1024)return console.error("Too many sprites"),-1;const r=a.push(e)-1;i.set(e,r),this.updateUVs(e);return n.geometry.drawRange.count=3*a.length*2,1}remove(e){const t=CC(e),n=this.meshes[t];if(!n)return;const a=this.sprites[t],i=this.indicesFromSprites[t];if(!i.has(e))return void console.error("This sprite is not found");const r=i.get(e);i.delete(e);const o=a.pop();e!==o&&(a[r]=o,i.set(o,r),this.updateUVs(o));n.geometry.drawRange.count=3*a.length*2}}const NC=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Matrix4,o=new THREE.Vector3;let s=1;return function(l,c,d){l.updateMatrices(),c.updateMatrices(),Object(lt.a)(r.copy(l.matrixWorld),r).extractBasis(i,e,t),o.setFromMatrixPosition(l.matrixWorld).add(i.addVectors(e.multiplyScalar(1.6),t.multiplyScalar(.15))),a.subVectors(o,i.setFromMatrixPosition(c.matrixWorld));const u=a.length();return u<(u<.2*i.setFromMatrixColumn(c.matrixWorld,0).length())?(s=1e-5,a.set(0,0,-1)):s=.1+.05*u,n.copy(a).projectOnPlane(e.set(0,1,0)).normalize(),d.makeBasis(i.crossVectors(n,e).multiplyScalar(s),e.multiplyScalar(s),n.multiplyScalar(-1*s)).setPosition(o)}}();function FC(e){return e.canBeOccupied&&e.canBeSpawnPoint}function VC(e){return!e.canBeOccupied&&e.canBeSpawnPoint}function BC(e,t){return new Promise(n=>{const a=document.importNode(document.getElementById(t).content.children[0]);e.appendChild(a,!0),setTimeout(()=>{n(a)},0)})}function UC(e,t){return function(e){const t=[];return e.canBeClicked&&e.canBeOccupied?t.push("occupiable-waypoint-icon"):e.canBeClicked&&!e.canBeOccupied?t.push("teleport-waypoint-icon"):VC(e)||FC(e),t}(t).map(t=>BC(e,t))}function zC(e){return e.data.canBeOccupied&&e.data.isOccupied&&e.el.components.networked&&NAF.utils.isMine(e.el)}function WC(e){e.el.setAttribute("waypoint",{isOccupied:!1})}function qC(e){e.filter(zC).forEach(WC)}function GC(e){return e.object3D.uuid}class YC{constructor(e,t){this.helperMat4=new THREE.Matrix4,this.scene=e,this.loading=[],this.ready=[],this.previousWaypointHash=null,this.initialSpawnHappened=!1,this.waypointForTemplateEl={},this.elementsFromTemplatesFor={},this.eventHandlers=[],this.lostOwnershipOfWaypoint=this.lostOwnershipOfWaypoint.bind(this),Object(Ue.b)().then(()=>{BC(e,"waypoint-preview-avatar-template").then(e=>{this.waypointPreviewAvatar=e,this.waypointPreviewAvatar.object3D.visible=!1})}),this.characterController=t}releaseAnyOccupiedWaypoints(){qC(this.ready),this.currentWaypoint&&this.currentWaypoint.el.removeEventListener("ownership-lost",this.lostOwnershipOfWaypoint)}teleportToWaypoint(e,t){return function(){this.moveToWaypoint(t,!1)}.bind(this)}tryTeleportToOccupiableWaypoint(e,t){return function(){const e=this.ready.filter(zC);this.tryToOccupy(t).then(n=>{n&&(t.el.object3D.updateMatrices(),this.characterController.shouldLandWhenPossible=!0,this.characterController.enqueueWaypointTravelTo(t.el.object3D.matrixWorld,!1,t.data),qC(e.filter(e=>e!==t)))})}.bind(this)}setupEventHandlersFor(e){return function(t){const n=GC(t);if(this.eventHandlers[n]=this.eventHandlers[n]||{},e.data.canBeClicked&&(t.classList.contains("teleport-waypoint-icon")||t.classList.contains("occupiable-waypoint-icon"))){const a=()=>{e.el.object3D.updateMatrices(),this.waypointPreviewAvatar&&!this.waypointForTemplateEl[n].data.willMaintainInitialOrientation&&(this.waypointPreviewAvatar.object3D.visible=!0,e.el.object3D.updateMatrices(),Object(lt.n)(this.waypointPreviewAvatar.object3D,e.el.object3D.matrixWorld))},i=()=>{this.waypointPreviewAvatar&&(this.waypointPreviewAvatar.object3D.visible=!1)};t.object3D.addEventListener("hovered",a),t.object3D.addEventListener("unhovered",i),this.eventHandlers[n].hovered=a,this.eventHandlers[n].unhovered=i}if(Object(gi.a)(t,"singleActionButton")&&e.data.canBeClicked){let a=()=>{console.log("interacted with",t,"associated with waypoint",e)};t.classList.contains("teleport-waypoint-icon")?a=this.teleportToWaypoint(t,e):t.classList.contains("occupiable-waypoint-icon")&&(a=this.tryTeleportToOccupiableWaypoint(t,e)),t.object3D.addEventListener("interact",a),this.eventHandlers[n].interact=a}}.bind(this)}registerComponent(e){this.loading.push(e);const t=this.setupEventHandlersFor(e),n=GC(e.el);this.elementsFromTemplatesFor[n]=this.elementsFromTemplatesFor[n]||[],Promise.all(UC(this.scene,e.data)).then(a=>{const i=this.loading.indexOf(e);if(-1===i)return null;this.loading.splice(i,1),this.ready.push(e),this.elementsFromTemplatesFor[n].push(...a),a.forEach(t=>{this.waypointForTemplateEl[GC(t)]=e}),a.forEach(t)})}unregisterComponent(e){const t=this.loading.indexOf(e);-1!==t&&this.loading.splice(t,1);const n=this.ready.indexOf(e);if(-1!==n){this.ready.splice(n,1);const t=GC(e.el),a=this.elementsFromTemplatesFor[t];for(let e=0;e<a.length;e++){const t=a[e],n=GC(t);if(this.eventHandlers[n]){["interact","hovered","unhovered"].map(e=>{this.eventHandlers[n][e]&&(t.object3D.removeEventListener(e,this.eventHandlers[n][e]),delete this.eventHandlers[n][e])})}t.parentNode.removeChild(t)}this.elementsFromTemplatesFor[t].length=0}}getUnoccupiableSpawnPoint(){const e=this.ready.filter(e=>VC(e.data));return e.length&&e.splice(Math.floor(Math.random()*e.length),1)[0]}lostOwnershipOfWaypoint(e){this.currentWaypoint&&this.currentWaypoint.el===e.detail.el&&(this.mightNeedRespawn=!0,this.ownershipLostTime=performance.now())}tryToOccupy(e){return new Promise(t=>{var n;(function(e){return e.data.canBeOccupied&&(NAF.utils.isMine(e.el)||!(e.data.isOccupied&&NAF.utils.getNetworkOwner(e.el)&&NAF.connection.connectedClients[NAF.utils.getNetworkOwner(e.el)]))})(e)&&(n=e.el,NAF.utils.isMine(n)||NAF.utils.takeOwnership(n))?(!function(e){e.el.setAttribute("waypoint",{isOccupied:!0})}(e),this.currentWaypoint&&this.currentWaypoint.el.removeEventListener("ownership-lost",this.lostOwnershipOfWaypoint),this.currentWaypoint=e,e.el.addEventListener("ownership-lost",this.lostOwnershipOfWaypoint),t(!0)):t(!1)})}tryToOccupyAnyOf(e){if(!e.length)return Promise.resolve(null);const t=e.splice(Math.floor(Math.random()*e.length),1)[0];return this.tryToOccupy(t).then(n=>n?Promise.resolve(t):this.tryToOccupyAnyOf(e))}moveToSpawnPoint(){return this.currentMoveToSpawn?this.currentMoveToSpawn:(this.nextMoveToSpawn||(this.waitOneTick=!0,this.nextMoveToSpawn=new Promise(e=>{this.nextMoveToSpawnResolve=e})),this.previousWaypointHash=null,this.initialSpawnHappened=!1,this.nextMoveToSpawn)}moveToWaypoint(e,t){this.releaseAnyOccupiedWaypoints(),e.el.object3D.updateMatrices(),this.characterController.shouldLandWhenPossible=!0,this.characterController.enqueueWaypointTravelTo(e.el.object3D.matrixWorld,!window.APP.store.state.preferences.animateWaypointTransitions||t,e.data)}moveToUnoccupiableSpawnPoint(){const e=this.getUnoccupiableSpawnPoint();return e&&this.moveToWaypoint(e,!0),e}tick(){if(this.waitOneTick)return void(this.waitOneTick=!1);if(""!==window.location.hash&&this.previousWaypointHash!==window.location.hash&&this.initialSpawnHappened){const e=window.location.hash.replace("#",""),t=this.ready.find(t=>t.el.object3D.name===e);t&&(this.moveToWaypoint(t,null===this.previousWaypointHash),window.history.replaceState(null,null,window.location.href.split("#")[0])),this.previousWaypointHash=window.location.hash}if(!this.currentMoveToSpawn&&this.nextMoveToSpawn){let e;this.mightNeedRespawn=!1,this.currentMoveToSpawn=this.nextMoveToSpawn,this.currentMoveToSpawnResolve=this.nextMoveToSpawnResolve,this.nextMoveToSpawn=null,this.nextMoveToSpawnResolve=null;const t=this.ready.filter(zC);this.tryToOccupyAnyOf(this.ready.filter(e=>FC(e.data))).then(n=>{if(n){const a=n;qC(t.filter(e=>e!==a)),a.el.object3D.updateMatrices(),this.characterController.shouldLandWhenPossible=!0,this.characterController.enqueueWaypointTravelTo(a.el.object3D.matrixWorld,!0,a.data),e=a}else null===n&&(e=this.moveToUnoccupiableSpawnPoint());this.initialSpawnHappened=!0,this.currentMoveToSpawnResolve(e),this.currentMoveToSpawn=null,this.currentMoveToSpawnResolve=null})}else this.mightNeedRespawn&&performance.now()-this.ownershipLostTime<8e3&&(this.mightNeedRespawn=!1,this.moveToSpawnPoint());const e=(e,t)=>{(e.classList.contains("teleport-waypoint-icon")||e.classList.contains("occupiable-waypoint-icon"))&&(e.object3D.visible=this.scene.is("frozen"),e.object3D.visible&&(this.viewingCamera=this.viewingCamera||document.getElementById("viewing-camera").object3DMap.camera,Object(lt.n)(e.object3D,NC(t.el.object3D,this.viewingCamera,this.helperMat4))))};this.ready.forEach(function(t){this.elementsFromTemplatesFor[GC(t.el)].forEach(n=>e(n,t))}.bind(this))}}AFRAME.registerComponent("waypoint",{schema:{canBeSpawnPoint:{default:!1},canBeOccupied:{default:!1},canBeClicked:{default:!1},willDisableMotion:{default:!1},willDisableTeleporting:{default:!1},snapToNavMesh:{default:!1},willMaintainInitialOrientation:{default:!1},willMaintainWorldUp:{default:!0},isOccupied:{default:!1}},init(){this.system=this.el.sceneEl.systems["hubs-systems"].waypointSystem,this.didRegisterWithSystem=!1},play(){this.didRegisterWithSystem||(this.el.components.networked&&Object(v.a)(this.el.components.networked.data.networkId),this.system.registerComponent(this,this.el.sceneEl),this.didRegisterWithSystem=!0)},remove(){this.didRegisterWithSystem?this.system.unregisterComponent(this):console.warn("Waypoint removed without ever having registered with the system.")}});var KC=n(267);const XC=[];const QC=function(){let e,t;return function(n){return e=e||document.getElementById("avatar-pov-node"),t=t||document.getElementById("avatar-rig"),t.object3D.updateMatrices(),e.object3D.updateMatrices(),n?e.object3D.matrixWorld.elements[13]-t.object3D.matrixWorld.elements[13]:e.object3D.matrix.elements[13]}}(),JC="character",ZC=Object(mt.a)("waypointLerp"),$C=AFRAME.utils.device.isMobile(),eP=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Matrix4;return function(a,i,r,o){return n.makeTranslation(r.x,r.y,r.z),e.extractRotation(a),i||Object(lt.a)(e,e),t.copy(e).multiply(n),o.setFromMatrixPosition(t)}}();class tP{constructor(e){this.teleportTo=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3;return function(r){this.isMotionDisabled=!1,this.avatarRig.object3D.getWorldPosition(e),this.avatarPOV.object3D.getWorldPosition(t),a.copy(r),a.y+=this.avatarPOV.object3D.position.y,n.copy(a).sub(t),i.copy(e).add(n);const o=JC in this.scene.systems.nav.pathfinder.zones;this.findPositionOnNavMesh(i,i,this.avatarRig.object3D.position,o),this.avatarRig.object3D.matrixNeedsUpdate=!0}}(),this.travelByWaypoint=function(){const e=new THREE.Matrix4,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Matrix4,i=new THREE.Matrix4,r=new THREE.Vector3,o=new THREE.Vector3,s=new THREE.Matrix4;return function(l,c,d){this.avatarPOV.object3D.updateMatrices(),this.fly||c||(this.fly=!0,this.shouldLandWhenPossible=!0,this.shouldUnoccupyWaypointsOnceMoving=!0),e.copy(l),Object(lt.m)(e,Math.PI,s);const u=JC in this.scene.systems.nav.pathfinder.zones;!u&&c&&console.warn("Tried to travel to a waypoint that wants to snap to the nav mesh, but there is no nav mesh"),u&&c?(t.setFromMatrixPosition(e),this.findPositionOnNavMesh(t,t,n,!0),s.setPosition(n),a.makeTranslation(0,QC(),-.15)):a.makeTranslation(0,1.6,-.15),s.multiply(a),d&&(i.extractRotation(this.avatarPOV.object3D.matrixWorld),r.setFromMatrixScale(s),o.setFromMatrixPosition(s),s.copy(i).scale(r).setPosition(o)),Object(lt.b)(this.avatarPOV.object3D.matrixWorld,s,s),Object(lt.d)(this.avatarRig.object3D,this.avatarPOV.object3D,s)}}(),this.tick=function(){const e=new THREE.Matrix4,t=new THREE.Matrix4,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Matrix4,s=new THREE.Matrix4,l=new THREE.Matrix4,c=new THREE.Vector3,d=new THREE.Vector3;let u;return function(h,p){const m=this.scene.is("entered");u=u||document.getElementById("ui-root");if(!(!m&&u&&u.firstChild&&u.firstChild.classList.contains("isGhost"))&&!m)return;const f=this.scene.is("vr-mode");this.sfx=this.sfx||this.scene.systems["hubs-systems"].soundEffectsSystem,this.waypointSystem=this.waypointSystem||this.scene.systems["hubs-systems"].waypointSystem,!this.activeWaypoint&&this.waypoints.length&&(this.activeWaypoint=this.waypoints.splice(0,1)[0],this.isMotionDisabled=this.activeWaypoint.waypointComponentData.willDisableMotion&&(!$C||this.activeWaypoint.waypointComponentData.willDisableTeleporting),this.isTeleportingDisabled=this.activeWaypoint.waypointComponentData.willDisableTeleporting,this.avatarPOV.object3D.updateMatrices(),this.waypointTravelTime=f&&!ZC||this.activeWaypoint.isInstant?0:(new THREE.Vector3).setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld).distanceTo(c.setFromMatrixPosition(this.activeWaypoint.transform))/50*1e3,Object(lt.m)(this.avatarPOV.object3D.matrixWorld,Math.PI,o),o.multiply(l.makeTranslation(0,-1*QC(),-.15)),this.waypointTravelStartTime=h,!f&&this.waypointTravelTime>100&&this.sfx.playSoundOneShot(Q.y));const g=0===this.waypointTravelTime||h>=this.waypointTravelStartTime+this.waypointTravelTime;if(this.activeWaypoint&&!g){const e=THREE.Math.clamp((h-this.waypointTravelStartTime)/this.waypointTravelTime,0,1);Object(lt.l)(o,this.activeWaypoint.transform,Object(KC.a)(e),s),this.travelByWaypoint(s,!1,this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation)}var v;this.activeWaypoint&&(this.waypoints.length||g)&&(this.travelByWaypoint(this.activeWaypoint.transform,this.activeWaypoint.waypointComponentData.snapToNavMesh,this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation),v=this.activeWaypoint.transform,XC.push(v),this.activeWaypoint=null,(f||this.waypointTravelTime>0)&&this.sfx.playSoundOneShot(Q.x));const b=AFRAME.scenes[0].systems.userinput,y=this.fly;b.get(Xe.a.actions.toggleFly)&&(this.shouldLandWhenPossible=!1,this.avatarRig.messageDispatch.dispatch("/fly"));const E=y&&!this.fly;!this.fly&&this.shouldLandWhenPossible&&(this.shouldLandWhenPossible=!1),this.fly&&(this.navNode=null);const w=window.APP.store.state.preferences,_=b.get(Xe.a.actions.snapRotateLeft),S=b.get(Xe.a.actions.snapRotateRight);_&&(this.dXZ+=w.snapRotationDegrees*Math.PI/180),S&&(this.dXZ-=w.snapRotationDegrees*Math.PI/180),(_||S)&&this.scene.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.o);const x=b.get(Xe.a.actions.characterAcceleration);if(x){const e=-1*x[1];this.relativeMotion.set(this.relativeMotion.x+(w.disableMovement||w.disableStrafing?0:x[0]),this.relativeMotion.y,this.relativeMotion.z+(w.disableMovement?0:w.disableBackwardsMovement?Math.min(0,e):e))}const A=f?0:.85;this.nextRelativeMotion.copy(this.relativeMotion).multiplyScalar(A),this.relativeMotion.multiplyScalar(1-A),this.avatarPOV.object3D.updateMatrices(),Object(lt.m)(this.avatarPOV.object3D.matrixWorld,this.dXZ,e),t.copy(e);const M=JC in this.scene.systems.nav.pathfinder.zones;if(!this.isMotionDisabled){const o=d.setFromMatrixColumn(this.avatarPOV.object3D.matrixWorld,1).length(),s=this.relativeMotion.lengthSq()>1e-6;if(s){const a=w.movementSpeedModifier;eP(e,this.fly||!M,this.relativeMotion.multiplyScalar((b.get(Xe.a.actions.boost)?2:1)*a*3.2*Math.sqrt(o)*p/1e3),n),t.makeTranslation(n.x,n.y,n.z).multiply(e)}const l=E||this.shouldLandWhenPossible,c=M&&(l||s);let u=0;c&&(this.findPOVPositionAboveNavMesh(a.setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld),i.setFromMatrixPosition(t),r,l),u=i.distanceToSquared(r),this.fly&&this.shouldLandWhenPossible&&u<.5&&!this.activeWaypoint?(this.shouldLandWhenPossible=!1,this.fly=!1,t.setPosition(r)):this.fly||t.setPosition(r)),!this.activeWaypoint&&this.shouldUnoccupyWaypointsOnceMoving&&s&&(this.shouldUnoccupyWaypointsOnceMoving=!1,this.waypointSystem.releaseAnyOccupiedWaypoints(),this.fly&&this.shouldLandWhenPossible&&c&&u<3&&(t.setPosition(r),this.shouldLandWhenPossible=!1,this.fly=!1))}Object(lt.d)(this.avatarRig.object3D,this.avatarPOV.object3D,t),this.relativeMotion.copy(this.nextRelativeMotion),this.dXZ=0}}(),this.findPOVPositionAboveNavMesh=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a,i,r){const o=QC(!0);return e.copy(n),e.y-=o,t.copy(a),t.y-=o,this.findPositionOnNavMesh(e,t,i,r),i.y+=o,i}}(),this.scene=e,this.fly=!1,this.shouldLandWhenPossible=!1,this.waypoints=[],this.waypointTravelStartTime=0,this.waypointTravelTime=0,this.navGroup=null,this.navNode=null,this.relativeMotion=new THREE.Vector3(0,0,0),this.nextRelativeMotion=new THREE.Vector3(0,0,0),this.dXZ=0,this.scene.addEventListener("nav-mesh-loaded",()=>{this.navGroup=null,this.navNode=null}),Object(Ue.b)().then(()=>{this.avatarPOV=document.getElementById("avatar-pov-node"),this.avatarRig=document.getElementById("avatar-rig")})}enqueueWaypointTravelTo(e,t,n){this.waypoints.push({transform:(XC.shift()||new THREE.Matrix4).copy(e),isInstant:t,waypointComponentData:n})}enqueueRelativeMotion(e){this.relativeMotion.add(e)}enqueueInPlaceRotationAroundWorldUp(e){this.dXZ+=e}getClosestNode(e){const t=this.scene.systems.nav.pathfinder;return t.zones[JC].groups[this.navGroup]?t.getClosestNode(e,JC,this.navGroup,!0)||t.getClosestNode(e,JC,this.navGroup):null}findPositionOnNavMesh(e,t,n,a){const i=this.scene.systems.nav.pathfinder;if(JC in i.zones)return this.navGroup=a||null===this.navGroup?i.getGroup(JC,t,!0,!0):this.navGroup,this.navNode=a||null===this.navNode||void 0===this.navNode?this.getClosestNode(t):this.navNode,null===this.navNode||void 0===this.navNode?n.copy(t):this.navNode=i.clampStep(e,t,this.navNode,JC,this.navGroup,n),n}enableFly(e){return e&&window.APP.hubChannel&&window.APP.hubChannel.can("fly")?this.fly=!0:this.fly=!1,this.fly}}const nP=(new THREE.Matrix4).identity();class aP{constructor(){this.pairs=[]}register(e,t){e.applyMatrix4(nP),this.pairs.push({object3D:e,path:t})}unregister(e){this.pairs=this.pairs.filter(t=>t.object3D!==e)}tick(){for(let e=0;e<this.pairs.length;e++){const t=AFRAME.scenes[0].systems.userinput.get(this.pairs[e].path);if(t){const n=this.pairs[e].object3D;n.matrix.copy(t),n.matrix.decompose(n.position,n.quaternion,n.scale),n.matrixWorldNeedsUpdate=!0}}}}class iP{constructor(){this.tick=function(){const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3;return function(r){if(!this.viewingCameraEl)return;const o=this.viewingCameraEl.object3DMap.camera;o.updateMatrices(),i.setFromMatrixPosition(o.matrixWorld);for(let o=0;o<this.components.length;o++){const s=this.data.get(this.components[o]),l=s.menuEl.object3D.visible,c=l&&!s.wasMenuVisible,d=e.subVectors(i,a.setFromMatrixPosition(s.menuEl.object3D.matrixWorld)).length();if(s.menuEl.object3D.parent.updateMatrices(),n.setFromMatrixScale(s.menuEl.object3D.parent.matrixWorld),c){const e=s.chooseScale?THREE.Math.clamp(.45*d,.05,4):t.setFromMatrixScale(s.menuEl.object3D.matrixWorld).x;s.endingScale=e/n.x,s.menuOpenTime=r,s.startScaleAtMenuOpenTime=.8*s.endingScale}if(l){const e=THREE.Math.lerp(s.startScaleAtMenuOpenTime,s.endingScale,Object(KC.b)(THREE.Math.clamp((r-s.menuOpenTime)/750,0,1)));s.menuEl.object3D.scale.x!==e&&(s.menuEl.object3D.scale.setScalar(e),s.menuEl.object3D.matrixNeedsUpdate=!0)}s.wasMenuVisible=l}}}(),this.components=[],this.data=new Map,this.tick=this.tick.bind(this),Object(Ue.b)().then(()=>{this.viewingCameraEl=document.getElementById("viewing-camera")})}register(e,t,n){this.components.push(e),this.data.set(e,{menuEl:t,chooseScale:n,menuOpenTime:-1,startScaleAtMenuOpenTime:0,wasMenuVisible:!1,endingScale:0})}unregister(e){this.components.splice(this.components.indexOf(e),1),this.data.delete(e)}}class rP{constructor(e){this.onSceneReset=()=>{APP.sceneAudioDefaults.delete($t.g.AVATAR_AUDIO_SOURCE),APP.sceneAudioDefaults.delete($t.g.MEDIA_VIDEO);for(const[e,t]of APP.audios.entries())Object(Zt.d)(e,t)},e.addEventListener("reset_scene",this.onSceneReset),0!==window.APP.store.state.preferences.audioNormalization&&window.APP.store.update({preferences:{audioNormalization:0}})}}var oP=n(199);function sP(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function lP(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){sP(r,a,i,o,s,"next",e)}function s(e){sP(r,a,i,o,s,"throw",e)}o(void 0)}))}}let cP=null;function dP(e){cP&&clearTimeout(cP),cP=setTimeout(()=>{cP=null,console.warn("enableChromeAEC: recreate RTCPeerConnection loopback because the local connection was disconnected for 10s"),hP(e)},1e4)}function uP(e){return e instanceof d.THREE.Audio||e instanceof d.THREE.PositionalAudio}function hP(e){return pP.apply(this,arguments)}function pP(){return(pP=lP((function*(e){const t=new Audio;t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline");const n=d.THREE.AudioContext.getContext().createMediaStreamDestination(),a=new RTCPeerConnection,i=new RTCPeerConnection,r=e=>{console.error("enableChromeAEC: RTCPeerConnection loopback initialization error",e)};a.addEventListener("icecandidate",e=>{i.addIceCandidate(e.candidate).catch(r)}),a.addEventListener("iceconnectionstatechange",()=>{console.warn("enableChromeAEC: outboundPeerConnection state changed to "+a.iceConnectionState),"disconnected"===a.iceConnectionState&&dP(e),"connected"===a.iceConnectionState&&cP&&clearTimeout(cP)}),i.addEventListener("icecandidate",e=>{a.addIceCandidate(e.candidate).catch(r)}),i.addEventListener("iceconnectionstatechange",()=>{console.warn("enableChromeAEC: inboundPeerConnection state changed to "+i.iceConnectionState),"disconnected"===i.iceConnectionState&&dP(e),"connected"===i.iceConnectionState&&cP&&clearTimeout(cP)}),i.addEventListener("track",e=>{t.srcObject=e.streams[0]});try{n.stream.getTracks().forEach(e=>{a.addTrack(e,n.stream)});const t=yield a.createOffer();a.setLocalDescription(t),yield i.setRemoteDescription(t);const r=yield i.createAnswer(),o=oP.parse(r.sdp);for(let e=0;e<o.media.length;e++)for(let t=0;t<o.media[e].fmtp.length;t++)o.media[e].fmtp[t].config+=";stereo=1;cbr=0;maxaveragebitrate=510000;";r.sdp=oP.write(o),i.setLocalDescription(r),a.setRemoteDescription(r),e.disconnect(),e.connect(n)}catch(e){r(e)}}))).apply(this,arguments)}class mP{constructor(e){this._resumeAudioContext=()=>{this.audioContext.resume(),setTimeout(()=>{if("running"===this.audioContext.state){const e=window.APP.store.state.preferences.disableEchoCancellation;AFRAME.utils.device.isMobile()||!/chrome/i.test(navigator.userAgent)||e||hP(this._sceneEl.audioListener.gain),document.body.removeEventListener("touchend",this._resumeAudioContext,!1),document.body.removeEventListener("mouseup",this._resumeAudioContext,!1)}},0)},this._sceneEl=e,this.audioContext=d.THREE.AudioContext.getContext(),this.audioNodes=new Map,this.mediaStreamDestinationNode=this.audioContext.createMediaStreamDestination(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.outboundStream=this.mediaStreamDestinationNode.stream,this.outboundGainNode=this.audioContext.createGain(),this.outboundAnalyser=this.audioContext.createAnalyser(),this.outboundAnalyser.fftSize=32,this.analyserLevels=new Uint8Array(this.outboundAnalyser.fftSize),this.outboundGainNode.connect(this.outboundAnalyser),this.outboundAnalyser.connect(this.mediaStreamDestinationNode),this.audioContextNeedsToBeResumed=!1,this.mixer={[$t.g.AVATAR_AUDIO_SOURCE]:this.audioContext.createGain(),[$t.g.MEDIA_VIDEO]:this.audioContext.createGain(),[$t.g.SFX]:this.audioContext.createGain()},this.mixer[$t.g.AVATAR_AUDIO_SOURCE].connect(this._sceneEl.audioListener.getInput()),this.mixer[$t.g.MEDIA_VIDEO].connect(this._sceneEl.audioListener.getInput()),this.mixer[$t.g.SFX].connect(this._sceneEl.audioListener.getInput()),this.mixerAnalyser=this.audioContext.createAnalyser(),this.mixerAnalyser.fftSize=32,this.mixer[$t.g.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser),this.mixer[$t.g.MEDIA_VIDEO].connect(this.mixerAnalyser),this.mixer[$t.g.SFX].connect(this.mixerAnalyser),this._safariMobileAudioInterruptionFix(),document.body.addEventListener("touchend",this._resumeAudioContext,!1),document.body.addEventListener("mouseup",this._resumeAudioContext,!1),this.onPrefsUpdated=this.updatePrefs.bind(this),window.APP.store.addEventListener("statechanged",this.onPrefsUpdated)}addStreamToOutboundAudio(e,t){this.audioNodes.has(e)&&this.removeStreamFromOutboundAudio(e);const n=this.audioContext.createMediaStreamSource(t),a=this.audioContext.createGain();n.connect(a),a.connect(this.outboundGainNode),this.audioNodes.set(e,{sourceNode:n,gainNode:a})}removeStreamFromOutboundAudio(e){if(this.audioNodes.has(e)){const t=this.audioNodes.get(e);t.sourceNode.disconnect(),t.gainNode.disconnect(),this.audioNodes.delete(e)}}addAudio({sourceType:e,node:t}){let n=t;uP(t)&&(t.gain.disconnect(),n=t.gain),n.connect(this.mixer[e])}removeAudio({node:e}){let t=e;uP(e)&&(t=e.gain),t.disconnect()}updatePrefs(){const{globalVoiceVolume:e,globalMediaVolume:t,globalSFXVolume:n}=window.APP.store.state.preferences;let a=t/100;if(this.mixer[$t.g.MEDIA_VIDEO].gain.setTargetAtTime(a,this.audioContext.currentTime,$t.e),a=n/100,this.mixer[$t.g.SFX].gain.setTargetAtTime(a,this.audioContext.currentTime,$t.e),a=e/100,this.mixer[$t.g.AVATAR_AUDIO_SOURCE].gain.setTargetAtTime(a,this.audioContext.currentTime,$t.e),Js.isAudioOutputSelectEnabled&&APP.mediaDevicesManager){var i;const e=APP.mediaDevicesManager.selectedSpeakersDeviceId,t=e===APP.mediaDevicesManager.defaultOutputDeviceId;if(!this.outputMediaAudio&&t||e===(null===(i=this.outputMediaAudio)||void 0===i?void 0:i.sinkId))return;const n=t?this._sceneEl.audioListener.getInput():this.audioDestination;this.mixer[$t.g.AVATAR_AUDIO_SOURCE].disconnect(),this.mixer[$t.g.AVATAR_AUDIO_SOURCE].connect(n),this.mixer[$t.g.AVATAR_AUDIO_SOURCE].connect(this.mixerAnalyser),this.mixer[$t.g.MEDIA_VIDEO].disconnect(),this.mixer[$t.g.MEDIA_VIDEO].connect(n),this.mixer[$t.g.MEDIA_VIDEO].connect(this.mixerAnalyser),this.mixer[$t.g.SFX].disconnect(),this.mixer[$t.g.SFX].connect(n),this.mixer[$t.g.SFX].connect(this.mixerAnalyser),t?this.outputMediaAudio&&(this.outputMediaAudio.pause(),this.outputMediaAudio.srcObject=null,this.outputMediaAudio=null):(this.outputMediaAudio||(this.outputMediaAudio=new Audio,this.outputMediaAudio.srcObject=this.audioDestination.stream),this.outputMediaAudio.sinkId!==e&&this.outputMediaAudio.setSinkId(e).then(()=>{this.outputMediaAudio.play()}))}}_safariMobileAudioInterruptionFix(){this.audioContext.onstatechange=()=>{console.log("AudioContext state changed to ".concat(this.audioContext.state)),"suspended"===this.audioContext.state?(document.getElementById("avatar-rig").messageDispatch.log(Yc.audioSuspended),document.body.addEventListener("touchend",this._resumeAudioContext,!1),document.body.addEventListener("mouseup",this._resumeAudioContext,!1),this.audioContextNeedsToBeResumed=!0):"running"===this.audioContext.state&&this.audioContextNeedsToBeResumed&&(this.audioContextNeedsToBeResumed=!1,document.getElementById("avatar-rig").messageDispatch.log(Yc.audioResumed))}}}var fP=n(424);function gP(e,t){return Math.min(e.x/t.x,e.y/t.y,e.z/t.z)}const vP=Object(mt.a)("debug"),bP={[te.a.ALL]:function(e){return!(!e||!e.components["media-loader"])},[te.a.ALL_2D]:function(e){return!(!e||!(e.components["media-image"]||e.components["media-video"]||e.components["media-pdf"]))},[te.a.MODEL]:function(e){return!(!e||!e.components["gltf-model-plus"])},[te.a.IMAGE]:function(e){return!(!e||!e.components["media-image"])},[te.a.VIDEO]:function(e){return!(!e||!e.components["media-video"])},[te.a.PDF]:function(e){return!(!e||!e.components["media-pdf"])}},yP=[];class EP{constructor(e,t){this.physicsSystem=e,this.interactionSystem=t}tick(){for(let e=0;e<yP.length;e++){const t=yP[e],n=t.el.components["body-helper"].uuid;if(!this.physicsSystem.bodyInitialized(n))continue;const a=this.interactionSystem.isHoldingAnything(bP[t.data.mediaType]),i=t.el.getObject3D("guide");if(i.visible=a,"empty"===t.data.targetId){i.material.uniforms.color.value.set(7323901);const e=this.getCapturableEntityCollidingWithBody(t.data.mediaType,n);e&&NAF.utils.isMine(e)?this.interactionSystem.isHeld(e)?(i.material.uniforms.color.value.set(3113197),t.showPreview(e)):t.capture(e):t.hidePreview()}else{i.material.uniforms.color.value.set(8421504),t.hidePreview();const e=document.getElementById(t.data.targetId);e?NAF.utils.isMine(e)&&(this.interactionSystem.isHeld(e)?this.isColliding(t.el,e)?i.material.uniforms.color.value.set(3113197):t.release():t.data.snapToCenter&&this.interactionSystem.wasReleasedThisFrame(e)&&t.snapObject(e)):t.release()}}}getCapturableEntityCollidingWithBody(e,t){const n=this.physicsSystem.getCollisions(t);for(let t=0;t<n.length;t++){const a=this.physicsSystem.bodyUuidToData.get(n[t]),i=a&&a.object3D&&a.object3D.el;if(bP[e](i))return i}return null}isColliding(e,t){const n=e.components["body-helper"].uuid,a=t.components["body-helper"].uuid;return this.physicsSystem.bodyInitialized(n)&&this.physicsSystem.bodyInitialized(a)&&-1!==this.physicsSystem.getCollisions(n).indexOf(a)}}AFRAME.registerComponent("media-frame",{schema:{bounds:{default:new THREE.Vector3(1,1,1)},mediaType:{default:te.a.ALL_2D,oneOf:Object.values(te.a)},snapToCenter:{default:!0},debug:{default:!1},targetId:{default:"empty"},originalTargetScale:{default:new THREE.Vector3(1,1,1)}},init(){this.tmpWorldPosition=new THREE.Vector3,this.el.setObject3D("guide",new THREE.Mesh(new THREE.BoxGeometry(this.data.bounds.x,this.data.bounds.y,this.data.bounds.z),new THREE.ShaderMaterial({uniforms:{color:{value:new THREE.Color(3113197)}},vertexShader:"\n            varying vec2 vUv;\n            void main()\n            {\n              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n              vUv = uv;\n            }\n          ",fragmentShader:"\n            // adapted from https://www.shadertoy.com/view/Mlt3z8\n            float bayerDither2x2( vec2 v ) {\n              return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n            }\n            float bayerDither4x4( vec2 v ) {\n              vec2 P1 = mod( v, 2.0 );\n              vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n              return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n            }\n\n            varying vec2 vUv;\n            uniform vec3 color;\n            void main() {\n              float alpha = max(step(0.45, abs(vUv.x - 0.5)), step(0.45, abs(vUv.y - 0.5))) - 0.5;\n              if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n              gl_FragColor = vec4(color, 1.0);\n            }\n          ",side:THREE.DoubleSide})))},update(e){if(this.data.debug&&console.log("".concat(this.el.id,": ").concat(e.targetId,"(").concat(JSON.stringify(e.originalTargetScale),") -> ").concat(this.data.targetId,"(").concat(JSON.stringify(this.data.originalTargetScale),")")),"empty"!==e.targetId&&e.targetId!==this.data.targetId){const t=document.getElementById(e.targetId);t&&NAF.utils.isMine(t)&&(t.object3D.translateZ(this.data.bounds.z),t.object3D.scale.copy(e.originalTargetScale),t.object3D.matrixNeedsUpdate=!0,t.components["floaty-object"].setLocked(!1))}},play(){yP.push(this),this.el.components.networked&&Object(v.a)(this.el.components.networked.data.networkId)},pause(){yP.splice(yP.indexOf(this),1)},tick(e,t){this.mixer&&this.mixer.update(t/1e3)},showPreview(e){if(!this.preview){const t=e.getObject3D("mesh"),n=Object(lt.e)(t,!1);n.traverse(e=>{e.isMesh&&e.material&&(e.material=e.material.clone(),e.material.transparent=!0,e.material.opacity=.5,e.material.needsUpdate=!0)});const a=e.components["loop-animation"];if(a&&a.isPlaying){const e=a.currentActions[a.data.activeClipIndex],t=n.animations[a.data.activeClipIndex];this.mixer=new THREE.AnimationMixer(n);const i=this.mixer.clipAction(t);i.syncWith(e),i.setLoop(THREE.LoopRepeat,1/0).play()}n.position.set(0,0,0),n.quaternion.identity();let i=(new THREE.Box3).setFromObject(n);const r=new THREE.Vector3;i.getSize(r);let o=new THREE.Vector3;i.getCenter(o),n.position.copy(o),n.position.multiplyScalar(-1),n.matrixNeedsUpdate=!0,this.preview=new THREE.Object3D,this.el.sceneEl.object3D.add(this.preview),this.preview.add(n),this.el.object3D.updateWorldMatrix(!0);const s=new THREE.Vector3;this.el.object3D.getWorldPosition(s);const l=new THREE.Quaternion;if(this.el.object3D.getWorldQuaternion(l),this.preview.position.copy(s),this.preview.scale.multiplyScalar(gP(this.data.bounds,r)),this.preview.setRotationFromQuaternion(l),this.preview.matrixNeedsUpdate=!0,vP){const e=this.preview.quaternion.clone();this.preview.quaternion.identity(),this.preview.matrixNeedsUpdate=!0,this.preview.updateMatrixWorld(!0),i=(new THREE.Box3).setFromObject(this.preview),this.preview.quaternion.copy(e),this.preview.matrixNeedsUpdate=!0,this.preview.updateMatrixWorld(!0),this.helperBBAA=new THREE.Box3Helper(i,16776960),this.helperBBAA.setRotationFromQuaternion(this.preview.quaternion),this.el.sceneEl.object3D.add(this.helperBBAA),this.centerBBAA=new THREE.AxesHelper(.25),o=new THREE.Vector3,i.getCenter(o),this.centerBBAA.position.copy(o),this.centerBBAA.setRotationFromQuaternion(this.preview.quaternion),this.el.sceneEl.object3D.add(this.centerBBAA)}}},hidePreview(){this.preview&&(this.el.sceneEl.object3D.remove(this.preview),this.mixer&&(this.mixer.stopAllAction(),this.mixer.uncacheRoot(this.preview),this.mixer=null),Object(lt.h)(this.preview),this.preview=null,vP&&(this.el.sceneEl.object3D.remove(this.helperBBAA),this.el.sceneEl.object3D.remove(this.centerBBAA)))},snapObject(e){this.el.object3D.getWorldPosition(this.tmpWorldPosition),e.object3D.position.copy(this.tmpWorldPosition);const t=new THREE.Quaternion;this.el.object3D.getWorldQuaternion(t),e.object3D.setRotationFromQuaternion(t),e.object3D.matrixNeedsUpdate=!0,e.components["floaty-object"].setLocked(!0)},capture(e){if(NAF.utils.isMine(this.el)||NAF.utils.takeOwnership(this.el)){const t=()=>{this.el.setAttribute("media-frame",{targetId:e.id,originalTargetScale:(new THREE.Vector3).copy(e.object3D.scale)}),e.object3D.scale.set(1,1,1),e.object3D.quaternion.identity(),e.object3D.matrixNeedsUpdate=!0,e.object3D.updateMatrixWorld();const t=e.getObject3D("mesh"),n=new THREE.Vector3;(new THREE.Box3).setFromObject(t).getSize(n),e.object3D.scale.multiplyScalar(gP(this.data.bounds,n)),e.object3D.matrixNeedsUpdate=!0,this.snapObject(e)};e.components["media-loader"].isPlaying&&e.addEventListener("media-loaded",()=>{t()},{once:!0}),t(),this.hidePreview()}else console.error("failed to take ownership of media frame")},release(){if(NAF.utils.isMine(this.el)||NAF.utils.takeOwnership(this.el)){const e=document.getElementById(this.data.targetId);this.el.setAttribute("media-frame",{targetId:"empty"}),e&&(e.object3D.scale.copy(this.data.originalTargetScale),e.object3D.matrixNeedsUpdate=!0,e.components["floaty-object"].setLocked(!1))}else console.error("failed to take ownership of media frame")}});class wP{tick(e,t,n){if(e.is("entered")&&t.get(Xe.a.actions.startInspectingSelf)){const e=document.getElementById("avatar-rig");n.inspect(e,1.5)}}}const _P=[Xe.a.actions.spawnEmoji0,Xe.a.actions.spawnEmoji1,Xe.a.actions.spawnEmoji2,Xe.a.actions.spawnEmoji3,Xe.a.actions.spawnEmoji4,Xe.a.actions.spawnEmoji5,Xe.a.actions.spawnEmoji6];class SP{constructor(e){this.scene=e,this.scene.addEventListener("enter-vr",()=>{if(!document.getElementById("emoji-hud")){const t=document.createElement("a-entity");t.id="emoji-hud",t.setAttribute("emoji-hud",""),e.appendChild(t)}}),this.scene.addEventListener("exit-vr",()=>{const e=document.getElementById("emoji-hud");e&&e.remove()}),this.lastSpawnedEmoji=0}tick(e,t){if(this.scene.is("entered"))for(let n=0;n<_P.length;n++)t.get(_P[n])&&n<Te.length&&window.APP.hubChannel.can("spawn_emoji")&&e-this.lastSpawnedEmoji>1e3&&(this.lastSpawnedEmoji=e,je(Te[n]))}}function xP(e,t){return t||e?t&&!e?t:!t&&e?e:["gain","maxDistance","refDistance","rolloffFactor","coneInnerAngle","coneOuterAngle","coneOuterGain"].reduce((n,a)=>(void 0!==t[a]&&void 0!==e[a]?n[a]=Math.min(e[a],t[a]):void 0!==t[a]&&void 0===e[a]?n[a]=t[a]:void 0===t[a]&&void 0!==e[a]&&(n[a]=e[a]),n),{}):{}}function AP(e,t,n){const a=t.isEnabled()&&t.contains(n),i=e.has(t);a&&!i?e.add(t):!a&&i&&e.delete(t)}function MP(e,t){return e.size!==t.size||function(e,t){for(const n of e)if(t(n))return!0;return!1}(e,e=>!t.has(e))}const kP=function(){const e=new THREE.Vector3;return function(t,n,a){t.set(n,e.subVectors(a,n).normalize())}}();function OP(e){return t=>!e.has(t)}function CP(e){const t=new THREE.Vector3;return n=>(e.intersectBox(n.getBoundingBox(),t),null!==t)}const PP=function(){const e=new THREE.Ray;return function(t,n,a,i,r){kP(e,i,n);const o=Array.from(a).filter(e=>e.data.inOut).filter(OP(r)).filter(CP(e)).map(e=>e.getAudioParams()).reduce(xP,null),s=Array.from(r).filter(e=>e.data.outIn).filter(OP(a)).filter(CP(e)).map(e=>e.getAudioParams()).reduce(xP,null);s||o?s&&!o?t.apply(s):!s&&o?t.apply(o):t.apply(Object.assign({},o,s,xP({gain:s.gain},{gain:o.gain}))):t.restore()}}();class RP{constructor(){this.tick=function(){const e=new THREE.Vector3;return function(t){if(!t.is("entered"))return;this.didRegisterAudioListener||(this.didRegisterAudioListener=!0,this.registerEntity(t.audioListener));const n=this.currZones.get(t.audioListener);t.audioListener.getWorldPosition(e),this.zones.forEach(t=>{AP(n,t,e),this.sources.forEach(e=>{AP(this.currZones.get(e),t,e.getPosition())})});const a=MP(n,this.prevZones.get(t.audioListener));this.sources.filter(e=>a||MP(this.currZones.get(e),this.prevZones.get(e))).forEach(t=>{PP(t,t.getPosition(),this.currZones.get(t),e,n)}),this.entities.forEach(e=>{const t=this.prevZones.get(e);t.clear(),this.currZones.get(e).forEach(e=>t.add(e))})}}(),this.zones=[],this.sources=[],this.entities=[],this.currZones=new Map,this.prevZones=new Map,this.didRegisterAudioListener=!1}registerZone(e){this.zones.push(e)}unregisterZone(e){this.zones.splice(this.zones.indexOf(e),1),this.entities.forEach(t=>{this.currZones.get(t).delete(e)})}registerSource(e){this.sources.push(e),this.registerEntity(e)}unregisterSource(e){this.sources.splice(this.sources.indexOf(e),1),this.unregisterEntity(e)}registerEntity(e){this.entities.push(e),this.currZones.set(e,new Set),this.prevZones.set(e,new Set)}unregisterEntity(e){this.entities.splice(this.entities.indexOf(e),1),this.currZones.delete(e),this.prevZones.delete(e)}}const TP={linear:function(e,t,n,a){return 1-t*((e-n)/(a-n))},inverse:function(e,t,n){return n/(n+t*(Math.max(e,n)-n))},exponential:function(e,t,n){return Math.pow(Math.max(e,n)/n,-t)}},jP=(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return(n,a)=>{n.sceneEl.audioListener.getWorldPosition(e),a.getWorldPosition(t);const i=t.distanceTo(e);if(a.panner)return TP[a.panner.distanceModel](i,a.panner.rolloffFactor,a.panner.refDistance,a.panner.maxDistance);{const{distanceModel:e,rolloffFactor:t,refDistance:a,maxDistance:r}=Object(Zt.a)(n);return e?TP[e]?TP[e](i,t,a,r):(console.error("Unrecognized distance model."),1):1}}})();class DP{tick(){const{enableAudioClipping:e,audioClippingThreshold:t}=window.APP.store.state.preferences;for(const[n,a]of APP.audios.entries()){const i=jP(n,a);Object(Zt.c)(n,a)?(APP.supplementaryAttenuation.set(n,i),Object(Zt.d)(n,a)):APP.supplementaryAttenuation.has(n)&&(APP.supplementaryAttenuation.delete(n),Object(Zt.d)(n,a));const r=e&&i<t;APP.clippingState.has(n)!==r&&(r?APP.clippingState.add(n):APP.clippingState.delete(n),Object(Zt.d)(n,a))}}}var IP=n(425);class LP{constructor(e){this.tick=function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(){this.avatarRig.getWorldPosition(t),this.components.forEach(n=>{if("showSpeaking"===this.nametagVisibility){const e=Date.now();!n.isTalking&&n.wasTalking?e-n.lastUpdateTime>3e3&&(n.shouldBeVisible=!1):n.isTalking&&!n.wasTalking?(n.lastUpdateTime=Date.now(),n.shouldBeVisible=!0):n.isTalking||n.wasTalking||e-n.lastUpdateTime>3e3&&(n.shouldBeVisible=!1)}else"showFrozen"===this.nametagVisibility?n.shouldBeVisible=this.sceneEl.is("frozen"):"showNone"===this.nametagVisibility?n.shouldBeVisible=!1:"showClose"===this.nametagVisibility?n.ikRoot&&(n.ikRoot.getWorldPosition(e),n.shouldBeVisible=e.sub(t).lengthSq()<this.nametagVisibilityDistance):n.shouldBeVisible=!0})}}(),this.sceneEl=e,this.store=window.APP.store,this.components=[],this.lastUpdateTime=Date.now(),this.tick=this.tick.bind(this),this.onStateChanged=this.onStateChanged.bind(this),this.nametagVisibility=this.store.state.preferences.nametagVisibility,this.nametagVisibilityDistance=Math.pow(this.store.state.preferences.nametagVisibilityDistance,2),Object(Ue.b)().then(()=>{this.avatarRig=document.getElementById("avatar-rig").object3D}),window.APP.store.addEventListener("statechanged",this.onStateChanged)}register(e){this.components.push(e)}unregister(e){this.components.splice(this.components.indexOf(e),1)}onStateChanged(){this.nametagVisibilityDistance=Math.pow(this.store.state.preferences.nametagVisibilityDistance,2),this.nametagVisibility=this.store.state.preferences.nametagVisibility}}AFRAME.registerSystem("hubs-systems",{init(){Object(Ue.b)().then(()=>{this.DOMContentDidLoad=!0}),this.cursorTogglingSystem=new _O,this.interactionSfxSystem=new dC,this.superSpawnerSystem=new QO,this.cursorTargettingSystem=new bO,this.positionAtBorderSystem=new Kn,this.physicsSystem=new RO(this.el.object3D),this.constraintsSystem=new jO(this.physicsSystem),this.twoPointStretchingSystem=new HO,this.singleActionButtonSystem=new NO,this.holdableButtonSystem=new FO,this.hoverButtonSystem=new qO,this.hoverMenuSystem=new XO,this.hapticFeedbackSystem=new sC,this.audioSystem=new mP(this.el),this.soundEffectsSystem=new Q.z(this.el),this.scenePreviewCameraSystem=new cC.a,this.spriteSystem=new HC(this.el),this.batchManagerSystem=new lC(this.el.object3D,this.el.renderer),this.cameraSystem=new Tt.d(this.el.camera,this.el.renderer),this.drawingMenuSystem=new GO(this.el),this.characterController=new tP(this.el),this.waypointSystem=new YC(this.el,this.characterController),this.cursorPoseTrackingSystem=new aP,this.menuAnimationSystem=new iP,this.audioSettingsSystem=new rP(this.el),this.animationMixerSystem=new yO.a,this.boneVisibilitySystem=new ee,this.uvScrollSystem=new EO.a,this.shadowSystem=new fP.a(this.el),this.mediaFramesSystem=new EP(this.physicsSystem,this.el.systems.interaction),this.inspectYourselfSystem=new wP,this.emojiSystem=new SP(this.el),this.audioZonesSystem=new RP,this.gainSystem=new DP,this.environmentSystem=new IP.a(this.el),this.nameTagSystem=new LP(this.el)},tick(e,t){if(!this.DOMContentDidLoad)return;const n=AFRAME.scenes[0].systems;n.userinput.tick2(),n.interaction.tick2(),this.animationMixerSystem.tick(t),this.characterController.tick(e,t),this.cursorTogglingSystem.tick(n.interaction,n.userinput,this.el),this.interactionSfxSystem.tick(n.interaction,n.userinput,this.soundEffectsSystem),this.superSpawnerSystem.tick(),this.emojiSystem.tick(e,n.userinput),this.cursorPoseTrackingSystem.tick(),this.cursorTargettingSystem.tick(e),this.hoverMenuSystem.tick(),this.positionAtBorderSystem.tick(),this.constraintsSystem.tick(),this.twoPointStretchingSystem.tick(),this.singleActionButtonSystem.tick(),this.holdableButtonSystem.tick(),this.hoverButtonSystem.tick(),this.drawingMenuSystem.tick(),this.hapticFeedbackSystem.tick(this.twoPointStretchingSystem,this.singleActionButtonSystem.didInteractLeftThisFrame,this.singleActionButtonSystem.didInteractRightThisFrame),this.soundEffectsSystem.tick(),this.scenePreviewCameraSystem.tick(),this.physicsSystem.tick(t),this.batchManagerSystem.tick(e),this.inspectYourselfSystem.tick(this.el,n.userinput,this.cameraSystem),this.cameraSystem.tick(this.el,t),this.waypointSystem.tick(e,t),this.menuAnimationSystem.tick(e),this.spriteSystem.tick(e,t),this.uvScrollSystem.tick(t),this.shadowSystem.tick(),this.mediaFramesSystem.tick(),this.audioZonesSystem.tick(this.el),this.gainSystem.tick(),this.nameTagSystem.tick(),this.boneVisibilitySystem.tick()},remove(){this.cursorTargettingSystem.remove()}}),AFRAME.registerSystem("capture-system",{init(){this._gotAudioTrack=!1,this._recorderTimeout=null},_initRecorder(){if(!this.available())return;this._stream=new MediaStream;const e=this.el.canvas.captureStream().getVideoTracks()[0];this._stream.addTrack(e),this._recorder=new MediaRecorder(this._stream,{mimeType:"video/webm; codecs=vp8"});const t=[];this._recorder.ondataavailable=e=>{t.push(e.data)},this._recorder.onstop=()=>{if(0===t.length)return;const e=t[0].type,n=new Blob(t,{type:e});t.length=0,this.el.emit("add_media",new File([n],"capture",{type:e}))}},available:()=>Object(mt.a)("video_capture")&&window.MediaRecorder&&MediaRecorder.isTypeSupported("video/webm; codecs=vp8"),started(){return this._recorder&&"inactive"!==this._recorder.state},_tryAddingAudioTrack(){if(this._gotAudioTrack||!this.el.audioListener)return;const e=this.el.audioListener,t=e.context.createMediaStreamDestination();e.getInput().connect(t);const n=t.stream.getAudioTracks()[0];this._stream.addTrack(n),this._gotAudioTrack=!0},start(){this._recorder||this._initRecorder(),this._tryAddingAudioTrack(),this.started()||(this._recorder.start(),this._recorderTimeout=setTimeout(()=>{this.started()&&this._recorder.stop()},15e3))},stop(){this.started()&&(clearTimeout(this._recorderTimeout),this._recorder.stop())}});n(1536);AFRAME.registerSystem("linked-media",{init:function(){this.handlers=[],this.addLinkageHandler=this.addLinkageHandler.bind(this),this.syncLinkage=this.syncLinkage.bind(this)},addLinkageHandler(e,t){const n=()=>{t._handlingLinkage||(e._handlingLinkage=!0,this.syncLinkage(e,t),e._handlingLinkage=!1)};if(e.components["media-loader"].data)e.addEventListener("componentchanged",n);else{const t=a=>{"media-loader"===a.detail.name&&(e.removeEventListener("componentinitialized",t),e.addEventListener("componentchanged",n))};e.addEventListener("componentinitialized",t)}return n},registerLinkage:function(e,t){this.syncLinkage(e,t);const n=this.addLinkageHandler(e,t),a=this.addLinkageHandler(t,e);e.setAttribute("linked-media",""),t.setAttribute("linked-media",""),APP.mutedState.add(e);const i=APP.audios.get(e);i&&Object(Zt.d)(e,i),this.handlers.push([e,t,n,a])},deregisterLinkage:function(e){for(const[t,n,a,i]of this.handlers){e!==t&&e!==n||(t.removeEventListener("componentchanged",a),n.removeEventListener("componentchanged",i)),APP.mutedState.delete(t);const r=APP.audios.get(t);r&&Object(Zt.d)(t,r)}this.handlers=this.handlers.filter(([t,n])=>t!==e&&n!==e)},syncLinkage(e,t){if(t.components.networked&&!NAF.utils.isMine(t)&&!NAF.utils.takeOwnership(t))return;const{src:n,version:a}=e.components["media-loader"].data;if(t.setAttribute("media-loader",{src:n,version:a}),e.components["media-pdf"]){const{index:n}=e.components["media-pdf"].data;t.setAttribute("media-pdf",{index:n})}if(e.components["media-video"]){const{time:n,videoPaused:a,loop:i,hidePlaybackControls:r}=e.components["media-video"].data,o={time:n,videoPaused:a,loop:i,hidePlaybackControls:r};!t.components.networked&&(o.syncTolerance=.25),t.setAttribute("media-video",o),t.components["media-video"].updatePlaybackState(!0)}}}),AFRAME.registerComponent("linked-media",{remove:function(){this.system.deregisterLinkage(this.el)}});var HP=n(821),NP=n.n(HP),FP=n(822),VP=n.n(FP);const BP={distanceModel:$t.d.Inverse,maxDistance:0,refDistance:0,rolloffFactor:0,coneInnerAngle:0,coneOuterAngle:0};AFRAME.registerSystem("audio-debug",{schema:{enabled:{default:!1}},init(){this.unsupported=!1;Object(h.a)(this.el.sceneEl.renderer)<"2.0"&&(this.unsupported=!0),window.APP.store.addEventListener("statechanged",this.updateState.bind(this)),this.onSceneLoaded=this.onSceneLoaded.bind(this),this.el.sceneEl.addEventListener("environment-scene-loaded",this.onSceneLoaded),this.navMeshObject=null,this.zones=[],this.material=new d.THREE.ShaderMaterial({uniforms:{time:{value:0},colorInner:{value:new d.THREE.Color("#7AFF59")},colorOuter:{value:new d.THREE.Color("#FF6340")},colorGain:{value:new d.THREE.Color("#70DBFF")},count:{value:0},maxDistance:{value:[]},refDistance:{value:[]},rolloffFactor:{value:[]},distanceModel:{value:[]},sourcePosition:{value:[]},sourceOrientation:{value:[]},coneInnerAngle:{value:[]},coneOuterAngle:{value:[]},gain:{value:[]},clipped:{value:[]}},vertexShader:NP.a,fragmentShader:VP.a}),this.material.side=d.THREE.FrontSide,this.material.transparent=!0,this.material.uniforms.count.value=0,this.material.defines.MAX_DEBUG_SOURCES=64,this.sourcePositions=new Array(64),this.sourcePositions.fill(new d.THREE.Vector3),this.sourceOrientations=new Array(64),this.sourceOrientations.fill(new d.THREE.Vector3),this.distanceModels=new Array(64),this.distanceModels.fill(0),this.maxDistances=new Array(64),this.maxDistances.fill(0),this.refDistances=new Array(64),this.refDistances.fill(0),this.rolloffFactors=new Array(64),this.rolloffFactors.fill(0),this.coneInnerAngles=new Array(64),this.coneInnerAngles.fill(0),this.coneOuterAngles=new Array(64),this.coneOuterAngles.fill(0),this.gains=new Array(64),this.gains.fill(0),this.clipped=new Array(64),this.clipped.fill(0)},remove(){window.APP.store.removeEventListener("statechanged",this.updateState),this.el.sceneEl.removeEventListener("environment-scene-loaded",this.onSceneLoaded)},registerZone(e){this.zones.push(e)},unregisterZone(e){const t=this.zones.indexOf(e);-1!==t&&this.zones.splice(t,1)},tick:(()=>{const e=new d.THREE.Vector3,t=new d.THREE.Vector3;return function(n){if(!this.data.enabled)return;let a=0;for(const[n,i]of APP.audios.entries()){if(a>=64)continue;if(APP.isAudioPaused.has(n))continue;i.getWorldPosition(e),i.getWorldDirection(t),this.sourcePositions[a]=this.navMeshObject.worldToLocal(e).clone(),this.sourceOrientations[a]=this.navMeshObject.worldToLocal(t).clone();const r=i.panner||BP;this.distanceModels[a]=0,r.distanceModel===$t.d.Linear?this.distanceModels[a]=0:r.distanceModel===$t.d.Inverse?this.distanceModels[a]=1:r.distanceModel===$t.d.Exponential&&(this.distanceModels[a]=2),this.maxDistances[a]=r.maxDistance,this.refDistances[a]=r.refDistance,this.rolloffFactors[a]=r.rolloffFactor,this.coneInnerAngles[a]=r.coneInnerAngle,this.coneOuterAngles[a]=r.coneOuterAngle,this.gains[a]=i.gain.gain.value,this.clipped[a]=APP.clippingState.has(n),a++}this.material.uniforms.time.value=n,this.material.uniforms.distanceModel.value=this.distanceModels,this.material.uniforms.maxDistance.value=this.maxDistances,this.material.uniforms.refDistance.value=this.refDistances,this.material.uniforms.rolloffFactor.value=this.rolloffFactors,this.material.uniforms.sourcePosition.value=this.sourcePositions,this.material.uniforms.sourceOrientation.value=this.sourceOrientations,this.material.uniforms.count.value=a,this.material.uniforms.coneInnerAngle.value=this.coneInnerAngles,this.material.uniforms.coneOuterAngle.value=this.coneOuterAngles,this.material.uniforms.gain.value=this.gains,this.material.uniforms.clipped.value=this.clipped}})(),enableDebugMode(e,t=!1){if((void 0===e||e===this.data.enabled)&&!t||this.unsupported)return;this.zones.forEach(t=>{t.el.setAttribute("audio-zone","debuggable",e)});const n=ii(Array.from(this.el.sceneEl.querySelectorAll("[nav-mesh]")));n.length&&(this.data.enabled=e,n.forEach(t=>{t.isMesh&&(this.navMeshObject=t,t.parent.visible=e,t.material&&(e?(!t._hubs_audio_debug_prev_material&&(t._hubs_audio_debug_prev_material=t.material),t.material=this.material,t.material.needsUpdate=!0):t._hubs_audio_debug_prev_material&&(t.material=t._hubs_audio_debug_prev_material,t._hubs_audio_debug_prev_material=null,t.material.needsUpdate=!0),t.geometry.computeVertexNormals()))})),this.navMeshObject||(this.data.enabled=!1)},updateState({force:e}){const t=window.APP.store.state.preferences.showAudioDebugPanel;(e||t!==this.data.enabled)&&this.enableDebugMode(t,e)},onSceneLoaded(){this.navMeshObject=null,this.updateState({force:!0})}});n(595);var UP=n(284);function zP(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function WP(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){zP(r,a,i,o,s,"next",e)}function s(e){zP(r,a,i,o,s,"throw",e)}o(void 0)}))}}class qP{constructor(e,t,n,a){this._signInAndPinOrUnpinElement=(e,t)=>{const n=t?()=>this._pinElement(e):()=>this.unpinElement(e);this.performConditionalSignIn(()=>this.hubChannel.signedIn,n,t?es.b.pin:es.b.unpin,e=>{console.warn("PinningHelper: Conditional sign-in failed. ".concat(e))})},this.hubChannel=e,this.authChannel=t,this.store=n,this.performConditionalSignIn=a}setPinned(e,t){var n=this;return WP((function*(){NAF.utils.isMine(e)?n._signInAndPinOrUnpinElement(e,t):console.warn("PinningHelper: Attempted to set pin state on object that was not mine.")}))()}_pinElement(e){var t=this;return WP((function*(){const{networkId:n}=e.components.networked.data,{fileId:a,src:i}=e.components["media-loader"].data;let r,o;if(a){r=new URL(i).searchParams.get("token");const e=Object(te.k)(a);e&&(o=e.promotionToken)}const s=function(e){if(!NAF.utils.isMine(e))return;const t=e.object3D,n=e.components,a=n.networked.data.networkId,i={},r={name:a,extensions:{HUBS_components:i}},o=(e,t)=>e.length===t.length&&e.every((e,n)=>e===t[n]),s=t.quaternion.toArray(),l=t.position.toArray(),c=t.scale.toArray();if(o(s,[0,0,0,1])||(r.rotation=s),o(l,[0,0,0])||(r.translation=l),o(c,[1,1,1])||(r.scale=c),n["media-loader"]){const e=n["media-loader"].data.src,t=n["media-loader"].data.version,r=n["media-loader"].data.contentSubtype;if(e.startsWith("hubs://")&&e.endsWith("/video"))return null;i.media={src:e,version:t,contentSubtype:r,id:a},n["media-pdf"]&&(i.media.pageIndex=n["media-pdf"].data.index),n["media-video"]&&n["media-video"].data.videoPaused&&(i.media.paused=!0,i.media.time=n["media-video"].data.time)}return i.pinnable={pinned:!0},r}(e);if(s){e.setAttribute("networked",{persistent:!0}),e.setAttribute("media-loader",{fileIsOwned:!0});try{yield t.hubChannel.pin(n,s,a,r,o),NAF.utils.isMine(e)||NAF.utils.takeOwnership(e)||console.warn("PinningHelper: Pinning succeeded, but ownership was lost in the mean time"),e.setAttribute("pinnable","pinned",!0),e.emit("pinned",{el:e}),t.store.update({activity:{hasPinned:!0}})}catch(n){"invalid_token"===n.reason?(yield t.authChannel.signOut(t.hubChannel),t._signInAndPinOrUnpinElement(e)):console.warn("PinningHelper: Pin failed for unknown reason",n)}}else console.warn("PinningHelper: Entity did not produce a GLTF node.")}))()}unpinElement(e){const t=e.components,n=t.networked;if(!n||!n.data||!NAF.utils.isMine(e))return void console.warn("PinningHelper: Tried to unpin element that is not networked or not mine.");const a=t.networked.data.networkId;e.setAttribute("networked",{persistent:!1});const i=t["media-loader"],r=i.data&&i.data.fileId;this.hubChannel.unpin(a,r),e.setAttribute("pinnable","pinned",!1),e.emit("unpinned",{el:e})}}var GP=n(469);n(1537),n(1538),n(1539);AFRAME.registerComponent("scalable-when-grabbed",{tick:function(){const e=AFRAME.scenes[0].systems.userinput,t=AFRAME.scenes[0].systems.interaction;let n;t.state.rightRemote.held===this.el&&(n=e.get(Xe.a.actions.cursor.right.scaleGrabbedGrabbable)),t.state.leftRemote.held===this.el&&(n=e.get(Xe.a.actions.cursor.left.scaleGrabbedGrabbable)),n&&(this.el.object3D.scale.addScalar(n).clampScalar(.1,100),this.el.object3D.matrixNeedsUpdate=!0)}});n(1540),n(589),n(1541);const YP=new THREE.Color(23/255,64/255,118/255),KP=new THREE.Color(190/255,190/255,190/255),XP=new THREE.Color(150/255,80/255,150/255),QP=new THREE.Color(23/255,64/255,118/255);AFRAME.registerComponent("cursor-controller",{schema:{cursor:{type:"selector"},camera:{type:"selector"},far:{default:100},near:{default:.01},defaultDistance:{default:4},minDistance:{default:.18}},init:function(){this.enabled=!1,this.cursorVisual=new THREE.Mesh(new THREE.PlaneBufferGeometry,new THREE.ShaderMaterial({depthTest:!1,uniforms:{color:{value:new THREE.Color(3113197)}},vertexShader:"\n          varying vec2 vPos;\n          void main() {\n            vPos = position.xy;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n            vec2 scale = vec2(\n              length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) ),\n              length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) )\n            );\n\n            float distance = -mvPosition.z;\n            scale *= distance; // negates projection scale\n            scale += min(1.0/distance, 0.3); // scale in screen space\n\n            float radius = 0.02;\n            mvPosition.xy += position.xy * radius * scale;\n            gl_Position = projectionMatrix * mvPosition;\n          }",fragmentShader:"\n          uniform vec3 color;\n          varying vec2 vPos;\n\n          void main() {\n            float distance = length(vPos);\n            if (distance > 0.5) {\n                discard;\n            }\n\n            gl_FragColor = vec4(\n              mix(color, vec3(0.0), step(0.35, distance)),\n              0.8\n            );\n\n            // #include <tonemapping_fragment>\n            #include <encodings_fragment>\n          }"}));const e=()=>{this.cursorVisual.scale.setScalar(APP.store.state.preferences.cursorSize||1),this.cursorVisual.matrixNeedsUpdate=!0};APP.store.addEventListener("statechanged",e),e(),this.cursorVisual.renderOrder=window.APP.RENDER_ORDER.CURSOR,this.cursorVisual.material.transparent=!0,this.data.cursor.object3D.add(this.cursorVisual),this.intersection=null,this.raycaster=new THREE.Raycaster,this.raycaster.firstHitOnly=!0,this.distance=this.data.far,this.color=this.cursorVisual.material.uniforms.color.value;const t=new THREE.BufferGeometry;t.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:"white",opacity:.2,transparent:!0,visible:!1})),this.el.setObject3D("line",this.line)},update:function(){this.raycaster.far=this.data.far,this.raycaster.near=this.data.near},tick2:(()=>{const e=[],t=new THREE.Vector3,n=new THREE.Vector3;return function(a,i){const r=AFRAME.scenes[0].systems.userinput,o=r.get(i?Xe.a.actions.cursor.left.pose:Xe.a.actions.cursor.right.pose),s=r.get(i?Xe.a.actions.cursor.left.hideLine:Xe.a.actions.cursor.right.hideLine);if(this.data.cursor.object3D.visible=this.enabled&&!!o,this.line.material.visible=!(!this.enabled||s),this.intersection=null,!this.enabled||!o)return;this.el.sceneEl.systems["hubs-systems"].characterController.avatarPOV.object3D.updateMatrices();const l=n.setFromMatrixColumn(this.el.sceneEl.systems["hubs-systems"].characterController.avatarPOV.object3D.matrixWorld,1).length();this.raycaster.far=this.data.far*l,this.raycaster.near=this.data.near*l;const c=AFRAME.scenes[0].systems.interaction,d=i?!!c.state.leftRemote.held:!!c.state.rightRemote.held;d||(e.length=0,this.raycaster.ray.origin=o.position,this.raycaster.ray.direction=o.direction,this.raycaster.intersectObjects(AFRAME.scenes[0].systems["hubs-systems"].cursorTargettingSystem.targets,!0,e),this.intersection=e[0],this.intersectionIsValid=!!c.updateCursorIntersection(this.intersection,i),this.distance=this.intersectionIsValid?this.intersection.distance:this.data.defaultDistance*l);const{cursor:u,minDistance:h,far:p,camera:m}=this.data,f=r.get(i?Xe.a.actions.cursor.left.modDelta:Xe.a.actions.cursor.right.modDelta)||0;d&&!r.activeSets.includes(i?ew.leftCursorHoldingUI:ew.rightCursorHoldingUI)&&(this.distance=THREE.Math.clamp(this.distance-f,h,p*l)),u.object3D.position.copy(o.position).addScaledVector(o.direction,this.distance),Object(lt.j)(m.object3D,t),t.y=u.object3D.position.y,u.object3D.lookAt(t),u.object3D.matrixNeedsUpdate=!0;const g=AFRAME.scenes[0].systems["transform-selected-object"];if(g.transforming&&(i&&"player-left-controller"===g.hand.el.id||!i&&"player-right-controller"===g.hand.el.id)?this.color.copy(XP).lerpHSL(QP,.5+.5*Math.sin(a/1e3)):this.intersectionIsValid||d?this.color.copy(YP):this.color.copy(KP),this.line.material.visible){const e=o.position,t=u.object3D.position,n=this.line.geometry.attributes.position.array;n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=t.x,n[4]=t.y,n[5]=t.z,this.line.geometry.attributes.position.needsUpdate=!0,this.line.geometry.computeBoundingSphere()}}})()});const JP={"player-right-controller":{startDrawing:Xe.a.actions.rightHand.startDrawing,stopDrawing:Xe.a.actions.rightHand.stopDrawing,undoDrawing:Xe.a.actions.rightHand.undoDrawing,switchDrawMode:Xe.a.actions.rightHand.switchDrawMode,penNextColor:Xe.a.actions.rightHand.penNextColor,penPrevColor:Xe.a.actions.rightHand.penPrevColor,scalePenTip:Xe.a.actions.rightHand.scalePenTip},"player-left-controller":{startDrawing:Xe.a.actions.leftHand.startDrawing,stopDrawing:Xe.a.actions.leftHand.stopDrawing,undoDrawing:Xe.a.actions.leftHand.undoDrawing,switchDrawMode:Xe.a.actions.leftHand.switchDrawMode,penNextColor:Xe.a.actions.leftHand.penNextColor,penPrevColor:Xe.a.actions.leftHand.penPrevColor,scalePenTip:Xe.a.actions.leftHand.scalePenTip},"right-cursor":{pose:Xe.a.actions.cursor.right.pose,startDrawing:Xe.a.actions.cursor.right.startDrawing,stopDrawing:Xe.a.actions.cursor.right.stopDrawing,undoDrawing:Xe.a.actions.cursor.right.undoDrawing,penNextColor:Xe.a.actions.cursor.right.penNextColor,penPrevColor:Xe.a.actions.cursor.right.penPrevColor,scalePenTip:Xe.a.actions.cursor.right.scalePenTip},"left-cursor":{pose:Xe.a.actions.cursor.left.pose,startDrawing:Xe.a.actions.cursor.left.startDrawing,stopDrawing:Xe.a.actions.cursor.left.stopDrawing,undoDrawing:Xe.a.actions.cursor.left.undoDrawing,penNextColor:Xe.a.actions.cursor.left.penNextColor,penPrevColor:Xe.a.actions.cursor.left.penPrevColor,scalePenTip:Xe.a.actions.cursor.left.scalePenTip}},ZP=0,$P=1;function eR(e,t,n){return Math.abs(t.x-n.x)<e&&Math.abs(t.y-n.y)<e&&Math.abs(t.z-n.z)<e}AFRAME.registerComponent("pen",{schema:{drawFrequency:{default:5},minDistanceBetweenPoints:{default:.01},camera:{type:"selector"},drawingManager:{type:"string"},color:{type:"color",default:"#FF0033"},availableColors:{default:["#FF0033","#FFFF00","#0099FF","#00FF33","#9900FF","#FF6600","#8D5524","#C68642","#E0AC69","#F1C27D","#FFDBAC","#FFFFFF","#222222","#111111","#000000"]},radius:{default:.01},minRadius:{default:.005},maxRadius:{default:.2},far:{default:100},near:{default:.01},drawMode:{default:ZP,oneOf:[ZP,$P]},penVisible:{default:!0},penTipPosition:{default:{x:0,y:0,z:0}}},init(){this.timeSinceLastDraw=0,this.lastPosition=new THREE.Vector3,this.lastPosition.copy(this.el.object3D.position),this.direction=new THREE.Vector3(1,0,0),this.currentDrawing=null,this.normal=new THREE.Vector3,this.worldPosition=new THREE.Vector3,this.colorIndex=0,this.grabbed=!1,this.raycaster=new THREE.Raycaster,this.raycaster.firstHitOnly=!0,this.originalPosition=this.el.object3D.position.clone(),this.lastIntersectionDistance=0,this.targets=[],this.setDirty=this.setDirty.bind(this),this.dirty=!0;let e=new THREE.MeshStandardMaterial;const t=window.APP.store.state.preferences.materialQualitySetting;e=Object(Bt.a)(e,t),this.penTip=new THREE.Mesh(new THREE.SphereBufferGeometry(1,16,12),e),this.penTip.scale.setScalar(this.data.radius/this.el.parentEl.object3D.scale.x),this.penTip.matrixNeedsUpdate=!0,this.el.setObject3D("mesh",this.penTip),this.penLaserAttributesUpdated=!1,this.penLaserAttributes={color:"#FF0033",laserVisible:!1,laserInHand:!1,laserOrigin:{x:0,y:0,z:0},remoteLaserOrigin:{x:0,y:0,z:0},laserTarget:{x:0,y:0,z:0}},this.observer=new MutationObserver(this.setDirty),Object(Ue.b)().then(()=>{const e=document.querySelector("a-scene");this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),e.addEventListener("object3dset",this.setDirty),e.addEventListener("object3dremove",this.setDirty)}),this.penSystem=this.el.sceneEl.systems["pen-tools"],this.penSystem.register(this.el)},play(){this.drawingManager=document.querySelector(this.data.drawingManager).components["drawing-manager"]},update(e){e.color!=this.data.color&&(this.penTip.material.color.set(this.data.color),this.penLaserAttributes.color=this.data.color,this.el.setAttribute("pen-laser",{color:this.data.color})),e.radius!=this.data.radius&&this.el.setAttribute("radius",this.data.radius),this.raycaster.far=this.data.far,this.raycaster.near=this.data.near},tick(e,t){const n=this.el.parentEl.components.networked.initialized&&this.el.parentEl.components.networked.isMine();if(this.penTip.material.visible!==n&&(this.penTip.material.visible=n),n){this._handleInput();const e=this.data.drawMode!==$P||"right-cursor"!==this.grabberId&&"left-cursor"!==this.grabberId?null:AFRAME.scenes[0].systems.userinput.get(JP[this.grabberId].pose),n=this._getIntersection(e);this._updatePenTip(n);const a=this.data.drawMode===$P&&!!n,i=this.el.sceneEl.is("vr-mode")&&a;this.penLaserAttributes.laserVisible!==a&&(this.penLaserAttributes.laserVisible=a,this.penLaserAttributesUpdated=!0),this.penLaserAttributes.laserInHand!==i&&(this.penLaserAttributes.laserInHand=i,this.penLaserAttributesUpdated=!0),a&&this._updateLaser(e,n);const r="left-cursor"!==this.grabberId&&"right-cursor"!==this.grabberId||!n;this._setPenVisible(r),this.el.setAttribute("pen",{penVisible:r}),this._doDraw(n,t),this.penLaserAttributesUpdated&&(this.penLaserAttributesUpdated=!1,this.el.setAttribute("pen-laser",this.penLaserAttributes,!0))}else this._setPenVisible(this.data.penVisible)},_handleInput(){const e=AFRAME.scenes[0].systems.userinput,t=AFRAME.scenes[0].systems.interaction;if(t.state.rightHand.held===this.el.parentNode?this.grabberId="player-right-controller":t.state.leftHand.held===this.el.parentNode?this.grabberId="player-left-controller":t.state.rightRemote.held===this.el.parentNode?(this.grabberId="right-cursor",this.data.drawMode=$P):t.state.leftRemote.held===this.el.parentNode?(this.grabberId="left-cursor",this.data.drawMode=$P):this.grabberId=null,this.grabberId&&JP[this.grabberId]){const t=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem,n=JP[this.grabberId];e.get(n.startDrawing)&&(this._startDraw(),t.playSoundOneShot(Q.j)),e.get(n.stopDrawing)&&(this._endDraw(),t.playSoundOneShot(Q.k));const a=e.get(n.scalePenTip);a&&this._changeRadius(a),e.get(n.penNextColor)&&(this._changeColor(1),t.playSoundOneShot(Q.i)),e.get(n.penPrevColor)&&(this._changeColor(-1),t.playSoundOneShot(Q.i)),e.get(n.undoDrawing)&&(this._undoDraw(),t.playSoundOneShot(Q.l)),n.switchDrawMode&&e.get(n.switchDrawMode)&&(this.data.drawMode=this.data.drawMode===ZP?$P:ZP)}},_getIntersection:(()=>{const e=[],t=new THREE.Quaternion;return function(n){return e.length=0,this.data.drawMode===$P&&(n?(this.raycaster.ray.origin.copy(n.position),this.raycaster.ray.direction.copy(n.direction)):null!==this.grabberId&&(Object(lt.j)(this.el.parentEl.object3D,this.raycaster.ray.origin),Object(lt.k)(this.el.parentEl.object3D,t),this.raycaster.ray.direction.set(0,-1,0),this.raycaster.ray.direction.applyQuaternion(t)),null!==this.grabberId)?(this.raycaster.intersectObjects(this.targets,!0,e),e[0]):null}})(),_updatePenTip(e){this.data.drawMode===$P&&e?(this.el.object3D.position.copy(e.point),this.el.parentEl.object3D.worldToLocal(this.el.object3D.position),this.el.object3D.matrixNeedsUpdate=!0,this.worldPosition.copy(e.point)):(this.el.object3D.position.copy(this.originalPosition),this.el.object3D.matrixNeedsUpdate=!0,Object(lt.j)(this.el.object3D,this.worldPosition))},_updateLaser:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;return function(i,r){i?e.copy(i.position):this.el.parentEl.object3D.getWorldPosition(e),t.copy(r.point),this.el.sceneEl.is("vr-mode")?a.copy(e):(this.data.camera.object3D.getWorldPosition(n),a.subVectors(t,n).normalize().multiplyScalar(.5),a.add(n)),eR(.001,this.penLaserAttributes.laserOrigin,e)||(this.penLaserAttributes.laserOrigin.x=e.x,this.penLaserAttributes.laserOrigin.y=e.y,this.penLaserAttributes.laserOrigin.z=e.z,this.penLaserAttributesUpdated=!0),eR(.001,this.penLaserAttributes.remoteLaserOrigin,a)||(this.penLaserAttributes.remoteLaserOrigin.x=a.x,this.penLaserAttributes.remoteLaserOrigin.y=a.y,this.penLaserAttributes.remoteLaserOrigin.z=a.z,this.penLaserAttributesUpdated=!0),eR(.001,this.penLaserAttributes.laserTarget,t)||(this.penLaserAttributes.laserTarget.x=t.x,this.penLaserAttributes.laserTarget.y=t.y,this.penLaserAttributes.laserTarget.z=t.z,this.penLaserAttributesUpdated=!0)}})(),_doDraw(e,t){if(this.currentDrawing&&this.lastIntersectedObject!==(e?e.object:null)&&(!e||Math.abs(e.distance-this.lastIntersectionDistance)>1)&&(this.worldPosition.copy(this.lastPosition),this._endDraw()),this.lastIntersectionDistance=e?e.distance:0,this.lastIntersectedObject=e?e.object:null,eR(.005,this.worldPosition,this.lastPosition)||(this.direction.subVectors(this.worldPosition,this.lastPosition).normalize(),this.lastPosition.copy(this.worldPosition)),this.currentDrawing){const e=this.timeSinceLastDraw+t;e>=this.data.drawFrequency&&this.currentDrawing.getLastPoint().distanceTo(this.worldPosition)>=this.data.minDistanceBetweenPoints&&(this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.draw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)),this.timeSinceLastDraw=e%this.data.drawFrequency}this.currentDrawing&&!this.grabberId&&this._endDraw(),this.dirty&&(this.populateEntities(this.targets),this.dirty=!1)},_setPenVisible(e){this.el.parentEl.object3DMap.mesh&&this.el.parentEl.object3DMap.mesh.visible!==e&&(this.el.parentEl.object3DMap.mesh.visible=e)},_getNormal:(()=>{const e=new THREE.Vector3;return function(t,n,a){e.subVectors(n,this.data.camera.object3D.position).normalize(),t.crossVectors(a,e)}})(),_startDraw(){this.drawingManager.getDrawing(this).then(e=>{this.currentDrawing=e,this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.startDraw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)})},_endDraw(){this.currentDrawing&&(this.timeSinceLastDraw=0,this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.endDraw(this.worldPosition,this.direction,this.normal),this.drawingManager.returnDrawing(this),this.currentDrawing=null)},_undoDraw(){this.drawingManager.getDrawing(this).then(e=>{e.undoDraw(),this.drawingManager.returnDrawing(this)})},_changeColor(e){this.colorIndex=(this.colorIndex+e+this.data.availableColors.length)%this.data.availableColors.length,this.data.color=this.data.availableColors[this.colorIndex],this.penTip.material.color.set(this.data.color),this.penLaserAttributes.color=this.data.color,this.penLaserAttributesUpdated=!0},_changeRadius(e){this.data.radius=Math.max(this.data.minRadius,Math.min(this.data.radius+e,this.data.maxRadius)),this.penTip.scale.setScalar(this.data.radius/this.el.parentEl.object3D.scale.x),this.penTip.matrixNeedsUpdate=!0},setDirty(){this.dirty=!0},populateEntities(e){e.length=0;const t=AFRAME.scenes[0].querySelectorAll(".collidable, .interactable, #environment-root");for(let n=0;n<t.length;n++)!t[n].classList.contains("pen")&&t[n].object3D&&e.push(t[n].object3D)},remove(){this.observer.disconnect(),AFRAME.scenes[0].removeEventListener("object3dset",this.setDirty),AFRAME.scenes[0].removeEventListener("object3dremove",this.setDirty),this.penSystem.deregister(this.el)}});const tR=n(1542);function nR(e,t,n){return Math.abs(t.x-n.x)<e&&Math.abs(t.y-n.y)<e&&Math.abs(t.z-n.z)<e}AFRAME.registerComponent("pen-laser",{schema:{color:{type:"color",default:"#FF0033"},laserVisible:{default:!1},laserInHand:{default:!1},laserOrigin:{default:{x:0,y:0,z:0}},remoteLaserOrigin:{default:{x:0,y:0,z:0}},laserTarget:{default:{x:0,y:0,z:0}}},init(){let e=new THREE.MeshStandardMaterial({color:"red",opacity:.5,transparent:!0,visible:!0});const t=window.APP.store.state.preferences.materialQualitySetting;e=Object(Bt.a)(e,t);const n=e.clone(),a=new THREE.LineCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,2)),i=new THREE.TubeBufferGeometry(a,2,.003,8,!0);this.laser=new THREE.Mesh(i,e),this.laserTip=new THREE.Mesh(new THREE.SphereBufferGeometry(1,8,6),n),this.laserTip.scale.setScalar(.01),this.laserTip.matrixNeedsUpdate=!0,this.laser.raycast=function(){},this.el.sceneEl.setObject3D("pen-laser-".concat(this.laser.uuid),this.laser),this.el.sceneEl.setObject3D("pen-laser-tip-".concat(this.laser.uuid),this.laserTip),this.originBuffer=new tR(tR.MODE_LERP,.1),this.targetBuffer=new tR(tR.MODE_LERP,.1)},update:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n){n.color!=this.data.color&&(this.laser.material.color.set(this.data.color),this.laserTip.material.color.set(this.data.color)),n.remoteLaserOrigin&&!nR(.001,n.remoteLaserOrigin,this.data.remoteLaserOrigin)&&this.originBuffer.setPosition(e.set(this.data.remoteLaserOrigin.x,this.data.remoteLaserOrigin.y,this.data.remoteLaserOrigin.z)),n.laserTarget&&!nR(.001,n.laserTarget,this.data.laserTarget)&&this.targetBuffer.setPosition(t.set(this.data.laserTarget.x,this.data.laserTarget.y,this.data.laserTarget.z))}})(),tick:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){const i=this.el.parentEl.components.networked.initialized&&this.el.parentEl.components.networked.isMine();let r=!1;i&&this.data.laserVisible?(e.copy(this.data.laserOrigin),this.data.laserInHand||(e.y=e.y-.4),t.copy(this.data.laserTarget),r=!0):!i&&this.data.laserVisible&&(this.originBuffer.update(a),this.targetBuffer.update(a),e.copy(this.originBuffer.getPosition()),t.copy(this.targetBuffer.getPosition()),r=!0),r&&(this.laser.position.copy(e),this.laser.lookAt(t),this.laser.scale.set(1,1,e.distanceTo(t)),this.laser.matrixNeedsUpdate=!0,this.laserTip.position.copy(t),this.laserTip.matrixNeedsUpdate=!0),this.laser.material.visible!==r&&(this.laser.material.visible=r);const o=!!r&&!(i&&this.data.laserVisible);this.laserTip.material.visible!==o&&(this.laserTip.material.visible=o)}})(),remove(){this.el.sceneEl.removeObject3D("pen-laser-".concat(this.laser.uuid)),this.el.sceneEl.removeObject3D("pen-laser-tip-".concat(this.laser.uuid))}});class aR{constructor(e,t){this.material=e,this.maxBufferSize=t,this.geometries=[],this.current=null,this.drawing=new THREE.Object3D,this.addBuffer()}remove(e,t){if(this.idx.position>t.position)for(const n in this.idx){const a="index"===n?1:3;let i=e[n]*a;const r=(t[n]+1)*a,o=this.idx[n]*a;for(let e=r;e<o;e++)"index"===n?this.current.index.array[i++]=this.current.index.array[e]-t.position-1:this.current.attributes[n].array[i++]=this.current.attributes[n].array[e];const s=t[n]-e[n]+1;this.idx[n]-=s}else for(const n in this.idx){const a=t[n]-e[n];this.idx[n]-=a}this.update()}undo(e){this.idx=e,this.update()}addBuffer(){const e=new THREE.BufferGeometry,t=new Float32Array(3*this.maxBufferSize),n=new Float32Array(3*this.maxBufferSize),a=new Float32Array(3*this.maxBufferSize),i=new Uint32Array(3*this.maxBufferSize),r=new THREE.Mesh(e,this.material);r.frustumCulled=!1,r.vertices=t;const o=new THREE.Object3D;this.drawing.add(o),o.add(r),e.setDrawRange(0,0),e.setAttribute("position",new THREE.BufferAttribute(t,3).setUsage(THREE.DynamicDrawUsage)),e.setAttribute("normal",new THREE.BufferAttribute(n,3).setUsage(THREE.DynamicDrawUsage)),e.setAttribute("color",new THREE.BufferAttribute(a,3).setUsage(THREE.DynamicDrawUsage)),e.setIndex(new THREE.BufferAttribute(i,1).setUsage(THREE.DynamicDrawUsage)),this.previous=null,this.geometries.length>0&&(this.previous=this.current),this.idx={position:0,normal:0,color:0,index:0},this.geometries.push(e),this.current=e}addColor(e,t,n){this.current.attributes.color.setXYZ(this.idx.color++,e,t,n)}addNormal(e,t,n){this.current.attributes.normal.setXYZ(this.idx.normal++,e,t,n)}addVertex(e,t,n){const a=this.current.attributes.position;this.idx.position===a.count&&console.error("maxBufferSize limit exceeded"),a.setXYZ(this.idx.position++,e,t,n)}addIndex(e,t,n){this.current.index.setXYZ(this.idx.index,e,t,n),this.idx.index+=3}update(){this.current.setDrawRange(0,this.idx.index),this.current.attributes.color.needsUpdate=!0,this.current.attributes.normal.needsUpdate=!0,this.current.attributes.position.needsUpdate=!0,this.current.index.needsUpdate=!0}computeBoundingSpheres(){for(let e=0;e<this.geometries.length;e++)this.geometries[e].computeBoundingSphere()}}class iR{constructor(){this.sharedBuffers={}}addSharedBuffer(e,t,n){this.sharedBuffers[e]=new aR(t,n)}getSharedBuffer(e){return this.sharedBuffers[e]}}var rR=n(823);function oR(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function sR(e,t,n,a){let i=n-1,r=-1;for(;i+1<=a;)t[++r]=e[++i]}AFRAME.registerComponent("networked-drawing",{schema:{segments:{default:8},defaultRadius:{default:.01},maxDrawTimeout:{default:6e5},maxLines:{default:50},maxPointsPerLine:{default:250}},init(){this._receiveData=this._receiveData.bind(this),this.networkBuffer=[],this.sendNetworkBufferQueue=[],this.drawStarted=!1,this.lineStarted=!1,this.remoteLineStarted=!1,this.receivedBufferParts=0,this.bufferIndex=0,this.connectedToOwner=!1,this.networkBufferInitialized=!1;const e={vertexColors:THREE.VertexColors};this.color=new THREE.Color,this.radius=this.data.defaultRadius,this.segments=this.data.segments;let t=new THREE.MeshStandardMaterial(e);const n=window.APP.store.state.preferences.materialQualitySetting;t=Object(Bt.a)(t,n),this.sharedBufferGeometryManager=new iR;const a=Math.round(20*this.data.maxPointsPerLine*(this.data.maxLines+1)*.333);this.sharedBufferGeometryManager.addSharedBuffer(0,t,a),this.lastPoint=new THREE.Vector3,this.lastSegments=[],this.currentSegments=[];for(let e=0;e<this.segments;e++)this.lastSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3},this.currentSegments[e]={position:new THREE.Vector3,normal:new THREE.Vector3};this.sharedBuffer=this.sharedBufferGeometryManager.getSharedBuffer(0),this.drawing=this.sharedBuffer.drawing,this.el.setObject3D("mesh",this.drawing),this.prevIdx=Object.assign({},this.sharedBuffer.idx),this.idx=Object.assign({},this.sharedBuffer.idx),this.vertexCount=0,this.indexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.invalidPointRead=!1,this.lastReadPointCount=0,this.networkBufferHistory=[],NAF.connection.onConnect(()=>{NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.networkId=NAF.utils.getNetworkId(this.networkedEl),this.drawingId="drawing-"+this.networkId,NAF.connection.subscribeToDataChannel(this.drawingId,this._receiveData)})})},play(){AFRAME.scenes[0].systems["hubs-systems"].drawingMenuSystem.registerDrawingMenu(this.el)},remove(){NAF.connection.unsubscribeToDataChannel(this.drawingId,this._receiveData),this.drawStarted=!1,this.el.removeObject3D("mesh");this.el.sceneEl.querySelector("#drawing-manager").components["drawing-manager"].destroyDrawing(this),AFRAME.scenes[0].systems["hubs-systems"].drawingMenuSystem.unregisterDrawingMenu(this.el)},tick(e){const t=NAF.connection.isConnected()&&this.networkedEl,n=t&&NAF.utils.isMine(this.networkedEl);if(!this.connectedToOwner&&t){const e=NAF.utils.getNetworkOwner(this.networkedEl);!n&&NAF.connection.hasActiveDataChannel(e)&&(NAF.connection.sendDataGuaranteed(e,this.drawingId,{type:0,clientId:NAF.clientId}),this.connectedToOwner=!0)}if(this.networkBuffer.length>0&&t&&(n?this.bufferIndex<this.networkBuffer.length&&this._broadcastDrawing():this._drawFromNetwork()),n&&this.sendNetworkBufferQueue.length>0){const e=[];for(let t=0;t<this.sendNetworkBufferQueue.length;t++)NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[t])&&e.push(this.sendNetworkBufferQueue[t]);for(let t=0;t<e.length;t++){const n=this.sendNetworkBufferQueue.indexOf(e[t]);this._sendNetworkBuffer(e[t]),this.sendNetworkBufferQueue.splice(n,1)}}this._deleteExpiredLines(e)},cloneMesh(e){const t=e.current,n=e.idx,a=new THREE.BufferGeometry,i=t.getAttribute("position").array.subarray(0,3*n.position),r=t.getAttribute("color").array.subarray(0,3*n.color),o=t.getAttribute("normal").array.subarray(0,3*n.normal),s=t.index.array.subarray(0,n.index);a.setAttribute("position",new THREE.BufferAttribute(i,3)),a.setAttribute("color",new THREE.BufferAttribute(r,3)),a.setAttribute("normal",new THREE.BufferAttribute(o,3)),a.setIndex(new THREE.BufferAttribute(s,1));const l=new THREE.MeshStandardMaterial({vertexColors:THREE.VertexColors});return new THREE.Mesh(a,l)},serializeDrawing(){var e,t=this;return(e=function*(){const e=new rR.a,n=t.cloneMesh(t.sharedBuffer);n.userData.gltfExtensions={MOZ_hubs_components:{version:4,"networked-drawing-buffer":{buffer:t.networkBuffer}}};const a=yield new Promise(t=>{e.parse(n,t,{binary:!0,includeCustomExtensions:!0})}),i=new File([a],"drawing.glb",{type:"model/gltf-binary"}),{entity:r}=Object(te.c)(i,"#interactable-media",ta.a.FILE,"drawing",!1,!1),o=new THREE.Vector3(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new THREE.Vector3(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),l=new THREE.Vector3,c=t.sharedBuffer.current.attributes.position;for(let e=0;e<t.sharedBuffer.idx.position;e++)l.set(c.getX(e),c.getY(e),c.getZ(e)),o.min(l),s.max(l);r.object3D.position.addVectors(o,s).multiplyScalar(.5),r.object3D.matrixNeedsUpdate=!0},function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){oR(r,a,i,o,s,"next",e)}function s(e){oR(r,a,i,o,s,"throw",e)}o(void 0)}))})()},deserializeDrawing:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(a){let i=a[0];for("-"===i&&(this._undoDraw(),a.shift(),i=a[0]);null!=i&&a.length>=11;)e.set(a[1],a[2],a[3]),t.set(a[4],a[5],a[6]),this.radius=Math.round(1e3*t.length())/1e3,t.normalize(),n.set(a[7],a[8],a[9]),this.color.setHex(Math.round(n.length())-1),n.normalize(),a.splice(0,10),this.drawStarted?null!==a[0]&&this.draw(e,t,n):this.startDraw(e,t,n),null===a[0]&&(this.endDraw(e,t,n),a.shift())}})(),_broadcastDrawing:(()=>{const e=[];return function(){e.length=0,sR(this.networkBuffer,e,this.bufferIndex,this.networkBuffer.length-1);let t=-1;for(;-1!=(t=this.networkBuffer.indexOf("-"));)this.networkBuffer.splice(t,1);this.bufferIndex=this.networkBuffer.length,NAF.connection.broadcastDataGuaranteed(this.drawingId,{type:1,buffer:e})}})(),_drawFromNetwork:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(){let a=this.networkBuffer[0];"-"===a&&(this._undoDraw(),this.networkBuffer.shift(),a=this.networkBuffer[0]);let i=!1;for(;null!=a&&this.networkBuffer.length>=11;){const a=this.networkBuffer[0];a!==this.lastReadPointCount+1&&(this.invalidPointRead=!0,console.error("Draw networking error: ID ".concat(this.drawingId," expected point ").concat(this.lastReadPointCount+1," but received ").concat(a))),this.lastReadPointCount=a,e.set(this.networkBuffer[1],this.networkBuffer[2],this.networkBuffer[3]),t.set(this.networkBuffer[4],this.networkBuffer[5],this.networkBuffer[6]),this.radius=Math.round(1e3*t.length())/1e3,t.normalize(),n.set(this.networkBuffer[7],this.networkBuffer[8],this.networkBuffer[9]),this.color.setHex(Math.round(n.length())-1),n.normalize(),this.networkBuffer.splice(0,10),this.remoteLineStarted||(this.startDraw(e,t,n),this.remoteLineStarted=!0),null===this.networkBuffer[0]?(this.invalidPointRead||this._endDraw(e,t,n),this.remoteLineStarted=!1,this.networkBuffer.shift(),this.lastReadPointCount=0,this.invalidPointRead=!1):this.invalidPointRead||(this._draw(e,t,n),i=!0)}i&&this._updateBuffer()}})(),_deleteExpiredLines(e){const t=this.networkBufferHistory.length;if(t>0){const n=this.networkBufferHistory[0].time;if(t>this.data.maxLines||n+this.data.maxDrawTimeout<=e){const e=this.networkBufferHistory[0];this.idx.position=e.vertexCount,this.idx.normal=e.vertexCount,this.idx.color=e.vertexCount,this.idx.index=e.indexCount,this.sharedBuffer.remove(this.prevIdx,this.idx),this.networkBufferHistory.shift(),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(0,e.networkBufferCount),this.bufferIndex-=e.networkBufferCount)}}},_sendNetworkBuffer:(()=>{const e=[];return function(t){if(NAF.utils.isMine(this.networkedEl))if(this.networkBuffer.length<=3e3)NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:1,buffer:this.networkBuffer});else{let n=0,a=0;for(;a<this.networkBuffer.length;)a=Math.min(a+3e3,this.networkBuffer.length),e.length=0,sR(this.networkBuffer,e,n,a-1),n=a,NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:Math.ceil(this.networkBuffer.length/3e3),buffer:e})}}})(),_receiveData(e,t,n){switch(n.type){case 0:this.sendNetworkBufferQueue.push(n.clientId);break;case 1:this.networkBufferInitialized&&this.networkBuffer.push.apply(this.networkBuffer,n.buffer);break;case 2:this.networkBuffer.push.apply(this.networkBuffer,n.buffer),++this.receivedBufferParts>=n.parts&&(this.networkBufferInitialized=!0)}},getLastPoint(){return this.lastPoint},startDraw(e,t,n,a,i){NAF.connection.isConnected()&&(this.drawStarted=!0,a&&this.color.set(a),i&&(this.radius=i),this.lastPoint.copy(e),this._addToNetworkBuffer(e,t,n))},draw(e,t,n,a,i){NAF.connection.isConnected()&&this.drawStarted&&(a&&a!="#"+this.color.getHexString().toUpperCase()&&this.color.set(a),i&&(this.radius=i),this._addToNetworkBuffer(e,t,n),this._draw(e,t,n),this._updateBuffer())},_draw:(()=>{const e=new THREE.Vector3;return function(t,n,a,i=1){if(this.lineStarted)this._generateSegments(this.currentSegments,t,n,a,this.radius*i),this._drawCylinder(),this.currentPointCount>this.data.maxPointsPerLine&&(this._drawProjectedEndCap(t,n),this._endLine());else{this._generateSegments(this.lastSegments,t,n,a,this.radius*i),e.copy(n).negate();for(let t=0;t<this.segments;t++)this.lastSegments[t].normal.add(e).multiplyScalar(.5);this._drawStartCap(this.lastPoint,this.lastSegments,e),this.lineStarted=!0}this.lastPoint.copy(t)}})(),undoDraw(){NAF.connection.isConnected()&&!this.drawStarted&&(this._undoDraw(),this._pushToNetworkBuffer("-"))},_undoDraw(){const e=this.networkBufferHistory.length;if(e>0){const t=this.networkBufferHistory.pop();this.idx.position=0,this.idx.normal=0,this.idx.color=0,this.idx.index=0,e>1&&(this.idx.position=this.sharedBuffer.idx.position-t.vertexCount-1,this.idx.normal=this.sharedBuffer.idx.normal-t.vertexCount-1,this.idx.color=this.sharedBuffer.idx.color-t.vertexCount-1,this.idx.index=this.sharedBuffer.idx.index-t.indexCount-1),this.sharedBuffer.remove(this.idx,this.sharedBuffer.idx),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(this.networkBuffer.length-t.networkBufferCount,t.networkBufferCount),this.bufferIndex-=t.networkBufferCount)}},endDraw(e,t,n){this._endDraw(e,t,n),this._updateBuffer()},_endDraw(e,t,n){!this.lineStarted&&this.drawStarted?this._drawPoint(e):this.lineStarted&&this.drawStarted&&(this._addToNetworkBuffer(e,t,n),this._draw(e,t,n),this._drawProjectedEndCap(e,t)),this._endLine()},_drawProjectedEndCap:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a){this.lineStarted&&this.drawStarted&&(e.copy(a).multiplyScalar(this.radius),t.copy(n).add(e),this._drawEndCap(t,a))}})(),_endLine(){if(!this.drawStarted)return;this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this._pushToNetworkBuffer(null);const e={networkBufferCount:this.networkBufferCount,vertexCount:this.vertexCount-1,indexCount:this.indexCount-1,time:1e3*this.el.sceneEl.clock.elapsedTime};this.networkBufferHistory.push(e),this.vertexCount=0,this.indexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.lineStarted=!1,this.drawStarted=!1,this.sharedBuffer.computeBoundingSpheres()},_addToNetworkBuffer:(()=>{const e=new THREE.Vector3,t=new THREE.Vector3;return function(n,a,i){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(++this.currentPointCount,this._pushToNetworkBuffer(this.currentPointCount),this._pushToNetworkBuffer(n.x),this._pushToNetworkBuffer(n.y),this._pushToNetworkBuffer(n.z),e.copy(a),e.setLength(this.radius),this._pushToNetworkBuffer(e.x),this._pushToNetworkBuffer(e.y),this._pushToNetworkBuffer(e.z),t.copy(i),t.setLength(this.color.getHex()+1),this._pushToNetworkBuffer(t.x),this._pushToNetworkBuffer(t.y),this._pushToNetworkBuffer(t.z))}})(),_pushToNetworkBuffer(e){"-"!==e&&++this.networkBufferCount,this.networkBuffer.push(e)},_drawCylinder(){for(let e=0;e<this.segments;e++)this.currentSegments[e].normal.add(this.lastSegments[e].normal).multiplyScalar(.5);for(let e=0;e<this.segments;e++)this._addVertex(this.currentSegments[e]);const e=this.sharedBuffer.idx.position;for(let t=0;t<this.segments;t++){const n=e-(this.segments+(this.segments-t)),a=t+1<this.segments?n+1:e-2*this.segments,i=e-(this.segments-t),r=t+1<this.segments?i+1:e-this.segments;this._addIndex(i,n,a),this._addIndex(i,a,r)}for(let e=0;e<this.segments;e++)this.lastSegments[e].position.copy(this.currentSegments[e].position),this.lastSegments[e].normal.copy(this.currentSegments[e].normal)},_drawPoint:(()=>{const e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,-1,0),n=new THREE.Vector3(1,0,0),a=new THREE.Vector3,i=new THREE.Vector3;return function(r){a.copy(e).multiplyScalar(.75*this.radius),i.copy(r).add(a),this.lastPoint.copy(i),a.copy(e).multiplyScalar(.5*this.radius),i.copy(r).add(a),this._draw(i,t,n,.75),this._draw(r,t,n),a.copy(t).multiplyScalar(.5*this.radius),i.copy(r).add(a),this._draw(i,t,n,.75),a.copy(t).multiplyScalar(.75*this.radius),i.copy(r).add(a),this._drawEndCap(i,t)}})(),_drawStartCap(e,t,n){this._addVertex({position:e,normal:n});for(let e=0;e<this.segments;e++)this._addVertex(t[e]);const a=this.sharedBuffer.idx.position,i=a-this.segments-1;for(let e=0;e<this.segments;e++){const t=a-(this.segments-e),n=e+1<this.segments?t+1:a-this.segments;this._addIndex(i,n,t)}},_drawEndCap(e,t){this._addVertex({position:e,normal:t});const n=this.sharedBuffer.idx.position,a=n-1;for(let e=0;e<this.segments;e++){const t=n-(this.segments-e)-1,i=e+1<this.segments?t+1:n-this.segments-1;this._addIndex(a,t,i)}},_updateBuffer(){this.sharedBuffer.update()},_addVertex(e){const t=e.position,n=e.normal;this.sharedBuffer.addVertex(t.x,t.y,t.z),this.sharedBuffer.addColor(this.color.r,this.color.g,this.color.b),n?this.sharedBuffer.addNormal(n.x,n.y,n.z):++this.sharedBuffer.idx.normal,++this.vertexCount},_addIndex(e,t,n){this.sharedBuffer.addIndex(e,t,n),this.indexCount+=3},_generateSegments(e,t,n,a,i){const r=2*Math.PI/this.segments;for(let o=0;o<this.segments;o++){const s=e[o].position;this._rotatePointAroundAxis(s,t,n,a,r*o,i),e[o].normal.subVectors(s,t).normalize()}},_rotatePointAroundAxis:(()=>{const e=new THREE.Vector3;return function(t,n,a,i,r,o){e.copy(i),e.applyAxisAngle(a,r),t.copy(n).add(e.normalize().multiplyScalar(o))}})()}),AFRAME.registerComponent("networked-drawing-buffer",{schema:{buffer:{default:[]}},play(){const e=this._getDeserializeButton(this.el.parentEl);e&&(e.object3D.visible=!0,e.components["deserialize-drawing-button"].networkedDrawingBuffer=this)},_getDeserializeButton(e){return e.classList.contains("interactable")?e.querySelector(".deserialize-drawing"):e.parentEl?this._getDeserializeButton(e.parentEl):null}}),AFRAME.registerComponent("deserialize-drawing-button",{init(){const e=this.el.sceneEl.querySelector("#drawing-manager").components["drawing-manager"];this.networkedDrawingBuffer=null,this.onClick=()=>{if(!NAF.utils.isMine(this.targetEl)&&!NAF.utils.takeOwnership(this.targetEl))return;const t=()=>{e.drawing.deserializeDrawing(this.networkedDrawingBuffer.data.buffer),Object(te.d)(e.drawing.el.object3DMap.mesh,{x:.001,y:.001,z:.001}),this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned&&window.APP.pinningHelper.setPinned(this.targetEl,!1),this.targetEl.parentEl.removeChild(this.targetEl),this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(Q.j)};e.drawing?e.drawing.serializeDrawing().then(()=>{e.drawing.el.parentEl.removeChild(e.drawing.el),e.destroyDrawing(e.drawing),e.createDrawing().then(t)}):e.createDrawing().then(t)},this._updateUI=this._updateUI.bind(this),this._updateUIOnStateChange=this._updateUIOnStateChange.bind(this),this.el.sceneEl.addEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.addEventListener("stateremoved",this._updateUIOnStateChange),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.targetEl=e,this._updateUI(),this.targetEl.addEventListener("pinned",this._updateUI),this.targetEl.addEventListener("unpinned",this._updateUI)})},play(){this.el.object3D.addEventListener("interact",this.onClick)},pause(){this.el.object3D.removeEventListener("interact",this.onClick)},remove(){this.el.sceneEl.removeEventListener("stateadded",this._updateUIOnStateChange),this.el.sceneEl.removeEventListener("stateremoved",this._updateUIOnStateChange),this.targetEl&&(this.targetEl.removeEventListener("pinned",this._updateUI),this.targetEl.removeEventListener("unpinned",this._updateUI))},_updateUIOnStateChange(e){"frozen"===e.detail&&this._updateUI()},_updateUI(){if(this.networkedDrawingBuffer){const e=this.targetEl.components.pinnable&&this.targetEl.components.pinnable.data.pinned,t=window.APP.hubChannel.can("pin_objects")&&window.APP.hubChannel.signedIn;this.el.object3D.visible=(!e||t)&&window.APP.hubChannel.can("spawn_drawing")}else this.el.object3D.visible=!1}});n(1543);const lR=SO.b.ACTIVATION_STATE,cR=SO.b.TYPE,dR=[lR.ACTIVE_TAG,lR.ISLAND_SLEEPING,lR.WANTS_DEACTIVATION,lR.DISABLE_DEACTIVATION,lR.DISABLE_SIMULATION];AFRAME.registerComponent("body-helper",{schema:{loadedEvent:{default:""},mass:{default:1},gravity:{type:"vec3",default:{x:0,y:-9.8,z:0}},linearDamping:{default:.01},angularDamping:{default:.01},linearSleepingThreshold:{default:1.6},angularSleepingThreshold:{default:2.5},angularFactor:{type:"vec3",default:{x:1,y:1,z:1}},activationState:{default:lR.ACTIVE_TAG,oneOf:dR},type:{default:"dynamic",oneOf:[cR.STATIC,cR.DYNAMIC,cR.KINEMATIC]},emitCollisionEvents:{default:!1},disableCollision:{default:!1},collisionFilterGroup:{default:1},collisionFilterMask:{default:1},scaleAutoUpdate:{default:!0}},init:function(){this.system=this.el.sceneEl.systems["hubs-systems"].physicsSystem,this.alive=!0,this.uuid=-1,this.system.registerBodyHelper(this)},init2:function(){this.el.object3D.updateMatrices(),this.uuid=this.system.addBody(this.el.object3D,this.data)},update:function(e){null!==e&&-1!==this.uuid&&this.system.updateBody(this.uuid,this.data)},remove:function(){-1!==this.uuid&&this.system.removeBody(this.uuid),this.alive=!1}}),AFRAME.registerComponent("shape-helper",{schema:{type:{default:De.SHAPE.HULL,oneOf:[De.SHAPE.BOX,De.SHAPE.CYLINDER,De.SHAPE.SPHERE,De.SHAPE.CAPSULE,De.SHAPE.CONE,De.SHAPE.HULL,De.SHAPE.HACD,De.SHAPE.VHACD,De.SHAPE.MESH,De.SHAPE.HEIGHTFIELD]},fit:{default:De.FIT.ALL,oneOf:[De.FIT.ALL,De.FIT.MANUAL]},halfExtents:{type:"vec3",default:{x:1,y:1,z:1}},minHalfExtent:{default:0},maxHalfExtent:{default:Number.POSITIVE_INFINITY},sphereRadius:{default:NaN},cylinderAxis:{default:"y",oneOf:["x","y","z"]},margin:{default:.01},offset:{type:"vec3",default:{x:0,y:0,z:0}},orientation:{type:"vec4",default:{x:0,y:0,z:0,w:1}},heightfieldData:{default:[]},heightfieldDistance:{default:1},includeInvisible:{default:!1}},multiple:!0,init:function(){this.system=this.el.sceneEl.systems["hubs-systems"].physicsSystem,this.alive=!0,this.uuid=-1,this.system.registerShapeHelper(this)},init2:function(){this.mesh=null;let e=this.el;for(this.bodyHelper=e.components["body-helper"]||null;!this.bodyHelper&&e.parentNode!=this.el.sceneEl;)e=e.parentNode,e.components["body-helper"]&&(this.bodyHelper=e.components["body-helper"]);if(this.bodyHelper&&null!==this.bodyHelper.uuid&&void 0!==this.bodyHelper.uuid){if(this.data.fit===De.FIT.ALL){if(!this.el.object3DMap.mesh)return void console.error("Cannot use FIT.ALL without object3DMap.mesh");this.mesh=this.el.object3DMap.mesh,this.mesh.updateMatrices()}this.uuid=this.system.addShapes(this.bodyHelper.uuid,this.mesh,this.data)}else console.warn("body not found")},remove:function(){-1!==this.uuid&&this.system.removeShapes(this.bodyHelper.uuid,this.uuid),this.alive=!1}});var uR=function(){const e=e=>()=>{let t=null;return n=>null===t?(t=new THREE.Vector3(n.x,n.y,n.z),!0):!NAF.utils.almostEqualVec3(t,n,e)&&(t.copy(n),!0)};NAF.schemas.add({template:"#remote-avatar",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"player-info","networked-avatar",{selector:".camera",component:"position",requiresNetworkUpdate:e(.001)},{selector:".camera",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".left-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"visible"},{selector:".right-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".right-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".right-controller",component:"visible"}]}),NAF.schemas.add({template:"#interactable-media",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pdf",property:"index"},"pinnable"],nonAuthorizedComponents:[{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"}]}),NAF.schemas.add({template:"#interactable-emoji",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"emoji",property:"emitEndTime"},{component:"emoji",property:"particleEmitterConfig"},{component:"scale",requiresNetworkUpdate:e(.001)},"media-loader","pinnable",{selector:".particle-emitter",component:"particle-emitter"}]}),NAF.schemas.add({template:"#interactable-media-frame",components:[{component:"media-frame",property:"targetId"},{component:"media-frame",property:"originalTargetScale"}],nonAuthorizedComponents:["media-frame"]}),NAF.schemas.add({template:"#static-media",components:["media-loader",{component:"media-video",property:"time"}],nonAuthorizedComponents:[{component:"media-video",property:"time"}]}),NAF.schemas.add({template:"#static-controlled-media",components:["media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pdf",property:"index"}],nonAuthorizedComponents:[{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"},{component:"media-pager",property:"index"}]}),NAF.schemas.add({template:"#interactable-drawing",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"networked-drawing"]}),NAF.schemas.add({template:"#interactable-camera",components:["position","rotation",{component:"camera-tool",property:"isSnapping"},{component:"camera-tool",property:"isRecording"},{component:"camera-tool",property:"label"}]}),NAF.schemas.add({template:"#template-waypoint-avatar",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"waypoint"],nonAuthorizedComponents:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},"waypoint"]}),NAF.schemas.add({template:"#interactable-pen",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},{component:"scale",requiresNetworkUpdate:e(.001)},{selector:"#pen",component:"pen",property:"radius"},{selector:"#pen",component:"pen",property:"color"},{selector:"#pen",component:"pen",property:"drawMode"},{selector:"#pen",component:"pen",property:"penVisible"},{selector:"#pen",component:"pen-laser",property:"laserVisible"},{selector:"#pen",component:"pen-laser",property:"remoteLaserOrigin",requiresNetworkUpdate:e(.001)},{selector:"#pen",component:"pen-laser",property:"laserTarget",requiresNetworkUpdate:e(.001)}]})},hR=n(86);var pR=n(63),mR=n(824),fR=n.n(mR),gR=n(321);function vR(){return(vR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function bR(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const yR={discord:"Discord",slack:"Slack"};function ER(e){let{provider:t,redirectUrl:n,termsUrl:a,privacyUrl:i}=e,r=bR(e,["provider","redirectUrl","termsUrl","privacyUrl"]);return Hi.a.createElement("div",vR({className:fR.a.oauthScreen},r),Hi.a.createElement(zr.a,{title:Hi.a.createElement(Yi.a,{id:"oauth-screen.title",defaultMessage:"Sign In To Continue"})},Hi.a.createElement(Hr.a,{center:!0,padding:!0},Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"oauth-screen.description",defaultMessage:"You'll need to sign in to {provider} to access this room.",values:{provider:yR[t]}})),Hi.a.createElement("p",null,Hi.a.createElement(Yi.a,{id:"oauth-screen.email-reason",defaultMessage:"We'll ask for access to your e-mail address so you can skip signing in next time."})),Hi.a.createElement("p",null,Hi.a.createElement("small",null,Hi.a.createElement(gR.a,{termsUrl:a,privacyUrl:i}))),Hi.a.createElement(jr.c,{as:"a",href:n,preset:"discord"===t?"accent5":"accent4"},Hi.a.createElement(Yi.a,{id:"oauth-screen.sign-in-button",defaultMessage:"Sign Into {provider}",values:{provider:yR[t]}})))))}function wR({oauthInfo:e}){const{url:t,type:n}=e[0];return Hi.a.createElement(ER,{provider:n,redirectUrl:t,termsUrl:a.a.feature("show_terms")&&a.a.link("terms_of_use","https://github.com/mozilla/hubs/blob/master/TERMS.md"),privacyUrl:a.a.feature("show_privacy")&&a.a.link("privacy_notice","https://github.com/mozilla/hubs/blob/master/PRIVACY.md")})}function _R(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function SR(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){_R(r,a,i,o,s,"next",e)}function s(e){_R(r,a,i,o,s,"throw",e)}o(void 0)}))}}function xR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){AR(e,t,n[t])}))}return e}function AR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ER.propTypes={provider:Ui.a.string.isRequired,redirectUrl:Ui.a.string.isRequired,termsUrl:Ui.a.string,privacyUrl:Ui.a.string},wR.propTypes={oauthInfo:Ui.a.array},console.log("App version: ".concat(a.a.IS_LOCAL_OR_CUSTOM_CLIENT?"Custom client or local client (undeploy custom client to run build ".concat("1.0.0.20220616041622",")"):"1.0.0.20220616041622")),THREE.Cache.enabled=!1,Object(h.b)(),n(662),window.APP=new UP.a,window.APP.dialog=new z,window.APP.RENDER_ORDER={HUD_BACKGROUND:1,HUD_ICONS:2,CURSOR:3};const MR=window.APP.store;MR.update({preferences:{shouldPromptForRefresh:!1}});const kR=window.APP.mediaSearchStore,OR=new URLSearchParams(location.search),CR=AFRAME.utils.device.isMobile(),PR=AFRAME.utils.device.isMobileVR(),RR=window.self!==window.top;if(RR&&!OR.get("embed_token"))throw new Error("no embed token");THREE.Object3D.DefaultMatrixAutoUpdate=!1;NAF.options.firstSyncSource="phx-reliable",NAF.options.syncSource="phx-reliable";let TR=!1;try{window.opener&&window.opener.doingTwitterOAuth&&(window.opener.postMessage("oauth-successful"),TR=!0,window.close())}catch(e){console.error("Exception in oauth processing code",e)}const jR=Object(mt.a)("bot"),DR=Object(mt.a)("disable_telemetry"),IR=Object(mt.a)("debug");jR||DR||Object(hR.a)("/hub","Room Landing Page"),Object(xE.a)(),TR||function(e="global"){const t="___concurrent_load_detector_".concat(e);localStorage.setItem(t,JSON.stringify({started_at:new Date}));const n=e=>{e.key===t&&(window.dispatchEvent(new CustomEvent("concurrentload")),window.removeEventListener("storage",n))};window.addEventListener("storage",n)}();let LR={},HR=document.location.pathname.split("/").slice(0,2).join("/");document.location.pathname.includes("hub.html")&&(HR="/");const NR="/"===HR?Object(Fi.b)():Object(Fi.a)({basename:HR});window.APP.history=NR;const FR=OR.get("vr_entry_type");function VR(e){LR=xR({},LR,e),function(e={}){const t=document.querySelector("a-scene"),n=Object(mt.a)("allow_idle")||!1,a=FR;Ii.a.render(Hi.a.createElement(pR.a,null,Hi.a.createElement(Bs.a,{store:MR},Hi.a.createElement(Ni.b,{history:NR},Hi.a.createElement(Ni.a,{render:i=>e.showOAuthScreen?Hi.a.createElement(wR,{oauthInfo:e.oauthInfo}):e.roomUnavailableReason?Hi.a.createElement(uE,{reason:e.roomUnavailableReason}):Hi.a.createElement(dE,xR({scene:t,isBotMode:jR,disableAutoExitOnIdle:n,forcedVREntryType:a,store:MR,mediaSearchStore:kR},e,i))})))),document.getElementById("ui-root"))}(LR)}function BR(e){return UR.apply(this,arguments)}function UR(){return(UR=SR((function*(e){var t;let n,a;if(e.scene)a=!1,n=e.scene.model_url;else if(null===e.scene)n=c.a;else{const t=e.topics[0],i=t.assets.find(e=>"glb"===e.asset_type),r=t.assets.find(e=>"gltf_bundle"===e.asset_type);n=(i||r).src||c.a;const o=/\.gltf/i.test(n)||/\.glb/i.test(n);a=!(i||o)}if(Object(mt.a)("debugLocalScene")&&(null===(t=n)||void 0===t?void 0:t.startsWith("blob:")))n=document.querySelector("a-scene").is("entered")?n:c.a;else if(a){const e=yield fetch(n),t=yield e.json(),a=new URL(THREE.LoaderUtils.extractUrlBase(n),window.location.href);n=new URL(t.assets[0].src,a).href}else n=Object(Ut.j)(n);return n}))).apply(this,arguments)}function zR(e,t){return WR.apply(this,arguments)}function WR(){return(WR=SR((function*(e,t){console.log("Updating environment for hub");const n=yield BR(e),a=()=>{VR({roomUnavailableReason:ey.sceneError}),t.exitScene()},i=document.querySelector("#environment-scene"),r=document.querySelector("a-scene"),o=r.systems["hubs-systems"].environmentSystem;console.log("Scene URL: ".concat(n));const s=performance.now();let l=null;if(0===i.childNodes.length){const e=document.createElement("a-entity");e.addEventListener("model-loaded",()=>{e.removeEventListener("model-error",a),console.log("Scene file initial load took ".concat(Math.round(performance.now()-s),"ms")),document.querySelector(".a-canvas").classList.remove("a-hidden"),r.addState("visible"),o.updateEnvironment(e),kE(e)},{once:!0}),e.addEventListener("model-error",a,{once:!0}),e.setAttribute("gltf-model-plus",{src:n,useCache:!1,inflate:!0}),i.appendChild(e)}else{l=i.childNodes[0],THREE.Cache.clear();const e=r.systems["hubs-systems"].waypointSystem;e.releaseAnyOccupiedWaypoints(),l.addEventListener("model-loaded",()=>{l.addEventListener("model-loaded",()=>{l.removeEventListener("model-error",a),o.updateEnvironment(l),console.log("Scene file update load took ".concat(Math.round(performance.now()-s),"ms")),kE(l),r.is("entered")&&e.moveToSpawnPoint();const t=document.getElementById("viewing-camera").components.fader;setTimeout(()=>t.fadeIn(),2e3)},{once:!0}),r.emit("leaving_loading_environment"),l.components["gltf-model-plus"].data.src===n&&(console.warn("Updating environment to the same url."),l.setAttribute("gltf-model-plus",{src:""})),l.setAttribute("gltf-model-plus",{src:n})},{once:!0}),r.is("entered")||l.addEventListener("model-error",a,{once:!0}),l.components["gltf-model-plus"].data.src===c.a&&(console.warn("Transitioning to loading environment but was already in loading environment."),l.setAttribute("gltf-model-plus",{src:""})),l.setAttribute("gltf-model-plus",{src:c.a})}}))).apply(this,arguments)}function qR(e,t){return GR.apply(this,arguments)}function GR(){return(GR=SR((function*(e,t){VR({hub:e,entryDisallowed:!t.canEnterRoom(e)})}))).apply(this,arguments)}const YR=function(){let e=[],t=0;return{on:(n,a)=>{const i=t++;return e.push({event:n,ref:i,callback:a}),i},off:(t,n)=>{e=e.filter(e=>!(e.event===t&&(void 0===n||n===e.ref)))},trigger:(t,n)=>{e.filter(e=>e.event===t).forEach(e=>{e.callback(n)})},getBindings:()=>e}}();function KR(e,t,n,a,i){const r=document.querySelector("a-scene");if(NAF.connection.isConnected())return r.is("entered")&&t.sendEnteredEvent(),void NAF.connection.entities.completeSync(null,!0);RR&&t.allowNAFTraffic(!1);const o=a.hubs[0];let s=o.embed_token;if(!s){const e=MR.state.embedTokens&&MR.state.embedTokens.find(e=>e.hubId===o.hub_id);e&&(s=e.embedToken)}console.log("Dialog host: ".concat(o.host,":").concat(o.port)),VR({messageDispatch:n,onSendMessage:n.dispatch,onLoaded:()=>MR.executeOnLoadActions(r),onMediaSearchResultEntrySelected:(e,t)=>r.emit("action_selected_media_result_entry",{entry:e,selectAction:t}),onMediaSearchCancelled:e=>r.emit("action_media_search_cancelled",e),onAvatarSaved:e=>r.emit("action_avatar_saved",e),embedToken:s}),r.addEventListener("action_selected_media_result_entry",e=>{const{entry:n,selectAction:a}=e.detail;"scene_listing"!==n.type&&"scene"!==n.type||"use"!==a||t.can("update_hub")&&t.updateScene(n.url)}),r.addEventListener("2d-interstitial-gesture-required",()=>{VR({showInterstitialPrompt:!0,onInterstitialPromptClicked:()=>{VR({showInterstitialPrompt:!1,onInterstitialPromptClicked:null}),r.emit("2d-interstitial-gesture-complete")}})}),r.addEventListener("didConnectToNetworkedScene",()=>{const e=document.querySelector("#objects-scene"),t=Object(m.j)("/".concat(o.hub_id,"/objects.gltf")),n=document.createElement("a-entity");n.setAttribute("gltf-model-plus",{src:t,useCache:!1,inflate:!0}),jR||e.appendChild(n)},{once:!0}),r.setAttribute("networked-scene",{room:o.hub_id,serverURL:"wss://".concat(o.host,":").concat(o.port),debug:!!IR,adapter:"phoenix"}),SR((function*(){for(;!r.components["networked-scene"]||!r.components["networked-scene"].data;)yield Object(_.a)();const n=()=>{console.log("Loading environment and connecting to dialog servers"),zR(o,e),APP.dialog.disconnect(),APP.dialog.connect({serverUrl:"wss://".concat(o.host,":").concat(o.port),roomId:o.hub_id,joinToken:i,serverParams:{host:o.host,port:o.port,turn:o.turn},scene:r,clientId:a.session_id,forceTcp:OR.get("force_tcp"),forceTurn:OR.get("force_turn"),iceTransportPolicy:OR.get("force_tcp")||OR.get("force_turn")?"relay":"all"}),r.addEventListener("adapter-ready",({detail:e})=>{e.hubChannel=t,e.events=YR,e.session_id=a.session_id},{once:!0}),r.components["networked-scene"].connect().then(()=>{r.emit("didConnectToNetworkedScene")}).catch(t=>{!function(e,t){console.error("An error occurred while attempting to connect to networked scene:",t),VR({roomUnavailableReason:t.msg&&t.msg.match(/\bfull\b/i)?ey.full:ey.connectError}),e.exitScene()}(e,t)})};window.APP.hub=o,qR(o,t),r.emit("hub_updated",{hub:o}),RR?(console.log("Page is embedded so environment initialization will be deferred"),VR({onPreloadLoadClicked:()=>{console.log("Preload has been activated"),t.allowNAFTraffic(!0),VR({showPreload:!1}),n()}})):(console.log("Page is not embedded so environment initialization will start immediately"),n())}))()}function XR(){return(XR=SR((function*(e,t){console.log("Running in bot mode...");const n=()=>{};for(e.renderer={setAnimationLoop:n,render:n,shadowMap:{},vr:{isPresenting:()=>!1},setSize:n};!NAF.connection.isConnected();)yield Object(_.a)();t.enterSceneWhenLoaded(!1,!1)}))).apply(this,arguments)}document.addEventListener("DOMContentLoaded",SR((function*(){if(TR)return;yield MR.initProfile();if(document.querySelector(".a-canvas").classList.add("a-hidden"),Object(GP.platformUnsupported)())return;const e=Object(p.detectOS)(navigator.userAgent),t=Object(p.detect)();if(["iOS","Mac OS"].includes(e)&&["safari","ios"].includes(t.name))try{yield navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){return void VR({showSafariMicDialog:!0})}const n=function(){const e=new URLSearchParams(location.search),t=a.a.feature("default_room_id");return e.get("hub_id")||("/"===document.location.pathname&&t?t:document.location.pathname.substring(1).split("/")[0])}();console.log("Hub ID: ".concat(n));!a.a.feature("default_room_id")&&a.a.feature("require_account_for_join")&&!(MR.state.credentials&&MR.state.credentials.token)&&(document.location="/?sign_in&sign_in_destination=hub&sign_in_destination_url=".concat(encodeURIComponent(document.location.toString())));const r=new WE(n);APP.subscriptions=r,r.register();const o=document.querySelector("a-scene");window.APP.scene=o,o.querySelector("#batch-prep").setAttribute("media-image",{batch:!0,src:s.a,contentType:"image/png"});const l=()=>{const e=o.systems["hubs-systems"].physicsSystem;e.setDebug(IR||e.debug)};o.hasLoaded?l():o.addEventListener("loaded",l,{once:!0});(yield Object(it.e)(MR.state.profile.avatarId))||(yield MR.resetToRandomDefaultAvatar());const c=new hE.a(MR),d=new _E(MR,n);window.APP.hubChannel=d;const u=new VE(d,c,NR);window.APP.entryManager=u,APP.dialog.on("dialog-connection-connected",()=>{o.emit("didConnectToDialog")}),APP.dialog.on("dialog-connection-error-fatal",()=>{VR({roomUnavailableReason:ey.connectError}),APP.entryManager.exitScene()});const h=o.systems["hubs-systems"].audioSystem;APP.mediaDevicesManager=new Js(o,MR,h);const g=function(){var e=SR((function*(e,t,n,a){if(e())return t();var i;yield Ra(!0,()=>VR({showSignInDialog:!1})),VR({showSignInDialog:!0,signInMessage:n,onContinueAfterSignIn:(i=SR((function*(){VR({showSignInDialog:!1});let n=null;if(e())try{yield t()}catch(e){n=e}else n=new Error("Predicate failed post sign-in");n&&a&&a(n),ja()})),function(){return i.apply(this,arguments)}),onSignInDialogVisibilityChanged:e=>{VR(e?{showSignInDialog:!0}:{showSignInDialog:!1,onContinueAfterSignIn:null})}})}));return function(t,n,a,i){return e.apply(this,arguments)}}();window.APP.pinningHelper=new qP(d,c,MR,g),window.addEventListener("action_create_avatar",()=>{g(()=>d.signedIn,()=>Object(Vi.e)(NR,"overlay","avatar-editor"),es.b.createAvatar)}),o.addEventListener("scene_media_selected",e=>{const t=e.detail;g(()=>d.can("update_hub"),()=>d.updateScene(t),es.b.changeScene)}),VR({performConditionalSignIn:g,embed:RR,showPreload:RR}),u.performConditionalSignIn=g,u.init();const v=new SE.a(MR);window.dispatchEvent(new CustomEvent("hub_channel_ready"));const b=()=>!(!o.is("vr-mode")||o.is("vr-entered")||PR)&&(console.log("Pre-emptively exiting VR mode."),o.exitVR(),!0);VR({availableVREntryTypes:or,checkingForDeviceAvailability:!0});const y=ir();if(o.addEventListener("enter-vr",()=>{if(b())return!0;PR&&VR({hide:!0}),document.body.classList.add("vr-mode"),y.then(e=>{(CR||PR)&&e.cardboard===Zi||document.body.classList.add("vr-mode-stretch")})}),b(),window.addEventListener("vrdisplaypresentchange",()=>{if(o.is("vr-entered"))return;if(o.is("vr-mode"))return;const e=AFRAME.utils.device.getVRDisplay();e&&e.isPresenting&&(o.is("vr-mode")||(console.warn("Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode."),o.enterVR()))},{once:!0}),o.addEventListener("exit-vr",()=>{document.body.classList.remove("vr-mode"),document.body.classList.remove("vr-mode-stretch"),VR({hide:!1}),/OculusBrowser/i.test(window.navigator.userAgent)&&document.querySelectorAll("[media-video]").forEach(e=>{const t=e.components["media-video"];t&&(t._ignorePauseStateChanges=!0,setTimeout(()=>{const e=t.video;e&&e.paused&&!t.data.videoPaused&&e.play(),t._ignorePauseStateChanges=!1},1e3))})}),uR(),VR({authChannel:c,hubChannel:d,linkChannel:v,subscriptions:r,enterScene:u.enterScene,exitScene:e=>{u.exitScene(),VR({roomUnavailableReason:e||ey.exited})}}),o.addEventListener("leave_room_requested",()=>{u.exitScene(),VR({roomUnavailableReason:ey.left})}),o.addEventListener("hub_closed",()=>{o.exitVR(),u.exitScene(),VR({roomUnavailableReason:ey.closed})}),o.addEventListener("action_camera_recording_started",()=>d.beginRecording()),o.addEventListener("action_camera_recording_ended",()=>d.endRecording()),OR.get("required_version")){const e="1.0.0.20220616041622".split(" ",1)[0];if(OR.get("required_version")!==e)return VR({roomUnavailableReason:ey.versionMismatch}),setTimeout(()=>document.location.reload(),5e3),void u.exitScene()}Object(m.k)().then(e=>{if(console.log("Reticulum @ ".concat(e.phx_host,": v").concat(e.version," on ").concat(e.pool)),OR.get("required_ret_version")&&(OR.get("required_ret_version")!==e.version||OR.get("required_ret_pool")!==e.pool))return VR({roomUnavailableReason:ey.versionMismatch}),setTimeout(()=>document.location.reload(),5e3),void u.exitScene()}),y.then(function(){var e=SR((function*(e){if(PR){if(VR({availableVREntryTypes:e,forcedVREntryType:FR||"vr",checkingForDeviceAvailability:!1}),/Oculus/.test(navigator.userAgent)&&"getVRDisplays"in navigator){const e=yield navigator.getVRDisplays(),t=e.length&&e[0];AFRAME.utils.device.getVRDisplay=()=>t}}else{const t=e.cardboard!==$i||e.generic!==$i||e.daydream!==$i;VR({availableVREntryTypes:e,forcedVREntryType:FR||(t?null:"2d"),checkingForDeviceAvailability:!1})}}));return function(t){return e.apply(this,arguments)}}());const E=document.querySelector("#environment-scene");E.addEventListener("model-loaded",()=>{jR&&function(e,t){XR.apply(this,arguments)}(o,u)},{once:!0}),E.addEventListener("model-loaded",({detail:{model:e}})=>{console.log("Environment scene has loaded"),o.is("entered")||function(){console.log("Setting up lobby camera");const e=document.getElementById("scene-preview-node"),t=document.getElementById("environment-scene").object3D.getObjectByName("scene-preview-camera");if(t)e.object3D.position.copy(t.position),e.object3D.rotation.copy(t.rotation),e.object3D.rotation.reorder("YXZ");else{const t=e.object3D.position;e.object3D.position.set(t.x,2.5,t.z)}e.object3D.matrixNeedsUpdate=!0,e.removeAttribute("scene-preview-camera"),e.setAttribute("scene-preview-camera","positionOnly: true; duration: 60")}(),VR({environmentSceneLoaded:!0}),o.emit("environment-scene-loaded",e),document.querySelectorAll("a-entity[teleporter]").forEach(e=>e.components.teleporter.queryCollisionEntities());for(const e of E.children)Object(S.a)(e)});let w=!1;window.addEventListener("beforeunload",()=>w=!0);const _=yield Object(m.a)(IR);_.onClose(e=>{1e3!==e.code||w||(u.exitScene(),VR({roomUnavailableReason:ey.disconnected}))}),APP.retChannel=_.channel("ret",{hub_id:n}),APP.retChannel.join().receive("ok",e=>{r.setVapidPublicKey(e.vapid_public_key)}).receive("error",e=>{r.setVapidPublicKey(null),console.error(e)});const x=yield r.getCurrentEndpoint();APP.hubChannelParamsForPermsToken=e=>function({permsToken:e,profile:t,pushSubscriptionEndpoint:n,isMobile:a,isMobileVR:i,isEmbed:r,hubInviteId:o,authToken:s}){return{profile:t,push_subscription_endpoint:n,auth_token:s||null,perms_token:e||null,context:{mobile:a||i,embed:r,hmd:i},hub_invite_id:o}}({profile:MR.state.profile,pushSubscriptionEndpoint:x,permsToken:e,isMobile:CR,isMobileVR:PR,isEmbed:RR,hubInviteId:OR.get("hub_invite_id"),authToken:MR.state.credentials&&MR.state.credentials.token});const M=function(){var e=SR((function*({ret_version:e,ret_pool:t},n){console.log("[reconnect] Reticulum deploy detected v".concat(e," on ").concat(t,"."));if(!(yield Object(m.r)({ret_version:e,ret_pool:t},n)))return void console.error("[reconnect] Failed to reconnect. Did not get meta for v".concat(e," on ").concat(t,"."));console.log("[reconnect] Reconnect in progress. Updated reticulum meta.");const a=APP.retChannel.socket,i=yield Object(m.a)(IR,a.params());APP.retChannel=yield Object(m.o)(APP.retChannel,i),yield d.migrateToSocket(i,APP.hubChannelParamsForPermsToken()),c.setSocket(i),v.setSocket(i),yield Object(Ue.a)(1e4),a.teardown(),console.log("[reconnect] Reconnection successful.")}));return function(t,n){return e.apply(this,arguments)}}(),k=function(){let e=null;const t=function(){return!!e},n=function(){let n=!1;return function(){var a=SR((function*(){if(n||!e)return;n=!0;const a=Object.assign({},e);e=null;try{yield M(a,t)}catch{console.error("Failed to migrate to new reticulum server after deploy.",a)}finally{n=!1,i()}}));function i(){return a.apply(this,arguments)}return i}()}();return function(t){e=t,n()}}();APP.retChannel.on("notice",e=>{"ret-deploy"===e.event&&k(e)});const O=new PE(o,u,d,VR,kR);APP.messageDispatch=O,document.getElementById("avatar-rig").messageDispatch=O;const C=A.a.get("ret-oauth-flow-perms-token");C&&A.a.remove("ret-oauth-flow-perms-token");const P=_.channel("hub:".concat(n),APP.hubChannelParamsForPermsToken(C));d.channel=P,d.presence=new f.a(P);const{rawOnJoin:R,rawOnLeave:T}=Object(m.c)(Object(m.q)(YR));d.presence.onJoin(R),d.presence.onLeave(T),d.presence.onSync(()=>{YR.trigger("hub:sync",{presence:d.presence})}),YR.on("hub:join",({key:e,meta:t})=>{o.emit("presence_updated",{sessionId:e,profile:t.profile,roles:t.roles,permissions:t.permissions,streaming:t.streaming,recording:t.recording,hand_raised:t.hand_raised,typing:t.typing})}),YR.on("hub:join",({key:e,meta:t})=>{APP.hideHubPresenceEvents||e===d.channel.socket.params().session_id||d.presence.list().length>30||O.receive({type:"join",presence:t.presence,name:t.profile.displayName})}),YR.on("hub:leave",({meta:e})=>{APP.hideHubPresenceEvents||d.presence.list().length>30||O.receive({type:"leave",name:e.profile.displayName})}),YR.on("hub:change",({key:e,previous:t,current:n})=>{t.presence!==n.presence&&"room"===n.presence&&e!==d.channel.socket.params().session_id&&O.receive({type:"entered",presence:n.presence,name:n.profile.displayName})}),YR.on("hub:change",({previous:e,current:t})=>{e.profile.displayName!==t.profile.displayName&&O.receive({type:"display_name_changed",oldName:e.profile.displayName,newName:t.profile.displayName})}),YR.on("hub:change",({key:e,previous:t,current:n})=>{e===d.channel.socket.params().session_id&&t.profile.avatarId!==n.profile.avatarId&&O.log(Yc.avatarChanged)}),YR.on("hub:change",({key:e,current:t})=>{o.emit("presence_updated",{sessionId:e,profile:t.profile,roles:t.roles,permissions:t.permissions,streaming:t.streaming,recording:t.recording,hand_raised:t.hand_raised,typing:t.typing})});const j={promise:null,resolve:null};YR.on("hub:sync",()=>{j.resolve()}),YR.on("hub:sync",()=>{APP.hideHubPresenceEvents=!1}),YR.on("hub:sync",i),YR.on("hub:sync",({presence:e})=>{!function(e,t){Object.getOwnPropertyNames(e.state).length>1?t.addState("copresent"):t.removeState("copresent")}(e,o)}),YR.on("hub:sync",({presence:e})=>{VR({sessionId:_.params().session_id,presences:e.state,entryDisallowed:!d.canEnterRoom(LR.hub)})}),P.join().receive("ok",function(){var e=SR((function*(e){APP.hideHubPresenceEvents=!0,j.promise=new Promise(e=>{j.resolve=e}),_.params().session_id=e.session_id,_.params().session_token=e.session_token;const t=C||e.perms_token;d.setPermissionsFromToken(t),r.setHubChannel(d),r.setSubscribed(e.subscriptions.web_push),VR({hubIsBound:e.hub_requires_oauth,initialIsFavorited:e.subscriptions.favorites}),yield j.promise,KR(u,d,O,e,t)}));return function(t){return e.apply(this,arguments)}}()).receive("error",e=>{"closed"===e.reason?(u.exitScene(),VR({roomUnavailableReason:ey.closed})):"oauth_required"===e.reason?(u.exitScene(),VR({oauthInfo:e.oauth_info,showOAuthScreen:!0})):"join_denied"===e.reason&&(u.exitScene(),VR({roomUnavailableReason:ey.denied})),console.error(e)}),P.on("message",({session_id:e,type:t,body:n,from:a})=>{const i={name:(()=>{const t=d.presence.state[e];return a||(t?t.metas[0].profile.displayName:"Mystery user")})(),type:t,body:n,maySpawn:o.is("entered"),sessionId:e,sent:e===_.params().session_id};o.is("vr-mode")&&function(e){cd.apply(this,arguments)}(i),O.receive(i)}),P.on("hub_refresh",({session_id:e,hubs:t,stale_fields:n})=>{const a=t[0],i=d.presence.state[e],r=i&&i.metas[0].profile.displayName||"API";if(window.APP.hub=a,qR(a,d),n.includes("scene")||n.includes("scene_listing")||n.includes("default_environment_gltf_bundle_url")){document.getElementById("viewing-camera").components.fader.fadeOut().then(()=>{o.emit("reset_scene"),zR(a,u)}),O.receive({type:"scene_changed",name:r,sceneName:a.scene?a.scene.name:"a custom URL"})}if(n.includes("member_permissions")&&d.fetchPermissions(),n.includes("name")){const e=document.title.split(" | ");e[0]=a.name,document.title=e.join(" | ");const t=NR.location.pathname.split("/")[1],{search:n,state:i}=NR.location,o=NR.location.pathname.replace("/".concat(t),"/".concat(a.slug));NR.replace({pathname:o,search:n,state:i}),O.receive({type:"hub_name_changed",name:r,hubName:a.name})}"deny"===a.entry_mode&&o.emit("hub_closed"),o.emit("hub_updated",{hub:a})}),P.on("permissions_updated",()=>d.fetchPermissions()),P.on("mute",({session_id:e})=>{e===NAF.clientId&&(APP.mediaDevicesManager.micEnabled=!1)}),c.setSocket(_),v.setSocket(_)})))},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0);function i(e="keyboard-user"){const[t,n]=Object(a.useState)(!1);Object(a.useEffect)(()=>{function a(){t&&(document.body.classList.remove(e),n(!1))}function i(a){"Tab"!==a.key||t||(document.body.classList.add(e),n(!0))}return window.addEventListener("keydown",i),window.addEventListener("mousedown",a),()=>{window.removeEventListener("keydown",i),window.removeEventListener("mousedown",a)}},[e,t])}},167:function(e,t,n){"use strict";function a(e,t){return e&&e.components&&e.components.tags&&e.components.tags.data[t]}n.d(t,"a",(function(){return a})),AFRAME.registerComponent("tags",{schema:{isHandCollisionTarget:{default:!1},isHoldable:{default:!1},offersHandConstraint:{default:!1},offersRemoteConstraint:{default:!1},togglesHoveredActionSet:{default:!1},singleActionButton:{default:!1},holdableButton:{default:!1},isPen:{default:!1},isHoverMenuChild:{default:!1},isStatic:{default:!1},inspectable:{default:!1},preventAudioBoost:{default:!1},ignoreSpaceBubble:{default:!1}},update(){this.didUpdateOnce&&console.warn("Do not edit tags with .setAttribute"),this.didUpdateOnce=!0},remove(){const e=this.el.sceneEl.systems.interaction;e.isHeld(this.el)&&(e.release(this.el),this.el.sceneEl.systems["hubs-systems"].constraintsSystem.release(this.el))}})},169:function(e,t,n){e.exports={"hide-lg":"style-utils__hide-lg__1h-ZJ",hideLg:"style-utils__hide-lg__1h-ZJ","show-lg":"style-utils__show-lg__2vGu-",showLg:"style-utils__show-lg__2vGu-","margin-0":"style-utils__margin-0__3fL3L",margin0:"style-utils__margin-0__3fL3L",textError:"style-utils__textError__2IWPp","xs-margin-y":"style-utils__xs-margin-y__3MTs5",xsMarginY:"style-utils__xs-margin-y__3MTs5","xs-margin-r":"style-utils__xs-margin-r__2kJ2o",xsMarginR:"style-utils__xs-margin-r__2kJ2o","xs-margin-l":"style-utils__xs-margin-l__2X0bY",xsMarginL:"style-utils__xs-margin-l__2X0bY","xs-margin-bottom":"style-utils__xs-margin-bottom__2DGBy",xsMarginBottom:"style-utils__xs-margin-bottom__2DGBy","xs-margin-top":"style-utils__xs-margin-top__e8ZA4",xsMarginTop:"style-utils__xs-margin-top__e8ZA4","xs-padding":"style-utils__xs-padding__29trR",xsPadding:"style-utils__xs-padding__29trR","xs-wrap-margin":"style-utils__xs-wrap-margin__z2lYp",xsWrapMargin:"style-utils__xs-wrap-margin__z2lYp","sm-margin-y":"style-utils__sm-margin-y__2DMkm",smMarginY:"style-utils__sm-margin-y__2DMkm","sm-margin-r":"style-utils__sm-margin-r__2_zB3",smMarginR:"style-utils__sm-margin-r__2_zB3","sm-margin-l":"style-utils__sm-margin-l__1PIrH",smMarginL:"style-utils__sm-margin-l__1PIrH","sm-margin-bottom":"style-utils__sm-margin-bottom__2asWL",smMarginBottom:"style-utils__sm-margin-bottom__2asWL","sm-margin-top":"style-utils__sm-margin-top__1MnOX",smMarginTop:"style-utils__sm-margin-top__1MnOX","sm-padding":"style-utils__sm-padding__2SBKS",smPadding:"style-utils__sm-padding__2SBKS","sm-wrap-margin":"style-utils__sm-wrap-margin__2I2Nn",smWrapMargin:"style-utils__sm-wrap-margin__2I2Nn","md-margin-y":"style-utils__md-margin-y__2Jm84",mdMarginY:"style-utils__md-margin-y__2Jm84","md-margin-r":"style-utils__md-margin-r__dLXFG",mdMarginR:"style-utils__md-margin-r__dLXFG","md-margin-l":"style-utils__md-margin-l__2Go_A",mdMarginL:"style-utils__md-margin-l__2Go_A","md-margin-bottom":"style-utils__md-margin-bottom__2qTtf",mdMarginBottom:"style-utils__md-margin-bottom__2qTtf","md-margin-top":"style-utils__md-margin-top__1fgTa",mdMarginTop:"style-utils__md-margin-top__1fgTa","md-padding":"style-utils__md-padding__3hj3E",mdPadding:"style-utils__md-padding__3hj3E","md-wrap-margin":"style-utils__md-wrap-margin__FJWWt",mdWrapMargin:"style-utils__md-wrap-margin__FJWWt","lg-margin-y":"style-utils__lg-margin-y__2ZVqz",lgMarginY:"style-utils__lg-margin-y__2ZVqz","lg-margin-r":"style-utils__lg-margin-r__1C1HX",lgMarginR:"style-utils__lg-margin-r__1C1HX","lg-margin-l":"style-utils__lg-margin-l__2YNJk",lgMarginL:"style-utils__lg-margin-l__2YNJk","lg-margin-bottom":"style-utils__lg-margin-bottom__3Qm2t",lgMarginBottom:"style-utils__lg-margin-bottom__3Qm2t","lg-margin-top":"style-utils__lg-margin-top__1o2QK",lgMarginTop:"style-utils__lg-margin-top__1o2QK","lg-padding":"style-utils__lg-padding__36YG1",lgPadding:"style-utils__lg-padding__36YG1","lg-wrap-margin":"style-utils__lg-wrap-margin__2AX_R",lgWrapMargin:"style-utils__lg-wrap-margin__2AX_R","xl-margin-y":"style-utils__xl-margin-y__2Gii-",xlMarginY:"style-utils__xl-margin-y__2Gii-","xl-margin-r":"style-utils__xl-margin-r__1iqHb",xlMarginR:"style-utils__xl-margin-r__1iqHb","xl-margin-l":"style-utils__xl-margin-l__3aApC",xlMarginL:"style-utils__xl-margin-l__3aApC","xl-margin-bottom":"style-utils__xl-margin-bottom__4h7Sa",xlMarginBottom:"style-utils__xl-margin-bottom__4h7Sa","xl-margin-top":"style-utils__xl-margin-top__3pnM3",xlMarginTop:"style-utils__xl-margin-top__3pnM3","xl-padding":"style-utils__xl-padding__TwaRF",xlPadding:"style-utils__xl-padding__TwaRF","xl-wrap-margin":"style-utils__xl-wrap-margin__2oi2E",xlWrapMargin:"style-utils__xl-wrap-margin__2oi2E","flex-basis-10":"style-utils__flex-basis-10__3pkwD",flexBasis10:"style-utils__flex-basis-10__3pkwD","flex-basis-20":"style-utils__flex-basis-20__Yt4qI",flexBasis20:"style-utils__flex-basis-20__Yt4qI","flex-basis-30":"style-utils__flex-basis-30__1dtJW",flexBasis30:"style-utils__flex-basis-30__1dtJW","flex-basis-40":"style-utils__flex-basis-40__2IQLj",flexBasis40:"style-utils__flex-basis-40__2IQLj","flex-basis-50":"style-utils__flex-basis-50__3n2Gs",flexBasis50:"style-utils__flex-basis-50__3n2Gs","flex-basis-60":"style-utils__flex-basis-60__itfI3",flexBasis60:"style-utils__flex-basis-60__itfI3","flex-basis-70":"style-utils__flex-basis-70__4ZURo",flexBasis70:"style-utils__flex-basis-70__4ZURo","flex-basis-80":"style-utils__flex-basis-80__B0H9k",flexBasis80:"style-utils__flex-basis-80__B0H9k"}},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"j",(function(){return A})),n.d(t,"n",(function(){return M})),n.d(t,"p",(function(){return k})),n.d(t,"g",(function(){return O})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return P})),n.d(t,"m",(function(){return R})),n.d(t,"k",(function(){return T})),n.d(t,"b",(function(){return D})),n.d(t,"o",(function(){return I})),n.d(t,"h",(function(){return L})),n.d(t,"i",(function(){return F})),n.d(t,"d",(function(){return V})),n.d(t,"f",(function(){return B})),n.d(t,"l",(function(){return U}));var a=n(80),i=n(8),r=n(391),o=n.n(r),s=n(37),l=n(97),c=n(356),d=n(19),u=n(78),h=n(256),p=n.n(h),m=n(281),f=n.n(m),g=n(212);function v(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){v(r,a,i,o,s,"next",e)}function s(e){v(r,a,i,o,s,"throw",e)}o(void 0)}))}}const y={ALL:"all",ALL_2D:"all-2d",MODEL:"model",IMAGE:"image",VIDEO:"video",PDF:"pdf"},E=p()();E.tlds(f.a);const w=Object(i.j)("/api/v1/media"),_=AFRAME.utils.device.isMobile(),S=AFRAME.utils.device.isMobile(),x=new Map,A=(e=!1)=>{const t=_||S;return e?t?"low_360":"high_360":t?"low":"high"},M=function(){var e=b((function*(e,t=null,n=1,a){const i="".concat(e,"_").concat(n);if(!a&&x.has(i))return x.get(i);const r=fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:e,quality:t||A()},version:n})}).then(function(){var t=b((function*(t){if(!t.ok){const n='Error resolving url "'.concat(e,'":');try{const e=yield t.text();throw new Error(n+" "+e)}catch(e){throw new Error(n+" "+t.statusText)}}return t.json()}));return function(e){return t.apply(this,arguments)}}());return x.set(i,r),r}));return function(t){return e.apply(this,arguments)}}(),k=(e,t)=>{const n=new FormData;return n.append("media",e),n.append("promotion_mode","with_token"),t&&n.append("desired_content_type",t),fetch(Object(i.f)("/api/v1/media"),{method:"POST",body:n}).then(e=>e.json())};function O(e){return E.test(e)?e.indexOf("://")>=0?e:"https://".concat(e):e}const C=(e,t,n,i=null,r=!1,o=!1,s=!0,l={},c=!0,u=null,h=null)=>{const p=AFRAME.scenes[0],m=document.createElement("a-entity");if(c)m.setAttribute("networked",{template:t});else{const e=document.importNode(document.body.querySelector(t).content,!0).firstElementChild.cloneNode(!0),n=e.attributes;for(let e=0;e<n.length;e++)m.setAttribute(n[e].name,n[e].value);for(;e.firstElementChild;)m.appendChild(e.firstElementChild)}const f=e instanceof File,g=function(e){const t=document.querySelectorAll("[media-loader]");let n=1;for(const a of t){const t=a.components["media-loader"];t.data&&t.data.src===e&&(n=Math.max(n,t.data.version))}return n}(e);m.setAttribute("media-loader",{fitToBox:o,resolve:r,animate:s,src:"string"==typeof e?O(e)||e:"",version:g,contentSubtype:i,fileIsOwned:!f,linkedEl:h,mediaOptions:l}),m.object3D.matrixNeedsUpdate=!0,(u||p).appendChild(m);const v=new Promise((function(t){f?function(e,t){const n=new FileReader;n.onload=function(e){const n=new DataView(e.target.result);if(65496!=n.getUint16(0,!1))return t(-2);const a=n.byteLength;let i=2;for(;i<a;){if(n.getUint16(i+2,!1)<=8)return t(-1);const e=n.getUint16(i,!1);if(i+=2,65505==e){if(1165519206!=n.getUint32(i+=2,!1))return t(-1);const e=18761==n.getUint16(i+=6,!1);i+=n.getUint32(i+4,e);const a=n.getUint16(i,e);i+=2;for(let r=0;r<a;r++)if(274==n.getUint16(i+12*r,e))return t(n.getUint16(i+12*r+8,e))}else{if(65280!=(65280&e))break;i+=n.getUint16(i,!1)}}return t(-1)},n.readAsArrayBuffer(e)}(e,e=>{t(e)}):t(1)}));if(f){const t="video-camera"===i?"video/mp4":e.type||Object(d.c)(e.name);k(e,t).then(e=>{const t=new URL(Object(d.j)(e.origin));t.searchParams.set("token",e.meta.access_token),m.setAttribute("media-loader",{resolve:!1,src:t.href,fileId:e.file_id}),window.APP.store.update({uploadPromotionTokens:[{fileId:e.file_id,promotionToken:e.meta.promotion_token}]})}).catch(e=>{console.error("Media upload failed",e),m.setAttribute("media-loader",{src:"error"})})}else e instanceof MediaStream&&m.setAttribute("media-loader",{src:"hubs://clients/".concat(NAF.clientId,"/video")});return n&&m.addEventListener("media_resolved",({detail:e})=>{const t=Object(a.c)(n,e.contentType,e.src);p.emit("object_spawned",{objectType:t})}),{entity:m,orientation:v}},P=(e,t,n=null,i=!0,r=!1,o=null)=>{n||({src:n}=e.components["media-loader"].data);const{contentSubtype:s,fitToBox:l,mediaOptions:c}=e.components["media-loader"].data;return C(n,t,a.a.URL,s,!0,l,!1,c,i,o,r?e:null)};function R(e){const t=[],n=AFRAME.scenes[0].systems["hubs-systems"].batchManagerSystem;return e.traverse(a=>{a.material&&!a.isTroikaText&&(a.reflectionProbeMode="dynamic",Object(s.e)(a,i=>{if(i.hubs_InjectedCustomShaderChunks)return i;if(!c.a.includes(i.type))return i;if(a.el&&(a.el.classList.contains("ui")||a.el.classList.contains("hud")||a.el.getAttribute("text-button")))return i;n.batchingEnabled&&n.meshToEl.set(a,e.el);const r=i.clone();return r.onBeforeCompile=(e,n)=>{-1!=e.vertexShader.indexOf("#include <skinning_vertex>")&&(i.onBeforeCompile&&i.onBeforeCompile(e,n),e.uniforms.hubs_IsFrozen={value:!1},e.uniforms.hubs_EnableSweepingEffect={value:!1},e.uniforms.hubs_SweepParams={value:[0,0]},e.uniforms.hubs_InteractorOnePos={value:[0,0,0]},e.uniforms.hubs_InteractorTwoPos={value:[0,0,0]},e.uniforms.hubs_HighlightInteractorOne={value:!1},e.uniforms.hubs_HighlightInteractorTwo={value:!1},e.uniforms.hubs_Time={value:0},e.vertexShader=["varying vec3 hubs_WorldPosition;","uniform bool hubs_IsFrozen;","uniform bool hubs_HighlightInteractorOne;","uniform bool hubs_HighlightInteractorTwo;\n"].join("\n")+e.vertexShader.replace("#include <skinning_vertex>","#include <skinning_vertex>\n             if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n              vec4 wt = modelMatrix * vec4(transformed, 1);\n\n              // Used in the fragment shader below.\n              hubs_WorldPosition = wt.xyz;\n            }"),e.fragmentShader=["varying vec3 hubs_WorldPosition;","uniform bool hubs_IsFrozen;","uniform bool hubs_EnableSweepingEffect;","uniform vec2 hubs_SweepParams;","uniform bool hubs_HighlightInteractorOne;","uniform vec3 hubs_InteractorOnePos;","uniform bool hubs_HighlightInteractorTwo;","uniform vec3 hubs_InteractorTwoPos;","uniform float hubs_Time;\n"].join("\n")+e.fragmentShader.replace("#include <output_fragment>","#include <output_fragment>\n"+o.a),t.push(e.uniforms))},r.needsUpdate=!0,r.hubs_InjectedCustomShaderChunks=!0,r}))}),t}function T(e){return window.APP.store.state.uploadPromotionTokens.find(t=>t.fileId===e)}const j=new THREE.Vector3;function D(e,t,n,a,i=!1,r=.75){const{entity:o,orientation:s}=C(t,"#interactable-media",void 0,n,!1),l=e.object3D.position;o.object3D.position.set(l.x,l.y,l.z),o.object3D.rotation.copy(e.object3D.rotation),i&&o.object3D.rotateY(Math.PI);const c=a%6+3;j.set(Math.cos(2*Math.PI*(c/6))*r,Math.sin(2*Math.PI*(c/6))*r,.001*c-.05),e.object3D.localToWorld(j),o.object3D.visible=!1;const d=()=>{o.object3D.visible=!0,o.setAttribute("animation__photo_pos",{property:"position",dur:800,from:{x:l.x,y:l.y,z:l.z},to:{x:j.x,y:j.y,z:j.z},easing:"easeOutElastic"})};let u=null;if(n.startsWith("photo"))o.addEventListener("image-loaded",d,{once:!0}),u="photo";else{if(!n.startsWith("video"))return void console.error("invalid type "+n);o.addEventListener("video-loaded",d,{once:!0}),u="video"}return o.object3D.matrixNeedsUpdate=!0,o.addEventListener("media_resolved",()=>{e.emit("".concat(u,"_taken"),o.components["media-loader"].data.src)},{once:!0}),{entity:o,orientation:s}}const I=(new l.a).setCrossOrigin("anonymous");function L(e,t){return H.apply(this,arguments)}function H(){return(H=b((function*(e,t){let n;if(t){const a=new Image;a.crossOrigin="anonymous";const i=new Promise(e=>a.addEventListener("load",e,{once:!0}));a.src=e,yield i;const r=document.createElement("canvas");r.width=a.width,r.height=a.height;const o=r.getContext("2d");o.drawImage(a,0,0),yield t(o,a.width,a.height),n=new THREE.CanvasTexture(r)}else try{n=yield I.loadAsync(e)}catch(t){throw new Error("'".concat(e,"' could not be fetched (Error code: ").concat(t.status,"; Response: ").concat(t.statusText,")"))}return n.encoding=THREE.sRGBEncoding,n.anisotropy=4,n}))).apply(this,arguments)}const N=Object(u.b)();function F(e){const t=document.createElement(e);return t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.autoplay=!0,t.muted=N,t.preload="auto",t.crossOrigin="anonymous",t}function V(e,t,n){const a=function(){const t={};return function(n){const a=n.animatables[0].target;a.x=Math.max(Number.MIN_VALUE,a.x),a.y=Math.max(Number.MIN_VALUE,a.y),a.z=Math.max(Number.MIN_VALUE,a.z),a.x===t.x&&a.y===t.y&&a.z===t.z||(t.x=a.x,t.y=a.y,t.z=a.z,e.scale.set(a.x,a.y,a.z),e.matrixNeedsUpdate=!0)}}(),i={duration:400,easing:"easeOutElastic",elasticity:400,loop:0,round:!1,x:e.scale.x,y:e.scale.y,z:e.scale.z,targets:[t],update:e=>a(e),complete:e=>{a(e),n&&n()}};return e.scale.copy(t),e.matrixNeedsUpdate=!0,Object(g.default)(i)}function B(){const e=document.querySelector("#media-mirror-target");if(e.firstChild)return e.firstChild.setAttribute("animation__remove",{property:"scale",dur:200,to:{x:.01,y:.01,z:.01},easing:"easeInQuad"}),new Promise(t=>{e.firstChild.addEventListener("animationcomplete",()=>{e.removeChild(e.firstChild),e.parentEl.object3D.visible=!1,t()})})}function U(e){return!!e&&(void 0!==e.audioTracks?e.audioTracks.length>0:0===e.videoWidth&&0===e.videoHeight||(void 0!==e.mozHasAudio?e.mozHasAudio:void 0!==e.webkitAudioDecodedByteCount&&e.webkitAudioDecodedByteCount>0))}},171:function(e,t,n){"use strict";n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return N}));var a=n(153),i=n(37),r=n(282),o=n.n(r),s=n(19),l=n(213),c=n(231),d=n(11),u=n(97),h=n(289),p=n(358),m=n(287),f=n(359);function g(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){g(r,a,i,o,s,"next",e)}function s(e){g(r,a,i,o,s,"throw",e)}o(void 0)}))}}THREE.Mesh.prototype.raycast=c.b;const b=new class{constructor(){this.cache=new Map}set(e,t){return this.cache.set(e,{gltf:t,count:0}),this.retain(e)}has(e){return this.cache.has(e)}get(e){return this.cache.get(e)}retain(e){const t=this.cache.get(e);return t.count++,t}release(e){const t=this.cache.get(e);t?(t.count--,t.count<=0&&(t.gltf.scene.traverse(d.h),this.cache.delete(e))):console.error("Releasing uncached gltf ".concat(e))}},y=new Map,E=Object(l.a)(new o.a);function w(e,t,n){if(AFRAME.components[t])if(AFRAME.components[t].multiple&&Array.isArray(n))for(let a=0;a<n.length;a++)e.setAttribute(t+"__"+a,n[a]);else e.setAttribute(t,n);else console.warn('Inflator failed. "'.concat(t,'" component does not exist.'))}function _(e){return{animations:e.scene.animations,scene:Object(d.e)(e.scene)}}function S(e){const t=e.userData.gltfExtensions&&(e.userData.gltfExtensions.MOZ_hubs_components||e.userData.gltfExtensions.HUBS_components),n=e.userData.components;return t||n}function x(e){const t=e.material;return t?S(t):null}AFRAME.GLTFModelPlus={components:{},registerComponent(e,t,n){n=n||w,AFRAME.GLTFModelPlus.components[e]={inflator:n,componentName:t}}};const A=function(e,t,n,a,i=1){"Chest"===t.name?t.name="Spine":"Root Scene"===t.name?t.name="AvatarRoot":"Bot_Skinned"===t.name&&(t.name="AvatarMesh");const r=[],o=t.children.slice(0);for(const t of o){const a=A(e,t,n);a&&r.push(a)}const s=S(t),l=x(t);if(!(!!s||!!l||t.name in n)&&!r.length&&!a)return null;const c=document.createElement("a-entity");c.append.apply(c,r);const d=(t.name||t.uuid).replace(/[^\w-]/g,"");c.classList.add(d),"YXZ"!==t.rotation.order&&t.rotation.setFromQuaternion(t.quaternion,"YXZ"),c.object3D.position.copy(t.position),c.object3D.rotation.copy(t.rotation),c.object3D.scale.copy(t.scale).multiplyScalar(i),c.object3D.matrixNeedsUpdate=!0,t.matrixAutoUpdate=!1,t.matrix.identity(),t.matrix.decompose(t.position,t.rotation,t.scale),c.setObject3D(t.type.toLowerCase(),t),s&&"nav-mesh"in s&&c.setObject3D("mesh",t),c.object3D.name=t.name,c.object3D.uuid=t.uuid,t.uuid=THREE.Math.generateUUID(),t.animations&&(t.parent.animations=t.animations),t.morphTargetInfluences&&(t.parent.morphTargetInfluences=t.morphTargetInfluences);const u=t.userData.gltfIndex;return void 0!==u&&(e[u]=c),c};function M(){return(M=v((function*(e,t){let n=!0;const a=[];e.object3D.traverse(function(){var e=v((function*(e){const i={};i.promise=new Promise(e=>i.resolve=e),a.push(i),n||(yield a.shift().promise),n=!1;const r=S(e),o=e.el;function s(e){for(const n in e){const a=e[n];"node"===(null==a?void 0:a.__mhc_link_type)&&void 0!==a.index&&(t[a.index]?e[n]=t[a.index].object3D:(console.warn("inflateComponents: invalid node reference",n),e[n]=null))}return e}if(r&&o)for(const e in r)if(r.hasOwnProperty(e)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(e)){const{componentName:n,inflator:a}=AFRAME.GLTFModelPlus.components[e];yield a(o,n,s(r[e]),r,t)}const l=x(e);if(l&&o)for(const e in l)if(l.hasOwnProperty(e)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(e)){const{componentName:n,inflator:a}=AFRAME.GLTFModelPlus.components[e];yield a(o,n,s(l[e]),l,t)}i.resolve()}));return function(t){return e.apply(this,arguments)}}()),yield a.shift().promise}))).apply(this,arguments)}function k(e,t,n){const a=e.querySelectorAll("."+t);for(const e of a){const t=n.cloneNode(!0);for(const n of t.attributes){const{name:t,value:a}=n;e.setAttribute(t,a)}for(;t.children.length>0;)e.appendChild(t.children[0])}}function O(e){return e.extensions&&e.extensions.MOZ_hubs_components?e.extensions.MOZ_hubs_components:e.extensions&&e.extensions.HUBS_components?e.extensions.HUBS_components:e.extras&&e.extras.gltfExtensions&&e.extras.gltfExtensions.MOZ_hubs_components?e.extras.gltfExtensions.MOZ_hubs_components:void 0}let C,P;class R{constructor(e,t){this.parser=e,this.jsonPreprocessor=t,e.textureLoader=new u.a(e.options.manager)}beforeRoot(){const e=this.parser,t=this.jsonPreprocessor;t&&(e.json=t(e.json));let n=0;e.json.extensions&&e.json.extensions.MOZ_hubs_components&&e.json.extensions.MOZ_hubs_components.hasOwnProperty("version")&&(n=e.json.extensions.MOZ_hubs_components.version),function(e,t){if(e<2){const e=t.nodes.find(e=>{const t=O(e);return t&&t.heightfield&&t["nav-mesh"]});e&&(e.extensions&&e.extensions.MOZ_hubs_components?delete e.extensions.MOZ_hubs_components.heightfield:e.extensions&&e.extensions.HUBS_components?delete e.extensions.HUBS_components.heightfield:e.extras&&e.extras.gltfExtensions&&e.extras.gltfExtensions.MOZ_hubs_components&&delete e.extras.gltfExtensions.MOZ_hubs_components)}if(e<4&&t.nodes)for(const e of t.nodes){const t=O(e);if(!t)continue;const n=t["spot-light"]||t["point-light"];n&&0===n.range&&(n.decay=0)}}(n,e.json);const a=e.json.nodes;if(a)for(let e=0;e<a.length;e++){const t=a[e];t.extras||(t.extras={}),t.extras.gltfIndex=e}}afterRoot(e){if(e.scene.traverse(e=>{e.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate;const t=window.APP.store.state.preferences.materialQualitySetting;Object(i.e)(e,e=>Object(i.a)(e,t))}),e.animations)for(const t of e.animations)for(const n of t.tracks){const t=THREE.PropertyBinding.parseTrackName(n.name);for(const a of e.scenes){const e=THREE.PropertyBinding.findNode(a,t.nodeName);if(e){n.name=n.name.replace(/^[^.]*\./,e.uuid+".");break}}}e.scene.animations=e.animations}}class T{constructor(e){this.parser=e,this.name="MOZ_hubs_components"}afterRoot({scenes:e,parser:t}){const n=[],a=(e,a)=>{var i,r;const o=null===(i=t.associations.get(a))||void 0===i?void 0:i[e];if(void 0===o)return;const s=null===(r=t.json[e][o].extensions)||void 0===r?void 0:r[this.name];if(s){a.userData.gltfExtensions=Object.assign(a.userData.gltfExtensions||{},{MOZ_hubs_components:s});for(const e in s){const a=s[e];for(const e in a){const i=a[e],r=null==i?void 0:i.__mhc_link_type;r&&void 0!==i.index&&n.push(t.getDependency(r,i.index).then(n=>{var o;if("node"!==r)return"texture"!==r||(null===(o=t.json.textures[i.index].extensions)||void 0===o?void 0:o.MOZ_texture_rgbe)||(n.encoding=THREE.sRGBEncoding),a[e]=n,n}))}}}};for(let n=0;n<e.length;n++)t.associations.set(e[n],{scenes:n}),e[n].traverse(e=>{a("scenes",e),a("nodes",e),Object(i.d)(e,a.bind(this,"materials"))});return Promise.all(n)}}class j{constructor(e){this.parser=e,this.name="MOZ_lightmap"}loadMaterial(e){const t=this.parser,n=t.json.materials[e];if(!n.extensions||!n.extensions[this.name])return null;const a=n.extensions[this.name],i=[];return i.push(t.loadMaterial(e)),i.push(t.getDependency("texture",a.index)),Promise.all(i).then(e=>{const t=e[0],n=e[1];return t.lightMap=n,t.lightMapIntensity=void 0!==a.intensity?a.intensity:1,t})}}class D{constructor(e){this.parser=e,this.name="MOZ_HUBS_texture_basis",this.basisLoader=null}loadTexture(e){const t=this.parser,n=t.json,a=n.textures[e];if(!a.extensions||!a.extensions[this.name])return null;if(null===this.basisLoader&&(this.basisLoader=new m.a(t.options.manager).detectSupport(AFRAME.scenes[0].renderer)),!this.basisLoader)return null;console.warn("The ".concat(this.name," extension is deprecated, you should use KHR_texture_basisu instead."));const i=a.extensions[this.name],r=n.images[i.source];return t.loadTextureImage(e,r,this.basisLoader)}}class I{constructor(e,t){this.parser=e,this.loader=t,this.name="MOZ_texture_rgbe"}loadTexture(e){const t=this.parser,n=t.json,a=n.textures[e];if(!a.extensions||!a.extensions[this.name])return null;const i=a.extensions[this.name],r=n.images[i.source];return t.loadTextureImage(e,r,this.loader).then(e=>(e.minFilter==THREE.NearestMipmapNearestFilter||e.minFilter==THREE.NearestMipmapLinearFilter?e.minFilter=THREE.NearestFilter:e.minFilter!=THREE.LinearMipmapNearestFilter&&e.minFilter!=THREE.LinearMipmapLinearFilter||(e.minFilter=THREE.LinearFilter),e))}}function L(e,t,n,a){return H.apply(this,arguments)}function H(){return(H=v((function*(e,t,n,a){let i,r=e;t&&(t.includes("model/gltf+zip")||t.includes("application/x-zip-compressed"))&&(i=yield E(r),r=i["scene.gtlf"]);const o=new THREE.LoadingManager;o.setURLModifier(Object(s.b)(r));const l=new THREE.GLTFLoader(o);return l.register(e=>new T(e)).register(e=>new R(e,a)).register(e=>new j(e)).register(e=>new D(e)).register(e=>new I(e,(new p.a).setDataType(THREE.HalfFloatType))),!C&&AFRAME&&AFRAME.scenes&&AFRAME.scenes[0]&&(C=new h.a(o).detectSupport(AFRAME.scenes[0].renderer)),!P&&AFRAME&&AFRAME.scenes&&AFRAME.scenes[0]&&(P=new f.a(o)),C&&l.setKTX2Loader(C),P&&l.setDRACOLoader(P),new Promise((e,t)=>{l.load(r,e,n,t)}).finally(()=>{i&&Object.keys(i).forEach(URL.revokeObjectURL)})}))).apply(this,arguments)}function N(e){return F.apply(this,arguments)}function F(){return(F=v((function*(e,t=null,n=!1,a=null){if(console.log("Loading model ".concat(e)),n){if(b.has(e))return b.retain(e),_(b.get(e).gltf);if(y.has(e)){const t=yield y.get(e);return b.retain(e),_(t)}{const n=L(e,t,null,a);y.set(e,n);const i=yield n;return y.delete(e),b.set(e,i),_(i)}}return L(e,t,null,a)}))).apply(this,arguments)}function V(e){if(e&&"#"===e.charAt(0)){const t=document.getElementById(e.substring(1));if(t)return t.getAttribute("src")}return e}AFRAME.registerComponent("gltf-model-plus",{schema:{src:{type:"string"},contentType:{type:"string"},useCache:{default:!0},inflate:{default:!1},batch:{default:!1},modelToWorldScale:{type:"number",default:1}},init(){this.jsonPreprocessor=null,this.loadTemplates()},play(){this.el.components["listed-media"]&&this.el.sceneEl.emit("listed_media_changed")},update(){this.applySrc(V(this.data.src),this.data.contentType)},remove(){if(this.data.batch&&this.model&&this.el.sceneEl.systems["hubs-systems"].batchManagerSystem.removeObject(this.el.object3DMap.mesh),this.data.useCache){const e=V(this.data.src);e&&b.release(e)}},loadTemplates(){this.templates={},this.el.querySelectorAll(":scope > template").forEach(e=>{const t=document.importNode(e.firstElementChild||e.content.firstElementChild,!0);this.templates[e.getAttribute("data-name")]=t})},applySrc(e,t){var n=this;return v((function*(){try{if(e===n.lastSrc)return;const i=n.lastSrc;if(n.lastSrc=e,!e)return void(n.inflatedEl&&(console.warn("gltf-model-plus set to an empty source, unloading inflated model."),n.disposeLastInflatedEl()));n.el.emit("model-loading");const r=yield N(e,t,n.data.useCache,n.jsonPreprocessor);if(e!=n.lastSrc)return;n.disposeLastInflatedEl(),n.model=r.scene,n.data.batch&&n.el.sceneEl.systems["hubs-systems"].batchManagerSystem.addObject(n.model),r.animations.length>0?(n.el.setAttribute("animation-mixer",{}),n.el.components["animation-mixer"].initMixer(n.model.animations)):n.model.traverse(e=>{const t=e.isMesh&&e.geometry.isBufferGeometry,n=t&&e.geometry.boundsTree;if(t&&!n&&e.geometry.attributes.position){const t=e.geometry;if(t.attributes.position.isInterleavedBufferAttribute||t.index&&t.index.isInterleavedBufferAttribute)return void console.warn("Skipping generaton of MeshBVH for interleaved geoemtry as it is not supported");const n=t.index?t.index.count/3:t.attributes.position.count/3;n>1e3&&n<1e6&&(t.boundsTree=new c.a(e.geometry,{strategy:0,maxDepth:30}))}});const o={};let s=n.model;if(n.data.inflate&&(n.inflatedEl=A(o,n.model,n.templates,!0,n.data.modelToWorldScale))){if(n.el.appendChild(n.inflatedEl),s=n.inflatedEl.object3D,s.visible=!1,yield Object(a.a)(),e!=n.lastSrc)return;yield function(e,t){return M.apply(this,arguments)}(n.inflatedEl,o);for(const e in n.templates)k(n.el,e,n.templates[e])}const l=[];s.traverse(e=>{const t=e.el;t&&l.push(()=>e.el=t)}),i&&n.data.useCache&&b.release(i),n.el.setObject3D("mesh",s),l.forEach(e=>e()),s.visible=!0,n.el.emit("model-loaded",{format:"gltf",model:s})}catch(t){b.release(e),console.error("Failed to load glTF model",t,n),n.el.emit("model-error",{format:"gltf",src:e})}}))()},disposeLastInflatedEl(){this.inflatedEl&&(this.inflatedEl.parentNode.removeChild(this.inflatedEl),this.inflatedEl.object3D.traverse(e=>{e.material&&e.material.dispose&&e.material.dispose(),e.geometry&&(e.geometry.dispose&&e.geometry.dispose(),e.geometry.boundsTree=null)}),delete this.inflatedEl,this.el.removeAttribute("animation-mixer"))}})},174:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(98),i=n.n(a),r=n(78);function o(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){o(r,a,i,s,l,"next",e)}function l(e){o(r,a,i,s,l,"throw",e)}s(void 0)}))}}let l=!1;function c(){return(AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR())&&!Object(r.b)()&&i.a.enabled}function d(){return!i.a.isFullscreen&&c()}function u(){return h.apply(this,arguments)}function h(){return(h=s((function*(){c()&&(l=!0,yield i.a.request())}))).apply(this,arguments)}function p(){return m.apply(this,arguments)}function m(){return(m=s((function*(){l&&!i.a.isFullscreen&&(yield i.a.request())}))).apply(this,arguments)}},175:function(e,t,n){e.exports={"room-layout":"RoomLayout__room-layout__32kGK",roomLayout:"RoomLayout__room-layout__32kGK",main:"RoomLayout__main__2H19N",sidebar:"RoomLayout__sidebar__JpnQv",viewport:"RoomLayout__viewport__25svn",toolbar:"RoomLayout__toolbar__1_rvk","modal-container":"RoomLayout__modal-container__35xzu",modalContainer:"RoomLayout__modal-container__35xzu",scene:"RoomLayout__scene__sxaqT","object-focused":"RoomLayout__object-focused__t-oGm",objectFocused:"RoomLayout__object-focused__t-oGm",streaming:"RoomLayout__streaming__GVDfB"}},176:function(e,t,n){e.exports={"section-title":"RoomSidebar__section-title__3lE3B",sectionTitle:"RoomSidebar__section-title__3lE3B","scene-screenshot-container":"RoomSidebar__scene-screenshot-container__s0e5L",sceneScreenshotContainer:"RoomSidebar__scene-screenshot-container__s0e5L","scene-screenshot-image":"RoomSidebar__scene-screenshot-image__2Nndu",sceneScreenshotImage:"RoomSidebar__scene-screenshot-image__2Nndu","scene-info":"RoomSidebar__scene-info__1Ymsi",sceneInfo:"RoomSidebar__scene-info__1Ymsi","scene-name":"RoomSidebar__scene-name__3ddG-",sceneName:"RoomSidebar__scene-name__3ddG-","scene-creator":"RoomSidebar__scene-creator__2mQKU",sceneCreator:"RoomSidebar__scene-creator__2mQKU",attribution:"RoomSidebar__attribution__GK6hc","attribution-name":"RoomSidebar__attribution-name__3ELDI",attributionName:"RoomSidebar__attribution-name__3ELDI","attribution-author":"RoomSidebar__attribution-author__20TNm",attributionAuthor:"RoomSidebar__attribution-author__20TNm"}},181:function(e,t,n){"use strict";function a(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const i=window.createImageBitmap||function(){var e,t=(e=function*(e){return new Promise(t=>{let n;if(e instanceof Blob)n=URL.createObjectURL(e);else{const t=document.createElement("canvas"),a=t.getContext("2d");t.width=e.width,t.height=e.height,a.putImageData(e,0,0),n=t.toDataURL()}const a=document.createElement("img");a.addEventListener("load",()=>t(a)),a.src=n})},function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}();function r(e){e instanceof HTMLImageElement&&e.src.startsWith("blob:")?URL.revokeObjectURL(e.src):e.close&&e.close()}},19:function(e,t,n){"use strict";n.d(t,"l",(function(){return A})),n.d(t,"i",(function(){return M})),n.d(t,"j",(function(){return k})),n.d(t,"a",(function(){return O})),n.d(t,"k",(function(){return C})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return T})),n.d(t,"h",(function(){return F})),n.d(t,"g",(function(){return B})),n.d(t,"f",(function(){return z})),n.d(t,"e",(function(){return W})),n.d(t,"d",(function(){return q}));var a=n(8),i=n(4),r=n(216),o=n.n(r),s=n(217),l=n.n(s),c=n(285),d=n.n(c),u=n(286),h=n.n(u);function p(e,t){p=function(e,t){return new r(e,t)};var n=f(RegExp),a=RegExp.prototype,i=new WeakMap;function r(e,t){var a=n.call(this,e);return i.set(a,t),a}function o(e,n){var a=i.get(n);return Object.keys(t).reduce((function(t,n){return t[n]=e[a[n]],t}),Object.create(null))}return m(r,n),r.prototype.exec=function(e){var t=a.exec.call(this,e);return t&&(t.groups=o(t,this)),t},r.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=i.get(this);return a[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+n[t]})))}if("function"==typeof t){var r=this;return a[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!=typeof e[e.length-1]&&e.push(o(e,r)),t.apply(this,e)}))}return a[Symbol.replace].call(this,e,t)},p.apply(this,arguments)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return v(e,arguments,y(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b(a,e)})(e)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function v(e,t,n){return(v=g()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&b(i,n.prototype),i}).apply(null,arguments)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){E(r,a,i,o,s,"next",e)}function s(e){E(r,a,i,o,s,"throw",e)}o(void 0)}))}}const _=(i.a.NON_CORS_PROXY_DOMAINS||"").split(",");i.a.CORS_PROXY_SERVER&&_.push(i.a.CORS_PROXY_SERVER.split(":")[0]),_.push(document.location.hostname);const S={gltf:"model/gltf",glb:"model/gltf-binary",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",pdf:"application/pdf",mp4:"video/mp4",mp3:"audio/mpeg",basis:"image/basis",ktx2:"image/ktx2",m3u8:"application/vnd.apple.mpegurl",mpd:"application/dash+xml"};const x=e=>{return(t=e,btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))).replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_");var t},A=(e,t,n)=>{let r="";try{const t=new URL(e).pathname.split(".");if(t.length>1){const e=t.pop();S[e]&&(r=".".concat(e))}}catch(e){r=".png"}const o="https://".concat(i.a.THUMBNAIL_SERVER,"/thumbnail/").concat(x(e)).concat(r,"?w=").concat(t,"&h=").concat(n);try{const t=new URL(e).hostname;if(Object(a.m)()){if(new URL("https://".concat(i.a.RETICULUM_SERVER)).hostname===t)return e}}catch(e){return o}return o},M=e=>_.find(t=>e.endsWith(t)),k=e=>{if(!e.startsWith("http:")&&!e.startsWith("https:"))return e;try{const t=new URL(e);if(M(t.hostname))return e}catch(e){}return"https://".concat(i.a.CORS_PROXY_SERVER,"/").concat(e)};function O(e,t){return function(e,t){return new URL(t,e)}(e,t).href}const C=function(e){return"basis_transcoder.js"===e?o.a:"basis_transcoder.wasm"===e?l.a:e},P=e=>t=>{if("basis_transcoder.js"===t)return o.a;if("basis_transcoder.wasm"===t)return l.a;if("draco_wasm_wrapper.js"===t)return d.a;if("draco_decoder.wasm"===t)return h.a;if("string"!=typeof t||""===t)return"";if(/^(https?:)?\/\//i.test(t))return k(t);if(/^data:.*,.*$/i.test(t))return t;if(/^blob:.*$/i.test(t))return t;if(i.a.CORS_PROXY_SERVER){const n="https://".concat(i.a.CORS_PROXY_SERVER,"/");if(e.startsWith(n)){const a=decodeURIComponent(e.substring(n.length)).split("/"),i=new URL(t).pathname;return n+(a.slice(0,a.length-1).join("/")+"/"+i)}}return t},R=/data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+).*,.*/,T=e=>{if(!e)return;if(e.startsWith("hubs://")&&e.endsWith("/video"))return"video/vnd.hubs-webrtc";if(e.startsWith("data:")){const t=R.exec(e);t.length>0&&t[1]}const t=new URL(e,window.location).pathname.split(".").pop();return S[t]},j=new Map;function D(e){return I.apply(this,arguments)}function I(){return(I=w((function*(e){if(!e)return!1;e.startsWith("http")||(e="https://"+e);const{origin:t}=new URL(e);if(j.has(t))return j.get(t);let n;try{n=(yield fetch(k(t),{method:"HEAD"})).headers.has("hub-name")}catch(e){n=!1}return j.set(t,n),n}))).apply(this,arguments)}const L=/https?:\/\/[^/]+\/scenes\/[a-zA-Z0-9]{7}(?:\/|$)/,H=p(/https?:\/\/[\0-\.0-\uFFFF]+\/avatars\/([0-9A-Za-z]{7})(?:\/|$)/,{id:1}),N=p(/(https?:\/\/)?[\0-\.0-\uFFFF]+\/([0-9A-Za-z]{7})(?:\/|$)/,{id:2}),F=function(){var e=w((function*(e){return(yield D(e))&&new URL(e).origin===document.location.origin}));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=w((function*(e){return(yield D(e))&&L.test(e)}));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=w((function*(e){return(yield V(e))&&(yield F(e))}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=w((function*(e){return(yield D(e))&&H.test(e)}));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=w((function*(e){return(yield U(e))&&(yield F(e))}));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=w((function*(e){var t;return(yield D(e))&&!(yield U(e))&&!(yield V(e))&&(null===(t=e.match(N))||void 0===t?void 0:t.groups.id)}));return function(t){return e.apply(this,arguments)}}(),q=e=>{const t=e.match(H);return t?t.groups.id:null}},191:function(e,t,n){e.exports={"audio-toolbar-popover":"AudioPopover__audio-toolbar-popover__2BDFO",audioToolbarPopover:"AudioPopover__audio-toolbar-popover__2BDFO","selection-input":"AudioPopover__selection-input__1hr_y",selectionInput:"AudioPopover__selection-input__1hr_y","buttons-container":"AudioPopover__buttons-container__j8nNE",buttonsContainer:"AudioPopover__buttons-container__j8nNE","icon-enabled":"AudioPopover__icon-enabled__2b34_",iconEnabled:"AudioPopover__icon-enabled__2b34_","icon-disabled":"AudioPopover__icon-disabled__3e9Of",iconDisabled:"AudioPopover__icon-disabled__3e9Of","arrow-button":"AudioPopover__arrow-button__2-xhK",arrowButton:"AudioPopover__arrow-button__2-xhK","arrow-button-selected":"AudioPopover__arrow-button-selected__3Osmo",arrowButtonSelected:"AudioPopover__arrow-button-selected__3Osmo","level-bar":"AudioPopover__level-bar__2Ee4A",levelBar:"AudioPopover__level-bar__2Ee4A"}},2:function(e,t,n){"use strict";function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){i(e,t,n[t])}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}));const r={noop:"/noop",actions:{}};r.actions.log="/actions/log",r.actions.toggleScreenShare="/actions/toggleScreenShare",r.actions.snapRotateLeft="/actions/snapRotateLeft",r.actions.snapRotateRight="/actions/snapRotateRight",r.actions.angularVelocity="/actions/angularVelocity",r.actions.logDebugFrame="/actions/logDebugFrame",r.actions.logInteractionState="/actions/logInteractionState",r.actions.debugUserInput={},r.actions.debugUserInput.describeCurrentMasks="/actions/debugUserInput/describeCurrentMasks",r.actions.cameraDelta="/actions/cameraDelta",r.actions.lobbyCameraDelta="/actions/lobbyCameraDelta",r.actions.characterAcceleration="/actions/characterAcceleration",r.actions.dCharSpeed="/actions/dCharSpeed",r.actions.boost="/actions/boost",r.actions.startGazeTeleport="/actions/startTeleport",r.actions.stopGazeTeleport="/actions/stopTeleport",r.actions.spawnPen="/actions/spawnPen",r.actions.ensureFrozen="/actions/ensureFrozen",r.actions.toggleFreeze="/actions/toggleFreeze",r.actions.thaw="/actions/thaw",r.actions.muteMic="/actions/muteMic",r.actions.toggleFly="/actions/toggleFly",r.actions.toggleUI="/actions/toggleUI",r.actions.waypointDeltaDistance="/actions/waypointDeltaDistance",r.actions.focusChat="/actions/focusChat",r.actions.focusChatCommand="/actions/focusChatCommand",r.actions.toggleCamera="/actions/toggleCamera",r.actions.takeSnapshot="/actions/takeSnapshot",r.actions.mediaExit="/actions/mediaExit",r.actions.mediaSearch1="/actions/mediaSearch1",r.actions.mediaSearch2="/actions/mediaSearch2",r.actions.mediaSearch3="/actions/mediaSearch3",r.actions.mediaSearch4="/actions/mediaSearch4",r.actions.mediaSearch5="/actions/mediaSearch5",r.actions.mediaSearch6="/actions/mediaSearch6",r.actions.mediaSearch7="/actions/mediaSearch7",r.actions.mediaSearch8="/actions/mediaSearch8",r.actions.transformModifier="/actions/transformModifier",r.actions.rayObjectRotation="/actions/rayObjectRotation",r.actions.cursor={},r.actions.cursor.right={},r.actions.cursor.right.pose="/actions/cursor/right/Pose",r.actions.cursor.right.hideLine="/actions/cursor/right/HideLine",r.actions.cursor.right.grab="/actions/cursor/right/Grab",r.actions.cursor.right.drop="/actions/cursor/right/Drop",r.actions.cursor.right.modDelta="/actions/cursor/right/ModDelta",r.actions.cursor.right.startDrawing="/actions/cursor/right/StartDrawing",r.actions.cursor.right.stopDrawing="/actions/cursor/right/StopDrawing",r.actions.cursor.right.undoDrawing="/actions/cursor/right/UndoDrawing",r.actions.cursor.right.penNextColor="/actions/cursor/right/PenNextColor",r.actions.cursor.right.penPrevColor="/actions/cursor/right/PenPrevColor",r.actions.cursor.right.scalePenTip="/actions/cursor/right/ScalePenTip",r.actions.cursor.right.scaleGrabbedGrabbable="/actions/cursor/right/ScaleGrabbedGrabbable",r.actions.cursor.right.mediaVolumeMod="/actions/cursor/right//mediaVolumeMod",r.actions.cursor.right.takeSnapshot="/actions/cursor/right/TakeSnapshot",r.actions.cursor.right.wake="/actions/cursor/right/wake",r.actions.cursor.left={},r.actions.cursor.left.pose="/actions/cursor/left/Pose",r.actions.cursor.left.hideLine="/actions/cursor/left/HideLine",r.actions.cursor.left.grab="/actions/cursor/left/Grab",r.actions.cursor.left.drop="/actions/cursor/left/Drop",r.actions.cursor.left.modDelta="/actions/cursor/left/ModDelta",r.actions.cursor.left.startDrawing="/actions/cursor/left/StartDrawing",r.actions.cursor.left.stopDrawing="/actions/cursor/left/StopDrawing",r.actions.cursor.left.undoDrawing="/actions/cursor/left/UndoDrawing",r.actions.cursor.left.penNextColor="/actions/cursor/left/PenNextColor",r.actions.cursor.left.penPrevColor="/actions/cursor/left/PenPrevColor",r.actions.cursor.left.scalePenTip="/actions/cursor/left/ScalePenTip",r.actions.cursor.left.scaleGrabbedGrabbable="/actions/cursor/left/ScaleGrabbedGrabbable",r.actions.cursor.left.mediaVolumeMod="/actions/cursor/left//mediaVolumeMod",r.actions.cursor.left.takeSnapshot="/actions/cursor/left/TakeSnapshot",r.actions.cursor.left.wake="/actions/cursor/left/wake",r.actions.pen={},r.actions.pen.remove="/actions/pen/remove",r.actions.rightHand={},r.actions.rightHand.matrix="/actions/rightHand/matrix",r.actions.rightHand.pose="/actions/rightHandPose",r.actions.rightHand.grab="/actions/rightHandGrab",r.actions.rightHand.drop="/actions/rightHandDrop",r.actions.rightHand.modDelta="/actions/rightHandModDelta",r.actions.rightHand.startDrawing="/actions/rightHandStartDrawing",r.actions.rightHand.stopDrawing="/actions/rightHandStopDrawing",r.actions.rightHand.undoDrawing="/actions/rightHandUndoDrawing",r.actions.rightHand.switchDrawMode="/actions/rightHandSwitchDrawMode",r.actions.rightHand.penNextColor="/actions/rightHandPenNextColor",r.actions.rightHand.penPrevColor="/actions/rightHandPenPrevColor",r.actions.rightHand.scalePenTip="/actions/rightHandScalePenTip",r.actions.rightHand.startTeleport="/actions/rightHand/startTeleport",r.actions.rightHand.stopTeleport="/actions/rightHand/stopTeleport",r.actions.rightHand.takeSnapshot="/actions/rightHandTakeSnapshot",r.actions.rightHand.thumb="/actions/rightHand/thumbDown",r.actions.rightHand.index="/actions/rightHand/indexDown",r.actions.rightHand.middleRingPinky="/actions/rightHand/middleRingPinkyDown",r.actions.leftHand={},r.actions.leftHand.matrix="/actions/leftHand/matrix",r.actions.leftHand.pose="/actions/leftHandPose",r.actions.leftHand.grab="/actions/leftHandGrab",r.actions.leftHand.drop="/actions/leftHandDrop",r.actions.leftHand.modDelta="/actions/leftHandModDelta",r.actions.leftHand.startDrawing="/actions/leftHandStartDrawing",r.actions.leftHand.stopDrawing="/actions/leftHandStopDrawing",r.actions.leftHand.undoDrawing="/actions/leftHandUndoDrawing",r.actions.leftHand.switchDrawMode="/actions/leftHandSwitchDrawMode",r.actions.leftHand.penNextColor="/actions/leftHandPenNextColor",r.actions.leftHand.penPrevColor="/actions/leftHandPenPrevColor",r.actions.leftHand.scalePenTip="/actions/leftHandScalePenTip",r.actions.leftHand.startTeleport="/actions/leftHand/startTeleport",r.actions.leftHand.stopTeleport="/actions/leftHand/stopTeleport",r.actions.leftHand.takeSnapshot="/actions/leftHandTakeSnapshot",r.actions.leftHand.thumb="/actions/leftHand/thumbDown",r.actions.leftHand.index="/actions/leftHand/indexDown",r.actions.leftHand.middleRingPinky="/actions/leftHand/middleRingPinkyDown",r.actions.camera={},r.actions.camera.exitMirror="/actions/cameraExitMirror",r.actions.startInspecting="/actions/startInspecting",r.actions.startInspectingSelf="/actions/startInspectingSelf",r.actions.stopInspecting="/actions/stopInspecting",r.actions.inspectZoom="/actions/inspectZoom",r.actions.inspectPanY="/actions/inspectPanY",r.actions.resetInspectView="/actions/resetInspectView",r.actions.nextCameraMode="/actions/nextCameraMode",r.actions.spawnEmoji0="/actions/spawnEmoji0",r.actions.spawnEmoji1="/actions/spawnEmoji1",r.actions.spawnEmoji2="/actions/spawnEmoji2",r.actions.spawnEmoji3="/actions/spawnEmoji3",r.actions.spawnEmoji4="/actions/spawnEmoji4",r.actions.spawnEmoji5="/actions/spawnEmoji5",r.actions.spawnEmoji6="/actions/spawnEmoji6",r.haptics={},r.haptics.actuators={},r.haptics.actuators.left="/haptics/actuators/left",r.haptics.actuators.right="/haptics/actuators/right",r.device={},r.device.mouse={},r.device.mouse.coords="/device/mouse/coords",r.device.mouse.movementXY="/device/mouse/movementXY",r.device.mouse.buttonLeft="/device/mouse/buttonLeft",r.device.mouse.buttonRight="/device/mouse/buttonRight",r.device.mouse.buttonMiddle="/device/mouse/buttonMiddle",r.device.mouse.wheel="/device/mouse/wheel",r.device.smartMouse={},r.device.smartMouse.cursorPose="/device/smartMouse/cursorPose",r.device.smartMouse.cameraDelta="/device/smartMouse/cameraDelta",r.device.smartMouse.shouldMoveCamera="/device/smartMouse/shouldMoveCamera",r.device.touchscreen={},r.device.touchscreen.cursorPose="/device/touchscreen/cursorPose",r.device.touchscreen.touchCameraDelta="/device/touchscreen/touchCameraDelta",r.device.touchscreen.gyroCameraDelta="/device/touchscreen/gyroCameraDelta",r.device.touchscreen.cameraDelta="/device/touchscreen/cameraDelta",r.device.touchscreen.pinch={},r.device.touchscreen.pinch.delta="/device/touchscreen/pinch/delta",r.device.touchscreen.pinch.initialDistance="/device/touchscreen/pinch/initialDistance",r.device.touchscreen.pinch.currentDistance="/device/touchscreen/pinch/currentDistance",r.device.touchscreen.isTouching="/device/touchscreen/isTouching",r.device.touchscreen.isTouchingGrabbable="/device/touchscreen/isTouchingGrabbable",r.device.touchscreen.tap1="/device/touchscreen/tap1",r.device.touchscreen.tap2="/device/touchscreen/tap2",r.device.touchscreen.tap3="/device/touchscreen/tap3",r.device.touchscreen.tap4="/device/touchscreen/tap4",r.device.touchscreen.tap5="/device/touchscreen/tap5",r.device.touchscreen.anything="/device/touchscreen/anything",r.device.gyro={},r.device.gyro.averageDeltaX="/device/gyro/averageDeltaX",r.device.gyro.averageDeltaY="/device/gyro/averageDeltaY",r.device.hud={},r.device.hud.penButton="/device/hud/penButton",r.device.keyboard={map:new Map,key:function(e){let t=this.map.get(e);return t||(t="/device/keyboard/".concat(" "===e?"space":e.toLowerCase()),this.map.set(e,t),t)}},r.device.gamepad=e=>({button:t=>({pressed:"/device/gamepad/".concat(e,"/button/").concat(t,"/pressed"),touched:"/device/gamepad/".concat(e,"/button/").concat(t,"/touched"),value:"/device/gamepad/".concat(e,"/button/").concat(t,"/value")}),axis:t=>"/device/gamepad/".concat(e,"/axis/").concat(t)});const o="/device/xbox/";r.device.xbox={v:e=>"/vars/xbox/".concat(e),button:e=>({pressed:"".concat(o,"button/").concat(e,"/pressed"),touched:"".concat(o,"button/").concat(e,"/touched"),value:"".concat(o,"button/").concat(e,"/value")}),axis:e=>"".concat(o,"axis/").concat(e),axesSum:"".concat(o,"axis/sum")},r.device.oculusgo={button:e=>({pressed:"/device/oculusgo/button/".concat(e,"/pressed"),touched:"/device/oculusgo/button/".concat(e,"/touched"),value:"/device/oculusgo/button/".concat(e,"/value")}),axis:e=>"/device/oculusgo/axis/".concat(e),trigger:{pressed:"/device/oculusgo/button/trigger/pressed",touched:"/device/oculusgo/button/trigger/touched",value:"/device/oculusgo/button/trigger/value"},touchpad:{pressed:"/device/oculusgo/button/touchpad/pressed",touched:"/device/oculusgo/button/touchpad/touched",value:"/device/oculusgo/button/touchpad/value",axisX:"/device/oculusgo/axis/touchpadX",axisY:"/device/oculusgo/axis/touchpadY"},pose:"/device/oculusgo/pose",matrix:"/device/oculusgo/matrix",v:e=>"/vars/oculusgo/".concat(e)};const s="/device/gearVRController/";r.device.gearVRController={button:e=>({pressed:"".concat(s,"button/").concat(e,"/pressed"),touched:"".concat(s,"button/").concat(e,"/touched"),value:"".concat(s,"button/").concat(e,"/value")}),axis:e=>"".concat(s,"axis/").concat(e),pose:"".concat(s,"pose"),matrix:"".concat(s,"matrix"),v:e=>"/vars/gearVRController/".concat(e)};const l="/device/daydream/";r.device.daydream={button:e=>({pressed:"".concat(l,"button/").concat(e,"/pressed"),touched:"".concat(l,"button/").concat(e,"/touched"),value:"".concat(l,"button/").concat(e,"/value")}),axis:e=>"".concat(l,"axis/").concat(e),pose:"".concat(l,"pose"),matrix:"".concat(l,"matrix")};const c="/device/rightOculusTouch/";r.device.rightOculusTouch={button:e=>({pressed:"".concat(c,"button/").concat(e,"/pressed"),touched:"".concat(c,"button/").concat(e,"/touched"),value:"".concat(c,"button/").concat(e,"/value")}),axis:e=>"".concat(c,"axis/").concat(e),axesSum:"".concat(c,"axis/sum"),pose:"".concat(c,"pose"),matrix:"".concat(c,"matrix")};const d="/device/leftOculusTouch/";function u(e,t,n){return{pressed:"".concat(e).concat(t,"/button/").concat(n,"/pressed"),touched:"".concat(e).concat(t,"/button/").concat(n,"/touched"),value:"".concat(e).concat(t,"/button/").concat(n,"/value")}}function h(e,t,n){return{axisX:"".concat(e).concat(t,"/axis/").concat(n,"X"),axisY:"".concat(e).concat(t,"/axis/").concat(n,"Y")}}function p(e){const t="/device/wmr/";return{touchpad:a({},u(t,e,"touchpad"),h(t,e,"touchpad")),trigger:u(t,e,"trigger"),grip:u(t,e,"grip"),menu:u(t,e,"menu"),joystick:h(t,e,"joystick"),pose:"".concat(t).concat(e,"/pose"),matrix:"".concat(t).concat(e,"/matrix")}}r.device.leftOculusTouch={button:e=>({pressed:"".concat(d,"button/").concat(e,"/pressed"),touched:"".concat(d,"button/").concat(e,"/touched"),value:"".concat(d,"button/").concat(e,"/value")}),axis:e=>"".concat(d,"axis/").concat(e),axesSum:"".concat(d,"axis/sum"),pose:"".concat(d,"pose"),matrix:"".concat(d,"matrix")},r.device.vive={},r.device.vive.left={button:e=>({pressed:"/device/vive/left/button/".concat(e,"/pressed"),touched:"/device/vive/left/button/".concat(e,"/touched"),value:"/device/vive/left/button/".concat(e,"/value")}),axis:e=>"/device/vive/left/axis/".concat(e),axesSum:"/device/vive/left/axis/sum",pose:"/device/vive/left/pose",matrix:"/device/vive/left/matrix"},r.device.vive.right={button:e=>({pressed:"/device/vive/right/button/".concat(e,"/pressed"),touched:"/device/vive/right/button/".concat(e,"/touched"),value:"/device/vive/right/button/".concat(e,"/value")}),axis:e=>"/device/vive/right/axis/".concat(e),axesSum:"/device/vive/right/axis/sum",pose:"/device/vive/right/pose",matrix:"/device/vive/right/matrix"},r.device.wmr={},r.device.wmr.v=e=>"/vars/wmr/".concat(e),r.device.wmr.k=e=>"/vars/wmr/keyboard/".concat(e),r.device.wmr.left=p("left"),r.device.wmr.right=p("right");const m="/device/webxr/";r.device.webxr={},r.device.webxr.right={button:{trigger:u(m,"right","trigger"),grip:u(m,"right","grip"),touchpad:u(m,"right","touchpad"),a:u(m,"right","a"),b:u(m,"right","b"),thumbStick:u(m,"right","thumbStick")},axis:{touchpadX:"".concat(m,"right/axis/touchpadX"),touchpadY:"".concat(m,"right/axis/touchpadY"),joyX:"".concat(m,"right/axis/joyX"),joyY:"".concat(m,"right/axis/joyY")},pose:"".concat(m,"right/pose"),matrix:"".concat(m,"right/matrix")},r.device.webxr.left={button:{trigger:u(m,"left","trigger"),grip:u(m,"left","grip"),touchpad:u(m,"left","touchpad"),a:u(m,"left","a"),b:u(m,"left","b"),thumbStick:u(m,"left","thumbStick")},axis:{touchpadX:"".concat(m,"left/axis/touchpadX"),touchpadY:"".concat(m,"left/axis/touchpadY"),joyX:"".concat(m,"left/axis/joyX"),joyY:"".concat(m,"left/axis/joyY")},pose:"".concat(m,"left/pose"),matrix:"".concat(m,"left/matrix")}},20:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a={en:"English","zh-cn":"",pt:"Portugs (Brasil)",ja:"",es:"Espaol",ru:"P",fr:"Franais",ko:"",de:"Deutsch","zh-tw":""},i={jp:"ja"}},200:function(e,t,n){e.exports={"icon-button":"IconButton__icon-button__3PyMA",iconButton:"IconButton__icon-button__3PyMA","compact-sm":"IconButton__compact-sm__3NWNU",compactSm:"IconButton__compact-sm__3NWNU",lg:"IconButton__lg__1ss77"}},201:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0);let i=0;function r(){const[e]=Object(a.useState)(()=>"id_"+i++);return e}},202:function(e,t,n){e.exports={"support-main":"support__support-main__3QETt",supportMain:"support__support-main__3QETt","support-content":"support__support-content__3D3Yd",supportContent:"support__support-content__3D3Yd","unsupported-langs":"support__unsupported-langs__eyx9v",unsupportedLangs:"support__unsupported-langs__eyx9v",details:"support__details__3bRTj"}},203:function(e,t,n){e.exports={label:"InputField__label__1E124","input-field":"InputField__input-field__1zI_p",inputField:"InputField__input-field__1zI_p",fullWidth:"InputField__fullWidth__3lOtv",error:"InputField__error__1-GJA",info:"InputField__info__1i5VP"}},209:function(e,t){let n=0;const a=()=>1<<n++,i={ALL:-1,NONE:0,INTERACTABLES:a(),ENVIRONMENT:a(),AVATAR:a(),HANDS:a(),MEDIA_FRAMES:a()};i.DEFAULT_INTERACTABLE=i.INTERACTABLES|i.ENVIRONMENT|i.AVATAR|i.HANDS|i.MEDIA_FRAMES,i.UNOWNED_INTERACTABLE=i.INTERACTABLES|i.HANDS,i.DEFAULT_SPAWNER=i.INTERACTABLES|i.HANDS,e.exports={COLLISION_LAYERS:i}},21:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p}));var a,i,r,o,s=n(0),l=n(1),c=n.n(l);let d={NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}.APP_CONFIG;!d&&{NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}.STORYBOOK_APP_CONFIG&&(d=JSON.parse({NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}.STORYBOOK_APP_CONFIG)),d||(d=window.APP_CONFIG),(null===(a=d)||void 0===a||null===(i=a.theme)||void 0===i?void 0:i.error)&&console.error("Custom themes failed to load.\n".concat(d.theme.error,"\nIf you are an admin, reconfigure your themes in the admin panel."));const u=(null===(r=d)||void 0===r||null===(o=r.theme)||void 0===o?void 0:o.themes)||[];function h(e){const t=function(){const[e,t]=Object(s.useState)(!1);return Object(s.useEffect)(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");t(e.matches),e.addEventListener?e.addEventListener("change",e=>{t(e.matches)}):e.addListener(e=>{t(e.matches)})},[]),e}();Object(s.useEffect)(()=>{if(!Array.isArray(u))return;let n;if(e&&(n=u.find(t=>t.id===e)),!n&&t&&(n=u.find(e=>e.darkModeDefault)),n||(n=u.find(e=>e.default)),!n)return;const a=[];for(const e in n.variables)n.variables.hasOwnProperty(e)&&a.push("--".concat(e,": ").concat(n.variables[e],";"));const i=document.createElement("style");return i.innerHTML=":root {\n        ".concat(a.join("\n"),"\n      }"),document.head.appendChild(i),()=>{document.head.removeChild(i)}},[e,t])}function p({store:e,children:t}){return function(e){var t,n;const[a,i]=Object(s.useState)(null==e||null===(t=e.state)||void 0===t||null===(n=t.preferences)||void 0===n?void 0:n.theme);Object(s.useEffect)(()=>{function t(){var t,n;const r=null===(t=e.state)||void 0===t||null===(n=t.preferences)||void 0===n?void 0:n.theme;a!==r&&i(r)}return e&&e.addEventListener("statechanged",t),()=>{e&&e.removeEventListener("statechanged",t)}}),h(a)}(e),t}p.propTypes={store:c.a.object,children:c.a.node}},211:function(e,t,n){e.exports=n.p+"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png"},213:function(e,t,n){"use strict";function a(e){let t=0;const n={};return e.onmessage=t=>{const{id:a,result:i,err:r}=t.data,o=n[a];null==o?console.error("Unknown message with ID ".concat(a," received from ").concat(e,".")):(delete n[a],null!=r?o.reject(new Error(r)):o.resolve(i))},function(a,i,r={}){const o=t++,s=new Promise((e,t)=>{n[o]={resolve:e,reject:t}});return e.postMessage(Object.assign(r,{id:o,payload:a}),i),s}}n.d(t,"a",(function(){return a}))},214:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(70),i=n(4),r=n(8),o=n(36);function s(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){s(r,a,i,o,l,"next",e)}function l(e){s(r,a,i,o,l,"throw",e)}o(void 0)}))}}const c={entries:[],meta:{}},d={scenes:"scene_listings",images:"bing_images",videos:"bing_videos",youtube:"youtube_videos",gifs:"tenor",sketchfab:"sketchfab",twitch:"twitch",favorites:"favorites"},u=["sketchfab","videos","scenes","avatars","gifs","images"].filter(e=>{const t=d[e];return i.a.integration(t)}),h={gifs:"trending",sketchfab:"featured",scenes:"featured",favorites:"my-favorites"},p=["q","filter","cursor","similar_to"];class m extends a.a{constructor(){var e;super(),e=this,this._update=function(){var t=l((function*(t){e.result=null,e.dispatchEvent(new CustomEvent("statechanged"));const n=e.getUrlMediaSource(t);if(!n)return;e.previousSource&&e.previousSource===n||(e.dispatchEvent(new CustomEvent("sourcechanged")),e.previousSource=n);const a=new URLSearchParams(t.search);e.requestIndex++;const i=e.requestIndex,o=new URLSearchParams,s=new URLSearchParams(t.search),l=s.get("filter")&&s.get("filter").startsWith("my-");for(const e of p)a.get(e)&&o.set(e,a.get(e));let u;if(o.get("locale",navigator.languages[0]),"avatars"===n||"scenes"===n){const e="avatars"===n?"avatar":"scene";u="".concat(e,l?"s":"_listings")}else u=d[n];o.set("source",u);let h=!0;"avatars"!==u&&"scenes"!==u&&"favorites"!==u||l&&(window.APP.store.credentialsAccountId?o.set("user",window.APP.store.credentialsAccountId):h=!1);const m="/api/v1/media/search?".concat(o.toString()),f=Object(r.j)(m);if(e.lastSavedUrl===f)return;e.isFetching=!0,e.dispatchEvent(new CustomEvent("statechanged"));const g=h?yield Object(r.e)(m):c;e.requestIndex==i&&(e.result=g,e.nextCursor=e.result&&e.result.meta&&e.result.meta.next_cursor,e.lastFetchedUrl=f,e.isFetching=!1,e.dispatchEvent(new CustomEvent("statechanged")))}));return function(e){return t.apply(this,arguments)}}(),this.pageNavigate=e=>{if(-1===e)this.history.goBack();else{const e=this.history.location,t=new URLSearchParams(e.search);t.set("cursor",this.nextCursor),Object(o.d)(this.history,e.pathname,t.toString())}},this.filterQueryNavigate=(e,t)=>{const n=this.history.location,a=new URLSearchParams(n.search);a.delete("similar_to"),a.delete("similar_name"),t?a.set("q",t):a.delete("q"),e?a.set("filter",e):a.delete("filter"),e?a.set("cursor",e):a.delete("cursor"),Object(o.d)(this.history,n.pathname,a.toString())},this.getSearchClearedSearchParams=(e,t,n,a)=>{const i=new URLSearchParams(e.search);return i.delete("q"),i.delete("filter"),i.delete("cursor"),i.delete("similar_to"),i.delete("similar_name"),n||i.delete("media_nav"),t||i.delete("media_source"),a||i.delete("selectAction"),i},this._stashLastSearchParams=e=>{const t=new URLSearchParams(e.search);this._stashedParams={},this._stashedSource=null;const n=this.getUrlMediaSource(e);if("favorites"!==n){this._stashedSource=n;for(const e of p){const n=t.get(e);n&&(this._stashedParams[e]=n)}}},this.clearStashedQuery=()=>{this._stashedParams&&delete this._stashedParams.q},this.sourceNavigate=e=>{this._sourceNavigate(e,!1,!0)},this.sourceNavigateToDefaultSource=()=>{this._sourceNavigate(this._stashedSource?this._stashedSource:u[0],!1,!0)},this.sourceNavigateWithNoNav=(e,t)=>{this._sourceNavigate(e,!0,!1,t)},this._sourceNavigate=function(){var t=l((function*(t,n,a,s){const l=new URLSearchParams(e.history.location.search).get("q"),c=e.getSearchClearedSearchParams(e.history.location);if(l)c.set("q",l);else if(a&&e._stashedParams)for(const n of p){const a=e._stashedParams[n],i="q"===n||e._stashedSource===t;a&&i&&c.set(n,a)}else if("avatars"===t){const t=yield e._hasAccountWithAvatars();c.set("filter",t?"my-avatars":"featured")}else h[t]&&c.set("filter",h[t]);e._stashedParams=null,e._stashedSource=null,n&&c.set("media_nav","false"),s&&c.set("selectAction",s),Object(r.m)()&&document.location.host!==i.a.RETICULUM_SERVER?(c.set("media_source",t),Object(o.d)(e.history,e.history.location.pathname,c.toString())):Object(o.d)(e.history,Object(o.h)(e.history.location,"/media/".concat(t)),c.toString())}));return function(e,n,a,i){return t.apply(this,arguments)}}(),this._hasAccountWithAvatars=l((function*(){const{credentialsAccountId:e}=window.APP.store;if(!e)return!1;const t=new URLSearchParams;t.set("source","avatars"),t.set("user",e);const n=yield Object(r.e)("/api/v1/media/search?".concat(t.toString()));return!(!n||!n.entries)&&n.entries.length>0})),this.getUrlMediaSource=e=>{const{search:t}=e,n=new URLSearchParams(t),a=Object(o.g)(e);return a.startsWith("/media")||n.get("media_source")?n.get("media_source")||a.substring(7):null},this.pushExitMediaBrowserHistory=(e,t=!0)=>{e||(e=this.history),t&&this._stashLastSearchParams(e.location);const{pathname:n}=e.location,a=Object(o.g)(e.location).startsWith("/media");Object(o.d)(e,a?Object(o.h)(e.location,"/"):n,this.getSearchClearedSearchParams(e.location).toString()),this.dispatchEvent(new CustomEvent("media-exit"))},this.requestIndex=0}setHistory(e){this.history=e,this._update(this.history.location),this.history.listen(e=>{this._update(e)})}}},215:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M4.024 18.125H1.875v-2.148L13.99 3.832 16.17 6.01 4.024 18.125z",fill:o.color}),a.createElement("path",{d:"M16.63 5.547L14.453 3.37l1.237-1.197c.19-.193.484-.298.755-.298a1.011 1.011 0 01.72.298l.664.664a1.01 1.01 0 01.296.718c0 .273-.106.564-.298.756L16.63 5.547z",fill:o.color}))}o.defaultProps={color:"#000",title:"Pen"}},218:function(e,t,n){e.exports={popover:"Popover__popover__adrEn",content:"Popover__content__2ESLv",arrow:"Popover__arrow__OOaTx",header:"Popover__header__2snca","arrow-bg":"Popover__arrow-bg__TYK1s",arrowBg:"Popover__arrow-bg__TYK1s","arrow-border":"Popover__arrow-border__1a7Qc",arrowBorder:"Popover__arrow-border__1a7Qc",fullscreen:"Popover__fullscreen__18eZ5","fullscreen-body":"Popover__fullscreen-body__1jSzY",fullscreenBody:"Popover__fullscreen-body__1jSzY"}},219:function(e,t,n){e.exports={"back-button":"ObjectMenu__back-button__2HR09",backButton:"ObjectMenu__back-button__2HR09","lights-button":"ObjectMenu__lights-button__1sCQl",lightsButton:"ObjectMenu__lights-button__1sCQl","object-menu-container":"ObjectMenu__object-menu-container__ybwgq",objectMenuContainer:"ObjectMenu__object-menu-container__ybwgq","object-menu":"ObjectMenu__object-menu__3Hmi3",objectMenu:"ObjectMenu__object-menu__3Hmi3",header:"ObjectMenu__header__2KWZ6","close-button":"ObjectMenu__close-button__1VDyA",closeButton:"ObjectMenu__close-button__1VDyA","lights-header-button":"ObjectMenu__lights-header-button__1SYzz",lightsHeaderButton:"ObjectMenu__lights-header-button__1SYzz",menu:"ObjectMenu__menu__3g2o3","object-menu-button":"ObjectMenu__object-menu-button__1ETYJ",objectMenuButton:"ObjectMenu__object-menu-button__1ETYJ",separator:"ObjectMenu__separator__3g5K6",pagination:"ObjectMenu__pagination__2RKbj"}},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(28),d=n.n(c);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const p=Object(a.forwardRef)((e,t)=>{let{as:n,lastChildMargin:a,className:r,gap:o,padding:s,center:c,centerMd:p,grow:m,overflow:f,children:g}=e,v=h(e,["as","lastChildMargin","className","gap","padding","center","centerMd","grow","overflow","children"]);const b=!0===o?d.a.mdGap:d.a["".concat(o,"Gap")],y=!0===s?d.a.lgPadding:d.a["".concat(s,"Padding")];return i.a.createElement(n,u({},v,{ref:t,className:l()(d.a.column,b,y,{[d.a.center]:!0===c||"horizontal"===c||"both"===c,[d.a.centerVertical]:"vertical"===c||"both"===c,[d.a.centerMd]:!0===p||"horizontal"===p||"both"===p,[d.a.centerVerticalMd]:"vertical"===p||"both"===p,[d.a.grow]:m,[d.a.overflow]:f,[d.a.margin0LastChild]:a},r)}),g)});p.propTypes={as:o.a.elementType,className:o.a.string,children:o.a.node,gap:o.a.oneOfType([o.a.string,o.a.bool]),padding:o.a.oneOfType([o.a.string,o.a.bool]),centerMd:o.a.oneOfType([o.a.string,o.a.bool]),center:o.a.oneOfType([o.a.string,o.a.bool]),grow:o.a.bool,lastChildMargin:o.a.bool,overflow:o.a.bool},p.defaultProps={as:"div",gap:"md",center:!1,centerMd:!1,padding:!1,grow:!1,overflow:!1,lastChildMargin:!0}},227:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(78);const i=Object(a.b)();function r(){if(!i)return;let e=0;document.addEventListener("touchmove",e=>{1!==e.scale&&e.preventDefault()}),document.addEventListener("touchend",t=>{const n=(new Date).getTime(),a=n-e<=300;e=n,a&&t.preventDefault()})}},229:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M15.39 18.75a.625.625 0 01-.366-.118L10 14.99l-5.024 3.642a.625.625 0 01-.959-.706l1.96-5.803L.899 8.64A.625.625 0 011.25 7.5h6.265l1.89-5.819a.625.625 0 011.19 0l1.89 5.82h6.265a.624.624 0 01.354 1.141l-5.08 3.48 1.958 5.802a.624.624 0 01-.591.826z",fill:o.color}))}o.defaultProps={color:"#000",title:"Star"}},230:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(93);const i=Object(a.detect)(),r=["iOS","Mac OS"].includes(i.os)&&["safari","ios"].includes(i.name);function o(){return r}},232:function(e,t,n){e.exports={"media-grid":"MediaGrid__media-grid__10rNf",mediaGrid:"MediaGrid__media-grid__10rNf",sm:"MediaGrid__sm__30Dg9",center:"MediaGrid__center__2EOnM","variable-width":"MediaGrid__variable-width__3jnA2",variableWidth:"MediaGrid__variable-width__3jnA2"}},234:function(e,t,n){e.exports={"search-icon":"MediaBrowser__search-icon__sDw5R",searchIcon:"MediaBrowser__search-icon__sDw5R","favorite-icon":"MediaBrowser__favorite-icon__2H80P",favoriteIcon:"MediaBrowser__favorite-icon__2H80P","button-nav":"MediaBrowser__button-nav__2Yz5O",buttonNav:"MediaBrowser__button-nav__2Yz5O","facets-nav":"MediaBrowser__facets-nav__2IArx",facetsNav:"MediaBrowser__facets-nav__2IArx",content:"MediaBrowser__content__22rkT",pager:"MediaBrowser__pager__1PDRS","pager-button":"MediaBrowser__pager-button__10YHT",pagerButton:"MediaBrowser__pager-button__10YHT","no-results":"MediaBrowser__no-results__1GzFN",noResults:"MediaBrowser__no-results__1GzFN"}},235:function(e,t,n){e.exports={"border-tile":"CollapsiblePanel__border-tile__1Vv1C",borderTile:"CollapsiblePanel__border-tile__1Vv1C","borderless-tile":"CollapsiblePanel__borderless-tile__1ufmC",borderlessTile:"CollapsiblePanel__borderless-tile__1ufmC","rtc-debug-panel-root":"CollapsiblePanel__rtc-debug-panel-root__4uVPC",rtcDebugPanelRoot:"CollapsiblePanel__rtc-debug-panel-root__4uVPC","rtc-status-container":"CollapsiblePanel__rtc-status-container__1Yywm",rtcStatusContainer:"CollapsiblePanel__rtc-status-container__1Yywm","status-container-middle":"CollapsiblePanel__status-container-middle__2pQF2",statusContainerMiddle:"CollapsiblePanel__status-container-middle__2pQF2","rtc-status-container-right":"CollapsiblePanel__rtc-status-container-right__31_VM",rtcStatusContainerRight:"CollapsiblePanel__rtc-status-container-right__31_VM","rtc-status-container-left":"CollapsiblePanel__rtc-status-container-left__1op7a",rtcStatusContainerLeft:"CollapsiblePanel__rtc-status-container-left__1op7a","rtc-log-container":"CollapsiblePanel__rtc-log-container__2HW8Z",rtcLogContainer:"CollapsiblePanel__rtc-log-container__2HW8Z","rtc-log-time":"CollapsiblePanel__rtc-log-time__3nukv",rtcLogTime:"CollapsiblePanel__rtc-log-time__3nukv","rtc-log-text":"CollapsiblePanel__rtc-log-text__1MMc5",rtcLogText:"CollapsiblePanel__rtc-log-text__1MMc5","rtc-log-msg":"CollapsiblePanel__rtc-log-msg__livYJ",rtcLogMsg:"CollapsiblePanel__rtc-log-msg__livYJ","rtc-log-tag":"CollapsiblePanel__rtc-log-tag__3Ol6E",rtcLogTag:"CollapsiblePanel__rtc-log-tag__3Ol6E","rtc-log-msg-container":"CollapsiblePanel__rtc-log-msg-container__3gnKp",rtcLogMsgContainer:"CollapsiblePanel__rtc-log-msg-container__3gnKp","collapse-button":"CollapsiblePanel__collapse-button__2vUK3",collapseButton:"CollapsiblePanel__collapse-button__2vUK3","log-button":"CollapsiblePanel__log-button__3Nb1v",logButton:"CollapsiblePanel__log-button__3Nb1v","collapsible-content":"CollapsiblePanel__collapsible-content__tdm2-",collapsibleContent:"CollapsiblePanel__collapsible-content__tdm2-","collapsible-content-root":"CollapsiblePanel__collapsible-content-root__3_utC",collapsibleContentRoot:"CollapsiblePanel__collapsible-content-root__3_utC","collapsible-header":"CollapsiblePanel__collapsible-header__236oN",collapsibleHeader:"CollapsiblePanel__collapsible-header__236oN","collapsible-right-buttons":"CollapsiblePanel__collapsible-right-buttons__2xMCk",collapsibleRightButtons:"CollapsiblePanel__collapsible-right-buttons__2xMCk"}},236:function(e,t,n){e.exports={"border-tile":"RtcDebugPanel__border-tile__24pPW",borderTile:"RtcDebugPanel__border-tile__24pPW","borderless-tile":"RtcDebugPanel__borderless-tile__2Echk",borderlessTile:"RtcDebugPanel__borderless-tile__2Echk","rtc-debug-panel-root":"RtcDebugPanel__rtc-debug-panel-root__3Qcgf",rtcDebugPanelRoot:"RtcDebugPanel__rtc-debug-panel-root__3Qcgf","rtc-status-container":"RtcDebugPanel__rtc-status-container__1JFz8",rtcStatusContainer:"RtcDebugPanel__rtc-status-container__1JFz8","status-container-middle":"RtcDebugPanel__status-container-middle__32kw5",statusContainerMiddle:"RtcDebugPanel__status-container-middle__32kw5","rtc-status-container-right":"RtcDebugPanel__rtc-status-container-right__cdBji",rtcStatusContainerRight:"RtcDebugPanel__rtc-status-container-right__cdBji","rtc-status-container-left":"RtcDebugPanel__rtc-status-container-left__3QRgz",rtcStatusContainerLeft:"RtcDebugPanel__rtc-status-container-left__3QRgz","rtc-log-container":"RtcDebugPanel__rtc-log-container__CH4CI",rtcLogContainer:"RtcDebugPanel__rtc-log-container__CH4CI","rtc-log-time":"RtcDebugPanel__rtc-log-time__1BJtM",rtcLogTime:"RtcDebugPanel__rtc-log-time__1BJtM","rtc-log-text":"RtcDebugPanel__rtc-log-text__1IJrq",rtcLogText:"RtcDebugPanel__rtc-log-text__1IJrq","rtc-log-msg":"RtcDebugPanel__rtc-log-msg__2x3HB",rtcLogMsg:"RtcDebugPanel__rtc-log-msg__2x3HB","rtc-log-tag":"RtcDebugPanel__rtc-log-tag__3ND8l",rtcLogTag:"RtcDebugPanel__rtc-log-tag__3ND8l","rtc-log-msg-container":"RtcDebugPanel__rtc-log-msg-container__BNVW1",rtcLogMsgContainer:"RtcDebugPanel__rtc-log-msg-container__BNVW1"}},24:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={CAMERA_LAYER_DEFAULT:0,CAMERA_LAYER_XR_LEFT_EYE:1,CAMERA_LAYER_XR_RIGHT_EYE:2,CAMERA_LAYER_REFLECTION:3,CAMERA_LAYER_INSPECT:4,CAMERA_LAYER_BATCH_INSPECT:5,CAMERA_LAYER_VIDEO_TEXTURE_TARGET:6,CAMERA_LAYER_THIRD_PERSON_ONLY:7,CAMERA_LAYER_FIRST_PERSON_ONLY:8};AFRAME.registerComponent("layers",{schema:{reflection:{type:"boolean",default:!1},inWorldHud:{type:"boolean",default:!1},exclusive:{type:"boolean",default:!1}},init(){this.update=this.update.bind(this),this.el.addEventListener("model-loaded",this.update)},update(e){const t=this.el.object3D;this.data.exclusive&&t.traverse(e=>e.layers.mask=0);for(const[n,i]of Object.entries(a)){const a=e[n],r=this.data[n];a!==r&&(r?t.traverse(e=>e.layers.enable(i)):t.traverse(e=>e.layers.disable(i)))}},remove(){this.el.removeEventListener("model-loaded",this.update)}})},25:function(e,t,n){"use strict";n.d(t,"f",(function(){return B})),n.d(t,"v",(function(){return U})),n.d(t,"k",(function(){return z})),n.d(t,"l",(function(){return W})),n.d(t,"i",(function(){return q})),n.d(t,"w",(function(){return G})),n.d(t,"u",(function(){return Y})),n.d(t,"t",(function(){return K})),n.d(t,"y",(function(){return X})),n.d(t,"x",(function(){return Q})),n.d(t,"o",(function(){return J})),n.d(t,"q",(function(){return Z})),n.d(t,"j",(function(){return $})),n.d(t,"b",(function(){return ee})),n.d(t,"d",(function(){return te})),n.d(t,"n",(function(){return ne})),n.d(t,"s",(function(){return ae})),n.d(t,"c",(function(){return ie})),n.d(t,"e",(function(){return re})),n.d(t,"m",(function(){return oe})),n.d(t,"h",(function(){return se})),n.d(t,"g",(function(){return le})),n.d(t,"a",(function(){return ce})),n.d(t,"p",(function(){return ue})),n.d(t,"r",(function(){return he})),n.d(t,"z",(function(){return pe}));var a=n(155),i=n.n(a),r=n(397),o=n.n(r),s=n(324),l=n.n(s),c=n(398),d=n.n(c),u=n(399),h=n.n(u),p=n(400),m=n.n(p),f=n(401),g=n.n(f),v=n(402),b=n.n(v),y=n(403),E=n.n(y),w=n(404),_=n.n(w),S=n(405),x=n.n(S),A=n(325),M=n.n(A),k=n(406),O=n.n(k),C=n(407),P=n.n(C),R=n(408),T=n.n(R),j=n(409),D=n.n(j),I=n(410),L=n.n(I),H=n(11),N=n(230),F=n(10);let V=0;const B=V++,U=V++,z=V++,W=V++,q=V++,G=V++,Y=V++,K=V++,X=V++,Q=V++,J=V++,Z=V++,$=V++,ee=V++,te=V++,ne=V++,ae=V++,ie=V++,re=V++,oe=V++,se=V++,le=V++,ce=V++,de=V++,ue=V++,he=V++;class pe{constructor(e){this.pendingAudioSourceNodes=[],this.pendingPositionalAudios=[],this.positionalAudiosStationary=[],this.positionalAudiosFollowingObject3Ds=[],this.audioContext=THREE.AudioContext.getContext(),this.scene=e;const t=[[B,i.a],[U,i.a],[z,i.a],[W,i.a],[q,i.a],[G,i.a],[ce,i.a],[Y,o.a],[K,l.a],[X,l.a],[Q,i.a],[J,d.a],[Z,h.a],[$,m.a],[ee,g.a],[te,b.a],[ne,E.a],[ae,_.a],[ie,x.a],[re,M.a],[oe,O.a],[se,T.a],[le,P.a],[de,M.a],[ue,D.a],[he,L.a]],n=new Map,a=e=>{let t=n.get(e);return t||(t=fetch(e).then(e=>e.arrayBuffer()).then(e=>function(e,t){return new Promise((n,a)=>{e.decodeAudioData(t,n,a)})}(this.audioContext,e)),n.set(e,t)),t};this.sounds=new Map,t.map(([e,t])=>{a(t).then(t=>{this.sounds.set(e,t)})}),this.isDisabled=window.APP.store.state.preferences.disableSoundEffects,window.APP.store.addEventListener("statechanged",()=>{const e=window.APP.store.state.preferences.disableSoundEffects;e&&!this.isDisabled&&this.stopAllPositionalAudios(),this.isDisabled=e})}enqueueSound(e,t){if(this.isDisabled)return null;const n=this.sounds.get(e);if(!n)return null;const a=this.audioContext.createBufferSource();return a.buffer=n,this.scene.systems["hubs-systems"].audioSystem.addAudio({sourceType:F.g.SFX,node:a}),a.loop=t,this.pendingAudioSourceNodes.push(a),a}enqueuePositionalSound(e,t){if(this.isDisabled)return null;const n=this.sounds.get(e);if(!n)return null;const a=Object(N.a)()||window.APP.store.state.preferences.disableLeftRightPanning?new THREE.Audio(this.scene.audioListener):new THREE.PositionalAudio(this.scene.audioListener);return a.setBuffer(n),a.loop=t,this.pendingPositionalAudios.push(a),this.scene.systems["hubs-systems"].audioSystem.addAudio({sourceType:F.g.SFX,node:a}),a}playPositionalSoundAt(e,t,n){const a=this.enqueuePositionalSound(e,n);if(!a)return null;a.position.copy(t),a.matrixWorldNeedsUpdate=!0,this.positionalAudiosStationary.push(a)}playPositionalSoundFollowing(e,t,n){const a=this.enqueuePositionalSound(e,n);return a?(this.positionalAudiosFollowingObject3Ds.push({positionalAudio:a,object3D:t}),a):null}playSoundOneShot(e){return this.enqueueSound(e,!1)}playSoundLooped(e){return this.enqueueSound(e,!0)}playSoundLoopedWithGain(e){if(this.isDisabled)return null;const t=this.sounds.get(e);if(!t)return null;const n=this.audioContext.createBufferSource(),a=this.audioContext.createGain();return n.buffer=t,n.connect(a),this.scene.systems["hubs-systems"].audioSystem.addAudio({sourceType:F.g.SFX,node:a}),n.loop=!0,this.pendingAudioSourceNodes.push(n),{gain:a,source:n}}stopSoundNode(e){const t=this.pendingAudioSourceNodes.indexOf(e);-1!==t?this.pendingAudioSourceNodes.splice(t,1):(e.stop(),this.scene.systems["hubs-systems"].audioSystem.removeAudio({node:e}))}stopPositionalAudio(e){const t=this.pendingPositionalAudios.indexOf(e);-1!==t?this.pendingPositionalAudios.splice(t,1):(e.isPlaying&&e.stop(),e.parent&&e.removeFromParent()),this.positionalAudiosStationary=this.positionalAudiosStationary.filter(t=>t!==e),this.positionalAudiosFollowingObject3Ds=this.positionalAudiosFollowingObject3Ds.filter(({positionalAudio:t})=>t!==e),this.scene.systems["hubs-systems"].audioSystem.removeAudio({node:e})}stopAllPositionalAudios(){for(let e=this.positionalAudiosStationary.length-1;e>=0;e--){const t=this.positionalAudiosStationary[e];this.stopPositionalAudio(t)}for(let e=this.positionalAudiosFollowingObject3Ds.length-1;e>=0;e--){const t=this.positionalAudiosFollowingObject3Ds[e].positionalAudio;this.stopPositionalAudio(t)}}tick(){if(!this.isDisabled){for(let e=0;e<this.pendingAudioSourceNodes.length;e++)this.pendingAudioSourceNodes[e].start();this.pendingAudioSourceNodes.length=0;for(let e=0;e<this.pendingPositionalAudios.length;e++){const t=this.pendingPositionalAudios[e];this.scene.object3D.add(t),t.play()}this.pendingPositionalAudios.length=0;for(let e=this.positionalAudiosStationary.length-1;e>=0;e--){const t=this.positionalAudiosStationary[e];t.isPlaying||this.stopPositionalAudio(t)}for(let e=this.positionalAudiosFollowingObject3Ds.length-1;e>=0;e--){const t=this.positionalAudiosFollowingObject3Ds[e],n=t.positionalAudio,a=t.object3D;n.isPlaying&&a.parent?(a.updateMatrices(),Object(H.n)(n,a.matrixWorld)):this.stopPositionalAudio(n)}}}}},257:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(0),i=n.n(a);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function s(e){var t=e.title,n=e.titleId,i=o(e,["title","titleId"]);return a.createElement("svg",r({width:70,height:70,viewBox:"0 0 70 70",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M12.284 57.665A32.14 32.14 0 013.39 40.032a32.311 32.311 0 013.065-19.547A31.861 31.861 0 0120.307 6.49a31.414 31.414 0 0119.349-3.096m18.06 8.94a32.14 32.14 0 018.894 17.634 32.311 32.311 0 01-3.065 19.548A31.86 31.86 0 0149.693 63.51a31.413 31.413 0 01-19.348 3.096",stroke:i.color,strokeWidth:6}))}s.defaultProps={color:"#000",title:"Spinner"};var l=n(283),c=n.n(l);function d(){return i.a.createElement(s,{className:c.a.spinner})}},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M17 17L3 3",stroke:o.color,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M17 3L3 17",stroke:o.color,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}))}o.defaultProps={color:"#000",title:"Close"}},26:function(e,t,n){e.exports={button:"Button__button__2C3ps",basic:"Button__basic__2DMs5",transparent:"Button__transparent__mwQRf",primary:"Button__primary__emMw-",accept:"Button__accept__3uT0R",cancel:"Button__cancel__N3xQf",accent1:"Button__accent1__1zAmw",accent2:"Button__accent2__134e2",accent3:"Button__accent3__3Yct5",accent4:"Button__accent4__2jrJP",accent5:"Button__accent5__2s_w9",accent6:"Button__accent6__2anjb",sm:"Button__sm__2xDIc",lg:"Button__lg__-zn8l",xl:"Button__xl__4XioJ",thin:"Button__thin__3mkz4",thick:"Button__thick__3-pnm",signin:"Button__signin__3tVaW",landing:"Button__landing__27Ne-"}},267:function(e,t,n){"use strict";function a(e){return e*(2-e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const i=function(){const e=2*Math.PI,t=.3/e,n=Math.asin(1)*t;return function(e){return 1-1*Math.pow(2,-10*(e=+e))*Math.sin((e+n)/t)}}()},268:function(e,t,n){e.exports=n.p+"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg"},269:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(45),d=n.n(c);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e){var t=e.title,n=e.titleId,i=h(e,["title","titleId"]);return a.createElement("svg",u({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M3.343 17.43h13.314a1.25 1.25 0 001.1-1.842L11.102 3.223a1.25 1.25 0 00-2.202 0L2.242 15.588a1.25 1.25 0 001.1 1.842v0z",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M9.776 7.632L10 12.398l.224-4.764a.225.225 0 00-.227-.234v0a.224.224 0 00-.221.232v0z",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M10 15.517a.782.782 0 110-1.563.782.782 0 010 1.563z",fill:i.color}))}p.defaultProps={color:"#000",title:"Warning"};var m=n(26),f=n.n(m),g=n(200),v=n.n(g),b=n(98),y=n.n(b),E=n(174);const{detect:w}=n(93),_=w();let S=!1;function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function A(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const M=Object(a.memo)(Object(a.forwardRef)((e,t)=>{let{id:n,disabled:a,invalid:r,className:o,beforeInput:s,afterInput:c,onFocus:u,onBlur:h,textInputStyles:m,as:g}=e,b=A(e,["id","disabled","invalid","className","beforeInput","afterInput","onFocus","onBlur","textInputStyles","as"]);return i.a.createElement("div",{className:l()(d.a.outerWrapper,f.a.inputGroup,v.a.inputGroup,{[d.a.invalid]:r,[d.a.disabled]:a},o)},i.a.createElement("div",{className:d.a.beforeInput},s),i.a.createElement("div",{className:d.a.inputWrapper},i.a.createElement(g,x({id:n,className:l()(d.a.textInput,m),disabled:a,onFocus:e=>{!function(e){if(!window.AFRAME)return;const t=AFRAME.utils.device.isMobile();y.a.isFullscreen&&!AFRAME.utils.device.isMobileVR()&&"firefox"===_.name&&(S=!0,y.a.exit().then(()=>{e.focus()})),t||e.select()}(e.target),u&&u(e)},onBlur:e=>{S?S=!1:Object(E.b)(),h&&h(e)}},b,{ref:t}))),i.a.createElement("div",{className:d.a.afterInput},r&&i.a.createElement(p,{className:d.a.invalidIcon}),c))}));M.propTypes={id:o.a.string.isRequired,disabled:o.a.bool,invalid:o.a.bool,className:o.a.string,onChange:o.a.func,beforeInput:o.a.node,afterInput:o.a.node,onFocus:o.a.func,onBlur:o.a.func,textInputStyles:o.a.string,as:o.a.elementType},M.defaultProps={onChange:()=>{},as:"input"}},270:function(e,t,n){e.exports={list:"List__list__3Dc3X","list-item":"List__list-item__3WrR0",listItem:"List__list-item__3WrR0","list-item-content":"List__list-item-content__2IanG",listItemContent:"List__list-item-content__2IanG","button-list-item":"List__button-list-item__1uX4c",buttonListItem:"List__button-list-item__1uX4c",selected:"List__selected__1746_"}},271:function(e,t,n){e.exports={"toolbar-button":"ToolbarButton__toolbar-button__3-iHs",toolbarButton:"ToolbarButton__toolbar-button__3-iHs","icon-container":"ToolbarButton__icon-container__3LJEJ",iconContainer:"ToolbarButton__icon-container__3LJEJ",large:"ToolbarButton__large__1JH2K",basic:"ToolbarButton__basic__3YQM_",transparent:"ToolbarButton__transparent__3OB0a",selected:"ToolbarButton__selected__9i2OA",primary:"ToolbarButton__primary__1SVAK",accept:"ToolbarButton__accept__EdQyn",cancel:"ToolbarButton__cancel__3P9NA",accent1:"ToolbarButton__accent1__2-zPv",accent2:"ToolbarButton__accent2__doyFy",accent3:"ToolbarButton__accent3__Ch-MX",accent4:"ToolbarButton__accent4__2ODn2",accent5:"ToolbarButton__accent5__m3aEv","status-indicator":"ToolbarButton__status-indicator__1PEoq",statusIndicator:"ToolbarButton__status-indicator__1PEoq","status-enabled":"ToolbarButton__status-enabled__1HgFH",statusEnabled:"ToolbarButton__status-enabled__1HgFH","status-disabled":"ToolbarButton__status-disabled__2P2Sp",statusDisabled:"ToolbarButton__status-disabled__2P2Sp","status-unread":"ToolbarButton__status-unread__3AHbq",statusUnread:"ToolbarButton__status-unread__3AHbq","status-recording":"ToolbarButton__status-recording__DTFKv",statusRecording:"ToolbarButton__status-recording__DTFKv",left:"ToolbarButton__left__2Ki1k",middle:"ToolbarButton__middle__3QQW6",right:"ToolbarButton__right__2FcN-"}},28:function(e,t,n){e.exports={column:"Column__column__31daz","xs-gap":"Column__xs-gap__1rDPB",xsGap:"Column__xs-gap__1rDPB","sm-gap":"Column__sm-gap__dm1fW",smGap:"Column__sm-gap__dm1fW","md-gap":"Column__md-gap__2h1c8",mdGap:"Column__md-gap__2h1c8","lg-gap":"Column__lg-gap__3Gzec",lgGap:"Column__lg-gap__3Gzec","xl-gap":"Column__xl-gap__nKITg",xlGap:"Column__xl-gap__nKITg","xs-padding":"Column__xs-padding__3cdKO",xsPadding:"Column__xs-padding__3cdKO","sm-padding":"Column__sm-padding__2pY-s",smPadding:"Column__sm-padding__2pY-s","md-padding":"Column__md-padding__16bJT",mdPadding:"Column__md-padding__16bJT","lg-padding":"Column__lg-padding__3AA3L",lgPadding:"Column__lg-padding__3AA3L","xl-padding":"Column__xl-padding__1tOZj",xlPadding:"Column__xl-padding__1tOZj",center:"Column__center__Y9mvq","center-vertical":"Column__center-vertical__39UmF",centerVertical:"Column__center-vertical__39UmF","center-md":"Column__center-md__1vzWn",centerMd:"Column__center-md__1vzWn","center-vertical-md":"Column__center-vertical-md__130FA",centerVerticalMd:"Column__center-vertical-md__130FA",grow:"Column__grow__397q1",overflow:"Column__overflow__2fIrP","margin-0-last-child":"Column__margin-0-last-child__1mbso",margin0LastChild:"Column__margin-0-last-child__1mbso"}},282:function(e,t,n){e.exports=function(){return n(272)('!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.metaverseplus2.xyz/hubs/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var i=\n/*!\n * ZipLoader\n * (c) 2017 @yomotsu\n * Released under the MIT License.\n * \n * ZipLoader uses the library pako released under the MIT license :\n * https://github.com/nodeca/pako/blob/master/LICENSE\n */\nfunction(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,r),r+=a.length;return o}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(n)}));i.assign,i.shrinkBuf,i.setTyped,i.Buf8,i.Buf16,i.Buf32;var r=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(r=r+t[i++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0};var a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();var o=function(e,t,n,i){var r=a,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},s=function(e,t){var n,i,r,a,o,s,f,l,d,u,c,h,w,p,b,m,v,k,g,y,x,_,B,A,S;n=e.state,i=e.next_in,A=e.input,r=i+(e.avail_in-5),a=e.next_out,S=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),f=n.dmax,l=n.wsize,d=n.whave,u=n.wnext,c=n.window,h=n.hold,w=n.bits,p=n.lencode,b=n.distcode,m=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=p[h&m];t:for(;;){if(h>>>=g=k>>>24,w-=g,0===(g=k>>>16&255))S[a++]=65535&k;else{if(!(16&g)){if(0==(64&g)){k=p[(65535&k)+(h&(1<<g)-1)];continue t}if(32&g){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}y=65535&k,(g&=15)&&(w<g&&(h+=A[i++]<<w,w+=8),y+=h&(1<<g)-1,h>>>=g,w-=g),w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=b[h&v];n:for(;;){if(h>>>=g=k>>>24,w-=g,!(16&(g=k>>>16&255))){if(0==(64&g)){k=b[(65535&k)+(h&(1<<g)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&k,w<(g&=15)&&(h+=A[i++]<<w,(w+=8)<g&&(h+=A[i++]<<w,w+=8)),(x+=h&(1<<g)-1)>f){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=g,w-=g,x>(g=a-o)){if((g=x-g)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(_=0,B=c,0===u){if(_+=l-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}else if(u<g){if(_+=l+u-g,(g-=u)<y){y-=g;do{S[a++]=c[_++]}while(--g);if(_=0,u<y){y-=g=u;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}}else if(_+=u-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}for(;y>2;)S[a++]=B[_++],S[a++]=B[_++],S[a++]=B[_++],y-=3;y&&(S[a++]=B[_++],y>1&&(S[a++]=B[_++]))}else{_=a-x;do{S[a++]=S[_++],S[a++]=S[_++],S[a++]=S[_++],y-=3}while(y>2);y&&(S[a++]=S[_++],y>1&&(S[a++]=S[_++]))}break}}break}}while(i<r&&a<s);i-=y=w>>3,h&=(1<<(w-=y<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=h,n.bits=w},f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],c=function(e,t,n,r,a,o,s,c){var h,w,p,b,m,v,k,g,y,x=c.bits,_=0,B=0,A=0,S=0,U=0,C=0,j=0,O=0,T=0,z=0,R=null,E=0,L=new i.Buf16(16),D=new i.Buf16(16),P=null,H=0;for(_=0;_<=15;_++)L[_]=0;for(B=0;B<r;B++)L[t[n+B]]++;for(U=x,S=15;S>=1&&0===L[S];S--);if(U>S&&(U=S),0===S)return a[o++]=20971520,a[o++]=20971520,c.bits=1,0;for(A=1;A<S&&0===L[A];A++);for(U<A&&(U=A),O=1,_=1;_<=15;_++)if(O<<=1,(O-=L[_])<0)return-1;if(O>0&&(0===e||1!==S))return-1;for(D[1]=0,_=1;_<15;_++)D[_+1]=D[_]+L[_];for(B=0;B<r;B++)0!==t[n+B]&&(s[D[t[n+B]]++]=B);if(0===e?(R=P=s,v=19):1===e?(R=f,E-=257,P=l,H-=257,v=256):(R=d,P=u,v=-1),z=0,B=0,_=A,m=o,C=U,j=0,p=-1,b=(T=1<<U)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){k=_-j,s[B]<v?(g=0,y=s[B]):s[B]>v?(g=P[H+s[B]],y=R[E+s[B]]):(g=96,y=0),h=1<<_-j,A=w=1<<C;do{a[m+(z>>j)+(w-=h)]=k<<24|g<<16|y|0}while(0!==w);for(h=1<<_-1;z&h;)h>>=1;if(0!==h?(z&=h-1,z+=h):z=0,B++,0==--L[_]){if(_===S)break;_=t[n+s[B]]}if(_>U&&(z&b)!==p){for(0===j&&(j=U),m+=A,O=1<<(C=_-j);C+j<S&&!((O-=L[C+j])<=0);)C++,O<<=1;if(T+=1<<C,1===e&&T>852||2===e&&T>592)return 1;a[p=z&b]=U<<24|C<<16|m-o|0}}return 0!==z&&(a[m+z]=_-j<<24|64<<16|0),c.bits=U,0};function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function b(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,p(e)):-2}function m(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,b(e))):-2}function v(e,t){var n,i;return e?(i=new w,e.state=i,i.window=null,0!==(n=m(e,t))&&(e.state=null),n):-2}var k,g,y=!0;function x(e){if(y){var t;for(k=new i.Buf32(512),g=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(c(1,e.lens,0,288,k,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;c(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=k,e.lenbits=9,e.distcode=g,e.distbits=5}function _(e,t,n,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>r&&(a=r),i.arraySet(o.window,t,n-r,a,o.wnext),(r-=a)?(i.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}var B={inflateReset:b,inflateReset2:m,inflateResetKeep:p,inflateInit:function(e){return v(e,15)},inflateInit2:v,inflate:function(e,t){var n,a,f,l,d,u,w,p,b,m,v,k,g,y,B,A,S,U,C,j,O,T,z,R,E=0,L=new i.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,m=u,v=w,T=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(2&n.wrap&&35615===p){n.check=0,L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0),p=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&p)){e.msg="unknown compression method",n.mode=30;break}if(b-=4,O=8+(15&(p>>>=4)),0===n.wbits)n.wbits=O;else if(O>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<O,e.adler=n.check=1,n.mode=512&p?10:12,p=0,b=0;break;case 2:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.flags=p,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.time=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,L[2]=p>>>16&255,L[3]=p>>>24&255,n.check=o(n.check,L,4,0)),p=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((k=n.length)>u&&(k=u),k&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,a,l,k,O)),512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}p=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}e.adler=n.check=h(p),p=0,b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){p>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}switch(n.last=1&p,b-=1,3&(p>>>=1)){case 0:n.mode=14;break;case 1:if(x(n),n.mode=20,6===t){p>>>=2,b-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}p>>>=2,b-=2;break;case 14:for(p>>>=7&b,b-=7&b;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if((65535&p)!=(p>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&p,p=0,b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(k=n.length){if(k>u&&(k=u),k>w&&(k=w),0===k)break e;i.arraySet(f,a,l,k,d),u-=k,l+=k,w-=k,d+=k,n.length-=k;break}n.mode=12;break;case 17:for(;b<14;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.nlen=257+(31&p),p>>>=5,b-=5,n.ndist=1+(31&p),p>>>=5,b-=5,n.ncode=4+(15&p),p>>>=4,b-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.lens[D[n.have++]]=7&p,p>>>=3,b-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},T=c(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,T){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(S<16)p>>>=B,b-=B,n.lens[n.have++]=S;else{if(16===S){for(R=B+2;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p>>>=B,b-=B,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}O=n.lens[n.have-1],k=3+(3&p),p>>>=2,b-=2}else if(17===S){for(R=B+3;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=3+(7&(p>>>=B)),p>>>=3,b-=3}else{for(R=B+7;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=11+(127&(p>>>=B)),p>>>=7,b-=7}if(n.have+k>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;k--;)n.lens[n.have++]=O}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,z={bits:n.lenbits},T=c(1,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,T){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},T=c(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,T){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(u>=6&&w>=258){e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,s(e,v),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(A&&0==(240&A)){for(U=B,C=A,j=S;A=(E=n.lencode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,n.length=S,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=12;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(R=n.extra;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(E=n.distcode[p&(1<<n.distbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(0==(240&A)){for(U=B,C=A,j=S;A=(E=n.distcode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=S,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(R=n.extra;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===w)break e;if(k=v-w,n.offset>k){if((k=n.offset-k)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}k>n.wnext?(k-=n.wnext,g=n.wsize-k):g=n.wnext-k,k>n.length&&(k=n.length),y=n.window}else y=f,g=d-n.offset,k=n.length;k>w&&(k=w),w-=k,n.length-=k;do{f[d++]=y[g++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;f[d++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===u)break e;u--,p|=a[l++]<<b,b+=8}if(v-=w,e.total_out+=v,n.total+=v,v&&(e.adler=n.check=n.flags?o(n.check,f,v,d-v):r(n.check,f,v,d-v)),v=w,(n.flags?p:h(p))!==n.check){e.msg="incorrect data check",n.mode=30;break}p=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}p=0,b=0}n.mode=29;case 29:T=1;break e;case 30:T=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,(n.wsize||v!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&_(e,e.output,e.next_out,v-e.avail_out)?(n.mode=31,-4):(m-=e.avail_in,v-=e.avail_out,e.total_in+=m,e.total_out+=v,n.total+=v,n.wrap&&v&&(e.adler=n.check=n.flags?o(n.check,f,v,e.next_out-v):r(n.check,f,v,e.next_out-v)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===m&&0===v||4===t)&&0===T&&(T=-5),T)},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&r(1,t,i,0)!==n.check?-3:_(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},A=!0,S=!0;try{String.fromCharCode.apply(null,[0])}catch(e){A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){S=!1}for(var U=new i.Buf8(256),C=0;C<256;C++)U[C]=C>=252?6:C>=248?5:C>=240?4:C>=224?3:C>=192?2:1;U[254]=U[254]=1;function j(e,t){if(t<65537&&(e.subarray&&S||!e.subarray&&A))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var O=function(e){var t,n,r,a,o,s=e.length,f=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),f+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(f),o=0,a=0;o<f;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},T=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},z=function(e,t){var n,i,r,a,o=t||e.length,s=new Array(2*o);for(i=0,n=0;n<o;)if((r=e[n++])<128)s[i++]=r;else if((a=U[r])>4)s[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<o;)r=r<<6|63&e[n++],a--;a>1?s[i++]=65533:r<65536?s[i++]=r:(r-=65536,s[i++]=55296|r>>10&1023,s[i++]=56320|1023&r)}return j(s,i)},R=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+U[e[n]]>t?n:t},E=0,L=2,D=4,P=0,H=1,I=2,N=-5,J={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var M=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};var $=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},G=Object.prototype.toString;function V(e){if(!(this instanceof V))return new V(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var n=B.inflateInit2(this.strm,t.windowBits);if(n!==P)throw new Error(J[n]);this.header=new $,B.inflateGetHeader(this.strm,this.header)}function q(e,t){var n=new V(t);if(n.push(e,!0),n.err)throw n.msg||J[n.err];return n.result}V.prototype.push=function(e,t){var n,r,a,o,s,f,l=this.strm,d=this.options.chunkSize,u=this.options.dictionary,c=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?D:E,"string"==typeof e?l.input=T(e):"[object ArrayBuffer]"===G.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new i.Buf8(d),l.next_out=0,l.avail_out=d),(n=B.inflate(l,E))===I&&u&&(f="string"==typeof u?O(u):"[object ArrayBuffer]"===G.call(u)?new Uint8Array(u):u,n=B.inflateSetDictionary(this.strm,f)),n===N&&!0===c&&(n=P,c=!1),n!==H&&n!==P)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&n!==H&&(0!==l.avail_in||r!==D&&r!==L)||("string"===this.options.to?(a=R(l.output,l.next_out),o=l.next_out-a,s=z(l.output,a),l.next_out=o,l.avail_out=d-o,o&&i.arraySet(l.output,l.output,a,o,0),this.onData(s)):this.onData(i.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(c=!0)}while((l.avail_in>0||0===l.avail_out)&&n!==H);return n===H&&(r=D),r===D?(n=B.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===P):r!==L||(this.onEnd(P),l.avail_out=0,!0)},V.prototype.onData=function(e){this.chunks.push(e)},V.prototype.onEnd=function(e){e===P&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var F={Inflate:V,inflate:q,inflateRaw:function(e,t){return(t=t||{}).raw=!0,q(e,t)},ungzip:q};var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?"getUint32":2===e?"getUint16":"getUint8",n=this.position;return this.position+=e,this.dataView[t](n,!0)},e}(),X=function(e){for(var t=new K(e),n={};;){var i=t.readBytes(4);if(67324752!==i){if(33639248!==i)break;W(t)}else{var r=Q(t);n[r.name]={buffer:r.buffer}}}return n},Q=function(e){var t=0,n=void 0;e.skip(4);var i=e.readBytes(2);e.skip(8);var r=e.readBytes(4);e.skip(4);var a=e.readBytes(2),o=e.readBytes(2),s=[],f=new Uint8Array(r);for(t=0;t<a;t++)s.push(String.fromCharCode(e.readBytes(1)));for(e.skip(o),t=0;t<r;t++)f[t]=e.readBytes(1);switch(i){case 0:n=f;break;case 8:n=new Uint8Array(F.inflate(f,{raw:!0}));break;default:console.log(s.join("")+": unsupported compression type"),n=f}return{name:s.join(""),buffer:n}},W=function(e){e.skip(24);var t=e.readBytes(2),n=e.readBytes(2),i=e.readBytes(2);e.skip(12),e.skip(t),e.skip(n),e.skip(i)};var Y="function"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(){};return t((function(){n()})),{then:function(e){n=e}}};var Z=0,ee=void 0,te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=Z,this._listeners={},this.url=t,this.files=null,Z++}return e.unzip=function(t){return new Y((function(n){var i=new e,r=new FileReader;r.onload=function(e){var t=e.target.result;i.files=X(t),n(i)},t instanceof Blob&&r.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new Y((function(t){var n=Date.now(),i=new XMLHttpRequest;i.open("GET",e.url,!0),i.responseType="arraybuffer",i.onprogress=function(t){e.dispatch({type:"progress",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-n})},i.onload=function(){e.files=X(i.response),e.dispatch({type:"load",elapsedTime:Date.now()-n}),t()},i.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var n=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(n),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var n="",i=0,r=t.length;i<r;i++)n+=String.fromCharCode(t[i]);return decodeURIComponent(escape(n))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,n=this.extractAsJSON(e),i=e.replace(/\\/.+\\.json$/,"/"),r="__ziploader_"+this._id+"__",a=new RegExp(r);return-1!==!ee.Loader.Handlers.handlers.indexOf(a)&&ee.Loader.Handlers.add(a,{load:function(e){return t.loadThreeTexture(e.replace(a,""))}}),ee.JSONLoader.prototype.parse(n,r+i)},e.prototype.loadThreeTexture=function(e){var t=new ee.Texture,n=/\\.jpg$/.test(e)?"image/jpeg":/\\.png$/.test(e)?"image/png":/\\.gif$/.test(e)?"image/gif":void 0,i=new Blob([this.files[e].buffer],{type:n});return t.image=new Image,t.image.addEventListener("load",(function e(){t.needsUpdate=!0,t.image.removeEventListener("load",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(i),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var n=this._listeners[e];if(n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var n=t.length,i=0;i<n;i++)t[i].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,ee){var n="__ziploader_"+this._id+"__";ee.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===n)return ee.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(ee=e.THREE)},e}();function ne(e,t,n,i,r,a,o){try{var s=e[a](o),f=s.value}catch(e){return void n(e)}s.done?t(f):Promise.resolve(f).then(i,r)}function ie(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){ne(a,i,r,o,s,"next",e)}function s(e){ne(a,i,r,o,s,"throw",e)}o(void 0)}))}}function re(){return(re=ie((function*(e){const t=new te(e);return t.load().then(()=>{const e={};for(const n in t.files)e[n]=t.extractAsBlobUrl(n);const n=JSON.parse(t.extractAsText("scene.gltf"));return n.buffers&&n.buffers.forEach(t=>t.uri=e[t.uri]),n.images&&n.images.forEach(t=>t.uri=e[t.uri]),e["scene.gtlf"]=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:"text/plain"})),e})}))).apply(this,arguments)}self.onmessage=function(){var e=ie((function*(e){try{const t=yield function(e){return re.apply(this,arguments)}(e.data.payload);self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}));return function(t){return e.apply(this,arguments)}}()}]);\n//# sourceMappingURL=sketchfab-zip.worker-7073275d8e44913c60f4.js.map',"/assets/js/sketchfab-zip.worker-7073275d8e44913c60f4.js")}},283:function(e,t,n){e.exports={spinner:"Spinner__spinner__Cx7Nr"}},284:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(30),i=n(214),r=n(12);class o{constructor(){this.scene=null,this.store=new a.a,this.mediaSearchStore=new i.b,this.hubChannel=null,this.mediaDevicesManager=null,this.audios=new Map,this.sourceType=new Map,this.audioOverrides=new Map,this.zoneOverrides=new Map,this.audioDebugPanelOverrides=new Map,this.sceneAudioDefaults=new Map,this.gainMultipliers=new Map,this.supplementaryAttenuation=new Map,this.clippingState=new Set,this.mutedState=new Set,this.isAudioPaused=new Set}setupRenderer(e){const t=document.createElement("canvas");t.classList.add("a-canvas"),t.dataset.aframeCanvas=!0,t.addEventListener("touchmove",(function(e){e.preventDefault()}));const n=new THREE.WebGLRenderer({alpha:!1,antialias:!0,depth:!0,stencil:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,logarithmicDepthBuffer:!1,powerPreference:"default",canvas:t});n.setPixelRatio(window.devicePixelRatio),n.debug.checkShaderErrors=Object(r.a)("checkShaderErrors"),n.physicallyCorrectLights=!0,n.outputEncoding=THREE.sRGBEncoding,e.appendChild(n.domElement);const a=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.05,1e4),i=new THREE.AudioListener;a.add(i);const o=new THREE.Clock;function s(t,i){const r=1e3*o.getDelta(),s=1e3*o.elapsedTime;e.frame=i,e.isPlaying&&e.tick(s,r),n.render(e.object3D,a)}return e.clock=o,e.addEventListener("loaded",()=>{n.setAnimationLoop(s),e.renderStarted=!0}),{renderer:n,camera:a,audioListener:i}}}},290:function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return I}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(364),d=n(6),u=n(625),h=n(82),p=n.n(h),m=n(316),f=n(229),g=n(317),v=n(215);function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function y(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function E(e){var t=e.title,n=e.titleId,i=y(e,["title","titleId"]);return a.createElement("svg",b({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M15.898 5H7.227C5.997 5 5 5.996 5 7.226v8.672c0 1.23.997 2.227 2.227 2.227h8.671c1.23 0 2.227-.997 2.227-2.227V7.226c0-1.23-.997-2.226-2.227-2.226z",stroke:i.color,strokeWidth:1.5,strokeLinejoin:"round"}),a.createElement("path",{d:"M14.98 5l.02-.938a2.194 2.194 0 00-2.188-2.188H4.376a2.507 2.507 0 00-2.5 2.5v8.438a2.194 2.194 0 002.188 2.187H5",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M11.563 8.437v6.25",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M14.688 11.562h-6.25",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}E.defaultProps={color:"#000",title:"Duplicate"};var w=n(318);function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function x(e){var t=e.title,n=e.titleId,i=S(e,["title","titleId"]);return a.createElement("svg",_({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M10 2a8 8 0 100 16 8 8 0 000-16z",stroke:i.color,strokeMiterlimit:10}),a.createElement("path",{d:"M7.454 7.56s.039-.796.89-1.48c.505-.407 1.11-.525 1.656-.533.497-.007.94.076 1.206.202.454.216 1.34.745 1.34 1.868 0 1.182-.773 1.718-1.654 2.309-.88.59-1.12 1.231-1.12 1.893",stroke:i.color,strokeMiterlimit:10,strokeLinecap:"round"}),a.createElement("path",{d:"M9.855 14.844a.786.786 0 100-1.57.786.786 0 000 1.57z",fill:i.color}))}x.defaultProps={color:"#000",title:"Help"};function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function M(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function k(e){var t=e.title,n=e.titleId,i=M(e,["title","titleId"]);return a.createElement("svg",A({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},i),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M15 8.749v7.188a1.563 1.563 0 01-1.563 1.562H4.063A1.563 1.563 0 012.5 15.937V6.562a1.562 1.562 0 011.563-1.563h6.542",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M13.125 2.5H17.5v4.375",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M8.75 11.248l8.438-8.437",stroke:i.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}k.defaultProps={color:"#000",title:"External Link"};function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const P={sketchfab_model:"Sketchfab",twitch_stream:"Twitch"};function R(e,t){const n=e.type.endsWith("_image"),i="avatar"===e.type||"avatar_listing"===e.type,r=e.images.preview.width/e.images.preview.height,[o,s]=function(e,t,n){return Object(a.useMemo)(()=>{let a,i=220;return t&&(i=Math.floor(1.5*i)),a=e?Math.floor(Math.max(n*i,.85*i)):t?Math.floor(9/16*i):Math.floor(Math.max(16/9*i,.85*i)),[a,i]},[e,t,n])}(n,i,r);return[Object(a.useMemo)(()=>t?t(e,o,s):e.images.preview.url,[e,o,s,t]),o,s]}function T(e){let t,{as:n,className:a,name:r,description:o,tall:s,wide:c,children:d}=e,u=C(e,["as","className","name","description","tall","wide","children"]);return"div"===n&&(t={tabIndex:"0",role:"button"}),i.a.createElement(n,O({className:l()(p.a.mediaTile,{[p.a.tall]:s,[p.a.wide]:c},a)},t,u),i.a.createElement("div",{className:p.a.thumbnailContainer},d),(r||o)&&i.a.createElement("div",{className:p.a.info},i.a.createElement("b",null,r),o&&i.a.createElement("small",{className:p.a.description},o)))}function j(e){let{className:t,children:n}=e,a=C(e,["className","children"]);return i.a.createElement("button",O({type:"button",className:l()(p.a.tileAction,t)},a),n)}function D(e){let{label:t,type:n}=e,a=C(e,["label","type"]);return i.a.createElement(T,O({className:p.a.createTile,wide:"scene"===n,tall:"avatar"===n},a),i.a.createElement("div",{className:p.a.createTileContent},i.a.createElement(g.a,{width:48,height:48}),i.a.createElement("p",null,t)))}function I(e){let{entry:t,processThumbnailUrl:n,onClick:a,onEdit:r,onShowSimilar:o,onCopy:s,onInfo:l}=e,h=C(e,["entry","processThumbnailUrl","onClick","onEdit","onShowSimilar","onCopy","onInfo"]);const g=Object(c.a)(),b=t.attributions&&t.attributions.creator,y=t.attributions&&t.attributions.publisher&&t.attributions.publisher.name||P[t.type],[_,S,A]=R(t,n);return i.a.createElement(T,O({wide:"scene"===t.type||"scene_listing"===t.type||"room"===t.type,tall:"avatar"===t.type||"avatar_listing"===t.type,name:t.name,description:i.a.createElement(i.a.Fragment,null,b&&void 0===b.name&&i.a.createElement("span",null,b),b&&b.name&&!b.url&&i.a.createElement("span",null,b.name),b&&b.name&&b.url&&i.a.createElement("a",{href:b.url,target:"_blank",rel:"noopener noreferrer"},b.name),y&&i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},i.a.createElement(k,null)," ",y)),t.last_activated_at&&i.a.createElement("small",null,i.a.createElement(d.a,{id:"media-tile.joined-room",defaultMessage:"Joined {relativeTime}",values:{relativeTime:i.a.createElement(u.a,{updateIntervalInSeconds:10,value:(new Date(t.last_activated_at).getTime()-Date.now())/1e3})}})))},h),i.a.createElement("a",{className:p.a.thumbnailLink,href:t.url,rel:"noreferrer noopener",onClick:a},"mp4"===t.images.preview.type?i.a.createElement("video",{muted:!0,autoPlay:!0,playsInline:!0,loop:!0,src:_,alt:t.name,width:S,height:A}):i.a.createElement("img",{src:_,alt:t.name,width:S,height:A})),t.favorited&&i.a.createElement(f.a,{className:p.a.favoriteIcon}),void 0!==t.member_count&&i.a.createElement("div",{className:p.a.memberCount},i.a.createElement(m.a,null)," ",i.a.createElement("span",null,t.member_count)),i.a.createElement("div",{className:p.a.tileActions},"avatar"===t.type&&i.a.createElement(j,{title:g.formatMessage({id:"media-tile.action.edit-avatar",defaultMessage:"Edit avatar"}),onClick:r},i.a.createElement(v.a,null)),"scene"===t.type&&t.project_id&&i.a.createElement(j,{onClick:r,title:g.formatMessage({id:"media-tile.action.edit-scene",defaultMessage:"Edit scene"})},i.a.createElement(v.a,null)),"avatar_listing"===t.type&&i.a.createElement(j,{title:g.formatMessage({id:"media-tile.action.show-similar-avatars",defaultMessage:"Show similar avatars"}),onClick:o},i.a.createElement(w.a,null)),"avatar_listing"===t.type&&t.allow_remixing&&i.a.createElement(j,{title:g.formatMessage({id:"media-tile.action.copy-avatar",defaultMessage:"Copy to my avatars"}),onClick:s},i.a.createElement(E,null)),"scene_listing"===t.type&&t.allow_remixing&&i.a.createElement(j,{title:g.formatMessage({id:"media-tile.action.copy-scene",defaultMessage:"Copy to my scenes"}),onClick:s},i.a.createElement(E,null)),"room"===t.type&&l&&t.description&&i.a.createElement(j,{title:g.formatMessage({id:"media-tile.action.room-info",defaultMessage:"Room info"}),onClick:l},i.a.createElement(x,null))))}T.propTypes={as:o.a.elementType,className:o.a.string,name:o.a.string,description:o.a.node,children:o.a.node,tall:o.a.bool,wide:o.a.bool},T.defaultProps={as:"div"},j.propTypes={className:o.a.string,children:o.a.node},D.propTypes={label:o.a.node,type:o.a.string},I.propTypes={entry:o.a.object.isRequired,processThumbnailUrl:o.a.func,onClick:o.a.func,onEdit:o.a.func,onShowSimilar:o.a.func,onCopy:o.a.func,onInfo:o.a.func}},292:function(e,t,n){e.exports={toolbar:"Toolbar__toolbar__A751R",content:"Toolbar__content__re76m"}},293:function(e,t,n){e.exports={"toggle-input":"ToggleInput__toggle-input__3ReS2",toggleInput:"ToggleInput__toggle-input__3ReS2",track:"ToggleInput__track__3L23X",disabled:"ToggleInput__disabled__2QeSg","label-container":"ToggleInput__label-container__2kq7M",labelContainer:"ToggleInput__label-container__2kq7M",label:"ToggleInput__label__3fVT7",description:"ToggleInput__description__Wffxp",button:"ToggleInput__button__TabR1"}},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var a=n(111),i=n(69),r=n(54),o=n.n(r),s=n(34),l=n.n(s),c=n(12),d=n(70),u=n(8),h=n(59),p=n.n(h);function m(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){m(r,a,i,o,s,"next",e)}function s(e){m(r,a,i,o,s,"throw",e)}o(void 0)}))}}const g=["Baers-Pochard","Baikal-Teal","Barrows-Goldeneye","Blue-Billed","Blue-Duck","Blue-Winged","Brown-Teal","Bufflehead","Canvasback","Cape-Shoveler","Chestnut-Teal","Chiloe-Wigeon","Cinnamon-Teal","Comb-Duck","Common-Eider","Common-Goldeneye","Common-Merganser","Common-Pochard","Common-Scoter","Common-Shelduck","Cotton-Pygmy","Crested-Duck","Crested-Shelduck","Eatons-Pintail","Falcated","Ferruginous","Freckled-Duck","Gadwall","Garganey","Greater-Scaup","Green-Pygmy","Grey-Teal","Hardhead","Harlequin","Hartlaubs","Hooded-Merganser","Kelp-Goose","King-Eider","Lake-Duck","Laysan-Duck","Lesser-Scaup","Long-Tailed","Maccoa-Duck","Mallard","Mandarin","Marbled-Teal","Mellers-Duck","Merganser","Northern-Pintail","Orinoco-Goose","Paradise-Shelduck","Plumed-Whistler","Puna-Teal","Pygmy-Goose","Radjah-Shelduck","Red-Billed","Red-Crested","Red-Shoveler","Ring-Necked","Ringed-Teal","Rosy-Billed","Ruddy-Shelduck","Salvadoris-Teal","Scaly-Sided","Shelduck","Shoveler","Silver-Teal","Smew","Spectacled-Eider","Spot-Billed","Spotted-Whistler","Steamerduck","Stellers-Eider","Sunda-Teal","Surf-Scoter","Tufted-Duck","Velvet-Scoter","Wandering-Whistler","Whistling-duck","White-Backed","White-Cheeked","White-Winged","Wigeon","Wood-Duck","Yellow-Billed"];function v(e){return e[Math.floor(Math.random()*e.length)]}function b(){return y.apply(this,arguments)}function y(){return(y=f((function*(){const e=(yield Object(u.e)("/api/v1/media/search?filter=default&source=avatar_listings")).entries||[];if(0===e.length)return new URL(p.a,location.href).href;return v(e.map(e=>e.id))}))).apply(this,arguments)}var E,w=n(7);function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){S(e,t,n[t])}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){x(r,a,i,o,s,"next",e)}function s(e){x(r,a,i,o,s,"throw",e)}o(void 0)}))}}const M=Symbol(),k=new a.Validator,O=function(){const e=["low","medium","high"];if(window.AFRAME&&(AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR())){const t=Object(c.b)("default_mobile_material_quality");return t&&-1!==e.indexOf(t)?t:"low"}const t=Object(c.b)("default_material_quality");return t&&-1!==e.indexOf(t)?t:"high"}(),C=(null===(E=window.AFRAME)||void 0===E?void 0:E.utils.device.isMobileVR())&&navigator.userAgent.match(/Firefox/),P={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9_~ -]{3,32}$"},avatarId:{type:"string"},personalAvatarId:{type:"string"}}},credentials:{type:"object",additionalProperties:!1,properties:{token:{type:["null","string"]},email:{type:["null","string"]}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},hasAcceptedProfile:{type:"boolean"},lastEnteredAt:{type:"string"},hasPinned:{type:"boolean"},hasRotated:{type:"boolean"},hasRecentered:{type:"boolean"},hasScaled:{type:"boolean"},hasHoveredInWorldHud:{type:"boolean"},hasOpenedShare:{type:"boolean"},entryCount:{type:"number"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"},micMuted:{type:"bool"}}},preferences:{type:"object",additionalProperties:!1,properties:{shouldPromptForRefresh:{type:"bool",default:!1},preferredMic:{type:"string",default:w.c},preferredSpeakers:{type:"string",default:w.c},preferredCamera:{type:"string",default:w.c},muteMicOnEntry:{type:"bool",default:!1},disableLeftRightPanning:{type:"bool",default:!1},audioNormalization:{type:"bool",default:0},invertTouchscreenCameraMove:{type:"bool",default:!0},enableOnScreenJoystickLeft:{type:"bool",default:!1},enableOnScreenJoystickRight:{type:"bool",default:!1},enableGyro:{type:"bool",default:!0},animateWaypointTransitions:{type:"bool",default:!0},showFPSCounter:{type:"bool",default:!1},allowMultipleHubsInstances:{type:"bool",default:!1},disableIdleDetection:{type:"bool",default:!1},fastRoomSwitching:{type:"bool",default:!1},lazyLoadSceneMedia:{type:"bool",default:!1},preferMobileObjectInfoPanel:{type:"bool",default:!1},maxResolutionWidth:{type:"number",default:void 0},maxResolutionHeight:{type:"number",default:void 0},globalVoiceVolume:{type:"number",default:100},globalMediaVolume:{type:"number",default:100},globalSFXVolume:{type:"number",default:100},snapRotationDegrees:{type:"number",default:45},materialQualitySetting:{type:"string",default:O},enableDynamicShadows:{type:"bool",default:!1},disableSoundEffects:{type:"bool",default:!1},disableMovement:{type:"bool",default:!1},disableBackwardsMovement:{type:"bool",default:!1},disableStrafing:{type:"bool",default:!1},disableTeleporter:{type:"bool",default:!1},disableAutoPixelRatio:{type:"bool",default:!1},movementSpeedModifier:{type:"number",default:1},disableEchoCancellation:{type:"bool",default:C},disableNoiseSuppression:{type:"bool",default:C},disableAutoGainControl:{type:"bool",default:C},locale:{type:"string",default:"browser"},showRtcDebugPanel:{type:"bool",default:!1},showAudioDebugPanel:{type:"bool",default:!1},enableAudioClipping:{type:"bool",default:!1},audioClippingThreshold:{type:"number",default:.015},theme:{type:"string",default:void 0},cursorSize:{type:"number",default:1},nametagVisibility:{type:"string",default:"showAll"},nametagVisibilityDistance:{type:"number",default:5},avatarVoiceLevels:{type:"object"}}},confirmedDiscordRooms:{type:"array",items:{type:"string"}},confirmedBroadcastedRooms:{type:"array",items:{type:"string"}},uploadPromotionTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{fileId:{type:"string"},promotionToken:{type:"string"}}}},creatorAssignmentTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},creatorAssignmentToken:{type:"string"}}}},embedTokens:{type:"array",items:{type:"object",additionalProperties:!1,properties:{hubId:{type:"string"},embedToken:{type:"string"}}}},onLoadActions:{type:"array",items:{type:"object",additionalProperties:!1,properties:{action:{type:"string"},args:{type:"object"}}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},credentials:{$ref:"#/definitions/credentials"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"},preferences:{$ref:"#/definitions/preferences"},confirmedDiscordRooms:{$ref:"#/definitions/confirmedDiscordRooms"},confirmedBroadcastedRooms:{$ref:"#/definitions/confirmedBroadcastedRooms"},uploadPromotionTokens:{$ref:"#/definitions/uploadPromotionTokens"},creatorAssignmentTokens:{$ref:"#/definitions/creatorAssignmentTokens"},embedTokens:{$ref:"#/definitions/embedTokens"},onLoadActions:{$ref:"#/definitions/onLoadActions"}},additionalProperties:!1};class R extends d.a{constructor(){var e;super(),e=this,this._signOutOnExpiredAuthToken=()=>{if(!this.state.credentials.token)return;1e3*l()(this.state.credentials.token).exp<=Date.now()&&this.update({credentials:{token:null,email:null}})},this.initProfile=A((function*(){e._shouldResetAvatarOnInit?yield e.resetToRandomDefaultAvatar():e.update({profile:_({avatarId:yield b()},e.state.profile||{})}),e.state.activity.hasChangedName||e.update({profile:{displayName:"".concat(v(g),"-").concat(Math.floor(1e4+1e4*Math.random()))}})})),this.resetToRandomDefaultAvatar=A((function*(){e.update({profile:_({},e.state.profile||{},{avatarId:yield b()})})})),this._preferences={},null===localStorage.getItem("___hubs_store")&&localStorage.setItem("___hubs_store",JSON.stringify({})),window.addEventListener("storage",e=>{"___hubs_store"===e.key&&(delete this[M],this.dispatchEvent(new CustomEvent("statechanged")))}),this.update({activity:{},settings:{},credentials:{},profile:{},confirmedDiscordRooms:[],confirmedBroadcastedRooms:[],uploadPromotionTokens:[],creatorAssignmentTokens:[],embedTokens:[],onLoadActions:[],preferences:{}}),this._shouldResetAvatarOnInit=!1;const t=o.a.getJSON("ret-oauth-flow-account-credentials");t&&(this.update({credentials:t}),this._shouldResetAvatarOnInit=!0,o.a.remove("ret-oauth-flow-account-credentials")),this._signOutOnExpiredAuthToken();const n=(()=>{let e;return()=>{const t=this.state.preferences.theme;(e||t)&&e!==t&&this.dispatchEvent(new CustomEvent("themechanged",{detail:{current:t,previous:e}})),e=t}})();this.addEventListener("statechanged",n)}get state(){if(!this.hasOwnProperty(M)){const e=this[M]=JSON.parse(localStorage.getItem("___hubs_store"));e.preferences||(e.preferences={}),this._preferences=_({},e.preferences);for(const[t,n]of Object.entries(P.definitions.preferences.properties))n.hasOwnProperty("default")&&(e.preferences.hasOwnProperty(t)?e.preferences[t]===n.default&&delete this._preferences[t]:e.preferences[t]=n.default)}return this[M]}get credentialsAccountId(){return this.state.credentials.token?l()(this.state.credentials.token).sub:null}resetConfirmedBroadcastedRooms(){this.clearStoredArray("confirmedBroadcastedRooms")}resetTipActivityFlags(){this.update({activity:{hasRotated:!1,hasPinned:!1,hasRecentered:!1,hasScaled:!1,entryCount:0}})}bumpEntryCount(){const e=this.state.activity.entryCount||0;this.update({activity:{entryCount:e+1}})}enqueueOnLoadAction(e,t){this.update({onLoadActions:[{action:e,args:t}]})}executeOnLoadActions(e){for(let t=0;t<this.state.onLoadActions.length;t++){const{action:n,args:a}=this.state.onLoadActions[t];"emit_scene_event"===n&&e.emit(a.event,a.detail)}this.clearOnLoadActions()}clearOnLoadActions(){this.clearStoredArray("onLoadActions")}clearStoredArray(e){const t={};t[e]=[],this.update(t,{arrayMerge:(e,t)=>t})}update(e,t){const n=Object(i.a)(_({},this.state,{preferences:this._preferences}),e,t),{valid:a,errors:r}=k.validate(n,P);if(a||r.forEach(e=>{console.error("Removing invalid preference from store: ".concat(e.message)),delete e.instance[e.argument]}),e.preferences){for(const[e,t]of Object.entries(n.preferences)){var o;(null===(o=P.definitions.preferences.properties[e])||void 0===o?void 0:o.hasOwnProperty("default"))&&t===P.definitions.preferences.properties[e].default&&delete n.preferences[e]}this._preferences=n.preferences}return localStorage.setItem("___hubs_store",JSON.stringify(n)),delete this[M],void 0!==e.profile&&this.dispatchEvent(new CustomEvent("profilechanged")),this.dispatchEvent(new CustomEvent("statechanged")),n}get schema(){return P}}},304:function(e,t,n){e.exports={"no-default-button-style":"globals__no-default-button-style__2LSUQ",noDefaultButtonStyle:"globals__no-default-button-style__2LSUQ"}},314:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const a=[];class i{tick(e){for(let t=0;t<a.length;t++){const n=a[t];n.mixer&&n.mixer.update(e/1e3)}}}AFRAME.registerComponent("animation-mixer",{initMixer(e){this.mixer=new THREE.AnimationMixer(this.el.object3D),this.el.object3D.animations=e,this.animations=e},play(){a.push(this)},pause(){a.splice(a.indexOf(this),1)}})},316:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M15.703 6.563c-.114 1.588-1.293 2.812-2.578 2.812s-2.466-1.223-2.578-2.812c-.117-1.653 1.03-2.813 2.578-2.813 1.548 0 2.695 1.19 2.578 2.813z",stroke:o.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M13.125 11.875c-2.546 0-4.994 1.264-5.607 3.727-.081.326.123.648.458.648h10.299c.335 0 .538-.322.458-.648-.614-2.502-3.062-3.727-5.608-3.727z",stroke:o.color,strokeWidth:1.5,strokeMiterlimit:10}),a.createElement("path",{d:"M7.812 7.264C7.721 8.532 6.77 9.53 5.742 9.53c-1.026 0-1.98-.998-2.07-2.267C3.578 5.944 4.505 5 5.742 5c1.237 0 2.164.968 2.07 2.264z",stroke:o.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M8.047 11.954c-.705-.324-1.482-.448-2.305-.448-2.031 0-3.988 1.01-4.478 2.977-.065.26.098.517.366.517h4.386",stroke:o.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}))}o.defaultProps={color:"#000",title:"People"}},317:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M10 4.375v11.25",stroke:o.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M15.625 10H4.375",stroke:o.color,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"}))}o.defaultProps={color:"#000",title:"Add"}},318:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){var t=e.title,n=e.titleId,o=r(e,["title","titleId"]);return a.createElement("svg",i({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":n},o),t?a.createElement("title",{id:n},t):null,a.createElement("path",{d:"M8.636 2.5a6.136 6.136 0 100 12.273 6.136 6.136 0 000-12.272v0z",stroke:o.color,strokeWidth:1.5,strokeMiterlimit:10}),a.createElement("path",{d:"M13.214 13.214L17.5 17.5",stroke:o.color,strokeWidth:1.5,strokeMiterlimit:10,strokeLinecap:"round"}))}o.defaultProps={color:"#000",title:"Search"}},319:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));const a=AFRAME.THREE;function i(){if(/Android.+Firefox/.test(navigator.userAgent)){const e=WebGLRenderingContext.prototype.getExtension,t=function(){const e=new a.WebGLRenderer({forceWebVR:!0}),t=new a.Scene,n=new Float32Array(16),i=new a.DataTexture(n,2,2,a.RGBAFormat,a.FloatType),r=new a.Mesh(new a.PlaneBufferGeometry(1,1),new a.MeshBasicMaterial({map:i}));r.material.map.needsUpdate=!0,t.add(r),e.render(t,new a.Camera);const o=0===e.getContext().getError();return e.dispose(),o}();WebGLRenderingContext.prototype.getExtension=function(n){return"OES_texture_float"!==n||t?e.call(this,n):null}}}function r(e){const t=e.getContext();return t.getParameter(t.VERSION).split(" ")[1]}},320:function(e,t,n){"use strict";function a(e){e.components["animation-mixer"]&&(e.querySelector("[loop-animation]")||e.setAttribute("loop-animation",""))}n.d(t,"a",(function(){return a}))},321:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(6);function l({termsUrl:e,privacyUrl:t}){const n=Object(a.useCallback)(t=>i.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:e},t),[e]),r=Object(a.useCallback)(e=>i.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:t},e),[t]);return e&&t?i.a.createElement(s.a,{id:"legal-message.tos-and-privacy",defaultMessage:"By proceeding, you agree to the TOS",values:{toslink:n,privacylink:r}}):e&&!t?i.a.createElement(s.a,{id:"legal-message.tos",defaultMessage:"By proceeding, you agree to the <toslink>terms of use</toslink>.",values:{toslink:n}}):!e&&t?i.a.createElement(s.a,{id:"legal-message.privacy",defaultMessage:"By proceeding, you agree to the <privacylink>privacy notice</privacylink>.",values:{privacylink:r}}):null}l.propTypes={termsUrl:o.a.string,privacyUrl:o.a.string}},323:function(e,t,n){"use strict";var a=n(211),i=n.n(a),r=n(414),o=n.n(r),s=n(0),l=n.n(s),c=n(1),d=n.n(c),u=n(6),h=n(173),p=n(83),m=n(5),f=n.n(m),g=n(415),v=n.n(g),b=n(416),y=n.n(b),E=n(417),w=n.n(E),_=n(418),S=n.n(_),x=n(419),A=n.n(x),M=n(420),k=n.n(M);function O(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){O(r,a,i,o,s,"next",e)}function s(e){O(r,a,i,o,s,"throw",e)}o(void 0)}))}}function P(){return(P=C((function*(){const e=[v.a,y.a,w.a,S.a,A.a,k.a],t=yield new Promise((t,n)=>(new THREE.CubeTextureLoader).load(e,t,void 0,n));return t.format=THREE.RGBFormat,t}))).apply(this,arguments)}var R=n(171),T=n(11),j=n(84),D=n(181),I=n(19),L=n(421),H=n.n(L);function N(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){N(r,a,i,o,s,"next",e)}function s(e){N(r,a,i,o,s,"throw",e)}o(void 0)}))}}n(710);const V={base_map:["map"],emissive_map:["emissiveMap"],normal_map:["normalMap"],orm_map:["aoMap","roughnessMap","metalnessMap"]},B=Object.keys(V);function U(e,t=!1,n=!0){const a=e.getContext("webgl2",{alpha:t,depth:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"}),i=new THREE.WebGLRenderer({alpha:t,canvas:e,context:a,forceWebVR:!0});return i.outputEncoding=THREE.sRGBEncoding,i.physicallyCorrectLights=!0,n&&i.setPixelRatio(window.devicePixelRatio),i}const z=new THREE.Euler(-30*THREE.Math.DEG2RAD,30*THREE.Math.DEG2RAD,0);function W(e,t,n,a=1){const i=Math.max(t.max.y-n.y,n.y-t.min.y),r=THREE.Math.degToRad(e.fov/2);e.position.set(0,0,(i/Math.tan(r)+t.max.z)*a),e.position.applyEuler(z),e.position.add(n),e.lookAt(n)}class q extends s.Component{constructor(e){var t;super(e),t=this,this.componentDidMount=()=>{this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(55,this.canvas.clientWidth/this.canvas.clientHeight,.1,1e3),this.controls=new THREE.OrbitControls(this.camera,this.canvas),this.controls.screenSpacePanning=!0,this.controls.enableKeys=!0;const e=new THREE.DirectionalLight(16250607,1);e.position.set(0,10,10),this.scene.add(e),this.scene.add(new THREE.HemisphereLight(11658239,11658239,2.5)),this.loadId=0,this.camera.position.set(-.2,.5,.5),this.camera.matrixAutoUpdate=!0,this.controls.target.set(0,.45,0),this.controls.update(),this.props.avatarGltfUrl&&this.loadCurrentAvatarGltfUrl();const t=new THREE.Clock;this.snapshotCanvas=document.createElement("canvas"),this.snapshotCanvas.width=720,this.snapshotCanvas.height=1280,this.snapshotCamera=new THREE.PerspectiveCamera(55,.5625,.1,1e3),this.snapshotCamera.matrixAutoUpdate=!0,this.snapshotRenderer=U(this.snapshotCanvas,!0,!1),this.snapshotRenderer.setClearAlpha(0),this.previewRenderer=U(this.canvas),this.previewRenderer.setClearColor(function(){var e,t,n,a,i,r;const o=null===(e=APP)||void 0===e||null===(t=e.store)||void 0===t||null===(n=t.state)||void 0===n||null===(a=n.preferences)||void 0===a?void 0:a.theme,s=null===(i=window.APP_CONFIG)||void 0===i||null===(r=i.theme)||void 0===r?void 0:r.themes,l=(null==s?void 0:s.find(e=>e.id===o))||Object(p.a)();return new THREE.Color((null==l?void 0:l.variables["background3-color"])||15395562)}()),this.previewRenderer.setAnimationLoop(()=>{const e=t.getDelta();this.mixer&&this.mixer.update(e),this.previewRenderer.render(this.scene,this.camera)}),window.addEventListener("resize",this.resize),this.resize(),this.mounted=!0},this.resize=()=>{const e=this.canvas.parentElement.offsetWidth,t=this.canvas.parentElement.offsetHeight;this.previewRenderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()},this.setAvatar=e=>{e&&(this.avatar=e,this.scene.add(e),this.resetCamera(),this.setState({error:null,loading:!1}))},this.resetCamera=(()=>{const e=new THREE.Box3,t=new THREE.Vector3;return()=>{e.setFromObject(this.avatar),e.getCenter(t),t.y=.6*(e.max.y-e.min.y)+e.min.y,W(this.camera,e,t),W(this.snapshotCamera,e,t,.7),this.controls.target.copy(t),this.controls.update()}})(),this.componentWillUnmount=()=>{this.mounted=!1,this.scene&&this.scene.traverse(T.h),this.previewRenderer&&this.previewRenderer.dispose(),this.snapshotRenderer&&this.snapshotRenderer.dispose(),this.controls&&(this.controls.dispose(),this.controls.domElement=null),Object.values(this.imageBitmaps).forEach(e=>Object(D.b)(e)),window.removeEventListener("resize",this.resize)},this.componentDidUpdate=function(){var e=F((function*(e){e.avatarGltfUrl!==t.props.avatarGltfUrl&&(t.avatar&&(t.scene.remove(t.avatar),t.avatar=null),t.props.avatarGltfUrl&&(t.setState({error:null,loading:!0}),yield t.loadCurrentAvatarGltfUrl())),t.applyMaps(e,t.props)}));return function(t){return e.apply(this,arguments)}}(),this.loadPreviewAvatar=function(){var e=F((function*(e){let n;try{n=yield Object(R.a)(e,"model/gltf",null,j.c)}catch(e){return console.error("Failed to load avatar preview",e),void t.setState({loading:!1,error:!0})}if(!t.mounted)return;if(t.previewMesh=Object(T.i)(n.scene,e=>e.isMesh&&e.material&&e.material.name===j.b||"Bot_Skinned"===e.name),!t.previewMesh)return console.error("Failed to find avatar preview mesh"),void t.setState({loading:!1,error:!0});const a=n.animations&&n.animations.find(({name:e})=>"idle_eyes"===e);if(a){t.mixer=new THREE.AnimationMixer(n.scene);const e=t.mixer.clipAction(a);e.enabled=!0,e.setLoop(THREE.LoopRepeat,1/0).play(),t.idleAnimationAction=e}n.scene.traverse(e=>{if(e.isSkinnedMesh&&(e.frustumCulled=!1),e.material){const t=t=>e.material[t]&&delete e.material[t].onUpdate;V.base_map.forEach(t),V.emissive_map.forEach(t),V.normal_map.forEach(t),V.orm_map.forEach(t)}});const{material:i}=t.previewMesh;if(i){const e=e=>i[e]&&i[e].image;t.originalMaps={base_map:V.base_map.map(e),emissive_map:V.emissive_map.map(e),normal_map:V.normal_map.map(e),orm_map:V.orm_map.map(e)};const n=[t.applyMaps({},t.props)];"high"===window.APP.store.state.preferences.materialQualitySetting&&n.push(function(){return P.apply(this,arguments)}().then(e=>{t.previewMesh.material.envMap=e,t.previewMesh.material.needsUpdate=!0})),yield Promise.all(n)}else t.originalMaps={};return n}));return function(t){return e.apply(this,arguments)}}(),this.applyMapToPreview=(e,t)=>{this.imageBitmaps[e]&&Object(D.b)(this.imageBitmaps[e]),this.imageBitmaps[e]=t,V[e].forEach(e=>{const n=this.previewMesh.material[e];"normalMap"===e&&"low"===window.APP.store.state.preferences.materialQualitySetting||("roughnessMap"!==e&&"metalnessMap"!==e||"high"===window.APP.store.state.preferences.materialQualitySetting)&&(n.image=t,n.needsUpdate=!0)})},this.revertMap=e=>{this.imageBitmaps[e]&&Object(D.b)(this.imageBitmaps[e]),delete this.imageBitmaps[e],this.originalMaps[e].forEach((t,n)=>{const a=this.previewMesh.material[V[e][n]];a&&(a.image=t,a.needsUpdate=!0)})},this.snapshot=()=>new Promise(e=>{this.idleAnimationAction&&this.idleAnimationAction.stop(),this.snapshotCamera.position.copy(this.camera.position),this.snapshotCamera.rotation.copy(this.camera.rotation),this.snapshotRenderer.render(this.scene,this.snapshotCamera),this.snapshotCanvas.toBlob(t=>{this.idleAnimationAction&&this.idleAnimationAction.play(),e(t)})}),this.state={loading:!0,error:null},this.avatar=null,this.imageBitmaps={},this.mounted=!1}loadCurrentAvatarGltfUrl(){var e=this;return F((function*(){const t=++e.loadId,n=Object(I.j)(e.props.avatarGltfUrl),a=yield e.loadPreviewAvatar(n);e.mounted&&t===e.loadId&&(a&&e.props.onGltfLoaded&&e.props.onGltfLoaded(a),e.setAvatar(a.scene))}))()}applyMaps(e,t){return Promise.all(B.map(n=>{const a=this.applyMapToPreview.bind(this,n);if(e[n]!=t[n])return t[n]instanceof File?Object(D.a)(t[n]).then(a):t[n]?(i=t[n],fetch(i).then(e=>e.blob()).then(D.a)).then(a):this.revertMap(n);var i}))}render(){return l.a.createElement("div",{className:f()(H.a.preview,this.props.className)},!this.props.avatarGltfUrl||this.state.loading&&!this.state.error&&l.a.createElement("div",{className:"loader"},l.a.createElement("div",{className:"loader-center"})),this.props.avatarGltfUrl&&this.state.error&&!this.state.loading&&l.a.createElement("div",{className:"error"},l.a.createElement("img",{src:i.a,srcSet:o.a+" 2x",className:"error-icon"}),l.a.createElement(u.a,{id:"avatar-preview.loading-failed",defaultMessage:"Loading failed{linebreak}Please choose another avatar",values:{linebreak:l.a.createElement("br",null)}})),l.a.createElement("canvas",{ref:e=>this.canvas=e}))}}q.propTypes={avatarGltfUrl:d.a.string,className:d.a.string,onGltfLoaded:d.a.func};t.a=Object(h.c)(q,{forwardRef:!0})},324:function(e,t,n){e.exports=n.p+"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3"},325:function(e,t,n){e.exports=n.p+"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3"},328:function(e,t,n){e.exports={"room-permissions":"RoomSettingsSidebar__room-permissions__30BnJ",roomPermissions:"RoomSettingsSidebar__room-permissions__30BnJ","permissions-group":"RoomSettingsSidebar__permissions-group__3VoIc",permissionsGroup:"RoomSettingsSidebar__permissions-group__3VoIc","confirm-revoke-button":"RoomSettingsSidebar__confirm-revoke-button__hhk_l",confirmRevokeButton:"RoomSettingsSidebar__confirm-revoke-button__hhk_l"}},329:function(e,t,n){e.exports={sidebar:"Sidebar__sidebar__31EOU",header:"Sidebar__header__Sw_C4","before-title":"Sidebar__before-title__1dOWa",beforeTitle:"Sidebar__before-title__1dOWa","after-title":"Sidebar__after-title__2nLsi",afterTitle:"Sidebar__after-title__2nLsi",content:"Sidebar__content__1FPYB","overflow-y":"Sidebar__overflow-y__alRGc",overflowY:"Sidebar__overflow-y__alRGc"}},330:function(e,t,n){e.exports={"fullscreen-layout":"FullscreenLayout__fullscreen-layout__2DFsg",fullscreenLayout:"FullscreenLayout__fullscreen-layout__2DFsg",header:"FullscreenLayout__header__3czso","header-left":"FullscreenLayout__header-left__1Lfzu",headerLeft:"FullscreenLayout__header-left__1Lfzu","header-center":"FullscreenLayout__header-center__3QmGB",headerCenter:"FullscreenLayout__header-center__3QmGB","header-right":"FullscreenLayout__header-right__3NutT",headerRight:"FullscreenLayout__header-right__3NutT",content:"FullscreenLayout__content__17OJM"}},331:function(e,t,n){e.exports={"no-default-button-style":"preload-overlay__no-default-button-style__gwKec",noDefaultButtonStyle:"preload-overlay__no-default-button-style__gwKec",treatment:"preload-overlay__treatment__1L4r0",screenshot:"preload-overlay__screenshot__3TZYm","hub-name":"preload-overlay__hub-name__2txaT",hubName:"preload-overlay__hub-name__2txaT","main-panel":"preload-overlay__main-panel__2EX4k",mainPanel:"preload-overlay__main-panel__2EX4k",logo:"preload-overlay__logo__1IJJc"}},332:function(e,t,n){e.exports={"select-input":"SelectInputField__select-input__1f43w",selectInput:"SelectInputField__select-input__1f43w","dropdown-button":"SelectInputField__dropdown-button__ijkrA",dropdownButton:"SelectInputField__dropdown-button__ijkrA",dropdown:"SelectInputField__dropdown__2U3K0",open:"SelectInputField__open__souoW","dropdown-item":"SelectInputField__dropdown-item__I76nk",dropdownItem:"SelectInputField__dropdown-item__I76nk","highlighted-item":"SelectInputField__highlighted-item__1XEWG",highlightedItem:"SelectInputField__highlighted-item__1XEWG"}},333:function(e,t,n){e.exports={"more-menu-popover":"MoreMenuPopover__more-menu-popover__2IfA_",moreMenuPopover:"MoreMenuPopover__more-menu-popover__2IfA_","more-menu-group-label":"MoreMenuPopover__more-menu-group-label__mOCu2",moreMenuGroupLabel:"MoreMenuPopover__more-menu-group-label__mOCu2","more-menu-item-list":"MoreMenuPopover__more-menu-item-list__1LJri",moreMenuItemList:"MoreMenuPopover__more-menu-item-list__1LJri","more-menu-item-target":"MoreMenuPopover__more-menu-item-target__TvxV4",moreMenuItemTarget:"MoreMenuPopover__more-menu-item-target__TvxV4","compact-button":"MoreMenuPopover__compact-button__BxieG",compactButton:"MoreMenuPopover__compact-button__BxieG"}},334:function(e,t,n){e.exports={"radio-input":"RadioInput__radio-input__2oCwm",radioInput:"RadioInput__radio-input__2oCwm",option:"RadioInput__option__2L5bU",input:"RadioInput__input__189gK",content:"RadioInput__content__2MaqU",label:"RadioInput__label__2IXV7",description:"RadioInput__description__3lX8c"}},335:function(e,t,n){e.exports={media:"TweetEditorModal__media__2-s5G",editor:"TweetEditorModal__editor__iyyNJ","editor-inner":"TweetEditorModal__editor-inner__1RjaM",editorInner:"TweetEditorModal__editor-inner__1RjaM","emoji-button":"TweetEditorModal__emoji-button__8L-8v",emojiButton:"TweetEditorModal__emoji-button__8L-8v",counter:"TweetEditorModal__counter__1fyfG"}},35:function(e,t,n){"use strict";n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"e",(function(){return E})),n.d(t,"f",(function(){return w})),n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return S}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(48),l=n(47),c=n(9),d=n(364),u=n(6),h=n(14),p=n(141),m=n(22),f=n(321);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const b={submit:"submit",waitForVerification:"waitForVerification",complete:"complete"},y=Object(c.b)({pin:{id:"sign-in-modal.signin-message.pin",defaultMessage:"You'll need to sign in to pin objects."},unpin:{id:"sign-in-modal.signin-message.unpin",defaultMessage:"You'll need to sign in to un-pin objects."},changeScene:{id:"sign-in-modal.signin-message.change-scene",defaultMessage:"You'll need to sign in to change the scene."},roomSettings:{id:"sign-in-modal.signin-message.room-settings",defaultMessage:"You'll need to sign in to change the room's settings."},closeRoom:{id:"sign-in-modal.signin-message.close-room",defaultMessage:"You'll need to sign in to close the room."},muteUser:{id:"sign-in-modal.signin-message.mute-user",defaultMessage:"You'll need to sign in to mute other users."},kickUser:{id:"sign-in-modal.signin-message.kick-user",defaultMessage:"You'll need to sign in to kick other users."},addOwner:{id:"sign-in-modal.signin-message.add-owner",defaultMessage:"You'll need to sign in to assign moderators."},removeOwner:{id:"sign-in-modal.signin-message.remove-owner",defaultMessage:"You'll need to sign in to assign moderators."},createAvatar:{id:"sign-in-modal.signin-message.create-avatar",defaultMessage:"You'll need to sign in to create avatars."},remixAvatar:{id:"sign-in-modal.signin-message.remix-avatar",defaultMessage:"You'll need to sign in to remix avatars."},remixScene:{id:"sign-in-modal.signin-message.remix-scene",defaultMessage:"You'll need to sign in to remix scenes."},favoriteRoom:{id:"sign-in-modal.signin-message.favorite-room",defaultMessage:"You'll need to sign in to add this room to your favorites."},favoriteRooms:{id:"sign-in-modal.signin-message.favorite-rooms",defaultMessage:"You'll need to sign in to add favorite rooms."},tweet:{id:"sign-in-modal.signin-message.tweet",defaultMessage:"You'll need to sign in to send tweets."}});function E({onSubmitEmail:e,initialEmail:t,privacyUrl:n,termsUrl:r,message:o}){const s=Object(d.a)(),[l,c]=Object(a.useState)(t),g=Object(a.useCallback)(t=>{t.preventDefault(),e(l)},[e,l]),v=Object(a.useCallback)(e=>{c(e.target.value)},[c]);return i.a.createElement(m.a,{center:!0,padding:!0,as:"form",onSubmit:g},i.a.createElement("p",null,o?s.formatMessage(o):i.a.createElement(u.a,{id:"sign-in-modal.prompt",defaultMessage:"enter email to sign in :"})),i.a.createElement(p.a,{name:"email",type:"email",required:!0,value:l,onChange:v,placeholder:"user@metaverseplus.xyz"}),i.a.createElement("p",null,i.a.createElement("small",null,i.a.createElement(f.a,{termsUrl:r,privacyUrl:n}))),i.a.createElement(h.f,{type:"submit"}))}function w({email:e,onCancel:t,showNewsletterSignup:n}){return i.a.createElement(m.a,{center:!0,padding:!0},i.a.createElement(u.a,{id:"sign-in-modal.wait-for-verification",defaultMessage:"<p>Email sent to {email}!</p><p>To continue, click on the link in the email using your phone, tablet, or PC.</p><p>No email? You may not be able to create an account.</p>",values:{email:e,p:e=>i.a.createElement("p",null,e)}}),n&&i.a.createElement("p",null,i.a.createElement("small",null,i.a.createElement(u.a,{id:"sign-in-modal.newsletter-signup-question",defaultMessage:"MetaversePlus - Buiding Better Worlds"}),i.a.createElement("br",null),i.a.createElement("a",{href:"https://eepurl.com/gX_fH9",target:"_blank",rel:"noopener noreferrer"},i.a.createElement(u.a,{id:"sign-in-modal.newsletter-signup-link",defaultMessage:"Subscribe?"})))),i.a.createElement(h.d,{onClick:t}))}function _({message:e,onContinue:t}){const n=Object(d.a)();return i.a.createElement(m.a,{center:!0,padding:!0},i.a.createElement("p",null,i.a.createElement("b",null,e?n.formatMessage(e):i.a.createElement(u.a,{id:"sign-in-modal.complete",defaultMessage:"You are now signed in."}))),i.a.createElement(h.e,{onClick:t}))}function S(e){let{closeable:t,onClose:n,children:a}=e,r=v(e,["closeable","onClose","children"]);return i.a.createElement(l.a,g({title:i.a.createElement(u.a,{id:"sign-in-modal.title",defaultMessage:"Sign In"}),beforeTitle:t&&i.a.createElement(s.a,{onClick:n})},r),a)}E.defaultProps={initialEmail:""},E.propTypes={message:o.a.string,termsUrl:o.a.string,privacyUrl:o.a.string,initialEmail:o.a.string,onSubmitEmail:o.a.func.isRequired},w.propTypes={showNewsletterSignup:o.a.bool,email:o.a.string.isRequired,onCancel:o.a.func.isRequired},_.propTypes={message:o.a.string.isRequired,onContinue:o.a.func.isRequired},S.propTypes={closeable:o.a.bool,onClose:o.a.func,children:o.a.node}},356:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(37),i=n(113);const r=[],o=[],s=["MeshStandardMaterial","MeshBasicMaterial","MeshPhongMaterial"];AFRAME.registerComponent("hoverable-visuals",{schema:{enableSweepingEffect:{type:"boolean",default:!0}},init(){this.uniforms=null,this.geometryRadius=0,this.sweepParams=[0,0]},remove(){this.uniforms=null,this.boundingBox=null;const e=this.el.sceneEl.systems["hubs-systems"].batchManagerSystem;this.el.object3D.traverse(t=>{t.material&&Object(a.c)(t,n=>{!s.includes(n.type)||t.el.classList.contains("ui")||t.el.classList.contains("hud")||t.el.getAttribute("text-button")||e.batchingEnabled&&e.meshToEl.delete(t)})});const t=AFRAME.utils.device.isMobile(),n=AFRAME.utils.device.isMobileVR();this.isTouchscreen=t&&!n},tick(e){if(!this.uniforms||!this.uniforms.length)return;const t=this.el.sceneEl.is("frozen"),n=Object(i.d)(this.el),a=this.el.sceneEl.systems["hubs-systems"].cursorTogglingSystem;let s,l;const c=this.el.sceneEl.systems.interaction;if(c.ready){if(c.state.leftHand.hovered!==this.el||c.state.leftHand.held||(s=c.options.leftHand.entity.object3D),c.state.leftRemote.hovered!==this.el||c.state.leftRemote.held||a.leftToggledOff||(s=c.options.leftRemote.entity.object3D),c.state.rightRemote.hovered!==this.el||c.state.rightRemote.held||a.rightToggledOff||(l=c.options.rightRemote.entity.object3D),c.state.rightHand.hovered!==this.el||c.state.rightHand.held||(l=c.options.rightHand.entity.object3D),s&&s.matrixWorld.toArray(r),l&&l.matrixWorld.toArray(o),s||l||t){const e=this.el.object3D.matrixWorld.elements[13],t=this.el.object3D.matrixWorld.elements[4],n=this.el.object3D.matrixWorld.elements[5],a=this.el.object3D.matrixWorld.elements[6],i=Math.sqrt(t*t+n*n+a*a)*this.geometryRadius;this.sweepParams[0]=e-i,this.sweepParams[1]=e+i}for(let a=0,i=this.uniforms.length;a<i;a++){const i=this.uniforms[a];i.hubs_EnableSweepingEffect.value=this.data.enableSweepingEffect&&n,i.hubs_IsFrozen.value=t,i.hubs_SweepParams.value=this.sweepParams,i.hubs_HighlightInteractorOne.value=!!s&&n&&!this.isTouchscreen,i.hubs_InteractorOnePos.value[0]=r[12],i.hubs_InteractorOnePos.value[1]=r[13],i.hubs_InteractorOnePos.value[2]=r[14],i.hubs_HighlightInteractorTwo.value=!!l&&n&&!this.isTouchscreen,i.hubs_InteractorTwoPos.value[0]=o[12],i.hubs_InteractorTwoPos.value[1]=o[13],i.hubs_InteractorTwoPos.value[2]=o[14],(s||l||t)&&(i.hubs_Time.value=e)}}}})},357:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(232),d=n.n(c);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e){let{children:t,className:n,center:a,isVariableWidth:r,sm:o}=e,s=h(e,["children","className","center","isVariableWidth","sm"]);return i.a.createElement("div",u({className:l()(d.a.mediaGrid,{[d.a.center]:a,[d.a.variableWidth]:r,[d.a.sm]:o},n)},s),t)}p.propTypes={center:o.a.bool,isVariableWidth:o.a.bool,sm:o.a.bool,className:o.a.string,children:o.a.node}},36:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,i,r,o,s){let l={};const c=(e.location.state&&e.location.state.__historyLength||0)+(t?0:1);(n||o||s)&&(l=e.location.state?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){a(e,t,n[t])}))}return e}({},e.location.state):{},delete l.__duplicate,n&&(l[n]=i,l.key=n,l.value=i,l.detail=r));const d=void 0!==o?o:"/"===e.location.pathname?"":e.location.pathname,u=void 0!==s?s:e.location.search,h=e.location.hash,p=e.location.state&&e.location.state.__duplicate,m=t||p?e.replace:e.push;l.__historyLength=c,m({pathname:d,search:u,state:l,hash:h})}function r(e,t,n,a){i(e,!1,t,n,a)}function o(e,t,n,a){i(e,!0,t,n,a)}function s(e,t,n){i(e,!1,null,null,null,t,n)}function l(e){i(e,!1)}function c(e,t){if(!e.location.state||void 0===e.location.state.__historyLength)return;const n=e.location.state.__historyLength;return 0!==n?new Promise(a=>{const i=e.listen(()=>{i(),e.push({pathname:e.location.pathname,search:e.location.search,state:{__historyLength:0,__duplicate:!0}}),t&&e.go(-2),a()});e.go(-n)}):void 0}function d(e){c(e,!0)}function u(e){const t=e.pathname.split("/");return"/".concat(t.slice(2).join("/"))}function h(e,t){const n=e.pathname.split("/");return"/".concat(n[1]).concat(t)}n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return h}))},360:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);function i(e){return a.a.feature(e.name)&&e.children||null}},367:function(e,t,n){e.exports=n.p+"assets/models/LoadingEnvironment-570a9f69a9509eb8a039c9ff93ccfdca.glb"},368:function(e,t,n){e.exports={content:"RoomEntryModal__content__2mWAx","logo-container":"RoomEntryModal__logo-container__o-hM2",logoContainer:"RoomEntryModal__logo-container__o-hM2","room-name":"RoomEntryModal__room-name__2CyTs",roomName:"RoomEntryModal__room-name__2CyTs",buttons:"RoomEntryModal__buttons__X3XNq"}},369:function(e,t,n){e.exports={"flex-row":"Row__flex-row__2Q_u7",flexRow:"Row__flex-row__2Q_u7","space-between":"Row__space-between__3_Vbl",spaceBetween:"Row__space-between__3_Vbl","sm-breakpoint-column":"Row__sm-breakpoint-column__3OyhD",smBreakpointColumn:"Row__sm-breakpoint-column__3OyhD","md-breakpoint-column":"Row__md-breakpoint-column__1Jcsn",mdBreakpointColumn:"Row__md-breakpoint-column__1Jcsn","no-flex-wrap":"Row__no-flex-wrap__3Xl4E",noFlexWrap:"Row__no-flex-wrap__3Xl4E","xs-children-margin-r":"Row__xs-children-margin-r__3Y09x",xsChildrenMarginR:"Row__xs-children-margin-r__3Y09x","sm-children-margin-r":"Row__sm-children-margin-r__2m91A",smChildrenMarginR:"Row__sm-children-margin-r__2m91A","md-children-margin-r":"Row__md-children-margin-r__13Yl4",mdChildrenMarginR:"Row__md-children-margin-r__13Yl4","lg-children-margin-r":"Row__lg-children-margin-r__2lTSY",lgChildrenMarginR:"Row__lg-children-margin-r__2lTSY","xl-children-margin-r":"Row__xl-children-margin-r__2jOsR",xlChildrenMarginR:"Row__xl-children-margin-r__2jOsR"}},37:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function i(e,t){e.material&&(Array.isArray(e.material)?e.material.forEach(t):t(e.material))}function r(e,t){e.material&&(Array.isArray(e.material)?e.material=e.material.map(t):e.material=t(e.material))}function o(e,t){return e.material?Array.isArray(e.material)?e.material.map(t):[t(e.material)]:[]}n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));class s extends THREE.MeshBasicMaterial{static fromMeshStandardMaterial(e){const t=new s;return THREE.Material.prototype.copy.call(t,e),t.color.copy(e.color),t.emissive.copy(e.emissive),t.emissiveIntensity=e.emissiveIntensity,t.emissiveMap=e.emissiveMap,t.map=e.map,t.lightMap=e.lightMap,t.lightMapIntensity=e.lightMapIntensity,t.aoMap=e.aoMap,t.aoMapIntensity=e.aoMapIntensity,t.alphaMap=e.alphaMap,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,t.wireframeLinecap=e.wireframeLinecap,t.wireframeLinejoin=e.wireframeLinejoin,t}constructor(e={}){let{emissive:t,emissiveMap:n,emissiveIntensity:i}=e;super(a(e,["emissive","emissiveMap","emissiveIntensity"])),this.onBeforeCompile=e=>{e.uniforms.emissive=this._emissive,e.uniforms.emissiveIntensity=this._emissiveIntensity,e.uniforms.emissiveMap=this._emissiveMap,e.fragmentShader=e.fragmentShader.replace("#include <lightmap_pars_fragment>","#include <lightmap_pars_fragment>\n      uniform vec3 emissive;\n      uniform sampler2D emissiveMap;\n      "),e.fragmentShader=e.fragmentShader.replace("#include <envmap_fragment>","#include <envmap_fragment>\n\n      vec3 totalEmissiveRadiance = emissive;\n      #include <emissivemap_fragment>\n      outgoingLight += totalEmissiveRadiance;\n\n      ")},this._emissive={value:t||new THREE.Color},this._emissiveIntensity={value:void 0===i?1:i},this._emissiveMap={value:n}}get emissive(){return this._emissive.value}set emissive(e){this._emissive.value=e}get emissiveIntensity(){return this._emissiveIntensity.value}set emissiveIntensity(e){this._emissiveIntensity.value=e}get emissiveMap(){return this._emissiveMap.value}set emissiveMap(e){this._emissiveMap.value=e}copy(e){return super.copy(e),this.emissive.copy(e.emissive),this.emissiveIntensity=e.emissiveIntensity,this.emissiveMap=e.emissiveMap,this}}class l extends THREE.MeshPhongMaterial{constructor(...e){super(...e),this.onBeforeCompile=e=>{e.vertexShader=e.vertexShader.replace("varying vec3 vNormal;","varying vec3 vNormal;\n      #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n      #endif\n      "),e.vertexShader=e.vertexShader.replace("vNormal = normalize( transformedNormal );","vNormal = normalize( transformedNormal );\n      \n        #ifdef USE_TANGENT\n      \n          vTangent = normalize( transformedTangent );\n          vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n      \n        #endif\n      "),e.fragmentShader=e.fragmentShader.replace("#include <lights_phong_pars_fragment>","#include <lights_phong_pars_fragment>\n      #ifndef FLAT_SHADED\n\n        #ifdef USE_TANGENT\n          varying vec3 vTangent;\n          varying vec3 vBitangent;\n        #endif\n\n      #endif\n      ")}}static fromMeshStandardMaterial(e){const t=new l;return THREE.Material.prototype.copy.call(t,e),t.color.copy(e.color),t.map=e.map,t.lightMap=e.lightMap,t.lightMapIntensity=e.lightMapIntensity,t.aoMap=e.aoMap,t.aoMapIntensity=e.aoMapIntensity,t.emissive.copy(e.emissive),t.emissiveMap=e.emissiveMap,t.emissiveIntensity=e.emissiveIntensity,t.normalMapType=e.normalMapType,t.normalMap=e.normalMap,t.normalScale.copy(e.normalScale),t.bumpMap=e.bumpMap,t.bumpScale=e.bumpScale,t.displacementMap=e.displacementMap,t.displacementScale=e.displacementScale,t.displacementBias=e.displacementBias,t.alphaMap=e.alphaMap,t.reflectivity=.5,t.refractionRatio=e.refractionRatio,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,t.wireframeLinecap=e.wireframeLinecap,t.wireframeLinejoin=e.wireframeLinejoin,t}}function c(e,t){return e.isMeshStandardMaterial?"medium"===t?l.fromMeshStandardMaterial(e):"low"===t?s.fromMeshStandardMaterial(e):e:e}function d(e){if(e.dash&&e.dash.reset(),e.image instanceof HTMLVideoElement){const t=e.image;t.pause(),t.src="",t.load()}e.hls&&(e.hls.stopLoad(),e.hls.detachMedia(),e.hls.destroy(),e.hls=null),e.dispose()}},376:function(e,t,n){"use strict";var a=n(259),i=n.n(a),r=n(12);const o=new URLSearchParams(location.search),s=Object(r.a)("debug"),l=o.get("log_filter")||s&&"naf-janus-adapter:*,naf-dialog-adapter:*,mediasoup*";l&&i.a.enable(l)},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(10),i=n(230);const r=Object.freeze(new Map([[a.g.MEDIA_VIDEO,a.f],[a.g.AVATAR_AUDIO_SOURCE,a.b],[a.g.AUDIO_TARGET,a.h]]));function o(e){const t=APP.sourceType.get(e),n=r.get(t),o=APP.sceneAudioDefaults.get(t),s=APP.audioOverrides.get(e),l=APP.audioDebugPanelOverrides.get(t),c=APP.zoneOverrides.get(e),d=APP.store.state.preferences.disableLeftRightPanning?{audioType:a.a.Stereo}:{},u=Object(i.a)()?{audioType:a.a.Stereo}:{},h=Object.assign({},n,o,s,l,c,d,u);return APP.clippingState.has(e)||APP.mutedState.has(e)?h.gain=0:APP.gainMultipliers.has(e)&&(h.gain=h.gain*APP.gainMultipliers.get(e)),APP.supplementaryAttenuation.has(e)&&(h.gain=h.gain*APP.supplementaryAttenuation.get(e)),h}function s(e){const t=r.get(e),n=APP.sceneAudioDefaults.get(e),a=APP.audioDebugPanelOverrides.get(e);return Object.assign({},t,n,a)}function l(e,t){const n=o(e);(void 0===t.panner&&n.audioType===a.a.PannerNode||void 0!==t.panner&&n.audioType===a.a.Stereo)&&e.emit("audio_type_changed"),function(e,t){e.panner&&(e.setDistanceModel(t.distanceModel),e.setRolloffFactor(t.rolloffFactor),e.setRefDistance(t.refDistance),e.setMaxDistance(t.maxDistance),e.panner.coneInnerAngle=t.coneInnerAngle,e.panner.coneOuterAngle=t.coneOuterAngle,e.panner.coneOuterGain=t.coneOuterGain),e.gain.gain.setTargetAtTime(t.gain,e.context.currentTime,.1)}(t,n)}function c(e,t){if(t.panner)return!1;const n=APP.sourceType.get(e),i=r.get(n),o=APP.sceneAudioDefaults.get(n),s=APP.audioDebugPanelOverrides.get(n),l=APP.audioOverrides.get(e),c=APP.zoneOverrides.get(e);return Object.assign({},i,o,s,l,c).audioType===a.a.PannerNode}},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const a=new Map,i=[];class r{tick(e){for(let t=0;t<i.length;t++){const n=i[t],{offset:r,instances:o}=a.get(n),{component:s}=o[0];r.addScaledVector(s.data.speed,e/1e3),r.x=r.x%1,r.y=r.y%1;const l=s.data.increment;n.offset.x=l.x?r.x-r.x%l.x:r.x,n.offset.y=l.y?r.y-r.y%l.y:r.y}}}AFRAME.registerComponent("uv-scroll",{schema:{speed:{type:"vec2",default:{x:0,y:0}},increment:{type:"vec2",default:{x:0,y:0}}},play(){const e=this.el.getObject3D("mesh")||this.el.getObject3D("skinnedmesh"),t=e&&e.material;if(t){const n={component:this,mesh:e};this.instance=n,this.map=t.map||t.emissiveMap,this.map&&!a.has(this.map)?(a.set(this.map,{offset:new THREE.Vector2,instances:[n]}),i.push(this.map)):this.map?(console.warn("Multiple uv-scroll instances added to objects sharing a texture, only the speed/increment from the first one will have any effect"),a.get(this.map).instances.push(n)):console.warn("Ignoring uv-scroll added to mesh with no scrollable texture.")}},pause(){if(this.map){const e=a.get(this.map).instances;e.splice(e.indexOf(this.instance),1),e.length||(a.delete(this.map),i.splice(i.indexOf(this.map),1))}}})},391:function(e,t){e.exports="if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n  float ratio = 0.0;\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\n\n  if (hubs_EnableSweepingEffect) {\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\n\n    if (hubs_WorldPosition.y < line) {\n      // Highlight with a sweeping gradient.\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\n    }\n  }\n\n  // Highlight with a gradient falling off with distance.\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\n\n  if (hubs_HighlightInteractorOne) {\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\n  } \n\n  if (hubs_HighlightInteractorTwo) {\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\n  }\n\n  ratio = min(1.0, ratio);\n\n  // Gamma corrected highlight color\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\n\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\n}\n"},392:function(e,t,n){e.exports=n.p+"assets/hud/action_button.9-438d957372d6db1f225653a7e1083ffe.png"},393:function(e,t,n){e.exports=n.p+"assets/hud/button.9-1983f9e07c50d99b7f0db40e9bd0c3a1.png"},394:function(e,t,n){e.exports=n.p+"assets/hud/nametag.9-7b9c7f3806be28f5ba1468cdae710338.png"},395:function(e,t,n){e.exports=n.p+"assets/hud/nametag-border.9-7b34c214fad1f34baa28d0b0be5a027a.png"},396:function(e,t,n){e.exports=n.p+"assets/models/LoadingObject_Atom-63177fe6a0cd36cf826c1037e1beab66.glb"},397:function(e,t,n){e.exports=n.p+"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3"},398:function(e,t,n){e.exports=n.p+"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3"},399:function(e,t,n){e.exports=n.p+"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3"},4:function(e,t,n){"use strict";n(64),n(65),n(66),n(67),n(68);var a=n(16),i={},r=!1;["RETICULUM_SERVER","THUMBNAIL_SERVER","CORS_PROXY_SERVER","NON_CORS_PROXY_DOMAINS","SENTRY_DSN","GA_TRACKING_ID","SHORTLINK_DOMAIN","BASE_ASSETS_PATH","UPLOADS_HOST"].forEach((function(e){var t=document.querySelector("meta[name='env:".concat(e.toLowerCase(),"']"));i[e]=t?t.getAttribute("content"):{NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}[e];"BASE_ASSETS_PATH"===e&&i.BASE_ASSETS_PATH&&(i.BASE_ASSETS_PATH.startsWith("http")||(i.BASE_ASSETS_PATH=new URL(i.BASE_ASSETS_PATH,window.location).toString()),n.p=i.BASE_ASSETS_PATH)}));var o=!!document.querySelector("meta[name='env:thumbnail_server']");if(i.IS_LOCAL_OR_CUSTOM_CLIENT=!o,i.AVAILABLE_INTEGRATIONS=window.AVAILABLE_INTEGRATIONS||{},{NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}.APP_CONFIG&&(window.APP_CONFIG={NODE_ENV:"production",SHORTLINK_DOMAIN:"nftbrandshub.xyz",RETICULUM_SERVER:"",THUMBNAIL_SERVER:"metaverseplus2.xyz",CORS_PROXY_SERVER:"cors-proxy.metaverseplus2.xyz",NON_CORS_PROXY_DOMAINS:"metaverseplus2.xyz,assets.metaverseplus2.xyz,mvp1-73920e77f1e2-hubs-worker.com",BUILD_VERSION:"1.0.0.20220616041622",SENTRY_DSN:"",GA_TRACKING_ID:"",POSTGREST_SERVER:"",UPLOADS_HOST:"",BASE_ASSETS_PATH:"https://assets.metaverseplus2.xyz/hubs/"}.APP_CONFIG),window.APP_CONFIG){i.APP_CONFIG=window.APP_CONFIG;var s=i.APP_CONFIG.theme;if(s){var l=[];for(var c in s)s.hasOwnProperty(c)&&l.push("--".concat(c,": ").concat(s[c],";"));var d=document.createElement("style");d.innerHTML=":root{".concat(l.join("\n"),"}"),document.head.insertBefore(d,document.head.firstChild)}i.APP_CONFIG.features||(i.APP_CONFIG.features={})}else i.APP_CONFIG={features:{}};i.feature=function(e){var t=i.APP_CONFIG&&i.APP_CONFIG.features&&i.APP_CONFIG.features[e];return("boolean"==typeof t||"enable_spoke"===e)&&"enable_spoke"===e&&r||t};var u={};i.image=function(e,t){var n=i.APP_CONFIG&&i.APP_CONFIG.images&&i.APP_CONFIG.images[e]||u[e];return n&&t?"url(".concat(n,")"):n},i.link=function(e,t){return i.APP_CONFIG&&i.APP_CONFIG.links&&i.APP_CONFIG.links[e]||t},i.setIsAdmin=function(e){r=e},i.isAdmin=function(){return r},i.integration=function(e){var t=i.AVAILABLE_INTEGRATIONS;return!t.hasOwnProperty(e)||t[e]},i.translation=function(e){var t=Object(a.a)(),n=i.APP_CONFIG&&i.APP_CONFIG.translations||{};return n[t]&&n[t][e]||n.en&&n.en[e]||Object(a.b)(e)||""},t.a=i},400:function(e,t,n){e.exports=n.p+"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3"},401:function(e,t,n){e.exports=n.p+"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3"},402:function(e,t,n){e.exports=n.p+"assets/sfx/welcome-2a510e5f966867a4c9ca3cff716a1797.mp3"},403:function(e,t,n){e.exports=n.p+"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3"},404:function(e,t,n){e.exports=n.p+"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3"},405:function(e,t,n){e.exports=n.p+"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3"},406:function(e,t,n){e.exports=n.p+"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3"},407:function(e,t,n){e.exports=n.p+"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3"},408:function(e,t,n){e.exports=n.p+"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3"},409:function(e,t,n){e.exports=n.p+"assets/sfx/emoji-27673179a22e6f42e8187ccba07e4dce.mp3"},410:function(e,t,n){e.exports=n.p+"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3"},411:function(e,t,n){e.exports=n.p+"assets/images/avatar_unavailable-3145734291e8890bc42b09db277bb337.png"},413:function(e,t,n){e.exports={lg:"CloseButton__lg__ZB1Yp"}},414:function(e,t,n){e.exports=n.p+"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png"},415:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg"},416:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg"},417:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg"},418:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg"},419:function(e,t,n){e.exports=n.p+"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg"},420:function(e,t,n){e.exports=n.p+"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg"},421:function(e,t,n){e.exports={preview:"avatar-preview__preview__2I8qx"}},422:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),i=n(322);function r(e,t,n){const[r,o]=Object(a.useState)({width:window.screen.width,height:window.screen.height});Object(a.useEffect)(()=>{function e(){const{maxResolutionWidth:e,maxResolutionHeight:n}=t.state.preferences;o({width:void 0===e?window.screen.width:e,height:void 0===n?window.screen.height:n})}return e(),t.addEventListener("statechanged",e),()=>{t.removeEventListener("statechanged",e)}},[t]),Object(a.useEffect)(()=>{const t=new i.a(e=>{const t=n.renderer.xr.isPresenting,a=n.renderer.xr.enabled&&t;if(!n.camera||!n.canvas||n.is("vr-mode")&&(n.isMobile||a))return;const i=e[0].contentRect,o=function(e,t,n){const a=window.devicePixelRatio;if(!t||n||-1===t.width&&-1===t.height)return e;if(e.width*a<t.width&&e.height*a<t.height)return e;const i=e.width/e.height;return e.width*a>t.width&&-1!==t.width?{width:Math.round(t.width/a),height:Math.round(t.width/i/a)}:e.height*a>t.height&&-1!==t.height?{height:Math.round(t.height/a),width:Math.round(t.height*i/a)}:e}(i,r,a),s=n.canvas;s.style.width=i.width+"px",s.style.height=i.height+"px",n.renderer.setSize(o.width,o.height,!1),n.camera.aspect=o.width/o.height,n.camera.updateProjectionMatrix(),n.renderer.render(n.object3D,n.camera),n.emit("rendererresize",null,!1)});return t.observe(e.current),()=>{t.disconnect()}},[e,n,r])}},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(140),i=n(11);let r,o;class s{constructor(){this.entities=[]}register(e){this.entities.push(e)}unregister(e){this.entities.splice(this.entities.indexOf(e),1)}tick(){r=r||document.getElementById("viewing-camera"),o=o||document.getElementById("ui-root");const e=r&&r.sceneEl.is("entered"),t=!e&&o&&o.firstChild&&o.firstChild.classList.contains("isGhost");for(let n=0;n<this.entities.length;n++){const o=this.entities[n],s=AFRAME.scenes[0].systems["hubs-systems"];!o||s&&(s.cameraSystem.mode===a.b||t||e)||(o.components["scene-preview-camera"].tick2(),s&&r&&(o.object3D.updateMatrices(),Object(i.n)(r.object3DMap.camera,o.object3D.matrixWorld)))}}}},424:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(37);const i=new THREE.Box3,r=new THREE.Matrix4,o=new THREE.Box3,s=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];class l{constructor(e){this.sceneEl=e,this.shadowCameraBoundingBox=new THREE.Box3,this.previousShadowsEnabled=this.realtimeShadowsEnabled=null,e.renderer.shadowMap.enabled=!1,e.renderer.shadowMap.type=THREE.PCFSoftShadowMap,e.renderer.shadowMap.autoUpdate=!0,window.APP.store.addEventListener("statechanged",this.updatePrefs.bind(this)),this.updatePrefs()}updatePrefs(){this.realtimeShadowsEnabled=!0===window.APP.store.state.preferences.enableDynamicShadows&&"low"!==window.APP.store.materialQualitySetting,this.previousShadowsEnabled!==this.realtimeShadowsEnabled&&(this.sceneEl.renderer.shadowMap.enabled=this.realtimeShadowsEnabled,this.sceneEl.hasLoaded&&this.sceneEl.object3D.traverse(e=>{e.receiveShadow&&e.material&&Object(a.e)(e,e=>(e.needsUpdate=!0,e))})),this.previousShadowsEnabled=this.realtimeShadowsEnabled}tick(){this.realtimeShadowsEnabled&&(!function(e,t=new THREE.Box3){t.makeEmpty(),e.updateMatrixWorld(),e.traverse(e=>{const n=e.geometry;n&&e.castShadow&&(n.boundingBox||n.computeBoundingBox(),o.copy(n.boundingBox),o.applyMatrix4(e.matrixWorld),t.union(o))}),o.makeEmpty()}(this.sceneEl.object3D,this.shadowCameraBoundingBox),this.sceneEl.object3D.traverse(e=>{e.isDirectionalLight&&function(e,t){i.makeEmpty();const n=t.min,a=t.max;s[0].set(n.x,n.y,n.z),s[1].set(n.x,n.y,a.z),s[2].set(n.x,a.y,n.z),s[3].set(n.x,a.y,a.z),s[4].set(a.x,n.y,n.z),s[5].set(a.x,n.y,a.z),s[6].set(a.x,a.y,n.z),s[7].set(a.x,a.y,a.z),e.updateMatrices(),e.target.updateMatrices(),e.shadow.updateMatrices(e),r.copy(e.shadow.camera.matrixWorld).invert();for(let e=0;e<s.length;e++)s[e].applyMatrix4(r),i.expandByPoint(s[e]);const o=e.shadow.camera;o.left=i.min.x-1,o.right=i.max.x+1,o.bottom=i.min.y-1,o.top=i.max.y+1,o.near=i.min.z+-500,o.far=i.max.z+500,o.updateProjectionMatrix()}(e,this.shadowCameraBoundingBox)}))}}},425:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(477),i=n(12),r=n(478),o=n(426),s=n.n(o);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){c(e,t,n[t])}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d={None:"NoToneMapping",Linear:"LinearToneMapping",Reinhard:"ReinhardToneMapping",Cineon:"CineonToneMapping",ACESFilmic:"ACESFilmicToneMapping",CustomToneMapping:"CustomToneMapping",LUTToneMapping:"LUTToneMapping"},u={LinearEncoding:"LinearEncoding",sRGBEncoding:"sRGBEncoding",GammaEncoding:"GammaEncoding",GBEEncoding:"GBEEncoding",LogLuvEncoding:"LogLuvEncoding",GBM7Encoding:"GBM7Encoding",RGBM16Encoding:"RGBM16Encoding",GBDEncoding:"GBDEncoding",BasicDepthPacking:"BasicDepthPacking",GBADepthPacking:"GBADepthPackig"},h={toneMapping:d.Linear,outputEncoding:u.sRGBEncoding,toneMappingExposure:1,physicallyCorrectLights:!0,envMapTexture:null,backgroundTexture:null,backgroundColor:new THREE.Color("#000000"),fogType:null,fogColor:new THREE.Color("#ffffff"),fogDensity:25e-5,fogFar:1e3,fogNear:1};let p;class m{constructor(e){this.scene=e.object3D,this.renderer=e.renderer,this.pmremGenerator=new THREE.PMREMGenerator(this.renderer),this.applyEnvSettings(h),Object(i.a)("envSettingsDebug")&&this.setupDebugView()}setupDebugView(){const e=l({},h),t=()=>{this.applyEnvSettings(e)},n=new a.a;n.add(e,"toneMapping",Object.values(d)).onChange(t).listen(),n.add(e,"toneMappingExposure",0,4,.01).onChange(t).listen(),n.add(e,"outputEncoding",Object.values(u)).onChange(t).listen(),n.add(e,"physicallyCorrectLights",!0).onChange(t).listen(),n.open(),this.debugGui=n,this.debugSettings=e,this.debugMode=!0,window.$E=this}updateEnvironment(e){const t=e.querySelector("[environment-settings]"),n=e.querySelector("[skybox]"),a=e.querySelector("[nav-mesh]"),i=l({},h,{skybox:null==n?void 0:n.components.skybox});t&&Object.assign(i,t.components["environment-settings"].data);const r=null==a?void 0:a.object3D.getObjectByProperty("isMesh",!0);r&&AFRAME.scenes[0].systems.nav.loadMesh(r,a.components["nav-mesh"].data.zone),e.object3D.traverse(e=>{e.isMesh&&(e.reflectionProbeMode="static")}),this.applyEnvSettings(i)}applyEnvSettings(e){var t;this.debugSettings&&Object.assign(this.debugSettings,e);let n=!1;this.debugMode&&console.log("Applying environment settings",e),this.renderer.physicallyCorrectLights!==e.physicallyCorrectLights&&(this.renderer.physicallyCorrectLights=e.physicallyCorrectLights,n=!0);const a=THREE[e.toneMapping];this.renderer.toneMapping!==a&&(this.renderer.toneMapping=a,n=!0,a===THREE.LUTToneMapping?(p||(p=new Promise((function(e,t){(new r.a).load(s.a,({texture3D:t})=>e(t),null,t)}))),p.then(e=>{this.renderer.tonemappingLUT=e}).catch((function(e){console.error("Error loading Blender LUT",e),p=null}))):this.renderer.tonemappingLUT=null),this.renderer.toneMappingExposure=e.toneMappingExposure;const i=THREE[e.outputEncoding];this.renderer.outputEncoding!==i&&(this.renderer.outputEncoding=i,n=!0),this.scene.remove(window.lp),e.backgroundTexture?(e.backgroundTexture.mapping=THREE.EquirectangularReflectionMapping,this.scene.background=e.backgroundTexture):this.scene.background=e.backgroundColor,e.envMapTexture?this.prevEnvMapTextureUUID!==e.envMapTexture.uuid&&(this.prevEnvMapTextureUUID=e.envMapTexture.uuid,e.envMapTexture.flipY=!0,e.envMapTexture.mapping=THREE.EquirectangularReflectionMapping,this.scene.environment=e.envMapTexture):e.skybox?this.prevEnvMapTextureUUID!==e.skybox.uuid&&(this.prevEnvMapTextureUUID=e.skybox.uuid,this.scene.environment=e.skybox.sky.generateEnvironmentMap(this.renderer)):(this.scene.environment=null,this.prevEnvMapTextureUUID=null),(null===(t=this.scene.fog)||void 0===t?void 0:t.name)!==e.fogType?("linear"===e.fogType?this.scene.fog=new THREE.Fog(e.fogColor,e.fogNear,e.fogFar):"exponential"===e.fogType?this.scene.fog=new THREE.FogExp2(e.fogColor,e.fogDensity):this.scene.fog=null,n=!0):e.fogType&&(this.scene.fog.color.copy(e.fogColor),"linear"===e.fogType?(this.scene.fog.near=e.fogNear,this.scene.fog.far=e.fogFar):"exponential"===e.fogType&&(this.scene.fog.density=e.fogDensity)),n&&(this.debugMode&&console.log("materials need updating"),this.scene.traverse(e=>{e.material&&(e.material.needsUpdate=!0)}))}}AFRAME.registerComponent("nav-mesh",{schema:{zone:{default:"character"}}}),AFRAME.registerComponent("environment-settings",{schema:{toneMapping:{default:h.toneMapping,oneOf:Object.values(d)},toneMappingExposure:{default:h.toneMappingExposure},backgroundColor:{type:"color",default:h.background},fogType:{type:"string",default:h.fogType},fogColor:{type:"color",default:h.fogColor},fogDensity:{type:"number",default:h.fogDensity},fogNear:{type:"number",default:h.forNear},fogFar:{type:"number",default:h.fogFar}}}),AFRAME.registerComponent("reflection-probe",{schema:{size:{default:1},envMapTexture:{type:"map"}},init:function(){this.el.object3D.updateMatrices();const e=(new THREE.Box3).setFromCenterAndSize(new THREE.Vector3,(new THREE.Vector3).setScalar(2*this.data.size)).applyMatrix4(this.el.object3D.matrixWorld);if(this.el.setObject3D("probe",new THREE.ReflectionProbe(e,this.data.envMapTexture)),this.el.sceneEl.systems["hubs-systems"].environmentSystem.debugMode){const e=(new THREE.Box3).setFromCenterAndSize(new THREE.Vector3,(new THREE.Vector3).setScalar(2*this.data.size));this.el.setObject3D("helper",new THREE.Box3Helper(e,new THREE.Color(Math.random(),Math.random(),Math.random())))}}})},426:function(e,t,n){e.exports=n.p+"assets/blender-lut-d60eebdc2b11fbaa6a041253ed1402b0.cube"},429:function(e,t,n){"use strict";function a(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)}))}}function r(e,t){return o.apply(this,arguments)}function o(){return(o=i((function*(e,t){return crypto.subtle.deriveKey({name:"ECDH",public:t},e,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])}))).apply(this,arguments)}function s(e){return l.apply(this,arguments)}function l(){return(l=i((function*(e){return JSON.stringify(yield crypto.subtle.exportKey("jwk",e))}))).apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return(d=i((function*(e){return yield crypto.subtle.importKey("jwk",JSON.parse(e),{name:"ECDH",namedCurve:"P-256"},!0,[])}))).apply(this,arguments)}function u(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function h(e){const t=new Uint8Array(e);let n="";for(let e=0;e<t.byteLength;e++)n+=String.fromCharCode(t[e]);return n}function p(){return(p=i((function*(){const e=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]);return{publicKeyString:yield s(e.publicKey),privateKey:e.privateKey}}))).apply(this,arguments)}function m(){return(m=i((function*(e,t){const n=new Uint8Array(16),a=yield c(e),i=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),o=yield s(i.publicKey),l=yield r(i.privateKey,a);return{publicKeyString:o,encryptedData:btoa(h(yield crypto.subtle.encrypt({name:"AES-CBC",iv:n},l,u(JSON.stringify(t)))))}}))).apply(this,arguments)}function f(){return(f=i((function*(e,t,n){const a=new Uint8Array(16),i=yield c(e),o=yield r(t,i),s=u(atob(n)),l=yield crypto.subtle.decrypt({name:"AES-CBC",iv:a},o,s);return JSON.parse(h(l))}))).apply(this,arguments)}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){v(e,t,n[t])}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return b}));class b{constructor(e){this.setSocket=e=>{this.socket=e},this.generateCode=()=>new Promise(e=>{const t=new Promise(n=>{const a=()=>{const i=()=>"ABCDEFGHI"[Math.floor(9*Math.random())],r="".concat(i()).concat(i()).concat(i()).concat(i());let o=!1,s=!1;const l=this.socket.channel("link:".concat(r),{timeout:1e4}),c=()=>{s||l.leave(),s=!0},d=()=>c();l.on("link_expired",()=>n("expired")),l.on("presence_state",n=>{o||(Object.keys(n).length>0?a():(o=!0,e({code:r,cancel:d,onFinished:t})))}),l.on("link_request",e=>{if(o){const t={path:location.pathname};this.store.state.activity.hasChangedName&&(t.profile=g({},this.store.state.profile)),t.credentials=g({},this.store.state.credentials),function(e,t){return m.apply(this,arguments)}(e.public_key,t).then(({publicKeyString:t,encryptedData:a})=>{const i={target_session_id:e.reply_to_session_id,public_key:t,data:a};s||l.push("link_response",i),c(),n("used"),o=!1})}}),l.join().receive("error",e=>console.error(e))};a()})}),this.attemptLink=e=>new Promise((t,n)=>{const a=this.socket.channel("link:".concat(e),{timeout:1e4});let i=!1;(function(){return p.apply(this,arguments)})().then(({publicKeyString:e,privateKey:r})=>{a.on("presence_state",t=>{const r=Object.keys(t).length;1===r?(a.push("link_request",{reply_to_session_id:this.socket.params().session_id,public_key:e}),setTimeout(()=>{i||(a.leave(),n(new Error("no_response")))},1e4)):0===r?(a.leave(),n(new Error("failed"))):(console.warn("link code channel already has 2 or more occupants, something fishy is going on."),a.leave(),n(new Error("in_use")))}),a.on("link_response",e=>{i=!0,a.leave(),function(e,t,n){return f.apply(this,arguments)}(e.public_key,r,e.data).then(t)}),a.join().receive("ok",e=>this.socket.params().session_id=e.session_id).receive("error",e=>console.error(e))})}),this.store=e}}},432:function(e,t,n){e.exports={trackColor:"var(--primary-color)","number-with-range":"Slider__number-with-range__2yK02",numberWithRange:"Slider__number-with-range__2yK02","range-slider":"Slider__range-slider__3GLiW",rangeSlider:"Slider__range-slider__3GLiW"}},434:function(e,t,n){e.exports={"loading-screen-layout":"LoadingScreenLayout__loading-screen-layout__FjWc6",loadingScreenLayout:"LoadingScreenLayout__loading-screen-layout__FjWc6",center:"LoadingScreenLayout__center__GIcnI",logo:"LoadingScreenLayout__logo__3bfwo",bottom:"LoadingScreenLayout__bottom__2FUSp"}},435:function(e,t,n){e.exports={"content-menu":"ContentMenu__content-menu__15hNf",contentMenu:"ContentMenu__content-menu__15hNf","content-menu-button":"ContentMenu__content-menu-button__1QkGw",contentMenuButton:"ContentMenu__content-menu-button__1QkGw",active:"ContentMenu__active__S2U1Z",separator:"ContentMenu__separator__27bBF"}},44:function(e,t,n){e.exports={"nav-item":"preferences-screen__nav-item__3wk4x",navItem:"preferences-screen__nav-item__3wk4x",dropdown:"preferences-screen__dropdown__Yvmf_","section-title":"preferences-screen__section-title__1JGHh",sectionTitle:"preferences-screen__section-title__1JGHh","refresh-prompt":"preferences-screen__refresh-prompt__298UP",refreshPrompt:"preferences-screen__refresh-prompt__298UP","preference-label":"preferences-screen__preference-label__2QMX3",preferenceLabel:"preferences-screen__preference-label__2QMX3","max-resolution-preference-item":"preferences-screen__max-resolution-preference-item__1lqd7",maxResolutionPreferenceItem:"preferences-screen__max-resolution-preference-item__1lqd7","preferences-panel":"preferences-screen__preferences-panel__1WQqG",preferencesPanel:"preferences-screen__preferences-panel__1WQqG","refresh-now-button":"preferences-screen__refresh-now-button__3AysF",refreshNowButton:"preferences-screen__refresh-now-button__3AysF","reset-to-default-button":"preferences-screen__reset-to-default-button__1WpmV",resetToDefaultButton:"preferences-screen__reset-to-default-button__1WpmV","close-button":"preferences-screen__close-button__2zMLp",closeButton:"preferences-screen__close-button__2zMLp","no-default-button-style":"preferences-screen__no-default-button-style__3rNT-",noDefaultButtonStyle:"preferences-screen__no-default-button-style__3rNT-","nav-container":"preferences-screen__nav-container__18eMw",navContainer:"preferences-screen__nav-container__18eMw",nav:"preferences-screen__nav__CgUX7",selected:"preferences-screen__selected__13wz5",vertical:"preferences-screen__vertical__3umN8",horizontal:"preferences-screen__horizontal__2Libq","list-item":"preferences-screen__list-item__2bJXt",listItem:"preferences-screen__list-item__2bJXt",column:"preferences-screen__column__2Q5rv",row:"preferences-screen__row__24y1Q","row-right":"preferences-screen__row-right__2dL9F",rowRight:"preferences-screen__row-right__2dL9F","row-center":"preferences-screen__row-center__1CC_y",rowCenter:"preferences-screen__row-center__1CC_y","warn-icon":"preferences-screen__warn-icon__1yCTe",warnIcon:"preferences-screen__warn-icon__1yCTe","warn-icon-placeholder":"preferences-screen__warn-icon-placeholder__1i4lO",warnIconPlaceholder:"preferences-screen__warn-icon-placeholder__1i4lO","control-with-default":"preferences-screen__control-with-default__2-fUi",controlWithDefault:"preferences-screen__control-with-default__2-fUi",toast:"preferences-screen__toast__3VuzK","reset-to-default-button-placeholder":"preferences-screen__reset-to-default-button-placeholder__1-EM_",resetToDefaultButtonPlaceholder:"preferences-screen__reset-to-default-button-placeholder__1-EM_",flex:"preferences-screen__flex__G1TbZ",icon:"preferences-screen__icon__1JySY","content-container":"preferences-screen__content-container__3VLFw",contentContainer:"preferences-screen__content-container__3VLFw","scrolling-content":"preferences-screen__scrolling-content__3eE_K",scrollingContent:"preferences-screen__scrolling-content__3eE_K","checkbox-placeholder":"preferences-screen__checkbox-placeholder__3_hLX",checkboxPlaceholder:"preferences-screen__checkbox-placeholder__3_hLX",section:"preferences-screen__section__2StMI","dropdown-arrow":"preferences-screen__dropdown-arrow__3nHfN",dropdownArrow:"preferences-screen__dropdown-arrow__3nHfN","number-with-range":"preferences-screen__number-with-range__35LSW",numberWithRange:"preferences-screen__number-with-range__35LSW","number-in-number-with-range":"preferences-screen__number-in-number-with-range__2KQrK",numberInNumberWithRange:"preferences-screen__number-in-number-with-range__2KQrK"}},45:function(e,t,n){e.exports={"outer-wrapper":"TextInput__outer-wrapper__1f4NF",outerWrapper:"TextInput__outer-wrapper__1f4NF","input-wrapper":"TextInput__input-wrapper__j3Fk-",inputWrapper:"TextInput__input-wrapper__j3Fk-","before-input":"TextInput__before-input__v6otW",beforeInput:"TextInput__before-input__v6otW","after-input":"TextInput__after-input__380cd",afterInput:"TextInput__after-input__380cd",button:"TextInput__button__1ue_9","icon-button":"TextInput__icon-button__3y8mN",iconButton:"TextInput__icon-button__3y8mN",disabled:"TextInput__disabled__2k5hv",invalid:"TextInput__invalid__1NkU6","text-input":"TextInput__text-input__1-6ZA",textInput:"TextInput__text-input__1-6ZA","invalid-icon":"TextInput__invalid-icon__2kFlx",invalidIcon:"TextInput__invalid-icon__2kFlx"}},469:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"platformUnsupported",(function(){return platformUnsupported}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(53),react_dom__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__),copy_to_clipboard__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(315),copy_to_clipboard__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(copy_to_clipboard__WEBPACK_IMPORTED_MODULE_2__),detect_browser__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93),detect_browser__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(detect_browser__WEBPACK_IMPORTED_MODULE_3__),_react_components_styles_global_scss__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95),_react_components_styles_global_scss__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_react_components_styles_global_scss__WEBPACK_IMPORTED_MODULE_4__),_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(202),_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5__);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _createSuper2(e){function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}return function(){var n,a=_getPrototypeOf(e);if(t()){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var SHORTHAND_INITIALIZER="var foo = 'bar'; var baz = { foo };",SPREAD_SYNTAX="var foo = {}; var baz = { ...foo };",CATCH_SYNTAX="try { foo(); } catch {}";function syntaxSupported(syntax){try{return eval(syntax),!0}catch(e){return!1}}function getPlatformSupport(){return[{name:"Web Assembly",supported:!!window.WebAssembly},{name:"Media Devices",supported:!!navigator.mediaDevices},{name:"Modern JavaScript Syntax",supported:syntaxSupported(CATCH_SYNTAX)&&syntaxSupported(SPREAD_SYNTAX)&&syntaxSupported(SHORTHAND_INITIALIZER)}]}function isInAppBrowser(){return"iOS"===Object(detect_browser__WEBPACK_IMPORTED_MODULE_3__.detectOS)(navigator.userAgent)&&!navigator.mediaDevices||/\bfb_iab\b/i.test(navigator.userAgent)}function platformUnsupported(){return getPlatformSupport().some((function(e){return!e.supported}))||isInAppBrowser()}var Support=function(e){_inherits(n,e);var t=_createSuper2(n);function n(){var e;_classCallCheck(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={showDetails:!1,hasCopied:!1},e.toggleDetails=function(t){t.preventDefault(),e.setState((function(e){return e.showDetails=!e.showDetails,e}))},e.onCopyClicked=function(t){t.preventDefault(),copy_to_clipboard__WEBPACK_IMPORTED_MODULE_2___default()(document.location),e.setState({hasCopied:!0})},e}return _createClass(n,[{key:"render",value:function(){var e=getPlatformSupport(),t=e.every((function(e){return e.supported})),n=isInAppBrowser();if(t&&!n)return null;var a=Object(detect_browser__WEBPACK_IMPORTED_MODULE_3__.detectOS)(navigator.userAgent);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default.a.supportMain},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default.a.supportContent},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h1",null,"Mozilla Hubs"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",{className:_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default.a.unsupportedLangs}," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Unsupported"),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"No Soportado"),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Nicht Untersttzt"),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Sem Suporte"),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Non Compatible"),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,""),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null," "),"  ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"")," "),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Your browser is missing required features."),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),n?"iOS"===a?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Copy and paste this link directly into Safari"):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Copy and paste this link directly into Chrome or Firefox"):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Please try switching or updating to a newer browser"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("input",{type:"text",readOnly:!0,onFocus:function(e){return e.target.select()},value:document.location}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{className:"copy-link",href:"#",onClick:this.onCopyClicked},this.state.hasCopied?"copied!":"copy"),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("br",null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a",{className:_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default.a.detailsLink,href:"#",onClick:this.toggleDetails},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"details"))),this.state.showDetails&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("table",{className:_assets_stylesheets_support_scss__WEBPACK_IMPORTED_MODULE_5___default.a.details},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("tbody",null,e.sort((function(e,t){return e.supported&&!t.supported?1:-1})).map((function(e){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("tr",{key:e.name},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("td",null,e.name),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("td",null,e.supported?"supported":"unsupported"))}))))))}}]),n}(react__WEBPACK_IMPORTED_MODULE_0___default.a.Component);document.addEventListener("DOMContentLoaded",(function(){react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Support,null),document.getElementById("support-root"))}))},47:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(104),d=n.n(c);function u({title:e,titleNode:t,beforeTitle:n,afterTitle:a,children:r,contentClassName:o,className:s,disableFullscreen:c}){return i.a.createElement("div",{className:l()(d.a.modal,{[d.a.smFullscreen]:!c},s)},(e||n||a)&&i.a.createElement("div",{className:d.a.header},i.a.createElement("div",{className:d.a.beforeTitle},n),t||i.a.createElement("h5",null,e),i.a.createElement("div",{className:d.a.afterTitle},a)),i.a.createElement("div",{className:l()(d.a.content,o)},r))}u.propTypes={title:o.a.node,titleNode:o.a.node,beforeTitle:o.a.node,afterTitle:o.a.node,children:o.a.node,className:o.a.string,contentClassName:o.a.string,disableFullscreen:o.a.bool}},473:function(e,t,n){e.exports=n.p+"assets/models/DuckyMesh-bb97d3e4ddb733f9a8bdeadcf3fe3e2a.glb"},474:function(e,t,n){e.exports=n.p+"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png"},475:function(e,t,n){e.exports=n.p+"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png"},479:function(e,t,n){e.exports={interstitial:"ui-root__interstitial__1cotl",ui:"ui-root__ui__33CMU","no-default-button-style":"ui-root__no-default-button-style__qWBUA",noDefaultButtonStyle:"ui-root__no-default-button-style__qWBUA","avatar-editor":"ui-root__avatar-editor__2mO8z",avatarEditor:"ui-root__avatar-editor__2mO8z"}},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(57),d=n(258),u=n(413),h=n.n(u);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function f(e){let{lg:t,className:n}=e,a=m(e,["lg","className"]);return i.a.createElement(c.a,p({className:l()({[h.a.lg]:t},n)},a),i.a.createElement(d.a,{width:16,height:16}))}f.propTypes={className:o.a.string,lg:o.a.bool}},480:function(e,t,n){e.exports={hidden:"ObjectUrlModal__hidden__1INnH","url-input":"ObjectUrlModal__url-input__3FqDw",urlInput:"ObjectUrlModal__url-input__3FqDw"}},481:function(e,t,n){e.exports={"code-container":"EnterOnDeviceModal__code-container__xLcj1",codeContainer:"EnterOnDeviceModal__code-container__xLcj1","short-url-container":"EnterOnDeviceModal__short-url-container__3DltK",shortUrlContainer:"EnterOnDeviceModal__short-url-container__3DltK","code-letter":"EnterOnDeviceModal__code-letter__2j09a",codeLetter:"EnterOnDeviceModal__code-letter__2j09a"}},482:function(e,t,n){e.exports={"level-bar-container":"LevelBar__level-bar-container__qc4HE",levelBarContainer:"LevelBar__level-bar-container__qc4HE","level-bar-border":"LevelBar__level-bar-border__1zPGA",levelBarBorder:"LevelBar__level-bar-border__1zPGA","level-bar":"LevelBar__level-bar__3K0A8",levelBar:"LevelBar__level-bar__3K0A8"}},483:function(e,t,n){e.exports={person:"PeopleSidebar__person__2MDeA","moderator-icon":"PeopleSidebar__moderator-icon__19Fqq",moderatorIcon:"PeopleSidebar__moderator-icon__19Fqq",presence:"PeopleSidebar__presence__xhCbs"}},484:function(e,t,n){e.exports={"avatar-preview-container":"UserProfileSidebar__avatar-preview-container__2d92D",avatarPreviewContainer:"UserProfileSidebar__avatar-preview-container__2d92D","slider-container":"UserProfileSidebar__slider-container__GJXA4",sliderContainer:"UserProfileSidebar__slider-container__GJXA4","slider-input-container":"UserProfileSidebar__slider-input-container__38dT6",sliderInputContainer:"UserProfileSidebar__slider-input-container__38dT6"}},485:function(e,t,n){e.exports={tip:"Tip__tip__28GK8",content:"Tip__content__2Iyoa","dismiss-button":"Tip__dismiss-button__2kHA1",dismissButton:"Tip__dismiss-button__2kHA1"}},51:function(e,t,n){e.exports={"presence-log":"presence-log__presence-log__10oFj",presenceLog:"presence-log__presence-log__10oFj","presence-log-entry":"presence-log__presence-log-entry__dt0t4",presenceLogEntry:"presence-log__presence-log-entry__dt0t4","no-default-button-style":"presence-log__no-default-button-style__3o-00",noDefaultButtonStyle:"presence-log__no-default-button-style__3o-00","message-body":"presence-log__message-body__2L9jA",messageBody:"presence-log__message-body__2L9jA","message-body-multi":"presence-log__message-body-multi__2e-Sx",messageBodyMulti:"presence-log__message-body-multi__2e-Sx","message-body-mono":"presence-log__message-body-mono__3zuQE",messageBodyMono:"presence-log__message-body-mono__3zuQE","message-wrap":"presence-log__message-wrap__2aWCa",messageWrap:"presence-log__message-wrap__2aWCa","message-wrap-multi":"presence-log__message-wrap-multi__1eA6v",messageWrapMulti:"presence-log__message-wrap-multi__1eA6v","message-source":"presence-log__message-source__3CI4d",messageSource:"presence-log__message-source__3CI4d","message-source-link":"presence-log__message-source-link__1evTZ",messageSourceLink:"presence-log__message-source-link__1evTZ","icon-button":"presence-log__icon-button__2Shbm",iconButton:"presence-log__icon-button__2Shbm","spawn-message":"presence-log__spawn-message__14Ne8",spawnMessage:"presence-log__spawn-message__14Ne8",share:"presence-log__share__37U7E",media:"presence-log__media__2qG_d",mediaBody:"presence-log__mediaBody__1rByA",expired:"presence-log__expired__2wMJc","presence-log-entry-with-button":"presence-log__presence-log-entry-with-button__1PxTw",presenceLogEntryWithButton:"presence-log__presence-log-entry-with-button__1PxTw","presence-log-in-room":"presence-log__presence-log-in-room__17h3n",presenceLogInRoom:"presence-log__presence-log-in-room__17h3n","presence-log-spawn":"presence-log__presence-log-spawn__3jlmT",presenceLogSpawn:"presence-log__presence-log-spawn__3jlmT","presence-log-entry-one-line":"presence-log__presence-log-entry-one-line__bRXfp",presenceLogEntryOneLine:"presence-log__presence-log-entry-one-line__bRXfp","presence-log-emoji":"presence-log__presence-log-emoji__1_3Yn",presenceLogEmoji:"presence-log__presence-log-emoji__1_3Yn",emoji:"presence-log__emoji__10b18"}},522:function(e,t,n){var a=n(212).default,i=AFRAME.components,r=AFRAME.registerComponent,o=AFRAME.utils;delete AFRAME.components.animation;var s=new THREE.Color,l=new THREE.Color,c={};function d(e,t){return c[t=t||"."]||(c[t]={}),-1!==e.indexOf(t)?c[t][e]=e.split(t):c[t][e]=e,c[t][e]}const u=function(e,t,n){var a;return n=n||".",-1!==t.indexOf(n)?(a=d(t,n)).constructor===String?e.getAttribute(a):e.getAttribute(a[0])[a[1]]:e.getAttribute(t)},h=function(e,t,n,a){var i;a=a||".",-1===t.indexOf(a)?e.setAttribute(t,n):(i=d(t,a)).constructor===String?e.setAttribute(i,n):e.setAttribute(i[0],i[1],n)};var p={};function m(e){e.x=THREE.Math.degToRad(e.x),e.y=THREE.Math.degToRad(e.y),e.z=THREE.Math.degToRad(e.z)}function f(e,t,n){var a;for(a=0;a<t.length;a++)e.addEventListener(t[a],n)}function g(e,t,n){var a;for(a=0;a<t.length;a++)e.removeEventListener(t[a],n)}function v(e,t){var n,a,i;for(a=y(t),i=e,n=0;n<a.length;n++)i=i[a[n]];return i}function b(e,t,n,a){var i,r,o,s;for(t.startsWith("object3D.rotation")&&(n=THREE.Math.degToRad(n)),r=y(t),s=e,i=0;i<r.length-1;i++)s=s[r[i]];o=r[r.length-1],"color"!==a?s[o]=n:"r"in s[o]?(s[o].r=n.r,s[o].g=n.g,s[o].b=n.b):(s[o].x=n.r,s[o].y=n.g,s[o].z=n.b)}function y(e){return e in p||(p[e]=e.split(".")),p[e]}function E(e){return e.isRawProperty||e.property.startsWith("components")||e.property.startsWith("object3D")}e.exports.Component=r("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var e=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){e.animationIsPlaying=!1,e.el.emit("animationcomplete",e.eventDetail,!1),e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,!1)}}},update:function(e){var t=this.config,n=this.data;this.animationIsPlaying=!1,this.data.enabled&&n.property&&(t.autoplay=!1,t.direction=n.dir,t.duration=n.dur,t.easing=n.easing,t.elasticity=n.elasticity,t.loop=n.loop,t.round=n.round,this.createAndStartAnimation())},tick:function(e,t){this.animationIsPlaying&&(this.time+=t,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners(),this.cancelDelayedStart()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners(),this.cancelDelayedStart()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var e=this.data;this.updateConfig(),this.animationIsPlaying=!1,this.animation=a(this.config),this.removeEventListeners(),this.cancelDelayedStart(),this.addEventListeners(),!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?this.delayTimeout=setTimeout(this.beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig(),this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=a(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){var e,t,n,a=this.config,i=this.data,r=this.el;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(t in e=""===i.from?v(r,i.property):i.from,n=i.to,this.setColorConfig(e,n),e=this.fromColor,n=this.toColor,this.targetsArray.length=0,this.targetsArray.push(e),a.targets=this.targetsArray,n)a[t]=n[t];var o;a.update=(o={},function(e){var t;(t=e.animatables[0].target).r===o.r&&t.g===o.g&&t.b===o.b||b(r,i.property,t,i.type)})}},updateConfigForDefault:function(){var e,t,n,a,i=this.config,r=this.data,o=this.el;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(e=""===r.from?E(r)?v(o,r.property):u(o,r.property):r.from,n=r.to,!isNaN(e||n)?(e=parseFloat(e),n=parseFloat(n)):(e=e?e.toString():e,n=n?n.toString():n),(t="true"===r.to||"false"===r.to||!0===r.to||!1===r.to)&&(e="true"===r.from||!0===r.from?1:0,n="true"===r.to||!0===r.to?1:0),this.targets.aframeProperty=e,i.targets=this.targets,i.aframeProperty=n,i.update=function(e){var n;(n=e.animatables[0].target.aframeProperty)!==a&&(a=n,t&&(n=n>=1),E(r)?b(o,r.property,n,r.type):h(o,r.property,n))})},updateConfigForVector:function(){var e,t,n,a,i=this.config,r=this.data,s=this.el;for(e in t=""!==r.from?o.coordinates.parse(r.from):u(s,r.property),n=o.coordinates.parse(r.to),"rotation"===r.property&&(m(t),m(n)),this.targetsArray.length=0,this.targetsArray.push(t),i.targets=this.targetsArray,n)i[e]=n[e];"position"!==r.property&&"rotation"!==r.property&&"scale"!==r.property?i.update=function(){var e={};return function(t){var n=t.animations[0].target;n.x===e.x&&n.y===e.y&&n.z===e.z||(e.x=n.x,e.y=n.y,e.z=n.z,h(s,r.property,n))}}():i.update=(a={},function(e){var t=e.animatables[0].target;"scale"===r.property&&(t.x=Math.max(1e-4,t.x),t.y=Math.max(1e-4,t.y),t.z=Math.max(1e-4,t.z)),t.x===a.x&&t.y===a.y&&t.z===a.z||(a.x=t.x,a.y=t.y,a.z=t.z,s.object3D[r.property].set(t.x,t.y,t.z),s.object3D.matrixNeedsUpdate=!0)})},updateConfig:function(){var e;e=function(e,t){var n,a,r,o;if(r=t.split("."),a=r[0],o=r[1],!(n=e.components[a]||i[a]))return null;if(o&&!n.schema[o])return null;if(o)return n.schema[o].type;return n.schema.type}(this.el,this.data.property),E(this.data)&&"color"===this.data.type?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(e){var t,n=this.data,i=this.el,r=this;return""===n.from&&(!!n.property.startsWith("components")&&(t=y(n.property)[1],!i.components[t]&&(i.addEventListener("componentinitialized",(function n(o){o.detail.name===t&&(e(),r.animation=a(r.config),i.removeEventListener("componentinitialized",n))})),!0)))},stopRelatedAnimations:function(){var e,t;for(t in this.el.components)e=this.el.components[t],t!==this.attrName&&"animation"===e.name&&e.animationIsPlaying&&e.data.property===this.data.property&&(e.animationIsPlaying=!1)},addEventListeners:function(){var e=this.data,t=this.el;f(t,e.startEvents,this.onStartEvent),f(t,e.pauseEvents,this.pauseAnimation),f(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var e=this.data,t=this.el;g(t,e.startEvents,this.onStartEvent),g(t,e.pauseEvents,this.pauseAnimation),g(t,e.resumeEvents,this.resumeAnimation)},cancelDelayedStart:function(){this.delayTimeout&&(clearTimeout(this.delayTimeout),this.delayTimeout=null)},setColorConfig:function(e,t){s.set(e),l.set(t),e=this.fromColor,t=this.toColor,e.r=s.r,e.g=s.g,e.b=s.b,t.r=l.r,t.g=l.g,t.b=l.b}})},523:function(e,t){AFRAME.registerComponent("ambient-light",{schema:{color:{type:"color"},intensity:{default:1}},init(){this.light=new THREE.AmbientLight,this.el.setObject3D("ambient-light",this.light)},update(e){this.data.color!==e.color&&(this.light.color.set(this.data.color),this.light.color.convertSRGBToLinear()),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("ambient-light")}})},524:function(e,t){const n=AFRAME.utils.device.isMobileVR();AFRAME.registerComponent("billboard",{schema:{onlyY:{type:"boolean"}},init:function(){this._updateBillboard=this._updateBillboard.bind(this),this._updateIsInView=this._updateIsInView.bind(this),n&&this.el.sceneEl.systems["frame-scheduler"].schedule(this._updateIsInView,"billboards")},remove(){n&&this.el.sceneEl.systems["frame-scheduler"].unschedule(this._updateIsInView,"billboards")},tick(){!this.isInView&&n||this._updateBillboard()},_updateIsInView:function(){const e=new THREE.Frustum,t=new THREE.Matrix4,n=new THREE.Box3,a=new THREE.Box3,i=e=>{e.geometry&&(e.updateMatrices(),e.geometry.computeBoundingBox(),a.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),n.expandByPoint(a.min),n.expandByPoint(a.max))},r=(a,r)=>(t.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),e.setFromProjectionMatrix(t),n.makeEmpty(),a.traverse(i),e.intersectsBox(n));return function(){if(this.el.object3D.visible){if(this.playerCamera||(this.playerCamera=document.getElementById("viewing-camera").getObject3D("camera")),this.playerCamera&&(this.isInView=!!this.el.sceneEl.is("vr-mode")||r(this.el.object3D,this.playerCamera),!this.isInView)){const e=this.el.sceneEl.systems["camera-tools"];e&&e.ifMyCameraRenderingViewfinder(e=>{this.isInView=this.isInView||r(this.el.object3D,e.camera)})}}else this.isInView=!1}}(),_updateBillboard:function(){const e=new THREE.Vector3,t=new THREE.Vector3;return function(){if(!this.el.object3D.visible)return;const n=this.el.sceneEl.camera,a=this.el.object3D;n&&(e.setFromMatrixPosition(n.matrixWorld),this.data.onlyY&&(a.getWorldPosition(t),e.y=t.y),a.lookAt(e),a.matrixNeedsUpdate=!0)}}()})},525:function(e,t){AFRAME.registerComponent("css-class",{schema:{type:"string"},multiple:!0,init(){this.el.classList.add(this.data)},update(e){this.data!==e&&(this.el.classList.remove(e),this.el.classList.add(this.data))},remove(){this.el.classList.remove(this.data)}})},526:function(e,t){AFRAME.registerComponent("directional-light",{schema:{color:{type:"color"},intensity:{default:1},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){this.light=new THREE.DirectionalLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.el.setObject3D("directional-light",this.light)},update(e){const t=this.light;if(this.data.color!==e.color){const e=new THREE.Color(this.data.color);e.convertSRGBToLinear(),t.color.copy(e)}this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[n,a]=this.data.shadowMapResolution,[i,r]=e.shadowMapResolution?e.shadowMapResolution:[512,512];n===i&&a===r||(t.shadow.mapSize.set(n,a),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null)),this.light.shadow.camera.matrixNeedsUpdate=!0},remove:function(){this.el.removeObject3D("directional-light")}})},527:function(e,t){AFRAME.registerComponent("duck",{schema:{initialForce:{default:0},maxForce:{default:6.5},maxScale:{default:5}},init:function(){this.initialScale=this.el.object3D.scale.x,this.maxScale=this.data.maxScale*this.initialScale,NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEntity=e,this.initialScale=this.networkedEntity.object3D.scale.x,this.maxScale=this.data.maxScale*this.initialScale})},tick:function(){if(!this.networkedEntity||NAF.utils.isMine(this.networkedEntity)){const e=this.networkedEntity||this.el,t=e.object3D.scale.x,n=Math.min(1,(t-this.initialScale)/(this.maxScale-this.initialScale))*this.data.maxForce;if(n>0){const t=Math.random()*Math.PI*2,a=Math.cos(t),i=Math.sin(t);e.setAttribute("body-helper",{gravity:{x:a,y:n,z:i}})}}}})},528:function(e,t){AFRAME.registerComponent("heightfield",{init(){this.el.addEventListener("componentinitialized",e=>{"static-body"===e.detail.name&&this.generateAndAddHeightfield(this.el.components["static-body"])}),this.el.setAttribute("static-body",{shape:"none",mass:0})},generateAndAddHeightfield(e){const{offset:t,distance:n,data:a}=this.data,i=new CANNON.Quaternion;i.setFromAxisAngle(new CANNON.Vec3(1,0,0),-Math.PI/2);const r=new CANNON.Quaternion;r.setFromAxisAngle(new CANNON.Vec3(0,1,0),-Math.PI/2),r.mult(i,i);const o=new CANNON.Vec3(t.x,t.y,t.z),s=new CANNON.Heightfield(a,{elementSize:n});e.addShape(s,o,i)}})},529:function(e,t){AFRAME.registerComponent("hemisphere-light",{schema:{skyColor:{type:"color"},groundColor:{type:"color"},intensity:{default:1}},init(){this.light=new THREE.HemisphereLight,this.light.position.set(0,0,0),this.light.matrixNeedsUpdate=!0,this.el.setObject3D("hemisphere-light",this.light)},update(e){this.data.skyColor!==e.skyColor&&this.light.color.set(this.data.skyColor),this.data.groundColor!==e.groundColor&&this.light.groundColor.set(this.data.groundColor),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("hemisphere-light")}})},530:function(e,t){AFRAME.registerComponent("hide-when-quality",{schema:{type:"string",default:"low"},update(e){this.data!==e&&this.updateComponentState(window.APP.store.state.preferences.materialQualitySetting)},updateComponentState(e){this.el.setAttribute("visible",e!==this.data)}})},531:function(e,t){AFRAME.registerComponent("point-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},decay:{default:2},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){this.light=new THREE.PointLight,this.light.shadow.camera.matrixAutoUpdate=!0,this.el.setObject3D("point-light",this.light)},update(e){const t=this.light;if(this.data.color!==e.color){const e=new THREE.Color(this.data.color);e.convertSRGBToLinear(),t.color.copy(e)}this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.decay!==e.decay&&(t.decay=this.data.decay),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[n,a]=this.data.shadowMapResolution,[i,r]=e.shadowMapResolution?e.shadowMapResolution:[512,512];n===i&&a===r||(t.shadow.mapSize.set(n,a),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("point-light")}})},532:function(e,t){AFRAME.registerComponent("spot-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},decay:{default:2},innerConeAngle:{default:0},outerConeAngle:{default:Math.PI/4},castShadow:{default:!0},shadowMapResolution:{default:[512,512]},shadowBias:{default:0},shadowRadius:{default:1}},init(){this.light=new THREE.SpotLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.light.matrixNeedsUpdate=!0,this.light.target.matrixNeedsUpdate=!0,this.el.setObject3D("spot-light",this.light)},update(e){const t=this.light;this.data.color!==e.color&&t.color.set(this.data.color),this.data.intensity!==e.intensity&&(t.intensity=this.data.intensity),this.data.range!==e.range&&(t.distance=this.data.range),this.data.decay!==e.decay&&(t.decay=this.data.decay),this.data.innerConeAngle===e.innerConeAngle&&this.data.outerConeAngle===e.outerConeAngle||(t.angle=this.data.outerConeAngle,t.penumbra=1-this.data.innerConeAngle/this.data.outerConeAngle),this.data.castShadow!==e.castShadow&&(t.castShadow=this.data.castShadow),this.data.shadowBias!==e.shadowBias&&(t.shadow.bias=this.data.shadowBias),this.data.shadowRadius!==e.shadowRadius&&(t.shadow.radius=this.data.shadowRadius);const[n,a]=this.data.shadowMapResolution,[i,r]=e.shadowMapResolution?e.shadowMapResolution:[512,512];n===i&&a===r||(t.shadow.mapSize.set(n,a),t.shadow.map&&(t.shadow.map.dispose(),t.shadow.map=null))},remove:function(){this.el.removeObject3D("spot-light")}})},533:function(e,t,n){const a=n(209).COLLISION_LAYERS;AFRAME.registerComponent("floaty-object",{schema:{autoLockOnLoad:{default:!1},autoLockOnRelease:{default:!1},modifyGravityOnRelease:{default:!1},releaseGravity:{default:-2},reduceAngularFloat:{default:!1},gravitySpeedLimit:{default:1.85}},init(){this.onGrab=this.onGrab.bind(this),this.onRelease=this.onRelease.bind(this)},tick(){this.bodyHelper||(this.bodyHelper=this.el.components["body-helper"]);const e=AFRAME.scenes[0].systems.interaction,t=e&&e.isHeld(this.el);if(t&&!this.wasHeld&&this.onGrab(),this.wasHeld&&!t&&this.onRelease(),!t&&this._makeStaticWhenAtRest){const e=this.el.sceneEl.systems["hubs-systems"].physicsSystem,t=this.el.components.networked&&NAF.utils.isMine(this.el),n=this.bodyHelper.data.linearSleepingThreshold,a=this.bodyHelper.data.angularSleepingThreshold,i=this.bodyHelper.uuid,r=e.bodyInitialized(i)&&e.getLinearVelocity(i)<n&&e.getAngularVelocity(i)<a;r&&t&&this.el.setAttribute("body-helper",{type:"kinematic"}),!r&&t||(this._makeStaticWhenAtRest=!1)}this.wasHeld=t},play(){this.hasBeenHereBefore||(this.hasBeenHereBefore=!0,this.data.autoLockOnLoad&&(this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0}}),this.setLocked(!0)))},setLocked(e){this.el.components.networked&&!NAF.utils.isMine(this.el)||(this.locked=e,this.el.setAttribute("body-helper",{type:e?"kinematic":"dynamic"}))},onRelease(){if(this.data.modifyGravityOnRelease){const e=this.bodyHelper.uuid,t=this.el.sceneEl.systems["hubs-systems"].physicsSystem;0===this.data.gravitySpeedLimit||t.bodyInitialized(e)&&t.getLinearVelocity(e)<this.data.gravitySpeedLimit?(this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0},angularDamping:this.data.reduceAngularFloat?.98:.5,linearDamping:.95,linearSleepingThreshold:.1,angularSleepingThreshold:.1,collisionFilterMask:a.HANDS|a.MEDIA_FRAMES}),this._makeStaticWhenAtRest=!0):this.el.setAttribute("body-helper",{gravity:{x:0,y:this.data.releaseGravity,z:0},angularDamping:.01,linearDamping:.01,linearSleepingThreshold:1.6,angularSleepingThreshold:2.5,collisionFilterMask:a.DEFAULT_INTERACTABLE})}else this.el.setAttribute("body-helper",{collisionFilterMask:a.DEFAULT_INTERACTABLE,gravity:{x:0,y:-9.8,z:0}});this.data.autoLockOnRelease&&this.setLocked(!0)},onGrab(){this.el.setAttribute("body-helper",{gravity:{x:0,y:0,z:0},collisionFilterMask:a.HANDS|a.MEDIA_FRAMES}),this.setLocked(!1)},remove(){if(this.stuckTo){const e=this.stuckTo;delete this.stuckTo,e._unstickObject()}}})},534:function(e,t){THREE.Water=function(e,t){THREE.Mesh.call(this,e);const n=this,a=void 0!==(t=t||{}).textureWidth?t.textureWidth:512,i=void 0!==t.textureHeight?t.textureHeight:512,r=void 0!==t.clipBias?t.clipBias:0,o=void 0!==t.alpha?t.alpha:1,s=void 0!==t.time?t.time:0,l=void 0!==t.waterNormals?t.waterNormals:null,c=void 0!==t.sunDirection?t.sunDirection:new THREE.Vector3(.70707,.70707,0),d=new THREE.Color(void 0!==t.sunColor?t.sunColor:16777215),u=new THREE.Color(void 0!==t.waterColor?t.waterColor:8355711),h=void 0!==t.eye?t.eye:new THREE.Vector3(0,0,0),p=void 0!==t.distortionScale?t.distortionScale:20,m=void 0!==t.side?t.side:THREE.FrontSide,f=void 0!==t.fog&&t.fog,g=new THREE.Plane,v=new THREE.Vector3,b=new THREE.Vector3,y=new THREE.Vector3,E=new THREE.Matrix4,w=new THREE.Vector3(0,0,-1),_=new THREE.Vector4,S=new THREE.Vector3,x=new THREE.Vector3,A=new THREE.Vector4,M=new THREE.Matrix4,k=new THREE.PerspectiveCamera,O={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},C=new THREE.WebGLRenderTarget(a,i,O);THREE.Math.isPowerOfTwo(a)&&THREE.Math.isPowerOfTwo(i)||(C.texture.generateMipmaps=!1);const P={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new THREE.Matrix4},sunColor:{value:new THREE.Color(8355711)},sunDirection:{value:new THREE.Vector3(.70707,.70707,0)},eye:{value:new THREE.Vector3},waterColor:{value:new THREE.Color(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",THREE.ShaderChunk.fog_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.fog_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",THREE.ShaderChunk.common,THREE.ShaderChunk.packing,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_pars_begin,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.z + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",THREE.ShaderChunk.tonemapping_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},R=new THREE.ShaderMaterial({fragmentShader:P.fragmentShader,vertexShader:P.vertexShader,uniforms:THREE.UniformsUtils.clone(P.uniforms),transparent:!0,lights:!0,side:m,fog:f});R.uniforms.mirrorSampler.value=C.texture,R.uniforms.textureMatrix.value=M,R.uniforms.alpha.value=o,R.uniforms.time.value=s,R.uniforms.normalSampler.value=l,R.uniforms.sunColor.value=d,R.uniforms.waterColor.value=u,R.uniforms.sunDirection.value=c,R.uniforms.distortionScale.value=p,R.uniforms.eye.value=h,n.material=R,n.mirrorCamera=k,n.onBeforeRender=function(e,t,a){if(b.setFromMatrixPosition(n.matrixWorld),y.setFromMatrixPosition(a.matrixWorld),E.extractRotation(n.matrixWorld),v.set(0,0,1),v.applyMatrix4(E),S.subVectors(b,y),S.dot(v)>0)return;S.reflect(v).negate(),S.add(b),E.extractRotation(a.matrixWorld),w.set(0,0,-1),w.applyMatrix4(E),w.add(y),x.subVectors(b,w),x.reflect(v).negate(),x.add(b),k.position.copy(S),k.up.set(0,1,0),k.up.applyMatrix4(E),k.up.reflect(v),k.lookAt(x),k.far=a.far,k.matrixNeedsUpdate=!0,k.updateMatrixWorld(),k.projectionMatrix.copy(a.projectionMatrix),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(k.projectionMatrix),M.multiply(k.matrixWorldInverse),g.setFromNormalAndCoplanarPoint(v,b),g.applyMatrix4(k.matrixWorldInverse),_.set(g.normal.x,g.normal.y,g.normal.z,g.constant);const i=k.projectionMatrix;A.x=(Math.sign(_.x)+i.elements[8])/i.elements[0],A.y=(Math.sign(_.y)+i.elements[9])/i.elements[5],A.z=-1,A.w=(1+i.elements[10])/i.elements[14],_.multiplyScalar(2/_.dot(A)),i.elements[2]=_.x,i.elements[6]=_.y,i.elements[10]=_.z+1-r,i.elements[14]=_.w,h.setFromMatrixPosition(a.matrixWorld);const o=e.getRenderTarget(),s=e.xr.enabled,l=e.shadowMap.autoUpdate;n.visible=!1,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(C),e.render(t,k),e.setRenderTarget(null),n.visible=!0,e.xr.enabled=s,e.shadowMap.autoUpdate=l,e.setRenderTarget(o)}},THREE.Water.prototype=Object.create(THREE.Mesh.prototype),THREE.Water.prototype.constructor=THREE.Water},535:function(e,t){const n=new THREE.Vector3,a=new THREE.Vector3,i=new THREE.Vector3;AFRAME.registerComponent("trigger-volume",{schema:{colliders:{type:"selectorAll"},size:{type:"vec3",default:{x:1,y:1,z:1}},target:{type:"selector"},enterComponent:{type:"string"},enterProperty:{type:"string"},enterValue:{default:"",parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify},leaveComponent:{type:"string"},leaveProperty:{type:"string"},leaveValue:{default:"",parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.boundingBox=new THREE.Box3,this.collidingLastFrame={}},update(){this.el.object3D.getWorldPosition(a),n.copy(this.data.size),this.boundingBox.setFromCenterAndSize(a,n)},tick(){if(!this.data.target)return;const e=this.data.colliders;for(let t=0;t<e.length;t++){const n=e[t].object3D;n.getWorldPosition(i);const a=this.boundingBox.containsPoint(i),r=this.collidingLastFrame[n.id];a&&!r?this.data.target.setAttribute(this.data.enterComponent,this.data.enterProperty,this.data.enterValue):!a&&r&&this.data.target.setAttribute(this.data.leaveComponent,this.data.leaveProperty,this.data.leaveValue),this.collidingLastFrame[n.id]=a}}})},536:function(e,t){AFRAME.registerComponent("video-pause-state",{schema:{paused:{default:!1}},init(){this.onPauseStateChange=this.onPauseStateChange.bind(this),this.videoComponent=this.el.components["media-video"],this.videoComponent?this.onVideoLoaded():(this.onVideoLoaded=this.onVideoLoaded.bind(this),this.el.addEventListener("video-loaded",this.onVideoLoaded))},onVideoLoaded(){this.videoComponent=this.el.components["media-video"],this.video=this.videoComponent.video,this.video.addEventListener("pause",this.onPauseStateChange)},onPauseStateChange(){this.el.setAttribute("paused",this.video.paused)},update(){this.video&&this.data.paused!==this.video.paused&&this.videoComponent.togglePlaying()},remove(){this.video&&this.video.removeEventListener("pause",this.onPauseStateChange),this.el.removeEventListener("video-loaded",this.onVideoLoaded)}})},537:function(e,t){const n=new THREE.MeshBasicMaterial({color:302836,transparent:!0,opacity:.25,side:THREE.DoubleSide});AFRAME.registerComponent("audio-zone",{schema:{enabled:{default:!0},inOut:{default:!0},outIn:{default:!0},debuggable:{default:!0}},init(){var e,t;const a=new THREE.BoxGeometry;this.debugMesh=new THREE.Mesh(a,n),this.debugMesh.el=this.el.object3D.el;const i=new THREE.BoxHelper(this.debugMesh,302836);this.el.object3D.add(i),this.el.object3D.updateMatrixWorld(!0),null===(e=this.el.sceneEl.systems["audio-debug"])||void 0===e||e.registerZone(this),null===(t=this.el.sceneEl.systems["hubs-systems"])||void 0===t||t.audioZonesSystem.registerZone(this),this.enableDebug(window.APP.store.state.preferences.showAudioDebugPanel)},remove(){var e,t;null===(e=this.el.sceneEl.systems["audio-debug"])||void 0===e||e.unregisterZone(this),null===(t=this.el.sceneEl.systems["hubs-systems"])||void 0===t||t.audioZonesSystem.unregisterZone(this)},update(){this.enableDebug(this.data.debuggable&&window.APP.store.state.preferences.showAudioDebugPanel)},isEnabled(){return this.data.enabled},getBoundingBox:function(){const e=new THREE.Box3;return function(){return e.copy(this.debugMesh.geometry.boundingBox).applyMatrix4(this.el.object3D.matrixWorld)}}(),enableDebug(e){this.data.debuggable=e,this.el.object3D.visible=e},getAudioParams(){return APP.audioOverrides.get(this.el)},contains(e){return this.getBoundingBox().containsPoint(e)}})},538:function(e,t){AFRAME.registerComponent("frustrum",{schema:{culled:{type:"boolean",default:!0}},update:function(){this.updateDescendants(this.data.culled)},remove:function(){this.updateDescendants(!0)},updateDescendants:function(e){this.el.object3D.traverse((function(t){t instanceof THREE.Mesh&&(t.frustumCulled=e)}))}})},539:function(e,t){AFRAME.registerComponent("inject-main-camera-here",{init(){this.el.setObject3D("camera",this.el.sceneEl.camera)}})},540:function(e,t){AFRAME.registerComponent("log-events",{init:function(){const e=this.el,t=this.log.bind(this),n=this.el.dispatchEvent;this.el.dispatchEvent=function(){return t(Array.from(arguments)),n.apply(e,arguments)}},log:function([e]){if(["componentchanged"].includes(e.type))return;let t=!0;console.info("log-events: ".concat(this.el.id," ").concat(e.type," ").concat(JSON.stringify(e.detail,(e,n)=>n&&"object"==typeof n&&void 0===n.length?t?(t=!1,n):"[object]":n)))}}),AFRAME.registerComponent("lifecycle-checker",{schema:{name:{type:"string"},tick:{default:!1}},init:function(){this.log("init")},update:function(){this.log("update")},tick:function(){this.data.tick&&this.log("tick")},remove:function(){this.log("remove")},pause:function(){this.log("pause")},play:function(){this.log("play")},log:function(e){console.info("lifecycle-checker:".concat(this.data.name," ").concat(e))}})},56:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);function i(){return a.a.feature("show_cloud")}},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(5),l=n.n(s),c=n(200),d=n.n(c),u=n(45),h=n.n(u);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const f=Object(a.memo)(Object(a.forwardRef)((e,t)=>{let{className:n,as:a,compactSm:r,lg:o,children:s}=e,c=m(e,["className","as","compactSm","lg","children"]);const u="button"===a?{type:"button"}:{};return i.a.createElement(a,p({className:l()(d.a.iconButton,h.a.iconButton,{[d.a.compactSm]:r,[d.a.lg]:o},n)},u,c,{ref:t}),s)}));f.propTypes={compactSm:o.a.bool,lg:o.a.bool,className:o.a.string,children:o.a.node},f.defaultProps={as:"button"}},587:function(e,t,n){"use strict";var a=n(12);const{Pathfinding:i}=n(588);AFRAME.registerSystem("nav",{init:function(){this.pathfinder=new i,this.mesh=null,this.el.addEventListener("reset_scene",this.removeNavMeshData.bind(this)),this.el.addEventListener("leaving_loading_environment",this.removeNavMeshData.bind(this))},loadMesh:function(e,t){this.mesh&&(console.error("tried to load multiple nav meshes"),this.removeNavMeshData());const n=e.geometry.clone();e.updateMatrices(),n.applyMatrix4(e.matrixWorld),this.pathfinder.setZoneData(t,i.createZone(n)),this.mesh=e;const r=document.querySelectorAll("[teleporter]");for(let e=0;e<r.length;e++)r[e].components.teleporter.queryCollisionEntities();this.el.sceneEl.emit("nav-mesh-loaded"),Object(a.a)("debugNavmesh")&&(this.helperMesh=new THREE.Mesh(n,new THREE.MeshBasicMaterial({wireframe:!0})),this.el.sceneEl.object3D.add(this.helperMesh))},removeNavMeshData(){var e,t;(this.mesh&&this.mesh.geometry&&this.mesh.geometry.dispose&&this.mesh._hubs_audio_debug_prev_material&&(this.mesh.material=this.mesh._hubs_audio_debug_prev_material,this.mesh._hubs_audio_debug_prev_material=null),this.helperMesh)&&(null===(e=this.helperMesh.material)||void 0===e||e.dispose(),null===(t=this.helperMesh.geometry)||void 0===t||t.dispose(),this.helperMesh.removeFromParent(),this.helperMesh=null);this.mesh=null,this.pathfinder.zones={}}})},589:function(e,t){AFRAME.registerComponent("event-repeater",{schema:{eventSource:{type:"selector"},events:{type:"array"}},play:function(){this.data.eventListeners=[];const e=this.data.events;for(let t=0;t<e.length;t++){const n=e[t];this.data.eventListeners[n]=this._handleEvent.bind(this,n),this.data.eventSource.addEventListener(n,this.data.eventListeners[n])}},pause:function(){const e=this.data.events;for(let t=0;t<e.length;t++){const n=e[t];this.data.eventSource.removeEventListener(n,this.data.eventListeners[n])}this.data.eventListeners=[]},_handleEvent:function(e,t){this.el.emit(e,t.detail)}})},59:function(e,t,n){e.exports=n.p+"assets/models/DefaultAvatar-798e20921f79aae310651e2fcb6f6ebb.glb"},594:function(e,t,n){"use strict";n(522),n(523),n(314);var a=n(103),i=n(13),r=n(267),o=n(158),s=n(7);function l(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){l(r,a,i,o,s,"next",e)}function s(e){l(r,a,i,o,s,"throw",e)}o(void 0)}))}}function d(e){const t=((e,t)=>{e.getByteTimeDomainData(t);let n=0;for(let e=0;e<t.length;e++){const a=(t[e]-128)/128;n+=a*a}return Math.sqrt(n/t.length)})(e.analyser,e.levels),n=Math.log(THREE.Math.mapLinear(t,0,1,1,Math.E));e.volume=n<.08?0:n;const a=e.volume>e.prevVolume?.35:.3;e.volume=a*e.volume+(1-a)*e.prevVolume,e.prevVolume=e.volume}function u(e){const t=Object(a.a)(e,"ik-root");if(t&&"avatar-rig"===t.id)return e.sceneEl.systems["local-audio-analyser"];{const t=Object(a.a)(e,"networked-audio-analyser");return t?t.components["networked-audio-analyser"]:null}}AFRAME.registerComponent("networked-audio-analyser",{init(){var e=this;return c((function*(){e.volume=0,e.prevVolume=0,e.disableUpdates=!0,e.avatarIsTalking=!1,e._updateAnalysis=e._updateAnalysis.bind(e),e._runScheduledWork=e._runScheduledWork.bind(e),e.el.sceneEl.systems["frame-scheduler"].schedule(e._runScheduledWork,"audio-analyser"),e.el.addEventListener("sound-source-set",t=>{const n=THREE.AudioContext.getContext();e.analyser=n.createAnalyser(),e.analyser.fftSize=32,e.levels=new Uint8Array(e.analyser.fftSize),t.detail.soundSource.connect(e.analyser)},{once:!0}),e.playerSessionId=Object(a.a)(e.el,"player-info").components["player-info"].playerSessionId,Object(o.d)(e,"networked-audio-analyser")}))()},remove:function(){Object(o.a)(this,"networked-audio-analyser"),this.el.sceneEl.systems["frame-scheduler"].unschedule(this._runScheduledWork,"audio-analyser")},tick:function(e){this.disableUpdates||this._updateAnalysis(e)},_runScheduledWork:function(){this.disableUpdates&&this._updateAnalysis()},_updateAnalysis:function(e){this.analyser&&(d(this),this.volume<1e-5?(e&&this.lastSeenVolume&&this.lastSeenVolume<e-1e4&&(this.disableUpdates=!0),e&&this.lastSeenVolume&&this.lastSeenVolume<e-1e3&&(this.avatarIsTalking=!1)):(e&&(this.lastSeenVolume=e),this.disableUpdates=!1,this.avatarIsTalking=!0))}}),AFRAME.registerSystem("local-audio-analyser",{init(){this.volume=0,this.prevVolume=0,this.onMicEnabled=this.onMicEnabled.bind(this),this.el.addEventListener(s.b.MIC_SHARE_STARTED,this.onMicEnabled)},remove(){this.el.removeEventListener(s.b.MIC_SHARE_STARTED,this.onMicEnabled)},onMicEnabled(){const e=this.el.sceneEl.systems["hubs-systems"].audioSystem;this.analyser=e.outboundAnalyser,this.levels=e.analyserLevels},tick:function(){this.analyser&&(APP.dialog.isMicEnabled?d(this):(this.prevVolume=this.volume,this.volume=0))}}),AFRAME.registerComponent("scale-audio-feedback",{schema:{minScale:{default:1},maxScale:{default:1.5}},init(){var e=this;return c((function*(){yield Object(i.b)(),e.cameraEl=document.getElementById("viewing-camera")}))()},tick(){var e;this.cameraEl&&(this.analyser||(this.analyser=u(this.el)),this.el.object3D.scale.setScalar(THREE.Math.mapLinear((null===(e=this.analyser)||void 0===e?void 0:e.volume)||0,0,1,this.data.minScale,this.data.maxScale)),this.el.object3D.matrixNeedsUpdate=!0)}}),AFRAME.registerComponent("morph-audio-feedback",{schema:{name:{default:""},minValue:{default:0},maxValue:{default:2}},init(){const e=[];this.el.object3DMap.skinnedmesh?e.push(this.el.object3DMap.skinnedmesh):this.el.object3DMap.group&&this.el.object3DMap.group.traverse(t=>t.isSkinnedMesh&&e.push(t)),e.length&&(this.morphs=e.map(e=>({mesh:e,morphNumber:e.morphTargetDictionary[this.data.name]})).filter(e=>void 0!==e.morphNumber))},tick(){if(!this.morphs||!this.morphs.length)return;this.analyser||(this.analyser=u(this.el));const{minValue:e,maxValue:t}=this.data,n=THREE.Math.mapLinear(Object(r.a)(this.analyser?this.analyser.volume:0),0,1,e,t);for(let e=0;e<this.morphs.length;e++)this.morphs[e].mesh.morphTargetInfluences[this.morphs[e].morphNumber]=n}});const h={MIC:["mic-0.png","mic-1.png","mic-2.png","mic-3.png","mic-4.png","mic-5.png","mic-6.png","mic-7.png"],MIC_HOVER:["mic-0_hover.png","mic-1_hover.png","mic-2_hover.png","mic-3_hover.png","mic-4_hover.png","mic-5_hover.png","mic-6_hover.png","mic-7_hover.png"],MIC_OFF:["mic-off-0.png","mic-off-1.png","mic-off-2.png","mic-off-3.png","mic-off-4.png","mic-off-5.png","mic-off-6.png","mic-off-7.png"],MIC_OFF_HOVER:["mic-off-0_hover.png","mic-off-1_hover.png","mic-off-2_hover.png","mic-off-3_hover.png","mic-off-4_hover.png","mic-off-5_hover.png","mic-off-6_hover.png","mic-off-7_hover.png"]};AFRAME.registerComponent("mic-button",{schema:{active:{type:"boolean"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init(){this.prevSpriteName="",this.el.object3D.matrixNeedsUpdate=!0,this.hovering=!1,this.onHover=()=>{this.hovering=!0,this.data.tooltip.setAttribute("visible",!0)},this.onHoverOut=()=>{this.hovering=!1,this.data.tooltip.setAttribute("visible",!1)}},play(){this.el.object3D.addEventListener("hovered",this.onHover),this.el.object3D.addEventListener("unhovered",this.onHoverOut)},pause(){this.el.object3D.removeEventListener("hovered",this.onHover),this.el.object3D.removeEventListener("unhovered",this.onHoverOut)},update(){this.data.tooltip&&(this.textEl=this.data.tooltip.querySelector("[text]"))},tick(){const e=this.el.sceneEl.systems["local-audio-analyser"],t=this.data.active,n=this.hovering;var a;const i=h[t?n?"MIC_HOVER":"MIC":n?"MIC_OFF_HOVER":"MIC_OFF"][(a=e.volume,THREE.Math.clamp(Math.ceil(THREE.Math.mapLinear(a-.05,0,1,0,7)),0,7))];i!==this.prevSpriteName&&(this.prevSpriteName=i,this.el.setAttribute("sprite","name",i)),this.data.tooltip&&n&&(this.textEl=this.textEl||this.data.tooltip.querySelector("[text]"),this.textEl.setAttribute("text","value",t?this.data.activeTooltipText:this.data.tooltipText))}});n(524);var p=n(17),m=n(392),f=n.n(m),g=n(393),v=n.n(g),b=n(394),y=n.n(b),E=n(395),w=n.n(E);const _={"action-button":{tex:p.o.load(f.a),width:128,height:128},button:{tex:p.o.load(v.a),width:128,height:128},nametag:{tex:p.o.load(y.a),width:128,height:128},"nametag-border":{tex:p.o.load(w.a),width:128,height:128}};AFRAME.registerComponent("slice9",{schema:{alphaTest:{default:0},bottom:{default:0,min:0},color:{type:"color",default:"#fff"},debug:{default:!1},height:{default:1,min:0},left:{default:0,min:0},opacity:{default:1,min:0,max:1},padding:{default:.1,min:.01},right:{default:0,min:0},side:{default:"front",oneOf:["front","back","double"]},src:{oneOf:Object.keys(_)},top:{default:0,min:0},transparent:{default:!0},width:{default:1,min:0},usingCustomMaterial:{default:!1},usingAtlas:{default:!1},uvAtlasMin:{type:"vec2"},uvAtlasMax:{type:"vec2"}},init:function(){const e=this.data;this.textureSrc=null;const t=this.geometry=new THREE.PlaneBufferGeometry(e.width,e.height,3,3);if(e.usingCustomMaterial)this.plane=new THREE.Mesh(t);else{const n=new THREE.MeshBasicMaterial({alphaTest:e.alphaTest,color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.debug});this.plane=new THREE.Mesh(t,n)}this.el.setObject3D("mesh",this.plane)},regenerateMesh:function(){const e=this.data;let t;const n=this.geometry.attributes.position.array,a=this.geometry.attributes.uv.array;let i;if(this.plane.material&&!this.plane.material.map)return;function r(e,t,a){n[3*e]=t,n[3*e+1]=a}function o(t,n,i){e.usingAtlas&&(n=e.uvAtlasMin.x+n*(e.uvAtlasMax.x-e.uvAtlasMin.x),i=e.uvAtlasMin.y+i*(e.uvAtlasMax.y-e.uvAtlasMin.y)),a[2*t]=n,a[2*t+1]=i}e.usingCustomMaterial?(t=1,i=1):(t=_[e.src].height,i=_[e.src].width);const s={left:e.left/i,right:e.right/i,top:e.top/t,bottom:e.bottom/t};o(1,s.left,1),o(2,s.right,1),o(4,0,s.bottom),o(5,s.left,s.bottom),o(6,s.right,s.bottom),o(7,1,s.bottom),o(8,0,s.top),o(9,s.left,s.top),o(10,s.right,s.top),o(11,1,s.top),o(13,s.left,0),o(14,s.right,0),e.usingAtlas&&(o(0,0,1),o(3,1,1),o(12,0,0),o(15,1,0));const l=e.width/2,c=e.height/2,d=-l+e.padding,u=l-e.padding,h=c-e.padding,p=-c+e.padding;r(0,-l,c),r(1,d,c),r(2,u,c),r(3,l,c),r(4,-l,h),r(5,d,h),r(6,u,h),r(7,l,h),r(8,-l,p),r(9,d,p),r(10,u,p),r(11,l,p),r(13,d,-c),r(14,u,-c),r(12,-l,-c),r(15,l,-c),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0},update:function(e){const t=this.data,n=AFRAME.utils.diff(t,e);t.usingCustomMaterial||(this.plane.material.alphaTest=t.alphaTest,this.plane.material.color.setStyle(t.color),this.plane.material.opacity=t.opacity,this.plane.material.transparent=t.transparent,this.plane.material.wireframe=t.debug,this.plane.material.side=function(e){switch(e){case"back":return THREE.BackSide;case"double":return THREE.DoubleSide;default:return THREE.FrontSide}}(t.side),this.plane.material.needsUpdate=!0,"src"in n&&this.updateMap()),("width"in n||"height"in n||"padding"in n||"left"in n||"top"in n||"bottom"in n||"right"in n)&&this.regenerateMesh()},setMap(e){this.plane.material.map=e,this.plane.material.needsUpdate=!0,this.regenerateMesh()},updateMap:function(){const e=this.data.src;if(e){if(e===this.textureSrc)return;return this.textureSrc=e,void this.setMap(_[e].tex)}this.plane.material.map&&this.setMap(null)}});n(525),n(526),n(527);var S=n(171),x=(n(528),n(529),n(530),n(24));AFRAME.registerComponent("loop-animation",{schema:{paused:{type:"boolean",default:!1},clip:{type:"string",default:""},activeClipIndex:{type:"int",default:0},activeClipIndices:{type:"array"}},init(){this.mixerEl=Object(a.a)(this.el,"animation-mixer"),this.currentActions=[],this.mixerEl||console.warn("loop-animation component could not find an animation-mixer in its ancestors.")},update(e){if(this.mixerEl&&(e.clip===this.data.clip&&e.activeClipIndex===this.data.activeClipIndex||this.updateClip(),e.paused!==this.data.paused))for(let e=0;e<this.currentActions.length;e++)this.currentActions[e].paused=this.data.paused},updateClip(){const{mixer:e,animations:t}=this.mixerEl.components["animation-mixer"],{clip:n,activeClipIndex:a}=this.data,{activeClipIndices:i}=this.data;if(0===t.length)return;let r=[];if(i&&i.length>0)r=i.map(e=>t[e]);else if(""!==n){const e=n.split(",");for(let n=0;n<e.length;n++){const a=e[n],i=t.find(({name:e})=>e===a);i?r.push(i):console.warn("Could not find animation named '".concat(a,"' in ").concat(this.el.className))}}else r=[t[a]];if(r&&r.length){this.currentActions.length=0;for(let t=0;t<r.length;t++){const n=e.clipAction(r[t],this.el.object3D);n.enabled=!0,n.setLoop(THREE.LoopRepeat,1/0).play(),this.currentActions.push(n)}}},destroy(){for(let e=0;e<this.currentActions.length;e++)this.currentActions[e].enabled=!1,this.currentActions[e].stop();this.currentActions.length=0}});n(390);var A=n(116),M=n(19),k=n(320),O=n(12),C=n(396),P=n.n(C),R=n(25),T=n(11),j=n(27);function D(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){D(r,a,i,o,s,"next",e)}function s(e){D(r,a,i,o,s,"throw",e)}o(void 0)}))}}let L;Object(i.b)().then(()=>{Object(S.b)(P.a).then(e=>{L=e})});const H=Object(O.a)("batchMeshes"),N=Object(O.a)("batchImages"),F=Object(O.a)("disableBatching");AFRAME.registerComponent("media-loader",{schema:{playSoundEffect:{default:!0},fileId:{type:"string"},fileIsOwned:{type:"boolean"},src:{type:"string"},version:{type:"number",default:1},fitToBox:{default:!1},moveTheParentNotTheMesh:{default:!1},resolve:{default:!1},contentType:{default:null},contentSubtype:{default:null},animate:{default:!0},linkedEl:{default:null},mediaOptions:{default:{},parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.onError=this.onError.bind(this),this.showLoader=this.showLoader.bind(this),this.clearLoadingTimeout=this.clearLoadingTimeout.bind(this),this.onMediaLoaded=this.onMediaLoaded.bind(this),this.handleLinkedElRemoved=this.handleLinkedElRemoved.bind(this),this.refresh=this.refresh.bind(this),this.animating=!1;try{NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e}).catch(()=>{})}catch(e){}},updateScale:function(){const e=new THREE.Vector3,t=new THREE.Matrix4,n=new THREE.Matrix4,a=new THREE.Vector3,i=new THREE.Quaternion,r=new THREE.Vector3,o=new THREE.Box3;return function(s,l){this.el.object3D.updateMatrices();const c=this.el.getObject3D("mesh");if(c.updateMatrices(),l)s&&console.warn("Unexpected combination of inputs. Can fit the mesh to a box OR move the parent to the mesh, but did not expect to do both.",this.el),t.copy(c.matrixWorld),Object(A.b)(c,o),e.addVectors(o.min,o.max).multiplyScalar(.5),this.el.object3D.matrixWorld.decompose(a,i,r),n.compose(e,i,r),Object(T.n)(this.el.object3D,n),c.updateMatrices(),Object(T.n)(c,t);else{const t=Object(A.c)(this.el,c),n=s?Object(A.d)(.5,t):1,{min:a,max:i}=t;e.addVectors(a,i).multiplyScalar(.5*n),c.scale.multiplyScalar(n),c.position.sub(e),c.matrixNeedsUpdate=!0}}}(),removeShape(e){this.el.getAttribute("shape-helper__"+e)&&this.el.removeAttribute("shape-helper__"+e)},tick(e,t){this.loaderMixer&&this.loaderMixer.update(t/1e3)},handleLinkedElRemoved(e){"media-loader"===e.detail.name&&(this.data.linkedEl.removeEventListener("componentremoved",this.handleLinkedElRemoved),Object(p.f)())},remove(){this.data.linkedEl&&this.data.linkedEl.removeEventListener("componentremoved",this.handleLinkedElRemoved);const e=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem;this.loadingSoundEffect&&(e.stopPositionalAudio(this.loadingSoundEffect),this.loadingSoundEffect=null),this.loadedSoundEffect&&(e.stopPositionalAudio(this.loadedSoundEffect),this.loadedSoundEffect=null)},onError(){this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-pager"),this.el.removeAttribute("media-video"),this.el.removeAttribute("audio-zone-source"),this.el.removeAttribute("media-pdf"),this.el.setAttribute("media-image",{src:"error"}),this.clearLoadingTimeout()},showLoader(){if(this.el.object3DMap.mesh)return void this.clearLoadingTimeout();const e=!!L,t=e?Object(T.e)(L.scene):new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial);this.el.setObject3D("mesh",t),this.updateScale(!0,!1),e&&(this.loaderMixer=new THREE.AnimationMixer(t),this.loadingClip=this.loaderMixer.clipAction(t.animations[0]),this.loadingScaleClip=this.loaderMixer.clipAction(new THREE.AnimationClip(null,1e3,[new THREE.VectorKeyframeTrack(".scale",[0,.2],[0,0,0,t.scale.x,t.scale.y,t.scale.z])])),setTimeout(()=>{this.loaderMixer&&this.el.setAttribute("shape-helper__loader",{type:j.SHAPE.BOX})},200),this.loadingClip.play(),this.loadingScaleClip.play()),this.el.sceneEl.is("entered")&&(!this.networkedEl||NAF.utils.isMine(this.networkedEl))&&this.data.playSoundEffect&&(this.loadingSoundEffect=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(R.h,this.el.object3D,!0)),delete this.showLoaderTimeout},clearLoadingTimeout(){clearTimeout(this.showLoaderTimeout),this.loadingSoundEffect&&(this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect),this.loadingSoundEffect=null),this.loaderMixer&&(this.loadingClip.stop(),this.loadingScaleClip.stop(),delete this.loaderMixer,delete this.loadingScaleClip,delete this.loadingClip),delete this.showLoaderTimeout,this.removeShape("loader")},updateHoverableVisuals:function(){const e=new THREE.Box3,t=new THREE.Sphere;return function(){const n=this.el.components["hoverable-visuals"];n&&(this.injectedCustomShaderChunks||(this.injectedCustomShaderChunks=!0,n.uniforms=Object(p.m)(this.el.object3D)),e.setFromObject(this.el.object3DMap.mesh),e.getBoundingSphere(t),n.geometryRadius=t.radius/this.el.object3D.scale.y)}}(),onMediaLoaded(e=null,t){const n=this.el;this.clearLoadingTimeout(),this.el.sceneEl.is("entered")&&this.data.playSoundEffect&&(this.loadedSoundEffect=this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playPositionalSoundFollowing(R.g,this.el.object3D,!1));const a=()=>{this.animating=!1,e&&n.setAttribute("shape-helper",{type:e,minHalfExtent:.04}),this.updateHoverableVisuals(),this.data.linkedEl&&(this.el.sceneEl.systems["linked-media"].registerLinkage(this.data.linkedEl,this.el),this.data.linkedEl.addEventListener("componentremoved",this.handleLinkedElRemoved)),n.emit("media-loaded")};if(this.data.animate){if(!this.animating){this.animating=!0,t&&this.updateScale(this.data.fitToBox,this.data.moveTheParentNotTheMesh);const e=this.el.getObject3D("mesh"),n={x:.001,y:.001,z:.001};n.x=e.scale.x<n.x?.001*e.scale.x:n.x,n.y=e.scale.y<n.y?.001*e.scale.x:n.y,n.z=e.scale.z<n.z?.001*e.scale.x:n.z,Object(p.d)(e,n,a)}}else t&&this.updateScale(this.data.fitToBox,this.data.moveTheParentNotTheMesh),a()},refresh(){(!this.networkedEl||NAF.utils.isMine(this.networkedEl)||NAF.utils.takeOwnership(this.networkedEl))&&this.el.setAttribute("media-loader",{version:Math.floor(Date.now()/1e3)})},update(e,t){var n=this;return I((function*(){const{version:a,contentSubtype:i}=n.data;let r=n.data.src;if(!r)return;const o=e.src!==r;!(!e.version||e.version===a)&&(n.el.emit("media_refreshing"),n.data.animate=!1,n.data.playSoundEffect=NAF.utils.isMine(n.networkedEl)),t&&(n.el.removeAttribute("gltf-model-plus"),n.el.removeAttribute("media-pager"),n.el.removeAttribute("media-video"),n.el.removeAttribute("audio-zone-source"),n.el.removeAttribute("media-pdf"),n.el.removeAttribute("media-image"));try{!t&&!o||n.showLoaderTimeout||(n.showLoaderTimeout=setTimeout(n.showLoader,100)),"#"===r.charAt(0)&&(r=n.data.src="".concat(window.location.origin).concat(window.location.pathname).concat(window.location.search).concat(r));let e,l=r,c=null,d=r,u=n.data.contentType;const h=new URL(r),m=Object(M.i)(h.hostname)&&(Object(M.c)(r)||"").startsWith("model/gltf");if(n.data.resolve&&!r.startsWith("data:")&&!r.startsWith("hubs:")&&!m){const i=!(!n.data.mediaOptions.projection||!n.data.mediaOptions.projection.startsWith("360")),o=Object(p.j)(i),s=yield Object(p.n)(r,o,a,t);l=s.origin,l.startsWith("//")&&(l=location.protocol+l),c=s.origin_audio,c&&c.startsWith("//")&&(c=location.protocol+c),u=s.meta&&s.meta.expected_content_type||u,e=s.meta&&s.meta.thumbnail&&Object(M.j)(s.meta.thumbnail)}if(d=Object(M.j)(l),u=u||Object(M.c)(l)||(yield(s=d,fetch(s,{method:"HEAD"}).then(e=>e.headers.get("content-type")))),"application/octet-stream"===u&&(u=Object(M.c)(l)||u),"audio/x-mpegurl"!==u&&"audio/mpegurl"!==u||(u="application/vnd.apple.mpegurl"),t||o?n.el.emit("media_resolved",{src:r,raw:d,contentType:u}):n.el.emit("media_refreshed",{src:r,raw:d,contentType:u}),u.startsWith("video/")||u.startsWith("audio/")||u.startsWith("application/dash")||AFRAME.utils.material.isHLS(l,u)){let e,t,a;if(n.data.linkedEl){const i=n.data.linkedEl.components["media-video"];e=i.videoTexture,t=i.audioSource,a=i.mediaElementAudioSource}const i=parseInt(h.searchParams.get("t")),r=parseInt(new URLSearchParams(h.hash.substring(1)).get("t"))||i||0;n.el.removeAttribute("gltf-model-plus"),n.el.removeAttribute("media-image"),n.el.removeAttribute("media-pdf"),n.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1}),n.el.addEventListener("video-loaded",e=>{n.onMediaLoaded("flat"===e.detail.projection?j.SHAPE.BOX:null)},{once:!0}),n.el.setAttribute("media-video",Object.assign({},n.data.mediaOptions,{src:d,audioSrc:c?Object(M.j)(c):null,time:r,contentType:u,linkedVideoTexture:e,linkedAudioSource:t,linkedMediaElementAudioSource:a})),n.el.setAttribute("audio-zone-source",{}),n.el.components["position-at-border__freeze"]&&n.el.setAttribute("position-at-border__freeze",{isFlat:!0}),n.el.components["position-at-border__freeze-unprivileged"]&&n.el.setAttribute("position-at-border__freeze-unprivileged",{isFlat:!0})}else if(u.startsWith("image/")){n.el.removeAttribute("gltf-model-plus"),n.el.removeAttribute("media-video"),n.el.removeAttribute("audio-zone-source"),n.el.removeAttribute("media-pdf"),n.el.removeAttribute("media-pager"),n.el.addEventListener("image-loaded",e=>{n.onMediaLoaded("flat"===e.detail.projection?j.SHAPE.BOX:null),"photo-camera"===i?n.el.setAttribute("hover-menu__photo",{template:"#photo-hover-menu",isFlat:!0}):n.data.mediaOptions.href&&n.el.setAttribute("hover-menu__link",{template:"#link-hover-menu",isFlat:!0})},{once:!0}),n.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1});let e=!F&&N;n.data.mediaOptions.hasOwnProperty("batch")&&!n.data.mediaOptions.batch&&(e=!1),n.el.setAttribute("media-image",Object.assign({},n.data.mediaOptions,{src:d,version:a,contentType:u,batch:e})),n.el.components["position-at-border__freeze"]&&n.el.setAttribute("position-at-border__freeze",{isFlat:!0}),n.el.components["position-at-border__freeze-unprivileged"]&&n.el.setAttribute("position-at-border__freeze-unprivileged",{isFlat:!0})}else if(u.startsWith("application/pdf"))n.el.removeAttribute("gltf-model-plus"),n.el.removeAttribute("media-video"),n.el.removeAttribute("audio-zone-source"),n.el.removeAttribute("media-image"),n.el.setAttribute("media-pdf",Object.assign({},n.data.mediaOptions,{src:d,contentType:u,batch:!1})),n.el.setAttribute("media-pager",{}),n.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1}),n.el.addEventListener("pdf-loaded",()=>{n.clearLoadingTimeout(),n.onMediaLoaded(j.SHAPE.BOX)},{once:!0}),n.el.components["position-at-border__freeze"]&&n.el.setAttribute("position-at-border__freeze",{isFlat:!0}),n.el.components["position-at-border__freeze-unprivileged"]&&n.el.setAttribute("position-at-border__freeze-unprivileged",{isFlat:!0});else if(u.includes("application/octet-stream")||u.includes("x-zip-compressed")||u.startsWith("model/gltf")){n.el.removeAttribute("media-image"),n.el.removeAttribute("media-video"),n.el.removeAttribute("audio-zone-source"),n.el.removeAttribute("media-pdf"),n.el.removeAttribute("media-pager"),n.el.addEventListener("model-loaded",()=>{n.onMediaLoaded(j.SHAPE.HULL,!0),Object(k.a)(n.el)},{once:!0}),n.el.addEventListener("model-error",n.onError,{once:!0});let e=!F&&H;n.data.mediaOptions.hasOwnProperty("batch")&&!n.data.mediaOptions.batch&&(e=!1),n.data.mediaOptions.hasOwnProperty("applyGravity")&&n.el.setAttribute("floaty-object",{modifyGravityOnRelease:!n.data.mediaOptions.applyGravity}),n.el.setAttribute("gltf-model-plus",Object.assign({},n.data.mediaOptions,{src:d,contentType:u,inflate:!0,batch:e,modelToWorldScale:n.data.fitToBox?1e-4:1}))}else{if(!u.startsWith("text/html"))throw new Error("Unsupported content type: ".concat(u));{n.el.removeAttribute("gltf-model-plus"),n.el.removeAttribute("media-video"),n.el.removeAttribute("audio-zone-source"),n.el.removeAttribute("media-pdf"),n.el.removeAttribute("media-pager"),n.el.addEventListener("image-loaded",I((function*(){const e=n.el.sceneEl.systems.permissions.can("update_hub");(yield Object(M.f)(r))?n.el.setAttribute("hover-menu__hubs-item",{template:"#avatar-link-hover-menu",isFlat:!0}):(yield Object(M.e)(r))||(yield Object(M.g)(r))&&e?n.el.setAttribute("hover-menu__hubs-item",{template:"#hubs-destination-hover-menu",isFlat:!0}):n.el.setAttribute("hover-menu__link",{template:"#link-hover-menu",isFlat:!0}),n.onMediaLoaded(j.SHAPE.BOX)})),{once:!0}),n.el.setAttribute("floaty-object",{reduceAngularFloat:!0,releaseGravity:-1});let t=!F&&N;n.data.mediaOptions.hasOwnProperty("batch")&&!n.data.mediaOptions.batch&&(t=!1),n.el.setAttribute("media-image",Object.assign({},n.data.mediaOptions,{src:e,version:a,contentType:Object(M.c)(e)||"image/png",batch:t})),n.el.components["position-at-border__freeze"]&&n.el.setAttribute("position-at-border__freeze",{isFlat:!0}),n.el.components["position-at-border__freeze-unprivileged"]&&n.el.setAttribute("position-at-border__freeze-unprivileged",{isFlat:!0})}}}catch(e){n.el.components["position-at-border__freeze"]&&n.el.setAttribute("position-at-border__freeze",{isFlat:!0}),n.el.components["position-at-border__freeze-unprivileged"]&&n.el.setAttribute("position-at-border__freeze-unprivileged",{isFlat:!0}),console.error("Error adding media",e),n.onError()}var s}))()}}),AFRAME.registerComponent("media-pager",{schema:{index:{default:0},maxIndex:{default:0}},init(){var e=this;this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this),this.onSnap=this.onSnap.bind(this),this.update=this.update.bind(this),this.el.setAttribute("hover-menu__pager",{template:"#pager-hover-menu",isFlat:!0}),this.el.components["hover-menu__pager"].getHoverMenu().then(e=>{this.el.parentNode&&(this.hoverMenu=e,this.nextButton=this.el.querySelector(".next-button [text-button]"),this.prevButton=this.el.querySelector(".prev-button [text-button]"),this.snapButton=this.el.querySelector(".snap-button [text-button]"),this.pageLabel=this.el.querySelector(".page-label"),this.nextButton.object3D.addEventListener("interact",this.onNext),this.prevButton.object3D.addEventListener("interact",this.onPrev),this.snapButton.object3D.addEventListener("interact",this.onSnap),this.update(),this.el.emit("pager-loaded"))}),NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEl=e,this.networkedEl.addEventListener("pinned",this.update),this.networkedEl.addEventListener("unpinned",this.update),window.APP.hubChannel.addEventListener("permissions_updated",this.update)}).catch(()=>{}),this.el.addEventListener("pdf-loaded",I((function*(){e.update()})))},update(e){var t=this;return I((function*(){if(t.networkedEl&&NAF.utils.isMine(t.networkedEl)&&e&&"number"==typeof e.index&&e.index!==t.data.index&&t.el.emit("owned-pager-page-changed"),t.pageLabel&&t.pageLabel.setAttribute("text","value","".concat(t.data.index+1,"/").concat(t.data.maxIndex+1)),t.prevButton&&t.nextButton){const e=t.el.components["media-loader"].data.linkedEl||t.el,n=e.components.pinnable&&e.components.pinnable.data.pinned;t.prevButton.object3D.visible=t.nextButton.object3D.visible=!n||window.APP.hubChannel.can("pin_objects")}}))()},onNext(){if(this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&!NAF.utils.takeOwnership(this.networkedEl))return;const e=Math.min(this.data.index+1,this.data.maxIndex);this.el.setAttribute("media-pdf","index",e),this.el.setAttribute("media-pager","index",e)},onPrev(){if(this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&!NAF.utils.takeOwnership(this.networkedEl))return;const e=Math.max(this.data.index-1,0);this.el.setAttribute("media-pdf","index",e),this.el.setAttribute("media-pager","index",e)},onSnap(){this.el.emit("pager-snap-clicked")},remove(){this.networkedEl&&(this.networkedEl.removeEventListener("pinned",this.update),this.networkedEl.removeEventListener("unpinned",this.update)),window.APP.hubChannel.removeEventListener("permissions_updated",this.update)}});n(531);AFRAME.registerComponent("quack",{schema:{quackPercentage:{default:1},specialQuackPercentage:{default:.01}},init:function(){this.wasInteracting=!1,NAF.utils.getNetworkedEntity(this.el).then(e=>{this.networkedEntity=e})},tick:function(){const e=AFRAME.scenes[0].systems.interaction.isHeld(this.networkedEntity||this.el);e&&!this.wasInteracting&&this.quack(),this.wasInteracting=e},quack:function(){const e=Math.random();e<this.data.specialQuackPercentage?this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(R.s):e<this.data.quackPercentage&&this.el.sceneEl.systems["hubs-systems"].soundEffectsSystem.playSoundOneShot(R.n)}});var V=n(140);function B(e,t,n){return(1-n)*e+n*t}const U=new THREE.Quaternion;AFRAME.registerComponent("scene-preview-camera",{schema:{duration:{default:90,type:"number"},positionOnly:{default:!1,type:"boolean"}},init:function(){const e=AFRAME.scenes[0].systems["hubs-systems"]||AFRAME.scenes[0].systems["scene-systems"];e&&e.scenePreviewCameraSystem.register(this.el),this.startPoint=this.el.object3D.position.clone(),this.startRotation=this.el.object3D.quaternion.clone(),this.targetPoint=this.el.object3D.position.clone(),this.targetPoint.y=Math.max(this.targetPoint.y-1.5,1),this.targetPoint.add(new THREE.Vector3(2,0,-2));const t=new THREE.Euler(-.15,0,.15);this.targetRotation=new THREE.Quaternion,this.targetRotation.setFromEuler(t),this.targetRotation.premultiply(this.startRotation),this.startTime=performance.now(),this.backwards=!1,this.ranOnePass=!1},tick2:function(){const e=this.el.sceneEl.systems["hubs-systems"];let t;if(e&&(e.cameraSystem.mode=V.c,t=function(){const e=Object(o.b)();return e?e.el.querySelector(".camera").object3D:null}()),t)Object(T.n)(this.el.object3D,t.matrixWorld),this.el.object3D.translateZ(-.1),this.el.object3D.matrixNeedsUpdate=!0;else{let e=(performance.now()-this.startTime)/(1e3*this.data.duration);e=Math.min(1,Math.max(0,e)),this.ranOnePass?e=e<.5?2*e*e:(4-2*e)*e-1:e*=2-e;const t=this.backwards?this.targetPoint:this.startPoint,n=this.backwards?this.startPoint:this.targetPoint,a=this.backwards?this.targetRotation:this.startRotation,i=this.backwards?this.startRotation:this.targetRotation;U.slerpQuaternions(a,i,e),this.el.object3D.position.set(B(t.x,n.x,e),B(t.y,n.y,e),B(t.z,n.z,e)),this.data.positionOnly||this.el.object3D.rotation.setFromQuaternion(U),this.el.object3D.matrixNeedsUpdate=!0,e>=.9999&&(this.ranOnePass=!0,this.backwards=!this.backwards,this.startTime=performance.now())}},remove:function(){var e,t;const n=(null===(e=AFRAME.scenes[0])||void 0===e?void 0:e.systems["hubs-systems"])||(null===(t=AFRAME.scenes[0])||void 0===t?void 0:t.systems["scene-systems"]);n&&n.scenePreviewCameraSystem.unregister(this.el)}}),n(674);const{AmbientLight:z,BackSide:W,BoxBufferGeometry:q,CubeCamera:G,LightProbeGenerator:Y,LinearFilter:K,Mesh:X,Object3D:Q,PMREMGenerator:J,RGBAFormat:Z,Scene:$,ShaderMaterial:ee,sRGBEncoding:te,UniformsLib:ne,UniformsUtils:ae,Vector3:ie,WebGLCubeRenderTarget:re}=THREE;class oe extends Q{constructor(){super();const e=new ee({fragmentShader:oe.shader.fragmentShader,vertexShader:oe.shader.vertexShader,uniforms:ae.clone(oe.shader.uniforms),side:W,fog:!0});this.sky=new X(oe._geometry,e),this.sky.name="Sky",this.add(this.sky),this._inclination=0,this._azimuth=.15,this._distance=8e3,this.updateSunPosition()}get turbidity(){return this.sky.material.uniforms.turbidity.value}set turbidity(e){this.sky.material.uniforms.turbidity.value=e}get rayleigh(){return this.sky.material.uniforms.rayleigh.value}set rayleigh(e){this.sky.material.uniforms.rayleigh.value=e}get luminance(){return this.sky.material.uniforms.luminance.value}set luminance(e){this.sky.material.uniforms.luminance.value=e}get mieCoefficient(){return this.sky.material.uniforms.mieCoefficient.value}set mieCoefficient(e){this.sky.material.uniforms.mieCoefficient.value=e}get mieDirectionalG(){return this.sky.material.uniforms.mieDirectionalG.value}set mieDirectionalG(e){this.sky.material.uniforms.mieDirectionalG.value=e}get inclination(){return this._inclination}set inclination(e){this._inclination=e,this.updateSunPosition()}get azimuth(){return this._azimuth}set azimuth(e){this._azimuth=e,this.updateSunPosition()}get distance(){return this._distance}set distance(e){this._distance=e,this.updateSunPosition()}updateSunPosition(){const e=Math.PI*(this._inclination-.5),t=2*Math.PI*(this._azimuth-.5),n=Math.min(1e3,this._distance),a=n*Math.cos(t),i=n*Math.sin(t)*Math.sin(e),r=n*Math.sin(t)*Math.cos(e);this.sky.material.uniforms.sunPosition.value.set(a,i,r).normalize(),this.sky.scale.set(n,n,n)}generateEnvironmentMap(e){const t=new $,n=new G(1,1e5,new re(512));t.add(n),t.add(this.sky),n.update(e,t),this.add(this.sky);const a=e.xr.enabled;e.xr.enabled=!1;const i=new J(e),r=i.fromCubemap(n.renderTarget.texture).texture;return e.xr.enabled=a,i.dispose(),n.renderTarget.dispose(),r}generateLightProbe(e){const t=new $;t.add(this.sky);const n=new G(1,1e5,new re(512,{format:Z,magFilter:K,minFilter:K,encoding:te}));t.add(n),t.add(this.sky),n.update(e,t),this.add(this.sky);const a=Y.fromCubeRenderTarget(e,n.renderTarget);return n.renderTarget.dispose(),a}copy(e,t=!0){if(t&&this.remove(this.sky),super.copy(e,t),t){const t=e.children.indexOf(e.sky);-1!==t&&(this.sky=this.children[t])}return this.turbidity=e.turbidity,this.rayleigh=e.rayleigh,this.luminance=e.luminance,this.mieCoefficient=e.mieCoefficient,this.mieDirectionalG=e.mieDirectionalG,this.inclination=e.inclination,this.azimuth=e.azimuth,this.distance=e.distance,this}}oe.shader={uniforms:ae.merge([ne.fog,{luminance:{value:1},turbidity:{value:10},rayleigh:{value:2},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new ie}}]),vertexShader:"\n#include <common>\n#include <fog_pars_vertex>\n\nuniform vec3 sunPosition;\nuniform float rayleigh;\nuniform float turbidity;\nuniform float mieCoefficient;\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\nconst float pi = 3.141592653589793238462643383279502884197169;\n\n// wavelength of used primaries, according to preetham\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n// mie stuff\n// K coefficient for the primaries\nconst float v = 4.0;\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n// earth shadow hack\n// cutoffAngle = pi / 1.95;\nconst float cutoffAngle = 1.6110731556870734;\nconst float steepness = 1.5;\nconst float EE = 1000.0;\n\nfloat sunIntensity( float zenithAngleCos ) {\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n}\n\nvec3 totalMie( float T ) {\n  float c = ( 0.2 * T ) * 10E-18;\n  return 0.434 * c * MieConst;\n}\n\nvoid main() {\n  #include <begin_vertex>\n\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n  vWorldPosition = worldPosition.xyz;\n\n  #include <project_vertex>\n\n  vSunDirection = normalize( sunPosition );\n\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n  // extinction (absorbtion + out scattering)\n  // rayleigh coefficients\n  vBetaR = totalRayleigh * rayleighCoefficient;\n\n  // mie coefficients\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n  #include <fog_vertex>\n}\n",fragmentShader:"\n#include <common>\n#include <fog_pars_fragment>\n\nvarying vec3 vWorldPosition;\nvarying vec3 vSunDirection;\nvarying float vSunfade;\nvarying vec3 vBetaR;\nvarying vec3 vBetaM;\nvarying float vSunE;\n\nuniform float luminance;\nuniform float mieDirectionalG;\n\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n// constants for atmospheric scattering\nconst float pi = 3.141592653589793238462643383279502884197169;\n\nconst float n = 1.0003; // refractive index of air\nconst float N = 2.545E25; // number of molecules per unit volume for air at\n// 288.15K and 1013mb (sea level -45 celsius)\n\n// optical length at zenith for molecules\nconst float rayleighZenithLength = 8.4E3;\nconst float mieZenithLength = 1.25E3;\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\n// 66 arc seconds -> degrees, and the cosine of that\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n// 3.0 / ( 16.0 * pi )\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n// 1.0 / ( 4.0 * pi )\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\n\nfloat rayleighPhase( float cosTheta ) {\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n}\n\nfloat hgPhase( float cosTheta, float g ) {\n  float g2 = pow( g, 2.0 );\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n}\n\n// Filmic ToneMapping http://filmicgames.com/archives/75\nconst float A = 0.15;\nconst float B = 0.50;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.02;\nconst float F = 0.30;\n\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\n\nvec3 Uncharted2Tonemap( vec3 x ) {\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\n}\n\nvoid main() {\n  // optical length\n  // cutoff angle at 90 to avoid singularity in next formula.\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n  float sR = rayleighZenithLength * inverse;\n  float sM = mieZenithLength * inverse;\n\n  // combined extinction factor\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n  // in scattering\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\n\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n  vec3 betaRTheta = vBetaR * rPhase;\n\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\n  vec3 betaMTheta = vBetaM * mPhase;\n\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n  // nightsky\n  vec3 direction = normalize( vWorldPosition - cameraPos );\n  float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n  float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n  vec3 L0 = vec3( 0.1 ) * Fex;\n\n  // composition + solar disc\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\n  vec3 color = curr * whiteScale;\n\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n  gl_FragColor = vec4( retColor, 1.0 );\n\n  #include <fog_fragment>\n}\n"},oe._geometry=new q(1,1,1),AFRAME.registerComponent("skybox",{schema:{turbidity:{type:"number",default:10},rayleigh:{type:"number",default:2},luminance:{type:"number",default:1},mieCoefficient:{type:"number",default:.005},mieDirectionalG:{type:"number",default:.8},inclination:{type:"number",default:0},azimuth:{type:"number",default:.15},distance:{type:"number",default:8e3}},init(){this.sky=new oe,this.el.setObject3D("mesh",this.sky)},update(e){if(this.data.turbidity!==e.turbidity&&(this.sky.turbidity=this.data.turbidity),this.data.rayleigh!==e.rayleigh&&(this.sky.rayleigh=this.data.rayleigh),this.data.luminance!==e.luminance&&(this.sky.luminance=this.data.luminance),this.data.mieCoefficient!==e.mieCoefficient&&(this.sky.mieCoefficient=this.data.mieCoefficient),this.data.mieDirectionalG!==e.mieDirectionalG&&(this.sky.mieDirectionalG=this.data.mieDirectionalG),this.data.inclination!==e.inclination&&(this.sky.inclination=this.data.inclination,this.el.object3D.matrixNeedsUpdate=!0),this.data.azimuth!==e.azimuth&&(this.sky.azimuth=this.data.azimuth,this.el.object3D.matrixNeedsUpdate=!0),this.data.distance!==e.distance){const e=this.data.distance;this.sky.distance=1===this.el.object3D.scale.x?e:1,this.sky.matrixNeedsUpdate=!0}"medium"===window.APP.store.state.preferences.materialQualitySetting&&(this.el.setObject3D("ambient-light",new z(16777215,.3)),this.el.setObject3D("light-probe",this.sky.generateLightProbe(this.el.sceneEl.renderer)))},remove(){this.el.removeObject3D("mesh")}}),AFRAME.registerComponent("spawn-controller",{schema:{target:{type:"selector"},camera:{type:"selector",default:"#avatar-pov-node"},playerHeight:{default:1.6},loadedEvent:{type:"string"}},init(){this.moveToSpawnPoint=this.moveToSpawnPoint.bind(this),Object(i.b)().then(()=>{this.data.target.addEventListener(this.data.loadedEvent,this.moveToSpawnPoint)})},moveToSpawnPoint(){const e=document.querySelectorAll("[spawn-point]");if(0===e.length)return;const t=this.data.camera,n=e[Math.round((e.length-1)*Math.random())];Object(T.j)(n.object3D,this.el.object3D.position),this.el.object3D.rotation.copy(n.object3D.rotation),this.el.sceneEl.is("vr-mode")?this.el.object3D.rotation.y-=this.data.camera.object3D.rotation.y:(t.object3D.position.set(0,this.data.playerHeight,0),t.object3D.rotation.set(0,0,0),t.object3D.matrixNeedsUpdate=!0),this.el.object3D.rotation.y+=Math.PI,this.el.object3D.matrixNeedsUpdate=!0}}),AFRAME.registerComponent("spawn-point",{init(){this.el.object3D.visible=!1}});n(532),n(533);var se=n(80),le=n(2);function ce(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const de=n(209).COLLISION_LAYERS;AFRAME.registerComponent("super-spawner",{schema:{src:{default:""},resolve:{default:!1},template:{default:""},spawnScale:{type:"vec3",default:{x:NaN,y:NaN,z:NaN}},spawnCooldown:{default:1},spawnEvent:{type:"string"},animateFromCursor:{type:"boolean"},mediaOptions:{default:{},parse:e=>"object"==typeof e?e:JSON.parse(e),stringify:JSON.stringify}},init(){this.cooldownTimeout=null,this.handPosition=new THREE.Vector3,this.onSpawnEvent=this.onSpawnEvent.bind(this),this.sceneEl=this.el.sceneEl,this.tempSpawnHandPosition=new THREE.Vector3,this.handleMediaLoaded=this.handleMediaLoaded.bind(this),this.spawnedMediaScale=null,this.physicsSystem=this.el.sceneEl.systems["hubs-systems"].physicsSystem},play(){this.el.addEventListener("media-loaded",this.handleMediaLoaded),this.data.spawnEvent&&this.el.sceneEl.addEventListener(this.data.spawnEvent,this.onSpawnEvent)},pause(){this.el.removeEventListener("media-loaded",this.handleMediaLoaded),this.data.spawnEvent&&this.el.sceneEl.removeEventListener(this.data.spawnEvent,this.onSpawnEvent),this.cooldownTimeout&&(clearTimeout(this.cooldownTimeout),this.cooldownTimeout=null,this.el.setAttribute("visible",!0),this.el.classList.add("interactable"))},handleMediaLoaded(e){const t=e.target;var n,a;this.spawnedMediaScale=t.object3D.scale.clone(),n=this.spawnedMediaScale,a=this.data.spawnScale,n.set(null===a.x?n.x:a.x,null===a.y?n.y:a.y,null===a.z?n.z:a.z);const i=t.components["media-image"]||t.components["media-video"]||t.components["media-pdf"]?1:.5,r=Object(A.d)(i,Object(A.c)(t,t.object3D));this.spawnedMediaScale.divideScalar(r)},onSpawnEvent(e){var t,n=this;return(t=function*(){if(n.cooldownTimeout||!n.el.sceneEl.is("entered"))return;const t=Object(p.c)(n.data.src,n.data.template,se.a.SPAWNER,null,n.data.resolve,!1,{x:null===n.data.spawnScale.x?1:n.data.spawnScale.x,y:null===n.data.spawnScale.y?1:n.data.spawnScale.y,z:null===n.data.spawnScale.z?1:n.data.spawnScale.z},n.data.mediaOptions).entity,a=n.el.sceneEl.systems.interaction;if(!a.ready)return;const r=e.detail&&e.detail.object3D||a.options.rightRemote.entity.object3D,o=-1===r.el.id.indexOf("right"),s=o?a.options.leftHand.entity.object3D:a.options.rightHand.entity.object3D;r.getWorldPosition(t.object3D.position),r.getWorldQuaternion(t.object3D.quaternion),t.object3D.matrixNeedsUpdate=!0,n.el.emit("spawned-entity-created",{target:t});const l=AFRAME.scenes[0].systems.userinput,c=n.data.animateFromCursor&&(l.get(le.a.actions.rightHand.matrix)||l.get(le.a.actions.leftHand.matrix));c||(o?(a.state.leftRemote.held=t,a.state.leftRemote.spawning=!0):(a.state.rightRemote.held=t,a.state.rightRemote.spawning=!0)),n.activateCooldown(),yield Object(i.c)("model-loaded",t),r.getWorldPosition(t.object3D.position),r.getWorldQuaternion(t.object3D.quaternion),t.object3D.matrixNeedsUpdate=!0,c?(s.getWorldPosition(n.handPosition),t.setAttribute("animation__spawn-at-cursor",{property:"position",delay:500,dur:1500,from:{x:t.object3D.position.x,y:t.object3D.position.y,z:t.object3D.position.z},to:{x:n.handPosition.x,y:n.handPosition.y,z:n.handPosition.z},easing:"easeInOutBack"})):o?a.state.leftRemote.spawning=!1:a.state.rightRemote.spawning=!1,n.physicsSystem.resetDynamicBody(t.components["body-helper"].uuid),t.addEventListener("media-loaded",()=>{n.el.emit("spawned-entity-loaded",{target:t})},{once:!0})},function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function o(e){ce(r,a,i,o,s,"next",e)}function s(e){ce(r,a,i,o,s,"throw",e)}o(void 0)}))})()},activateCooldown(){if(this.data.spawnCooldown>0){const[e,t,n]=[this.el.object3D.scale.x,this.el.object3D.scale.y,this.el.object3D.scale.z];this.el.setAttribute("visible",!1),this.el.object3D.scale.set(.001,.001,.001),this.el.object3D.matrixNeedsUpdate=!0,this.el.classList.remove("interactable"),this.el.setAttribute("body-helper",{collisionFilterMask:de.NONE}),this.cooldownTimeout=setTimeout(()=>{this.el.setAttribute("visible",!0),this.el.classList.add("interactable"),this.el.setAttribute("body-helper",{collisionFilterMask:de.DEFAULT_SPAWNER}),this.el.removeAttribute("animation__spawner-cooldown"),this.el.setAttribute("animation__spawner-cooldown",{property:"scale",delay:50,dur:350,from:{x:.001,y:.001,z:.001},to:{x:e,y:t,z:n},easing:"easeOutElastic"}),setTimeout(()=>{this.cooldownTimeout=null},400)},1e3*this.data.spawnCooldown)}}});n(534);var ue=n(268),he=n.n(ue),pe=n(97);function me(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function fe(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){me(r,a,i,o,s,"next",e)}function s(e){me(r,a,i,o,s,"throw",e)}o(void 0)}))}}function ge(e,t){THREE.Mesh.call(this,e);const n=void 0!==(t=t||{}).time?t.time:0,a=void 0!==t.waterNormals?t.waterNormals:null,i=void 0!==t.sunDirection?t.sunDirection:new THREE.Vector3(.70707,.70707,0),r=new THREE.Color(void 0!==t.sunColor?t.sunColor:16777215),o=new THREE.Color(void 0!==t.waterColor?t.waterColor:8355711),s=void 0!==t.eye?t.eye:new THREE.Vector3(0,0,0),l=void 0!==t.distortionScale?t.distortionScale:20,c=void 0!==t.side?t.side:THREE.FrontSide,d=void 0!==t.fog&&t.fog,u={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{normalSampler:{value:null},time:{value:0},size:{value:1},distortionScale:{value:20},sunColor:{value:new THREE.Color(8355711)},sunDirection:{value:new THREE.Vector3(.70707,.70707,0)},eye:{value:new THREE.Vector3},waterColor:{value:new THREE.Color(5592405)}}]),vertexShader:"\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    ",fragmentShader:"\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ".concat(THREE.ShaderChunk.common,"\n      ").concat(THREE.ShaderChunk.packing,"\n      ").concat(THREE.ShaderChunk.bsdfs,"\n      ").concat(THREE.ShaderChunk.lights_pars_begin,"\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    ")},h=new THREE.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:THREE.UniformsUtils.clone(u.uniforms),transparent:!1,lights:!0,side:c,fog:d});h.uniforms.time.value=n,h.uniforms.normalSampler.value=a,h.uniforms.sunColor.value=r,h.uniforms.waterColor.value=o,h.uniforms.sunDirection.value=i,h.uniforms.distortionScale.value=l,h.uniforms.eye.value=s,this.material=h}function ve(){return(ve=fe((function*(e){const t=yield new Promise((t,n)=>(new pe.a).load(e,t,void 0,n));return t.wrapS=t.wrapT=THREE.RepeatWrapping,t.needsUpdate=!0,t}))).apply(this,arguments)}ge.prototype=Object.create(THREE.Mesh.prototype),ge.prototype.constructor=THREE.Water,AFRAME.registerComponent("water",{schema:{waterColor:{type:"color",default:"#001e0f"},distortionScale:{type:"number",default:3.7},sunColor:{type:"color",default:"#ffffff"},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:1},speed:{type:"number",default:.1},forceMobile:{type:"boolean",default:!1}},init(){const e=this.el.getObject3D("mesh"),t=e.geometry;e.visible=!1,function(e){return ve.apply(this,arguments)}(he.a).then(e=>{const n={textureWidth:512,textureHeight:512,waterNormals:e,sunDirection:this.data.sunDirection,sunColor:new THREE.Color(this.data.sunColor),waterColor:new THREE.Color(this.data.waterColor),distortionScale:this.data.distortionScale,fog:!1};AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR()||this.data.forceMobile?this.water=new ge(t,n):(this.water=new THREE.Water(t,n),this.water.mirrorCamera.layers.set(x.a.CAMERA_LAYER_REFLECTION)),this.el.setObject3D("water",this.water)})},update(e){if(this.data.forceMobile!==e.forceMobile)return this.el.removeObject3D("water"),void this.init();if(!this.water)return;const t=this.water.material.uniforms;if(this.data.waterColor!==e.waterColor&&t.waterColor.value.setStyle(this.data.waterColor),this.data.distortionScale!==e.distortionScale&&(t.distortionScale.value=this.data.distortionScale),this.data.sunColor!==e.sunColor&&t.sunColor.value.setStyle(this.data.sunColor),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){const e=Math.PI*(this.data.inclination-.5),n=2*Math.PI*(this.data.azimuth-.5),a=this.data.distance,i=a*Math.cos(n),r=a*Math.sin(n)*Math.sin(e),o=a*Math.sin(n)*Math.cos(e);t.sunDirection.value.set(i,r,o)}},tick(e){this.water&&(this.water.material.uniforms.time.value=e/1e3*this.data.speed)},remove(){this.el.removeObject3D("water");this.el.getObject3D("mesh").visible=!0}});var be=n(471);const{Mesh:ye,PlaneBufferGeometry:Ee,MeshStandardMaterial:we,MeshPhongMaterial:_e,Vector2:Se,RepeatWrapping:xe}=THREE;class Ae{constructor(e=new Se(1,1),t=new Se(1,1),n=.0025,a=!0){this.speed=e,this.scale=t,this.height=n,this.alternate=a}}class Me extends ye{constructor(e,t=24,n=!1){const a=new Ee(10,10,t,t);a.rotateX(-Math.PI/2);const i={ripplesSpeed:{value:.25},ripplesScale:{value:1},time:{value:0}},r=n?_e:we;e.wrapS=e.wrapT=xe;const o=new r({color:21727,normalMap:e,roughness:.5,metalness:.5});o.name="SimpleWaterMaterial",o.onBeforeCompile=e=>{Object.assign(e.uniforms,i),e.vertexShader=e.vertexShader.replace("#include <fog_pars_vertex>","\n        #include <fog_pars_vertex>\n        varying vec3 vWPosition;\n      "),e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n        #include <fog_vertex>\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normalmap_pars_fragment>","\n        #include <normalmap_pars_fragment>\n\n        uniform float time;\n        uniform float ripplesSpeed;\n        uniform float ripplesScale;\n      \n        varying vec3 vWPosition;\n      \n        vec4 getNoise(vec2 uv){\n          float timeOffset = time * ripplesSpeed;\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\n          vec4 noise = (texture2D(normalMap, uv0)) +\n                       (texture2D(normalMap, uv1)) +\n                       (texture2D(normalMap, uv2)) +\n                       (texture2D(normalMap, uv3));\n          return noise / 4.0;\n        }\n      "),e.fragmentShader=e.fragmentShader.replace("#include <normal_fragment_maps>","\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n          vec3 eye_pos = -vViewPosition;\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n          vec2 st0 = dFdx( vUv.st );\n          vec2 st1 = dFdy( vUv.st );\n\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n          vec3 N = normalize( normal );\n          mat3 tsn = mat3( S, T, N );\n\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\n\n          mapN.xy *= normalScale;\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n          normal = normalize( tsn * mapN );\n        ")},super(a,o),this.lowQuality=n,this.waterUniforms=i,n?this.material.specular.set(16777215):this.receiveShadow=!0,this.geometry.attributes.position.dynamic=!0,this.resolution=t,this.octaves=[new Ae(new Se(.5,.5),new Se(1,1),.01,!0),new Ae(new Se(.05,6),new Se(1,20),.1,!1)],this.simplex=new be.a}get opacity(){return this.material.opacity}set opacity(e){this.material.opacity=e,1!==e&&(this.material.transparent=!0)}get color(){return this.material.color}get tideHeight(){return this.octaves[0].height}get tideScale(){return this.octaves[0].scale}get tideSpeed(){return this.octaves[0].speed}set tideHeight(e){this.octaves[0].height=e}get waveHeight(){return this.octaves[1].height}set waveHeight(e){this.octaves[1].height=e}get waveScale(){return this.octaves[1].scale}get waveSpeed(){return this.octaves[1].speed}set ripplesSpeed(e){this.waterUniforms.ripplesSpeed.value=e}get ripplesSpeed(){return this.waterUniforms.ripplesSpeed.value}set ripplesScale(e){this.waterUniforms.ripplesScale.value=e}get ripplesScale(){return this.waterUniforms.ripplesScale.value}update(e){const t=this.geometry.attributes.position;for(let n=0;n<=this.resolution;n++)for(let a=0;a<=this.resolution;a++){let i=0;for(let t=0;t<this.octaves.length;t++){const r=this.octaves[t];if(r.alternate){const t=this.simplex.noise(n*r.scale.x/this.resolution,a*r.scale.y/this.resolution);i+=Math.cos(t+r.speed.length()*e)*r.height}else{i+=(this.simplex.noise((n*r.scale.x+e*r.speed.x)/this.resolution,(a*r.scale.y+e*r.speed.y)/this.resolution)-.5)*r.height}}t.setY(n*(this.resolution+1)+a,i)}this.geometry.computeVertexNormals(),t.needsUpdate=!0,this.waterUniforms.time.value=e}clone(e){return new Me(this.material.normalMap,this.resolution,this.lowQuality).copy(this,e)}copy(e,t=!0){return super.copy(e,t),this.opacity=e.opacity,this.color.copy(e.color),this.tideHeight=e.tideHeight,this.tideScale.copy(e.tideScale),this.tideSpeed.copy(e.tideSpeed),this.waveHeight=e.waveHeight,this.waveScale.copy(e.waveScale),this.waveSpeed.copy(e.waveSpeed),this.ripplesSpeed=e.ripplesSpeed,this.ripplesScale=e.ripplesScale,this}}function ke(e,t){return e&&t&&e.x===t.x&&e.y===t.y}let Oe=null;AFRAME.registerComponent("simple-water",{schema:{opacity:{type:"number",default:1},color:{type:"color"},tideHeight:{type:"number",default:.01},tideScale:{type:"vec2",default:{x:1,y:1}},tideSpeed:{type:"vec2",default:{x:.5,y:.5}},waveHeight:{type:"number",default:.1},waveScale:{type:"vec2",default:{x:1,y:20}},waveSpeed:{type:"vec2",default:{x:.05,y:6}},ripplesScale:{type:"number",default:1},ripplesSpeed:{type:"number",default:.25}},init(){Oe||(Oe=(new pe.a).load(he.a));const e="high"!==window.APP.store.state.preferences.materialQualitySetting;this.water=new Me(Oe,void 0,e),this.el.setObject3D("mesh",this.water)},update(e){this.data.opacity!==e.opacity&&(this.water.opacity=this.data.opacity),this.data.color!==e.color&&this.water.color.set(this.data.color),this.data.tideHeight!==e.tideHeight&&(this.water.tideHeight=this.data.tideHeight),ke(this.data.tideScale,e.tideScale)||this.water.tideScale.copy(this.data.tideScale),ke(this.data.tideSpeed,e.tideSpeed)||this.water.tideSpeed.copy(this.data.tideSpeed),this.data.waveHeight!==e.waveHeight&&(this.water.waveHeight=this.data.waveHeight),ke(this.data.waveScale,e.waveScale)||this.water.waveScale.copy(this.data.waveScale),ke(this.data.waveSpeed,e.waveSpeed)||this.water.waveSpeed.copy(this.data.waveSpeed),this.data.ripplesScale!==e.ripplesScale&&(this.water.ripplesScale=this.data.ripplesScale),this.data.ripplesSpeed!==e.ripplesSpeed&&(this.water.ripplesSpeed=this.data.ripplesSpeed)},tick(e){this.water.update(e/1e3)},remove(){this.el.removeObject3D("mesh")}});n(535),n(536);var Ce=n(430),Pe=n(211);function Re(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}const Te=new URL(n.n(Pe).a,window.location.href).href;AFRAME.registerComponent("particle-emitter",{schema:{resolve:{type:"boolean",default:!0},src:{type:"string",default:Te},startColor:{type:"color"},middleColor:{type:"color"},endColor:{type:"color"},startOpacity:{type:"number",default:1},middleOpacity:{type:"number",default:1},endOpacity:{type:"number",default:1},colorCurve:{type:"string",default:"linear"},sizeCurve:{type:"string",default:"linear"},startSize:{type:"number",default:1},endSize:{type:"number",default:1},sizeRandomness:{type:"number"},ageRandomness:{type:"number"},lifetime:{type:"number",default:1},lifetimeRandomness:{type:"number"},particleCount:{type:"number",default:10},startVelocity:{type:"vec3",default:{x:0,y:0,z:1}},endVelocity:{type:"vec3",default:{x:0,y:0,z:1}},velocityCurve:{type:"string",default:"linear"},angularVelocity:{type:"number"}},init(){this.particleEmitter=new Ce.a(null),this.particleEmitter.visible=!1,this.el.setObject3D("particle-emitter",this.particleEmitter),this.updateParticles=!1,this.data.src===Te&&(this.data.resolve=!1)},setTexture(e,t){var n,a=this;return(n=function*(){let n=e;if(t){let t=(yield Object(p.n)(e)).origin;t.startsWith("//")&&(t=location.protocol+t),n=Object(M.j)(t)}const i=yield p.o.loadAsync(n);a.data.src===e&&(a.particleEmitter.material.uniforms.map.value=i,a.particleEmitter.visible=!0,a.updateParticles=!0)},function(){var e=this,t=arguments;return new Promise((function(a,i){var r=n.apply(e,t);function o(e){Re(r,a,i,o,s,"next",e)}function s(e){Re(r,a,i,o,s,"throw",e)}o(void 0)}))})()},update(e){const t=this.data,n=this.particleEmitter;e.src!==t.src&&this.setTexture(t.src,t.resolve).catch(console.error),e.startColor===t.startColor&&e.startSize===t.startSize&&e.sizeRandomness===t.sizeRandomness&&e.ageRandomness===t.ageRandomness&&e.lifetime===t.lifetime&&e.lifetimeRandomness===t.lifetimeRandomness&&e.particleCount===t.particleCount||(this.updateParticles=!0),n.startColor.set(t.startColor),n.middleColor.set(t.middleColor),n.endColor.set(t.endColor),n.startOpacity=t.startOpacity,n.middleOpacity=t.middleOpacity,n.endOpacity=t.endOpacity,n.colorCurve=t.colorCurve,n.sizeCurve=t.sizeCurve,n.startSize=t.startSize,n.endSize=t.endSize,n.sizeRandomness=t.sizeRandomness,n.ageRandomness=t.ageRandomness,n.lifetime=t.lifetime,n.lifetimeRandomness=t.lifetimeRandomness,n.particleCount=t.particleCount,n.startVelocity.copy(t.startVelocity),n.endVelocity.copy(t.endVelocity),n.velocityCurve=t.velocityCurve,n.angularVelocity=t.angularVelocity},tick(e,t){this.updateParticles&&(this.particleEmitter.updateParticles(),this.updateParticles=!1),this.particleEmitter.visible&&this.particleEmitter.update(t/1e3)}});n(537);var je=n(43),De=n(38);AFRAME.registerComponent("audio-zone-source",{init(){var e;this.originalAudioParamsData=null,null===(e=this.el.sceneEl.systems["hubs-systems"])||void 0===e||e.audioZonesSystem.registerSource(this)},remove(){var e;APP.zoneOverrides.delete(this.el),null===(e=this.el.sceneEl.systems["hubs-systems"])||void 0===e||e.audioZonesSystem.unregisterSource(this)},getPosition:(()=>{const e=new je.THREE.Vector3;return function(){const t=APP.audios.get(this.el);return t?t.getWorldPosition(e):e.set(0,0,0),e}})(),apply(e){APP.zoneOverrides.set(this.el,e);const t=APP.audios.get(this.el);t&&Object(De.d)(this.el,t)},restore(){APP.zoneOverrides.delete(this.el);const e=APP.audios.get(this.el);e&&Object(De.d)(this.el,e)}});var Ie=n(327);Ie.a.prototype.isTroikaText=!0;const Le={front:THREE.FrontSide,back:THREE.BackSide,double:THREE.DoubleSide};function He(e){return{default:e,parse:function(e){return"string"==typeof e&&e.indexOf("%")>0?e:(e=+e,isNaN(e)?0:e)},stringify:function(e){return""+e}}}AFRAME.registerComponent("text",{schema:{textAlign:{type:"string",default:"left",oneOf:["left","right","center","justify"]},anchorX:{default:"center",oneOf:["left","right","center"]},anchorY:{default:"middle",oneOf:["top","top-baseline","middle","bottom-baseline","bottom"]},clipRect:{type:"string",default:"",parse:function(e){return e&&(e=e.split(/[\s,]+/).reduce((function(e,t){return t=+t,isNaN(t)||e.push(t),e}),[])),e&&4===e.length?e:null},stringify:function(e){return e?e.join(" "):""}},color:{type:"color",default:"#FFF"},curveRadius:{type:"number",default:0},depthOffset:{type:"number",default:0},direction:{type:"string",default:"auto",oneOf:["auto","ltr","rtl"]},fillOpacity:{type:"number",default:1},fontUrl:{type:"string"},fontSize:{type:"number",default:.075},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},maxWidth:{type:"number",default:1/0},outlineBlur:He(0),outlineColor:{type:"color",default:"#000"},outlineOffsetX:He(0),outlineOffsetY:He(0),outlineOpacity:{type:"number",default:1},outlineWidth:He(0),overflowWrap:{type:"string",default:"normal",oneOf:["normal","break-word"]},strokeColor:{type:"color",default:"grey"},strokeOpacity:{type:"number",default:1},strokeWidth:He(0),value:{type:"string",default:""},textIndent:{type:"number",default:0},whiteSpace:{default:"normal",oneOf:["normal","nowrap"]},opacity:{type:"number",default:1},side:{default:"front",oneOf:["front","back","double"]}},init:function(){this.troikaTextMesh=new Ie.a,this.troikaTextMesh.material.toneMapped=!1,this.el.setObject3D("text",this.troikaTextMesh)},update:function(){const e=this.data,t=this.troikaTextMesh;t.text=e.value||"",t.textAlign=e.textAlign,t.anchorX=e.anchorX,t.anchorY=e.anchorY,t.color=e.color,t.material.side=Le[e.side],t.material.opacity=e.opacity,t.curveRadius=e.curveRadius,t.depthOffset=e.depthOffset||0,t.direction=e.direction,t.fillOpacity=e.fillOpacity,t.font=e.fontUrl,t.fontSize=e.fontSize,t.letterSpacing=e.letterSpacing||0,t.clipRect=e.clipRect,t.lineHeight=e.lineHeight||"normal",t.outlineBlur=e.outlineBlur,t.outlineColor=e.outlineColor,t.outlineOffsetX=e.outlineOffsetX,t.outlineOffsetY=e.outlineOffsetY,t.outlineOpacity=e.outlineOpacity,t.outlineWidth=e.outlineWidth,t.overflowWrap=e.overflowWrap,t.strokeColor=e.strokeColor,t.strokeOpacity=e.strokeOpacity,t.strokeWidth=e.strokeWidth,t.textIndent=e.textIndent,t.whiteSpace=e.whiteSpace,t.maxWidth=e.maxWidth,t.sync(()=>{this.el.emit("text-updated",this)})},remove:function(){this.troikaTextMesh.dispose()},getSize:function(){const e=new THREE.Vector3;return function(t){this.troikaTextMesh.geometry.boundingBox.getSize(e),t.set(e.x*this.troikaTextMesh.scale.x,e.y*this.troikaTextMesh.scale.y,e.z*this.troikaTextMesh.scale.z)}}()});n(538),n(539)},595:function(e,t,n){"use strict";var a=n(204);n(171);function i(e,t,n){const a=n[e];if(!a)throw new Error('Component "'.concat(e,'" is not public.'));const i=a.publicProperties[t];if(!i)throw new Error('Component "'.concat(e,'"\'s property "').concat(t,'" is not public.'));return{mappedComponent:a.mappedComponent,mappedProperty:i.mappedProperty,getMappedValue:i.getMappedValue}}var r=n(27),o=n(10),s=n(38);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){c(e,t,n[t])}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){d(r,a,i,o,s,"next",e)}function s(e){d(r,a,i,o,s,"throw",e)}o(void 0)}))}}const h=n(209).COLLISION_LAYERS;function p(e,t,n,a){return m.apply(this,arguments)}function m(){return(m=u((function*(e,t,n,i){let r=!0;if("link"===t&&(i.video||i.image))return;if(i.networked){r=n.controls||"link"===t;const a="video"===t||"audio"===t,o="model"===t||r||a?"#static-controlled-media":"#static-media";e.setAttribute("networked",{template:o,owner:"scene",persistent:!0,networkId:i.networked.id})}const l={};if("video"!==t&&"image"!==t||(l.projection=n.projection,l.alphaMode=n.alphaMode,l.alphaCutoff=n.alphaCutoff),"video"===t||"audio"===t){if(l.videoPaused=!n.autoPlay,l.loop=n.loop,l.hidePlaybackControls=!r,n.audioType){APP.audioOverrides.set(e,{audioType:n.audioType,distanceModel:n.audioType===o.a.Stereo?o.d.Linear:n.distanceModel,rolloffFactor:n.audioType===o.a.Stereo?0:n.rolloffFactor,refDistance:n.refDistance,maxDistance:n.maxDistance,coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,gain:n.volume}),APP.sourceType.set(e,o.g.MEDIA_VIDEO);const t=APP.audios.get(e);t&&Object(s.d)(e,t)}e.setAttribute("video-pause-state",{paused:l.videoPaused})}"video"!==t&&"image"!==t||!i.link||(l.href=Object(a.sanitizeUrl)(i.link.href));const c="link"===t?n.href:n.src;e.setAttribute("media-loader",{src:Object(a.sanitizeUrl)(c),fitToBox:!0,resolve:!0,fileIsOwned:!0,animate:!1,mediaOptions:l,moveTheParentNotTheMesh:!0})}))).apply(this,arguments)}AFRAME.GLTFModelPlus.registerComponent("duck","duck",e=>{e.setAttribute("duck",""),e.setAttribute("quack",{quackPercentage:.1})}),AFRAME.GLTFModelPlus.registerComponent("quack","quack"),AFRAME.GLTFModelPlus.registerComponent("sound","sound"),AFRAME.GLTFModelPlus.registerComponent("css-class","css-class"),AFRAME.GLTFModelPlus.registerComponent("interactable","css-class",(e,t)=>{e.setAttribute(t,"interactable")}),AFRAME.GLTFModelPlus.registerComponent("super-spawner","super-spawner",(e,t,n)=>{e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0}),e.setAttribute("hoverable-visuals",""),e.setAttribute(t,n)}),AFRAME.GLTFModelPlus.registerComponent("gltf-model-plus","gltf-model-plus"),AFRAME.GLTFModelPlus.registerComponent("media-loader","media-loader"),AFRAME.GLTFModelPlus.registerComponent("body","body-helper",e=>{e.setAttribute("body-helper",{mass:0,type:r.TYPE.STATIC,collisionFilterGroup:h.INTERACTABLES,collisionFilterMask:h.DEFAULT_SPAWNER})}),AFRAME.GLTFModelPlus.registerComponent("ammo-shape","shape-helper"),AFRAME.GLTFModelPlus.registerComponent("hide-when-quality","hide-when-quality"),AFRAME.GLTFModelPlus.registerComponent("light","light",(e,t,n)=>{0===n.distance&&(n.decay=0),e.setAttribute(t,n),n.castShadow&&setTimeout(()=>{e.components.light.light.shadow.camera.matrixNeedsUpdate=!0},0)}),AFRAME.GLTFModelPlus.registerComponent("ambient-light","ambient-light"),AFRAME.GLTFModelPlus.registerComponent("directional-light","directional-light"),AFRAME.GLTFModelPlus.registerComponent("hemisphere-light","hemisphere-light"),AFRAME.GLTFModelPlus.registerComponent("point-light","point-light"),AFRAME.GLTFModelPlus.registerComponent("spot-light","spot-light"),AFRAME.GLTFModelPlus.registerComponent("billboard","billboard"),AFRAME.GLTFModelPlus.registerComponent("simple-water","simple-water"),AFRAME.GLTFModelPlus.registerComponent("skybox","skybox"),AFRAME.GLTFModelPlus.registerComponent("layers","layers"),AFRAME.GLTFModelPlus.registerComponent("shadow","shadow"),AFRAME.GLTFModelPlus.registerComponent("water","water"),AFRAME.GLTFModelPlus.registerComponent("scale-audio-feedback","scale-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("morph-audio-feedback","morph-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("animation-mixer","animation-mixer"),AFRAME.GLTFModelPlus.registerComponent("loop-animation","loop-animation"),AFRAME.GLTFModelPlus.registerComponent("uv-scroll","uv-scroll"),AFRAME.GLTFModelPlus.registerComponent("frustrum","frustrum"),AFRAME.GLTFModelPlus.registerComponent("mirror","mirror"),AFRAME.GLTFModelPlus.registerComponent("box-collider","shape-helper",(()=>{const e=new THREE.Euler;return(t,n,a)=>{const{scale:i,rotation:o}=a;e.set(o.x,o.y,o.z);const s=(new THREE.Quaternion).setFromEuler(e);t.setAttribute(n,{type:r.SHAPE.BOX,fit:r.FIT.MANUAL,offset:a.position,halfExtents:{x:i.x/2,y:i.y/2,z:i.z/2},orientation:{x:s.x,y:s.y,z:s.z,w:s.w}})}})()),AFRAME.GLTFModelPlus.registerComponent("visible","visible",(e,t,n)=>{"object"==typeof n?e.setAttribute(t,n.visible):e.setAttribute(t,n)}),AFRAME.GLTFModelPlus.registerComponent("spawn-point","spawn-point",e=>{e.setAttribute("waypoint",{canBeSpawnPoint:!0,canBeOccupied:!1,canBeClicked:!1,willDisableMotion:!1,willDisableTeleporting:!1,willMaintainWorldUp:!0})}),AFRAME.GLTFModelPlus.registerComponent("nav-mesh","nav-mesh"),AFRAME.GLTFModelPlus.registerComponent("pinnable","pinnable"),AFRAME.GLTFModelPlus.registerComponent("waypoint","waypoint",(e,t,n,a)=>{n.canBeOccupied&&e.setAttribute("networked",{template:"#template-waypoint-avatar",attachTemplateToLocal:!1,owner:"scene",persistent:!0,networkId:a.networked.id}),e.setAttribute("waypoint",n)}),AFRAME.GLTFModelPlus.registerComponent("media-frame","media-frame",(e,t,n,a)=>{e.setAttribute("networked",{template:"#interactable-media-frame",owner:"scene",persistent:!0,networkId:a.networked.id}),e.setAttribute("shape-helper",{type:"box",fit:"manual",halfExtents:{x:n.bounds.x/2,y:n.bounds.y/2,z:n.bounds.z/2}}),e.setAttribute("media-frame",n)}),AFRAME.GLTFModelPlus.registerComponent("media","media",(e,t,n)=>{n.id&&e.setAttribute("networked",{template:"#interactable-media",owner:"scene",persistent:!0,networkId:n.id});const i={src:Object(a.sanitizeUrl)(n.src),fitToBox:!n.contentSubtype,resolve:!0,fileIsOwned:!0,animate:!1,contentSubtype:n.contentSubtype};n.version&&(i.version=n.version),e.setAttribute("media-loader",i),n.pageIndex&&(e.setAttribute("media-pdf",{index:n.pageIndex}),e.setAttribute("media-pager",{index:n.pageIndex})),void 0!==n.paused&&e.setAttribute("media-video",{videoPaused:n.paused}),n.time&&e.setAttribute("media-video",{time:n.time})}),AFRAME.GLTFModelPlus.registerComponent("model","model",p),AFRAME.GLTFModelPlus.registerComponent("image","image",p),AFRAME.GLTFModelPlus.registerComponent("audio","audio",p,(e,t,n)=>"paused"===t?{name:"video-pause-state",property:t,value:n}:null),AFRAME.GLTFModelPlus.registerComponent("video","video",p,(e,t,n)=>"paused"===t?{name:"video-pause-state",property:t,value:n}:null),AFRAME.GLTFModelPlus.registerComponent("link","link",p),AFRAME.GLTFModelPlus.registerComponent("hoverable","is-remote-hover-target",e=>{e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0})}),AFRAME.GLTFModelPlus.registerComponent("spawner","spawner",(e,t,n)=>{e.setAttribute("media-loader",{src:Object(a.sanitizeUrl)(n.src),resolve:!0,fileIsOwned:!0,animate:!1,moveTheParentNotTheMesh:!0}),e.setAttribute("css-class","interactable"),e.setAttribute("super-spawner",{src:Object(a.sanitizeUrl)(n.src),resolve:!0,template:"#interactable-media",mediaOptions:n.mediaOptions||{}}),e.setAttribute("hoverable-visuals",""),e.setAttribute("body-helper",{mass:0,type:r.TYPE.STATIC,collisionFilterGroup:h.INTERACTABLES,collisionFilterMask:h.DEFAULT_SPAWNER}),e.setAttribute("is-remote-hover-target",""),e.setAttribute("tags",{isHandCollisionTarget:!0})});const f={video:{mappedComponent:"video-pause-state",publicProperties:{paused:{mappedProperty:"paused",getMappedValue:e=>!!e}}},"loop-animation":{mappedComponent:"loop-animation",publicProperties:{paused:{mappedProperty:"paused",getMappedValue:e=>!!e}}}};AFRAME.GLTFModelPlus.registerComponent("trigger-volume","trigger-volume",(e,t,n,a,r)=>{const{size:o,target:s,enterComponent:l,enterProperty:c,enterValue:d,leaveComponent:u,leaveProperty:h,leaveValue:p}=n;let m,g,v;try{if(m=i(l,c,f),g=i(u,h,f),v="number"==typeof s?r[s]:null==s?void 0:s.el,!v)throw new Error("Couldn't find target entity with index: ".concat(s,"."))}catch(e){return void console.warn('Error inflating gltf component "trigger-volume": '.concat(e.message))}e.setAttribute("trigger-volume",{colliders:"#avatar-pov-node",size:o,target:v,enterComponent:m.mappedComponent,enterProperty:m.mappedProperty,enterValue:m.getMappedValue(d),leaveComponent:g.mappedComponent,leaveProperty:g.mappedProperty,leaveValue:g.getMappedValue(p)})}),AFRAME.GLTFModelPlus.registerComponent("heightfield","heightfield",(e,t,n)=>{e.setAttribute("shape-helper__heightfield",{type:r.SHAPE.HEIGHTFIELD,margin:.01,fit:r.FIT.MANUAL,heightfieldDistance:n.distance,offset:n.offset,heightfieldData:n.data})}),AFRAME.GLTFModelPlus.registerComponent("trimesh","trimesh",e=>{e.setAttribute("shape-helper__trimesh",{type:r.SHAPE.MESH,margin:.01,fit:r.FIT.ALL,includeInvisible:!0})}),AFRAME.GLTFModelPlus.registerComponent("particle-emitter","particle-emitter"),AFRAME.GLTFModelPlus.registerComponent("networked-drawing-buffer","networked-drawing-buffer"),AFRAME.GLTFModelPlus.registerComponent("audio-settings","audio-settings",(e,t,n)=>{const a=e=>Object.entries(e).reduce((e,[t,n])=>(void 0!==n&&(e[t]=n),e),{});APP.sceneAudioDefaults.set(o.g.MEDIA_VIDEO,a({distanceModel:n.mediaDistanceModel,rolloffFactor:n.mediaRolloffFactor,refDistance:n.mediaRefDistance,maxDistance:n.mediaMaxDistance,coneInnerAngle:n.mediaConeInnerAngle,coneOuterAngle:n.mediaConeOuterAngle,coneOuterGain:n.mediaConeOuterGain,gain:n.mediaVolume})),APP.sceneAudioDefaults.set(o.g.AVATAR_AUDIO_SOURCE,a({distanceModel:n.avatarDistanceModel,rolloffFactor:n.avatarRolloffFactor,refDistance:n.avatarRefDistance,maxDistance:n.avatarMaxDistance,coneInnerAngle:n.avatarConeInnerAngle,coneOuterAngle:n.avatarConeOuterAngle,coneOuterGain:n.avatarConeOuterGain,gain:n.avatarVolume}));for(const[e,t]of APP.audios.entries())Object(s.d)(e,t)}),AFRAME.GLTFModelPlus.registerComponent("video-texture-target","video-texture-target",(e,t,n,a,i)=>{const{targetBaseColorMap:r,targetEmissiveMap:o,srcNode:s}=n;let l;void 0!==s&&(l="number"==typeof s?i[s]:null==s?void 0:s.el,l||console.warn('Error inflating gltf component "video-texture-srcEl": Couldn\'t find srcEl entity with index '.concat(s))),e.setAttribute(t,{src:l?"el":"",targetBaseColorMap:r,targetEmissiveMap:o,srcEl:l})}),AFRAME.GLTFModelPlus.registerComponent("video-texture-source","video-texture-source"),AFRAME.GLTFModelPlus.registerComponent("text","text"),AFRAME.GLTFModelPlus.registerComponent("audio-target","audio-target",(e,t,n,a,i)=>{const{srcNode:r}=n;let l;if(void 0!==r&&(l="number"==typeof r?i[r]:null==r?void 0:r.el,l||console.warn("Error inflating gltf component ".concat(t,": Couldn't find srcEl entity with index ").concat(r))),void 0!==n.positional){APP.audioOverrides.set(e,{audioType:n.positional?o.a.PannerNode:o.a.Stereo,distanceModel:n.distanceModel,rolloffFactor:n.rolloffFactor,refDistance:n.refDistance,maxDistance:n.maxDistance,coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,gain:n.gain}),APP.sourceType.set(e,o.g.AUDIO_TARGET);const t=APP.audios.get(e);t&&Object(s.d)(e,t)}e.setAttribute(t,{minDelay:n.minDelay,maxDelay:n.maxDelay,debug:n.debug,srcEl:l})}),AFRAME.GLTFModelPlus.registerComponent("zone-audio-source","zone-audio-source"),AFRAME.GLTFModelPlus.registerComponent("audio-params","audio-params",(e,t,n)=>{APP.audioOverrides.set(e,n);const a=APP.audios.get(e);a&&Object(s.d)(e,a)}),AFRAME.GLTFModelPlus.registerComponent("audio-zone","audio-zone",(e,t,n)=>{e.setAttribute(t,l({},n))}),AFRAME.GLTFModelPlus.registerComponent("background","background",(e,t,n)=>{console.warn("The `background` component is deprecated, use `backgroundColor` on the `environment-settings` component instead."),e.setAttribute("environment-settings",{backgroundColor:new THREE.Color(n.color)})}),AFRAME.GLTFModelPlus.registerComponent("fog","fog",(e,t,n)=>{e.setAttribute("environment-settings",{fogType:n.type,fogColor:new THREE.Color(n.color),fogNear:n.near,fogFar:n.far,fogDensity:n.density})}),AFRAME.GLTFModelPlus.registerComponent("environment-settings","environment-settings",(e,t,n)=>{e.setAttribute(t,l({},n,{backgroundColor:new THREE.Color(n.backgroundColor)}))}),AFRAME.GLTFModelPlus.registerComponent("reflection-probe","reflection-probe",(e,t,n)=>{n.envMapTexture.flipY=!0,n.envMapTexture.mapping=THREE.EquirectangularReflectionMapping,e.setAttribute(t,n)})},607:function(e,t,n){e.exports={content:"AvatarSettingsContent__content___aUEb","avatar-preview-container":"AvatarSettingsContent__avatar-preview-container__3jB58",avatarPreviewContainer:"AvatarSettingsContent__avatar-preview-container__3jB58"}},610:function(e,t,n){e.exports={"rtc-tile-text":"Prop__rtc-tile-text__3RB-P",rtcTileText:"Prop__rtc-tile-text__3RB-P","rtc-value-text":"Prop__rtc-value-text__mPfQH",rtcValueText:"Prop__rtc-value-text__mPfQH"}},611:function(e,t,n){e.exports={"data-tile":"DataPanel__data-tile__2r7CT",dataTile:"DataPanel__data-tile__2r7CT","data-tile-title":"DataPanel__data-tile-title__27XlV",dataTileTitle:"DataPanel__data-tile-title__27XlV"}},613:function(e,t,n){e.exports={object:"ObjectsSidebar__object__3Cefq","no-objects":"ObjectsSidebar__no-objects__3zFp8",noObjects:"ObjectsSidebar__no-objects__3zFp8"}},614:function(e,t,n){e.exports={"button-grid-popover":"ButtonGridPopover__button-grid-popover__31fTd",buttonGridPopover:"ButtonGridPopover__button-grid-popover__31fTd",fullscreen:"ButtonGridPopover__fullscreen__2JcTB"}},615:function(e,t,n){e.exports={"image-grid-popover":"ImageGridPopover__image-grid-popover__29N5T",imageGridPopover:"ImageGridPopover__image-grid-popover__29N5T",fullscreen:"ImageGridPopover__fullscreen__3w2sX"}},616:function(e,t,n){e.exports={"reaction-button":"ReactionButton__reaction-button__13xbX",reactionButton:"ReactionButton__reaction-button__13xbX",active:"ReactionButton__active__3Eurw"}},617:function(e,t,n){e.exports={label:"ReactionPopover__label__3XckL",popover:"ReactionPopover__popover__1GmS2"}},618:function(e){e.exports=JSON.parse('{"meta":{"image":"sprite-system-action-spritesheet.png","size":{"w":1024,"h":1024},"scale":"1"},"frames":{"angry-off.png":{"frame":{"x":8,"y":8,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"angry-on-hover.png":{"frame":{"x":154,"y":8,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"angry-on.png":{"frame":{"x":8,"y":154,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"disgust-off.png":{"frame":{"x":154,"y":154,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"disgust-on-hover.png":{"frame":{"x":300,"y":8,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"disgust-on.png":{"frame":{"x":300,"y":154,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"eww-off.png":{"frame":{"x":8,"y":300,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"eww-on-hover.png":{"frame":{"x":154,"y":300,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"eww-on.png":{"frame":{"x":300,"y":300,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"happy-off.png":{"frame":{"x":446,"y":8,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"happy-on-hover.png":{"frame":{"x":446,"y":154,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"happy-on.png":{"frame":{"x":446,"y":300,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"hearts-off.png":{"frame":{"x":8,"y":446,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"hearts-on-hover.png":{"frame":{"x":154,"y":446,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"hearts-on.png":{"frame":{"x":300,"y":446,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"sad-off.png":{"frame":{"x":446,"y":446,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"sad-on-hover.png":{"frame":{"x":592,"y":8,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"sad-on.png":{"frame":{"x":592,"y":154,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"smile-off.png":{"frame":{"x":592,"y":300,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"smile-on-hover.png":{"frame":{"x":592,"y":446,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"smile-on.png":{"frame":{"x":8,"y":592,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"surprise-off.png":{"frame":{"x":154,"y":592,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"surprise-on-hover.png":{"frame":{"x":300,"y":592,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"surprise-on.png":{"frame":{"x":446,"y":592,"w":130,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":130,"h":130},"sourceSize":{"w":130,"h":130}},"mod-badge.png":{"frame":{"x":592,"y":592,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"recording-badge.png":{"frame":{"x":738,"y":8,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"spawn-disabled.png":{"frame":{"x":738,"y":152,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"spawn-hover.png":{"frame":{"x":738,"y":296,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"spawn.png":{"frame":{"x":738,"y":440,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"Background.png":{"frame":{"x":738,"y":584,"w":128,"h":48},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":48},"sourceSize":{"w":128,"h":48}},"camera-action.png":{"frame":{"x":738,"y":648,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"close-action.png":{"frame":{"x":8,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"deserialize-action.png":{"frame":{"x":88,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"drop-action.png":{"frame":{"x":168,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"focus-action.png":{"frame":{"x":248,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"inspect-action.png":{"frame":{"x":328,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"mute-action.png":{"frame":{"x":408,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"next.png":{"frame":{"x":488,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"pin-action.png":{"frame":{"x":568,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"prev.png":{"frame":{"x":648,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"recenter-action.png":{"frame":{"x":728,"y":738,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"record-action-alpha.png":{"frame":{"x":882,"y":8,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"record-action.png":{"frame":{"x":882,"y":88,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"remove-action.png":{"frame":{"x":882,"y":168,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"rotate-action.png":{"frame":{"x":882,"y":248,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"scale-action.png":{"frame":{"x":882,"y":328,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"serialize-action.png":{"frame":{"x":882,"y":408,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"snap-page.png":{"frame":{"x":882,"y":488,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"spawn_message.png":{"frame":{"x":882,"y":568,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"spawn_message_dark-hover.png":{"frame":{"x":882,"y":648,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"spawn_message_dark.png":{"frame":{"x":882,"y":728,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"stop-action.png":{"frame":{"x":8,"y":818,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"undo-action.png":{"frame":{"x":88,"y":818,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"unmute-action.png":{"frame":{"x":168,"y":818,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}}}}')},63:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),i=n.n(a),r=n(1),o=n.n(r),s=n(190),l=(n(117),n(126),n(131),n(220),n(221),n(16));class c extends i.a.Component{constructor(...e){super(...e),this.state={locale:Object(l.a)(),messages:Object(l.c)()},this.updateLocale=()=>{this.setState({locale:Object(l.a)(),messages:Object(l.c)()})}}componentDidMount(){this.updateLocale(),window.addEventListener("locale-updated",this.updateLocale)}componentWillUnmount(){window.removeEventListener("locale-updated",this.updateLocale)}render(){return i.a.createElement(s.a,{locale:this.state.locale,messages:this.state.messages},this.props.children)}}c.propTypes={children:o.a.node.isRequired}},64:function(e,t,n){e.exports=n.p+"assets/images/app-logo-6c8cfcf9c903ba04105ca0bc29514de7.png"},65:function(e,t,n){e.exports=n.p+"assets/images/app-logo-dark-3ce7d2da524556485823d5ac27c3a7fc.png"},66:function(e,t,n){e.exports=n.p+"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png"},67:function(e,t,n){e.exports=n.p+"assets/images/home-hero-background-unbranded-af23743b76d26ec9d5c160558a2e18ef.png"},68:function(e,t,n){e.exports=n.p+"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png"},7:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o}));const a=Object.freeze({PERMISSIONS_STATUS_CHANGED:"permissions_status_changed",MIC_SHARE_STARTED:"mic_share_started",MIC_SHARE_ENDED:"mic_share_ended",VIDEO_SHARE_STARTED:"video_share_started",VIDEO_SHARE_ENDED:"video_share_ended",DEVICE_CHANGE:"devicechange"}),i=Object.freeze({GRANTED:"granted",DENIED:"denied",PROMPT:"prompt"}),r=Object.freeze({MICROPHONE:"microphone",SPEAKERS:"speakers",CAMERA:"camera",SCREEN:"screen"}),o="none"},763:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_0-3818feefc64a56500b4a9aafd3c335f6.png"},764:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_1-ff98c03defdd5eadb3a76d54dc4de4ff.png"},765:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_2-aebbe107715f979f4211cc137554f5ee.png"},766:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_3-6480f2b043fc431438467975b444fa27.png"},767:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_4-4d4455f09e9816d62fb4fc971bf0b804.png"},768:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_5-d84043c3235c12f7278ceea115f6beb3.png"},769:function(e,t,n){e.exports=n.p+"assets/images/emojis/emoji_6-38b62cb627da408d9f78b5b260051b33.png"},770:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_0-f3f46448f25bc1d8599c39fc43fc3430.glb"},771:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_1-99633c94256b7520f7833921094bedfe.glb"},772:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_2-4531e5b1d197a14e76c8d47894b62db0.glb"},773:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_3-167102458af413f37fc62cd5b201a010.glb"},774:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_4-834ee3738e00e03227ff45809c6f2fe8.glb"},775:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_5-b2763de169ccdb200ec5e8503170079d.glb"},776:function(e,t,n){e.exports=n.p+"assets/models/emojis/emoji_6-6df1120c791dabb88d6b1ada0d8f973d.glb"},777:function(e,t,n){e.exports=n.p+"assets/hud/hand-raised-8e89d297620ec62351f31419c30d415b.png"},778:function(e,t,n){e.exports=n.p+"assets/images/audio-0205471a2825b8450c63e45f83436997.png"},78:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var a=n(110);const i=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,r=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;function o(){return window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)}function s(){return/iPad|iPhone|iPod/.test(window.navigator.platform)||o()}function l(){return/(OculusBrowser)/i.test(window.navigator.userAgent)||/(Mobile VR)/i.test(window.navigator.userAgent)}const c=function(){let e=!1;var t;return t=window.navigator.userAgent||window.navigator.vendor||window.opera,(i.test(t)||r.test(t.substr(0,4)))&&(e=!0),(s()||function(e){const t=e||window.navigator.userAgent;return o()||/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t)}()||/R7 Build/.test(window.navigator.userAgent))&&(e=!0),Object(a.a)()&&(e=!0),l()&&(e=!1),function(){return e}}();t.a=c},781:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABLAAAAV4CAMAAACHM9SQAAAAVFBMVEUAAADu7u45OTlmZmbExMTa2tqqqqoeHh739/eMjIyKiooAAAC3t7dRUVHk5OR6enqbm5vPz883NzecnJzFxcUAAAAAAAAAAAAAAAAAAAAAAAD///+BLmiLAAAAG3RSTlN/74+fz9+/h/evrwDHl+ent9ePt89xNyBRYgrhA2luAABGR0lEQVR42uzcu23EQAxAQeaM96Ptv1A7sGUDwl16JDBTxAPJFRT5tOa+RgB8yLj2XPkUj1ptrQIKGHu9D9aZagWUMeabYC25AkoZ80WwzhUAxeyTtzBeAaWN9QzWDICS5h0svQKqm7/B0iugvPk/WCsAClt/wTru7UBp49zB2gFQ2pXfwgEL6GD9BMtCCJQ3TmYYsIAWZmYYsIAWRmb4pAHoYWV4IgR62Bk2QqCHkWEjBJpY4Y0QaGKGExbQxA6/GQWauMLNHWhCrgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC+2IMDAQAAAAAg/9dGUFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUV9uBAAAAAAADI/7URVFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWFnTtKbRCKoih61YgarCa0f3f+8yzmu6BgjM+y1jA2hwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8b90wzM1LvegCoFRd/qGvFu3L87a4B8DpptziEQCnG3OLJgBON+QGfQCcr84N2gAoQC9hAVfR5rqvACjAKGEBVzHnqmcAlKDLVWajQCEqCQu4iluuqAKgDI9ccQuA/erYr5GwgA9o+vsHqnsdAHt9Z06x3yRhAQfrft70ozBKWMCx6ikX7eGHDXMA7NJUb7uqqiWsX/buLMdtGAjCsEiKiwbUBj/y/vcMEsBZx2MH7tJi/98d3CgVaTYApUu7iuIHG6YOAJ6Qa/slaB9sqB0APFlfGUasSoUFQCS49ocgfbCBzV8ADOors4jleR0ZgEKugnM8R4UFwJ6fFFc7VxZ8ATA3OknPtLSbOgAwqa+uUvecQIUFwFhtN5SserAhdQDwRH0lmCsTFRYAQX0liVg9C74ACOorScQaqLAACOorScQa2VEPQFBfaSJWYcEXAEF9JYlYkQoLgKC+kuy2qeyoByCoryS7IoaTLfjyPoRhGJZ0tQzDHILnbQlgTz62K2XE8qeosPI4L7WPrrTbyhT7tISR0QVsz6/tQbF7Rjn2gi8/L/1U2v8osV/C0UYu8OpSe1DonrAetcLK451RdW9s1YXr+sB2ZrdBxFqOWGH5oU7NQqwzy3+AbXinj1jhaAu+/NC7Zsn1HwwtYAO5yiNWPlKFlUN1TcH1M2U8IHeRRyx3lB31eYmlCUWCFqDmnThi9YdY8OVTbHpT4vQQkPJRG7GW/SusnGLbiqvkLEAptbt6wwcbpm5TeYltWxPfhsAd4vsN3u7qaO02FNbSdrDufnMDeF03iiybKRN3q7ByKm0vridmASJZ+JBf3WlHfehL21WcOwASF9lDfsMuFVaIbX/ug9tZgIR3oojlH/u4fJVvQb4MgS34KIpY5d4NiZcdVz8wsgCJpIlY69cV1muPK0YWoDI7RcRavrw0//LjipEFiHgniFjh9th7j3HFyAI0crWPWHmrCuty2HHFyAI0UrulGDzYUDqZMLVjc6kDYGx01uso+g0qLH+Ee1f3OP6xA2z223fPt+5LJ5FTOwfHdyFgLdm+MjOqK6zZtdOgygKsDcX0Ib/yT4X1dl+DfBcCOt5ZRqz494Kv9zkb/MxKyAJs5WoYsaquwhqPfjb4Kc4LAWPJLmINsh31ZynbKd8BsdFZRSwvWvDlTxmvCFmAgo9WEav8rLDeu736XSRkAbaSUcRaBTvq87kOBzkuBOSGYrKOYrFf8BVOdPfqlp4HSQFT3lls/ArtO0fb/o29u8ttHIQCKAwGG1zZxEnm7e5/n6OOlCqZxo7/giGcbwWtqtzCCca0d+CtnJVHbvWFDbbUs6ITrgrAG0NWs/rChi+2g791bAuBXfV680V+ds+EdZVPwrYQGLf9vFOzsrqH3c7gfxZtFIA9NRuXWL2I2OIPi3KIFIij9ds+X17kRL4a0ykAe6r0piVWLeLIV6MCIQvYlbNbllidBPIV6R2Ip9mwxGqlI18xsYCIer36XqtKDPlqkufLQmBfVVh9T4x35KsXeBga2Fmz9rM1kK843gDE1vp1t8w48hUTC4iu0jMv8uMuGSYWcDhnZy+xeHiQiQUcrZm5xOLhQSYWcLxev15i8aYJJhaQhipMLbHIV0wsIClNrUaQr5hYQGraXj1DvuLeZKBIpeUrzrwD+SovX/3oFYCslJivbjx3NwA5KTRfcdsMkKFi89WN5vVfQC4Kzlc3tQKQhZLzFW+mQLHONscUUni+4jgWShVEztndvFt8vvqR3Z8O2MLJN53XMUTyFV8VokxGJLuRRb66E/iqEAUZ5EZ3efyzJl8R3lEsK3dy6O/kK8I7yhXkgU094iaQr7TWof4W9PE/DM/ooCjyv5B0zLrKUbw+d8NXf3Hq0aU3X42tvSzDiXdgOSN3ku/vB+UrbYfTRb3gTNstG1tkLGChQZ7RTZK7jCPyVd2dnJqvH85a5uJyLGBDc0+8v0fPV7ozTi3Xt2cvr5GxgE3NPe3+fpWo6uGi1jNWy0s8Bg0sI1PqhHYacfNVPTj1TzYzi7MNKICROyn395j5yje92kdbywQ2hcCG5p5wfzdeYqmN2lE1ucxiUwisbu7p9verROI7o/bWahnHphCYL8gstlcHcn8kDt849Q6mlhFsCoGVzT3V/j6er/IYV9+MlWfYFAJrm3ui/d15eS6fcTW+ymJTCMw3yBL6WqnZMgtYnVPP5dSyPM8U4qNZuZNsf+/k3eqxRpfZyOKZQny0IJLByHJB3kobFUll5QlueAdmkTXqk4qs0vIot93g5K9CdweWN/eU+/tf9u52O1EYCMBwEsiHHMAK/pv7v889Wwu1q6vgoiaz73MFtudok7fj0MnT9JV5rSAX6O7AAh/yKNs4c1cJ4b01ixRzyKK7Q69WHmdvxqysXmoO9eplh6xgAKW8nMm8v/cyK7Ne3drsxbw7cF9mXxR+8UUqfZi3cV6epTaASp2cyb6/d0k2ZTuzWhHXws4AGu3kTP79fZQt+Wjea5/kHKMNwIqQXUB/b3W16Z+XXKZHgRXNvYT+7mUjKYtFqvMaCo5YwMLmnueizuuiVZGvZvEgJxyxgFXNvYz+3iUV+erylssRC7hjJ1uzTTQ/ZPmas1ppEOSEIxbwvL/uyVrbe3+o6zqE8NE0TVVVwzBE81NWL/rt01c3PrE4YgH/mLC/P5TaEELTNPuq6oZhMI/IJLznkq+uf2IxiwX8zXxU8t7Xp6NSMx+V8sk8m4b3PsMvrgT5xLg7cMswmBK5pCRfzYJMWNoAaLOTR2WWry7DnKrBWAC/BS35anYUEY5YgE4HLfnq/tZ6dadJ4L8TbUG7r1Z8r5DJBkAjl7QdOD5/IoZHAZX2skrK/91byUnJ2+oBXBe05KtZECG7A0odZbG6jLfuQUTI7oBK0WobSYqW7A5o5ZKWfDXphOwOaFXJAraEfHW+tZ7sDug0qslXEy9bSgZAPo5a8tXEJe6EgFaxl1vS3pRmZMkMoJazWvLVxDOKBahVFfGoiRVc4k4IqDVqyVeTwJ0Q0KvN+Empbx8f5f+EQF5iX9auvrsq7oSAXs4qyVcTz+wooFen7F3qZDvWAMjLmPWTUtdreUAhoFirJF99iYkdM4BiXia+xGnRPwV2zACKOasjX32JiWF3QLEuqboABQYbAM1GHfnqS0wMNgBv05mna8t41MRCtWylNwBWCdKYp9tpqjWVbEbTrwV4vngUSWpuazflOO5OxAJWcLbY5VSr5HrEImIBy1WJgaBHJCaxgJcL/KV/TGDFDPBi8SjfRoPlIl8nBF7LWd4578/uxe4yBH6xd0fJbcJQAEUhcWWYaU3pr/a/z04/PE2pwIqjwIt9zhKciWwukt6uXocHmApxmFF1hx0lmxhD7Hb3qUNFvvJlH+OZUHWH9+Qr4f3YZ8JfHbCdr+y7DvNMqLrDpvRY45jrhXwm9CAOFfmq6OIwbq2fuY25A9bzlWnEocbnGJ0DVflKeP+QPrfRAWXJhSfh5n15TQg1+apsEN733dgwdcB2vhLew0SsR5nNAVfN85XwHidi2dcAH7rCKXU0mEXh+wHuzlduGv8j4E4sx59hI18J77FudrcRC4r5ql4vvN92thELPkFyYOSveNXdRiwo5yvhvaXZte7Q2EtvP+Nb8fa6e8UBpXwlvHddwL3ubsSCQr4S3hubbHWHw/OVqcT3H86RC+H+fOU/6VM5mwPH5yt1pVLvbA4cn6+uBm/cN10sWBAgXwnvVWa3ukOEfCW81zj5jCFEvlKEK3y3YEGIfGUqRYVkwYIY+Up4vy25XwaC5CvjoG8aLVgQJV95ZLFgwVLEpxTh3YIFBZHzlfBuwYJ/Rc5X7pizYMFbsfOV8L5pNDYHIuUr46C3jF5qwH3Oc14Q3pcsWBBDMV8J70sRf9NasHg605DXmZVwZcGCAFIuEd7/F/Dws/uweC7nOe/gYsFaOlmwIFy+Ut1XfDOEAuLlK7OoLFjwZfJV7hX3kt4gVZCvvorcxNTBc9gnX51scy96sV8E3uFHn1fIVzt4dbIc6o15B4MfAGum3ITfrzyFlFfYLloU9Q/QwW/27na3URiIwnBswJiVCWHVf+f+73O1kaq2wQVc5WNw3+cWotieYzPzCyTlEV+tszZHlXZY+AU2e4vyRCjP3KR6PiVE/fqzHi9y4b5KTKoHzDxnIL5aN3KKBcysVzPx1bpBPHQHjKxXbPxbEu9GARvrVWTff1Lmrr8noGL59Yr46tl68QwLsLBedcRX2xox5AswsF7Rq2+PxKsG4PXrFfHVPh2XG8C63unRHM0DdulFNyxg3VmP1hG37zOJ5jLAqjdlEF8VsTUxR/EEVCooj159+xnr586nz6hW0BLxVRlrjxo40qJWg7IYNbGXxYqQzB2V8lG3iK+KWKwIydxRJ++0QHxVwmRFSOaOOjktMSm1gM2KkMwdVUq6RXxVxub+wbkWNQpaYNREEaMXIBxsUaFRC8RXxex9R0hvGdTIO2UxKbWMtRn1RFioUqcb9OorZzFyp1UDKhT0BfHVj5h8EsfhFtUZtcSoiVImI3deYaE6NwEW8dXrOYluo8B2XkJ8ZcAgiZGEwJ5/B5NSX87pXtgwUJmvBSHxlQGDJAbmADsKQkZNvJ6jPwawuZsTX9kwSKK1DLBdEDIp9fV6p3txJ6AqrT6jV58BQXfTnoCaDHpHfGWEl8Qzd2CjIGTUhA2tqAiB7aZ9TEq1YBIVIbBRfRBfWeHEHSGwMZaeXn1GBFERAk9L3CO7upkzLzcfqIrTf7wWNcRJ4jtCYK36YDSOFUGSaI4MPCVxP/O63VAjRSpC1KTV1UFv0Xs/NsNwCaH9EEIYhqYZj7pseicidyDLH3K96v10Se3ZRa1y3ZzC1Bxs5WoP93MA3zD+73j8H6RvLml2KhO7OUxHubcMEpE7kOUPtF75Ic1RPxe79Mf+qjXqimbuwLcHLOutLfvmMkfdQ+yS6RLRO0l89wzkNEe4H2xCF3VX5zQZXbR6JxG5A3mzJNPvRf2li3qILlg8fLzpijcN+Mfe3ea2DQNBGBapTxuSE6P9N/e/ZxGkQZPYTpyCEkfr97mCoTV3uCRxKXvXq3ZOWlPq3BZag1hgAV8nWJa3AoztPGkD56PRNtqgF5xAB67Jtl/HqtXqsmaZrLMOkuS85AV+yHiBNeyyWr3qHPKsJ73axYwJ8D3nBdapKWJ87lVD6nJT1zLpFUOjwBWdX/fRnidV0x+bH9hBvWKBhUiSZDWg+F+LqyjLrNd6xQIL+CLiNQqwxmGSgfvSLO8fgwUWAkqSz7xPe5aLuzrDHdSriQUWAmmNmo+2l5N0R8nynr96MTRAHJ3Nt2FWru4uWd7PQjKDhUiyS0NoWK62LVljr3c4RQhccfBoCE3L1bcly/c+GU4RIqLk0BBm33K1VclqJ/3FAgu4ZTH4Lx9nubv+Xpl73M7bXoimq/9f7jF39Z1VR0nH33rHaNsW8JJqXxreJu3E0Kwln/QeM6PA6hcD5IDh1e0oaw/xFSMNiKar+1/+axfd4Mp94S99QOIO3DLVXGAtJ+3O0NzguONA4o5YnlRKZ/WlfmLcZV3GVyTuwOodYY4btt+3yDLccuAQIYKZVEhncWzuJtdF1kV8xYw7sMFFDdmoEbrKcu0y6yMaQmCLjrCLvTl46ZTN4ysaQsSTqvyZjz539NWcyVqSPqEhBLY4R9gbfaibmcfmjeEIGteMIpxnFXJ0yZm/ZZO9z7rG8jFbwEOvMpLDKd8KpqPZXX2cIURg4/ZfRw7SDr4ZLOMrzhAiolaF5PqnfAvYbrfwMGllSwNEM6uM/vHiq39Strmrj4kGhNarjKNJzlzHdDSLr6RzA4QzqpDs8qFWMhg8NUGAhehaldG7fKjVzE7xFRNYiGlQGcdHr1dSP9rEV0xgIah+w45wCbc9+FHKNmeSCNwR06Qieo9GqLKUTVaZBO6IadmuAzkovpQthtDS2AARHVTG8pDjVxdSaxBfsUGIsGYVkSyC5upO2eEMJRuECKtXEWfqlaR5NIivpKcGCGpSEUfqlfTsEF8x0IDAFpWxUK+m1iPEY6ABcT2piIn9QY/4inqF0AYV0T98vepGjweCqFeI7LzBMbpF8T2bvBc7N0BgJxXRNrfl8PPtNvEVVyIjOBXR19/Kr+mUTa4Ao14htqwi8kPXK5f4inqF6NrVP5SdP0Z/h6ExeYCR/OoPe3eX2yoMhGHYv2AQCdBezv73eaRWOo2qJE2CjYf4ffbAMP4wM3h3g+Tg6h+Gqkleyz5+vg/i7XWSQWj4wqjVEl9Rr9CAVTJw7V7A+jO+inIL9Qqo8etzaPdCg5r4SkYDvD8r27lWPxAmr2XCavIGaEDRLmOVt6YnvmJeH9rQ53hYGg3cQ69lAeOZeoU2uIIN1ixvrdOwauJLYH47GuFlK1v/ga0hzVriKz4Poh2zbDU2ecPdOi0DVhOfB9GOQTay1Z/YGtZewaZU4nY0p5ONRm0jsJKNIXTdMn5Zum4KMVoRecv4KhJfoSVdoQart7K3dA7L/NGb6z782K3nfeKrmfgKuKRmKeForguypxSn+cM8wi/hTHwFHFSQTWz9XwjTupzMU/p5Om85hOlYNUF8hQYF2cRXznBi581L3LCmg8dXK/EVmhNli1j1QBiX3mwxh/T8IUzHplTiK7QpyhbuiQOhsmr1bVifPIQpWTUhiWX0aFGUDUKtU1GavMnEDZb4CjiIWKDBmuQ3jc3VDx8ePYQpWTVBfIVWxQINlhQVvcnOhUfiKyWbUomv0K6Yv8GyUlDwpgg3WeIrQLuYvcEapJzgTDGuS3fjK2b1AdVFeZnbO3GPzlxX/mA4EV8BCsTcQUqQS8qzqwdLVhrVrJogvkLTYuaTiZNLx/tt7lpybk/EV4AKMfOrPkoRU2/28pmIrwClorzG7pm4x5PZkQu/4istm1KJr9C8kHesjJX80mJ2NljiK0CjoL7BqrHCyoX/8ZWWVRPEV4AxQXuDNZkqvnP0yKZUQJMuZ4P1KblZbypxVmQyWjalEl8Brxes8f6d0cNcFb2nnxY1s/qIr4AvQ8YGq2vrOSW+Av6iomD5m3dGj3hX9BYtqyaIr4Atq+rjLj/l2JNR7P6mVOIroAiX769nETn4bYYLxFeAQk6eFu42WE1sNJ6Jr4AqdDZYwWhGfAVUYjU2WKrPQfdXTRBfAQWd8zRYvpl6RXwF1BPyNFjnVh5UT3wF1DNlabCGVurVp9xGfAWUtmSpJraNekV8BdQ153jvD4efzvBNzaoJzVUbqMjJM5bSDdZq9PJWbiG+AnbRq5rbZxWfhIivgPqsorEymh/VSW4jvgJ2suoZK5P01iviK0CFSU+DtRitTsRXgArD1gYrvH9vQXz1j717W1YUhoIwzMEQmEJlj5fr/d9zpvR2R0iwsLP4v3eAatukAURc9wYs+5DQqKK+AlRE2+iWCFjew0UXLI36CjhWqzGM3DeaqK8AJZddRzovztPFNFoS9RVwuEVht69tNFFfAVr6PbMywT5DM15E6itATBSYldF8XjvqK0DOrTxgtZ5/EFJfAYLmrwcsyQd2sDTqK+BbpvKA5XcDi/oK0NQV7/b5/UVEfQWoar87jPynkXOnvgJUXcqeqsFt4z7YQS7UV0CuqXBWxumdnPefmqC+Ar6rK9vtc/pV+uPqK7lXNVCFtiRgOT3S0FNfAdrmkt0+nwHrYWnUV4CCnoBFfQXUIo4ErNVPTVBfASICAWvlS6nUV4CMJXdp/cdhwKK+AuoQM09J9f6SRpztDeorQEjIvPXs7tGlvgLqsdjvznLr+Up9BdQjJgLWSW49U18BVQk5AcvbrWfqK6Auy3kDVhcsifoKUBRPG7Cor4D6hK0Bq/MVsKbRkqivAFH3c+72UV8BNYrjtkesGx0FrEh9BdRp3hawLvYRoREgUl/1vM2AXP3GW89+hpFF6qvBlgZApnCyWZnBDjK8n+DS/DAjIG451ayMSH31vMP40wDIFMcTBaxOpL4ahf4xBaoyrwas3kvAumvUVw974YgWkO26GrCCk4ClU1+9/G0A5AorAWvyEbBWPjVxaH31cm8A5OpXTkm1LgKWVH31xLkGYE/E6h3v9vVa9dV/nGsAikz+h5FF6qtZKXMClRqdDyPr1Vc6F5WA6gy+d/u6m6UcWl+1mtMVQGXiaGZuZ2UU66unsQFQYHC82/ewVcfXVy8NgLKIlZiVqT1gidZXnBwFdhgSAcsqD1gq21et8cICPib6DFgP1fpKZx4McKPygNUFO8iQterK3RxgJ4fDyP/Yu4PkxGEgCsOyZNmCIsbULPv+95yERZhUxZZsg+jW/N8RWKgez+pWZjdDvfpK20EONMn0YuR68arz6y2auuQJNMnyWpnV9kpBfcX0M7Bba3v7wiRrFNRXCuYrgaaYXSvjb7JGRX3FgQXs1dTevnFIskJJfcWBBTgCVu640lJfsRAL+O8DVv640lJfsRALMBSw+v7DPZu/JMmoV19FfekTaNaf15Y8QUTi2T1TiJKhqb7iwAKcuicbhtUrXl3vTf4XzNdXSWO/B7RqeFYMyRVk09m7o8ZTlMrmkvqK0h1Yo24o51xSkMWzP3ZaJcnTVl9xrQHQNvXclX6BnC7B7eHnKPVNmfrKyEtCQCPqBayHFOfgtvCnPklt+frqlKw8fQY0onLAeoiXc3B5/nq5JdlAX33FgQUYDlj/mOJlDh/jr3tRw2nopyR1lddXY7Sw2BBoSpWAlddNMfbf4tQlebtcfWViEyvQkiDPcV284mXWzvqKFcnAy0yvXYw8iFmZ+srGKlagKSd5jo/WAlauvtrzEwHQPfUsRk3+yCwT7xICd0oDll/6AmnU4fqKp+qBTwSsGuYXjF4mB4CA9UV5ffWlcwCOGAlYO+orWw/MAs0YCFhV6qu7mwOgYG/fpaWAtb2+Yh0WsEjhUM7iYmR7DtZXPPwM/KRv6nl5MbI5m+orJnOAFVoD1rj0BdKc9frqmuSBi+5Ahs6AdXa/szeUk6uvjhkdgLcHLNdIwMrUVzf5xr1RII+A9ZOd+oprWMBBkYC1o77iVgPwDlcC1o76ilsNwBbapp7bCFg76ivW9wEZCqeem1iMPHm3ZpY7PhIC5VQGrCYWI/djSdvHR0KgmNKA1cJi5NllJPnER0KgnM6A1cBamRSKnhXiIyGwBWtlMg7XV/nncZgkBEopXCtjP2D144Z30JgkBIoQsF5jdnle6NyBjTQO5VgPWCm4ArPQuQMbKZx6th6wJl/xZezBAdjDC4uR7/VV6a/FPXegnNKAZXwx8uwW5P8R8ogqsEJnwDK9GDkFV6ijwgLe6MZiZJm8KxSECgt4n8BaGelHV6qnwgK20jeU85e9u91xEwaiMOxPbBAkkP6c+7/PVmmr3VWbDSYkHuL3uYRIHh0Dc3LkWpm55P7MIyygkMKt5+MGrOyLfi4eYQEFCFj7OrnSn4u2UWAtAta+xqSohQdAzYD1Q3TLs6o/6gBAMfJN1tV5oxoMgGKu7WLkMZkyUfioASiisVbmVjFyFsXy2RRywo0QqMblhmtlojOlFm6EQBGNW89HrJXJ87adANqRgfVUbj0fMGBFZ8pFboRAAQJWpXh11Qs3QqAAAatSvLqywjtCYDUCVoWXgx964UYIVDM9uRh5EZXGZLax3AiBemKLxchxqrUT8MEZAJUOYHegrWfrqy9dipwMgFK2uWLk3KX6811kMAColbk7rhQsXXIjBBTWyqgLWCGpWLrkkTtAwLonOB2tFlT3AQSsO4LT8skaj9yBijecQX8PVu6Smp0AHrkDFW841tzigo5LYe6Sop0AvnIHNhhfUJOS+vojK85J09Il/5YDVDyA0XzPB6koL17Z0iXfNAAbhJe98HKzlTpsl7TNd75pABTWynzlQ5ZXy6NXON8JWIC+Wpl/pD7KK8UhmR15AhZQ4NAB6zf33czS+Jz9k0jAAgooPYDOFHH9Ik+W/0wrlTsBBCzg6jh/XuyDlWfJo/+YVvp2AghYwBa27ulz/ZJF9o9Wk/mLgAW8jV72MZrtpnmxspe8zN58pnO+E7CAilvPzjzGnceY5UGncbiYr5TOdwIWoLAYucx07uJJtrDLOEzmf1TOdwIWoLAYeevYCtHKOvYUumFK5gal852ABSjs7XvExZ+HbgwxWpvlC2tPMYRuHvzF3Kew1YKABaisldlPulyZUhprw37pDABdvX1v5jrflbykAJrjaKErEoQeLGAttQewlYAlFI0Ca6k9gK2cviA0uQNrqT2AZ9MEAhawntoDGE0bCFjAemoPYCP/BErAAsq8Ta3MEQXZjTcADtHbd1ReRLhDA0X0LeW0ErAoRgaKqdt6buX0sfUMrKf2ALZy+th6Bn6yd28pDQRREECT4CMBUYKf2f8+xV+jMAWBqfaes4fbVKb7VrarHcAh0ydgwXa1A/h2mEHAgv28thQjL0LAglBjrcyUUie1MpBp7HWa8mL7orcPQoWPtoesxJ2OlnIg0rgVN2X6Xmw9Q0LAyghY8F8IWGplYBkClloZWIWAJWDBMp6VOiVOamVgPx+mT28frMLWc+RkKQdChY+2p0zfk61niAhYmdJi5ClHPAhYgcobijlHPAhYm5We74OOeOjbipsyfcfbo5yHHPFQuBU3ZPrUykCkM2BNmT69fZBpfFM0ZfoulnIgVPimSMCydwn3SgPWYYZPAQsSnQFryPTp7YOIgJVqvKGYc8SDgLWX01nAgkjjVtyU6VMrA7G+K68pAev2MNcDkLkIWGplYBVHP2/09sEiLoqRBSxYha1nAQtWobcvcxWwICJgZRqfgAzauwQBay/vamUgImAFSs93AQsErHul5/ucV2tQOIAClrUA+KF2AKf8vBGwIFT433pTvh8LWJCpvKMXsAQs+E3jlsmU6VOMDKHGLZMh0/ddjGzvErYTsEKlxchDvvlB4SeZKQHrbOsZIo13XlMClloZCDW+aZgSsNTKwHatEyhgCVhwp3UCFSMLWPCHuk/uUy7on9TK8MXeveUmDANRADWhhSDxSvlk//vsT78qleAoqseZc/Zg68bMXKgUcMo9yekb1MpAlZCRIcvnzSRgQUujgPW+vaUcqBRwCCtLwLraeoY6Eb9xkgQstTLQ1FHAUisDvTiZwRKwoBeTGawWAetagHqjuFAXsKwFQJVwP9NneY/ZWcqBauGmRu8lhYetZ6gVMDTkOH6DgAVtXZ4rmEoKipGhsftzBbeSgWJkWCZW12iSJ3e9fbBMrKGGHHlBrQwsEW6oIcdIkd4+WCLaO3KOL8KfgGUIBKqEe8LK8UX4YesZFgj3hJXii3Cw9Qz14j1hjSWDScCCBcJNYaWYGlWMDO1NDqBiZOjFGufwUrZPrQy0d5QYKjbE/dssVIv2MpPhCetkKQfau5uC1NsHvZi8yQhY0Is13tzL9glYEIE/f1GMDL24yAyKkaEXN2/ubziolYEIDt7c5w2j3j6IYI3GlK+ycWplIIZPVQ1qZaAXOz8SCljQC6txAhb0Yo2phnPZNgELgtj74UvAgl6cHMM5k1oZCMIY1py93j6I4uwczrhayoEoJnOjamWgF58uLLUy0AttWAIWdGPnwhKwoBdPF9b/BKxRwAIX1m9RA9bGp2vhL+GmuMtmPfT2QSAurFeGnaUcCMSF9crB1vM3e3eQ6yYQBAEUM2CwFL7567r/PaNIkaIozm4W0/DeESwZFUN3DYykeWD937wLWDASDyy1MlBGi0l3tTJQhAeWgAVltHRwTFc0q5WBwbR08J6uaEkv3xMwzAPrkic0s61nGE2Lm+o/W209w2ha3JrzUROwYDhNhFArA1W0xM3PevughiMd7NPlqJWBAc3pYZsu5qVWBgY0x+SogAVFbFblPnhZyoEhxVzDv/T2wZj2dLBOl6K3Dwb18JlQMTJU8RUFMwIWFLFKEnr7oIrF+snHX8TRHgzoh3cftTJQxRmz7n9ZbD3DsF5OawQsqKJJEwIWVDEnJrEELCjCxTCKkaGMh1aCP5paGRjad6J1VK0M1LAktnP09kENp0ihVgaqeFv01dsHVczxnVDAgir2RO2ogAU1fKWPvfo+oYAF41vSyTmV9kxixAMGd6p/+l2M7DQPhtf8UX95WsqBAjb/VFvPUMYjye1r/NTKQA2LBToBC6o4k9tPNghYUMSR20csAQvK2G8fsbwVQxnr3SPWrFYGynjm5hFrjWl/qKIlyY1XoJutZ6hj29PPMZVj6xkqWZPcd6NQrQyUcqaj91TLJmBBKUc6ehQ7d//J3h0kNwoDURhGAgmRwjYulu/+95xy4ixInIynBjDd+r8TJAt3PbXUTSZgAbYUVdt3j2JbBWDLKKnSH+654u4dYNNFkqrcuDkwlANY0xdJNb53j4GpZ8CcpDoPhR0BC7Bnkmq8KZxFwALs6SXVd1MYCwELsChpXXNjQCBgASZNWlcxkDhGsVYGMKmXamtjzVXeiwIuJK3s2hxbLGIoBzBq0E09r7FikJh6BozqiyTV03g/i4AF2DXqppb3o6MIWIBhrVZXDrt+NIuABZh21p3/2/5ZBCzAtixVUrEGqeql0IADfZGqqFinajp1gGNXSRVUrFORxFAOYFwrSe4r1ke9YuoZsC5JkvOK1RYRsAAPJt24rliDRMACXFi03V2+x5olAhbgRNaCuymdrJvKtugAXn2JWN4moUef/xZQq6ytdC/fjxXPeue0OwfUJ+qTux/3KeiOoRzAiU6bKS/9ec9FH5h6BtyI+sbDt3T6Ue8IWIArnZZcHAs/j4MELMCXqO+sX6vNuiNgAc50+sJ6yIpJHwhYgDtR31kOWctuO2tlAF9GbSycmt20SUvVfMYMqENftLUuNj86/uUgU8/AgWRtruRmB7logalnwJ++aHvhrdnYJWiBgAW4NOsRWyWrTVoiYAFOJT1kp2Q9LFemH2cA+EmrnYS32KyuH5I2NjUADqPTXsLaN4Z9LnqEN6OAV33RftKbnbMgQznAAc3aU+jaZgXxl3BFxx1wLGlfYTz9b7VK+gVPGgDHWj3hMDmrzWf9jdVhSAAHGCl8KE3/XLTidC36HR13wLk+6DVKypf45N94ea5YcSAEvGv1QiWNU3tqfhRPw3gNepqHPc8ADncoXAjpOuZpGNq7YZjy2KWglwkv/1wZgEMdCo+MtX3AQf1h745yE4aBIIBaQEiQICmif77/PSu1Us+Q2X3vECN7dp1cJy6EkOI+cSGEFMvEhBBCXLaJlVEIcUz+LQM4tRPsNpyFr/bB2a375M8xgJNTYymwIIdtrF/7AALYxlJgQY7vyWsAERTvfpMDOS7dn0Er3CHIq/eo0MYoRHnMxhTuEKbxqFBeQZy2ibUZEEKerssNfvMMiXp+HMuAECK1XMeSVxCqYWLJK4jVboFUXkGwZol1G0CwVoklryBco8SSVxCvTWLJKyigyaxQXkEJLRLLfBCqqP9KR15BHdVfQssrqKR2YnnvDLV8ZlnbdQC1vKquN/heHxRUdCFrl1dQ0fqe9dzWAZRUr3o3HoS6HrV+/6Vuh9JKFVnqKyhufc4qnuorKO9T41q4fQ2gvhLXQttX0EX+tNB1EPq4Zh+yTAehlctt5no7XkEzj9RDlrYdGgo9ZC3admgpsMnajgE0lTYuNByEzqLuhYvhIDQXU74r24Ex7hGR5TYIP+zd0W6DIACG0VmEUgLW9pb3f8/d7GJZss2t2mpyzkN8gV8SOci90LdB4CDJMl4Bn51i36tBroAvwj6TNfjpIHCMZMkV8J2wry0ryhVwjPnd1A785lR38S5rlCtgicvUXysnz0SBpdqY+3LugsBLnS+xL+JwBezA89esbLkC/i2Mz2tWjsXhCjhAs9QKWEeoU99SrkGtgNWcLrfcNxGT3QpYXZtjXjlWjlbAdtp8G1YarZJYAZs7h3SbHmpVLfc3gGc5h7nGv2ZrmMb5qlXAa7RQ0hin3H+ShzjW+dpcAYFduLdwLSWlVMcPKaW5lNDuOgUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwzh4cCAAAAAAA+b82gqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqsF8HuQkDQRQF24bBBhlCwrLvf88sQNgWICSHQYlSdYLZzNNvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKC+Lt6i6wLgB9qhyczDrnZMVqXP7MsuABY69XnWtFFRV/JiMLOAZU551e+jnkNelQBYoM2JJqrZ5sQp4H8bymgf3LMvoyHOjjm1ilc4ltHHOLBGh1ikm70f/rAy+3bcs8rbs+wzpzbxCusc7S6tyZlu4Rp0VvJaXftA3BCs5+oHq7wnWG3OfAkWv8I2H2nKZh4SwXqufrDWb1pYgvXN3rkt2wnCADSAXNyDt+6+5f//s/fBFGJoKx07zXo7CoiZzToIiMoTmfEK87YlqQpLZrCw6jGsUcKiPTkDKizlEcx4jSnLBlVYMuOFFRMZDB8mrBnPB1VYyjOYUSLDd1RYMuOFBVs5Zuw4YcHHcmwCFZbyDERhlZ+rCquD8cKCzfw4ZGGgsCCUf1kqLOUhiMIqI7sqrB7GCwvifKxmnRzAUGGBzd4YHyyosJSnMGMHC3xBhSUzWFiUccKiqLCUxyAKq/zYVFgdqLBUWArDcGHRhc4qrA5UWCoshTBOWD784DBI2OCCuM2hdXQP0zSFfbN3Ciu6+UuxOWxLd5ZlDiHM7vesa7c5hL15tWXe2XJpupC/hGJ2Uk3n8DXd0i2sZtzzNOXd/S1hxR9hUGEp45mZwfWAZwLbguL+1TxAcdlgwUyuW1hvJOy0bYRzrnS8Lm9nKvX7hq/Si7mD4W7CTamcssARd5+w4F8kaXVzpEQabtku9G5xcj9Lw/yKsPBEZ3h7hbXiGWNBUX5LWJyxprawyhQ7bcueWX8qC8smfn7STnWxb0E578RWQxZWDDT3atlbZJRFSiBJxZST/XVhvasyBghLCq8srIBnkvpKuUFYkGRhxY+IlbCsxxbGdQgrGjxzkBbNrMTnldOqyhS7hbUYboFHzMicYgRCSI2ktr6WWXqFxQc+bUOExYf3sLKwNiRsoCg3CGsShRVL1540UoYgC4uKwJzkYle2WFY51AK0UFlYLmHNEWldeGMVndd4C5QtYU3aZGExziu8xwiLD6/lhMXUM4Ci3CGsII1hnXyFJBfHJAnrzf72rRGLrecQ2nnWzhmItngPvi40fEXnXLMubNgkvX9BWDZhk3mUsA4mvFEQlsczuq+fcpOwMha2lrDOCYivWCZOWM02t1S+koudUSZfBEPmDZ49JfiK9vNk12AShSVHKI0RFk++FlagegNFuUdYKxYsFVYN6ytKvhSW4SYIoxEkIimH4vhgdJCRI0VGAsJaXIMSsrAOZBkvLIq7EpbTCUJliLC2RmORhGVRYrsQVmYfsCYUWG5YuC/mlgmkqF7JBvxzYc34HGH5C2FZoxOEyghhuVT5QBaWQYkUWWHN7ATh0t9GZuzBDRAWvTtrutNavEFY5kHCQscLy+sEodKNPDH2nW339YOcLKwZKWn1PiElcMKyiR3j8aTQ7CLAMhvaRrgWlaYcDsNVQhaWIXmlU3u7T+i3CBA3ejBw3cdk1tQrLLbiZjUDhUXDuyIls8IKOkGoDH+XcIVOYRmazcWvWdaqY9EUlmHHNlx78ea71Zzn9uKv5aeqCcGga8WXqfZHCl9PuQnb/ULTXIHmTCMSqXVNS4QsCssgwbtYyhgjLBpeTw9zwlp0glAZLqwpdgprwzOZe8unLSyaaOGak4lM1T+QY/UUO10TFXuCYRb2Ac/Y9qnUKMhYZj5wL0kbcrNHv7CoCNKrhH6csGh4Mw1vW1g0VgYU5XZhpR3gQlh+39wXykSV9F7i2hTWfPEGoaHTlYWjzjKz/TRfCVEKBrMMjHEQ8ebBrUYPlYImtsYfu4W1IzLfrw8DhCWH17WFdegEoTJWWGaPcMZdrdjmV/x42qZrYVnDyY52Hya2Nl76dIKjZ+RgBCY34yBiwsRFIp7OpErH6Eha0yssz9vejxOWHF4qrKAThMroHpaZLN9uA8hG4E5RYRk6EETY2WmliIXUuB3LdtR2qBByJywk1kH4EhwLK1K7ReTTul5hJV5KdoCwxPCGlrAWpFpVlCFjWIFrQoYXSwKKwUKuheWvnhUyFmZHSFXHbeaH1idhfkrIzRvVV819w0JwhJUmphF1TNgEYcWrzqMfIqw6QFkQljE6QagMEhbliF3PVZm0Lv7cUTck3lc0obx2dOa9EnqFJeeWmnvALnZyyVrzkPuE5WgcKPsQYfEdYSoshgMUZZSw8GgLK/K/+nzRalbiIXlR54pduHpZmbBElvL7uUPV3DN2EYBGxnP1kYXFS28ZIKzeAFn+TUpFuXGL5Ex1ElrCWi96QuHiKqZOfqkSg128HiSsqV9Y4UpYThQWF92CfZ6wdIJQuUVYgd3eU9hkXBSW6xWWh98V1vbvC2v6T4Slb+Qog7eX8R3COi6EsHX3sN61sP69R0LtYWkPSyGMFxY1RZSE1T+G5S+Fhcv/M4a1S2Pi+2+MYcV/YAxr1TEs5X5hZSzssrCyJDNeWKn698utZ3+xxAcJa8dCfrFYoOViZMImCGu5KmN7iLASkryKcoOw+OYrC2vn/s/L67B2YqzIi/AD8DxIWHN1hGW5ex3WDpTjIcLyWddhKX9NWIcsrIUfV3XkVC0s90a2YNr6/w1h2f7ORBTvXBYWGH7y1uJThAUrkssoShe/1RC9LKyY2GZj8IRtCIv8hZltcv7fEBYk0tnkuO1dwoNXwfEcYdlEX9FWlAGD7t3CYqTTt1tDNPxUYWJa9ESa+qOENTGp5zpEmX0l+Pi93RrQkbo9R1jw1qlCZfRnvvofCWGr5uxbXx19NYUFjrY5riLGth9B07N6WK7dl7CN7pRjvgtrPXYLyyLhfQr9k4QFH3WqUBkkrGWq9CMJKyakbS8CQNyZraSIsC57Gkszv6PTTs8SFqR6Qz1uA7uEhGmLAGBDQklY1P409D/KeJawotEXCpX7hLVOPzgMUlyHsCDwG4vLe7qD79scDo+Xs273SLAPE1agcdjdsswHEkhSgjF/vqd7+lrGw4QFTvd0V24QloiBHmFF01EQKyybuG3XLUpMDxt0h2i6IxHTv/nVnN8RFrzxzBsUZYSwsiCsclrA8cKCGYVRexZjnyYsORSlC/m+QVjuHxEWeDzjQFHuF5axgrB6zRKAEZbwJVWPlyxPW9bAvJ4j3d3vCwvyPyIsm3SjZGW0sDboFBbk32qlrvkc9aIfgeAJj1uH9YWPUpdVvjsjCkt+HE/PEhY43RlLGSysAN3CgiCUwwur/lzV0mes8LyFo4yxuMKX1PbVLAlLdnpyDxMWZERyWFFuFVbaQRAWIYjl8MKCN/81Lc8V+3rgSncmFOzlF4M1yTpZWIKx0usp28t4+E5c9XOqyjhheQuSsCjWcOXIwgLPb0PyNu1in/hqzne2ZpWN44NGdd0jrIKd6jKWx+yH5Us9k04VKoOE5Z24o1zNvDLlyMKKhn90spOpi33mu4QlW1XlFCIU+JQhQqew+DJyfM4Gfr4kfaNOFSp3CyuZI7+isAUmx5LXc8qwAIjCKldg3RDnI5VzJrunvvx8YjtrNk0OWGZPrdYnLL6MbJ+046gno3s6Vag8jOhe4QuvJcKdLNsePrNv/8780uK+V/mDFLNvCV9Cuq4ydDcERVEURVEU5RN7cCAAAAAAAOT/2giqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqsJuHawqDANRAB1tNXkPFMTl/f//tDuFICIiWHrOcgITspibAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBnWivYuv1inI2l2OpdbWg1dHzdYOVT+aUXtOOh51Db1S79fCrYJRmKf0mO9a45yfTkbEoy12C89r9WLflGrlx7kk0H1pykr/wz+wFtutvXKgms+vnAuiZbD6xdFlasT0150G/sne3SmyAQhQVU0MGvpP+8//tsNcUDHAixST/SvDvTaQORhcPuIxq0y1S9n/1dYDVCiC9gFUxvczT2l0v1SbYIITDiZsuwN10T/EOm1tDE+0n6t4AF71/AKti0RdbHXQ5tiAKwpNgi8steACwjdjNvSqwvYFXVPw4s+/6y/DKwYOrjkP0bTHmJLTvxjmfCL2BV1T8OrPojb99swPqsi+DfbQAWlq3vt279Alb1DsD6vNT9Ahbs9cDCR1H5pqdOe5+GrusSS1utum5SVDpRaeFArmV36McjwJLdDwdDlWtCMrBoBMNJYN13O2FI5zWREzVLE5M5Klm5HzWkgaWHXDcklEvXFoDFPWYF0KmUflFnJurMOQcDzxabzqkIsc4Ai0OBnaXH9NGXlhGwKuFEvpFLNUjh/dPNRqwigvJaFkuTB5rtKxLn9mangFxMugGFigKw2nHdTfTk2bihyCywuubn0a2MgAW1YACWbkXarW6dJk1Uk5cNg0F/rjIzmkWRIK4z7FPV5md7tYyAhSaNq0N7h3JQDJHUbYoTraARhxKluLRma4qlPg5Dj1tBzZxwwDLkTM+YubBXwte/HuDJswud8HhaoD4Nk8a0fN71NQErSFkHrHZdkcKDPwdigvQLitGWbqJSNhl8hYB1zTSg7Qqz+g6w5Mg/f7JncU0Da/CP7k8AS4qM28mUfo9l2QAsGfYHpr/dEeRKPjFtkSukDGlcJdsTMgbW1pUCsDiU+pAnw+YhDawWR5mpqgJJRozthAOSIW2T4NgHsHyxal0CFmRE10P1bdIXit/wvs2fAdZ19YDVmZuCQkSS7UFjhDCuGKWrK71WbIP5GXq3v20ErPbWrIm8IUhvNaPOAqsWty647CLPwmUkjZ671z4MrDbntl0DTQydJkm21gPWYNAbuvGIKgiS8imG6Cjj+mn9lNFjoM+ogzGgygwRsOz6CLCukf6tzxNl1iSwKCT6fQwYgdCY/YcdSOFFNc0wRk3tAVgQCxNeAtY3N2WgL9S34TBxjD+TtvpMi4HVeMAyYrsisK3cZ3ZXsdXu18RDye4oHxbgrd1K561U0Y45P2OaSW8X7NuR1gfWzdsF3qYgpcW8x0C9HZIF1laptPve2gS8Mq1C4zUDS5rjeN1tPpdEOF8ul/0aerdDjMPtGLht0SG5Q82wKFeIuWswBPQVrRu1fw4QkSALBAl8Wp+fUhwCV9PuynopU/+os2q/uSN4DKY9qsQSAEtsf+o2hI2+XPZvOY2q6dbIgPZbL/q2oGtsqwhYCIlhV8DIZV1rtfseMYtwoAoOIIMmGZhXYg7EB7Ds5lrpI5hG/XPUoxv1Jb4HandRvQbNAPVd5hzD9PMM5ar6SIuBtaWpPpQzcxAwy1YDHukDIE5ue0yK8CC1xHEAKB3tb3MdAUsMPtqEHzxW+1V5YLVByCnvmFEGVVcC1h7Jyl/BF266F90GNXKkX+MgG86oFq3SqAdfkIoFYZ8CPutg8Xf1+hldpWjr6SODKrknDoC1mVB3fyVENzTah+8G4yRlHG5xzhkxbih9wkFOhthUqPDoUURg3cqTgZvuEbA6nhahPfVH7Q+zRmu9y7PPfczpABYEX6CcCjJxrGD2OM6v0GZdzf4Pp6j7IJJE6YMLRByD1QVWO4pScDMtMsByfOEpti4+GL4AVhdds6kCsDJuF3yso46PtAMiJRtapVE3LAiIlTxVDMecquiG1hWOcXkF6XBy4ioAy7VZAFadCCWBecdgGFjS3zvvDsOh9qwDiS4jytl1YuYWxiiIJe8DS6JB+hy1N0F7l1rIs4+0EFgtQOEyj0/9kEwDWN7jU1upRGn4vB3K4vy/RsBaojW5df8K4TfcAZYMUWBcz1GDO2YRsASWf+jCg8CSYe8MciNUns+SksREqzzqYe8yt7sZfOooda07qo81UABWoM/o9FFxlRYRsPryPiyZbGTCFVu6CRHJ38AzrkjPOCjIAOtwjHf+1IRRAmcGWIxFBSxBxMS8CHRcCPGZW7zUhoZut7k2a4h6FX4tONC6IDDJXcwGy2Y2jirXUBMuf9k9r0vqLLDG5KaYzrXF6ACwBt6PZh4FVhNUO7czCOj1SLNsq0wMhvJocTMlqKo5BGnj9Yrs+95NmiAXFmeqtD6WqqYQWKYqA6ujRmbXPk4dbIAOTiAilk6fdEALlQm4CaTuKfZbxihkuA8spiLiPU4LhI343PtWob6R2QrAIt1SEW5T25yqhkspMha6tQlghRDUDj+as0JlgWV5TyjOqhTrwZdmplOdB1bB7eDCfkggH0Zi8jmeES7TVStnBh8N8zfBrdRR7fQZ0Z5fpYC1B4DVJBsxmTomPwcQuHI552BAG2GgcXQwwQmj1NEMsDRPGRgbx/cUXFuYN3+K4vXAGg/1ee08K9/2lMZNE2ER5PiRTcwoZTrNzLCGFh/oTSYrdBZYbexQJWAImABYSZh0jwJrjgmkKpfsgYGcBdl4UYioV+mqlfrGY1GBOYUpZTzJDLUHAiAhC8ASvLAcXTXmpqAz3LGP8WEHU0YGZhgXGQyGxzrlgIUYztwKcHU8TP0zzz58lbXPUHOzelaMCMQl2xL8MCVqpDiVFp/f553uKWBNqc1Qp4DFX8eiC8DCr/XPPUsIt4blQxcLstFgAI9cFbMn7hWbwI8o6RykbKad7gVgoVPcCFL8CWCdczCvSeN5b3KdEfDla9tngYUYpvguAAv77Zb+g5/NoTA7BSw8ZcCPEsiaSikHTgELqftqYLUErOblwFrZaJGZky0/6nwVVDsPrCYNdPkqYInfCayyg4IM5t68M7DEWWB1vwgsPIe0mvrtXgL1h4G1bB/JLBbXtcCeXS4V6oEV1lAAVm6yzUtWWBPd6Hr9CkuQQa2kbNNDKyz7SyssQ51pCkD5bSus5WXAOudgzssAG/6VFdb+8TidXavPtAKwTrzQaOga7MpB6TxiJy/9+kFdKQFreP4e1shJ0RCnEjydTwOLOVk0yNas0U739J2VqXQPS6OCbrWxle9haaoiYD1zD+t5YJUdnHsHEa8r+R4WwzEPLNzqZyjmgcV59o5vM/9zwJpL73nC1ueRShemTDVxmS0By4WKphGcAFb5V8IMIupngIV8KhvL1sUQAah0umr1c4dtwFjIcNIhAjaJqtPA4k5JN4bngXXOgUzL8PyvhDILLJ4yhFsZWMizr42jWWDhFFD+3wAxR6UdR5rDQJSA5WomSoYTwOKtUigBsCSBUZrngDWT0KRgWsz8Pqze+ecq3oeFF1lhA1LyP1TE3hbSpyUJuvPAmpPtL68B1kkHBrMcyEB6znxPDzFLCSV+ZR/WVAYWrPnIV7gWgRUtqmVq42ffNE1P+ZksLe90LwNrjjdvy/UEsLB1KM6FHsDChuXw+OeApdHxzNbWvGwdpPF3ukv3pTG10x3Y5VUiX/KK/E537fTB/npUnQeWjh/7llimPA2skw5sfDMI3yQEUey773MwtVlgYcMh77O7D6ypaZrr//Rm298ILKQXhz5Ov8j4ZOlAjsNgGdYysBxurB+MZ4FVtYkH4gTfQnb/RHtPAauy1HGKOZYNwOKD64IgwC5nmkJSQ5PMs4TfUNdQ1XlgVU0USgvafxpYJx3IjAzsmsUvP0u4ELAwZfwsYQFYKqiZP/Ym1iPAwuN9MnjqVUJ9X3rtSq+uFBcgURjB9WRWUwIWFmJWO8yJdTUngaWFCzK8/a6ntzU0DqjwysDCHZMysGQQpnqMBU6LCVqGo0aiXQOYqUCQwWlMmWb5NQU9brrn9JEmls6cAhYaaWTwLkX5ImDBAV43kXZAMtAD+XDlVIT4QqJXviIWX8UTPNTha9CgEgiFPLCqMDQ+9v84fAhYiNV+U0mrxlO8PV4NqztkhFc6G0517Nzth+3WintjXxlY1XLsBdf7ZnErTgELb15QutKqNRhK6n1Y24DlvHePRoGT8v4QwB1gIR1Er/Ga4SDkSLbv7J3hckQwFIUTkbBGGO2+/7O2tPqVK+5kdHZqOL92YpNcB58fOJnNJA+Lvf49jd8x5J05iwBtRmCS6OtEHpZf+dMuwc0mO2QCCyNKNxbc4v9fACtjAmmDkofVTA4PPPRe52HFL7O6RdRC6z5VrQp+cur3HuSlgIX1pZuuPzu1XlIasFBcRlTS60k71ledbEXcJlAoVGAxMupMHrCIKkZhM3GU8mTiKKp+xkoDi994kvgwzEvbSBxF1CwMKc1e4miRShwtF4mjVr4gzHjIFmUesMAeottxYGVOQH7tbIOvlBdtZ14BrOkCQF3FLVlJHMXHaBRg0cfak64f+jpg8Zwd1Y3ImhbBb8hLdwmAm6MCVWBx+qDWZAJLstI6TvrUn2qZ6U4crwqs7WTwaFDSTHaGeqiZPklDHjZxHKp2L9O93NjGeAyXByzF/+PAypsA83BPKOUiwDIhEYAfbTLTPXD7IRhTeUoYzr1C+8uAhfphtitUS/J82+/DZmtjhFiWZo5eVoElR669M7nAYmZ2RQJLlievEKrpdGAxouaJtI1Vc7plzdKQQRpSjL1wC/EVUN1urJozsG3ZK1jqywSWZsRxYOVPIG1Aey4CLG69detWXvl6CSw2tVb0UYBFpTZc+GvCPLm+afoNt+LY/rbZqqzB1zRNNBli5HjoqFWOkvfK4z/HxIhK5dgm6Vsk63E7hhTMqRw2YVBU6jvkv2LEyybAhoxTFWDhv8lQ8mDqlV4zuu/WafS48rpO/1oTsG7dunUD6wy6gfXBTh2QAAAAAAj6/7odgY4QhLUhLBDWhrBAWBvCAmFtCAuEtSEsENaGsIidOiYCAISBANYfOoN/tQjAQHuXiAjCWkNY8DlJbjFPJ10AAAAAAAAAAAAAAAAAjz04EAAAAAAA8n9tBFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVhT04EAAAAAAA8n9tBFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVad9ebhuIYSiKcv/W+sz0X2iAxDEMu4BQyDlFXIgUCAAA8D+MAjjCqKsAjnDVLoAj7JoFcIRZqwCOsCq27sARRiqWWMARdipmQuAIKxUzIXCCkVTinxA4wEwquT2xgPZGkkpssYD+5iNYcZ4DNLfzEyxDIdDduB/BMhQC3a08g+WnEGht5ltFsYDmZn5UFAvobeah8mvZvAMNjZXPYOV2Bg20c915qryYHllAK2PlRSWSBfQ05p1XlTdraxbQwNgrbyqf1tyXagF/Zlx7rnz6AsK3+OQ/Kq5iAAAAAElFTkSuQmCC"},782:function(e,t,n){e.exports=function(){return n(272)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://assets.metaverseplus2.xyz/hubs/",r(r.s=0)}([function(e,t){self.onmessage=e=>{try{const t=function(e){let t=0;const r=[];let n=null;const o=[],s=[];let a=0;if(71!==e[0]||73!==e[1]||70!==e[2]||56!==e[3]||57!==e[4]||97!==e[5])throw new Error("parseGIF: no GIF89a");{t+=13+ +!!(128&e[10])*Math.pow(2,1+(7&e[10]))*3;const u=e.subarray(0,t);for(;e[t]&&59!==e[t];){const l=t,f=e[t];if(33===f){const o=e[++t];if(-1===[1,254,249,255].indexOf(o))throw new Error("parseGIF: unknown label");for(249===o&&r.push(10*(e[t+3]+(e[t+4]<<8))),255===o&&(a=e[t+15]+(e[t+16]<<8));e[++t];)t+=e[t];249===o&&(n=e.subarray(l,t+1),s.push(n[3]>>2&7))}else{if(44!==f)throw new Error("parseGIF: unknown blockId");{for(t+=9,t+=1+ +!!(128&e[t])*(3*Math.pow(2,1+(7&e[t])));e[++t];)t+=e[t];const r=e.subarray(l,t+1);o.push(URL.createObjectURL(new Blob([u,n,r])))}}t++}}return{delayTimes:r,loopCnt:a,frames:o,disposals:s}}(new Uint8Array(e.data.payload));self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}}]);\n//# sourceMappingURL=gifparsing.worker-86e9055e75cce6cfb27b.js.map',"/assets/js/gifparsing.worker-86e9055e75cce6cfb27b.js")}},783:function(e,t,n){e.exports=n.p+"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb"},785:function(e,t,n){e.exports={"back-button":"BackButton__back-button__1jBAH",backButton:"BackButton__back-button__1jBAH"}},786:function(e,t,n){e.exports={"avatar-editor":"avatar-editor__avatar-editor__xtJ6P",avatarEditor:"avatar-editor__avatar-editor__xtJ6P","no-default-button-style":"avatar-editor__no-default-button-style__eEjWl",noDefaultButtonStyle:"avatar-editor__no-default-button-style__eEjWl"}},789:function(e,t,n){e.exports={textarea:"TextAreaInput__textarea__1PCmO"}},791:function(e,t,n){e.exports=n.p+"assets/images/emoji-picker-16-d27c8f382eaeeb7b717d978dd41fee51.png"},792:function(e,t,n){e.exports=n.p+"assets/images/emoji-picker-20-fa7761ef913857542662d12fbc895cfa.png"},793:function(e,t,n){e.exports=n.p+"assets/images/emoji-picker-32-b6a14672513ad3d8041ea933cffd0c8e.png"},794:function(e,t,n){e.exports=n.p+"assets/images/emoji-picker-64-2d98b1622032d9951a077670afb53f1d.png"},797:function(e,t,n){e.exports={"invite-popover":"InvitePopover__invite-popover__13s5V",invitePopover:"InvitePopover__invite-popover__13s5V"}},799:function(e,t,n){e.exports={"copy-button":"CopyableTextInputField__copy-button__2P-A4",copyButton:"CopyableTextInputField__copy-button__2P-A4"}},8:function(e,t,n){"use strict";n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return E})),n.d(t,"f",(function(){return x})),n.d(t,"a",(function(){return k})),n.d(t,"g",(function(){return C})),n.d(t,"e",(function(){return P})),n.d(t,"b",(function(){return R})),n.d(t,"h",(function(){return D})),n.d(t,"i",(function(){return I})),n.d(t,"o",(function(){return H})),n.d(t,"p",(function(){return N})),n.d(t,"d",(function(){return F})),n.d(t,"l",(function(){return V})),n.d(t,"c",(function(){return B})),n.d(t,"q",(function(){return U})),n.d(t,"r",(function(){return z}));var a=n(87);const i=["able","absolute","acceptable","acclaimed","accomplished","accurate","aching","acrobatic","adorable","adventurous","basic","belated","beloved","calm","candid","capital","carefree","caring","cautious","celebrated","charming","daring","darling","dearest","each","eager","early","earnest","easy","easygoing","ecstatic","edible","fabulous","fair","faithful","familiar","famous","fancy","fantastic","far","generous","gentle","genuine","giant","handmade","handsome","handy","happy","icy","ideal","identical","keen","lasting","lavish","magnificent","majestic","mammoth","marvelous","natural","obedient","palatable","parched","passionate","pastel","peaceful","perfect","perfumed","quaint","qualified","radiant","rapid","rare","safe","sandy","satisfied","scaly","scarce","scared","scary","scented","scientific","secret","sentimental","talkative","tangible","tart","tasty","tattered","teeming","ultimate","uncommon","unconscious","understated","warm","active","adept","admirable","admired","adorable","adored","advanced","affectionate","beneficial","best","better","big","cheerful","cheery","chief","chilly","classic","clean","clear","clever","decent","decisive","deep","defiant","definitive","delectable","delicious","elaborate","elastic","elated","elegant","elementary","elliptical","fast","favorable","favorite","fearless","gifted","glamorous","gleaming","glittering","harmonious","imaginative","immense","jealous","kind","leafy","legal","mature","mean","nautical","neat","necessary","needy","oddball","offbeat","periodic","perky","personal","pertinent","petty","quarterly","ready","real","realistic","reasonable","regal","serene","shabby","sharp","shiny","showy","shy","silky","tempting","tense","terrific","testy","thankful","uniform","unique","vast","weary","wee","welcome","agile","alarmed","alert","alive","bleak","blissful","blushing","coarse","colorful","colossal","comfortable","compassionate","complete","delightful","dense","dependable","dependent","descriptive","detailed","determined","devoted","different","eminent","emotional","enchanted","enchanting","energetic","enormous","fine","finished","firm","firsthand","fixed","flashy","flawless","glorious","glossy","golden","good","gorgeous","graceful","healthy","heartfelt","hearty","helpful","impartial","impressive","jolly","jovial","lighthearted","likable","lined","mellow","melodic","memorable","mild","new","opulent","playful","pleasant","pleasing","plump","plush","polished","polite","reliable","relieved","remarkable","remote","respectful","responsible","simple","simplistic","sizzling","sleepy","slight","slim","smart","smooth","snappy","snoopy","thirsty","this","thorough","those","thoughtful","united","vibrant","vicious","wellmade","whimsical","whirlwind","zesty","amazing","ambitious","ample","amused","amusing","ancient","angelic","antique","bold","bossy","both","bouncy","bountiful","complex","conscious","considerate","constant","content","conventional","cooked","cool","cooperative","diligent","dimwitted","direct","discrete","envious","essential","ethical","euphoric","flippant","fluffy","flustered","focused","fond","gracious","grand","grandiose","granular","grateful","grave","great","hidden","high","hilarious","homely","incomparable","incredible","infamous","joyful","lively","loathsome","lonely","long","mindless","miniature","minor","misty","next","nice","nifty","nimble","orderly","organic","ornate","popular","posh","positive","potable","powerful","powerless","precious","present","prestigious","quick","rewarding","rich","right","sociable","soft","solid","some","sophisticated","soulful","sparkling","spectacular","speedy","spicy","spiffy","spirited","spiteful","splendid","spotless","spry","thrifty","tidy","tight","timely","tinted","unruly","untimely","violet","wicked","wide","wild","willing","winding","windy","zigzag","apprehensive","appropriate","artistic","assured","astonishing","bright","brilliant","bronze","coordinated","courageous","courteous","crafty","crazy","creamy","creative","crisp","distant","distinct","downright","evergreen","everlasting","every","evil","excellent","excitable","exemplary","exhausted","forthright","fortunate","fragrant","frank","free","frequent","fresh","friendly","frightened","frigid","gripping","grounded","honest","honorable","honored","hopeful","hospitable","hot","huge","infatuated","infinite","informal","insistent","instructive","juicy","jumbo","knowing","knowledgeable","longterm","loud","lovable","loving","modern","modest","monumental","normal","notable","outgoing","precious","pretty","prickly","primary","pristine","private","prize","productive","profitable","quiet","quintessential","roasted","robust","square","squiggly","stable","staid","starry","steel","stimulating","striking","striped","strong","studious","stunning","tough","trained","treasured","tremendous","triangular","tricky","unused","unusual","upbeat","virtual","witty","wonderful","wooden","worldly","youthful","attached","attentive","attractive","austere","authentic","automatic","aware","awesome","bubbly","bustling","busy","buttery","cuddly","cultured","curly","curvy","cute","cylindrical","downright","dramatic","excited","exciting","exotic","experienced","expert","frosty","fruitful","full","fumbling","funny","fussy","growing","grown","gummy","humble","humongous","hungry","intelligent","interesting","known","kooky","loyal","lucky","luminous","lustrous","luxurious","multicolored","mysterious","noteworthy","numb","nutritious","outstanding","overjoyed","proper","proud","prudent","punctual","puny","pure","puzzled","puzzling","quirky","stupendous","sturdy","stylish","subdued","subtle","sunny","super","superb","supportive","surprised","sweet","swift","sympathetic","trivial","trusting","trustworthy","trusty","truthful","twin","usable","used","useful","utilized","vital","vivid","worried","worthwhile","worthy","writhing","wry","yummy","chocolate","crimson","cyan","fuchsia","gold","honeydew","lime","linen","magenta","olive","peru","salmon","seashell","sienna","snow","thistle","tomato","transparent","turquoise","violet"],r=["space","land","world","universe","plane","room","nation","plaza","gathering","meetup","get together","conclave","party","domain","dominion","realm","square","commons","park","cosmos","sphere","terrain","spot","zone","area","tract","turf","place","territory","volume","camp","picnic","outing","vacation","adventure","exploration","outing","walkabout","safari","venture","roundtable","barbecue","celebration","festivity","gala","shindig","social","convention","assembly","congregation","rendezvous","huddle","meet","soiree"];function o(){const e=e=>{const t=e[Math.floor(Math.random()*e.length)];return t.charAt(0).toUpperCase()+t.slice(1)};return"".concat(e(i)," ").concat(e(i)," ").concat(e(r))}var s=n(4),l=n(13),c=n(30);function d(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){d(r,a,i,o,s,"next",e)}function s(e){d(r,a,i,o,s,"throw",e)}o(void 0)}))}}function h(){return!!s.a.RETICULUM_SERVER}function p(){return h()&&document.location.host!==s.a.RETICULUM_SERVER}function m(e,t,n){let a;if(e||(e=p()?new URLSearchParams(location.search).get("hub_id"):location.pathname.split("/")[1]),p())a=new URL("/hub.html",location.href),a.searchParams.set("hub_id",e);else{const t=n?"/".concat(n):"";a=new URL("/".concat(e).concat(t),location.href)}for(const e in t)t.hasOwnProperty(e)&&a.searchParams.set(e,t[e]);return a}const f=document.createElement("a");let g,v=null,b=!1;function y(e,t=!1,n=null,a=null){return n||h()?"https://".concat(n||s.a.RETICULUM_SERVER).concat(a?":".concat(a):"").concat(e):t?(f.href=e,f.href):e}function E(){return w.apply(this,arguments)}function w(){return(w=u((function*(){v||(!b&&document.querySelector("meta[name='ret:version']")?v={version:document.querySelector("meta[name='ret:version']").getAttribute("value"),pool:document.querySelector("meta[name='ret:pool']").getAttribute("value"),phx_host:document.querySelector("meta[name='ret:phx_host']").getAttribute("value")}:yield fetch(y("/api/v1/meta")).then(function(){var e=u((function*(e){v=yield e.json()}));return function(t){return e.apply(this,arguments)}}()));const e=new URLSearchParams(location.search).get("phx_host");return e&&(v.phx_host=e),v}))).apply(this,arguments)}function _(){return S.apply(this,arguments)}function S(){return(S=u((function*(){const e=new URLSearchParams(location.search);let t=e.get("phx_host");const n=yield E();t=t||s.a.RETICULUM_SOCKET_SERVER||n.phx_host;const a=e.get("phx_port")||(h()?new URL("".concat(document.location.protocol,"//").concat(s.a.RETICULUM_SERVER)).port:"443");g={host:t,port:a}}))).apply(this,arguments)}function x(e,t=!1){if(!g)return console.warn("Cannot call getDirectReticulumFetchUrl before connectToReticulum. Returning non-direct url."),y(e,t);const{host:n,port:a}=g;return y(e,t,n,a)}function A(){return M.apply(this,arguments)}function M(){return(M=u((function*(){b=!0,v=null}))).apply(this,arguments)}function k(){return O.apply(this,arguments)}function O(){return(O=u((function*(e=!1,t=null,n=a.b){const i=new URLSearchParams(location.search),r=function(){var e=u((function*(){yield _();const{host:e,port:t}=g,n=i.get("phx_protocol")||s.a.RETICULUM_SOCKET_PROTOCOL||("https:"===document.location.protocol?"wss:":"ws:");return"".concat(n,"//").concat(e).concat(t?":".concat(t):"")}));return function(){return e.apply(this,arguments)}}(),o=yield r();console.log("Phoenix Socket URL: ".concat(o));const l={};e&&(l.logger=(e,t,n)=>{console.log("".concat(e,": ").concat(t),n)}),t&&(l.params=t);const c=new n("".concat(o,"/socket"),l);return c.connect(),c.onError(u((function*(){A();const e=new URL(c.endPoint).pathname,t=yield r(),n="".concat(t).concat(e);console.log("Socket error, changed endpoint to ".concat(n)),c.endPoint=n}))),c}))).apply(this,arguments)}function C(e){const t=new URL(e);return y(t.pathname.replace(".png",".html")+t.search,!0)}function P(e,t="GET",n){const{token:a}=window.APP.store.state.credentials,i=y(e),r={headers:{"content-type":"application/json"},method:t};return a&&(r.headers.authorization="bearer ".concat(a)),n&&(r.body=JSON.stringify(n)),fetch(i,r).then(function(){var e=u((function*(e){const t=yield e.text();try{return JSON.parse(t)}catch(e){return t}}));return function(t){return e.apply(this,arguments)}}())}function R(e,t,n){return T.apply(this,arguments)}function T(){return(T=u((function*(e,t,n){const a=y("/api/v1/hubs"),i={hub:{name:e||o()}};t&&(i.hub.scene_id=t);const r={"content-type":"application/json"},s=new c.a;s.state&&s.state.credentials.token&&(r.authorization="bearer ".concat(s.state.credentials.token));let l=yield fetch(a,{body:JSON.stringify(i),headers:r,method:"POST"}).then(e=>e.json());"invalid_token"===l.error&&(s.update({credentials:{token:null,email:null}}),delete r.authorization,l=yield fetch(a,{body:JSON.stringify(i),headers:r,method:"POST"}).then(e=>e.json()));const d=l;let u=d.url;const h=d.creator_assignment_token;if(h){s.update({creatorAssignmentTokens:[{hubId:d.hub_id,creatorAssignmentToken:h}]});const e=d.embed_token;e&&s.update({embedTokens:[{hubId:d.hub_id,embedToken:e}]})}p()&&(u="/hub.html?hub_id=".concat(d.hub_id)),n?document.location.replace(u):document.location=u}))).apply(this,arguments)}function j(e,t){const n=(Object.entries(e||{}).find(([e])=>e===t)||[])[1];return n&&n.metas&&n.metas[0]||{}}function D(e,t){return(j(e,t)||{}).context||{}}function I(e,t){return(j(e,t)||{}).profile||{}}function L(e,t){const n=["phx_close","phx_error","phx_reply","presence_state","presence_diff"];for(let i=0,r=e.bindings.length;i<r;i++){const r=e.bindings[i];(a=r.event).startsWith("chan_reply_")||n.includes(a)||t.bindings.push(r)}var a;t.bindingRef=e.bindingRef}function H(e,t,n){const a=t.channel(e.topic,n||e.params);L(e,a);for(let t=0,n=e.pushBuffer.length;t<n;t++){const n=e.pushBuffer[t];a.push(n.event,n.payload,n.timeout)}const i=e.joinPush,r=a.join();for(let e=0,t=i.recHooks.length;e<t;e++){const t=i.recHooks[e];r.receive(t.status,t.callback)}return new Promise(t=>{r.receive("ok",()=>{e.bindings=[],t(a)})})}function N(e,t){return L(e,t),new Promise((n,a)=>{t.join().receive("ok",t=>{e.leave(),e.bindings=[],n(t)}).receive("error",e=>{t.leave(),a(e)})})}function F(e){const t=[];for(const n of Object.values(e))for(const e of n.metas)e.profile&&e.profile.discordBridges&&Array.prototype.push.apply(t,e.profile.discordBridges.map(e=>e.channel.name));return t}function V(e){for(const t of Object.values(e))for(const e of t.metas)if(e.context&&e.context.embed)return!0;return!1}function B({onJoin:e,onLeave:t,onChange:n}){return{rawOnJoin:(t,n,a)=>{void 0===n&&e(t,a.metas[0])},rawOnLeave:(e,a,i)=>{0===a.metas.length?t(e,i.metas[0]):n(e,i.metas[i.metas.length-1],a.metas[a.metas.length-1])}}}function U(e){return{onJoin:(t,n)=>{e.trigger("hub:join",{key:t,meta:n})},onLeave:(t,n)=>{e.trigger("hub:leave",{key:t,meta:n})},onChange:(t,n,a)=>{e.trigger("hub:change",{key:t,previous:n,current:a})}}}const z=function(){var e=u((function*({ret_pool:e,ret_version:t},n){let a=!1,i=0;for(;!a&&i<10&&!n();){try{const n=5e3*i+(0===i?15e3*Math.random():0);console.log("[reconnect] Getting reticulum meta in ".concat(Math.ceil(n/1e3)," seconds.").concat(i?" (Attempt ".concat(i+1," of ").concat(10,")"):"")),yield Object(l.a)(n),A(),console.log("[reconnect] Getting reticulum meta.".concat(i?" (Attempt ".concat(i+1," of ").concat(10,")"):""));const{pool:r,version:o}=yield E();a=e===r&&t===o}catch{a=!1}i+=1}return a}));return function(t,n){return e.apply(this,arguments)}}()},80:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l}));const a={URL:1,FILE:2,CLIPBOARD:3,SPAWNER:4},i={URL_IMAGE:0,URL_VIDEO:1,URL_MODEL:2,URL_PDF:3,URL_AUDIO:4,FILE_IMAGE:8,FILE_VIDEO:9,FILE_MODEL:10,FILE_PDF:11,FILE_AUDIO:12,CLIPBOARD_IMAGE:16,CLIPBOARD_VIDEO:17,CLIPBOARD_MODEL:18,CLIPBOARD_PDF:19,CLIPBOARD_AUDIO:20,SPAWNER_IMAGE:24,SPAWNER_VIDEO:25,SPAWNER_MODEL:26,SPAWNER_PDF:27,SPAWNER_AUDIO:28,CAMERA:30,UNKNOWN:31};function r(e,t,n,i,r){return e===a.URL?t:e===a.FILE?n:e===a.CLIPBOARD?i:r}const o={"image/":[i.URL_IMAGE,i.FILE_IMAGE,i.CLIPBOARD_IMAGE,i.SPAWNER_IMAGE],"model/":[i.URL_MODEL,i.FILE_MODEL,i.CLIPBOARD_MODEL,i.SPAWNER_MODEL],"application/x-zip-compressed":[i.URL_MODEL,i.FILE_MODEL,i.CLIPBOARD_MODEL,i.SPAWNER_MODEL],"video/":[i.URL_VIDEO,i.FILE_VIDEO,i.CLIPBOARD_VIDEO,i.SPAWNER_VIDEO],"application/vnd.apple.mpegurl":[i.URL_VIDEO,i.FILE_VIDEO,i.CLIPBOARD_VIDEO,i.SPAWNER_VIDEO],"application/x-mpegurl":[i.URL_VIDEO,i.FILE_VIDEO,i.CLIPBOARD_VIDEO,i.SPAWNER_VIDEO],"audio/":[i.URL_AUDIO,i.FILE_AUDIO,i.CLIPBOARD_AUDIO,i.SPAWNER_AUDIO],"application/pdf":[i.URL_PDF,i.FILE_PDF,i.CLIPBOARD_PDF,i.SPAWNER_PDF]},s={".m3u8":[i.URL_VIDEO,i.FILE_VIDEO,i.CLIPBOARD_VIDEO,i.SPAWNER_VIDEO]};function l(e,t,n){for(const n in o)if(t.toLowerCase().startsWith(n)){return r(e,...o[n])}if(n)for(const t in s)if(n.toLowerCase().endsWith(t)){return r(e,...s[t])}return i.UNKNOWN}},806:function(e,t,n){e.exports={divider:"Divider__divider__jeSkI"}},807:function(e,t,n){e.exports={"numeric-input":"NumericInput__numeric-input__2Bp3p",numericInput:"NumericInput__numeric-input__2Bp3p"}},812:function(e,t,n){e.exports={label:"SpectatingLabel__label__2Hd_2"}},815:function(e){e.exports=JSON.parse('{"meta":{"image":"sprite-system-notice-spritesheet.png","size":{"w":2048,"h":2048},"scale":"1"},"frames":{"spawn-point.png":{"frame":{"x":8,"y":8,"w":512,"h":512},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":512,"h":512},"sourceSize":{"w":512,"h":512}},"volume_up-hover.png":{"frame":{"x":536,"y":8,"w":256,"h":256},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":256,"h":256},"sourceSize":{"w":256,"h":256}},"pause-hover.png":{"frame":{"x":536,"y":280,"w":192,"h":192},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":192,"h":192},"sourceSize":{"w":192,"h":192}},"pause.png":{"frame":{"x":8,"y":536,"w":192,"h":192},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":192,"h":192},"sourceSize":{"w":192,"h":192}},"play-hover.png":{"frame":{"x":216,"y":536,"w":192,"h":192},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":192,"h":192},"sourceSize":{"w":192,"h":192}},"play.png":{"frame":{"x":424,"y":536,"w":192,"h":192},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":192,"h":192},"sourceSize":{"w":192,"h":192}},"create_object-hover.png":{"frame":{"x":632,"y":536,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"create_object.png":{"frame":{"x":808,"y":8,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"freeze_off-hover.png":{"frame":{"x":808,"y":156,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"freeze_off.png":{"frame":{"x":808,"y":304,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"freeze_on-hover.png":{"frame":{"x":808,"y":452,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"freeze_on.png":{"frame":{"x":8,"y":744,"w":132,"h":132},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":132,"h":132},"sourceSize":{"w":132,"h":132}},"mic-0.png":{"frame":{"x":808,"y":600,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-1.png":{"frame":{"x":300,"y":744,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-2.png":{"frame":{"x":588,"y":744,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-3.png":{"frame":{"x":956,"y":8,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-4.png":{"frame":{"x":956,"y":296,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-5.png":{"frame":{"x":956,"y":584,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-6.png":{"frame":{"x":8,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-7.png":{"frame":{"x":296,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-0.png":{"frame":{"x":584,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-1.png":{"frame":{"x":872,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-2.png":{"frame":{"x":1100,"y":152,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-3.png":{"frame":{"x":1100,"y":440,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-4.png":{"frame":{"x":1100,"y":728,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-5.png":{"frame":{"x":8,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-6.png":{"frame":{"x":296,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-7.png":{"frame":{"x":584,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"Background.png":{"frame":{"x":872,"y":1036,"w":128,"h":48},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":48},"sourceSize":{"w":128,"h":48}},"seek_back-hover.png":{"frame":{"x":1244,"y":8,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"seek_back.png":{"frame":{"x":1244,"y":120,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"seek_fwd-hover.png":{"frame":{"x":1244,"y":232,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"seek_fwd.png":{"frame":{"x":1244,"y":344,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"snap-hover.png":{"frame":{"x":1244,"y":456,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"snap.png":{"frame":{"x":1244,"y":568,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"volume_down-hover.png":{"frame":{"x":1244,"y":680,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"volume_down.png":{"frame":{"x":1244,"y":792,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"volume_up.png":{"frame":{"x":1244,"y":904,"w":96,"h":96},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":96,"h":96},"sourceSize":{"w":96,"h":96}},"camera_off-disabled.png":{"frame":{"x":1244,"y":1016,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"camera_off-hover.png":{"frame":{"x":1016,"y":892,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"camera_off.png":{"frame":{"x":8,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"camera_on-hover.png":{"frame":{"x":92,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"camera_on.png":{"frame":{"x":176,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"mute_off-hover.png":{"frame":{"x":260,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"mute_off.png":{"frame":{"x":344,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"pen_off-disabled.png":{"frame":{"x":428,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"pen_off-hover.png":{"frame":{"x":512,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"pen_off.png":{"frame":{"x":596,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"pen_on-hover.png":{"frame":{"x":680,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"pen_on.png":{"frame":{"x":764,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_camera_off-hover.png":{"frame":{"x":848,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_camera_off.png":{"frame":{"x":932,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_camera_on-hover.png":{"frame":{"x":1016,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_camera_on.png":{"frame":{"x":1100,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_screen_off.png":{"frame":{"x":1184,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_screen_on-hover.png":{"frame":{"x":1268,"y":1180,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_screen_on.png":{"frame":{"x":8,"y":1264,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_window_off-hover.png":{"frame":{"x":92,"y":1264,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_window_off.png":{"frame":{"x":176,"y":1264,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_window_on-hover.png":{"frame":{"x":260,"y":1264,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"share_window_on.png":{"frame":{"x":344,"y":1264,"w":68,"h":68},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":68,"h":68},"sourceSize":{"w":68,"h":68}},"mute_on-hover.png":{"frame":{"x":1244,"y":1100,"w":66,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":66,"h":64},"sourceSize":{"w":66,"h":64}},"close-white.png":{"frame":{"x":876,"y":744,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"mute_on.png":{"frame":{"x":872,"y":1100,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"rotate-cursor.png":{"frame":{"x":952,"y":1100,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"snap_camera.png":{"frame":{"x":1032,"y":1100,"w":64,"h":64},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":64,"h":64},"sourceSize":{"w":64,"h":64}},"mic-0_hover.png":{"frame":{"x":156,"y":744,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-1_hover.png":{"frame":{"x":444,"y":744,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-2_hover.png":{"frame":{"x":732,"y":744,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-3_hover.png":{"frame":{"x":956,"y":152,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-4_hover.png":{"frame":{"x":956,"y":440,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-5_hover.png":{"frame":{"x":956,"y":728,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-6_hover.png":{"frame":{"x":152,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-7_hover.png":{"frame":{"x":440,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-0_hover.png":{"frame":{"x":728,"y":892,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-1_hover.png":{"frame":{"x":1100,"y":8,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-2_hover.png":{"frame":{"x":1100,"y":296,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-3_hover.png":{"frame":{"x":1100,"y":584,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-4_hover.png":{"frame":{"x":1100,"y":872,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-5_hover.png":{"frame":{"x":152,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-6_hover.png":{"frame":{"x":440,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}},"mic-off-7_hover.png":{"frame":{"x":728,"y":1036,"w":128,"h":128},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":128,"h":128},"sourceSize":{"w":128,"h":128}}}}')},816:function(e,t,n){e.exports=n.p+"assets/images/spritesheets/sprite-system-action-spritesheet-7c9dc220b9426c1eff195e421fee8d51.png"},817:function(e,t,n){e.exports=n.p+"assets/images/spritesheets/sprite-system-notice-spritesheet-f48f446b92410c437a7e81c3a17f70fa.png"},818:function(e,t){e.exports="uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nattribute mat4 a_mv;\nattribute vec3 position;\nattribute vec2 a_uvs;\nvarying vec2 v_uvs;\nattribute float a_hubs_EnableSweepingEffect;\nvarying float v_hubs_EnableSweepingEffect;\nattribute vec2 a_hubs_SweepParams;\nvarying vec2 v_hubs_SweepParams;\nvarying vec3 hubs_WorldPosition;\n\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * a_mv * vec4(position, 1.0);\n  v_uvs = a_uvs;\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\n  v_hubs_SweepParams = a_hubs_SweepParams;\n\n  vec4 wt = vec4(position, 1.0);\n  hubs_WorldPosition = (a_mv * wt).xyz;\n}\n"},819:function(e,t){e.exports="precision mediump float;\n\nuniform sampler2D u_spritesheet;\n\nvarying vec2 v_uvs;\n\nvarying float v_hubs_EnableSweepingEffect;\nvarying vec2 v_hubs_SweepParams;\nvarying vec3 hubs_WorldPosition;\nuniform bool hubs_HighlightInteractorOne;\nuniform vec3 hubs_InteractorOnePos;\nuniform bool hubs_HighlightInteractorTwo;\nuniform vec3 hubs_InteractorTwoPos;\nuniform float hubs_Time;\n\nvec4 LinearTosRGB( in vec4 value ) {\n    return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 linearToOutputTexel( vec4 value ) {\n  return LinearTosRGB( value );\n}\n\nvoid main() {\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\n\n    float ratio = 0.0;\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\n        if (hubs_WorldPosition.y < line) {\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\n        }\n\n    }\n    ratio = min(1.0, ratio);\n\n    vec4 highlightColor = vec4(0.184, 0.499, 0.933, 1.0);\n    gl_FragColor = linearToOutputTexel(vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a));\n}\n"},82:function(e,t,n){e.exports={"media-tile":"MediaTiles__media-tile__mGdaM",mediaTile:"MediaTiles__media-tile__mGdaM","thumbnail-container":"MediaTiles__thumbnail-container__2o2c0",thumbnailContainer:"MediaTiles__thumbnail-container__2o2c0","create-tile-content":"MediaTiles__create-tile-content__ZPGad",createTileContent:"MediaTiles__create-tile-content__ZPGad",tall:"MediaTiles__tall__16fSM",wide:"MediaTiles__wide__1-OwO","thumbnail-link":"MediaTiles__thumbnail-link__1PgRp",thumbnailLink:"MediaTiles__thumbnail-link__1PgRp","tile-actions":"MediaTiles__tile-actions__3B_T3",tileActions:"MediaTiles__tile-actions__3B_T3","tile-action":"MediaTiles__tile-action__2h4gJ",tileAction:"MediaTiles__tile-action__2h4gJ","member-count":"MediaTiles__member-count__1LXbp",memberCount:"MediaTiles__member-count__1LXbp","favorite-icon":"MediaTiles__favorite-icon__2Dkie",favoriteIcon:"MediaTiles__favorite-icon__2Dkie",info:"MediaTiles__info__Tt-xT",description:"MediaTiles__description__qcX6D","create-tile":"MediaTiles__create-tile__ZoX89",createTile:"MediaTiles__create-tile__ZoX89"}},820:function(e,t,n){e.exports=function(){return n(272)('!function(r){var n={};function t(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return r[e].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=r,t.c=n,t.d=function(r,n,e){t.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:e})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,n){if(1&n&&(r=t(r)),8&n)return r;if(4&n&&"object"==typeof r&&r&&r.__esModule)return r;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:r}),2&n&&"string"!=typeof r)for(var a in r)t.d(e,a,function(n){return r[n]}.bind(null,a));return e},t.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(n,"a",n),n},t.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},t.p="https://assets.metaverseplus2.xyz/hubs/",t(t.s=3)}([function(r,n,t){"use strict";var e=t(4),a=t(7),o=[].slice,l=["keyword","gray","hex"],i={};Object.keys(a).forEach((function(r){i[o.call(a[r].labels).sort().join("")]=r}));var s={};function h(r,n){if(!(this instanceof h))return new h(r,n);if(n&&n in l&&(n=null),n&&!(n in a))throw new Error("Unknown model: "+n);var t,u;if(null==r)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(r instanceof h)this.model=r.model,this.color=r.color.slice(),this.valpha=r.valpha;else if("string"==typeof r){var c=e.get(r);if(null===c)throw new Error("Unable to parse color from string: "+r);this.model=c.model,u=a[this.model].channels,this.color=c.value.slice(0,u),this.valpha="number"==typeof c.value[u]?c.value[u]:1}else if(r.length){this.model=n||"rgb",u=a[this.model].channels;var f=o.call(r,0,u);this.color=g(f,u),this.valpha="number"==typeof r[u]?r[u]:1}else if("number"==typeof r)r&=16777215,this.model="rgb",this.color=[r>>16&255,r>>8&255,255&r],this.valpha=1;else{this.valpha=1;var b=Object.keys(r);"alpha"in r&&(b.splice(b.indexOf("alpha"),1),this.valpha="number"==typeof r.alpha?r.alpha:0);var p=b.sort().join("");if(!(p in i))throw new Error("Unable to parse color from object: "+JSON.stringify(r));this.model=i[p];var v=a[this.model].labels,d=[];for(t=0;t<v.length;t++)d.push(r[v[t]]);this.color=g(d)}if(s[this.model])for(u=a[this.model].channels,t=0;t<u;t++){var m=s[this.model][t];m&&(this.color[t]=m(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(r,n,t){return(r=Array.isArray(r)?r:[r]).forEach((function(r){(s[r]||(s[r]=[]))[n]=t})),r=r[0],function(e){var a;return arguments.length?(t&&(e=t(e)),(a=this[r]()).color[n]=e,a):(a=this[r]().color[n],t&&(a=t(a)),a)}}function c(r){return function(n){return Math.max(0,Math.min(r,n))}}function f(r){return Array.isArray(r)?r:[r]}function g(r,n){for(var t=0;t<n;t++)"number"!=typeof r[t]&&(r[t]=0);return r}h.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(r){var n=this.model in e.to?this:this.rgb(),t=1===(n=n.round("number"==typeof r?r:1)).valpha?n.color:n.color.concat(this.valpha);return e.to[n.model](t)},percentString:function(r){var n=this.rgb().round("number"==typeof r?r:1),t=1===n.valpha?n.color:n.color.concat(this.valpha);return e.to.rgb.percent(t)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},n=a[this.model].channels,t=a[this.model].labels,e=0;e<n;e++)r[t[e]]=this.color[e];return 1!==this.valpha&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,1!==this.valpha&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,1!==this.valpha&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new h(this.color.map(function(r){return function(n){return function(r,n){return Number(r.toFixed(n))}(n,r)}}(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new h(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:u("rgb",0,c(255)),green:u("rgb",1,c(255)),blue:u("rgb",2,c(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(function(r){return(r%360+360)%360})),saturationl:u("hsl",1,c(100)),lightness:u("hsl",2,c(100)),saturationv:u("hsv",1,c(100)),value:u("hsv",2,c(100)),chroma:u("hcg",1,c(100)),gray:u("hcg",2,c(100)),white:u("hwb",1,c(100)),wblack:u("hwb",2,c(100)),cyan:u("cmyk",0,c(100)),magenta:u("cmyk",1,c(100)),yellow:u("cmyk",2,c(100)),black:u("cmyk",3,c(100)),x:u("xyz",0,c(100)),y:u("xyz",1,c(100)),z:u("xyz",2,c(100)),l:u("lab",0,c(100)),a:u("lab",1),b:u("lab",2),keyword:function(r){return arguments.length?new h(r):a[this.model].keyword(this.color)},hex:function(r){return arguments.length?new h(r):e.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(255&r[0])<<16|(255&r[1])<<8|255&r[2]},luminosity:function(){for(var r=this.rgb().color,n=[],t=0;t<r.length;t++){var e=r[t]/255;n[t]=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(r){var n=this.luminosity(),t=r.luminosity();return n>t?(n+.05)/(t+.05):(t+.05)/(n+.05)},level:function(r){var n=this.contrast(r);return n>=7.1?"AAA":n>=4.5?"AA":""},isDark:function(){var r=this.rgb().color;return(299*r[0]+587*r[1]+114*r[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),n=0;n<3;n++)r.color[n]=255-r.color[n];return r},lighten:function(r){var n=this.hsl();return n.color[2]+=n.color[2]*r,n},darken:function(r){var n=this.hsl();return n.color[2]-=n.color[2]*r,n},saturate:function(r){var n=this.hsl();return n.color[1]+=n.color[1]*r,n},desaturate:function(r){var n=this.hsl();return n.color[1]-=n.color[1]*r,n},whiten:function(r){var n=this.hwb();return n.color[1]+=n.color[1]*r,n},blacken:function(r){var n=this.hwb();return n.color[2]+=n.color[2]*r,n},grayscale:function(){var r=this.rgb().color,n=.3*r[0]+.59*r[1]+.11*r[2];return h.rgb(n,n,n)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var n=this.hsl(),t=n.color[0];return t=(t=(t+r)%360)<0?360+t:t,n.color[0]=t,n},mix:function(r,n){if(!r||!r.rgb)throw new Error(\'Argument to "mix" was not a Color instance, but rather an instance of \'+typeof r);var t=r.rgb(),e=this.rgb(),a=void 0===n?.5:n,o=2*a-1,l=t.alpha()-e.alpha(),i=((o*l==-1?o:(o+l)/(1+o*l))+1)/2,s=1-i;return h.rgb(i*t.red()+s*e.red(),i*t.green()+s*e.green(),i*t.blue()+s*e.blue(),t.alpha()*a+e.alpha()*(1-a))}},Object.keys(a).forEach((function(r){if(-1===l.indexOf(r)){var n=a[r].channels;h.prototype[r]=function(){if(this.model===r)return new h(this);if(arguments.length)return new h(arguments,r);var t="number"==typeof arguments[n]?n:this.valpha;return new h(f(a[this.model][r].raw(this.color)).concat(t),r)},h[r]=function(t){return"number"==typeof t&&(t=g(o.call(arguments),n)),new h(t,r)}}})),r.exports=h},function(r,n){r.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(r,n,t){var e=t(1),a={};for(var o in e)e.hasOwnProperty(o)&&(a[e[o]]=o);var l=r.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var i in l)if(l.hasOwnProperty(i)){if(!("channels"in l[i]))throw new Error("missing channels property: "+i);if(!("labels"in l[i]))throw new Error("missing channel labels property: "+i);if(l[i].labels.length!==l[i].channels)throw new Error("channel and label counts mismatch: "+i);var s=l[i].channels,h=l[i].labels;delete l[i].channels,delete l[i].labels,Object.defineProperty(l[i],"channels",{value:s}),Object.defineProperty(l[i],"labels",{value:h})}l.rgb.hsl=function(r){var n,t,e=r[0]/255,a=r[1]/255,o=r[2]/255,l=Math.min(e,a,o),i=Math.max(e,a,o),s=i-l;return i===l?n=0:e===i?n=(a-o)/s:a===i?n=2+(o-e)/s:o===i&&(n=4+(e-a)/s),(n=Math.min(60*n,360))<0&&(n+=360),t=(l+i)/2,[n,100*(i===l?0:t<=.5?s/(i+l):s/(2-i-l)),100*t]},l.rgb.hsv=function(r){var n,t,e,a,o,l=r[0]/255,i=r[1]/255,s=r[2]/255,h=Math.max(l,i,s),u=h-Math.min(l,i,s),c=function(r){return(h-r)/6/u+.5};return 0===u?a=o=0:(o=u/h,n=c(l),t=c(i),e=c(s),l===h?a=e-t:i===h?a=1/3+n-e:s===h&&(a=2/3+t-n),a<0?a+=1:a>1&&(a-=1)),[360*a,100*o,100*h]},l.rgb.hwb=function(r){var n=r[0],t=r[1],e=r[2];return[l.rgb.hsl(r)[0],100*(1/255*Math.min(n,Math.min(t,e))),100*(e=1-1/255*Math.max(n,Math.max(t,e)))]},l.rgb.cmyk=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255;return[100*((1-t-(n=Math.min(1-t,1-e,1-a)))/(1-n)||0),100*((1-e-n)/(1-n)||0),100*((1-a-n)/(1-n)||0),100*n]},l.rgb.keyword=function(r){var n=a[r];if(n)return n;var t,o,l,i=1/0;for(var s in e)if(e.hasOwnProperty(s)){var h=e[s],u=(o=r,l=h,Math.pow(o[0]-l[0],2)+Math.pow(o[1]-l[1],2)+Math.pow(o[2]-l[2],2));u<i&&(i=u,t=s)}return t},l.keyword.rgb=function(r){return e[r]},l.rgb.xyz=function(r){var n=r[0]/255,t=r[1]/255,e=r[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1805*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*n+.7152*t+.0722*e),100*(.0193*n+.1192*t+.9505*e)]},l.rgb.lab=function(r){var n=l.rgb.xyz(r),t=n[0],e=n[1],a=n[2];return e/=100,a/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116)-16,500*(t-e),200*(e-(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116))]},l.hsl.rgb=function(r){var n,t,e,a,o,l=r[0]/360,i=r[1]/100,s=r[2]/100;if(0===i)return[o=255*s,o,o];n=2*s-(t=s<.5?s*(1+i):s+i-s*i),a=[0,0,0];for(var h=0;h<3;h++)(e=l+1/3*-(h-1))<0&&e++,e>1&&e--,o=6*e<1?n+6*(t-n)*e:2*e<1?t:3*e<2?n+(t-n)*(2/3-e)*6:n,a[h]=255*o;return a},l.hsl.hsv=function(r){var n=r[0],t=r[1]/100,e=r[2]/100,a=t,o=Math.max(e,.01);return t*=(e*=2)<=1?e:2-e,a*=o<=1?o:2-o,[n,100*(0===e?2*a/(o+a):2*t/(e+t)),100*((e+t)/2)]},l.hsv.rgb=function(r){var n=r[0]/60,t=r[1]/100,e=r[2]/100,a=Math.floor(n)%6,o=n-Math.floor(n),l=255*e*(1-t),i=255*e*(1-t*o),s=255*e*(1-t*(1-o));switch(e*=255,a){case 0:return[e,s,l];case 1:return[i,e,l];case 2:return[l,e,s];case 3:return[l,i,e];case 4:return[s,l,e];case 5:return[e,l,i]}},l.hsv.hsl=function(r){var n,t,e,a=r[0],o=r[1]/100,l=r[2]/100,i=Math.max(l,.01);return e=(2-o)*l,t=o*i,[a,100*(t=(t/=(n=(2-o)*i)<=1?n:2-n)||0),100*(e/=2)]},l.hwb.rgb=function(r){var n,t,e,a,o,l,i,s=r[0]/360,h=r[1]/100,u=r[2]/100,c=h+u;switch(c>1&&(h/=c,u/=c),e=6*s-(n=Math.floor(6*s)),0!=(1&n)&&(e=1-e),a=h+e*((t=1-u)-h),n){default:case 6:case 0:o=t,l=a,i=h;break;case 1:o=a,l=t,i=h;break;case 2:o=h,l=t,i=a;break;case 3:o=h,l=a,i=t;break;case 4:o=a,l=h,i=t;break;case 5:o=t,l=h,i=a}return[255*o,255*l,255*i]},l.cmyk.rgb=function(r){var n=r[0]/100,t=r[1]/100,e=r[2]/100,a=r[3]/100;return[255*(1-Math.min(1,n*(1-a)+a)),255*(1-Math.min(1,t*(1-a)+a)),255*(1-Math.min(1,e*(1-a)+a))]},l.xyz.rgb=function(r){var n,t,e,a=r[0]/100,o=r[1]/100,l=r[2]/100;return t=-.9689*a+1.8758*o+.0415*l,e=.0557*a+-.204*o+1.057*l,n=(n=3.2406*a+-1.5372*o+-.4986*l)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,[255*(n=Math.min(Math.max(0,n),1)),255*(t=Math.min(Math.max(0,t),1)),255*(e=Math.min(Math.max(0,e),1))]},l.xyz.lab=function(r){var n=r[0],t=r[1],e=r[2];return t/=100,e/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116)-16,500*(n-t),200*(t-(e=e>.008856?Math.pow(e,1/3):7.787*e+16/116))]},l.lab.xyz=function(r){var n,t,e,a=r[0];n=r[1]/500+(t=(a+16)/116),e=t-r[2]/200;var o=Math.pow(t,3),l=Math.pow(n,3),i=Math.pow(e,3);return t=o>.008856?o:(t-16/116)/7.787,n=l>.008856?l:(n-16/116)/7.787,e=i>.008856?i:(e-16/116)/7.787,[n*=95.047,t*=100,e*=108.883]},l.lab.lch=function(r){var n,t=r[0],e=r[1],a=r[2];return(n=360*Math.atan2(a,e)/2/Math.PI)<0&&(n+=360),[t,Math.sqrt(e*e+a*a),n]},l.lch.lab=function(r){var n,t=r[0],e=r[1];return n=r[2]/360*2*Math.PI,[t,e*Math.cos(n),e*Math.sin(n)]},l.rgb.ansi16=function(r){var n=r[0],t=r[1],e=r[2],a=1 in arguments?arguments[1]:l.rgb.hsv(r)[2];if(0===(a=Math.round(a/50)))return 30;var o=30+(Math.round(e/255)<<2|Math.round(t/255)<<1|Math.round(n/255));return 2===a&&(o+=60),o},l.hsv.ansi16=function(r){return l.rgb.ansi16(l.hsv.rgb(r),r[2])},l.rgb.ansi256=function(r){var n=r[0],t=r[1],e=r[2];return n===t&&t===e?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(t/255*5)+Math.round(e/255*5)},l.ansi16.rgb=function(r){var n=r%10;if(0===n||7===n)return r>50&&(n+=3.5),[n=n/10.5*255,n,n];var t=.5*(1+~~(r>50));return[(1&n)*t*255,(n>>1&1)*t*255,(n>>2&1)*t*255]},l.ansi256.rgb=function(r){if(r>=232){var n=10*(r-232)+8;return[n,n,n]}var t;return r-=16,[Math.floor(r/36)/5*255,Math.floor((t=r%36)/6)/5*255,t%6/5*255]},l.rgb.hex=function(r){var n=(((255&Math.round(r[0]))<<16)+((255&Math.round(r[1]))<<8)+(255&Math.round(r[2]))).toString(16).toUpperCase();return"000000".substring(n.length)+n},l.hex.rgb=function(r){var n=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var t=n[0];3===n[0].length&&(t=t.split("").map((function(r){return r+r})).join(""));var e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]},l.rgb.hcg=function(r){var n,t=r[0]/255,e=r[1]/255,a=r[2]/255,o=Math.max(Math.max(t,e),a),l=Math.min(Math.min(t,e),a),i=o-l;return n=i<=0?0:o===t?(e-a)/i%6:o===e?2+(a-t)/i:4+(t-e)/i+4,n/=6,[360*(n%=1),100*i,100*(i<1?l/(1-i):0)]},l.hsl.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=1,a=0;return(e=t<.5?2*n*t:2*n*(1-t))<1&&(a=(t-.5*e)/(1-e)),[r[0],100*e,100*a]},l.hsv.hcg=function(r){var n=r[1]/100,t=r[2]/100,e=n*t,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.hcg.rgb=function(r){var n=r[0]/360,t=r[1]/100,e=r[2]/100;if(0===t)return[255*e,255*e,255*e];var a,o=[0,0,0],l=n%1*6,i=l%1,s=1-i;switch(Math.floor(l)){case 0:o[0]=1,o[1]=i,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=i;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=i,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return a=(1-t)*e,[255*(t*o[0]+a),255*(t*o[1]+a),255*(t*o[2]+a)]},l.hcg.hsv=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n),e=0;return t>0&&(e=n/t),[r[0],100*e,100*t]},l.hcg.hsl=function(r){var n=r[1]/100,t=r[2]/100*(1-n)+.5*n,e=0;return t>0&&t<.5?e=n/(2*t):t>=.5&&t<1&&(e=n/(2*(1-t))),[r[0],100*e,100*t]},l.hcg.hwb=function(r){var n=r[1]/100,t=n+r[2]/100*(1-n);return[r[0],100*(t-n),100*(1-t)]},l.hwb.hcg=function(r){var n=r[1]/100,t=1-r[2]/100,e=t-n,a=0;return e<1&&(a=(t-e)/(1-e)),[r[0],100*e,100*a]},l.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]},l.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]},l.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]},l.gray.hsl=l.gray.hsv=function(r){return[0,0,r[0]]},l.gray.hwb=function(r){return[0,100,r[0]]},l.gray.cmyk=function(r){return[0,0,0,r[0]]},l.gray.lab=function(r){return[r[0],0,0]},l.gray.hex=function(r){var n=255&Math.round(r[0]/100*255),t=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(t.length)+t},l.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]}},function(r,n,t){"use strict";t.r(n);var e=t(0),a=t.n(e);self.onmessage=r=>{const n=function(r,n){const t="action"===r?a()("#ff3464"):a()("#2F80ED"),e=a()(n).hsl(),o=t.hsl(),l=e.hue()-o.hue(),i=e.saturationl()/o.saturationl(),s=e.lightness()/o.lightness();return r=>{const n=(()=>{const r=(r,n)=>Math.abs(r-n)<5;return(n,t,e)=>r(n,t)&&r(t,e)&&r(n,e)})(),t={};for(let e=0,o=r.length;e<o;e+=4){const o=r[e],h=r[e+1],u=r[e+2];if(!n(o,h,u)){const n=o+1e3*h+1e6*u;if(!t[n]){let r=a()({r:o,g:h,b:u}).hsl();r=r.rotate(l),r.color[1]*=i,r.color[2]*=s;const[e,c,f]=r.rgb().array();t[n]=[e,c,f]}const[c,f,g]=t[n];r[e]=c,r[e+1]=f,r[e+2]=g}}return r}}(r.data.type,r.data.color)(new Uint8ClampedArray(r.data.payload));self.postMessage({id:r.data.id,result:n})}},function(r,n,t){var e=t(1),a=t(5),o={};for(var l in e)e.hasOwnProperty(l)&&(o[e[l]]=l);var i=r.exports={to:{},get:{}};function s(r,n,t){return Math.min(Math.max(n,r),t)}function h(r){var n=r.toString(16).toUpperCase();return n.length<2?"0"+n:n}i.get=function(r){var n,t;switch(r.substring(0,3).toLowerCase()){case"hsl":n=i.get.hsl(r),t="hsl";break;case"hwb":n=i.get.hwb(r),t="hwb";break;default:n=i.get.rgb(r),t="rgb"}return n?{model:t,value:n}:null},i.get.rgb=function(r){if(!r)return null;var n,t,a,o=[0,0,0,1];if(n=r.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(a=n[2],n=n[1],t=0;t<3;t++){var l=2*t;o[t]=parseInt(n.slice(l,l+2),16)}a&&(o[3]=Math.round(parseInt(a,16)/255*100)/100)}else if(n=r.match(/^#([a-f0-9]{3,4})$/i)){for(a=(n=n[1])[3],t=0;t<3;t++)o[t]=parseInt(n[t]+n[t],16);a&&(o[3]=Math.round(parseInt(a+a,16)/255*100)/100)}else if(n=r.match(/^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/)){for(t=0;t<3;t++)o[t]=parseInt(n[t+1],0);n[4]&&(o[3]=parseFloat(n[4]))}else{if(!(n=r.match(/^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/)))return(n=r.match(/(\\D+)/))?"transparent"===n[1]?[0,0,0,0]:(o=e[n[1]])?(o[3]=1,o):null:null;for(t=0;t<3;t++)o[t]=Math.round(2.55*parseFloat(n[t+1]));n[4]&&(o[3]=parseFloat(n[4]))}for(t=0;t<3;t++)o[t]=s(o[t],0,255);return o[3]=s(o[3],0,1),o},i.get.hsl=function(r){if(!r)return null;var n=r.match(/^hsla?\\(\\s*([+-]?(?:\\d*\\.)?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])+360)%360,s(parseFloat(n[2]),0,100),s(parseFloat(n[3]),0,100),s(isNaN(t)?1:t,0,1)]}return null},i.get.hwb=function(r){if(!r)return null;var n=r.match(/^hwb\\(\\s*([+-]?\\d*[\\.]?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,s(parseFloat(n[2]),0,100),s(parseFloat(n[3]),0,100),s(isNaN(t)?1:t,0,1)]}return null},i.to.hex=function(){var r=a(arguments);return"#"+h(r[0])+h(r[1])+h(r[2])+(r[3]<1?h(Math.round(255*r[3])):"")},i.to.rgb=function(){var r=a(arguments);return r.length<4||1===r[3]?"rgb("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+")":"rgba("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+", "+r[3]+")"},i.to.rgb.percent=function(){var r=a(arguments),n=Math.round(r[0]/255*100),t=Math.round(r[1]/255*100),e=Math.round(r[2]/255*100);return r.length<4||1===r[3]?"rgb("+n+"%, "+t+"%, "+e+"%)":"rgba("+n+"%, "+t+"%, "+e+"%, "+r[3]+")"},i.to.hsl=function(){var r=a(arguments);return r.length<4||1===r[3]?"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)":"hsla("+r[0]+", "+r[1]+"%, "+r[2]+"%, "+r[3]+")"},i.to.hwb=function(){var r=a(arguments),n="";return r.length>=4&&1!==r[3]&&(n=", "+r[3]),"hwb("+r[0]+", "+r[1]+"%, "+r[2]+"%"+n+")"},i.to.keyword=function(r){return o[r.slice(0,3)]}},function(r,n,t){"use strict";var e=t(6),a=Array.prototype.concat,o=Array.prototype.slice,l=r.exports=function(r){for(var n=[],t=0,l=r.length;t<l;t++){var i=r[t];e(i)?n=a.call(n,o.call(i)):n.push(i)}return n};l.wrap=function(r){return function(){return r(l(arguments))}}},function(r,n){r.exports=function(r){return!(!r||"string"==typeof r)&&(r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&"String"!==r.constructor.name))}},function(r,n,t){var e=t(2),a=t(8),o={};Object.keys(e).forEach((function(r){o[r]={},Object.defineProperty(o[r],"channels",{value:e[r].channels}),Object.defineProperty(o[r],"labels",{value:e[r].labels});var n=a(r);Object.keys(n).forEach((function(t){var e=n[t];o[r][t]=function(r){var n=function(n){if(null==n)return n;arguments.length>1&&(n=Array.prototype.slice.call(arguments));var t=r(n);if("object"==typeof t)for(var e=t.length,a=0;a<e;a++)t[a]=Math.round(t[a]);return t};return"conversion"in r&&(n.conversion=r.conversion),n}(e),o[r][t].raw=function(r){var n=function(n){return null==n?n:(arguments.length>1&&(n=Array.prototype.slice.call(arguments)),r(n))};return"conversion"in r&&(n.conversion=r.conversion),n}(e)}))})),r.exports=o},function(r,n,t){var e=t(2);function a(r){var n=function(){for(var r={},n=Object.keys(e),t=n.length,a=0;a<t;a++)r[n[a]]={distance:-1,parent:null};return r}(),t=[r];for(n[r].distance=0;t.length;)for(var a=t.pop(),o=Object.keys(e[a]),l=o.length,i=0;i<l;i++){var s=o[i],h=n[s];-1===h.distance&&(h.distance=n[a].distance+1,h.parent=a,t.unshift(s))}return n}function o(r,n){return function(t){return n(r(t))}}function l(r,n){for(var t=[n[r].parent,r],a=e[n[r].parent][r],l=n[r].parent;n[l].parent;)t.unshift(n[l].parent),a=o(e[n[l].parent][l],a),l=n[l].parent;return a.conversion=t,a}r.exports=function(r){for(var n=a(r),t={},e=Object.keys(n),o=e.length,i=0;i<o;i++){var s=e[i];null!==n[s].parent&&(t[s]=l(s,n))}return t}}]);\n//# sourceMappingURL=color-shift.worker-7d65bcdcd6a5f767d997.js.map',"/assets/js/color-shift.worker-7d65bcdcd6a5f767d997.js")}},821:function(e,t){e.exports="precision highp float;\nprecision highp int;\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvoid main()\n{\n  vNormal = normalize(normal);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  vUv = position.xz;\n}"},822:function(e,t){e.exports="// Based on: https://www.shadertoy.com/view/Mll3D4#\n\nprecision highp float;\nprecision highp int;\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nuniform float time;\n\nconst int LINEAR = 0;\nconst int INVERSE = 1;\nconst int EXPONENTIAL = 2;\n        \nuniform vec3 colorInner;\nuniform vec3 colorOuter;\nuniform vec3 colorGain;\nuniform int count;\nuniform vec3 sourcePosition[MAX_DEBUG_SOURCES];\nuniform vec3 sourceOrientation[MAX_DEBUG_SOURCES];\nuniform float maxDistance[MAX_DEBUG_SOURCES];\nuniform float refDistance[MAX_DEBUG_SOURCES];\nuniform float rolloffFactor[MAX_DEBUG_SOURCES];\nuniform int distanceModel[MAX_DEBUG_SOURCES];\nuniform float coneInnerAngle[MAX_DEBUG_SOURCES];\nuniform float coneOuterAngle[MAX_DEBUG_SOURCES];\nuniform float gain[MAX_DEBUG_SOURCES];\nuniform bool clipped[MAX_DEBUG_SOURCES];\n\nconst float kPi = 3.141592;\nconst float kDegToRad = kPi / 180.0;\nconst float kInvPi = 1.0 / 3.141592;\nconst float kRefDistWidth = 0.05;\n\nfloat distance[MAX_DEBUG_SOURCES];\nvec2 center[MAX_DEBUG_SOURCES];\nfloat startOffset[MAX_DEBUG_SOURCES];\nfloat clampedGain[MAX_DEBUG_SOURCES];\n\nfloat att_linear(float x, float rolloff, float dref, float dmax) {\n  return 1.0-(rolloff*((x-dref)/(dmax-dref)));\n}\n\nfloat att_inverse(float x, float rolloff, float dref) {\n  return dref/(dref+(rolloff*(max(x, dref)-dref)));\n}\n\nfloat att_exponential(float x, float rolloff, float dref) {\n  return pow((max(x, dref)/dref),-rolloff);\n}\n\nvec4 circle(vec2 center, float d, float len, float radius, float holeRadius, vec3 color, float offset) {  \n  // Define how blurry the circle should be. \n  // A value of 1.0 means 'sharp', larger values\n  // will increase the bluriness.\n  float bluriness = 1.0;\n  \n  // Calculate angle, so we can draw segments, too.\n  float angle = atan( center.x, center.y ) * kInvPi * 0.5;\n  angle = fract( angle + offset);\n  \n  // Create an anti-aliased circle.\n  float wd = bluriness * fwidth( d );\n  float circle = smoothstep( radius + wd, radius - wd, d );\n  \n  // Optionally, you could create a hole in it:\n  float inner = holeRadius;\n  circle -= smoothstep( inner + wd, inner - wd, d );\n  \n  // Or only draw a portion (segment) of the circle.\n  float wa = bluriness * fwidth( angle );\n  float segment = smoothstep( len + wa, len - wa, angle );\n  segment *= smoothstep( 0.0, 2.0 * wa, angle );\n  circle *= mix( segment, 1.0, step( 1.0, len ) );\n      \n  // Let's define the circle's color now.\n  vec3 rgb = color * circle;\n  \n  // Output final color.\n  return vec4( rgb, circle);\n}\n\nfloat att(float d, float maxDistance, float refDistance, float rolloffFactor, int distanceModel) {\n  // Calculate attenuation\n  float attenuation = 1.0;\n  if (distanceModel == LINEAR) {\n    attenuation = att_linear(d, rolloffFactor, refDistance, maxDistance);\n  } else if (distanceModel == INVERSE) {\n    attenuation = att_inverse(d, rolloffFactor, refDistance);\n  } else if (distanceModel == EXPONENTIAL) {\n    attenuation = att_exponential(d, rolloffFactor, refDistance);\n  }\n  return clamp(attenuation, 0.0, 1.0);\n}\n\nvec4 draw_att(float d, float attenuation, vec4 circle) {\n  // Waves\n  float v = sin((d * 2.0 * kPi) - (time * 0.005)) + 1.0;\n  float waves = circle.a * attenuation * v;\n  \n  // Output final color.\n  return vec4( circle.rgb, waves );\n}\n\nvoid main() {\n  // Draw background\n  vec4 background = vec4(1.0, 1.0, 1.0, 0.0);\n\n  for (int i=0; i<count; i++) {\n    center[i] = sourcePosition[i].xz - vUv;\n\n    // Calculate distance to (0,0).\n    distance[i] = length( center[i] );\n\n    // Optional start Offset.\n    vec2 orientation = normalize(sourceOrientation[i].xz);\n    float ang = atan(-orientation.x, orientation.y) * kInvPi * 0.5;\n    // Rotate to start drawing facing front\n    ang -= 0.5;\n    startOffset[i] = mod(ang, 1.0);\n\n    // Gain\n    clampedGain[i] = clamp(gain[i], 0.0, 1.0);\n  }\n\n  for (int i=0; i<count; i++) {\n    float attenuation = att(distance[i], maxDistance[i], refDistance[i], rolloffFactor[i], distanceModel[i]);\n\n    // Draw inner cone\n    float innerAngle = coneInnerAngle[i] * kDegToRad * kInvPi * 0.5;\n    float innerStartAngle = startOffset[i] + innerAngle * 0.5;\n    vec4 innerLayer = circle(center[i], distance[i], innerAngle, 10000.0, 1.0, colorInner, innerStartAngle);\n    innerLayer = draw_att(distance[i], attenuation, innerLayer);\n    background = mix(background, innerLayer, innerLayer.a * clampedGain[i]);\n\n    // Draw outer cone\n    float outerAngle = coneOuterAngle[i] * kDegToRad * kInvPi * 0.5;\n    float outerAngleDiffHalf = (outerAngle - innerAngle) * 0.5;\n    vec4 outerLayer1 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle + outerAngleDiffHalf);\n    outerLayer1 = draw_att(distance[i], attenuation, outerLayer1);\n    background = mix(background, outerLayer1, outerLayer1.a * clampedGain[i]);\n    vec4 outerLayer2 = circle(center[i], distance[i], outerAngleDiffHalf, 10000.0, 1.0, colorOuter, innerStartAngle - innerAngle);\n    outerLayer2 = draw_att(distance[i], attenuation, outerLayer2);\n    background = mix(background, outerLayer2, outerLayer2.a * (clipped[i] ? 0.0 : 1.0) * clampedGain[i]);\n  }\n\n  for (int i=0; i<count; i++) {\n    // Draw base\n    vec4 baseLayer = circle(center[i], distance[i], 1.0, 1.0, 0.1, vec3(0.5, 0.5, 0.5), 0.0);\n    background = mix(background, baseLayer, baseLayer.a);\n\n    // Draw gain\n    vec4 gainLayer = circle(center[i], distance[i], clampedGain[i], 1.0, 0.5, colorGain, startOffset[i]);\n    background = mix(background, gainLayer, gainLayer.a);\n    if (gain[i] > 1.0) {\n      vec4 overGainLayer = circle(center[i], distance[i], gain[i] -  clampedGain[i], 1.0, 0.5, vec3(1.0, 0.0, 0.0), startOffset[i]);\n      background = mix(background, overGainLayer, overGainLayer.a);\n    }\n  } \n  \n  // Blend\n  gl_FragColor = vec4(background.rgb, background.a * vNormal.y);\n}"},824:function(e,t,n){e.exports={"oauth-screen":"OAuthScreen__oauth-screen__1gFQL",oauthScreen:"OAuthScreen__oauth-screen__1gFQL"}},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(21);function i(){return window.matchMedia("(prefers-color-scheme: dark)").matches&&a.b.find(e=>e.darkModeDefault)||a.b.find(e=>e.default)}},84:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return E})),n.d(t,"h",(function(){return w}));var a=n(8),i=n(19),r=n(411),o=n.n(r);function s(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){s(r,a,i,o,l,"next",e)}function l(e){s(r,a,i,o,l,"throw",e)}o(void 0)}))}}const c={SKINNABLE:"skinnable",URL:"url"};function d(e){return e.startsWith("http")?c.URL:c.SKINNABLE}function u(e){return h.apply(this,arguments)}function h(){return(h=l((function*(e){const t=yield Object(a.e)("/api/v1/avatars/".concat(e));return t&&t.avatars&&t.avatars[0]}))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=l((function*(e){switch(d(e)){case c.SKINNABLE:return u(e);case c.URL:return{avatar_id:e,gltf_url:Object(i.j)(e)}}}))).apply(this,arguments)}function f(){return(f=l((function*(e){return p(e).then(e=>e&&e.gltf_url)}))).apply(this,arguments)}function g(e){switch(d(e)){case c.SKINNABLE:return function(e){return f.apply(this,arguments)}(e);case c.URL:return Object(i.j)(e);default:return e}}function v(e){return b.apply(this,arguments)}function b(){return(b=l((function*(e){switch(d(e)){case c.SKINNABLE:return p(e).then(e=>e.files.thumbnail);default:return o.a}}))).apply(this,arguments)}const y="Bot_PBS";function E(e){if(e.materials.find(e=>e.name===y))return e;function t(t){if(!t.primitives)return;const n=t.primitives.find(e=>void 0!==e.material);return n&&e.materials[n.material]}let n=e.scenes[e.scene].nodes.slice(0);for(;n.length;){const a=e.nodes[n.shift()],i=void 0!==a.mesh&&t(e.meshes[a.mesh]);if(i){i.name=y;break}a.children&&(n=n.concat(a.children))}return e}function w(e,t){return _.apply(this,arguments)}function _(){return(_=l((function*(e,t){const n={parent_avatar_listing_id:e,name:t,files:{}};return Object(a.e)("/api/v1/avatars","POST",{avatar:n})}))).apply(this,arguments)}},86:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(157),i=n.n(a),r=n(4);const o=window.ga;function s(e,t){const n=r.a.SENTRY_DSN,a=r.a.GA_TRACKING_ID;n&&(console.log("Tracking: Sentry DSN: "+n),i.a.config(n).install()),o&&a&&(console.log("Tracking: Google Analytics ID: "+a),o("create",a,"auto"),e&&o("set","page",e),t&&o("set","title",t),o("send","pageview"))}},865:function(module,__webpack_exports__,__webpack_require__){"use strict";var _qs_truthy__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(12);const showLog=Object(_qs_truthy__WEBPACK_IMPORTED_MODULE_0__.a)("debug_log");if(showLog){const template=document.createElement("template");template.innerHTML='\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id="debug-log">\n        <div id="debug-log-controls">\n          <form id="debug-log-eval">\n            <input id="debug-log-input" placeholder="&gt;&gt;" autocorrect="off" autocapitalize="none" />\n            <button>&gt;</button>\n          </form>\n          <button id="debug-log-minimize">_</button>\n        </div>\n        <div id="debug-log-log"></div>\n    </div>\n  ',document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(template.content)});const debugLog=template.content.querySelector("#debug-log-log");debugLog.addEventListener("wheel",e=>e.stopPropagation());const debugLogInput=template.content.querySelector("#debug-log-input"),debugLogEval=template.content.querySelector("#debug-log-eval");debugLogEval.onsubmit=e=>{e.preventDefault(),console.log(eval("(".concat(debugLogInput.value,")")))};let minimized=!1;const debugLogMinimize=template.content.querySelector("#debug-log-minimize");debugLogMinimize.onclick=()=>{minimized=!minimized,debugLog.className=minimized?"minimized":"",debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight};const origConsoleInfo=console.info,origConsoleLog=console.log,origConsoleError=console.error,origConsoleWarn=console.warn,log=function(e,t){let n;debugLog.childNodes.length>1e3?n=debugLog.firstChild:(n=document.createElement("div"),n.classList.add("entry")),n.classList.remove("warn","error"),n.classList.add(e);const a=Array.from(t),i=a[0];let r;r="string"==typeof i&&i.includes("%c")?i.replace(/%c/g,""):i instanceof Error?"".concat(i.message,"\n").concat(i.stack):a.map(e=>"string"==typeof e?e:JSON.stringify(e)).join(" ");const o=(new Date).toISOString().substring(11,23);n.textContent="[".concat(o,"] ").concat(r);const s=debugLog.scrollTop===debugLog.scrollHeight-debugLog.clientHeight;debugLog.append(n),s&&(debugLog.scrollTop=debugLog.scrollHeight-debugLog.clientHeight)};console.warn=function(){origConsoleWarn.apply(null,arguments),log("warn",arguments)},console.error=function(){origConsoleError.apply(null,arguments),log("error",arguments)},console.log=function(){origConsoleLog.apply(null,arguments),log("log",arguments)},console.info=function(){origConsoleInfo.apply(null,arguments),log("info",arguments)},window.onunhandledrejection=e=>log("error",[e.reason.message,e.reason.code,e.reason.name]),window.onerror=e=>log("error",[e])}},88:function(e,t,n){e.exports={content:"MicSetupModal__content__2ZUH6","audio-check-container":"MicSetupModal__audio-check-container__VcphD",audioCheckContainer:"MicSetupModal__audio-check-container__VcphD","audio-io-container":"MicSetupModal__audio-io-container__2KuwI",audioIoContainer:"MicSetupModal__audio-io-container__2KuwI","icon-enabled":"MicSetupModal__icon-enabled__3mxrr",iconEnabled:"MicSetupModal__icon-enabled__3mxrr","icon-disabled":"MicSetupModal__icon-disabled__3k9bL",iconDisabled:"MicSetupModal__icon-disabled__3k9bL","icon-container":"MicSetupModal__icon-container__2p0jr",iconContainer:"MicSetupModal__icon-container__2p0jr","action-container":"MicSetupModal__action-container__iZU8O",actionContainer:"MicSetupModal__action-container__iZU8O","selection-container":"MicSetupModal__selection-container__3vLUs",selectionContainer:"MicSetupModal__selection-container__3vLUs","selection-input":"MicSetupModal__selection-input__1KF7f",selectionInput:"MicSetupModal__selection-input__1KF7f",popover:"MicSetupModal__popover__2oQQD","popover-arrow":"MicSetupModal__popover-arrow__3G38i",popoverArrow:"MicSetupModal__popover-arrow__3G38i","popover-content":"MicSetupModal__popover-content__2Mod_",popoverContent:"MicSetupModal__popover-content__2Mod_","error-title":"MicSetupModal__error-title__2sKGI",errorTitle:"MicSetupModal__error-title__2sKGI","spinner-container":"MicSetupModal__spinner-container__324aK",spinnerContainer:"MicSetupModal__spinner-container__324aK","info-icon":"MicSetupModal__info-icon__aXhaS",infoIcon:"MicSetupModal__info-icon__aXhaS","level-bar":"MicSetupModal__level-bar__u4Xri",levelBar:"MicSetupModal__level-bar__u4Xri"}},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n(13),i=n(4);const r={"action-color":"#FF3464","action-label-color":"#FF3464","action-color-disabled":"#FF74A4","action-color-highlight":"#FF74A4","action-text-color":"#FFFFFF","action-subtitle-color":"#F0F0F0","notice-background-color":"#2F80ED","notice-text-color":"#FFFFFF","favorited-color":"#FFC000","nametag-color":"#000000","nametag-volume-color":"#7ED320","nametag-text-color":"#FFFFFF","nametag-border-color":"#7ED320","nametag-border-color-raised-hand":"#FFCD74"};function o(e){var t,n,a,o,s,l,c,d,u,h,p;const m=null===(t=window.APP)||void 0===t||null===(n=t.store)||void 0===n||null===(a=n.state)||void 0===a||null===(o=a.preferences)||void 0===o?void 0:o.theme,f=m&&(null===(s=i.a.APP_CONFIG)||void 0===s||null===(l=s.theme)||void 0===l||null===(c=l.themes)||void 0===c?void 0:c.find(e=>e.id===m))||(null===(d=i.a.APP_CONFIG)||void 0===d||null===(u=d.theme)||void 0===u||null===(h=u.themes)||void 0===h?void 0:h.find(e=>!0===e.default));return(null==f||null===(p=f.variables)||void 0===p?void 0:p[e])?f.variables[e]:r[e]}function s(){const e=o("action-color"),t=o("action-color-highlight");document.querySelector("#rounded-text-button")&&(document.querySelector("#rounded-text-button").setAttribute("text-button","textHoverColor: ".concat(t,"; textColor: ").concat(e,"; backgroundColor: #fff; backgroundHoverColor: #aaa;")),document.querySelector("#rounded-button").setAttribute("text-button","textHoverColor: ".concat(t,"; textColor: ").concat(e,"; backgroundColor: #fff; backgroundHoverColor: #aaa;")),document.querySelector("#rounded-text-action-button").setAttribute("text-button","textHoverColor: #fff; textColor: #fff; backgroundColor: ".concat(e,"; backgroundHoverColor: ").concat(t)),document.querySelector("#rounded-action-button").setAttribute("text-button","textHoverColor: #fff; textColor: #fff; backgroundColor: ".concat(e,"; backgroundHoverColor: ").concat(t)))}const l=function(){let e;return function(){var t,n,a,i;const r=null===(t=window.APP)||void 0===t||null===(n=t.store)||void 0===n||null===(a=n.state)||void 0===a||null===(i=a.preferences)||void 0===i?void 0:i.theme;e!==r&&(e=r,s())}}();function c(e,t){e.setAttribute("text-button","backgroundColor",o(t?"action-color-highlight":"action-color")),e.setAttribute("text-button","backgroundHoverColor",t?"#aaa":o("action-color-highlight"))}Object(a.b)().then(()=>{var e,t;i.a.APP_CONFIG&&i.a.APP_CONFIG.theme&&i.a.APP_CONFIG.theme["dark-theme"]?document.body.classList.add("dark-theme"):document.body.classList.add("light-theme"),s(),null===(e=window.APP)||void 0===e||null===(t=e.store)||void 0===t||t.addEventListener("statechanged",l)})},91:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(144),i=n.n(a);function r(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){r(o,a,i,s,l,"next",e)}function l(e){r(o,a,i,s,l,"throw",e)}s(void 0)}))}}class s{constructor(e){var t=this;this.setSocket=e=>{this.socket=e},this.signOut=function(){var e=o((function*(e){e&&(yield e.signOut()),t.store.update({credentials:{token:null,email:null}}),yield t.store.resetToRandomDefaultAvatar(),t._signedIn=!1}));return function(t){return e.apply(this,arguments)}}(),this.store=e,this.socket=null,this._signedIn=!!this.store.state.credentials.token}get email(){return this.store.state.credentials.email}get signedIn(){return this._signedIn}verifyAuthentication(e,t,n){var a=this;const i=this.socket.channel(e);return new Promise((e,r)=>{i.onError(()=>{i.leave(),r()}),i.join().receive("ok",()=>{i.on("auth_credentials",function(){var t=o((function*({credentials:t,payload:n}){yield a.handleAuthCredentials(n.email,t),e()}));return function(e){return t.apply(this,arguments)}}()),i.push("auth_verified",{token:t,payload:n})}).receive("error",r)})}startAuthentication(e,t){var n=this;return o((function*(){const a=n.socket.channel("auth:".concat(i()()));yield new Promise((e,t)=>a.join().receive("ok",e).receive("error",t));const r=new Promise(i=>a.on("auth_credentials",function(){var a=o((function*({credentials:a}){yield n.handleAuthCredentials(e,a,t),i()}));return function(e){return a.apply(this,arguments)}}()));return a.push("auth_request",{email:e,origin:"hubs"}),{authComplete:r}}))()}handleAuthCredentials(e,t,n){var a=this;return o((function*(){a.store.update({credentials:{email:e,token:t}}),n&&(yield n.signIn(t)),a._signedIn=!0}))()}}},95:function(e,t,n){},97:function(e,t,n){"use strict";function a(e,t,n,a,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,i)}n.d(t,"a",(function(){return r}));const i=void 0!==window.createImageBitmap&&!1===/Firefox/.test(navigator.userAgent);class r extends THREE.TextureLoader{constructor(e){super(e)}load(e,t,n,a){const r=i?this.loadImageBitmapTexture(e,t,n,a):super.load(e,t,n,a);return r.onUpdate=function(){r.image.close&&r.image.close(),delete r.image},r}loadAsync(e,t){var n,i=this;return(n=function*(){return new Promise((n,a)=>{i.load(e,n,t,a)})},function(){var e=this,t=arguments;return new Promise((function(i,r){var o=n.apply(e,t);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)}))})()}loadImageBitmapTexture(e,t,n,a){const i=new THREE.Texture,r=new THREE.ImageBitmapLoader(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(e,n=>{i.image=n,i.needsUpdate=!0,THREE.Cache.remove(this.manager.resolveURL(e)),void 0!==t&&t(i)},n,a),i.flipY=!1,i}}},99:function(e,t,n){e.exports={touchZone:"virtual-gamepad-controls__touchZone__1KF_C",left:"virtual-gamepad-controls__left__1-URB",right:"virtual-gamepad-controls__right__1cgnU",mockJoystickContainer:"virtual-gamepad-controls__mockJoystickContainer__1aH3e",mockJoystick:"virtual-gamepad-controls__mockJoystick__2CuCG",hidden:"virtual-gamepad-controls__hidden__2ev3w",inner:"virtual-gamepad-controls__inner__1Bn3C"}}});
//# sourceMappingURL=hub-a6c90215e64baf4dbee3.js.map