{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/punycode/punycode.js","webpack:///./src/utils/three-utils.js","webpack:///./src/utils/detect-touchscreen.js","webpack:///./node_modules/@formatjs/intl-locale/polyfill.js","webpack:///./node_modules/@formatjs/intl-locale/index.js","webpack:///./node_modules/@formatjs/intl-locale/node_modules/tslib/tslib.es6.js","webpack:///./src/utils/qs_truthy.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/index.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/src/canonicalizer.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/src/data/aliases.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/src/types.js","webpack:///./node_modules/@formatjs/intl-locale/get_internal_slots.js","webpack:///./node_modules/@formatjs/intl-locale/should-polyfill.js","webpack:///./node_modules/@formatjs/intl-pluralrules/polyfill.js","webpack:///./node_modules/@formatjs/intl-pluralrules/index.js","webpack:///./node_modules/@formatjs/intl-pluralrules/node_modules/tslib/tslib.es6.js","webpack:///./node_modules/@formatjs/intl-pluralrules/get_internal_slots.js","webpack:///./src/utils/async-utils.js","webpack:///./node_modules/@formatjs/intl-pluralrules/should-polyfill.js","webpack:///./node_modules/@formatjs/intl-pluralrules/locale-data/en.js","webpack:///./src/assets/locales lazy ^\\.\\/.*\\.json$ namespace object","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/url/util.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./src/utils/next-tick.js","webpack:///./src/avatar.js","webpack:///./src/utils/i18n.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/image-bitmap-utils.js","webpack:///./src/assets/stylesheets/avatar.scss?a817","webpack:///./node_modules/url/url.js","webpack:///./src/utils/media-url-utils.js","webpack:///./src/assets/locales/locale_config.js","webpack:///./src/react-components/styles/theme.js","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/utils/promisify-worker.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./node_modules/three-mesh-bvh/src/MeshBVHNode.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/ArrayBoxUtilities.js","webpack:///./node_modules/three-mesh-bvh/src/buildFunctions.js","webpack:///./node_modules/three-mesh-bvh/src/Constants.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/SeparatingAxisBounds.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/MathUtilities.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/SeparatingAxisTriangle.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/OrientedBox.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/TriangleUtils.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/ThreeIntersectionUtilities.js","webpack:///./node_modules/three-mesh-bvh/src/Utils/RayIntersectTriUtlities.js","webpack:///./node_modules/three-mesh-bvh/src/castFunctions.js","webpack:///./node_modules/three-mesh-bvh/src/castFunctionsBuffer.js","webpack:///./node_modules/three-mesh-bvh/src/MeshBVH.js","webpack:///./node_modules/three-mesh-bvh/src/MeshBVHVisualizer.js","webpack:///./node_modules/three-mesh-bvh/src/MeshBVHDebug.js","webpack:///./node_modules/three-mesh-bvh/src/index.js","webpack:///./src/components/layers.js","webpack:///./node_modules/worker-loader/dist/workers/InlineWorker.js","webpack:///./src/workers/sketchfab-zip.worker.js","webpack:///./src/App.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/node_modules/tslib/tslib.es6.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/components/environment-map.js","webpack:///./src/react-components/avatar-preview.js","webpack:///./src/utils/history.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/logging.js","webpack:///./src/utils/configs.js","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/src/parser.js","webpack:///./src/assets/images/avatar_unavailable.png","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./node_modules/@formatjs/intl-getcanonicallocales/src/emitter.js","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/assets/stylesheets/avatar-preview.scss?0bdf","webpack:///./src/assets/models/DefaultAvatar.glb","webpack:///./src/react-components/wrapped-intl-provider.js","webpack:///./src/assets/images/app-logo.png","webpack:///./src/assets/images/app-logo-dark.png","webpack:///./src/assets/images/company-logo.png","webpack:///./src/assets/images/home-hero-background-unbranded.png","webpack:///./src/assets/images/editor-logo.png","webpack:///./node_modules/deepmerge/dist/es.js","webpack:///./src/utils/media-devices-utils.js","webpack:///./src/utils/is-mobile.js","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/get-color-scheme-pref.js","webpack:///./src/utils/avatar-utils.js","webpack:///./src/utils/theme.js","webpack:///./node_modules/process/browser.js","webpack:///./src/loaders/HubsTextureLoader.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","root","nodeType","freeGlobal","global","self","punycode","maxInt","regexPunycode","regexNonASCII","regexSeparators","errors","floor","Math","stringFromCharCode","String","fromCharCode","RangeError","map","array","fn","mapDomain","string","parts","split","replace","join","ucs2decode","extra","output","counter","charCodeAt","ucs2encode","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","baseMinusTMin","base","decode","input","out","basic","index","oldi","w","baseMinusT","codePoint","inputLength","bias","lastIndexOf","encode","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","test","toLowerCase","tempVector3","THREE","Vector3","Quaternion","getLastWorldPosition","updateMatrices","setFromMatrixPosition","matrixWorld","getLastWorldQuaternion","decompose","disposeMaterial","mtrl","dispose","lightMap","bumpMap","normalMap","specularMap","envMap","disposeNode","node","Mesh","geometry","material","materialArray","MeshFaceMaterial","MultiMaterial","materials","Array","forEach","IDENTITY","Matrix4","identity","tempMatrix4","setMatrixWorld","object3D","matrixIsModified","applyMatrix4","copy","parent","matrix","invert","multiply","position","quaternion","scale","near","childrenNeedMatrixWorldUpdate","cloneAnimationClip","sourceAnimationClip","cloneUUIDLookup","clonedTracks","tracks","keyframeTrack","sourceKeyframeTrack","nodeName","uuid","objectName","objectIndex","propertyName","propertyIndex","PropertyBinding","parseTrackName","path","clonedUUID","warn","clonedKeyframeTrack","clone","cloneKeyframeTrack","AnimationClip","duration","cloneObject3D","source","preserveUUIDs","cloneLookup","Map","parallelTraverse","a","b","callback","children","sourceNode","clonedNode","set","traverse","animations","animationClip","isMesh","boundsTree","isDirectionalLight","isSpotLight","isSkinnedMesh","sourceBones","skeleton","bones","sourceBone","has","bindMatrix","findNode","pred","nodes","concat","interpolateAffine","mat4","end","start","interpolated","startMat4","endMat4","progress","outMat4","setFromRotationMatrix","extractRotation","slerpQuaternions","lerpVectors","setFromMatrixColumn","setFromMatrixScale","compose","posA","posB","affixToWorldUp","inRotationMat4","inForward","outForward","outSide","worldUp","v","inMat4Copy","inMat4","multiplyScalar","sub","projectOnVector","normalize","crossVectors","makeBasis","setPosition","calculateCameraTransformForWaypoint","upAffixedCameraTransform","upAffixedWaypointTransform","detachFromWorldUp","cameraTransform","waypointTransform","calculateViewingDistance","fov","aspect","box","center","vrMode","halfYExtents","max","abs","y","min","halfXExtents","x","halfVertFOV","degToRad","halfHorFOV","atan","tan","length1","length2","length3","z","rotateInPlaceAroundWorldUp","startRotation","endRotation","theta","makeRotationY","childMatch","inverseParentWorld","childRelativeToParent","childInverse","newParentMatrix","child","multiplyMatrices","createPlaneBufferGeometry","width","height","widthSegments","heightSegments","flipY","PlaneBufferGeometry","uv","getAttribute","count","setY","getY","createHeadlessModelForSkinnedMesh","mesh","eraseBoneIndexes","bone","isEraseTarget","layers","Layers","CAMERA_LAYER_THIRD_PERSON_ONLY","erasingBonesIndex","dst","SkinnedMesh","frustumCulled","CAMERA_LAYER_FIRST_PERSON_ONLY","skinIndexAttr","skinIndex","skinWeightAttr","skinWeight","getIndex","oldTriangles","from","triangles","bws","exclude","bw0","skin0","includes","bw1","skin1","bw2","skin2","excludeTriangles","newTriangle","setIndex","onBeforeRender","Skeleton","boneInverses","createErasedMesh","enable","hackyMobileSafariTestValue","hackyMobileSafariTest","navigator","userAgent","hasTouchScreen","maxTouchPoints","msMaxTouchPoints","mQ","matchMedia","media","matches","UA","detectTouchScreen","_1","shouldPolyfill","Intl","Locale","writable","configurable","tslib_1","ecma402_abstract_1","intl_getcanonicallocales_1","likelySubtagsData","__importStar","get_internal_slots_1","__importDefault","likelySubtags","supplemental","RELEVANT_EXTENSION_KEYS","UNICODE_TYPE_REGEX","mergeUnicodeLanguageId","lang","region","variants","replacement","__spreadArrays","addLikelySubtags","tag","ast","parseUnicodeLocaleId","unicodeLangId","match_1","emitUnicodeLanguageId","parts_1","parseUnicodeLanguageId","emitUnicodeLocaleId","match_2","parts_2","match_3","parts_3","match","opts","this","constructor","TypeError","internalSlots","options","relevantExtensionKeys","internalSlotsList","indexOf","default","initializedLocale","locale","toString","invariant","isStructurallyValidLanguageTag","language","GetOption","isUnicodeLanguageSubtag","isUnicodeScriptSubtag","isUnicodeRegionSubtag","languageId","getCanonicalLocales","__assign","applyOptionsToTag","ToObject","opt","calendar","ca","collation","co","hc","kf","kn","_kn","numberingSystem","nu","unicodeExtension","keywords","_i","_a","extensions","ext","isArray","_b","relevantExtensionKeys_1","entry","_c","keywords_1","keyword","optionsValue","attributes","applyUnicodeExtensionToTag","hourCycle","caseFirst","numeric","SameValue","maximize","minimize","maxLocale","removeLikelySubtags","extendStatics","setPrototypeOf","__proto__","__extends","__","assign","arguments","__rest","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","step","next","rejected","done","then","__generator","body","f","g","_","label","sent","trys","ops","verb","iterator","op","pop","__createBinding","k2","__exportStar","__values","__read","ar","__spread","il","jl","__spreadArray","to","__await","__asyncGenerator","asyncIterator","resume","fulfill","settle","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__setModuleDefault","mod","__classPrivateFieldGet","receiver","privateMap","__classPrivateFieldSet","qs","URLSearchParams","location","search","qsTruthy","param","val","qsGet","parser_1","emitter_1","canonicalizer_1","locales","seen","locales_1","canonicalizedTag","canonicalizeUnicodeLocaleId","CanonicalizeLocaleList","parser_2","canonicalizeUnicodeLanguageId","aliases_1","canonicalizeKVs","arr","arr_1","kv","sort","compareKV","t1","t2","compareExtension","e1","e2","mergeVariants","v1","v2","v2_1","unicodeLanguageId","finalLangAst","replacedLang_1","variant","languageAlias","replacedLangAst","SEPARATOR","replacedLang_2","replacedLang_3","replacedLang","toUpperCase","regionAlias","territoryAlias","replacedRegion","regions","likelySubtag","likelyRegion","scriptAlias","variantAlias","alias","isUnicodeVariantSubtag","extension","strs","keys","reduce","str","fields","internalSlotMap","WeakMap","hasIntlGetCanonicalLocalesBug","PluralRules","validateInstance","instance","method","PluralRuleSelect","_n","IntegerDigits","NumberOfFractionDigits","FractionDigits","localeData","InitializePluralRules","availableLocales","getDefaultLocale","getInternalSlots","resolvedOptions","field","pluralCategories","categories","select","ToNumber","ResolvePlural","supportedLocalesOf","SupportedLocales","__addLocaleData","data_1","add","__defaultLocale","Set","polyfilled","ex","waitForEvent","eventName","eventObj","addEventListener","once","waitForDOMContentLoaded","readyState","sleep","milliseconds","minimumFractionDigits","ord","v0","t0","Number","n10","n100","webpackAsyncContext","req","code","ids","id","webpackPolyfill","deprecate","paths","isString","arg","isObject","isNull","isNullOrUndefined","parse","stringify","obj","prop","sep","eq","regexp","maxKeys","len","kstr","vstr","idx","substr","decodeURIComponent","xs","stringifyPrimitive","isFinite","objectKeys","ks","encodeURIComponent","res","nextTick","log","process","disableiOSZoom","APP","App","AvatarPage","React","Component","props","super","storeUpdated","forceUpdate","refetchAvatar","avatar","fetchAvatar","avatarId","setState","setAvatar","preventDefault","store","update","profile","state","avatar_id","handleCopyAvatar","copyState","remixAvatar","copyMessage","componentDidMount","componentWillUnmount","removeEventListener","render","className","styles","avatarLanding","classNames","darkened","defaultMessage","selectedAvatarId","isSelected","onSubmit","title","attributions","creator","preview","avatarGltfUrl","gltf_url","copyTip","allow_remixing","editAvatar","onClick","icon","faClone","selectedMessage","disabled","formSubmit","logo","configs","image","alt","propTypes","PropTypes","intl","pathname","substring","ReactDOM","getElementById","defaultLocaleData","cachedMessages","_locale","_localeData","setLocale","resolvedLocale","curLocale","AVAILABLE_LOCALES","FALLBACK_LOCALES","primaryLanguageSubtag","findLocale","CustomEvent","interval","getLocale","getMessage","getMessages","configTranslations","entries","messages","acc","raycast","acceleratedRaycast","gltfCache","cache","gltf","retain","cacheItem","release","scene","delete","inflightGltfs","extractZipFile","promisifyWorker","SketchfabZipWorker","defaultInflator","el","componentName","componentData","AFRAME","components","multiple","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","getHubsComponentsFromMaterial","GLTFModelPlus","registerComponent","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","entityComponents","materialComponents","append","classList","rotation","order","setFromQuaternion","matrixNeedsUpdate","matrixAutoUpdate","setObject3D","generateUUID","morphTargetInfluences","gltfIndex","inflatedEntity","isFirstInflation","objectInflations","objectInflation","resolveNodeRefs","propName","__mhc_link_type","attachTemplate","templateRoot","targetEls","querySelectorAll","cloneNode","getHubsComponentsExtension","extras","ktxLoader","dracoLoader","GLTFHubsPlugin","parser","jsonPreprocessor","textureLoader","HubsTextureLoader","manager","beforeRoot","json","version","oldHeightfieldNode","find","heightfield","light","range","decay","runMigration","afterRoot","Object3D","DefaultMatrixAutoUpdate","materialQuality","preferences","materialQualitySetting","updateMaterials","convertStandardMaterial","animation","track","parsedPath","scenes","GLTFHubsComponentsExtension","deps","resolveComponents","gltfRootType","associations","getDependency","loadedDep","textures","MOZ_texture_rgbe","encoding","sRGBEncoding","mapMaterials","GLTFHubsLightMapExtension","loadMaterial","materialIndex","materialDef","extensionDef","pending","results","lightMapIntensity","intensity","GLTFHubsTextureBasisExtension","basisLoader","loadTexture","textureIndex","textureDef","BasisTextureLoader","detectSupport","renderer","images","loadTextureImage","GLTFMozTextureRGBE","loader","minFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","NearestFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","LinearFilter","loadGLTF","contentType","onProgress","fileMap","gltfUrl","loadingManager","LoadingManager","setURLModifier","getCustomGLTFParserURLResolver","gltfLoader","GLTFLoader","register","RGBELoader","setDataType","HalfFloatType","KTX2Loader","DRACOLoader","setKTX2Loader","setDRACOLoader","load","finally","URL","revokeObjectURL","loadModel","useCache","resolveAsset","charAt","assetEl","schema","inflate","batch","init","loadTemplates","play","sceneEl","emit","applySrc","remove","model","systems","batchManagerSystem","removeObject","object3DMap","templateEl","importNode","firstElementChild","content","lastSrc","inflatedEl","disposeLastInflatedEl","addObject","initMixer","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","isInterleavedBufferAttribute","triCount","MeshBVH","strategy","maxDepth","object3DToSet","visible","inflateComponents","rewires","format","parentNode","removeChild","removeAttribute","createImageBitmap","srcUrl","Blob","createObjectURL","canvas","ctx","getContext","putImageData","toDataURL","img","disposeImageBitmap","imageBitmap","HTMLImageElement","startsWith","close","util","Url","protocol","slashes","auth","host","port","hostname","hash","query","href","urlParse","relative","resolveObject","protocolPattern","portPattern","simplePathPattern","unwise","autoEscape","nonHostChars","hostEndingChars","hostnamePartPattern","hostnamePartStart","unsafeProtocol","hostlessProtocol","slashedProtocol","querystring","url","parseQueryString","slashesDenoteHost","u","queryIndex","splitter","uSplit","rest","trim","simplePath","exec","proto","lowerProto","atSign","hostEnd","hec","parseHost","ipv6Hostname","hostparts","part","newpart","validParts","notHost","bit","unshift","toASCII","h","ae","esc","escape","qm","rel","tkeys","tk","tkey","rkeys","rk","rkey","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","authInHost","last","hasTrailingSlash","up","isAbsolute","nonCorsProxyDomains","NON_CORS_PROXY_DOMAINS","CORS_PROXY_SERVER","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","basis","ktx2","m3u8","mpd","farsparkEncodeUrl","btoa","p1","scaledThumbnailUrlFor","pathParts","extensionCandidate","thumbnailUrl","THUMBNAIL_SERVER","urlHostname","hasReticulumServer","RETICULUM_SERVER","isNonCorsProxyDomain","domain","endsWith","proxiedUrlFor","parsedUrl","getAbsoluteHref","baseUrl","relativeUrl","getAbsoluteUrl","rewriteBasisTranscoderUrls","basisJsUrl","basisWasmUrl","dracoWrapperJsUrl","dracoWasmUrl","corsProxyPrefix","originalUrlParts","dataUrlRegex","guessContentType","originIsHubsServer","isHubsServer","origin","fetch","headers","hubsSceneRegex","hubsAvatarRegex","hubsRoomRegex","isLocalHubsUrl","isHubsSceneUrl","isLocalHubsSceneUrl","isHubsAvatarUrl","isLocalHubsAvatarUrl","isHubsRoomUrl","groups","idForAvatarUrl","en","pt","ja","es","ru","fr","ko","de","jp","config","APP_CONFIG","STORYBOOK_APP_CONFIG","JSON","theme","themes","useTheme","themeId","darkMode","setDarkMode","useState","useEffect","darkmodeQuery","addListener","useDarkMode","darkModeDefault","variables","styleTag","innerHTML","ThemeProvider","setThemeId","onStoreChanged","nextThemeId","useThemeFromStore","worker","nextItemId","outstanding","onmessage","msg","handlers","transfer","args","postMessage","payload","EMPTY_RESULT","meta","URL_SOURCE_TO_TO_API_SOURCE","videos","youtube","gifs","sketchfab","twitch","favorites","SOURCES","filter","apiSource","integration","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","_update","dispatchEvent","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","searchParams","locationSearchParams","isMy","languages","singular","credentialsAccountId","getReticulumFetchUrl","lastSavedUrl","isFetching","fetchReticulumAuthenticated","nextCursor","next_cursor","lastFetchedUrl","pageNavigate","history","goBack","pushHistoryPath","filterQueryNavigate","getSearchClearedSearchParams","keepSource","keepNav","keepSelectAction","_stashLastSearchParams","_stashedParams","_stashedSource","clearStashedQuery","sourceNavigate","_sourceNavigate","sourceNavigateToDefaultSource","sourceNavigateWithNoNav","selectAction","hideNav","useLastStashedParams","currentQuery","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","withSlug","sluglessPath","pushExitMediaBrowserHistory","stashLastSearchParams","hasMediaPath","setHistory","listen","isIOS","detectIOS","lastTouchAtMs","ev","now","Date","getTime","isDoubleTouch","MeshBVHNode","arrayToBox","getLongestEdgeIndex","bounds","splitDimIdx","splitDist","Infinity","dist","FLOAT32_EPSILON","pow","boxTemp","getBounds","triangleBounds","offset","centroidTarget","minx","miny","minz","maxx","maxy","maxz","cminx","cminy","cminz","cmaxx","cmaxy","cmaxz","includeCentroid","cx","hx","lx","rx","cy","hy","ly","ry","cz","hz","lz","rz","getCentroidBounds","buildTree","splitNode","centroidBoundingData","depth","reachedMaxDepth","verbose","maxLeafTris","nodeBoundingData","sahPlanes","axis","pos","avg","getAverage","TRAVERSAL_COST","INTERSECTION_COST","bb","dim","sa","filteredLists","planes","getCost","sal","nl","sar","nr","bestCost","o1","o2","bmin","bmax","pinfo","ldim","rdim","ldimo1","rdimo1","ldimo2","rdimo2","cost","getOptimalSplit","boundingData","splitOffset","left","right","axisOffset","partition","indexArray","splitAxis","lstart","lcount","Float32Array","lazyGeneration","continueGeneration","cacheCentroidBoundingData","rstart","rcount","vertexCount","Uint32Array","Uint16Array","ensureIndex","verts","tri","tri3","tri6","ai","bi","ci","halfExtents","el2","computeTriangleBounds","computeSAHPlanes","roots","ranges","rangeBoundaries","group","sortedBoundaries","values","getRootIndexRanges","boundingBox","bx","boxToArray","rootBox","union","SeparatingAxisBounds","points","dot","other","setFromBox","boxMin","boxMax","cacheSatBounds","closestPointLineToLine","dir1","dir2","v02","l1","l2","v10","v32","subVectors","d0232","d3210","d3232","d0210","denom","d2","closestPointsSegmentToSegment","paramResult","temp1","temp2","target1","target2","at","closestPointToPoint","p2","closestPoint","closestPoint2","distanceToSquared","sphereIntersectTriangle","closestPointTemp","projectedPointTemp","planeTemp","lineTemp","sphere","triangle","radius","distanceTo","plane","getPlane","distanceToPoint","pp","projectPoint","containsPoint","isSeparatingAxisTriangle","satAxes","fill","satBounds","needsUpdate","axis0","sab0","getNormal","setFromPoints","axis1","sab1","axis2","sab2","axis3","sab3","closestPointToSegment","point1","point2","edge","segment","distSq","closestDistanceSq","nexti","sqrt","intersectsTriangle","saTri2","arr1","arr2","cachedSatBounds","cachedSatBounds2","cachedAxis","satBounds1","satAxes1","sb","isSeparated","satBounds2","satAxes2","sa1","i2","sa2","point","distanceToTriangle","cornerFields","line1","line2","getMidpoint","otherVec","thisVec","f11","f12","f21","f22","isOrientedBox","invMatrix","alignedSatBounds","setTriangle","ta","tb","tc","i3","getX","getZ","minVec","pi","setFromPointsField","intersectsBox","aabbBounds","intersectsSphere","saTri","pointsArr","triSatBounds","triSatAxes","clamp","distanceToBox","xyzFields","segments1","segments2","threshold","getCenter","threshold2","i1","nextIndex","nextIndex2","index2","f1","f2","f3","vA","vB","vC","uvA","uvB","uvC","intersectionPoint","intersectionPointWorld","checkBufferGeometryIntersection","raycaster","ray","fromBufferAttribute","intersection","pA","pB","pC","side","intersectTriangle","distance","far","checkIntersection","getUV","face","normal","faceIndex","intersectTri","intersections","triOffset","intersectTris","intersectClosestTri","boxIntersection","intersectRay","intersectBox","intersects","raycastFirst","xyzAxis","leftToRight","direction","c1","c2","c1Result","c2Result","_triangle","_cachedBox1","_cachedBox2","iterateOverTriangles","intersectsTriangleFunc","contained","shapecast","intersectsBoundsFunc","nodeScoreFunc","cachedBox1","cachedBox2","getLeftOffset","getRightEndOffset","score1","score2","box1","box2","temp","c1Intersection","c1StopTraversal","c2Intersection","c2StopTraversal","triangle2","cachedMesh","invertedMat","obb","obb2","intersectsGeometry","geometryToBvh","cachedObb","computeBoundingBox","thisGeometry","thisIndex","thisPos","raycastBuffer","stride4Offset","stride2Offset","float32Array","_float32Array","uint16Array","_uint16Array","uint32Array","_uint32Array","intersectRayBuffer","raycastFirstBuffer","shapecastBuffer","getLeftOffsetBuffer","getRightEndOffsetBuffer","arrayToBoxBuffer","intersectsGeometryBuffer","bufferStack","_prevBuffer","setBuffer","buffer","clearBuffer","SKIP_GENERATION","tri2","bvh","copyIndexBuffer","finishTree","countNodes","populateBuffer","byteOffset","isLeaf","nextUnusedPointer","_roots","rootData","_isPacked","nodeCount","ArrayBuffer","indexAttribute","newIndex","packData","serialize","rootIndex","_traverseBuffer","BYTES_PER_NODE","_traverseNode","isPacked","closestResult","geomToMesh","orderNodesFunc","boxToMesh","geom","minThreshold","maxThreshold","tempTarget1","tempTarget2","closestDistance","score","sphere1","sphere2","closestPointToGeometry","color","transparent","opacity","tmpInverseMatrix","origMeshRaycastFunc","firstHitOnly","CAMERA_LAYER_DEFAULT","CAMERA_LAYER_XR_LEFT_EYE","CAMERA_LAYER_XR_RIGHT_EYE","CAMERA_LAYER_REFLECTION","CAMERA_LAYER_INSPECT","CAMERA_LAYER_BATCH_INSPECT","CAMERA_LAYER_VIDEO_TEXTURE_TARGET","reflection","inWorldHud","exclusive","oldData","mask","layer","oldValue","newValue","disable","webkitURL","blob","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","getBlob","Worker","Store","mediaSearchStore","hubChannel","mediaDevicesManager","audios","sourceType","audioOverrides","zoneOverrides","audioDebugPanelOverrides","sceneAudioDefaults","gainMultipliers","supplementaryAttenuation","clippingState","mutedState","isAudioPaused","setupRenderer","dataset","aframeCanvas","WebGLRenderer","alpha","antialias","stencil","premultipliedAlpha","preserveDrawingBuffer","logarithmicDepthBuffer","powerPreference","setPixelRatio","devicePixelRatio","debug","checkShaderErrors","physicallyCorrectLights","outputEncoding","domElement","camera","PerspectiveCamera","innerWidth","innerHeight","audioListener","AudioListener","renderClock","Clock","mainTick","_rafTime","xrFrame","getDelta","time","elapsedTime","frame","isPlaying","tick","clock","setAnimationLoop","renderStarted","names","chooseRandom","random","fetchRandomDefaultAvatarId","defaultAvatars","defaultAvatar","STORE_STATE_CACHE_KEY","validator","Validator","defaultMaterialQuality","MATERIAL_QUALITY_OPTIONS","utils","device","isMobile","isMobileVR","qsMobileDefault","qsDefault","isFirefoxReality","SCHEMA","definitions","additionalProperties","properties","displayName","pattern","personalAvatarId","credentials","token","email","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","micMuted","shouldPromptForRefresh","preferredMic","NO_DEVICE_ID","preferredSpeakers","preferredCamera","muteMicOnEntry","disableLeftRightPanning","audioNormalization","invertTouchscreenCameraMove","enableOnScreenJoystickLeft","enableOnScreenJoystickRight","enableGyro","animateWaypointTransitions","showFPSCounter","allowMultipleHubsInstances","disableIdleDetection","fastRoomSwitching","lazyLoadSceneMedia","preferMobileObjectInfoPanel","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","globalSFXVolume","snapRotationDegrees","enableDynamicShadows","disableSoundEffects","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","disableAutoPixelRatio","movementSpeedModifier","disableEchoCancellation","disableNoiseSuppression","disableAutoGainControl","showRtcDebugPanel","showAudioDebugPanel","enableAudioClipping","audioClippingThreshold","cursorSize","nametagVisibility","nametagVisibilityDistance","avatarVoiceLevels","confirmedDiscordRooms","items","confirmedBroadcastedRooms","uploadPromotionTokens","fileId","promotionToken","creatorAssignmentTokens","hubId","creatorAssignmentToken","embedTokens","embedToken","onLoadActions","action","$ref","_signOutOnExpiredAuthToken","jwtDecode","exp","initProfile","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","_preferences","localStorage","getItem","setItem","oauthFlowCredentials","Cookies","getJSON","maybeDispatchThemeChanged","previous","current","detail","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","merge","valid","validate","argument","Function","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","CubeTextureLoader","RGBFormat","require","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","useDevicePixelRatio","context","forceWebVR","ORBIT_ANGLE","Euler","DEG2RAD","fitBoxInFrustum","margin","applyEuler","lookAt","AvatarPreview","Scene","clientWidth","clientHeight","controls","OrbitControls","screenSpacePanning","enableKeys","DirectionalLight","HemisphereLight","loadId","loadCurrentAvatarGltfUrl","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","currentTheme","currentThemeObject","getColorSchemePref","Color","getThemeBackground","dt","mixer","resize","mounted","parentElement","offsetWidth","offsetHeight","setSize","updateProjectionMatrix","resetCamera","loading","Box3","setFromObject","imageBitmaps","componentDidUpdate","oldProps","applyMaps","loadPreviewAvatar","ensureAvatarMaterial","previewMesh","MAT_NAME","idleAnimation","AnimationMixer","clipAction","enabled","setLoop","LoopRepeat","idleAnimationAction","removeOnUpdate","onUpdate","getImage","originalMaps","dependencies","createDefaultEnvironmentMap","applyMapToPreview","revertMap","bm","snapshot","stop","toBlob","newLoadId","onGltfLoaded","newProps","mapName","applyMap","File","srcSet","linebreak","ref","func","injectIntl","forwardRef","pushOrUpdateHistory","newPathname","newSearch","newLength","__historyLength","__duplicate","isDuplicate","pushHistoryState","replaceHistoryState","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","unsubscribe","go","forEachMaterial","HubsMeshBasicMaterial","MeshBasicMaterial","Material","emissive","emissiveIntensity","emissiveMap","aoMap","aoMapIntensity","alphaMap","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","onBeforeCompile","shader","uniforms","_emissive","_emissiveIntensity","_emissiveMap","fragmentShader","HubsMeshPhongMaterial","MeshPhongMaterial","vertexShader","normalMapType","normalScale","bumpScale","displacementMap","displacementScale","displacementBias","reflectivity","refractionRatio","quality","isMeshStandardMaterial","fromMeshStandardMaterial","disposeTexture","dash","reset","HTMLVideoElement","video","pause","hls","stopLoad","detachMedia","destroy","isDebug","logFilter","isAdmin","__webpack_public_path__","hasThumbnailServerMetaTag","colorVars","style","features","featureName","localDevImages","_isAdmin","availableIntegrations","translationsConfig","ALPHANUM_1_8","ALPHANUM_2_8","ALPHANUM_3_8","KEY_REGEX","TYPE_REGEX","ALPHA_4","OTHER_EXTENSION_TYPE","UNICODE_REGION_SUBTAG_REGEX","UNICODE_VARIANT_SUBTAG_REGEX","UNICODE_LANGUAGE_SUBTAG_REGEX","TKEY_REGEX","chunks","parseUnicodeExtension","parseKeyword","parseTransformedExtension","parsePuExtension","exts","parseOtherExtensionValue","transformedExtension","puExtension","otherExtensionMap","parseExtensions","Boolean","extensions_1","WrappedIntlProvider","updateLocale","isRequired","isMergeableObject","isNonNullObject","stringValue","$$typeof","REACT_ELEMENT_TYPE","isReactElement","isSpecial","for","cloneUnlessOtherwiseSpecified","deepmerge","defaultArrayMerge","element","sourceIsArray","destination","mergeObject","prev","deepmerge_1","MediaDevicesEvents","freeze","PERMISSIONS_STATUS_CHANGED","MIC_SHARE_STARTED","MIC_SHARE_ENDED","VIDEO_SHARE_STARTED","VIDEO_SHARE_ENDED","DEVICE_CHANGE","PermissionStatus","GRANTED","DENIED","PROMPT","MediaDevices","MICROPHONE","SPEAKERS","CAMERA","SCREEN","MOBILE_RE","TABLET_RE","isIpadOS","platform","_isMobile","vendor","opera","mockUserAgent","isTablet","adjectives","nouns","generateHubName","randItem","isLocalClient","hubUrl","extraParams","slug","maybeSlug","resolverLink","directReticulumHostAndPort","reticulumMeta","invalidatedReticulumMetaThisSession","absolute","getReticulumMeta","querySelector","pool","phx_host","phxHostOverride","refreshDirectReticulumHostAndPort","RETICULUM_SOCKET_SERVER","getDirectReticulumFetchUrl","invalidateReticulumMeta","connectToReticulum","params","socketClass","Socket","getNewSocketUrl","RETICULUM_SOCKET_PROTOCOL","socketUrl","socketSettings","logger","kind","socket","connect","onError","endPointPath","endPoint","newSocketUrl","newEndPoint","getLandingPageForPhoto","photoUrl","retUrl","authorization","text","createAndRedirectToNewHub","sceneId","createUrl","hub","scene_id","creator_assignment_token","hub_id","embed_token","getPresenceEntryForSession","presences","sessionId","presence","metas","getPresenceContextForSession","getPresenceProfileForSession","migrateBindings","oldChannel","newChannel","doNotDuplicate","bindings","item","bindingRef","migrateChannelToSocket","channel","topic","pushBuffer","oldJoinPush","joinPush","recHooks","receive","status","migrateToChannel","leave","discordBridgesForPresences","channels","discordBridges","hasEmbedPresences","embed","denoisePresence","onJoin","onLeave","onChange","rawOnJoin","beforeJoin","afterJoin","rawOnLeave","remaining","removed","presenceEventsForHub","events","trigger","tryGetMatchingMeta","ret_pool","ret_version","shouldAbandonMigration","didMatchMeta","attempt","delayMS","ceil","AVATAR_TYPES","SKINNABLE","getAvatarType","fetchSkinnableAvatar","resp","avatars","getAvatarSrc","fetchAvatarGltfUrl","getAvatarThumbnailUrl","files","thumbnail","avatarUnavailableImage","materialForMesh","primitives","primitive","meshes","parentId","parent_avatar_listing_id","DEFAULT_COLORS","getThemeColor","activateTheme","actionColor","actionHoverColor","newThemeId","applyThemeToTextButton","highlighted","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","noop","browser","env","argv","versions","on","off","removeListener","removeAllListeners","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","HAS_IMAGE_BITMAP","TextureLoader","onLoad","loadImageBitmapTexture","loadAsync","Texture","ImageBitmapLoader","setCrossOrigin","crossOrigin","setPath","bitmap","Cache","resolveURL"],"mappings":"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,cAAe,MACf,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,QACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,YAAa,iBACb,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,UACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,aAAc,MACd,IAAO,KACP,QAAS,MACT,QAAS,MACT,YAAa,iBACb,aAAc,mBACd,QAAS,MACT,YAAa,MACb,QAAS,KACT,UAAW,gBACX,WAAY,KACZ,QAAS,MACT,QAAS,MACT,QAAS,MACT,QAAS,MACT,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,GAAM,KACN,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,GAAM,KACN,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,GAAM,KACN,SAAU,KACV,YAAa,KACb,SAAU,KACV,aAAc,KACd,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,QACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,YAAa,MACb,YAAa,MACb,SAAU,MACV,YAAa,MACb,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,SAAU,MACV,GAAM,UACN,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,GAAM,MACN,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,QACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,aAAc,SACd,cAAe,MACf,cAAe,MACf,aAAc,MACd,YAAa,MACb,qBAAsB,cACtB,aAAc,MACd,cAAe,MACf,YAAa,MACb,YAAa,MACb,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,IAAO,KACP,IAAO,MACP,IAAO,MACP,IAAO,MACP,SAAU,KACV,cAAe,UACf,cAAe,UACf,SAAU,MACV,WAAY,KACZ,WAAY,MACZ,SAAU,eACV,aAAc,MACd,SAAU,MACV,WAAY,MACZ,SAAU,MACV,IAAO,KACP,IAAO,KACP,IAAO,MACP,IAAO,KACP,IAAO,KACP,IAAO,MAEXrkB,EAAQ6kB,eAAiB,CACrB,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,sCACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,WACP,IAAO,KACP,IAAO,WACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,cACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,+CACP,IAAO,KACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,oBACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,UACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,MAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,WACN,IAAO,KACP,IAAO,WACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,QACN,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,QACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,GAAM,QACN,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,cACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,+CACN,IAAO,+CACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,KACP,GAAM,QACN,IAAO,QACP,IAAO,KACP,IAAO,KACP,IAAO,KACP,GAAM,KACN,IAAO,KACP,IAAO,MAEX7kB,EAAQklB,YAAc,CAClB,KAAQ,QAEZllB,EAAQmlB,aAAe,CACnB,OAAU,UACV,SAAY,Y,iCC/mChBzmB,O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gBV,OAhBUA,EAcP9I,OAAOqS,UAAUC,WAAatS,OAAOqS,UAAUstD,QAAU3/D,OAAO4/D,OAZ7DN,EAAUt7D,KAAK8E,IAAMy2D,EAAUv7D,KAAK8E,EAAEsd,OAAO,EAAG,OAClDs5C,GAAY,IAEV/1B,KA5BR,SAAkBk2B,GAChB,MAAMvtD,EAAYutD,GAAiB7/D,OAAOqS,UAAUC,UACpD,OAAOktD,KAAc,yDAAyDx7D,KAAKsO,GA0BlEwtD,IAtBV,WAAW97D,KAAKhE,OAAOqS,UAAUC,cAuBpCotD,GAAY,GAEVttD,gBACFstD,GAAY,GAEV3W,MACF2W,GAAY,GAIT,WACL,OAAOA,GAnBO,GAuBH5W,O,+oBC3Df,MAAMiX,EAAa,CACjB,OACA,WACA,aACA,YACA,eACA,WACA,SACA,YACA,WACA,cACA,QACA,UACA,UACA,OACA,SACA,UACA,WACA,SACA,WACA,aACA,WACA,SACA,UACA,UACA,OACA,QACA,QACA,UACA,OACA,YACA,WACA,SACA,WACA,OACA,WACA,WACA,SACA,QACA,YACA,MACA,WACA,SACA,UACA,QACA,WACA,WACA,QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA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","file":"assets/js/avatar-8306b4bc022bbc8858ba.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"assets/js/\" + ({}[chunkId]||chunkId) + \"-\" + {\"18\":\"deb590a95f32ad55a327\",\"19\":\"9d314885b4be2546bd4d\",\"20\":\"51602cb7f065a8c1138b\",\"21\":\"6a9f00d0a5e7b80146b6\",\"22\":\"3abf1b2bcf31f38ae0ed\",\"23\":\"94819a85f75533f6e91c\",\"24\":\"1aa12389c4edd8cb52ac\",\"25\":\"6abcf658582e38411709\",\"26\":\"a0114c7e0a3079e69f56\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"https://assets.metaverseplus2.xyz/hubs/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1545,0,2,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  src.updateMatrices();\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    let materialArray;\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\n      materialArray = node.material.materials;\n    } else if (node.material instanceof Array) {\n      materialArray = node.material;\n    }\n    if (materialArray) {\n      materialArray.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n\nconst IDENTITY = new THREE.Matrix4().identity();\nconst tempMatrix4 = new THREE.Matrix4();\nconst EPSILON = 0.00000000001;\nexport function setMatrixWorld(object3D, m) {\n  if (!object3D.matrixIsModified) {\n    object3D.applyMatrix4(IDENTITY); // hack around our matrix optimizations\n  }\n  tempMatrix4.copy(object3D.matrixWorld);\n  object3D.matrixWorld.copy(m);\n  if (object3D.parent) {\n    object3D.parent.updateMatrices();\n    object3D.matrix = object3D.matrix\n      .copy(object3D.parent.matrixWorld)\n      .invert()\n      .multiply(object3D.matrixWorld);\n  } else {\n    object3D.matrix.copy(object3D.matrixWorld);\n  }\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\n  if (tempMatrix4.near(object3D.matrixWorld, EPSILON)) {\n    object3D.matrixWorld.copy(tempMatrix4);\n  } else {\n    object3D.childrenNeedMatrixWorldUpdate = true;\n  }\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\n// Supports the following PropertyBinding path formats:\n// uuid.propertyName\n// uuid.propertyName[propertyIndex]\n// uuid.objectName[objectIndex].propertyName[propertyIndex]\n// Does not support property bindings that use object3D names or parent nodes\nfunction cloneKeyframeTrack(sourceKeyframeTrack, cloneUUIDLookup) {\n  const { nodeName: uuid, objectName, objectIndex, propertyName, propertyIndex } = THREE.PropertyBinding.parseTrackName(\n    sourceKeyframeTrack.name\n  );\n\n  let path = \"\";\n\n  if (uuid !== undefined) {\n    const clonedUUID = cloneUUIDLookup.get(uuid);\n\n    if (clonedUUID === undefined) {\n      console.warn(`Could not find KeyframeTrack target with uuid: \"${uuid}\"`);\n    }\n\n    path += clonedUUID;\n  }\n\n  if (objectName !== undefined) {\n    path += \".\" + objectName;\n  }\n\n  if (objectIndex !== undefined) {\n    path += \"[\" + objectIndex + \"]\";\n  }\n\n  if (propertyName !== undefined) {\n    path += \".\" + propertyName;\n  }\n\n  if (propertyIndex !== undefined) {\n    path += \"[\" + propertyIndex + \"]\";\n  }\n\n  const clonedKeyframeTrack = sourceKeyframeTrack.clone();\n  clonedKeyframeTrack.name = path;\n\n  return clonedKeyframeTrack;\n}\n\nfunction cloneAnimationClip(sourceAnimationClip, cloneUUIDLookup) {\n  const clonedTracks = sourceAnimationClip.tracks.map(keyframeTrack =>\n    cloneKeyframeTrack(keyframeTrack, cloneUUIDLookup)\n  );\n  return new THREE.AnimationClip(sourceAnimationClip.name, sourceAnimationClip.duration, clonedTracks);\n}\n\nexport function cloneObject3D(source, preserveUUIDs) {\n  const cloneLookup = new Map();\n  const cloneUUIDLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, (sourceNode, clonedNode) => {\n    cloneLookup.set(sourceNode, clonedNode);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (preserveUUIDs) {\n      clonedNode.uuid = sourceNode.uuid;\n    }\n\n    cloneUUIDLookup.set(sourceNode.uuid, clonedNode.uuid);\n  });\n\n  source.traverse(sourceNode => {\n    const clonedNode = cloneLookup.get(sourceNode);\n\n    if (!clonedNode) {\n      return;\n    }\n\n    if (sourceNode.animations) {\n      clonedNode.animations = sourceNode.animations.map(animationClip =>\n        cloneAnimationClip(animationClip, cloneUUIDLookup)\n      );\n    }\n\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n\n    if ((clonedNode.isDirectionalLight || clonedNode.isSpotLight) && sourceNode.target) {\n      clonedNode.target = cloneLookup.get(sourceNode.target);\n    }\n\n    if (!sourceNode.isSkinnedMesh) return;\n\n    const sourceBones = sourceNode.skeleton.bones;\n\n    clonedNode.skeleton = sourceNode.skeleton.clone();\n\n    clonedNode.skeleton.bones = sourceBones.map(sourceBone => {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedNode.bind(clonedNode.skeleton, sourceNode.bindMatrix);\n  });\n\n  return clone;\n}\n\nexport function findNode(root, pred) {\n  let nodes = [root];\n  while (nodes.length) {\n    const node = nodes.shift();\n    if (pred(node)) return node;\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n  return null;\n}\n\nexport const interpolateAffine = (function() {\n  const mat4 = new THREE.Matrix4();\n  const end = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const start = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  const interpolated = {\n    position: new THREE.Vector3(),\n    quaternion: new THREE.Quaternion(),\n    scale: new THREE.Vector3()\n  };\n  return function(startMat4, endMat4, progress, outMat4) {\n    start.quaternion.setFromRotationMatrix(mat4.extractRotation(startMat4));\n    end.quaternion.setFromRotationMatrix(mat4.extractRotation(endMat4));\n    interpolated.quaternion.slerpQuaternions(start.quaternion, end.quaternion, progress);\n    interpolated.position.lerpVectors(\n      start.position.setFromMatrixColumn(startMat4, 3),\n      end.position.setFromMatrixColumn(endMat4, 3),\n      progress\n    );\n    interpolated.scale.lerpVectors(\n      start.scale.setFromMatrixScale(startMat4),\n      end.scale.setFromMatrixScale(endMat4),\n      progress\n    );\n    return outMat4.compose(\n      interpolated.position,\n      interpolated.quaternion,\n      interpolated.scale\n    );\n  };\n})();\n\nexport const squareDistanceBetween = (function() {\n  const posA = new THREE.Vector3();\n  const posB = new THREE.Vector3();\n  return function(objA, objB) {\n    objA.updateMatrices();\n    objB.updateMatrices();\n    posA.setFromMatrixColumn(objA.matrixWorld, 3);\n    posB.setFromMatrixColumn(objB.matrixWorld, 3);\n    return posA.distanceToSquared(posB);\n  };\n})();\n\nexport function isAlmostUniformVector3(v, epsilonHalf = 0.005) {\n  return Math.abs(v.x - v.y) < epsilonHalf && Math.abs(v.x - v.z) < epsilonHalf;\n}\nexport function almostEqual(a, b, epsilon = 0.01) {\n  return Math.abs(a - b) < epsilon;\n}\n\nexport const affixToWorldUp = (function() {\n  const inRotationMat4 = new THREE.Matrix4();\n  const inForward = new THREE.Vector3();\n  const outForward = new THREE.Vector3();\n  const outSide = new THREE.Vector3();\n  const worldUp = new THREE.Vector3(); // Could be called \"outUp\"\n  const v = new THREE.Vector3();\n  const inMat4Copy = new THREE.Matrix4();\n  return function affixToWorldUp(inMat4, outMat4) {\n    inRotationMat4.identity().extractRotation(inMat4Copy.copy(inMat4));\n    inForward.setFromMatrixColumn(inRotationMat4, 2).multiplyScalar(-1);\n    outForward\n      .copy(inForward)\n      .sub(v.copy(inForward).projectOnVector(worldUp.set(0, 1, 0)))\n      .normalize();\n    outSide.crossVectors(outForward, worldUp);\n    outMat4.makeBasis(outSide, worldUp, outForward.multiplyScalar(-1));\n    outMat4.scale(v.setFromMatrixScale(inMat4Copy));\n    outMat4.setPosition(v.setFromMatrixColumn(inMat4Copy, 3));\n    return outMat4;\n  };\n})();\n\nexport const calculateCameraTransformForWaypoint = (function() {\n  const upAffixedCameraTransform = new THREE.Matrix4();\n  const upAffixedWaypointTransform = new THREE.Matrix4();\n  const detachFromWorldUp = new THREE.Matrix4();\n  return function calculateCameraTransformForWaypoint(cameraTransform, waypointTransform, outMat4) {\n    affixToWorldUp(cameraTransform, upAffixedCameraTransform);\n    detachFromWorldUp\n      .copy(upAffixedCameraTransform)\n      .invert()\n      .multiply(cameraTransform);\n    affixToWorldUp(waypointTransform, upAffixedWaypointTransform);\n    outMat4.copy(upAffixedWaypointTransform).multiply(detachFromWorldUp);\n  };\n})();\n\nexport const calculateViewingDistance = (function() {\n  return function calculateViewingDistance(fov, aspect, box, center, vrMode) {\n    const halfYExtents = Math.max(Math.abs(box.max.y - center.y), Math.abs(center.y - box.min.y));\n    const halfXExtents = Math.max(Math.abs(box.max.x - center.x), Math.abs(center.x - box.min.x));\n    const halfVertFOV = THREE.Math.degToRad(fov / 2);\n    const halfHorFOV = Math.atan(Math.tan(halfVertFOV) * aspect) * (vrMode ? 0.5 : 1);\n    const margin = 1.05;\n    const length1 = Math.abs((halfYExtents * margin) / Math.tan(halfVertFOV));\n    const length2 = Math.abs((halfXExtents * margin) / Math.tan(halfHorFOV));\n    const length3 = Math.abs(box.max.z - center.z) + Math.max(length1, length2);\n    const length = vrMode ? Math.max(0.25, length3) : length3;\n    return length || 1.25;\n  };\n})();\n\nexport const rotateInPlaceAroundWorldUp = (function() {\n  const inMat4Copy = new THREE.Matrix4();\n  const startRotation = new THREE.Matrix4();\n  const endRotation = new THREE.Matrix4();\n  const v = new THREE.Vector3();\n  return function rotateInPlaceAroundWorldUp(inMat4, theta, outMat4) {\n    inMat4Copy.copy(inMat4);\n    return outMat4\n      .copy(endRotation.makeRotationY(theta).multiply(startRotation.extractRotation(inMat4Copy)))\n      .scale(v.setFromMatrixScale(inMat4Copy))\n      .setPosition(v.setFromMatrixPosition(inMat4Copy));\n  };\n})();\n\nexport const childMatch = (function() {\n  const inverseParentWorld = new THREE.Matrix4();\n  const childRelativeToParent = new THREE.Matrix4();\n  const childInverse = new THREE.Matrix4();\n  const newParentMatrix = new THREE.Matrix4();\n  // transform the parent such that its child matches the target\n  return function childMatch(parent, child, target) {\n    parent.updateMatrices();\n    inverseParentWorld.copy(parent.matrixWorld).invert();\n    child.updateMatrices();\n    childRelativeToParent.multiplyMatrices(inverseParentWorld, child.matrixWorld);\n    childInverse.copy(childRelativeToParent).invert();\n    newParentMatrix.multiplyMatrices(target, childInverse);\n    setMatrixWorld(parent, newParentMatrix);\n  };\n})();\n\nexport function createPlaneBufferGeometry(width, height, widthSegments, heightSegments, flipY = true) {\n  const geometry = new THREE.PlaneBufferGeometry(width, height, widthSegments, heightSegments);\n  // Three.js seems to assume texture flipY is true for all its built in geometry\n  // but we turn this off on our texture loader since createImageBitmap in Firefox\n  // does not support flipping. Then we flip the uv for flipY = false texture.\n  if (flipY === false) {\n    const uv = geometry.getAttribute(\"uv\");\n    for (let i = 0; i < uv.count; i++) {\n      uv.setY(i, 1.0 - uv.getY(i));\n    }\n  }\n  return geometry;\n}\n\nimport { Layers } from \"../components/layers\";\n\n// This code is from three-vrm. We will likely be using that in the future and this inlined code can go away\nfunction excludeTriangles(triangles, bws, skinIndex, exclude) {\n  let count = 0;\n  if (bws != null && bws.length > 0) {\n    for (let i = 0; i < triangles.length; i += 3) {\n      const a = triangles[i];\n      const b = triangles[i + 1];\n      const c = triangles[i + 2];\n      const bw0 = bws[a];\n      const skin0 = skinIndex[a];\n\n      if (bw0[0] > 0 && exclude.includes(skin0[0])) continue;\n      if (bw0[1] > 0 && exclude.includes(skin0[1])) continue;\n      if (bw0[2] > 0 && exclude.includes(skin0[2])) continue;\n      if (bw0[3] > 0 && exclude.includes(skin0[3])) continue;\n\n      const bw1 = bws[b];\n      const skin1 = skinIndex[b];\n      if (bw1[0] > 0 && exclude.includes(skin1[0])) continue;\n      if (bw1[1] > 0 && exclude.includes(skin1[1])) continue;\n      if (bw1[2] > 0 && exclude.includes(skin1[2])) continue;\n      if (bw1[3] > 0 && exclude.includes(skin1[3])) continue;\n\n      const bw2 = bws[c];\n      const skin2 = skinIndex[c];\n      if (bw2[0] > 0 && exclude.includes(skin2[0])) continue;\n      if (bw2[1] > 0 && exclude.includes(skin2[1])) continue;\n      if (bw2[2] > 0 && exclude.includes(skin2[2])) continue;\n      if (bw2[3] > 0 && exclude.includes(skin2[3])) continue;\n\n      triangles[count++] = a;\n      triangles[count++] = b;\n      triangles[count++] = c;\n    }\n  }\n  return count;\n}\n\nfunction createErasedMesh(src, erasingBonesIndex) {\n  const dst = new THREE.SkinnedMesh(src.geometry.clone(), src.material);\n  dst.name = `${src.name}(headless)`;\n  dst.frustumCulled = src.frustumCulled;\n  dst.layers.set(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n\n  const geometry = dst.geometry;\n\n  const skinIndexAttr = geometry.getAttribute(\"skinIndex\").array;\n  const skinIndex = [];\n  for (let i = 0; i < skinIndexAttr.length; i += 4) {\n    skinIndex.push([skinIndexAttr[i], skinIndexAttr[i + 1], skinIndexAttr[i + 2], skinIndexAttr[i + 3]]);\n  }\n\n  const skinWeightAttr = geometry.getAttribute(\"skinWeight\").array;\n  const skinWeight = [];\n  for (let i = 0; i < skinWeightAttr.length; i += 4) {\n    skinWeight.push([skinWeightAttr[i], skinWeightAttr[i + 1], skinWeightAttr[i + 2], skinWeightAttr[i + 3]]);\n  }\n\n  const index = geometry.getIndex();\n  if (!index) {\n    throw new Error(\"The geometry doesn't have an index buffer\");\n  }\n  const oldTriangles = Array.from(index.array);\n\n  const count = excludeTriangles(oldTriangles, skinWeight, skinIndex, erasingBonesIndex);\n  const newTriangle = [];\n  for (let i = 0; i < count; i++) {\n    newTriangle[i] = oldTriangles[i];\n  }\n  geometry.setIndex(newTriangle);\n\n  if (src.onBeforeRender) {\n    dst.onBeforeRender = src.onBeforeRender;\n  }\n\n  dst.bind(new THREE.Skeleton(src.skeleton.bones, src.skeleton.boneInverses), new THREE.Matrix4());\n\n  return dst;\n}\n\nfunction isEraseTarget(bone) {\n  return bone.name === \"Head\" || (bone.parent && isEraseTarget(bone.parent));\n}\n\nexport function createHeadlessModelForSkinnedMesh(mesh) {\n  const eraseBoneIndexes = [];\n  mesh.skeleton.bones.forEach((bone, index) => {\n    if (isEraseTarget(bone)) eraseBoneIndexes.push(index);\n  });\n\n  if (!eraseBoneIndexes.length) {\n    mesh.layers.enable(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n    mesh.layers.enable(Layers.CAMERA_LAYER_FIRST_PERSON_ONLY);\n    return;\n  }\n\n  mesh.layers.set(Layers.CAMERA_LAYER_THIRD_PERSON_ONLY);\n\n  return createErasedMesh(mesh, eraseBoneIndexes);\n}\n","// from https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\nfunction detectTouchScreen() {\n  let hasTouchScreen = false;\n  if (\"maxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.maxTouchPoints > 0;\n  } else if (\"msMaxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.msMaxTouchPoints > 0;\n  } else {\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\");\n    if (mQ && mQ.media === \"(pointer:coarse)\") {\n      hasTouchScreen = !!mQ.matches;\n    } else if (\"orientation\" in window) {\n      hasTouchScreen = true; // deprecated, but good fallback\n    } else {\n      // Only as a last resort, fall back to user agent sniffing\n      const UA = navigator.userAgent;\n      hasTouchScreen =\n        /\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(UA) || /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(UA);\n    }\n  }\n  return hasTouchScreen;\n}\n\nlet hackyMobileSafariTestValue = null;\n\n// HACK for https://github.com/mozilla/hubs/issues/1813\n// Touchscreen controls depend on iPad and iPhone detection,\n// which recently regressed. For UA matching \"Macintosh\", enable\n// touchscreen controls if there exists a touchscreen.\n// We cannot always enable touchscreen controls when a touchscreen\n// is present until we fix conflicts between simultaneous mouse\n// and touchscreen interactions.\nexport function hackyMobileSafariTest() {\n  if (hackyMobileSafariTestValue === null) {\n    hackyMobileSafariTestValue = /\\b(Macintosh|iPad|iPhone)\\b/i.test(navigator.userAgent) && detectTouchScreen();\n  }\n\n  return hackyMobileSafariTestValue;\n  // e.g. Match\n  // Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Safari/605.1.15\n  // but not\n  // \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\"\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _1 = require(\"./\");\nvar should_polyfill_1 = require(\"./should-polyfill\");\nif (should_polyfill_1.shouldPolyfill()) {\n    Object.defineProperty(Intl, 'Locale', {\n        value: _1.Locale,\n        writable: true,\n        enumerable: false,\n        configurable: true,\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Locale = void 0;\nvar tslib_1 = require(\"tslib\");\nvar ecma402_abstract_1 = require(\"@formatjs/ecma402-abstract\");\nvar intl_getcanonicallocales_1 = require(\"@formatjs/intl-getcanonicallocales\");\nvar likelySubtagsData = tslib_1.__importStar(require(\"cldr-core/supplemental/likelySubtags.json\"));\nvar get_internal_slots_1 = tslib_1.__importDefault(require(\"./get_internal_slots\"));\nvar likelySubtags = likelySubtagsData.supplemental.likelySubtags;\nvar RELEVANT_EXTENSION_KEYS = ['ca', 'co', 'hc', 'kf', 'kn', 'nu'];\nvar UNICODE_TYPE_REGEX = /^[a-z0-9]{3,8}(-[a-z0-9]{3,8})*$/i;\nfunction applyOptionsToTag(tag, options) {\n    ecma402_abstract_1.invariant(typeof tag === 'string', 'language tag must be a string');\n    ecma402_abstract_1.invariant(intl_getcanonicallocales_1.isStructurallyValidLanguageTag(tag), 'malformed language tag', RangeError);\n    var language = ecma402_abstract_1.GetOption(options, 'language', 'string', undefined, undefined);\n    if (language !== undefined) {\n        ecma402_abstract_1.invariant(intl_getcanonicallocales_1.isUnicodeLanguageSubtag(language), 'Malformed unicode_language_subtag', RangeError);\n    }\n    var script = ecma402_abstract_1.GetOption(options, 'script', 'string', undefined, undefined);\n    if (script !== undefined) {\n        ecma402_abstract_1.invariant(intl_getcanonicallocales_1.isUnicodeScriptSubtag(script), 'Malformed unicode_script_subtag', RangeError);\n    }\n    var region = ecma402_abstract_1.GetOption(options, 'region', 'string', undefined, undefined);\n    if (region !== undefined) {\n        ecma402_abstract_1.invariant(intl_getcanonicallocales_1.isUnicodeRegionSubtag(region), 'Malformed unicode_region_subtag', RangeError);\n    }\n    var languageId = intl_getcanonicallocales_1.parseUnicodeLanguageId(tag);\n    if (language !== undefined) {\n        languageId.lang = language;\n    }\n    if (script !== undefined) {\n        languageId.script = script;\n    }\n    if (region !== undefined) {\n        languageId.region = region;\n    }\n    return Intl.getCanonicalLocales(intl_getcanonicallocales_1.emitUnicodeLocaleId(tslib_1.__assign(tslib_1.__assign({}, intl_getcanonicallocales_1.parseUnicodeLocaleId(tag)), { lang: languageId })))[0];\n}\nfunction applyUnicodeExtensionToTag(tag, options, relevantExtensionKeys) {\n    var unicodeExtension;\n    var keywords = [];\n    var ast = intl_getcanonicallocales_1.parseUnicodeLocaleId(tag);\n    for (var _i = 0, _a = ast.extensions; _i < _a.length; _i++) {\n        var ext = _a[_i];\n        if (ext.type === 'u') {\n            unicodeExtension = ext;\n            if (Array.isArray(ext.keywords))\n                keywords = ext.keywords;\n        }\n    }\n    var result = Object.create(null);\n    for (var _b = 0, relevantExtensionKeys_1 = relevantExtensionKeys; _b < relevantExtensionKeys_1.length; _b++) {\n        var key = relevantExtensionKeys_1[_b];\n        var value = void 0, entry = void 0;\n        for (var _c = 0, keywords_1 = keywords; _c < keywords_1.length; _c++) {\n            var keyword = keywords_1[_c];\n            if (keyword[0] === key) {\n                entry = keyword;\n                value = entry[1];\n            }\n        }\n        ecma402_abstract_1.invariant(key in options, key + \" must be in options\");\n        var optionsValue = options[key];\n        if (optionsValue !== undefined) {\n            ecma402_abstract_1.invariant(typeof optionsValue === 'string', \"Value for \" + key + \" must be a string\");\n            value = optionsValue;\n            if (entry) {\n                entry[1] = value;\n            }\n            else {\n                keywords.push([key, value]);\n            }\n        }\n        result[key] = value;\n    }\n    if (!unicodeExtension) {\n        if (keywords.length) {\n            ast.extensions.push({\n                type: 'u',\n                keywords: keywords,\n                attributes: [],\n            });\n        }\n    }\n    else {\n        unicodeExtension.keywords = keywords;\n    }\n    result.locale = Intl\n        .getCanonicalLocales(intl_getcanonicallocales_1.emitUnicodeLocaleId(ast))[0];\n    return result;\n}\nfunction mergeUnicodeLanguageId(lang, script, region, variants, replacement) {\n    if (variants === void 0) { variants = []; }\n    if (!replacement) {\n        return {\n            lang: lang || 'und',\n            script: script,\n            region: region,\n            variants: variants,\n        };\n    }\n    return {\n        lang: !lang || lang === 'und' ? replacement.lang : lang,\n        script: script || replacement.script,\n        region: region || replacement.region,\n        variants: tslib_1.__spreadArrays(variants, replacement.variants),\n    };\n}\nfunction addLikelySubtags(tag) {\n    var ast = intl_getcanonicallocales_1.parseUnicodeLocaleId(tag);\n    var unicodeLangId = ast.lang;\n    var lang = unicodeLangId.lang, script = unicodeLangId.script, region = unicodeLangId.region, variants = unicodeLangId.variants;\n    if (script && region) {\n        var match_1 = likelySubtags[intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, script: script, region: region, variants: [] })];\n        if (match_1) {\n            var parts_1 = intl_getcanonicallocales_1.parseUnicodeLanguageId(match_1);\n            ast.lang = mergeUnicodeLanguageId(undefined, undefined, undefined, variants, parts_1);\n            return intl_getcanonicallocales_1.emitUnicodeLocaleId(ast);\n        }\n    }\n    if (script) {\n        var match_2 = likelySubtags[intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, script: script, variants: [] })];\n        if (match_2) {\n            var parts_2 = intl_getcanonicallocales_1.parseUnicodeLanguageId(match_2);\n            ast.lang = mergeUnicodeLanguageId(undefined, undefined, region, variants, parts_2);\n            return intl_getcanonicallocales_1.emitUnicodeLocaleId(ast);\n        }\n    }\n    if (region) {\n        var match_3 = likelySubtags[intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, region: region, variants: [] })];\n        if (match_3) {\n            var parts_3 = intl_getcanonicallocales_1.parseUnicodeLanguageId(match_3);\n            ast.lang = mergeUnicodeLanguageId(undefined, script, undefined, variants, parts_3);\n            return intl_getcanonicallocales_1.emitUnicodeLocaleId(ast);\n        }\n    }\n    var match = likelySubtags[lang] ||\n        likelySubtags[intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: 'und', script: script, variants: [] })];\n    if (!match) {\n        throw new Error(\"No match for addLikelySubtags\");\n    }\n    var parts = intl_getcanonicallocales_1.parseUnicodeLanguageId(match);\n    ast.lang = mergeUnicodeLanguageId(undefined, script, region, variants, parts);\n    return intl_getcanonicallocales_1.emitUnicodeLocaleId(ast);\n}\n/**\n * From: https://github.com/unicode-org/icu/blob/4231ca5be053a22a1be24eb891817458c97db709/icu4j/main/classes/core/src/com/ibm/icu/util/ULocale.java#L2395\n * @param tag\n */\nfunction removeLikelySubtags(tag) {\n    var maxLocale = addLikelySubtags(tag);\n    if (!maxLocale) {\n        return tag;\n    }\n    maxLocale = intl_getcanonicallocales_1.emitUnicodeLanguageId(tslib_1.__assign(tslib_1.__assign({}, intl_getcanonicallocales_1.parseUnicodeLanguageId(maxLocale)), { variants: [] }));\n    var ast = intl_getcanonicallocales_1.parseUnicodeLocaleId(tag);\n    var _a = ast.lang, lang = _a.lang, script = _a.script, region = _a.region, variants = _a.variants;\n    var trial = addLikelySubtags(intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, variants: [] }));\n    if (trial === maxLocale) {\n        return intl_getcanonicallocales_1.emitUnicodeLocaleId(tslib_1.__assign(tslib_1.__assign({}, ast), { lang: mergeUnicodeLanguageId(lang, undefined, undefined, variants) }));\n    }\n    if (region) {\n        var trial_1 = addLikelySubtags(intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, region: region, variants: [] }));\n        if (trial_1 === maxLocale) {\n            return intl_getcanonicallocales_1.emitUnicodeLocaleId(tslib_1.__assign(tslib_1.__assign({}, ast), { lang: mergeUnicodeLanguageId(lang, undefined, region, variants) }));\n        }\n    }\n    if (script) {\n        var trial_2 = addLikelySubtags(intl_getcanonicallocales_1.emitUnicodeLanguageId({ lang: lang, script: script, variants: [] }));\n        if (trial_2 === maxLocale) {\n            return intl_getcanonicallocales_1.emitUnicodeLocaleId(tslib_1.__assign(tslib_1.__assign({}, ast), { lang: mergeUnicodeLanguageId(lang, script, undefined, variants) }));\n        }\n    }\n    return tag;\n}\nvar Locale = /** @class */ (function () {\n    function Locale(tag, opts) {\n        // test262/test/intl402/RelativeTimeFormat/constructor/constructor/newtarget-undefined.js\n        // Cannot use `new.target` bc of IE11 & TS transpiles it to something else\n        var newTarget = this && this instanceof Locale ? this.constructor : void 0;\n        if (!newTarget) {\n            throw new TypeError(\"Intl.Locale must be called with 'new'\");\n        }\n        var relevantExtensionKeys = Locale.relevantExtensionKeys;\n        var internalSlotsList = [\n            'initializedLocale',\n            'locale',\n            'calendar',\n            'collation',\n            'hourCycle',\n            'numberingSystem',\n        ];\n        if (relevantExtensionKeys.indexOf('kf') > -1) {\n            internalSlotsList.push('caseFirst');\n        }\n        if (relevantExtensionKeys.indexOf('kn') > -1) {\n            internalSlotsList.push('numeric');\n        }\n        if (tag === undefined) {\n            throw new TypeError(\"First argument to Intl.Locale constructor can't be empty or missing\");\n        }\n        if (typeof tag !== 'string' && typeof tag !== 'object') {\n            throw new TypeError('tag must be a string or object');\n        }\n        var internalSlots;\n        if (typeof tag === 'object' &&\n            (internalSlots = get_internal_slots_1.default(tag)) &&\n            internalSlots.initializedLocale) {\n            tag = internalSlots.locale;\n        }\n        else {\n            tag = tag.toString();\n        }\n        internalSlots = get_internal_slots_1.default(this);\n        var options;\n        if (opts === undefined) {\n            options = Object.create(null);\n        }\n        else {\n            options = ecma402_abstract_1.ToObject(opts);\n        }\n        tag = applyOptionsToTag(tag, options);\n        var opt = Object.create(null);\n        var calendar = ecma402_abstract_1.GetOption(options, 'calendar', 'string', undefined, undefined);\n        if (calendar !== undefined) {\n            if (!UNICODE_TYPE_REGEX.test(calendar)) {\n                throw new RangeError('invalid calendar');\n            }\n        }\n        opt.ca = calendar;\n        var collation = ecma402_abstract_1.GetOption(options, 'collation', 'string', undefined, undefined);\n        if (collation !== undefined) {\n            if (!UNICODE_TYPE_REGEX.test(collation)) {\n                throw new RangeError('invalid collation');\n            }\n        }\n        opt.co = collation;\n        var hc = ecma402_abstract_1.GetOption(options, 'hourCycle', 'string', ['h11', 'h12', 'h23', 'h24'], undefined);\n        opt.hc = hc;\n        var kf = ecma402_abstract_1.GetOption(options, 'caseFirst', 'string', ['upper', 'lower', 'false'], undefined);\n        opt.kf = kf;\n        var _kn = ecma402_abstract_1.GetOption(options, 'numeric', 'boolean', undefined, undefined);\n        var kn;\n        if (_kn !== undefined) {\n            kn = String(_kn);\n        }\n        opt.kn = kn;\n        var numberingSystem = ecma402_abstract_1.GetOption(options, 'numberingSystem', 'string', undefined, undefined);\n        if (numberingSystem !== undefined) {\n            if (!UNICODE_TYPE_REGEX.test(numberingSystem)) {\n                throw new RangeError('Invalid numberingSystem');\n            }\n        }\n        opt.nu = numberingSystem;\n        var r = applyUnicodeExtensionToTag(tag, opt, relevantExtensionKeys);\n        internalSlots.locale = r.locale;\n        internalSlots.calendar = r.ca;\n        internalSlots.collation = r.co;\n        internalSlots.hourCycle = r.hc;\n        if (relevantExtensionKeys.indexOf('kf') > -1) {\n            internalSlots.caseFirst = r.kf;\n        }\n        if (relevantExtensionKeys.indexOf('kn') > -1) {\n            internalSlots.numeric = ecma402_abstract_1.SameValue(r.kn, 'true');\n        }\n        internalSlots.numberingSystem = r.nu;\n    }\n    /**\n     * https://www.unicode.org/reports/tr35/#Likely_Subtags\n     */\n    Locale.prototype.maximize = function () {\n        var locale = get_internal_slots_1.default(this).locale;\n        try {\n            var maximizedLocale = addLikelySubtags(locale);\n            return new Locale(maximizedLocale);\n        }\n        catch (e) {\n            return new Locale(locale);\n        }\n    };\n    /**\n     * https://www.unicode.org/reports/tr35/#Likely_Subtags\n     */\n    Locale.prototype.minimize = function () {\n        var locale = get_internal_slots_1.default(this).locale;\n        try {\n            var minimizedLocale = removeLikelySubtags(locale);\n            return new Locale(minimizedLocale);\n        }\n        catch (e) {\n            return new Locale(locale);\n        }\n    };\n    Locale.prototype.toString = function () {\n        return get_internal_slots_1.default(this).locale;\n    };\n    Object.defineProperty(Locale.prototype, \"baseName\", {\n        get: function () {\n            var locale = get_internal_slots_1.default(this).locale;\n            return intl_getcanonicallocales_1.emitUnicodeLanguageId(intl_getcanonicallocales_1.parseUnicodeLanguageId(locale));\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"calendar\", {\n        get: function () {\n            return get_internal_slots_1.default(this).calendar;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"collation\", {\n        get: function () {\n            return get_internal_slots_1.default(this).collation;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"hourCycle\", {\n        get: function () {\n            return get_internal_slots_1.default(this).hourCycle;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"caseFirst\", {\n        get: function () {\n            return get_internal_slots_1.default(this).caseFirst;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"numeric\", {\n        get: function () {\n            return get_internal_slots_1.default(this).numeric;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"numberingSystem\", {\n        get: function () {\n            return get_internal_slots_1.default(this).numberingSystem;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"language\", {\n        /**\n         * https://tc39.es/proposal-intl-locale/#sec-Intl.Locale.prototype.language\n         */\n        get: function () {\n            var locale = get_internal_slots_1.default(this).locale;\n            return intl_getcanonicallocales_1.parseUnicodeLanguageId(locale).lang;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"script\", {\n        /**\n         * https://tc39.es/proposal-intl-locale/#sec-Intl.Locale.prototype.script\n         */\n        get: function () {\n            var locale = get_internal_slots_1.default(this).locale;\n            return intl_getcanonicallocales_1.parseUnicodeLanguageId(locale).script;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Locale.prototype, \"region\", {\n        /**\n         * https://tc39.es/proposal-intl-locale/#sec-Intl.Locale.prototype.region\n         */\n        get: function () {\n            var locale = get_internal_slots_1.default(this).locale;\n            return intl_getcanonicallocales_1.parseUnicodeLanguageId(locale).region;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Locale.relevantExtensionKeys = RELEVANT_EXTENSION_KEYS;\n    return Locale;\n}());\nexports.Locale = Locale;\ntry {\n    if (typeof Symbol !== 'undefined') {\n        Object.defineProperty(Locale.prototype, Symbol.toStringTag, {\n            value: 'Intl.Locale',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        });\n    }\n    Object.defineProperty(Locale.prototype.constructor, 'length', {\n        value: 1,\n        writable: false,\n        enumerable: false,\n        configurable: true,\n    });\n}\ncatch (e) {\n    // Meta fix so we're test262-compliant, not important\n}\nexports.default = Locale;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n\nexport function qsGet(param) {\n  return qs.get(param);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isUnicodeLanguageSubtag = exports.isUnicodeScriptSubtag = exports.isUnicodeRegionSubtag = exports.isStructurallyValidLanguageTag = exports.parseUnicodeLanguageId = exports.parseUnicodeLocaleId = exports.getCanonicalLocales = void 0;\nvar tslib_1 = require(\"tslib\");\nvar parser_1 = require(\"./src/parser\");\nvar emitter_1 = require(\"./src/emitter\");\nvar canonicalizer_1 = require(\"./src/canonicalizer\");\n/**\n * https://tc39.es/ecma402/#sec-canonicalizelocalelist\n * @param locales\n */\nfunction CanonicalizeLocaleList(locales) {\n    if (locales === undefined) {\n        return [];\n    }\n    var seen = [];\n    if (typeof locales === 'string') {\n        locales = [locales];\n    }\n    for (var _i = 0, locales_1 = locales; _i < locales_1.length; _i++) {\n        var locale = locales_1[_i];\n        var canonicalizedTag = emitter_1.emitUnicodeLocaleId(canonicalizer_1.canonicalizeUnicodeLocaleId(parser_1.parseUnicodeLocaleId(locale)));\n        if (seen.indexOf(canonicalizedTag) < 0) {\n            seen.push(canonicalizedTag);\n        }\n    }\n    return seen;\n}\nfunction getCanonicalLocales(locales) {\n    return CanonicalizeLocaleList(locales);\n}\nexports.getCanonicalLocales = getCanonicalLocales;\nvar parser_2 = require(\"./src/parser\");\nObject.defineProperty(exports, \"parseUnicodeLocaleId\", { enumerable: true, get: function () { return parser_2.parseUnicodeLocaleId; } });\nObject.defineProperty(exports, \"parseUnicodeLanguageId\", { enumerable: true, get: function () { return parser_2.parseUnicodeLanguageId; } });\nObject.defineProperty(exports, \"isStructurallyValidLanguageTag\", { enumerable: true, get: function () { return parser_2.isStructurallyValidLanguageTag; } });\nObject.defineProperty(exports, \"isUnicodeRegionSubtag\", { enumerable: true, get: function () { return parser_2.isUnicodeRegionSubtag; } });\nObject.defineProperty(exports, \"isUnicodeScriptSubtag\", { enumerable: true, get: function () { return parser_2.isUnicodeScriptSubtag; } });\nObject.defineProperty(exports, \"isUnicodeLanguageSubtag\", { enumerable: true, get: function () { return parser_2.isUnicodeLanguageSubtag; } });\ntslib_1.__exportStar(require(\"./src/types\"), exports);\ntslib_1.__exportStar(require(\"./src/emitter\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.canonicalizeUnicodeLocaleId = exports.canonicalizeUnicodeLanguageId = void 0;\nvar tslib_1 = require(\"tslib\");\nvar aliases_1 = require(\"./data/aliases\");\nvar parser_1 = require(\"./parser\");\nvar likelySubtags = tslib_1.__importStar(require(\"cldr-core/supplemental/likelySubtags.json\"));\nvar emitter_1 = require(\"./emitter\");\nfunction canonicalizeAttrs(strs) {\n    return Object.keys(strs.reduce(function (all, str) {\n        all[str.toLowerCase()] = 1;\n        return all;\n    }, {})).sort();\n}\nfunction canonicalizeKVs(arr) {\n    var all = {};\n    var result = [];\n    for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\n        var kv = arr_1[_i];\n        if (kv[0] in all) {\n            continue;\n        }\n        all[kv[0]] = 1;\n        if (!kv[1] || kv[1] === 'true') {\n            result.push([kv[0].toLowerCase()]);\n        }\n        else {\n            result.push([kv[0].toLowerCase(), kv[1].toLowerCase()]);\n        }\n    }\n    return result.sort(compareKV);\n}\nfunction compareKV(t1, t2) {\n    return t1[0] < t2[0] ? -1 : t1[0] > t2[0] ? 1 : 0;\n}\nfunction compareExtension(e1, e2) {\n    return e1.type < e2.type ? -1 : e1.type > e2.type ? 1 : 0;\n}\nfunction mergeVariants(v1, v2) {\n    var result = tslib_1.__spreadArrays(v1);\n    for (var _i = 0, v2_1 = v2; _i < v2_1.length; _i++) {\n        var v = v2_1[_i];\n        if (v1.indexOf(v) < 0) {\n            result.push(v);\n        }\n    }\n    return result;\n}\n/**\n * CAVEAT: We don't do this section in the spec bc they have no JSON data\n * Use the bcp47 data to replace keys, types, tfields, and tvalues by their canonical forms. See Section 3.6.4 U Extension Data Files) and Section 3.7.1 T Extension Data Files. The aliases are in the alias attribute value, while the canonical is in the name attribute value. For example,\nBecause of the following bcp47 data:\n<key name=\"ms\"><type name=\"uksystem\"  alias=\"imperial\"  /></key>\nWe get the following transformation:\nen-u-ms-imperial  en-u-ms-uksystem\n * @param lang\n */\nfunction canonicalizeUnicodeLanguageId(unicodeLanguageId) {\n    /**\n     * If the language subtag matches the type attribute of a languageAlias element in Supplemental Data, replace the language subtag with the replacement value.\n     *  1. If there are additional subtags in the replacement value, add them to the result, but only if there is no corresponding subtag already in the tag.\n     *  2. Five special deprecated grandfathered codes (such as i-default) are in type attributes, and are also replaced.\n     */\n    // From https://github.com/unicode-org/icu/blob/master/icu4j/main/classes/core/src/com/ibm/icu/util/ULocale.java#L1246\n    // Try language _ variant\n    var finalLangAst = unicodeLanguageId;\n    if (unicodeLanguageId.variants.length) {\n        var replacedLang_1 = '';\n        for (var _i = 0, _a = unicodeLanguageId.variants; _i < _a.length; _i++) {\n            var variant = _a[_i];\n            if ((replacedLang_1 =\n                aliases_1.languageAlias[emitter_1.emitUnicodeLanguageId({\n                    lang: unicodeLanguageId.lang,\n                    variants: [variant],\n                })])) {\n                var replacedLangAst = parser_1.parseUnicodeLanguageId(replacedLang_1.split(parser_1.SEPARATOR));\n                finalLangAst = {\n                    lang: replacedLangAst.lang,\n                    script: finalLangAst.script || replacedLangAst.script,\n                    region: finalLangAst.region || replacedLangAst.region,\n                    variants: mergeVariants(finalLangAst.variants, replacedLangAst.variants),\n                };\n                break;\n            }\n        }\n    }\n    // language _ script _ country\n    // ug-Arab-CN -> ug-CN\n    if (finalLangAst.script && finalLangAst.region) {\n        var replacedLang_2 = aliases_1.languageAlias[emitter_1.emitUnicodeLanguageId({\n            lang: finalLangAst.lang,\n            script: finalLangAst.script,\n            region: finalLangAst.region,\n            variants: [],\n        })];\n        if (replacedLang_2) {\n            var replacedLangAst = parser_1.parseUnicodeLanguageId(replacedLang_2.split(parser_1.SEPARATOR));\n            finalLangAst = {\n                lang: replacedLangAst.lang,\n                script: replacedLangAst.script,\n                region: replacedLangAst.region,\n                variants: finalLangAst.variants,\n            };\n        }\n    }\n    // language _ country\n    // eg. az_AZ -> az_Latn_A\n    if (finalLangAst.region) {\n        var replacedLang_3 = aliases_1.languageAlias[emitter_1.emitUnicodeLanguageId({\n            lang: finalLangAst.lang,\n            region: finalLangAst.region,\n            variants: [],\n        })];\n        if (replacedLang_3) {\n            var replacedLangAst = parser_1.parseUnicodeLanguageId(replacedLang_3.split(parser_1.SEPARATOR));\n            finalLangAst = {\n                lang: replacedLangAst.lang,\n                script: finalLangAst.script || replacedLangAst.script,\n                region: replacedLangAst.region,\n                variants: finalLangAst.variants,\n            };\n        }\n    }\n    // only language\n    // e.g. twi -> ak\n    var replacedLang = aliases_1.languageAlias[emitter_1.emitUnicodeLanguageId({\n        lang: finalLangAst.lang,\n        variants: [],\n    })];\n    if (replacedLang) {\n        var replacedLangAst = parser_1.parseUnicodeLanguageId(replacedLang.split(parser_1.SEPARATOR));\n        finalLangAst = {\n            lang: replacedLangAst.lang,\n            script: finalLangAst.script || replacedLangAst.script,\n            region: finalLangAst.region || replacedLangAst.region,\n            variants: finalLangAst.variants,\n        };\n    }\n    if (finalLangAst.region) {\n        var region = finalLangAst.region.toUpperCase();\n        var regionAlias = aliases_1.territoryAlias[region];\n        var replacedRegion = void 0;\n        if (regionAlias) {\n            var regions = regionAlias.split(' ');\n            replacedRegion = regions[0];\n            var likelySubtag = likelySubtags.supplemental.likelySubtags[emitter_1.emitUnicodeLanguageId({\n                lang: finalLangAst.lang,\n                script: finalLangAst.script,\n                variants: [],\n            })];\n            if (likelySubtag) {\n                var likelyRegion = parser_1.parseUnicodeLanguageId(likelySubtag.split(parser_1.SEPARATOR)).region;\n                if (likelyRegion && regions.indexOf(likelyRegion) > -1) {\n                    replacedRegion = likelyRegion;\n                }\n            }\n        }\n        if (replacedRegion) {\n            finalLangAst.region = replacedRegion;\n        }\n        finalLangAst.region = finalLangAst.region.toUpperCase();\n    }\n    if (finalLangAst.script) {\n        finalLangAst.script =\n            finalLangAst.script[0].toUpperCase() +\n                finalLangAst.script.slice(1).toLowerCase();\n        if (aliases_1.scriptAlias[finalLangAst.script]) {\n            finalLangAst.script = aliases_1.scriptAlias[finalLangAst.script];\n        }\n    }\n    if (finalLangAst.variants.length) {\n        for (var i = 0; i < finalLangAst.variants.length; i++) {\n            var variant = finalLangAst.variants[i].toLowerCase();\n            if (aliases_1.variantAlias[variant]) {\n                var alias = aliases_1.variantAlias[variant];\n                if (parser_1.isUnicodeVariantSubtag(alias)) {\n                    finalLangAst.variants[i] = alias;\n                }\n                else if (parser_1.isUnicodeLanguageSubtag(alias)) {\n                    // Yes this can happen per the spec\n                    finalLangAst.lang = alias;\n                }\n            }\n        }\n        finalLangAst.variants.sort();\n    }\n    return finalLangAst;\n}\nexports.canonicalizeUnicodeLanguageId = canonicalizeUnicodeLanguageId;\n/**\n * Canonicalize based on\n * https://www.unicode.org/reports/tr35/tr35.html#Canonical_Unicode_Locale_Identifiers\n * https://tc39.es/ecma402/#sec-canonicalizeunicodelocaleid\n * IMPORTANT: This modifies the object inline\n * @param locale\n */\nfunction canonicalizeUnicodeLocaleId(locale) {\n    locale.lang = canonicalizeUnicodeLanguageId(locale.lang);\n    if (locale.extensions) {\n        for (var _i = 0, _a = locale.extensions; _i < _a.length; _i++) {\n            var extension = _a[_i];\n            switch (extension.type) {\n                case 'u':\n                    extension.keywords = canonicalizeKVs(extension.keywords);\n                    if (extension.attributes) {\n                        extension.attributes = canonicalizeAttrs(extension.attributes);\n                    }\n                    break;\n                case 't':\n                    if (extension.lang) {\n                        extension.lang = canonicalizeUnicodeLanguageId(extension.lang);\n                    }\n                    extension.fields = canonicalizeKVs(extension.fields);\n                    break;\n                default:\n                    extension.value = extension.value.toLowerCase();\n                    break;\n            }\n        }\n        locale.extensions.sort(compareExtension);\n    }\n    return locale;\n}\nexports.canonicalizeUnicodeLocaleId = canonicalizeUnicodeLocaleId;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.variantAlias = exports.scriptAlias = exports.territoryAlias = exports.languageAlias = void 0;\n/* @generated */\n// prettier-ignore  \nexports.languageAlias = {\n    \"aa-saaho\": \"ssy\",\n    \"aam\": \"aas\",\n    \"aar\": \"aa\",\n    \"abk\": \"ab\",\n    \"adp\": \"dz\",\n    \"afr\": \"af\",\n    \"agp\": \"apf\",\n    \"ais\": \"ami\",\n    \"aju\": \"jrb\",\n    \"aka\": \"ak\",\n    \"alb\": \"sq\",\n    \"als\": \"sq\",\n    \"amh\": \"am\",\n    \"ara\": \"ar\",\n    \"arb\": \"ar\",\n    \"arg\": \"an\",\n    \"arm\": \"hy\",\n    \"art-lojban\": \"jbo\",\n    \"asd\": \"snz\",\n    \"asm\": \"as\",\n    \"aue\": \"ktz\",\n    \"ava\": \"av\",\n    \"ave\": \"ae\",\n    \"aym\": \"ay\",\n    \"ayr\": \"ay\",\n    \"ayx\": \"nun\",\n    \"aze\": \"az\",\n    \"azj\": \"az\",\n    \"bak\": \"ba\",\n    \"bam\": \"bm\",\n    \"baq\": \"eu\",\n    \"baz\": \"nvo\",\n    \"bcc\": \"bal\",\n    \"bcl\": \"bik\",\n    \"bel\": \"be\",\n    \"ben\": \"bn\",\n    \"bgm\": \"bcg\",\n    \"bh\": \"bho\",\n    \"bhk\": \"fbl\",\n    \"bih\": \"bho\",\n    \"bis\": \"bi\",\n    \"bjd\": \"drl\",\n    \"bjq\": \"bzc\",\n    \"bkb\": \"ebk\",\n    \"bod\": \"bo\",\n    \"bos\": \"bs\",\n    \"bre\": \"br\",\n    \"btb\": \"beb\",\n    \"bul\": \"bg\",\n    \"bur\": \"my\",\n    \"bxk\": \"luy\",\n    \"bxr\": \"bua\",\n    \"cat\": \"ca\",\n    \"ccq\": \"rki\",\n    \"cel-gaulish\": \"xtg\",\n    \"ces\": \"cs\",\n    \"cha\": \"ch\",\n    \"che\": \"ce\",\n    \"chi\": \"zh\",\n    \"chu\": \"cu\",\n    \"chv\": \"cv\",\n    \"cjr\": \"mom\",\n    \"cka\": \"cmr\",\n    \"cld\": \"syr\",\n    \"cmk\": \"xch\",\n    \"cmn\": \"zh\",\n    \"cnr\": \"sr-ME\",\n    \"cor\": \"kw\",\n    \"cos\": \"co\",\n    \"coy\": \"pij\",\n    \"cqu\": \"quh\",\n    \"cre\": \"cr\",\n    \"cwd\": \"cr\",\n    \"cym\": \"cy\",\n    \"cze\": \"cs\",\n    \"daf\": \"dnj\",\n    \"dan\": \"da\",\n    \"dap\": \"njz\",\n    \"deu\": \"de\",\n    \"dgo\": \"doi\",\n    \"dhd\": \"mwr\",\n    \"dik\": \"din\",\n    \"diq\": \"zza\",\n    \"dit\": \"dif\",\n    \"div\": \"dv\",\n    \"djl\": \"dze\",\n    \"dkl\": \"aqd\",\n    \"drh\": \"mn\",\n    \"drr\": \"kzk\",\n    \"drw\": \"fa-AF\",\n    \"dud\": \"uth\",\n    \"duj\": \"dwu\",\n    \"dut\": \"nl\",\n    \"dwl\": \"dbt\",\n    \"dzo\": \"dz\",\n    \"ekk\": \"et\",\n    \"ell\": \"el\",\n    \"elp\": \"amq\",\n    \"emk\": \"man\",\n    \"en-GB-oed\": \"en-GB-oxendict\",\n    \"eng\": \"en\",\n    \"epo\": \"eo\",\n    \"esk\": \"ik\",\n    \"est\": \"et\",\n    \"eus\": \"eu\",\n    \"ewe\": \"ee\",\n    \"fao\": \"fo\",\n    \"fas\": \"fa\",\n    \"fat\": \"ak\",\n    \"fij\": \"fj\",\n    \"fin\": \"fi\",\n    \"fra\": \"fr\",\n    \"fre\": \"fr\",\n    \"fry\": \"fy\",\n    \"fuc\": \"ff\",\n    \"ful\": \"ff\",\n    \"gav\": \"dev\",\n    \"gaz\": \"om\",\n    \"gbc\": \"wny\",\n    \"gbo\": \"grb\",\n    \"geo\": \"ka\",\n    \"ger\": \"de\",\n    \"gfx\": \"vaj\",\n    \"ggn\": \"gvr\",\n    \"ggo\": \"esg\",\n    \"ggr\": \"gtu\",\n    \"gio\": \"aou\",\n    \"gla\": \"gd\",\n    \"gle\": \"ga\",\n    \"glg\": \"gl\",\n    \"gli\": \"kzk\",\n    \"glv\": \"gv\",\n    \"gno\": \"gon\",\n    \"gre\": \"el\",\n    \"grn\": \"gn\",\n    \"gti\": \"nyc\",\n    \"gug\": \"gn\",\n    \"guj\": \"gu\",\n    \"guv\": \"duz\",\n    \"gya\": \"gba\",\n    \"hat\": \"ht\",\n    \"hau\": \"ha\",\n    \"hbs\": \"sr-Latn\",\n    \"hdn\": \"hai\",\n    \"hea\": \"hmn\",\n    \"heb\": \"he\",\n    \"her\": \"hz\",\n    \"him\": \"srx\",\n    \"hin\": \"hi\",\n    \"hmo\": \"ho\",\n    \"hrr\": \"jal\",\n    \"hrv\": \"hr\",\n    \"hun\": \"hu\",\n    \"hy-arevmda\": \"hyw\",\n    \"hye\": \"hy\",\n    \"i-ami\": \"ami\",\n    \"i-bnn\": \"bnn\",\n    \"i-default\": \"en-x-i-default\",\n    \"i-enochian\": \"und-x-i-enochian\",\n    \"i-hak\": \"hak\",\n    \"i-klingon\": \"tlh\",\n    \"i-lux\": \"lb\",\n    \"i-mingo\": \"see-x-i-mingo\",\n    \"i-navajo\": \"nv\",\n    \"i-pwn\": \"pwn\",\n    \"i-tao\": \"tao\",\n    \"i-tay\": \"tay\",\n    \"i-tsu\": \"tsu\",\n    \"ibi\": \"opa\",\n    \"ibo\": \"ig\",\n    \"ice\": \"is\",\n    \"ido\": \"io\",\n    \"iii\": \"ii\",\n    \"ike\": \"iu\",\n    \"iku\": \"iu\",\n    \"ile\": \"ie\",\n    \"ill\": \"ilm\",\n    \"ilw\": \"gal\",\n    \"in\": \"id\",\n    \"ina\": \"ia\",\n    \"ind\": \"id\",\n    \"ipk\": \"ik\",\n    \"isl\": \"is\",\n    \"ita\": \"it\",\n    \"iw\": \"he\",\n    \"izi\": \"eza\",\n    \"jar\": \"jgk\",\n    \"jav\": \"jv\",\n    \"jeg\": \"oyb\",\n    \"ji\": \"yi\",\n    \"jpn\": \"ja\",\n    \"jw\": \"jv\",\n    \"kal\": \"kl\",\n    \"kan\": \"kn\",\n    \"kas\": \"ks\",\n    \"kat\": \"ka\",\n    \"kau\": \"kr\",\n    \"kaz\": \"kk\",\n    \"kdv\": \"zkd\",\n    \"kgc\": \"tdf\",\n    \"kgd\": \"ncq\",\n    \"kgh\": \"kml\",\n    \"khk\": \"mn\",\n    \"khm\": \"km\",\n    \"kik\": \"ki\",\n    \"kin\": \"rw\",\n    \"kir\": \"ky\",\n    \"kmr\": \"ku\",\n    \"knc\": \"kr\",\n    \"kng\": \"kg\",\n    \"knn\": \"kok\",\n    \"koj\": \"kwv\",\n    \"kom\": \"kv\",\n    \"kon\": \"kg\",\n    \"kor\": \"ko\",\n    \"kpp\": \"jkm\",\n    \"kpv\": \"kv\",\n    \"krm\": \"bmf\",\n    \"ktr\": \"dtp\",\n    \"kua\": \"kj\",\n    \"kur\": \"ku\",\n    \"kvs\": \"gdj\",\n    \"kwq\": \"yam\",\n    \"kxe\": \"tvd\",\n    \"kxl\": \"kru\",\n    \"kzh\": \"dgl\",\n    \"kzj\": \"dtp\",\n    \"kzt\": \"dtp\",\n    \"lao\": \"lo\",\n    \"lat\": \"la\",\n    \"lav\": \"lv\",\n    \"lbk\": \"bnc\",\n    \"leg\": \"enl\",\n    \"lii\": \"raq\",\n    \"lim\": \"li\",\n    \"lin\": \"ln\",\n    \"lit\": \"lt\",\n    \"llo\": \"ngt\",\n    \"lmm\": \"rmx\",\n    \"ltz\": \"lb\",\n    \"lub\": \"lu\",\n    \"lug\": \"lg\",\n    \"lvs\": \"lv\",\n    \"mac\": \"mk\",\n    \"mah\": \"mh\",\n    \"mal\": \"ml\",\n    \"mao\": \"mi\",\n    \"mar\": \"mr\",\n    \"may\": \"ms\",\n    \"meg\": \"cir\",\n    \"mgx\": \"jbk\",\n    \"mhr\": \"chm\",\n    \"mkd\": \"mk\",\n    \"mlg\": \"mg\",\n    \"mlt\": \"mt\",\n    \"mnk\": \"man\",\n    \"mnt\": \"wnn\",\n    \"mo\": \"ro\",\n    \"mof\": \"xnt\",\n    \"mol\": \"ro\",\n    \"mon\": \"mn\",\n    \"mri\": \"mi\",\n    \"msa\": \"ms\",\n    \"mst\": \"mry\",\n    \"mup\": \"raj\",\n    \"mwd\": \"dmw\",\n    \"mwj\": \"vaj\",\n    \"mya\": \"my\",\n    \"myd\": \"aog\",\n    \"myt\": \"mry\",\n    \"nad\": \"xny\",\n    \"nau\": \"na\",\n    \"nav\": \"nv\",\n    \"nbf\": \"nru\",\n    \"nbl\": \"nr\",\n    \"nbx\": \"ekc\",\n    \"ncp\": \"kdz\",\n    \"nde\": \"nd\",\n    \"ndo\": \"ng\",\n    \"nep\": \"ne\",\n    \"nld\": \"nl\",\n    \"nln\": \"azd\",\n    \"nlr\": \"nrk\",\n    \"nno\": \"nn\",\n    \"nns\": \"nbr\",\n    \"nnx\": \"ngv\",\n    \"no\": \"nb\",\n    \"no-bok\": \"nb\",\n    \"no-bokmal\": \"nb\",\n    \"no-nyn\": \"nn\",\n    \"no-nynorsk\": \"nn\",\n    \"nob\": \"nb\",\n    \"noo\": \"dtd\",\n    \"nor\": \"nb\",\n    \"npi\": \"ne\",\n    \"nts\": \"pij\",\n    \"nxu\": \"bpp\",\n    \"nya\": \"ny\",\n    \"oci\": \"oc\",\n    \"ojg\": \"oj\",\n    \"oji\": \"oj\",\n    \"ori\": \"or\",\n    \"orm\": \"om\",\n    \"ory\": \"or\",\n    \"oss\": \"os\",\n    \"oun\": \"vaj\",\n    \"pan\": \"pa\",\n    \"pbu\": \"ps\",\n    \"pcr\": \"adx\",\n    \"per\": \"fa\",\n    \"pes\": \"fa\",\n    \"pli\": \"pi\",\n    \"plt\": \"mg\",\n    \"pmc\": \"huw\",\n    \"pmu\": \"phr\",\n    \"pnb\": \"lah\",\n    \"pol\": \"pl\",\n    \"por\": \"pt\",\n    \"ppa\": \"bfy\",\n    \"ppr\": \"lcq\",\n    \"prs\": \"fa-AF\",\n    \"pry\": \"prt\",\n    \"pus\": \"ps\",\n    \"puz\": \"pub\",\n    \"que\": \"qu\",\n    \"quz\": \"qu\",\n    \"rmr\": \"emx\",\n    \"rmy\": \"rom\",\n    \"roh\": \"rm\",\n    \"ron\": \"ro\",\n    \"rum\": \"ro\",\n    \"run\": \"rn\",\n    \"rus\": \"ru\",\n    \"sag\": \"sg\",\n    \"san\": \"sa\",\n    \"sap\": \"aqt\",\n    \"sca\": \"hle\",\n    \"scc\": \"sr\",\n    \"scr\": \"hr\",\n    \"sgl\": \"isk\",\n    \"sgn-BE-FR\": \"sfb\",\n    \"sgn-BE-NL\": \"vgt\",\n    \"sgn-BR\": \"bzs\",\n    \"sgn-CH-DE\": \"sgg\",\n    \"sgn-CO\": \"csn\",\n    \"sgn-DE\": \"gsg\",\n    \"sgn-DK\": \"dsl\",\n    \"sgn-ES\": \"ssp\",\n    \"sgn-FR\": \"fsl\",\n    \"sgn-GB\": \"bfi\",\n    \"sgn-GR\": \"gss\",\n    \"sgn-IE\": \"isg\",\n    \"sgn-IT\": \"ise\",\n    \"sgn-JP\": \"jsl\",\n    \"sgn-MX\": \"mfs\",\n    \"sgn-NI\": \"ncs\",\n    \"sgn-NL\": \"dse\",\n    \"sgn-NO\": \"nsi\",\n    \"sgn-PT\": \"psr\",\n    \"sgn-SE\": \"swl\",\n    \"sgn-US\": \"ase\",\n    \"sgn-ZA\": \"sfs\",\n    \"sh\": \"sr-Latn\",\n    \"sin\": \"si\",\n    \"skk\": \"oyb\",\n    \"slk\": \"sk\",\n    \"slo\": \"sk\",\n    \"slv\": \"sl\",\n    \"sme\": \"se\",\n    \"smo\": \"sm\",\n    \"sna\": \"sn\",\n    \"snd\": \"sd\",\n    \"som\": \"so\",\n    \"sot\": \"st\",\n    \"spa\": \"es\",\n    \"spy\": \"kln\",\n    \"sqi\": \"sq\",\n    \"src\": \"sc\",\n    \"srd\": \"sc\",\n    \"srp\": \"sr\",\n    \"ssw\": \"ss\",\n    \"sul\": \"sgd\",\n    \"sum\": \"ulw\",\n    \"sun\": \"su\",\n    \"swa\": \"sw\",\n    \"swc\": \"sw-CD\",\n    \"swe\": \"sv\",\n    \"swh\": \"sw\",\n    \"tah\": \"ty\",\n    \"tam\": \"ta\",\n    \"tat\": \"tt\",\n    \"tdu\": \"dtp\",\n    \"tel\": \"te\",\n    \"tgg\": \"bjp\",\n    \"tgk\": \"tg\",\n    \"tgl\": \"fil\",\n    \"tha\": \"th\",\n    \"thc\": \"tpo\",\n    \"thw\": \"ola\",\n    \"thx\": \"oyb\",\n    \"tib\": \"bo\",\n    \"tid\": \"itd\",\n    \"tie\": \"ras\",\n    \"tir\": \"ti\",\n    \"tkk\": \"twm\",\n    \"tl\": \"fil\",\n    \"tlw\": \"weo\",\n    \"tmp\": \"tyj\",\n    \"tne\": \"kak\",\n    \"tnf\": \"fa-AF\",\n    \"ton\": \"to\",\n    \"tsf\": \"taj\",\n    \"tsn\": \"tn\",\n    \"tso\": \"ts\",\n    \"ttq\": \"tmh\",\n    \"tuk\": \"tk\",\n    \"tur\": \"tr\",\n    \"tw\": \"ak\",\n    \"twi\": \"ak\",\n    \"uig\": \"ug\",\n    \"ukr\": \"uk\",\n    \"umu\": \"del\",\n    \"und-aaland\": \"und-AX\",\n    \"und-arevela\": \"und\",\n    \"und-arevmda\": \"und\",\n    \"und-bokmal\": \"und\",\n    \"und-hakka\": \"und\",\n    \"und-hepburn-heploc\": \"und-alalc97\",\n    \"und-lojban\": \"und\",\n    \"und-nynorsk\": \"und\",\n    \"und-saaho\": \"und\",\n    \"und-xiang\": \"und\",\n    \"unp\": \"wro\",\n    \"uok\": \"ema\",\n    \"urd\": \"ur\",\n    \"uzb\": \"uz\",\n    \"uzn\": \"uz\",\n    \"ven\": \"ve\",\n    \"vie\": \"vi\",\n    \"vol\": \"vo\",\n    \"wel\": \"cy\",\n    \"wgw\": \"wgb\",\n    \"wit\": \"nol\",\n    \"wiw\": \"nwo\",\n    \"wln\": \"wa\",\n    \"wol\": \"wo\",\n    \"xba\": \"cax\",\n    \"xho\": \"xh\",\n    \"xia\": \"acn\",\n    \"xkh\": \"waw\",\n    \"xpe\": \"kpe\",\n    \"xrq\": \"dmw\",\n    \"xsj\": \"suj\",\n    \"xsl\": \"den\",\n    \"ybd\": \"rki\",\n    \"ydd\": \"yi\",\n    \"yen\": \"ynq\",\n    \"yid\": \"yi\",\n    \"yiy\": \"yrm\",\n    \"yma\": \"lrr\",\n    \"ymt\": \"mtm\",\n    \"yor\": \"yo\",\n    \"yos\": \"zom\",\n    \"yuu\": \"yug\",\n    \"zai\": \"zap\",\n    \"zh-cmn\": \"zh\",\n    \"zh-cmn-Hans\": \"zh-Hans\",\n    \"zh-cmn-Hant\": \"zh-Hant\",\n    \"zh-gan\": \"gan\",\n    \"zh-guoyu\": \"zh\",\n    \"zh-hakka\": \"hak\",\n    \"zh-min\": \"nan-x-zh-min\",\n    \"zh-min-nan\": \"nan\",\n    \"zh-wuu\": \"wuu\",\n    \"zh-xiang\": \"hsn\",\n    \"zh-yue\": \"yue\",\n    \"zha\": \"za\",\n    \"zho\": \"zh\",\n    \"zir\": \"scv\",\n    \"zsm\": \"ms\",\n    \"zul\": \"zu\",\n    \"zyb\": \"za\"\n};\nexports.territoryAlias = {\n    \"100\": \"BG\",\n    \"104\": \"MM\",\n    \"108\": \"BI\",\n    \"112\": \"BY\",\n    \"116\": \"KH\",\n    \"120\": \"CM\",\n    \"124\": \"CA\",\n    \"132\": \"CV\",\n    \"136\": \"KY\",\n    \"140\": \"CF\",\n    \"144\": \"LK\",\n    \"148\": \"TD\",\n    \"152\": \"CL\",\n    \"156\": \"CN\",\n    \"158\": \"TW\",\n    \"162\": \"CX\",\n    \"166\": \"CC\",\n    \"170\": \"CO\",\n    \"172\": \"RU AM AZ BY GE KG KZ MD TJ TM UA UZ\",\n    \"174\": \"KM\",\n    \"175\": \"YT\",\n    \"178\": \"CG\",\n    \"180\": \"CD\",\n    \"184\": \"CK\",\n    \"188\": \"CR\",\n    \"191\": \"HR\",\n    \"192\": \"CU\",\n    \"196\": \"CY\",\n    \"200\": \"CZ SK\",\n    \"203\": \"CZ\",\n    \"204\": \"BJ\",\n    \"208\": \"DK\",\n    \"212\": \"DM\",\n    \"214\": \"DO\",\n    \"218\": \"EC\",\n    \"222\": \"SV\",\n    \"226\": \"GQ\",\n    \"230\": \"ET\",\n    \"231\": \"ET\",\n    \"232\": \"ER\",\n    \"233\": \"EE\",\n    \"234\": \"FO\",\n    \"238\": \"FK\",\n    \"239\": \"GS\",\n    \"242\": \"FJ\",\n    \"246\": \"FI\",\n    \"248\": \"AX\",\n    \"249\": \"FR\",\n    \"250\": \"FR\",\n    \"254\": \"GF\",\n    \"258\": \"PF\",\n    \"260\": \"TF\",\n    \"262\": \"DJ\",\n    \"266\": \"GA\",\n    \"268\": \"GE\",\n    \"270\": \"GM\",\n    \"275\": \"PS\",\n    \"276\": \"DE\",\n    \"278\": \"DE\",\n    \"280\": \"DE\",\n    \"288\": \"GH\",\n    \"292\": \"GI\",\n    \"296\": \"KI\",\n    \"300\": \"GR\",\n    \"304\": \"GL\",\n    \"308\": \"GD\",\n    \"312\": \"GP\",\n    \"316\": \"GU\",\n    \"320\": \"GT\",\n    \"324\": \"GN\",\n    \"328\": \"GY\",\n    \"332\": \"HT\",\n    \"334\": \"HM\",\n    \"336\": \"VA\",\n    \"340\": \"HN\",\n    \"344\": \"HK\",\n    \"348\": \"HU\",\n    \"352\": \"IS\",\n    \"356\": \"IN\",\n    \"360\": \"ID\",\n    \"364\": \"IR\",\n    \"368\": \"IQ\",\n    \"372\": \"IE\",\n    \"376\": \"IL\",\n    \"380\": \"IT\",\n    \"384\": \"CI\",\n    \"388\": \"JM\",\n    \"392\": \"JP\",\n    \"398\": \"KZ\",\n    \"400\": \"JO\",\n    \"404\": \"KE\",\n    \"408\": \"KP\",\n    \"410\": \"KR\",\n    \"414\": \"KW\",\n    \"417\": \"KG\",\n    \"418\": \"LA\",\n    \"422\": \"LB\",\n    \"426\": \"LS\",\n    \"428\": \"LV\",\n    \"430\": \"LR\",\n    \"434\": \"LY\",\n    \"438\": \"LI\",\n    \"440\": \"LT\",\n    \"442\": \"LU\",\n    \"446\": \"MO\",\n    \"450\": \"MG\",\n    \"454\": \"MW\",\n    \"458\": \"MY\",\n    \"462\": \"MV\",\n    \"466\": \"ML\",\n    \"470\": \"MT\",\n    \"474\": \"MQ\",\n    \"478\": \"MR\",\n    \"480\": \"MU\",\n    \"484\": \"MX\",\n    \"492\": \"MC\",\n    \"496\": \"MN\",\n    \"498\": \"MD\",\n    \"499\": \"ME\",\n    \"500\": \"MS\",\n    \"504\": \"MA\",\n    \"508\": \"MZ\",\n    \"512\": \"OM\",\n    \"516\": \"NA\",\n    \"520\": \"NR\",\n    \"524\": \"NP\",\n    \"528\": \"NL\",\n    \"530\": \"CW SX BQ\",\n    \"531\": \"CW\",\n    \"532\": \"CW SX BQ\",\n    \"533\": \"AW\",\n    \"534\": \"SX\",\n    \"535\": \"BQ\",\n    \"536\": \"SA IQ\",\n    \"540\": \"NC\",\n    \"548\": \"VU\",\n    \"554\": \"NZ\",\n    \"558\": \"NI\",\n    \"562\": \"NE\",\n    \"566\": \"NG\",\n    \"570\": \"NU\",\n    \"574\": \"NF\",\n    \"578\": \"NO\",\n    \"580\": \"MP\",\n    \"581\": \"UM\",\n    \"582\": \"FM MH MP PW\",\n    \"583\": \"FM\",\n    \"584\": \"MH\",\n    \"585\": \"PW\",\n    \"586\": \"PK\",\n    \"591\": \"PA\",\n    \"598\": \"PG\",\n    \"600\": \"PY\",\n    \"604\": \"PE\",\n    \"608\": \"PH\",\n    \"612\": \"PN\",\n    \"616\": \"PL\",\n    \"620\": \"PT\",\n    \"624\": \"GW\",\n    \"626\": \"TL\",\n    \"630\": \"PR\",\n    \"634\": \"QA\",\n    \"638\": \"RE\",\n    \"642\": \"RO\",\n    \"643\": \"RU\",\n    \"646\": \"RW\",\n    \"652\": \"BL\",\n    \"654\": \"SH\",\n    \"659\": \"KN\",\n    \"660\": \"AI\",\n    \"662\": \"LC\",\n    \"663\": \"MF\",\n    \"666\": \"PM\",\n    \"670\": \"VC\",\n    \"674\": \"SM\",\n    \"678\": \"ST\",\n    \"682\": \"SA\",\n    \"686\": \"SN\",\n    \"688\": \"RS\",\n    \"690\": \"SC\",\n    \"694\": \"SL\",\n    \"702\": \"SG\",\n    \"703\": \"SK\",\n    \"704\": \"VN\",\n    \"705\": \"SI\",\n    \"706\": \"SO\",\n    \"710\": \"ZA\",\n    \"716\": \"ZW\",\n    \"720\": \"YE\",\n    \"724\": \"ES\",\n    \"728\": \"SS\",\n    \"729\": \"SD\",\n    \"732\": \"EH\",\n    \"736\": \"SD\",\n    \"740\": \"SR\",\n    \"744\": \"SJ\",\n    \"748\": \"SZ\",\n    \"752\": \"SE\",\n    \"756\": \"CH\",\n    \"760\": \"SY\",\n    \"762\": \"TJ\",\n    \"764\": \"TH\",\n    \"768\": \"TG\",\n    \"772\": \"TK\",\n    \"776\": \"TO\",\n    \"780\": \"TT\",\n    \"784\": \"AE\",\n    \"788\": \"TN\",\n    \"792\": \"TR\",\n    \"795\": \"TM\",\n    \"796\": \"TC\",\n    \"798\": \"TV\",\n    \"800\": \"UG\",\n    \"804\": \"UA\",\n    \"807\": \"MK\",\n    \"810\": \"RU AM AZ BY EE GE KZ KG LV LT MD TJ TM UA UZ\",\n    \"818\": \"EG\",\n    \"826\": \"GB\",\n    \"830\": \"JE GG\",\n    \"831\": \"GG\",\n    \"832\": \"JE\",\n    \"833\": \"IM\",\n    \"834\": \"TZ\",\n    \"840\": \"US\",\n    \"850\": \"VI\",\n    \"854\": \"BF\",\n    \"858\": \"UY\",\n    \"860\": \"UZ\",\n    \"862\": \"VE\",\n    \"876\": \"WF\",\n    \"882\": \"WS\",\n    \"886\": \"YE\",\n    \"887\": \"YE\",\n    \"890\": \"RS ME SI HR MK BA\",\n    \"891\": \"RS ME\",\n    \"894\": \"ZM\",\n    \"958\": \"AA\",\n    \"959\": \"QM\",\n    \"960\": \"QN\",\n    \"962\": \"QP\",\n    \"963\": \"QQ\",\n    \"964\": \"QR\",\n    \"965\": \"QS\",\n    \"966\": \"QT\",\n    \"967\": \"EU\",\n    \"968\": \"QV\",\n    \"969\": \"QW\",\n    \"970\": \"QX\",\n    \"971\": \"QY\",\n    \"972\": \"QZ\",\n    \"973\": \"XA\",\n    \"974\": \"XB\",\n    \"975\": \"XC\",\n    \"976\": \"XD\",\n    \"977\": \"XE\",\n    \"978\": \"XF\",\n    \"979\": \"XG\",\n    \"980\": \"XH\",\n    \"981\": \"XI\",\n    \"982\": \"XJ\",\n    \"983\": \"XK\",\n    \"984\": \"XL\",\n    \"985\": \"XM\",\n    \"986\": \"XN\",\n    \"987\": \"XO\",\n    \"988\": \"XP\",\n    \"989\": \"XQ\",\n    \"990\": \"XR\",\n    \"991\": \"XS\",\n    \"992\": \"XT\",\n    \"993\": \"XU\",\n    \"994\": \"XV\",\n    \"995\": \"XW\",\n    \"996\": \"XX\",\n    \"997\": \"XY\",\n    \"998\": \"XZ\",\n    \"999\": \"ZZ\",\n    \"004\": \"AF\",\n    \"008\": \"AL\",\n    \"010\": \"AQ\",\n    \"012\": \"DZ\",\n    \"016\": \"AS\",\n    \"020\": \"AD\",\n    \"024\": \"AO\",\n    \"028\": \"AG\",\n    \"031\": \"AZ\",\n    \"032\": \"AR\",\n    \"036\": \"AU\",\n    \"040\": \"AT\",\n    \"044\": \"BS\",\n    \"048\": \"BH\",\n    \"050\": \"BD\",\n    \"051\": \"AM\",\n    \"052\": \"BB\",\n    \"056\": \"BE\",\n    \"060\": \"BM\",\n    \"062\": \"034 143\",\n    \"064\": \"BT\",\n    \"068\": \"BO\",\n    \"070\": \"BA\",\n    \"072\": \"BW\",\n    \"074\": \"BV\",\n    \"076\": \"BR\",\n    \"084\": \"BZ\",\n    \"086\": \"IO\",\n    \"090\": \"SB\",\n    \"092\": \"VG\",\n    \"096\": \"BN\",\n    \"AAA\": \"AA\",\n    \"ABW\": \"AW\",\n    \"AFG\": \"AF\",\n    \"AGO\": \"AO\",\n    \"AIA\": \"AI\",\n    \"ALA\": \"AX\",\n    \"ALB\": \"AL\",\n    \"AN\": \"CW SX BQ\",\n    \"AND\": \"AD\",\n    \"ANT\": \"CW SX BQ\",\n    \"ARE\": \"AE\",\n    \"ARG\": \"AR\",\n    \"ARM\": \"AM\",\n    \"ASC\": \"AC\",\n    \"ASM\": \"AS\",\n    \"ATA\": \"AQ\",\n    \"ATF\": \"TF\",\n    \"ATG\": \"AG\",\n    \"AUS\": \"AU\",\n    \"AUT\": \"AT\",\n    \"AZE\": \"AZ\",\n    \"BDI\": \"BI\",\n    \"BEL\": \"BE\",\n    \"BEN\": \"BJ\",\n    \"BES\": \"BQ\",\n    \"BFA\": \"BF\",\n    \"BGD\": \"BD\",\n    \"BGR\": \"BG\",\n    \"BHR\": \"BH\",\n    \"BHS\": \"BS\",\n    \"BIH\": \"BA\",\n    \"BLM\": \"BL\",\n    \"BLR\": \"BY\",\n    \"BLZ\": \"BZ\",\n    \"BMU\": \"BM\",\n    \"BOL\": \"BO\",\n    \"BRA\": \"BR\",\n    \"BRB\": \"BB\",\n    \"BRN\": \"BN\",\n    \"BTN\": \"BT\",\n    \"BU\": \"MM\",\n    \"BUR\": \"MM\",\n    \"BVT\": \"BV\",\n    \"BWA\": \"BW\",\n    \"CAF\": \"CF\",\n    \"CAN\": \"CA\",\n    \"CCK\": \"CC\",\n    \"CHE\": \"CH\",\n    \"CHL\": \"CL\",\n    \"CHN\": \"CN\",\n    \"CIV\": \"CI\",\n    \"CMR\": \"CM\",\n    \"COD\": \"CD\",\n    \"COG\": \"CG\",\n    \"COK\": \"CK\",\n    \"COL\": \"CO\",\n    \"COM\": \"KM\",\n    \"CPT\": \"CP\",\n    \"CPV\": \"CV\",\n    \"CRI\": \"CR\",\n    \"CS\": \"RS ME\",\n    \"CT\": \"KI\",\n    \"CUB\": \"CU\",\n    \"CUW\": \"CW\",\n    \"CXR\": \"CX\",\n    \"CYM\": \"KY\",\n    \"CYP\": \"CY\",\n    \"CZE\": \"CZ\",\n    \"DD\": \"DE\",\n    \"DDR\": \"DE\",\n    \"DEU\": \"DE\",\n    \"DGA\": \"DG\",\n    \"DJI\": \"DJ\",\n    \"DMA\": \"DM\",\n    \"DNK\": \"DK\",\n    \"DOM\": \"DO\",\n    \"DY\": \"BJ\",\n    \"DZA\": \"DZ\",\n    \"ECU\": \"EC\",\n    \"EGY\": \"EG\",\n    \"ERI\": \"ER\",\n    \"ESH\": \"EH\",\n    \"ESP\": \"ES\",\n    \"EST\": \"EE\",\n    \"ETH\": \"ET\",\n    \"FIN\": \"FI\",\n    \"FJI\": \"FJ\",\n    \"FLK\": \"FK\",\n    \"FQ\": \"AQ TF\",\n    \"FRA\": \"FR\",\n    \"FRO\": \"FO\",\n    \"FSM\": \"FM\",\n    \"FX\": \"FR\",\n    \"FXX\": \"FR\",\n    \"GAB\": \"GA\",\n    \"GBR\": \"GB\",\n    \"GEO\": \"GE\",\n    \"GGY\": \"GG\",\n    \"GHA\": \"GH\",\n    \"GIB\": \"GI\",\n    \"GIN\": \"GN\",\n    \"GLP\": \"GP\",\n    \"GMB\": \"GM\",\n    \"GNB\": \"GW\",\n    \"GNQ\": \"GQ\",\n    \"GRC\": \"GR\",\n    \"GRD\": \"GD\",\n    \"GRL\": \"GL\",\n    \"GTM\": \"GT\",\n    \"GUF\": \"GF\",\n    \"GUM\": \"GU\",\n    \"GUY\": \"GY\",\n    \"HKG\": \"HK\",\n    \"HMD\": \"HM\",\n    \"HND\": \"HN\",\n    \"HRV\": \"HR\",\n    \"HTI\": \"HT\",\n    \"HUN\": \"HU\",\n    \"HV\": \"BF\",\n    \"IDN\": \"ID\",\n    \"IMN\": \"IM\",\n    \"IND\": \"IN\",\n    \"IOT\": \"IO\",\n    \"IRL\": \"IE\",\n    \"IRN\": \"IR\",\n    \"IRQ\": \"IQ\",\n    \"ISL\": \"IS\",\n    \"ISR\": \"IL\",\n    \"ITA\": \"IT\",\n    \"JAM\": \"JM\",\n    \"JEY\": \"JE\",\n    \"JOR\": \"JO\",\n    \"JPN\": \"JP\",\n    \"JT\": \"UM\",\n    \"KAZ\": \"KZ\",\n    \"KEN\": \"KE\",\n    \"KGZ\": \"KG\",\n    \"KHM\": \"KH\",\n    \"KIR\": \"KI\",\n    \"KNA\": \"KN\",\n    \"KOR\": \"KR\",\n    \"KWT\": \"KW\",\n    \"LAO\": \"LA\",\n    \"LBN\": \"LB\",\n    \"LBR\": \"LR\",\n    \"LBY\": \"LY\",\n    \"LCA\": \"LC\",\n    \"LIE\": \"LI\",\n    \"LKA\": \"LK\",\n    \"LSO\": \"LS\",\n    \"LTU\": \"LT\",\n    \"LUX\": \"LU\",\n    \"LVA\": \"LV\",\n    \"MAC\": \"MO\",\n    \"MAF\": \"MF\",\n    \"MAR\": \"MA\",\n    \"MCO\": \"MC\",\n    \"MDA\": \"MD\",\n    \"MDG\": \"MG\",\n    \"MDV\": \"MV\",\n    \"MEX\": \"MX\",\n    \"MHL\": \"MH\",\n    \"MI\": \"UM\",\n    \"MKD\": \"MK\",\n    \"MLI\": \"ML\",\n    \"MLT\": \"MT\",\n    \"MMR\": \"MM\",\n    \"MNE\": \"ME\",\n    \"MNG\": \"MN\",\n    \"MNP\": \"MP\",\n    \"MOZ\": \"MZ\",\n    \"MRT\": \"MR\",\n    \"MSR\": \"MS\",\n    \"MTQ\": \"MQ\",\n    \"MUS\": \"MU\",\n    \"MWI\": \"MW\",\n    \"MYS\": \"MY\",\n    \"MYT\": \"YT\",\n    \"NAM\": \"NA\",\n    \"NCL\": \"NC\",\n    \"NER\": \"NE\",\n    \"NFK\": \"NF\",\n    \"NGA\": \"NG\",\n    \"NH\": \"VU\",\n    \"NIC\": \"NI\",\n    \"NIU\": \"NU\",\n    \"NLD\": \"NL\",\n    \"NOR\": \"NO\",\n    \"NPL\": \"NP\",\n    \"NQ\": \"AQ\",\n    \"NRU\": \"NR\",\n    \"NT\": \"SA IQ\",\n    \"NTZ\": \"SA IQ\",\n    \"NZL\": \"NZ\",\n    \"OMN\": \"OM\",\n    \"PAK\": \"PK\",\n    \"PAN\": \"PA\",\n    \"PC\": \"FM MH MP PW\",\n    \"PCN\": \"PN\",\n    \"PER\": \"PE\",\n    \"PHL\": \"PH\",\n    \"PLW\": \"PW\",\n    \"PNG\": \"PG\",\n    \"POL\": \"PL\",\n    \"PRI\": \"PR\",\n    \"PRK\": \"KP\",\n    \"PRT\": \"PT\",\n    \"PRY\": \"PY\",\n    \"PSE\": \"PS\",\n    \"PU\": \"UM\",\n    \"PYF\": \"PF\",\n    \"PZ\": \"PA\",\n    \"QAT\": \"QA\",\n    \"QMM\": \"QM\",\n    \"QNN\": \"QN\",\n    \"QPP\": \"QP\",\n    \"QQQ\": \"QQ\",\n    \"QRR\": \"QR\",\n    \"QSS\": \"QS\",\n    \"QTT\": \"QT\",\n    \"QU\": \"EU\",\n    \"QUU\": \"EU\",\n    \"QVV\": \"QV\",\n    \"QWW\": \"QW\",\n    \"QXX\": \"QX\",\n    \"QYY\": \"QY\",\n    \"QZZ\": \"QZ\",\n    \"REU\": \"RE\",\n    \"RH\": \"ZW\",\n    \"ROU\": \"RO\",\n    \"RUS\": \"RU\",\n    \"RWA\": \"RW\",\n    \"SAU\": \"SA\",\n    \"SCG\": \"RS ME\",\n    \"SDN\": \"SD\",\n    \"SEN\": \"SN\",\n    \"SGP\": \"SG\",\n    \"SGS\": \"GS\",\n    \"SHN\": \"SH\",\n    \"SJM\": \"SJ\",\n    \"SLB\": \"SB\",\n    \"SLE\": \"SL\",\n    \"SLV\": \"SV\",\n    \"SMR\": \"SM\",\n    \"SOM\": \"SO\",\n    \"SPM\": \"PM\",\n    \"SRB\": \"RS\",\n    \"SSD\": \"SS\",\n    \"STP\": \"ST\",\n    \"SU\": \"RU AM AZ BY EE GE KZ KG LV LT MD TJ TM UA UZ\",\n    \"SUN\": \"RU AM AZ BY EE GE KZ KG LV LT MD TJ TM UA UZ\",\n    \"SUR\": \"SR\",\n    \"SVK\": \"SK\",\n    \"SVN\": \"SI\",\n    \"SWE\": \"SE\",\n    \"SWZ\": \"SZ\",\n    \"SXM\": \"SX\",\n    \"SYC\": \"SC\",\n    \"SYR\": \"SY\",\n    \"TAA\": \"TA\",\n    \"TCA\": \"TC\",\n    \"TCD\": \"TD\",\n    \"TGO\": \"TG\",\n    \"THA\": \"TH\",\n    \"TJK\": \"TJ\",\n    \"TKL\": \"TK\",\n    \"TKM\": \"TM\",\n    \"TLS\": \"TL\",\n    \"TMP\": \"TL\",\n    \"TON\": \"TO\",\n    \"TP\": \"TL\",\n    \"TTO\": \"TT\",\n    \"TUN\": \"TN\",\n    \"TUR\": \"TR\",\n    \"TUV\": \"TV\",\n    \"TWN\": \"TW\",\n    \"TZA\": \"TZ\",\n    \"UGA\": \"UG\",\n    \"UK\": \"GB\",\n    \"UKR\": \"UA\",\n    \"UMI\": \"UM\",\n    \"URY\": \"UY\",\n    \"USA\": \"US\",\n    \"UZB\": \"UZ\",\n    \"VAT\": \"VA\",\n    \"VCT\": \"VC\",\n    \"VD\": \"VN\",\n    \"VEN\": \"VE\",\n    \"VGB\": \"VG\",\n    \"VIR\": \"VI\",\n    \"VNM\": \"VN\",\n    \"VUT\": \"VU\",\n    \"WK\": \"UM\",\n    \"WLF\": \"WF\",\n    \"WSM\": \"WS\",\n    \"XAA\": \"XA\",\n    \"XBB\": \"XB\",\n    \"XCC\": \"XC\",\n    \"XDD\": \"XD\",\n    \"XEE\": \"XE\",\n    \"XFF\": \"XF\",\n    \"XGG\": \"XG\",\n    \"XHH\": \"XH\",\n    \"XII\": \"XI\",\n    \"XJJ\": \"XJ\",\n    \"XKK\": \"XK\",\n    \"XLL\": \"XL\",\n    \"XMM\": \"XM\",\n    \"XNN\": \"XN\",\n    \"XOO\": \"XO\",\n    \"XPP\": \"XP\",\n    \"XQQ\": \"XQ\",\n    \"XRR\": \"XR\",\n    \"XSS\": \"XS\",\n    \"XTT\": \"XT\",\n    \"XUU\": \"XU\",\n    \"XVV\": \"XV\",\n    \"XWW\": \"XW\",\n    \"XXX\": \"XX\",\n    \"XYY\": \"XY\",\n    \"XZZ\": \"XZ\",\n    \"YD\": \"YE\",\n    \"YEM\": \"YE\",\n    \"YMD\": \"YE\",\n    \"YU\": \"RS ME\",\n    \"YUG\": \"RS ME\",\n    \"ZAF\": \"ZA\",\n    \"ZAR\": \"CD\",\n    \"ZMB\": \"ZM\",\n    \"ZR\": \"CD\",\n    \"ZWE\": \"ZW\",\n    \"ZZZ\": \"ZZ\"\n};\nexports.scriptAlias = {\n    \"Qaai\": \"Zinh\"\n};\nexports.variantAlias = {\n    \"heploc\": \"alalc97\",\n    \"polytoni\": \"polyton\"\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\n// Type-only circular import\n// eslint-disable-next-line import/no-cycle\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar internalSlotMap = new WeakMap();\nfunction getInternalSlots(x) {\n    var internalSlots = internalSlotMap.get(x);\n    if (!internalSlots) {\n        internalSlots = Object.create(null);\n        internalSlotMap.set(x, internalSlots);\n    }\n    return internalSlots;\n}\nexports.default = getInternalSlots;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shouldPolyfill = void 0;\n/**\n * https://bugs.chromium.org/p/v8/issues/detail?id=10682\n */\nfunction hasIntlGetCanonicalLocalesBug() {\n    try {\n        return new Intl.Locale('und-x-private').toString() === 'x-private';\n    }\n    catch (e) {\n        return true;\n    }\n}\nfunction shouldPolyfill() {\n    return (typeof Intl === 'undefined' ||\n        !('Locale' in Intl) ||\n        hasIntlGetCanonicalLocalesBug());\n}\nexports.shouldPolyfill = shouldPolyfill;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _1 = require(\"./\");\nvar should_polyfill_1 = require(\"./should-polyfill\");\nif (should_polyfill_1.shouldPolyfill()) {\n    Object.defineProperty(Intl, 'PluralRules', {\n        value: _1.PluralRules,\n        writable: true,\n        enumerable: false,\n        configurable: true,\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PluralRules = void 0;\nvar tslib_1 = require(\"tslib\");\nvar ecma402_abstract_1 = require(\"@formatjs/ecma402-abstract\");\nvar get_internal_slots_1 = tslib_1.__importDefault(require(\"./get_internal_slots\"));\nfunction validateInstance(instance, method) {\n    if (!(instance instanceof PluralRules)) {\n        throw new TypeError(\"Method Intl.PluralRules.prototype.\" + method + \" called on incompatible receiver \" + String(instance));\n    }\n}\n/**\n * http://ecma-international.org/ecma-402/7.0/index.html#sec-pluralruleselect\n * @param locale\n * @param type\n * @param _n\n * @param param3\n */\nfunction PluralRuleSelect(locale, type, _n, _a) {\n    var IntegerDigits = _a.IntegerDigits, NumberOfFractionDigits = _a.NumberOfFractionDigits, FractionDigits = _a.FractionDigits;\n    return PluralRules.localeData[locale].fn(NumberOfFractionDigits\n        ? IntegerDigits + \".\" + FractionDigits\n        : IntegerDigits, type === 'ordinal');\n}\nvar PluralRules = /** @class */ (function () {\n    function PluralRules(locales, options) {\n        // test262/test/intl402/RelativeTimeFormat/constructor/constructor/newtarget-undefined.js\n        // Cannot use `new.target` bc of IE11 & TS transpiles it to something else\n        var newTarget = this && this instanceof PluralRules ? this.constructor : void 0;\n        if (!newTarget) {\n            throw new TypeError(\"Intl.PluralRules must be called with 'new'\");\n        }\n        return ecma402_abstract_1.InitializePluralRules(this, locales, options, {\n            availableLocales: PluralRules.availableLocales,\n            relevantExtensionKeys: PluralRules.relevantExtensionKeys,\n            localeData: PluralRules.localeData,\n            getDefaultLocale: PluralRules.getDefaultLocale,\n            getInternalSlots: get_internal_slots_1.default,\n        });\n    }\n    PluralRules.prototype.resolvedOptions = function () {\n        validateInstance(this, 'resolvedOptions');\n        var opts = Object.create(null);\n        var internalSlots = get_internal_slots_1.default(this);\n        opts.locale = internalSlots.locale;\n        opts.type = internalSlots.type;\n        [\n            'minimumIntegerDigits',\n            'minimumFractionDigits',\n            'maximumFractionDigits',\n            'minimumSignificantDigits',\n            'maximumSignificantDigits',\n        ].forEach(function (field) {\n            var val = internalSlots[field];\n            if (val !== undefined) {\n                opts[field] = val;\n            }\n        });\n        opts.pluralCategories = tslib_1.__spreadArrays(PluralRules.localeData[opts.locale].categories[opts.type]);\n        return opts;\n    };\n    PluralRules.prototype.select = function (val) {\n        var pr = this;\n        validateInstance(pr, 'select');\n        var n = ecma402_abstract_1.ToNumber(val);\n        return ecma402_abstract_1.ResolvePlural(pr, n, { getInternalSlots: get_internal_slots_1.default, PluralRuleSelect: PluralRuleSelect });\n    };\n    PluralRules.prototype.toString = function () {\n        return '[object Intl.PluralRules]';\n    };\n    PluralRules.supportedLocalesOf = function (locales, options) {\n        return ecma402_abstract_1.SupportedLocales(PluralRules.availableLocales, ecma402_abstract_1.CanonicalizeLocaleList(locales), options);\n    };\n    PluralRules.__addLocaleData = function () {\n        var data = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            data[_i] = arguments[_i];\n        }\n        for (var _a = 0, data_1 = data; _a < data_1.length; _a++) {\n            var _b = data_1[_a], d = _b.data, locale = _b.locale;\n            PluralRules.localeData[locale] = d;\n            PluralRules.availableLocales.add(locale);\n            if (!PluralRules.__defaultLocale) {\n                PluralRules.__defaultLocale = locale;\n            }\n        }\n    };\n    PluralRules.getDefaultLocale = function () {\n        return PluralRules.__defaultLocale;\n    };\n    PluralRules.localeData = {};\n    PluralRules.availableLocales = new Set();\n    PluralRules.__defaultLocale = '';\n    PluralRules.relevantExtensionKeys = [];\n    PluralRules.polyfilled = true;\n    return PluralRules;\n}());\nexports.PluralRules = PluralRules;\ntry {\n    // IE11 does not have Symbol\n    if (typeof Symbol !== 'undefined') {\n        Object.defineProperty(PluralRules.prototype, Symbol.toStringTag, {\n            value: 'Intl.PluralRules',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        });\n    }\n    try {\n        // https://github.com/tc39/test262/blob/master/test/intl402/PluralRules/length.js\n        Object.defineProperty(PluralRules, 'length', {\n            value: 0,\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        });\n    }\n    catch (error) {\n        // IE 11 sets Function.prototype.length to be non-configurable which will cause the\n        // above Object.defineProperty to throw an error.\n    }\n    // https://github.com/tc39/test262/blob/master/test/intl402/RelativeTimeFormat/constructor/length.js\n    Object.defineProperty(PluralRules.prototype.constructor, 'length', {\n        value: 0,\n        writable: false,\n        enumerable: false,\n        configurable: true,\n    });\n    // https://github.com/tc39/test262/blob/master/test/intl402/RelativeTimeFormat/constructor/supportedLocalesOf/length.js\n    Object.defineProperty(PluralRules.supportedLocalesOf, 'length', {\n        value: 1,\n        writable: false,\n        enumerable: false,\n        configurable: true,\n    });\n}\ncatch (ex) {\n    // Meta fixes for test262\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar internalSlotMap = new WeakMap();\nfunction getInternalSlots(x) {\n    var internalSlots = internalSlotMap.get(x);\n    if (!internalSlots) {\n        internalSlots = Object.create(null);\n        internalSlotMap.set(x, internalSlots);\n    }\n    return internalSlots;\n}\nexports.default = getInternalSlots;\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n\nexport const sleep = function(milliseconds) {\n  return new Promise(resolve => {\n    setTimeout(resolve, milliseconds);\n  });\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shouldPolyfill = void 0;\nfunction shouldPolyfill() {\n    return (typeof Intl === 'undefined' ||\n        !('PluralRules' in Intl) ||\n        new Intl.PluralRules('en', { minimumFractionDigits: 2 }).select(1) ===\n            'one');\n}\nexports.shouldPolyfill = shouldPolyfill;\n","/* @generated */\n// prettier-ignore\nif (Intl.PluralRules && typeof Intl.PluralRules.__addLocaleData === 'function') {\n  Intl.PluralRules.__addLocaleData({\"data\":{\"categories\":{\"cardinal\":[\"one\",\"other\"],\"ordinal\":[\"one\",\"two\",\"few\",\"other\"]},\"fn\":function(n, ord) {\n  var s = String(n).split('.'), v0 = !s[1], t0 = Number(s[0]) == n, n10 = t0 && s[0].slice(-1), n100 = t0 && s[0].slice(-2);\n  if (ord) return n10 == 1 && n100 != 11 ? 'one'\n    : n10 == 2 && n100 != 12 ? 'two'\n    : n10 == 3 && n100 != 13 ? 'few'\n    : 'other';\n  return n == 1 && v0 ? 'one' : 'other';\n}},\"locale\":\"en\"})\n}\n","var map = {\n\t\"./de.json\": [\n\t\t237,\n\t\t18\n\t],\n\t\"./es.json\": [\n\t\t238,\n\t\t19\n\t],\n\t\"./fr.json\": [\n\t\t239,\n\t\t20\n\t],\n\t\"./ja.json\": [\n\t\t240,\n\t\t21\n\t],\n\t\"./ko.json\": [\n\t\t241,\n\t\t22\n\t],\n\t\"./pt.json\": [\n\t\t242,\n\t\t23\n\t],\n\t\"./ru.json\": [\n\t\t243,\n\t\t24\n\t],\n\t\"./zh-cn.json\": [\n\t\t244,\n\t\t25\n\t],\n\t\"./zh-tw.json\": [\n\t\t245,\n\t\t26\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 132;\nmodule.exports = webpackAsyncContext;","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\n\nmodule.exports = {\n  isString: function(arg) {\n    return typeof(arg) === 'string';\n  },\n  isObject: function(arg) {\n    return typeof(arg) === 'object' && arg !== null;\n  },\n  isNull: function(arg) {\n    return arg === null;\n  },\n  isNullOrUndefined: function(arg) {\n    return arg == null;\n  }\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","// We should technically be able to just include three here, but our dependancies are tangled such that not having aframe is a bit difficult\nimport \"./utils/theme\";\nconsole.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"aframe\";\nimport \"./utils/logging\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { WrappedIntlProvider } from \"./react-components/wrapped-intl-provider\";\n\nimport configs from \"./utils/configs\";\n\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\ndisableiOSZoom();\n\nimport { App } from \"./App\";\n\nimport AvatarPreview from \"./react-components/avatar-preview\";\n\nimport { fetchAvatar, remixAvatar } from \"./utils/avatar-utils\";\n\nimport \"./react-components/styles/global.scss\";\nimport styles from \"./assets/stylesheets/avatar.scss\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faClone } from \"@fortawesome/free-solid-svg-icons/faClone\";\nimport { ThemeProvider } from \"./react-components/styles/theme\";\n\nconst qs = new URLSearchParams(location.search);\nwindow.APP = new App();\n\nclass AvatarPage extends React.Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    store: PropTypes.object,\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = { copyMessage: null };\n  }\n\n  componentDidMount() {\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.refetchAvatar();\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  storeUpdated = () => this.forceUpdate();\n\n  refetchAvatar = async () => {\n    const avatar = await fetchAvatar(this.props.avatarId);\n    this.setState({ avatar });\n  };\n\n  setAvatar = e => {\n    e && e.preventDefault();\n    this.props.store.update({\n      profile: { avatarId: this.state.avatar.avatar_id }\n    });\n  };\n\n  handleCopyAvatar = async e => {\n    e.preventDefault();\n    const { avatar } = this.state;\n    this.setState({ copyState: \"copying\" });\n    await remixAvatar(avatar.avatar_id, avatar.name);\n    this.setState({ copyState: \"copied\" });\n    setTimeout(() => this.setState({ copyMessage: null }), 2000);\n  };\n\n  render() {\n    const { avatar, copyState } = this.state;\n    if (!avatar) {\n      return (\n        <div className={styles.avatarLanding}>\n          <div className={classNames([styles.box, styles.darkened])}>\n            <FormattedMessage id=\"avatar-page.loading\" defaultMessage=\"Loading\" />\n          </div>\n        </div>\n      );\n    }\n\n    const selectedAvatarId = this.props.store.state.profile.avatarId;\n    const isSelected = avatar.avatar_id === selectedAvatarId;\n\n    return (\n      <form onSubmit={this.setAvatar} className={styles.avatarLanding}>\n        <div className={classNames([styles.box, styles.darkened])}>\n          <label className={styles.title}>\n            <span>{avatar.name}</span>\n          </label>\n          <div className={styles.attributions}>\n            {avatar.attributions && avatar.attributions.creator && <span>{`by ${avatar.attributions.creator}`}</span>}\n          </div>\n          <div className={styles.preview}>\n            {avatar && <AvatarPreview avatarGltfUrl={avatar.gltf_url} />}\n            {copyState ? (\n              <div className={styles.copyTip}>\n                {copyState === \"copying\" ? (\n                  <FormattedMessage id=\"avatar-page.copying-avatar\" defaultMessage=\"Copying...\" />\n                ) : (\n                  <FormattedMessage id=\"avatar-page.copied-avatar\" defaultMessage=\"Copied\" />\n                )}\n              </div>\n            ) : (\n              avatar &&\n              avatar.type === \"avatar_listing\" &&\n              avatar.allow_remixing && (\n                <a\n                  className={styles.editAvatar}\n                  onClick={this.handleCopyAvatar}\n                  title={<FormattedMessage id=\"avatar-page.copy-button\" defaultMessage=\"Copy to my avatars\" />}\n                >\n                  <FontAwesomeIcon icon={faClone} />\n                </a>\n              )\n            )}\n          </div>\n          {isSelected ? (\n            <span className={styles.selectedMessage}>\n              <FormattedMessage id=\"avatar-page.selected\" defaultMessage=\"This is your current avatar\" />\n            </span>\n          ) : (\n            <button disabled={isSelected} className={styles.formSubmit} type=\"submit\">\n              <FormattedMessage id=\"avatar-page.select\" defaultMessage=\"Select\" />\n            </button>\n          )}\n        </div>\n        <img\n          className={styles.logo}\n          src={configs.image(\"logo\")}\n          alt={<FormattedMessage id=\"avatar-page.logo\" defaultMessage=\"Logo\" />}\n        />\n      </form>\n    );\n  }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const avatarId = qs.get(\"avatar_id\") || document.location.pathname.substring(1).split(\"/\")[1];\n  console.log(`Avatar ID: ${avatarId}`);\n  ReactDOM.render(\n    <WrappedIntlProvider>\n      <ThemeProvider store={window.APP.store}>\n        <AvatarPage avatarId={avatarId} store={window.APP.store} />\n      </ThemeProvider>\n    </WrappedIntlProvider>,\n    document.getElementById(\"ui-root\")\n  );\n});\n","import configs from \"./configs\";\nimport { AVAILABLE_LOCALES, FALLBACK_LOCALES } from \"../assets/locales/locale_config\";\n\n// These are set in the admin panel and are only included as fallbacks.\nconst defaultLocaleData = {\n  \"app-name\": \"App\",\n  \"editor-name\": \"Scene Editor\",\n  \"contact-email\": \"app@company.com\",\n  \"company-name\": \"Company\",\n  \"share-hashtag\": \"#app\",\n  \"app-description\": \"Gather share and collaborate together in a virtual, private and safe space\",\n  \"app-tagline\": \"Private social VR in your web browser\"\n};\n\nconst DEFAULT_LOCALE = \"en\";\nconst cachedMessages = new Map();\n\nlet _locale = DEFAULT_LOCALE;\nlet _localeData = defaultLocaleData;\n\nfunction findLocale(locale) {\n  const locales = (() => {\n    if (navigator.languages) {\n      return [...navigator.languages];\n    }\n    if (navigator.language) {\n      return [navigator.language];\n    }\n    if (navigator.userLanguage) {\n      return [navigator.userLanguage];\n    }\n  })();\n\n  if (locale && locale !== \"browser\") {\n    locales.unshift(locale);\n  }\n\n  for (let i = 0; i < locales.length; i++) {\n    const curLocale = locales[i];\n    if (AVAILABLE_LOCALES.hasOwnProperty(curLocale)) {\n      return curLocale;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(curLocale)) {\n      FALLBACK_LOCALES.hasOwnProperty(curLocale);\n    }\n    // Also check the primary language subtag in case\n    // we do not have an entry for full tag\n    // See https://en.wikipedia.org/wiki/IETF_language_tag#Syntax_of_language_tags\n    // and https://github.com/mozilla/hubs/pull/3350/files#diff-70ef5717d3da03ef288e8d15c2fda32c5237d7f37074421496f22403e4475bf1R16\n    const primaryLanguageSubtag = curLocale.split(\"-\")[0].toLowerCase();\n    if (AVAILABLE_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return primaryLanguageSubtag;\n    }\n    if (FALLBACK_LOCALES.hasOwnProperty(primaryLanguageSubtag)) {\n      return FALLBACK_LOCALES[primaryLanguageSubtag];\n    }\n  }\n  return DEFAULT_LOCALE;\n}\n\nexport function setLocale(locale) {\n  const resolvedLocale = findLocale(locale);\n\n  if (resolvedLocale === DEFAULT_LOCALE) {\n    _locale = resolvedLocale;\n    _localeData = defaultLocaleData;\n    window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n  } else {\n    if (cachedMessages.has(resolvedLocale)) {\n      _locale = resolvedLocale;\n      window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n    } else {\n      import(`../assets/locales/${resolvedLocale}.json`).then(({ default: localeData }) => {\n        _locale = resolvedLocale;\n        _localeData = localeData;\n        window.dispatchEvent(new CustomEvent(\"locale-updated\"));\n      });\n    }\n  }\n}\n\nconst interval = window.setInterval(() => {\n  if (window.APP && window.APP.store) {\n    window.clearInterval(interval);\n    setLocale(window.APP.store.state.preferences.locale);\n    window.APP.store.addEventListener(\"statechanged\", () => {\n      setLocale(window.APP.store.state.preferences.locale);\n    });\n  }\n}, 100);\n\nexport const getLocale = () => {\n  return _locale;\n};\n\nexport const getMessage = key => {\n  return _localeData[key];\n};\n\n// TODO: This should be removed, lets not inject app config data up front but rather via variables so that defaultMessage works properly.\nexport const getMessages = () => {\n  if (cachedMessages.has(_locale)) {\n    return cachedMessages.get(_locale);\n  }\n\n  // Swap in translations specified via the admin panel\n  if (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[_locale]) {\n    const configTranslations = configs.APP_CONFIG.translations[_locale];\n    for (const messageKey in configTranslations) {\n      if (!configTranslations.hasOwnProperty(messageKey)) continue;\n      if (!configTranslations[messageKey]) continue;\n      _localeData[messageKey] = configTranslations[messageKey];\n    }\n  }\n\n  const entries = [];\n  for (const key in _localeData) {\n    if (!_localeData.hasOwnProperty(key)) continue;\n    entries.push([key, _localeData[key]]);\n  }\n\n  const messages = entries\n    .map(([key, message]) => [\n      key,\n      // Replace nested message keys (e.g. %app-name%) with their messages.\n      message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _localeData[subkey])\n    ])\n    .reduce((acc, entry) => {\n      acc[entry[0]] = entry[1];\n      return acc;\n    }, {});\n\n  cachedMessages.set(_locale, messages);\n  return messages;\n};\n","import nextTick from \"../utils/next-tick\";\nimport { updateMaterials, mapMaterials, convertStandardMaterial } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nimport { disposeNode, cloneObject3D } from \"../utils/three-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { KTX2Loader } from \"three/examples/jsm/loaders/KTX2Loader\";\nimport { RGBELoader } from \"three/examples/jsm/loaders/RGBELoader\";\nimport { BasisTextureLoader } from \"three/examples/jsm/loaders/BasisTextureLoader\";\nimport { DRACOLoader } from \"three/examples/jsm/loaders/DRACOLoader\";\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nclass GLTFCache {\n  cache = new Map();\n\n  set(src, gltf) {\n    this.cache.set(src, {\n      gltf,\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached gltf ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    if (cacheItem.count <= 0) {\n      cacheItem.gltf.scene.traverse(disposeNode);\n      this.cache.delete(src);\n    }\n  }\n}\nconst gltfCache = new GLTFCache();\nconst inflightGltfs = new Map();\n\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    console.warn(`Inflator failed. \"${componentName}\" component does not exist.`);\n    return;\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n\n      if (\n        geo.attributes.position.isInterleavedBufferAttribute ||\n        (geo.index && geo.index.isInterleavedBufferAttribute)\n      ) {\n        console.warn(\"Skipping generaton of MeshBVH for interleaved geoemtry as it is not supported\");\n        return;\n      }\n\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.scene.animations,\n    scene: cloneObject3D(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\nfunction getHubsComponentsFromMaterial(node) {\n  const material = node.material;\n\n  if (!material) {\n    return null;\n  }\n\n  return getHubsComponents(material);\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n  const materialComponents = getHubsComponentsFromMaterial(node);\n\n  const nodeHasBehavior = !!entityComponents || !!materialComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that templates can be attached to the correct AFrame entity.\n  el.object3D.name = node.name;\n\n  // Set the uuid of the `THREE.Group` to match the uuid of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.uuid = node.uuid;\n  node.uuid = THREE.Math.generateUUID();\n\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  if (node.morphTargetInfluences) {\n    node.parent.morphTargetInfluences = node.morphTargetInfluences;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nasync function inflateComponents(inflatedEntity, indexToEntityMap) {\n  let isFirstInflation = true;\n  const objectInflations = [];\n\n  inflatedEntity.object3D.traverse(async object3D => {\n    const objectInflation = {};\n    objectInflation.promise = new Promise(resolve => (objectInflation.resolve = resolve));\n    objectInflations.push(objectInflation);\n\n    if (!isFirstInflation) {\n      await objectInflations.shift().promise;\n    }\n    isFirstInflation = false;\n\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    function resolveNodeRefs(componentData) {\n      for (const propName in componentData) {\n        const value = componentData[propName];\n        const type = value?.__mhc_link_type;\n        if (type === \"node\" && value.index !== undefined) {\n          if (indexToEntityMap[value.index]) {\n            componentData[propName] = indexToEntityMap[value.index].object3D;\n          } else {\n            console.warn(\"inflateComponents: invalid node reference\", propName);\n            componentData[propName] = null;\n          }\n        }\n      }\n      return componentData;\n    }\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(entityComponents[prop]),\n            entityComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    const materialComponents = getHubsComponentsFromMaterial(object3D);\n\n    if (materialComponents && el) {\n      for (const prop in materialComponents) {\n        if (materialComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          await inflator(\n            el,\n            componentName,\n            resolveNodeRefs(materialComponents[prop]),\n            materialComponents,\n            indexToEntityMap\n          );\n        }\n      }\n    }\n\n    objectInflation.resolve();\n  });\n\n  await objectInflations.shift().promise;\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction getHubsComponentsExtension(node) {\n  if (node.extensions && node.extensions.MOZ_hubs_components) {\n    return node.extensions.MOZ_hubs_components;\n  } else if (node.extensions && node.extensions.HUBS_components) {\n    return node.extensions.HUBS_components;\n  } else if (node.extras && node.extras.gltfExtensions && node.extras.gltfExtensions.MOZ_hubs_components) {\n    return node.extras.gltfExtensions.MOZ_hubs_components;\n  }\n}\n\n// Versions are documented here: https://github.com/mozilla/hubs/wiki/MOZ_hubs_components-Changelog\n// Make sure to update the wiki and Spoke when bumping a version\nfunction runMigration(version, json) {\n  if (version < 2) {\n    //old heightfields will be on the same node as the nav-mesh, delete those\n    const oldHeightfieldNode = json.nodes.find(node => {\n      const components = getHubsComponentsExtension(node);\n      return components && components.heightfield && components[\"nav-mesh\"];\n    });\n    if (oldHeightfieldNode) {\n      if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.MOZ_hubs_components) {\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\n      } else if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.HUBS_components) {\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\n      } else if (\n        oldHeightfieldNode.extras &&\n        oldHeightfieldNode.extras.gltfExtensions &&\n        oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components\n      ) {\n        delete oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components;\n      }\n    }\n  }\n\n  if (version < 4) {\n    // Lights prior to version 4 should treat range === 0 as if it has zero decay\n    if (json.nodes) {\n      for (const node of json.nodes) {\n        const components = getHubsComponentsExtension(node);\n\n        if (!components) {\n          continue;\n        }\n\n        const light = components[\"spot-light\"] || components[\"point-light\"];\n\n        if (light && light.range === 0) {\n          light.decay = 0;\n        }\n      }\n    }\n  }\n}\n\nlet ktxLoader;\nlet dracoLoader;\n\nclass GLTFHubsPlugin {\n  constructor(parser, jsonPreprocessor) {\n    this.parser = parser;\n    this.jsonPreprocessor = jsonPreprocessor;\n\n    // We override glTF parser textureLoader with our HubsTextureLoader for\n    // 1. Clean up the texture image related resources after it is uploaded to WebGL texture\n    // 2. Use ImageBitmapLoader if it is available. The latest official Three.js (r128) glTF loader\n    //    attempts to use ImageBitmapLoader if it is avaiable except for Firefox.\n    //    But we want to use ImageBitmapLoader even for Firefox so we need this overriding hack.\n    // But overriding the textureLoader is hacky and it can cause future potential problems\n    // especially in upstraming Three.js. So ideally we should replace this hack\n    // with the one using more proper APIs like plugin system at some point.\n    // Note: Be careful when replacing our Three.js fork with the official upstraming one that\n    //       the latest ImageBitmapLoader passes the second argument to createImageBitmap()\n    //       but currently createImageBitmap() on Firefox fails if the second argument is defined.\n    //       https://bugzilla.mozilla.org/show_bug.cgi?id=1367251\n    //       and this is the reason why the official glTF loader doesn't use ImageBitmapLoader\n    //       for Firefox. We will need a workaround for that.\n    parser.textureLoader = new HubsTextureLoader(parser.options.manager);\n  }\n\n  beforeRoot() {\n    const parser = this.parser;\n    const jsonPreprocessor = this.jsonPreprocessor;\n\n    //\n    if (jsonPreprocessor) {\n      parser.json = jsonPreprocessor(parser.json);\n    }\n\n    // Ideally Hubs components stuffs should be handled in MozHubsComponents plugin?\n    let version = 0;\n    if (\n      parser.json.extensions &&\n      parser.json.extensions.MOZ_hubs_components &&\n      parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\n    ) {\n      version = parser.json.extensions.MOZ_hubs_components.version;\n    }\n    runMigration(version, parser.json);\n\n    // Note: Here may be rewritten with the one with parser.associations\n    const nodes = parser.json.nodes;\n    if (nodes) {\n      for (let i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n\n        if (!node.extras) {\n          node.extras = {};\n        }\n\n        node.extras.gltfIndex = i;\n      }\n    }\n  }\n\n  afterRoot(gltf) {\n    gltf.scene.traverse(object => {\n      // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n      // @TODO: Should this be fixed in the gltf loader?\n      object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n      const materialQuality = window.APP.store.state.preferences.materialQualitySetting;\n      updateMaterials(object, material => convertStandardMaterial(material, materialQuality));\n    });\n\n    // Replace animation target node name with the node uuid.\n    // I assume track name is 'nodename.property'.\n    if (gltf.animations) {\n      for (const animation of gltf.animations) {\n        for (const track of animation.tracks) {\n          const parsedPath = THREE.PropertyBinding.parseTrackName(track.name);\n          for (const scene of gltf.scenes) {\n            const node = THREE.PropertyBinding.findNode(scene, parsedPath.nodeName);\n            if (node) {\n              track.name = track.name.replace(/^[^.]*\\./, node.uuid + \".\");\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    //\n    gltf.scene.animations = gltf.animations;\n  }\n}\n\nclass GLTFHubsComponentsExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_hubs_components\";\n  }\n\n  afterRoot({ scenes, parser }) {\n    const deps = [];\n\n    const resolveComponents = (gltfRootType, obj) => {\n      const idx = parser.associations.get(obj)?.[gltfRootType];\n      if (idx === undefined) return;\n      const ext = parser.json[gltfRootType][idx].extensions?.[this.name];\n      if (!ext) return;\n\n      // TODO putting this into userData is a bit silly, we should just inflate here, but entities need to be inflated first...\n      obj.userData.gltfExtensions = Object.assign(obj.userData.gltfExtensions || {}, {\n        MOZ_hubs_components: ext\n      });\n\n      for (const componentName in ext) {\n        const props = ext[componentName];\n        for (const propName in props) {\n          const value = props[propName];\n          const type = value?.__mhc_link_type;\n          if (type && value.index !== undefined) {\n            deps.push(\n              parser.getDependency(type, value.index).then(loadedDep => {\n                // TODO similar to above, this logic being spread out in multiple places is not great...\n                // Node refences are assumed to always be in the scene graph. These referneces are late-resolved in inflateComponents\n                // otherwise they will need to be updated when cloning (which happens as part of caching).\n                if (type === \"node\") return;\n\n                if (type === \"texture\" && !parser.json.textures[value.index].extensions?.MOZ_texture_rgbe) {\n                  // For now assume all non HDR textures linked in hubs components are sRGB.\n                  // We can allow this to be overriden later if needed\n                  loadedDep.encoding = THREE.sRGBEncoding;\n                }\n\n                props[propName] = loadedDep;\n\n                return loadedDep;\n              })\n            );\n          }\n        }\n      }\n    };\n\n    for (let i = 0; i < scenes.length; i++) {\n      // TODO this should be done by GLTLoader\n      parser.associations.set(scenes[i], { scenes: i });\n      scenes[i].traverse(obj => {\n        resolveComponents(\"scenes\", obj);\n        resolveComponents(\"nodes\", obj);\n        mapMaterials(obj, resolveComponents.bind(this, \"materials\"));\n      });\n    }\n\n    return Promise.all(deps);\n  }\n}\n\nclass GLTFHubsLightMapExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_lightmap\";\n  }\n\n  // @TODO: Ideally we should use extendMaterialParams hook.\n  //        But the current official glTF loader doesn't fire extendMaterialParams\n  //        hook for unlit and specular-glossiness materials.\n  //        So using loadMaterial hook as workaround so far.\n  //        Cons is loadMaterial hook is fired as _invokeOne so\n  //        if other plugins defining loadMaterial is registered\n  //        there is a chance that this light map extension handler isn't called.\n  //        The glTF loader should be updated to remove the limitation.\n  loadMaterial(materialIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const materialDef = json.materials[materialIndex];\n\n    if (!materialDef.extensions || !materialDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = materialDef.extensions[this.name];\n\n    const pending = [];\n\n    pending.push(parser.loadMaterial(materialIndex));\n    pending.push(parser.getDependency(\"texture\", extensionDef.index));\n\n    return Promise.all(pending).then(results => {\n      const material = results[0];\n      const lightMap = results[1];\n      material.lightMap = lightMap;\n      material.lightMapIntensity = extensionDef.intensity !== undefined ? extensionDef.intensity : 1;\n      return material;\n    });\n  }\n}\n\nclass GLTFHubsTextureBasisExtension {\n  constructor(parser) {\n    this.parser = parser;\n    this.name = \"MOZ_HUBS_texture_basis\";\n    this.basisLoader = null;\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    if (this.basisLoader === null) {\n      this.basisLoader = new BasisTextureLoader(parser.options.manager).detectSupport(AFRAME.scenes[0].renderer);\n    }\n\n    if (!this.basisLoader) {\n      // @TODO: Display warning (only if the extension is in extensionsRequired)?\n      return null;\n    }\n\n    console.warn(`The ${this.name} extension is deprecated, you should use KHR_texture_basisu instead.`);\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = json.images[extensionDef.source];\n\n    return parser.loadTextureImage(textureIndex, source, this.basisLoader);\n  }\n}\n\nclass GLTFMozTextureRGBE {\n  constructor(parser, loader) {\n    this.parser = parser;\n    this.loader = loader;\n    this.name = \"MOZ_texture_rgbe\";\n  }\n\n  loadTexture(textureIndex) {\n    const parser = this.parser;\n    const json = parser.json;\n    const textureDef = json.textures[textureIndex];\n\n    if (!textureDef.extensions || !textureDef.extensions[this.name]) {\n      return null;\n    }\n\n    const extensionDef = textureDef.extensions[this.name];\n    const source = json.images[extensionDef.source];\n    return parser.loadTextureImage(textureIndex, source, this.loader).then(t => {\n      // TODO pretty severe artifacting when using mipmaps, disable for now\n      if (t.minFilter == THREE.NearestMipmapNearestFilter || t.minFilter == THREE.NearestMipmapLinearFilter) {\n        t.minFilter = THREE.NearestFilter;\n      } else if (t.minFilter == THREE.LinearMipmapNearestFilter || t.minFilter == THREE.LinearMipmapLinearFilter) {\n        t.minFilter = THREE.LinearFilter;\n      }\n      return t;\n    });\n  }\n}\n\nexport async function loadGLTF(src, contentType, onProgress, jsonPreprocessor) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType && (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\"))) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n  gltfLoader\n    .register(parser => new GLTFHubsComponentsExtension(parser))\n    .register(parser => new GLTFHubsPlugin(parser, jsonPreprocessor))\n    .register(parser => new GLTFHubsLightMapExtension(parser))\n    .register(parser => new GLTFHubsTextureBasisExtension(parser))\n    .register(parser => new GLTFMozTextureRGBE(parser, new RGBELoader().setDataType(THREE.HalfFloatType)));\n\n  // TODO some models are loaded before the renderer exists. This is likely things like the camera tool and loading cube.\n  // They don't currently use KTX textures but if they did this would be an issue. Fixing this is hard but is part of\n  // \"taking control of the render loop\" which is something we want to tackle for many reasons.\n  if (!ktxLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    ktxLoader = new KTX2Loader(loadingManager).detectSupport(AFRAME.scenes[0].renderer);\n  }\n  if (!dracoLoader && AFRAME && AFRAME.scenes && AFRAME.scenes[0]) {\n    dracoLoader = new DRACOLoader(loadingManager);\n  }\n\n  if (ktxLoader) {\n    gltfLoader.setKTX2Loader(ktxLoader);\n  }\n  if (dracoLoader) {\n    gltfLoader.setDRACOLoader(dracoLoader);\n  }\n\n  return new Promise((resolve, reject) => {\n    gltfLoader.load(gltfUrl, resolve, onProgress, reject);\n  }).finally(() => {\n    if (fileMap) {\n      // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n      Object.keys(fileMap).forEach(URL.revokeObjectURL);\n    }\n  });\n}\n\nexport async function loadModel(src, contentType = null, useCache = false, jsonPreprocessor = null) {\n  console.log(`Loading model ${src}`);\n  if (useCache) {\n    if (gltfCache.has(src)) {\n      gltfCache.retain(src);\n      return cloneGltf(gltfCache.get(src).gltf);\n    } else {\n      if (inflightGltfs.has(src)) {\n        const gltf = await inflightGltfs.get(src);\n        gltfCache.retain(src);\n        return cloneGltf(gltf);\n      } else {\n        const promise = loadGLTF(src, contentType, null, jsonPreprocessor);\n        inflightGltfs.set(src, promise);\n        const gltf = await promise;\n        inflightGltfs.delete(src);\n        gltfCache.set(src, gltf);\n        return cloneGltf(gltf);\n      }\n    }\n  } else {\n    return loadGLTF(src, contentType, null, jsonPreprocessor);\n  }\n}\n\nfunction resolveAsset(src) {\n  // If the src attribute is a selector, get the url from the asset item.\n  if (src && src.charAt(0) === \"#\") {\n    const assetEl = document.getElementById(src.substring(1));\n    if (assetEl) {\n      return assetEl.getAttribute(\"src\");\n    }\n  }\n  return src;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * allowed components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    batch: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    // This can be set externally if a consumer wants to do some node preprocssing.\n    this.jsonPreprocessor = null;\n\n    this.loadTemplates();\n  },\n\n  play() {\n    this.el.components[\"listed-media\"] && this.el.sceneEl.emit(\"listed_media_changed\");\n  },\n\n  update() {\n    this.applySrc(resolveAsset(this.data.src), this.data.contentType);\n  },\n\n  remove() {\n    if (this.data.batch && this.model) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);\n    }\n    if (this.data.useCache) {\n      const src = resolveAsset(this.data.src);\n      if (src) {\n        gltfCache.release(src);\n      }\n    }\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      if (src === this.lastSrc) return;\n\n      const lastSrc = this.lastSrc;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await loadModel(src, contentType, this.data.useCache, this.jsonPreprocessor);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene;\n\n      if (this.data.batch) {\n        this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.model);\n      }\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(this.model.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        object3DToSet.visible = false;\n\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        await inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      if (lastSrc && this.data.useCache) {\n        gltfCache.release(lastSrc);\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      object3DToSet.visible = true;\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: object3DToSet });\n    } catch (e) {\n      gltfCache.release(src);\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar-landing\":\"avatar__avatar-landing__3bdoO\",\"avatarLanding\":\"avatar__avatar-landing__3bdoO\",\"form-submit\":\"avatar__form-submit__3OEBN\",\"formSubmit\":\"avatar__form-submit__3OEBN\",\"no-default-button-style\":\"avatar__no-default-button-style__d4suM\",\"noDefaultButtonStyle\":\"avatar__no-default-button-style__d4suM\",\"logo\":\"avatar__logo__35vmn\",\"box\":\"avatar__box__vyKNY\",\"title\":\"avatar__title__PP1dU\",\"selected-message\":\"avatar__selected-message__25S2j\",\"selectedMessage\":\"avatar__selected-message__25S2j\",\"attributions\":\"avatar__attributions__1Ej7c\",\"preview\":\"avatar__preview__3T2SV\",\"copy-tip\":\"avatar__copy-tip__1FaPe\",\"copyTip\":\"avatar__copy-tip__1FaPe\",\"edit-avatar\":\"avatar__edit-avatar__1pMAy\",\"editAvatar\":\"avatar__edit-avatar__1pMAy\"};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar punycode = require('punycode');\nvar util = require('./util');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && util.isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!util.isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  // Copy chrome, IE, opera backslash-handling behavior.\n  // Back slashes before the query string get converted to forward slashes\n  // See: https://code.google.com/p/chromium/issues/detail?id=25916\n  var queryIndex = url.indexOf('?'),\n      splitter =\n          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',\n      uSplit = url.split(splitter),\n      slashRegex = /\\\\/g;\n  uSplit[0] = uSplit[0].replace(slashRegex, '/');\n  url = uSplit.join(splitter);\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.path = rest;\n      this.href = rest;\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n        if (parseQueryString) {\n          this.query = querystring.parse(this.search.substr(1));\n        } else {\n          this.query = this.search.substr(1);\n        }\n      } else if (parseQueryString) {\n        this.search = '';\n        this.query = {};\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a punycoded representation of \"domain\".\n      // It only converts parts of the domain name that\n      // have non-ASCII characters, i.e. it doesn't matter if\n      // you call it with a domain that already is ASCII-only.\n      this.hostname = punycode.toASCII(this.hostname);\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      if (rest.indexOf(ae) === -1)\n        continue;\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (util.isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      util.isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (util.isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  var tkeys = Object.keys(this);\n  for (var tk = 0; tk < tkeys.length; tk++) {\n    var tkey = tkeys[tk];\n    result[tkey] = this[tkey];\n  }\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    var rkeys = Object.keys(relative);\n    for (var rk = 0; rk < rkeys.length; rk++) {\n      var rkey = rkeys[rk];\n      if (rkey !== 'protocol')\n        result[rkey] = relative[rkey];\n    }\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      var keys = Object.keys(relative);\n      for (var v = 0; v < keys.length; v++) {\n        var k = keys[v];\n        result[k] = relative[k];\n      }\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!util.isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especially happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host || srcPath.length > 1) &&\n      (last === '.' || last === '..') || last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last === '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especially happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n","import { hasReticulumServer } from \"./phoenix-utils\";\nimport configs from \"./configs\";\n\nconst nonCorsProxyDomains = (configs.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (configs.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(configs.CORS_PROXY_SERVER.split(\":\")[0]);\n}\nnonCorsProxyDomains.push(document.location.hostname);\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\",\n  basis: \"image/basis\",\n  ktx2: \"image/ktx2\",\n  m3u8: \"application/vnd.apple.mpegurl\",\n  mpd: \"application/dash+xml\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  let extension = \"\";\n  try {\n    const pathParts = new URL(url).pathname.split(\".\");\n\n    if (pathParts.length > 1) {\n      const extensionCandidate = pathParts.pop();\n      if (commonKnownContentTypes[extensionCandidate]) {\n        extension = `.${extensionCandidate}`;\n      }\n    }\n  } catch (e) {\n    extension = \".png\";\n  }\n\n  // HACK: the extension is needed to ensure CDN caching on Cloudflare\n  const thumbnailUrl = `https://${configs.THUMBNAIL_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}${extension}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (hasReticulumServer()) {\n      const retHostname = new URL(`https://${configs.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return thumbnailUrl;\n  }\n\n  return thumbnailUrl;\n};\n\nexport const isNonCorsProxyDomain = hostname => {\n  return nonCorsProxyDomains.find(domain => hostname.endsWith(domain));\n};\n\nexport const proxiedUrlFor = url => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (isNonCorsProxyDomain(parsedUrl.hostname)) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  return `https://${configs.CORS_PROXY_SERVER}/${url}`;\n};\n\nexport function getAbsoluteUrl(baseUrl, relativeUrl) {\n  return new URL(relativeUrl, baseUrl);\n}\n\nexport function getAbsoluteHref(baseUrl, relativeUrl) {\n  return getAbsoluteUrl(baseUrl, relativeUrl).href;\n}\n\n// Note this file is configured in webpack.config.js to be handled with file-loader, so this will be a string containing the file path\nimport basisJsUrl from \"three/examples/js/libs/basis/basis_transcoder.js\";\nimport basisWasmUrl from \"three/examples/js/libs/basis/basis_transcoder.wasm\";\nimport dracoWrapperJsUrl from \"three/examples/js/libs/draco/gltf/draco_wasm_wrapper.js\";\nimport dracoWasmUrl from \"three/examples/js/libs/draco/gltf/draco_decoder.wasm\";\n\nexport const rewriteBasisTranscoderUrls = function(url) {\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  }\n  return url;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  // Intercept loading of basis transcoder with content hashed urls\n  if (url === \"basis_transcoder.js\") {\n    return basisJsUrl;\n  } else if (url === \"basis_transcoder.wasm\") {\n    return basisWasmUrl;\n  } else if (url === \"draco_wasm_wrapper.js\") {\n    return dracoWrapperJsUrl;\n  } else if (url === \"draco_decoder.wasm\") {\n    return dracoWasmUrl;\n  }\n\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return proxiedUrlFor(url);\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (configs.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (!url) return;\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.exec(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nconst originIsHubsServer = new Map();\nasync function isHubsServer(url) {\n  if (!url) return false;\n  if (!url.startsWith(\"http\")) {\n    url = \"https://\" + url;\n  }\n  const { origin } = new URL(url);\n\n  if (originIsHubsServer.has(origin)) {\n    return originIsHubsServer.get(origin);\n  }\n\n  let isHubsServer;\n  try {\n    isHubsServer = (await fetch(proxiedUrlFor(origin), { method: \"HEAD\" })).headers.has(\"hub-name\");\n  } catch (e) {\n    isHubsServer = false;\n  }\n  originIsHubsServer.set(origin, isHubsServer);\n  return isHubsServer;\n}\n\nconst hubsSceneRegex = /https?:\\/\\/[^/]+\\/scenes\\/[a-zA-Z0-9]{7}(?:\\/|$)/;\nconst hubsAvatarRegex = /https?:\\/\\/[^/]+\\/avatars\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\nconst hubsRoomRegex = /(https?:\\/\\/)?[^/]+\\/(?<id>[a-zA-Z0-9]{7})(?:\\/|$)/;\n\nexport const isLocalHubsUrl = async url =>\n  (await isHubsServer(url)) && new URL(url).origin === document.location.origin;\n\nexport const isHubsSceneUrl = async url => (await isHubsServer(url)) && hubsSceneRegex.test(url);\nexport const isLocalHubsSceneUrl = async url => (await isHubsSceneUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsAvatarUrl = async url => (await isHubsServer(url)) && hubsAvatarRegex.test(url);\nexport const isLocalHubsAvatarUrl = async url => (await isHubsAvatarUrl(url)) && (await isLocalHubsUrl(url));\n\nexport const isHubsRoomUrl = async url =>\n  (await isHubsServer(url)) &&\n  !(await isHubsAvatarUrl(url)) &&\n  !(await isHubsSceneUrl(url)) &&\n  url.match(hubsRoomRegex)?.groups.id;\n\nexport const isHubsDestinationUrl = async url =>\n  (await isHubsServer(url)) && ((await isHubsSceneUrl(url)) || (await isHubsRoomUrl(url)));\n\nexport const idForAvatarUrl = url => {\n  const match = url.match(hubsAvatarRegex);\n  if (match) {\n    return match.groups.id;\n  }\n  return null;\n};\n","// Primary language tags for those languages we support\nexport const AVAILABLE_LOCALES = {\n  en: \"English\",\n  \"zh-cn\": \"\",\n  pt: \"Portugs (Brasil)\",\n  ja: \"\",\n  es: \"Espaol\",\n  ru: \"P\",\n  fr: \"Franais\",\n  ko: \"\",\n  de: \"Deutsch\",\n  \"zh-tw\": \"\"\n};\n\n// Map from alternative primary language tags to those we support\nexport const FALLBACK_LOCALES = {\n  jp: \"ja\"\n};\n","import { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\n\nlet config = process.env.APP_CONFIG;\n\n// Storybook includes environment variables as a string\n// https://storybook.js.org/docs/react/configure/environment-variables\nif (!config && process.env.STORYBOOK_APP_CONFIG) {\n  config = JSON.parse(process.env.STORYBOOK_APP_CONFIG);\n}\n\nif (!config) {\n  config = window.APP_CONFIG;\n}\n\nif (config?.theme?.error) {\n  console.error(\n    `Custom themes failed to load.\\n${\n      config.theme.error\n    }\\nIf you are an admin, reconfigure your themes in the admin panel.`\n  );\n}\n\nexport const defaultTheme = \"default\";\n\nexport const themes = config?.theme?.themes || [];\n\nfunction useDarkMode() {\n  const [darkMode, setDarkMode] = useState(false);\n\n  useEffect(() => {\n    const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n\n    setDarkMode(darkmodeQuery.matches);\n\n    // This is a workaround for old Safari.\n    // Prior to Safari 14, MediaQueryList is based on EventTarget, so you must use\n    // addListener() and removeListener() to observe media query lists.\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/addListener\n    // We may remove this workaround when no one will use Safari 13 or before.\n    if (darkmodeQuery.addEventListener) {\n      darkmodeQuery.addEventListener(\"change\", event => {\n        setDarkMode(event.matches);\n      });\n    } else {\n      darkmodeQuery.addListener(event => {\n        setDarkMode(event.matches);\n      });\n    }\n  }, []);\n\n  return darkMode;\n}\n\nexport function useTheme(themeId) {\n  const darkMode = useDarkMode();\n\n  useEffect(\n    () => {\n      // Themes can come from an external source. Ensure it is an array.\n      if (!Array.isArray(themes)) return;\n\n      let theme;\n\n      if (themeId) {\n        theme = themes.find(t => t.id === themeId);\n      }\n\n      if (!theme && darkMode) {\n        theme = themes.find(t => t.darkModeDefault);\n      }\n\n      if (!theme) {\n        theme = themes.find(t => t.default);\n      }\n\n      if (!theme) {\n        return;\n      }\n\n      const variables = [];\n\n      for (const key in theme.variables) {\n        if (!theme.variables.hasOwnProperty(key)) continue;\n        variables.push(`--${key}: ${theme.variables[key]};`);\n      }\n\n      const styleTag = document.createElement(\"style\");\n\n      styleTag.innerHTML = `:root {\n        ${variables.join(\"\\n\")}\n      }`;\n\n      document.head.appendChild(styleTag);\n\n      return () => {\n        document.head.removeChild(styleTag);\n      };\n    },\n    [themeId, darkMode]\n  );\n}\n\nexport function useThemeFromStore(store) {\n  const [themeId, setThemeId] = useState(store?.state?.preferences?.theme);\n\n  useEffect(() => {\n    function onStoreChanged() {\n      const nextThemeId = store.state?.preferences?.theme;\n\n      if (themeId !== nextThemeId) {\n        setThemeId(nextThemeId);\n      }\n    }\n\n    if (store) {\n      store.addEventListener(\"statechanged\", onStoreChanged);\n    }\n\n    return () => {\n      if (store) {\n        store.removeEventListener(\"statechanged\", onStoreChanged);\n      }\n    };\n  });\n\n  useTheme(themeId);\n}\n\nexport function ThemeProvider({ store, children }) {\n  useThemeFromStore(store);\n  return children;\n}\n\nThemeProvider.propTypes = {\n  store: PropTypes.object,\n  children: PropTypes.node\n};\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer, args = {}) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage(Object.assign(args, { id, payload: data }), transfer);\n    return promise;\n  };\n}\n","import { EventTarget } from \"event-target-shim\";\nimport configs from \"../utils/configs\";\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated, hasReticulumServer } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\n\nconst EMPTY_RESULT = { entries: [], meta: {} };\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  twitch: \"twitch\",\n  favorites: \"favorites\"\n};\n\nconst desiredSources = [\"sketchfab\", \"videos\", \"scenes\", \"avatars\", \"gifs\", \"images\"];\nconst availableSources = desiredSources.filter(source => {\n  const apiSource = URL_SOURCE_TO_TO_API_SOURCE[source];\n  return configs.integration(apiSource);\n});\nexport const SOURCES = availableSources;\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\",\n  favorites: \"my-favorites\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\", \"similar_to\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n    const locationSearchParams = new URLSearchParams(location.search);\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      source = isMy ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    let fetch = true;\n\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\n      if (isMy) {\n        if (window.APP.store.credentialsAccountId) {\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n        } else {\n          fetch = false; // Don't fetch my-* if not signed in\n        }\n      }\n    }\n\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\n    const url = getReticulumFetchUrl(path);\n    if (this.lastSavedUrl === url) return;\n\n    this.isFetching = true;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.isFetching = false;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav, keepSelectAction) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n    searchParams.delete(\"similar_to\");\n    searchParams.delete(\"similar_name\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    if (!keepSelectAction) {\n      searchParams.delete(\"selectAction\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n\n    this._stashedParams = {};\n    this._stashedSource = null;\n\n    const source = this.getUrlMediaSource(location);\n\n    // HACK for now do not stash favorite search, since that ends up being a source\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\n    // proper favorites browser. Then, we should have two separate stashes.\n    if (source === \"favorites\") return;\n    this._stashedSource = source;\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = (source, selectAction) => {\n    this._sourceNavigate(source, true, false, selectAction);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams, selectAction) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (selectAction) {\n      searchParams.set(\"selectAction\", selectAction);\n    }\n\n    if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","import { isIOS as detectIOS } from \"./is-mobile\";\nconst isIOS = detectIOS();\n\n// TODO should we be using touch-action CSS for this?\nexport function disableiOSZoom() {\n  if (!isIOS) return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","\r\nexport default\r\nclass MeshBVHNode {\r\n\r\n\tconstructor() {\r\n\r\n\t\t// internal nodes have boundingData, left, right, and splitAxis\r\n\t\t// leaf nodes have offset and count (referring to primitives in the mesh geometry)\r\n\r\n\t}\r\n\r\n}\r\n","// Returns a Float32Array representing the bounds data for box.\r\nexport function boxToArray( bx ) {\r\n\r\n\tconst arr = new Float32Array( 6 );\r\n\r\n\tarr[ 0 ] = bx.min.x;\r\n\tarr[ 1 ] = bx.min.y;\r\n\tarr[ 2 ] = bx.min.z;\r\n\r\n\tarr[ 3 ] = bx.max.x;\r\n\tarr[ 4 ] = bx.max.y;\r\n\tarr[ 5 ] = bx.max.z;\r\n\r\n\treturn arr;\r\n\r\n}\r\n\r\nexport function arrayToBox( arr, target ) {\r\n\r\n\ttarget.min.x = arr[ 0 ];\r\n\ttarget.min.y = arr[ 1 ];\r\n\ttarget.min.z = arr[ 2 ];\r\n\r\n\ttarget.max.x = arr[ 3 ];\r\n\ttarget.max.y = arr[ 4 ];\r\n\ttarget.max.z = arr[ 5 ];\r\n\r\n\treturn target;\r\n\r\n}\r\n\r\nexport function getLongestEdgeIndex( bounds ) {\r\n\r\n\tlet splitDimIdx = - 1;\r\n\tlet splitDist = - Infinity;\r\n\r\n\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\tconst dist = bounds[ i + 3 ] - bounds[ i ];\r\n\t\tif ( dist > splitDist ) {\r\n\r\n\t\t\tsplitDist = dist;\r\n\t\t\tsplitDimIdx = i;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn splitDimIdx;\r\n\r\n}\r\n","import { Box3, BufferAttribute } from 'three';\r\nimport MeshBVHNode from './MeshBVHNode.js';\r\nimport { arrayToBox, boxToArray, getLongestEdgeIndex } from './Utils/ArrayBoxUtilities.js';\r\nimport { CENTER, AVERAGE, SAH } from './Constants.js';\r\n\r\n// https://en.wikipedia.org/wiki/Machine_epsilon#Values_for_standard_hardware_floating_point_arithmetics\r\nconst FLOAT32_EPSILON = Math.pow( 2, - 24 );\r\nconst xyzFields = [ 'x', 'y', 'z' ];\r\nconst boxTemp = new Box3();\r\n\r\nfunction ensureIndex( geo ) {\r\n\r\n\tif ( ! geo.index ) {\r\n\r\n\t\tconst vertexCount = geo.attributes.position.count;\r\n\t\tconst index = new ( vertexCount > 65535 ? Uint32Array : Uint16Array )( vertexCount );\r\n\t\tgeo.setIndex( new BufferAttribute( index, 1 ) );\r\n\r\n\t\tfor ( let i = 0; i < vertexCount; i ++ ) {\r\n\r\n\t\t\tindex[ i ] = i;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n// Computes the set of { offset, count } ranges which need independent BVH roots. Each\r\n// region in the geometry index that belongs to a different set of material groups requires\r\n// a separate BVH root, so that triangles indices belonging to one group never get swapped\r\n// with triangle indices belongs to another group. For example, if the groups were like this:\r\n//\r\n// [-------------------------------------------------------------]\r\n// |__________________|\r\n//   g0 = [0, 20]  |______________________||_____________________|\r\n//                      g1 = [16, 40]           g2 = [41, 60]\r\n//\r\n// we would need four BVH roots: [0, 15], [16, 20], [21, 40], [41, 60].\r\nfunction getRootIndexRanges( geo ) {\r\n\r\n\tif ( ! geo.groups || ! geo.groups.length ) {\r\n\r\n\t\treturn [ { offset: 0, count: geo.index.count / 3 } ];\r\n\r\n\t}\r\n\r\n\tconst ranges = [];\r\n\tconst rangeBoundaries = new Set();\r\n\tfor ( const group of geo.groups ) {\r\n\r\n\t\trangeBoundaries.add( group.start );\r\n\t\trangeBoundaries.add( group.start + group.count );\r\n\r\n\t}\r\n\r\n\t// note that if you don't pass in a comparator, it sorts them lexicographically as strings :-(\r\n\tconst sortedBoundaries = Array.from( rangeBoundaries.values() ).sort( ( a, b ) => a - b );\r\n\tfor ( let i = 0; i < sortedBoundaries.length - 1; i ++ ) {\r\n\r\n\t\tconst start = sortedBoundaries[ i ], end = sortedBoundaries[ i + 1 ];\r\n\t\tranges.push( { offset: ( start / 3 ), count: ( end - start ) / 3 } );\r\n\r\n\t}\r\n\r\n\treturn ranges;\r\n\r\n}\r\n\r\n// computes the union of the bounds of all of the given triangles and puts the resulting box in target. If\r\n// centroidTarget is provided then a bounding box is computed for the centroids of the triangles, as well.\r\n// These are computed together to avoid redundant accesses to bounds array.\r\nfunction getBounds( triangleBounds, offset, count, target, centroidTarget = null ) {\r\n\r\n\tlet minx = Infinity;\r\n\tlet miny = Infinity;\r\n\tlet minz = Infinity;\r\n\tlet maxx = - Infinity;\r\n\tlet maxy = - Infinity;\r\n\tlet maxz = - Infinity;\r\n\r\n\tlet cminx = Infinity;\r\n\tlet cminy = Infinity;\r\n\tlet cminz = Infinity;\r\n\tlet cmaxx = - Infinity;\r\n\tlet cmaxy = - Infinity;\r\n\tlet cmaxz = - Infinity;\r\n\r\n\tconst includeCentroid = centroidTarget !== null;\r\n\tfor ( let i = offset * 6, end = ( offset + count ) * 6; i < end; i += 6 ) {\r\n\r\n\t\tconst cx = triangleBounds[ i + 0 ];\r\n\t\tconst hx = triangleBounds[ i + 1 ];\r\n\t\tconst lx = cx - hx;\r\n\t\tconst rx = cx + hx;\r\n\t\tif ( lx < minx ) minx = lx;\r\n\t\tif ( rx > maxx ) maxx = rx;\r\n\t\tif ( includeCentroid && cx < cminx ) cminx = cx;\r\n\t\tif ( includeCentroid && cx > cmaxx ) cmaxx = cx;\r\n\r\n\t\tconst cy = triangleBounds[ i + 2 ];\r\n\t\tconst hy = triangleBounds[ i + 3 ];\r\n\t\tconst ly = cy - hy;\r\n\t\tconst ry = cy + hy;\r\n\t\tif ( ly < miny ) miny = ly;\r\n\t\tif ( ry > maxy ) maxy = ry;\r\n\t\tif ( includeCentroid && cy < cminy ) cminy = cy;\r\n\t\tif ( includeCentroid && cy > cmaxy ) cmaxy = cy;\r\n\r\n\t\tconst cz = triangleBounds[ i + 4 ];\r\n\t\tconst hz = triangleBounds[ i + 5 ];\r\n\t\tconst lz = cz - hz;\r\n\t\tconst rz = cz + hz;\r\n\t\tif ( lz < minz ) minz = lz;\r\n\t\tif ( rz > maxz ) maxz = rz;\r\n\t\tif ( includeCentroid && cz < cminz ) cminz = cz;\r\n\t\tif ( includeCentroid && cz > cmaxz ) cmaxz = cz;\r\n\r\n\t}\r\n\r\n\ttarget[ 0 ] = minx;\r\n\ttarget[ 1 ] = miny;\r\n\ttarget[ 2 ] = minz;\r\n\r\n\ttarget[ 3 ] = maxx;\r\n\ttarget[ 4 ] = maxy;\r\n\ttarget[ 5 ] = maxz;\r\n\r\n\tif ( includeCentroid ) {\r\n\r\n\t\tcentroidTarget[ 0 ] = cminx;\r\n\t\tcentroidTarget[ 1 ] = cminy;\r\n\t\tcentroidTarget[ 2 ] = cminz;\r\n\r\n\t\tcentroidTarget[ 3 ] = cmaxx;\r\n\t\tcentroidTarget[ 4 ] = cmaxy;\r\n\t\tcentroidTarget[ 5 ] = cmaxz;\r\n\r\n\t}\r\n\r\n}\r\n\r\n// A stand alone function for retrieving the centroid bounds.\r\nfunction getCentroidBounds( triangleBounds, offset, count, centroidTarget ) {\r\n\r\n\tlet cminx = Infinity;\r\n\tlet cminy = Infinity;\r\n\tlet cminz = Infinity;\r\n\tlet cmaxx = - Infinity;\r\n\tlet cmaxy = - Infinity;\r\n\tlet cmaxz = - Infinity;\r\n\r\n\tfor ( let i = offset * 6, end = ( offset + count ) * 6; i < end; i += 6 ) {\r\n\r\n\t\tconst cx = triangleBounds[ i + 0 ];\r\n\t\tif ( cx < cminx ) cminx = cx;\r\n\t\tif ( cx > cmaxx ) cmaxx = cx;\r\n\r\n\t\tconst cy = triangleBounds[ i + 2 ];\r\n\t\tif ( cy < cminy ) cminy = cy;\r\n\t\tif ( cy > cmaxy ) cmaxy = cy;\r\n\r\n\t\tconst cz = triangleBounds[ i + 4 ];\r\n\t\tif ( cz < cminz ) cminz = cz;\r\n\t\tif ( cz > cmaxz ) cmaxz = cz;\r\n\r\n\t}\r\n\r\n\tcentroidTarget[ 0 ] = cminx;\r\n\tcentroidTarget[ 1 ] = cminy;\r\n\tcentroidTarget[ 2 ] = cminz;\r\n\r\n\tcentroidTarget[ 3 ] = cmaxx;\r\n\tcentroidTarget[ 4 ] = cmaxy;\r\n\tcentroidTarget[ 5 ] = cmaxz;\r\n\r\n}\r\n\r\n\r\n// reorders `tris` such that for `count` elements after `offset`, elements on the left side of the split\r\n// will be on the left and elements on the right side of the split will be on the right. returns the index\r\n// of the first element on the right side, or offset + count if there are no elements on the right side.\r\nfunction partition( index, triangleBounds, sahPlanes, offset, count, split ) {\r\n\r\n\tlet left = offset;\r\n\tlet right = offset + count - 1;\r\n\tconst pos = split.pos;\r\n\tconst axisOffset = split.axis * 2;\r\n\r\n\t// hoare partitioning, see e.g. https://en.wikipedia.org/wiki/Quicksort#Hoare_partition_scheme\r\n\twhile ( true ) {\r\n\r\n\t\twhile ( left <= right && triangleBounds[ left * 6 + axisOffset ] < pos ) {\r\n\r\n\t\t\tleft ++;\r\n\r\n\t\t}\r\n\r\n\t\twhile ( left <= right && triangleBounds[ right * 6 + axisOffset ] >= pos ) {\r\n\r\n\t\t\tright --;\r\n\r\n\t\t}\r\n\r\n\t\tif ( left < right ) {\r\n\r\n\t\t\t// we need to swap all of the information associated with the triangles at index\r\n\t\t\t// left and right; that's the verts in the geometry index, the bounds,\r\n\t\t\t// and perhaps the SAH planes\r\n\r\n\t\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\tlet t0 = index[ left * 3 + i ];\r\n\t\t\t\tindex[ left * 3 + i ] = index[ right * 3 + i ];\r\n\t\t\t\tindex[ right * 3 + i ] = t0;\r\n\r\n\t\t\t\tlet t1 = triangleBounds[ left * 6 + i * 2 + 0 ];\r\n\t\t\t\ttriangleBounds[ left * 6 + i * 2 + 0 ] = triangleBounds[ right * 6 + i * 2 + 0 ];\r\n\t\t\t\ttriangleBounds[ right * 6 + i * 2 + 0 ] = t1;\r\n\r\n\t\t\t\tlet t2 = triangleBounds[ left * 6 + i * 2 + 1 ];\r\n\t\t\t\ttriangleBounds[ left * 6 + i * 2 + 1 ] = triangleBounds[ right * 6 + i * 2 + 1 ];\r\n\t\t\t\ttriangleBounds[ right * 6 + i * 2 + 1 ] = t2;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( sahPlanes ) {\r\n\r\n\t\t\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t\t\tlet t = sahPlanes[ i ][ left ];\r\n\t\t\t\t\tsahPlanes[ i ][ left ] = sahPlanes[ i ][ right ];\r\n\t\t\t\t\tsahPlanes[ i ][ right ] = t;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tleft ++;\r\n\t\t\tright --;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn left;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction getOptimalSplit( nodeBoundingData, centroidBoundingData, triangleBounds, sahPlanes, offset, count, strategy ) {\r\n\r\n\tlet axis = - 1;\r\n\tlet pos = 0;\r\n\r\n\t// Center\r\n\tif ( strategy === CENTER ) {\r\n\r\n\t\taxis = getLongestEdgeIndex( centroidBoundingData );\r\n\t\tif ( axis !== - 1 ) {\r\n\r\n\t\t\tpos = ( centroidBoundingData[ axis ] + centroidBoundingData[ axis + 3 ] ) / 2;\r\n\r\n\t\t}\r\n\r\n\t} else if ( strategy === AVERAGE ) {\r\n\r\n\t\taxis = getLongestEdgeIndex( nodeBoundingData );\r\n\t\tif ( axis !== - 1 ) {\r\n\r\n\t\t\tpos = getAverage( triangleBounds, offset, count, axis );\r\n\r\n\t\t}\r\n\r\n\t} else if ( strategy === SAH ) {\r\n\r\n\t\t// Surface Area Heuristic\r\n\t\t// In order to make this code more terse, the x, y, and z\r\n\t\t// variables of various structures have been stuffed into\r\n\t\t// 0, 1, and 2 array indices so they can be easily computed\r\n\t\t// and accessed within array iteration\r\n\r\n\t\t// Cost values defineed for operations. We're using bounds for traversal, so\r\n\t\t// the cost of traversing one more layer is more than intersecting a triangle.\r\n\t\tconst TRAVERSAL_COST = 3;\r\n\t\tconst INTERSECTION_COST = 1;\r\n\t\tconst bb = arrayToBox( nodeBoundingData, boxTemp );\r\n\r\n\t\t// Define the width, height, and depth of the bounds as a box\r\n\t\tconst dim = [\r\n\t\t\tbb.max.x - bb.min.x,\r\n\t\t\tbb.max.y - bb.min.y,\r\n\t\t\tbb.max.z - bb.min.z\r\n\t\t];\r\n\t\tconst sa = 2 * ( dim[ 0 ] * dim[ 1 ] + dim[ 0 ] * dim[ 2 ] + dim[ 1 ] * dim[ 2 ] );\r\n\r\n\t\t// Get the precalculated planes based for the triangles we're\r\n\t\t// testing here\r\n\t\tconst filteredLists = [[], [], []];\r\n\t\tfor ( let i = offset, end = offset + count; i < end; i ++ ) {\r\n\r\n\t\t\tfor ( let v = 0; v < 3; v ++ ) {\r\n\r\n\t\t\t\tfilteredLists[ v ].push( sahPlanes[ v ][ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfilteredLists.forEach( planes => planes.sort( ( a, b ) => a.p - b.p ) );\r\n\r\n\t\t// this bounds surface area, left bound SA, left triangles, right bound SA, right triangles\r\n\t\tconst getCost = ( sa, sal, nl, sar, nr ) =>\r\n\t\t\t  TRAVERSAL_COST + INTERSECTION_COST * ( ( sal / sa ) * nl + ( sar / sa ) * nr );\r\n\r\n\t\t// the cost of _not_ splitting into smaller bounds\r\n\t\tconst noSplitCost = INTERSECTION_COST * count;\r\n\r\n\t\taxis = - 1;\r\n\t\tlet bestCost = noSplitCost;\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\t// o1 and o2 represent the _other_ two axes in the\r\n\t\t\t// the space. So if we're checking the x (0) dimension,\r\n\t\t\t// then o1 and o2 would be y and z (1 and 2)\r\n\t\t\tconst o1 = ( i + 1 ) % 3;\r\n\t\t\tconst o2 = ( i + 2 ) % 3;\r\n\r\n\t\t\tconst bmin = bb.min[ xyzFields[ i ] ];\r\n\t\t\tconst bmax = bb.max[ xyzFields[ i ] ];\r\n\t\t\tconst planes = filteredLists[ i ];\r\n\r\n\t\t\t// The number of left and right triangles on either side\r\n\t\t\t// given the current split\r\n\t\t\tlet nl = 0;\r\n\t\t\tlet nr = count;\r\n\t\t\tfor ( let p = 0; p < planes.length; p ++ ) {\r\n\r\n\t\t\t\tconst pinfo = planes[ p ];\r\n\r\n\t\t\t\t// As the plane moves, we have to increment or decrement the\r\n\t\t\t\t// number of triangles on either side of the plane\r\n\t\t\t\tnl ++;\r\n\t\t\t\tnr --;\r\n\r\n\t\t\t\t// the distance from the plane to the edge of the broader bounds\r\n\t\t\t\tconst ldim = pinfo.p - bmin;\r\n\t\t\t\tconst rdim = bmax - pinfo.p;\r\n\r\n\t\t\t\t// same for the other two dimensions\r\n\t\t\t\tlet ldimo1 = dim[ o1 ], rdimo1 = dim[ o1 ];\r\n\t\t\t\tlet ldimo2 = dim[ o2 ], rdimo2 = dim[ o2 ];\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t// compute the other bounding planes for the box\r\n\t\t\t\t// if only the current triangles are considered to\r\n\t\t\t\t// be in the box\r\n\t\t\t\t// This is really slow and probably not really worth it\r\n\t\t\t\tconst o1planes = sahPlanes[o1];\r\n\t\t\t\tconst o2planes = sahPlanes[o2];\r\n\t\t\t\tlet lmin = Infinity, lmax = -Infinity;\r\n\t\t\t\tlet rmin = Infinity, rmax = -Infinity;\r\n\t\t\t\tplanes.forEach((p, i) => {\r\n\t\t\t\tconst tri2 = p.tri * 2;\r\n\t\t\t\tconst inf1 = o1planes[tri2 + 0];\r\n\t\t\t\tconst inf2 = o1planes[tri2 + 1];\r\n\t\t\t\tif (i <= nl) {\r\n\t\t\t\tlmin = Math.min(inf1.p, inf2.p, lmin);\r\n\t\t\t\tlmax = Math.max(inf1.p, inf2.p, lmax);\r\n\t\t\t\t}\r\n\t\t\t\tif (i >= nr) {\r\n\t\t\t\trmin = Math.min(inf1.p, inf2.p, rmin);\r\n\t\t\t\trmax = Math.max(inf1.p, inf2.p, rmax);\r\n\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tldimo1 = Math.min(lmax - lmin, ldimo1);\r\n\t\t\t\trdimo1 = Math.min(rmax - rmin, rdimo1);\r\n\r\n\t\t\t\tplanes.forEach((p, i) => {\r\n\t\t\t\tconst tri2 = p.tri * 2;\r\n\t\t\t\tconst inf1 = o2planes[tri2 + 0];\r\n\t\t\t\tconst inf2 = o2planes[tri2 + 1];\r\n\t\t\t\tif (i <= nl) {\r\n\t\t\t\tlmin = Math.min(inf1.p, inf2.p, lmin);\r\n\t\t\t\tlmax = Math.max(inf1.p, inf2.p, lmax);\r\n\t\t\t\t}\r\n\t\t\t\tif (i >= nr) {\r\n\t\t\t\trmin = Math.min(inf1.p, inf2.p, rmin);\r\n\t\t\t\trmax = Math.max(inf1.p, inf2.p, rmax);\r\n\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tldimo2 = Math.min(lmax - lmin, ldimo2);\r\n\t\t\t\trdimo2 = Math.min(rmax - rmin, rdimo2);\r\n\t\t\t\t*/\r\n\r\n\t\t\t\t// surface areas and cost\r\n\t\t\t\tconst sal = 2 * ( ldimo1 * ldimo2 + ldimo1 * ldim + ldimo2 * ldim );\r\n\t\t\t\tconst sar = 2 * ( rdimo1 * rdimo2 + rdimo1 * rdim + rdimo2 * rdim );\r\n\t\t\t\tconst cost = getCost( sa, sal, nl, sar, nr );\r\n\r\n\t\t\t\tif ( cost < bestCost ) {\r\n\r\n\t\t\t\t\taxis = i;\r\n\t\t\t\t\tpos = pinfo.p;\r\n\t\t\t\t\tbestCost = cost;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn { axis, pos };\r\n\r\n}\r\n\r\n// returns the average coordinate on the specified axis of the all the provided triangles\r\nfunction getAverage( triangleBounds, offset, count, axis ) {\r\n\r\n\tlet avg = 0;\r\n\tfor ( let i = offset, end = offset + count; i < end; i ++ ) {\r\n\r\n\t\tavg += triangleBounds[ i * 6 + axis * 2 ];\r\n\r\n\t}\r\n\r\n\treturn avg / count;\r\n\r\n}\r\n\r\nfunction computeSAHPlanes( triangleBounds ) {\r\n\r\n\tconst triCount = triangleBounds.length / 6;\r\n\tconst sahPlanes = [ new Array( triCount ), new Array( triCount ), new Array( triCount ) ];\r\n\tfor ( let tri = 0; tri < triCount; tri ++ ) {\r\n\r\n\t\tfor ( let el = 0; el < 3; el ++ ) {\r\n\r\n\t\t\tsahPlanes[ el ][ tri ] = { p: triangleBounds[ tri * 6 + el * 2 ], tri };\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn sahPlanes;\r\n\r\n}\r\n\r\n// precomputes the bounding box for each triangle; required for quickly calculating tree splits.\r\n// result is an array of size tris.length * 6 where triangle i maps to a\r\n// [x_center, x_delta, y_center, y_delta, z_center, z_delta] tuple starting at index i * 6,\r\n// representing the center and half-extent in each dimension of triangle i\r\nfunction computeTriangleBounds( geo ) {\r\n\r\n\tconst verts = geo.attributes.position.array;\r\n\tconst index = geo.index.array;\r\n\tconst triCount = index.length / 3;\r\n\tconst triangleBounds = new Float32Array( triCount * 6 );\r\n\r\n\tfor ( let tri = 0; tri < triCount; tri ++ ) {\r\n\r\n\t\tconst tri3 = tri * 3;\r\n\t\tconst tri6 = tri * 6;\r\n\t\tconst ai = index[ tri3 + 0 ] * 3;\r\n\t\tconst bi = index[ tri3 + 1 ] * 3;\r\n\t\tconst ci = index[ tri3 + 2 ] * 3;\r\n\r\n\t\tfor ( let el = 0; el < 3; el ++ ) {\r\n\r\n\t\t\tconst a = verts[ ai + el ];\r\n\t\t\tconst b = verts[ bi + el ];\r\n\t\t\tconst c = verts[ ci + el ];\r\n\r\n\t\t\tlet min = a;\r\n\t\t\tif ( b < min ) min = b;\r\n\t\t\tif ( c < min ) min = c;\r\n\r\n\t\t\tlet max = a;\r\n\t\t\tif ( b > max ) max = b;\r\n\t\t\tif ( c > max ) max = c;\r\n\r\n\t\t\t// Increase the bounds size by float32 epsilon to avoid precision errors when\r\n\t\t\t// converting to 32 bit float. Scale the epsilon by the size of the numbers being\r\n\t\t\t// worked with.\r\n\t\t\tconst halfExtents = ( max - min ) / 2;\r\n\t\t\tconst el2 = el * 2;\r\n\t\t\ttriangleBounds[ tri6 + el2 + 0 ] = min + halfExtents;\r\n\t\t\ttriangleBounds[ tri6 + el2 + 1 ] = halfExtents + ( Math.abs( min ) + halfExtents ) * FLOAT32_EPSILON;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn triangleBounds;\r\n\r\n}\r\n\r\nexport function buildTree( geo, options ) {\r\n\r\n\t// either recursively splits the given node, creating left and right subtrees for it, or makes it a leaf node,\r\n\t// recording the offset and count of its triangles and writing them into the reordered geometry index.\r\n\tfunction splitNode( node, offset, count, centroidBoundingData = null, depth = 0 ) {\r\n\r\n\t\tif ( ! reachedMaxDepth && depth >= maxDepth ) {\r\n\r\n\t\t\treachedMaxDepth = true;\r\n\t\t\tif ( verbose ) {\r\n\r\n\t\t\t\tconsole.warn( `MeshBVH: Max depth of ${ maxDepth } reached when generating BVH. Consider increasing maxDepth.` );\r\n\t\t\t\tconsole.warn( this, geo );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// early out if we've met our capacity\r\n\t\tif ( count <= maxLeafTris || depth >= maxDepth ) {\r\n\r\n\t\t\tnode.offset = offset;\r\n\t\t\tnode.count = count;\r\n\t\t\treturn node;\r\n\r\n\t\t}\r\n\r\n\t\t// Find where to split the volume\r\n\t\tconst split = getOptimalSplit( node.boundingData, centroidBoundingData, triangleBounds, sahPlanes, offset, count, strategy );\r\n\t\tif ( split.axis === - 1 ) {\r\n\r\n\t\t\tnode.offset = offset;\r\n\t\t\tnode.count = count;\r\n\t\t\treturn node;\r\n\r\n\t\t}\r\n\r\n\t\tconst splitOffset = partition( indexArray, triangleBounds, sahPlanes, offset, count, split );\r\n\r\n\t\t// create the two new child nodes\r\n\t\tif ( splitOffset === offset || splitOffset === offset + count ) {\r\n\r\n\t\t\tnode.offset = offset;\r\n\t\t\tnode.count = count;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tnode.splitAxis = split.axis;\r\n\r\n\t\t\t// create the left child and compute its bounding box\r\n\t\t\tconst left = new MeshBVHNode();\r\n\t\t\tconst lstart = offset;\r\n\t\t\tconst lcount = splitOffset - offset;\r\n\t\t\tnode.left = left;\r\n\t\t\tleft.boundingData = new Float32Array( 6 );\r\n\r\n\t\t\tif ( lazyGeneration ) {\r\n\r\n\t\t\t\tgetBounds( triangleBounds, lstart, lcount, left.boundingData );\r\n\t\t\t\tleft.continueGeneration = function () {\r\n\r\n\t\t\t\t\tdelete this.continueGeneration;\r\n\t\t\t\t\tgetCentroidBounds( triangleBounds, lstart, lcount, cacheCentroidBoundingData );\r\n\t\t\t\t\tsplitNode( left, lstart, lcount, cacheCentroidBoundingData, depth + 1 );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgetBounds( triangleBounds, lstart, lcount, left.boundingData, cacheCentroidBoundingData );\r\n\t\t\t\tsplitNode( left, lstart, lcount, cacheCentroidBoundingData, depth + 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// repeat for right\r\n\t\t\tconst right = new MeshBVHNode();\r\n\t\t\tconst rstart = splitOffset;\r\n\t\t\tconst rcount = count - lcount;\r\n\t\t\tnode.right = right;\r\n\t\t\tright.boundingData = new Float32Array( 6 );\r\n\r\n\t\t\tif ( lazyGeneration ) {\r\n\r\n\t\t\t\tgetBounds( triangleBounds, rstart, rcount, right.boundingData );\r\n\t\t\t\tright.continueGeneration = function () {\r\n\r\n\t\t\t\t\tdelete this.continueGeneration;\r\n\t\t\t\t\tgetCentroidBounds( triangleBounds, rstart, rcount, cacheCentroidBoundingData );\r\n\t\t\t\t\tsplitNode( right, rstart, rcount, cacheCentroidBoundingData, depth + 1 );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tgetBounds( triangleBounds, rstart, rcount, right.boundingData, cacheCentroidBoundingData );\r\n\t\t\t\tsplitNode( right, rstart, rcount, cacheCentroidBoundingData, depth + 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn node;\r\n\r\n\t}\r\n\r\n\tensureIndex( geo );\r\n\r\n\tconst cacheCentroidBoundingData = new Float32Array( 6 );\r\n\tconst triangleBounds = computeTriangleBounds( geo );\r\n\tconst sahPlanes = options.strategy === SAH ? computeSAHPlanes( triangleBounds ) : null;\r\n\tconst indexArray = geo.index.array;\r\n\tconst maxDepth = options.maxDepth;\r\n\tconst verbose = options.verbose;\r\n\tconst maxLeafTris = options.maxLeafTris;\r\n\tconst strategy = options.strategy;\r\n\tconst lazyGeneration = options.lazyGeneration;\r\n\tlet reachedMaxDepth = false;\r\n\r\n\tconst roots = [];\r\n\tconst ranges = getRootIndexRanges( geo );\r\n\r\n\tif ( ranges.length === 1 ) {\r\n\r\n\t\tconst root = new MeshBVHNode();\r\n\t\tconst range = ranges[ 0 ];\r\n\r\n\t\tif ( geo.boundingBox != null ) {\r\n\r\n\t\t\troot.boundingData = boxToArray( geo.boundingBox );\r\n\t\t\tgetCentroidBounds( triangleBounds, range.offset, range.count, cacheCentroidBoundingData );\r\n\r\n\t\t} else {\r\n\r\n\t\t\troot.boundingData = new Float32Array( 6 );\r\n\t\t\tgetBounds( triangleBounds, range.offset, range.count, root.boundingData, cacheCentroidBoundingData );\r\n\r\n\t\t}\r\n\r\n\t\tsplitNode( root, range.offset, range.count, cacheCentroidBoundingData );\r\n\t\troots.push( root );\r\n\r\n\t} else {\r\n\r\n\t\tfor ( let range of ranges ) {\r\n\r\n\t\t\tconst root = new MeshBVHNode();\r\n\t\t\troot.boundingData = new Float32Array( 6 );\r\n\t\t\tgetBounds( triangleBounds, range.offset, range.count, root.boundingData, cacheCentroidBoundingData );\r\n\r\n\t\t\tsplitNode( root, range.offset, range.count, cacheCentroidBoundingData );\r\n\t\t\troots.push( root );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// if the geometry doesn't have a bounding box, then let's politely populate it using\r\n\t// the work we did to determine the BVH root bounds\r\n\tif ( geo.boundingBox == null ) {\r\n\r\n\t\tconst rootBox = new Box3();\r\n\t\tgeo.boundingBox = new Box3();\r\n\r\n\t\tfor ( let root of roots ) {\r\n\r\n\t\t\tgeo.boundingBox.union( arrayToBox( root.boundingData, rootBox ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn roots;\r\n\r\n}\r\n","// Split strategy constants\r\nexport const CENTER = 0;\r\nexport const AVERAGE = 1;\r\nexport const SAH = 2;\r\n\r\nexport const NOT_INTERSECTED = 0;\r\nexport const INTERSECTED = 1;\r\nexport const CONTAINED = 2;\r\n","import { Vector3 } from 'three';\r\n\r\nexport class SeparatingAxisBounds {\r\n\r\n\tconstructor() {\r\n\r\n\t\tthis.min = Infinity;\r\n\t\tthis.max = - Infinity;\r\n\r\n\t}\r\n\r\n\tsetFromPointsField( points, field ) {\r\n\r\n\t\tlet min = Infinity;\r\n\t\tlet max = - Infinity;\r\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\tconst p = points[ i ];\r\n\t\t\tconst val = p[ field ];\r\n\t\t\tmin = Math.min( val, min );\r\n\t\t\tmax = Math.max( val, max );\r\n\r\n\t\t}\r\n\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\r\n\r\n\t}\r\n\r\n\tsetFromPoints( axis, points ) {\r\n\r\n\t\tlet min = Infinity;\r\n\t\tlet max = - Infinity;\r\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\tconst p = points[ i ];\r\n\t\t\tconst val = axis.dot( p );\r\n\t\t\tmin = Math.min( val, min );\r\n\t\t\tmax = Math.max( val, max );\r\n\r\n\t\t}\r\n\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\r\n\t}\r\n\r\n\tisSeparated( other ) {\r\n\r\n\t\treturn this.min > other.max || other.min > this.max;\r\n\r\n\t}\r\n\r\n}\r\n\r\nSeparatingAxisBounds.prototype.setFromBox = ( function () {\r\n\r\n\tconst p = new Vector3();\r\n\treturn function setFromBox( axis, box ) {\r\n\r\n\t\tconst boxMin = box.min;\r\n\t\tconst boxMax = box.max;\r\n\t\tlet min = Infinity;\r\n\t\tlet max = - Infinity;\r\n\t\tfor ( let x = 0; x <= 1; x ++ ) {\r\n\r\n\t\t\tfor ( let y = 0; y <= 1; y ++ ) {\r\n\r\n\t\t\t\tfor ( let z = 0; z <= 1; z ++ ) {\r\n\r\n\t\t\t\t\tp.x = boxMin.x * x + boxMax.x * ( 1 - x );\r\n\t\t\t\t\tp.y = boxMin.y * y + boxMax.y * ( 1 - y );\r\n\t\t\t\t\tp.z = boxMin.z * z + boxMax.z * ( 1 - z );\r\n\r\n\t\t\t\t\tconst val = axis.dot( p );\r\n\t\t\t\t\tmin = Math.min( val, min );\r\n\t\t\t\t\tmax = Math.max( val, max );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nexport const areIntersecting = ( function () {\r\n\r\n\tconst cacheSatBounds = new SeparatingAxisBounds();\r\n\treturn function areIntersecting( shape1, shape2 ) {\r\n\r\n\t\tconst points1 = shape1.points;\r\n\t\tconst satAxes1 = shape1.satAxes;\r\n\t\tconst satBounds1 = shape1.satBounds;\r\n\r\n\t\tconst points2 = shape2.points;\r\n\t\tconst satAxes2 = shape2.satAxes;\r\n\t\tconst satBounds2 = shape2.satBounds;\r\n\r\n\t\t// check axes of the first shape\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\tconst sb = satBounds1[ i ];\r\n\t\t\tconst sa = satAxes1[ i ];\r\n\t\t\tcacheSatBounds.setFromPoints( sa, points2 );\r\n\t\t\tif ( sb.isSeparated( cacheSatBounds ) ) return false;\r\n\r\n\t\t}\r\n\r\n\t\t// check axes of the second shape\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\tconst sb = satBounds2[ i ];\r\n\t\t\tconst sa = satAxes2[ i ];\r\n\t\t\tcacheSatBounds.setFromPoints( sa, points1 );\r\n\t\t\tif ( sb.isSeparated( cacheSatBounds ) ) return false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n} )();\r\n","import { Vector3, Vector2, Plane, Line3 } from 'three';\nexport const closestPointLineToLine = ( function () {\n\n\t// https://github.com/juj/MathGeoLib/blob/master/src/Geometry/Line.cpp#L56\n\tconst dir1 = new Vector3();\n\tconst dir2 = new Vector3();\n\tconst v02 = new Vector3();\n\treturn function closestPointLineToLine( l1, l2, result ) {\n\n\t\tconst v0 = l1.start;\n\t\tconst v10 = dir1;\n\t\tconst v2 = l2.start;\n\t\tconst v32 = dir2;\n\n\t\tv02.subVectors( v0, v2 );\n\t\tdir1.subVectors( l1.end, l2.start );\n\t\tdir2.subVectors( l2.end, l2.start );\n\n\t\t// float d0232 = v02.Dot(v32);\n\t\tconst d0232 = v02.dot( v32 );\n\n\t\t// float d3210 = v32.Dot(v10);\n\t\tconst d3210 = v32.dot( v10 );\n\n\t\t// float d3232 = v32.Dot(v32);\n\t\tconst d3232 = v32.dot( v32 );\n\n\t\t// float d0210 = v02.Dot(v10);\n\t\tconst d0210 = v02.dot( v10 );\n\n\t\t// float d1010 = v10.Dot(v10);\n\t\tconst d1010 = v10.dot( v10 );\n\n\t\t// float denom = d1010*d3232 - d3210*d3210;\n\t\tconst denom = d1010 * d3232 - d3210 * d3210;\n\n\t\tlet d, d2;\n\t\tif ( denom !== 0 ) {\n\n\t\t\td = ( d0232 * d3210 - d0210 * d3232 ) / denom;\n\n\t\t} else {\n\n\t\t\td = 0;\n\n\t\t}\n\n\t\td2 = ( d0232 + d * d3210 ) / d3232;\n\n\t\tresult.x = d;\n\t\tresult.y = d2;\n\n\t};\n\n} )();\n\nexport const closestPointsSegmentToSegment = ( function () {\n\n\t// https://github.com/juj/MathGeoLib/blob/master/src/Geometry/LineSegment.cpp#L187\n\tconst paramResult = new Vector2();\n\tconst temp1 = new Vector3();\n\tconst temp2 = new Vector3();\n\treturn function closestPointsSegmentToSegment( l1, l2, target1, target2 ) {\n\n\t\tclosestPointLineToLine( l1, l2, paramResult );\n\n\t\tlet d = paramResult.x;\n\t\tlet d2 = paramResult.y;\n\t\tif ( d >= 0 && d <= 1 && d2 >= 0 && d2 <= 1 ) {\n\n\t\t\tl1.at( d, target1 );\n\t\t\tl2.at( d2, target2 );\n\n\t\t\treturn;\n\n\t\t} else if ( d >= 0 && d <= 1 ) {\n\n\t\t\t// Only d2 is out of bounds.\n\t\t\tif ( d2 < 0 ) {\n\n\t\t\t\tl2.at( 0, target2 );\n\n\t\t\t} else {\n\n\t\t\t\tl2.at( 1, target2 );\n\n\t\t\t}\n\n\t\t\tl1.closestPointToPoint( target2, true, target1 );\n\t\t\treturn;\n\n\t\t} else if ( d2 >= 0 && d2 <= 1 ) {\n\n\t\t\t// Only d is out of bounds.\n\t\t\tif ( d < 0 ) {\n\n\t\t\t\tl1.at( 0, target1 );\n\n\t\t\t} else {\n\n\t\t\t\tl1.at( 1, target1 );\n\n\t\t\t}\n\n\t\t\tl2.closestPointToPoint( target1, true, target2 );\n\t\t\treturn;\n\n\t\t} else {\n\n\t\t\t// Both u and u2 are out of bounds.\n\t\t\tlet p;\n\t\t\tif ( d < 0 ) {\n\n\t\t\t\tp = l1.start;\n\n\t\t\t} else {\n\n\t\t\t\tp = l1.end;\n\n\t\t\t}\n\n\t\t\tlet p2;\n\t\t\tif ( d2 < 0 ) {\n\n\t\t\t\tp2 = l2.start;\n\n\t\t\t} else {\n\n\t\t\t\tp2 = l2.end;\n\n\t\t\t}\n\n\t\t\tconst closestPoint = temp1;\n\t\t\tconst closestPoint2 = temp2;\n\t\t\tl1.closestPointToPoint( p2, true, temp1 );\n\t\t\tl2.closestPointToPoint( p, true, temp2 );\n\n\t\t\tif ( closestPoint.distanceToSquared( p2 ) <= closestPoint2.distanceToSquared( p ) ) {\n\n\t\t\t\ttarget1.copy( closestPoint );\n\t\t\t\ttarget2.copy( p2 );\n\t\t\t\treturn;\n\n\t\t\t} else {\n\n\t\t\t\ttarget1.copy( p );\n\t\t\t\ttarget2.copy( closestPoint2 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n} )();\n\n\nexport const sphereIntersectTriangle = ( function () {\n\n\t// https://stackoverflow.com/questions/34043955/detect-collision-between-sphere-and-triangle-in-three-js\n\tconst closestPointTemp = new Vector3();\n\tconst projectedPointTemp = new Vector3();\n\tconst planeTemp = new Plane();\n\tconst lineTemp = new Line3();\n\treturn function sphereIntersectTriangle( sphere, triangle ) {\n\n\t\tconst { radius, center } = sphere;\n\t\tconst { a, b, c } = triangle;\n\n\t\t// phase 1\n\t\tlineTemp.start = a;\n\t\tlineTemp.end = b;\n\t\tconst closestPoint1 = lineTemp.closestPointToPoint( center, true, closestPointTemp );\n\t\tif ( closestPoint1.distanceTo( center ) <= radius ) return true;\n\n\t\tlineTemp.start = a;\n\t\tlineTemp.end = c;\n\t\tconst closestPoint2 = lineTemp.closestPointToPoint( center, true, closestPointTemp );\n\t\tif ( closestPoint2.distanceTo( center ) <= radius ) return true;\n\n\t\tlineTemp.start = b;\n\t\tlineTemp.end = c;\n\t\tconst closestPoint3 = lineTemp.closestPointToPoint( center, true, closestPointTemp );\n\t\tif ( closestPoint3.distanceTo( center ) <= radius ) return true;\n\n\t\t// phase 2\n\t\tconst plane = triangle.getPlane( planeTemp );\n\t\tconst dp = Math.abs( plane.distanceToPoint( center ) );\n\t\tif ( dp <= radius ) {\n\n\t\t\tconst pp = plane.projectPoint( center, projectedPointTemp );\n\t\t\tconst cp = triangle.containsPoint( pp );\n\t\t\tif ( cp ) return true;\n\n\t\t}\n\n\t\treturn false;\n\n\t};\n\n} )();\n","import { Triangle, Vector3, Line3, Sphere } from 'three';\r\nimport { SeparatingAxisBounds } from './SeparatingAxisBounds.js';\r\nimport { closestPointsSegmentToSegment, sphereIntersectTriangle } from './MathUtilities.js';\r\n\r\nexport class SeparatingAxisTriangle extends Triangle {\r\n\r\n\tconstructor( ...args ) {\r\n\r\n\t\tsuper( ...args );\r\n\r\n\t\tthis.isSeparatingAxisTriangle = true;\r\n\t\tthis.satAxes = new Array( 4 ).fill().map( () => new Vector3() );\r\n\t\tthis.satBounds = new Array( 4 ).fill().map( () => new SeparatingAxisBounds() );\r\n\t\tthis.points = [ this.a, this.b, this.c ];\r\n\t\tthis.sphere = new Sphere();\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t}\r\n\r\n\tintersectsSphere( sphere ) {\r\n\r\n\t\treturn sphereIntersectTriangle( sphere, this );\r\n\r\n\t}\r\n\r\n}\r\n\r\nSeparatingAxisTriangle.prototype.update = ( function () {\r\n\r\n\tconst arr = new Array( 3 );\r\n\treturn function update() {\r\n\r\n\t\tconst a = this.a;\r\n\t\tconst b = this.b;\r\n\t\tconst c = this.c;\r\n\r\n\t\tarr[ 0 ] = this.a;\r\n\t\tarr[ 1 ] = this.b;\r\n\t\tarr[ 2 ] = this.c;\r\n\r\n\t\tconst satAxes = this.satAxes;\r\n\t\tconst satBounds = this.satBounds;\r\n\r\n\t\tconst axis0 = satAxes[ 0 ];\r\n\t\tconst sab0 = satBounds[ 0 ];\r\n\t\tthis.getNormal( axis0 );\r\n\t\tsab0.setFromPoints( axis0, arr );\r\n\r\n\t\tconst axis1 = satAxes[ 1 ];\r\n\t\tconst sab1 = satBounds[ 1 ];\r\n\t\taxis1.subVectors( a, b );\r\n\t\tsab1.setFromPoints( axis1, arr );\r\n\r\n\t\tconst axis2 = satAxes[ 2 ];\r\n\t\tconst sab2 = satBounds[ 2 ];\r\n\t\taxis2.subVectors( b, c );\r\n\t\tsab2.setFromPoints( axis2, arr );\r\n\r\n\t\tconst axis3 = satAxes[ 3 ];\r\n\t\tconst sab3 = satBounds[ 3 ];\r\n\t\taxis3.subVectors( c, a );\r\n\t\tsab3.setFromPoints( axis3, arr );\r\n\r\n\t\tthis.sphere.setFromPoints( this.points );\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nSeparatingAxisTriangle.prototype.closestPointToSegment = ( function () {\r\n\r\n\tconst point1 = new Vector3();\r\n\tconst point2 = new Vector3();\r\n\tconst edge = new Line3();\r\n\r\n\treturn function distanceToSegment( segment, target1 = null, target2 = null ) {\r\n\r\n\t\tif ( this.needsUpdate ) {\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t}\r\n\r\n\t\tconst { start, end } = segment;\r\n\t\tconst points = this.points;\r\n\t\tlet distSq;\r\n\t\tlet closestDistanceSq = Infinity;\r\n\r\n\t\t// check the triangle edges\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\tconst nexti = ( i + 1 ) % 3;\r\n\t\t\tedge.start.copy( points[ i ] );\r\n\t\t\tedge.end.copy( points[ nexti ] );\r\n\r\n\t\t\tclosestPointsSegmentToSegment( edge, segment, point1, point2 );\r\n\r\n\t\t\tdistSq = point1.distanceToSquared( point2 );\r\n\t\t\tif ( distSq < closestDistanceSq ) {\r\n\r\n\t\t\t\tclosestDistanceSq = distSq;\r\n\t\t\t\tif ( target1 ) target1.copy( point1 );\r\n\t\t\t\tif ( target2 ) target2.copy( point2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// check end points\r\n\t\tthis.closestPointToPoint( start, point1 );\r\n\t\tdistSq = start.distanceToSquared( point1 );\r\n\t\tif ( distSq < closestDistanceSq ) {\r\n\r\n\t\t\tclosestDistanceSq = distSq;\r\n\t\t\tif ( target1 ) target1.copy( point1 );\r\n\t\t\tif ( target2 ) target2.copy( start );\r\n\r\n\t\t}\r\n\r\n\t\tthis.closestPointToPoint( end, point1 );\r\n\t\tdistSq = end.distanceToSquared( point1 );\r\n\t\tif ( distSq < closestDistanceSq ) {\r\n\r\n\t\t\tclosestDistanceSq = distSq;\r\n\t\t\tif ( target1 ) target1.copy( point1 );\r\n\t\t\tif ( target2 ) target2.copy( end );\r\n\r\n\t\t}\r\n\r\n\t\treturn Math.sqrt( closestDistanceSq );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nSeparatingAxisTriangle.prototype.intersectsTriangle = ( function () {\r\n\r\n\tconst saTri2 = new SeparatingAxisTriangle();\r\n\tconst arr1 = new Array( 3 );\r\n\tconst arr2 = new Array( 3 );\r\n\tconst cachedSatBounds = new SeparatingAxisBounds();\r\n\tconst cachedSatBounds2 = new SeparatingAxisBounds();\r\n\tconst cachedAxis = new Vector3();\r\n\treturn function intersectsTriangle( other ) {\r\n\r\n\t\tif ( this.needsUpdate ) {\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t}\r\n\r\n\t\tif ( ! other.isSeparatingAxisTriangle ) {\r\n\r\n\t\t\tsaTri2.copy( other );\r\n\t\t\tsaTri2.update();\r\n\t\t\tother = saTri2;\r\n\r\n\t\t}\r\n\r\n\t\tconst satBounds1 = this.satBounds;\r\n\t\tconst satAxes1 = this.satAxes;\r\n\t\tarr2[ 0 ] = other.a;\r\n\t\tarr2[ 1 ] = other.b;\r\n\t\tarr2[ 2 ] = other.c;\r\n\t\tfor ( let i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\tconst sb = satBounds1[ i ];\r\n\t\t\tconst sa = satAxes1[ i ];\r\n\t\t\tcachedSatBounds.setFromPoints( sa, arr2 );\r\n\t\t\tif ( sb.isSeparated( cachedSatBounds ) ) return false;\r\n\r\n\t\t}\r\n\r\n\t\tconst satBounds2 = other.satBounds;\r\n\t\tconst satAxes2 = other.satAxes;\r\n\t\tarr1[ 0 ] = this.a;\r\n\t\tarr1[ 1 ] = this.b;\r\n\t\tarr1[ 2 ] = this.c;\r\n\t\tfor ( let i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\tconst sb = satBounds2[ i ];\r\n\t\t\tconst sa = satAxes2[ i ];\r\n\t\t\tcachedSatBounds.setFromPoints( sa, arr1 );\r\n\t\t\tif ( sb.isSeparated( cachedSatBounds ) ) return false;\r\n\r\n\t\t}\r\n\r\n\t\t// check crossed axes\r\n\t\tfor ( let i = 0; i < 4; i ++ ) {\r\n\r\n\t\t\tconst sa1 = satAxes1[ i ];\r\n\t\t\tfor ( let i2 = 0; i2 < 4; i2 ++ ) {\r\n\r\n\t\t\t\tconst sa2 = satAxes2[ i2 ];\r\n\t\t\t\tcachedAxis.crossVectors( sa1, sa2 );\r\n\t\t\t\tcachedSatBounds.setFromPoints( cachedAxis, arr1 );\r\n\t\t\t\tcachedSatBounds2.setFromPoints( cachedAxis, arr2 );\r\n\t\t\t\tif ( cachedSatBounds.isSeparated( cachedSatBounds2 ) ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n\r\nSeparatingAxisTriangle.prototype.distanceToPoint = ( function () {\r\n\r\n\tconst target = new Vector3();\r\n\treturn function distanceToPoint( point ) {\r\n\r\n\t\tthis.closestPointToPoint( point, target );\r\n\t\treturn point.distanceTo( target );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n\r\nSeparatingAxisTriangle.prototype.distanceToTriangle = ( function () {\r\n\r\n\tconst point = new Vector3();\r\n\tconst point2 = new Vector3();\r\n\tconst cornerFields = [ 'a', 'b', 'c' ];\r\n\tconst line1 = new Line3();\r\n\tconst line2 = new Line3();\r\n\r\n\treturn function distanceToTriangle( other, target1 = null, target2 = null ) {\r\n\r\n\t\tif ( other.needsUpdate ) {\r\n\r\n\t\t\tother.update();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.needsUpdate ) {\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.intersectsTriangle( other ) ) {\r\n\r\n\t\t\t// TODO: This will not result in a point that lies on\r\n\t\t\t// the intersection line of the triangles\r\n\t\t\tif ( target1 || target2 ) {\r\n\r\n\t\t\t\tthis.getMidpoint( point );\r\n\t\t\t\tother.closestPointToPoint( point, point2 );\r\n\t\t\t\tthis.closestPointToPoint( point2, point );\r\n\r\n\t\t\t\tif ( target1 ) target1.copy( point );\r\n\t\t\t\tif ( target2 ) target2.copy( point2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 0;\r\n\r\n\t\t}\r\n\r\n\t\tlet closestDistanceSq = Infinity;\r\n\r\n\t\t// check all point distances\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\tlet dist;\r\n\t\t\tconst field = cornerFields[ i ];\r\n\t\t\tconst otherVec = other[ field ];\r\n\t\t\tthis.closestPointToPoint( otherVec, point );\r\n\r\n\t\t\tdist = otherVec.distanceToSquared( point );\r\n\r\n\t\t\tif ( dist < closestDistanceSq ) {\r\n\r\n\t\t\t\tclosestDistanceSq = dist;\r\n\t\t\t\tif ( target1 ) target1.copy( point );\r\n\t\t\t\tif ( target2 ) target2.copy( otherVec );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tconst thisVec = this[ field ];\r\n\t\t\tother.closestPointToPoint( thisVec, point );\r\n\r\n\t\t\tdist = thisVec.distanceToSquared( point );\r\n\r\n\t\t\tif ( dist < closestDistanceSq ) {\r\n\r\n\t\t\t\tclosestDistanceSq = dist;\r\n\t\t\t\tif ( target1 ) target1.copy( thisVec );\r\n\t\t\t\tif ( target2 ) target2.copy( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( let i = 0; i < 3; i ++ ) {\r\n\r\n\t\t\tconst f11 = cornerFields[ i ];\r\n\t\t\tconst f12 = cornerFields[ ( i + 1 ) % 3 ];\r\n\t\t\tline1.set( this[ f11 ], this[ f12 ] );\r\n\t\t\tfor ( let i2 = 0; i2 < 3; i2 ++ ) {\r\n\r\n\t\t\t\tconst f21 = cornerFields[ i2 ];\r\n\t\t\t\tconst f22 = cornerFields[ ( i2 + 1 ) % 3 ];\r\n\t\t\t\tline2.set( other[ f21 ], other[ f22 ] );\r\n\r\n\t\t\t\tclosestPointsSegmentToSegment( line1, line2, point, point2 );\r\n\r\n\t\t\t\tconst dist = point.distanceToSquared( point2 );\r\n\t\t\t\tif ( dist < closestDistanceSq ) {\r\n\r\n\t\t\t\t\tclosestDistanceSq = dist;\r\n\t\t\t\t\tif ( target1 ) target1.copy( point );\r\n\t\t\t\t\tif ( target2 ) target2.copy( point2 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn Math.sqrt( closestDistanceSq );\r\n\r\n\t};\r\n\r\n} )();\r\n\r\n","import { Box3, Vector3, Matrix4, Sphere, Line3 } from 'three';\nimport { SeparatingAxisBounds } from './SeparatingAxisBounds.js';\nimport { SeparatingAxisTriangle } from './SeparatingAxisTriangle.js';\nimport { closestPointsSegmentToSegment } from './MathUtilities.js';\n\nexport class OrientedBox extends Box3 {\n\n\tconstructor( ...args ) {\n\n\t\tsuper( ...args );\n\n\t\tthis.isOrientedBox = true;\n\t\tthis.matrix = new Matrix4();\n\t\tthis.invMatrix = new Matrix4();\n\t\tthis.points = new Array( 8 ).fill().map( () => new Vector3() );\n\t\tthis.satAxes = new Array( 3 ).fill().map( () => new Vector3() );\n\t\tthis.satBounds = new Array( 3 ).fill().map( () => new SeparatingAxisBounds() );\n\t\tthis.alignedSatBounds = new Array( 3 ).fill().map( () => new SeparatingAxisBounds() );\n\t\tthis.sphere = new Sphere();\n\n\t}\n\n\tset( min, max, matrix ) {\n\n\t\tsuper.set( min, max );\n\t\tthis.matrix = matrix;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tsuper.copy( other );\n\t\tthis.matrix.copy( other.matrix );\n\n\t}\n\n}\n\nOrientedBox.prototype.update = ( function () {\n\n\treturn function update() {\n\n\t\tconst matrix = this.matrix;\n\t\tconst min = this.min;\n\t\tconst max = this.max;\n\n\t\tconst points = this.points;\n\t\tfor ( let x = 0; x <= 1; x ++ ) {\n\n\t\t\tfor ( let y = 0; y <= 1; y ++ ) {\n\n\t\t\t\tfor ( let z = 0; z <= 1; z ++ ) {\n\n\t\t\t\t\tconst i = ( ( 1 << 0 ) * x ) | ( ( 1 << 1 ) * y ) | ( ( 1 << 2 ) * z );\n\t\t\t\t\tconst v = points[ i ];\n\t\t\t\t\tv.x = x ? max.x : min.x;\n\t\t\t\t\tv.y = y ? max.y : min.y;\n\t\t\t\t\tv.z = z ? max.z : min.z;\n\n\t\t\t\t\tv.applyMatrix4( matrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.sphere.setFromPoints( this.points );\n\n\t\tconst satBounds = this.satBounds;\n\t\tconst satAxes = this.satAxes;\n\t\tconst minVec = points[ 0 ];\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst axis = satAxes[ i ];\n\t\t\tconst sb = satBounds[ i ];\n\t\t\tconst index = 1 << i;\n\t\t\tconst pi = points[ index ];\n\n\t\t\taxis.subVectors( minVec, pi );\n\t\t\tsb.setFromPoints( axis, points );\n\n\t\t}\n\n\t\tconst alignedSatBounds = this.alignedSatBounds;\n\t\talignedSatBounds[ 0 ].setFromPointsField( points, 'x' );\n\t\talignedSatBounds[ 1 ].setFromPointsField( points, 'y' );\n\t\talignedSatBounds[ 2 ].setFromPointsField( points, 'z' );\n\n\t\tthis.invMatrix.copy( this.matrix ).invert();\n\n\t};\n\n} )();\n\nOrientedBox.prototype.intersectsBox = ( function () {\n\n\tconst aabbBounds = new SeparatingAxisBounds();\n\treturn function intersectsBox( box ) {\n\n\t\tif ( ! box.intersectsSphere( this.sphere ) ) return false;\n\n\t\tconst min = box.min;\n\t\tconst max = box.max;\n\t\tconst satBounds = this.satBounds;\n\t\tconst satAxes = this.satAxes;\n\t\tconst alignedSatBounds = this.alignedSatBounds;\n\n\t\taabbBounds.min = min.x;\n\t\taabbBounds.max = max.x;\n\t\tif ( alignedSatBounds[ 0 ].isSeparated( aabbBounds ) ) return false;\n\n\t\taabbBounds.min = min.y;\n\t\taabbBounds.max = max.y;\n\t\tif ( alignedSatBounds[ 1 ].isSeparated( aabbBounds ) ) return false;\n\n\t\taabbBounds.min = min.z;\n\t\taabbBounds.max = max.z;\n\t\tif ( alignedSatBounds[ 2 ].isSeparated( aabbBounds ) ) return false;\n\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst axis = satAxes[ i ];\n\t\t\tconst sb = satBounds[ i ];\n\t\t\taabbBounds.setFromBox( axis, box );\n\t\t\tif ( sb.isSeparated( aabbBounds ) ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t};\n\n} )();\n\nOrientedBox.prototype.intersectsTriangle = ( function () {\n\n\tconst saTri = new SeparatingAxisTriangle();\n\tconst pointsArr = new Array( 3 );\n\tconst cachedSatBounds = new SeparatingAxisBounds();\n\tconst cachedSatBounds2 = new SeparatingAxisBounds();\n\tconst cachedAxis = new Vector3();\n\treturn function intersectsTriangle( triangle ) {\n\n\t\tif ( ! triangle.isSeparatingAxisTriangle ) {\n\n\t\t\tsaTri.copy( triangle );\n\t\t\tsaTri.update();\n\t\t\ttriangle = saTri;\n\n\t\t} else if ( triangle.needsUpdate ) {\n\n\t\t\ttriangle.update();\n\n\t\t}\n\n\t\tconst satBounds = this.satBounds;\n\t\tconst satAxes = this.satAxes;\n\n\t\tpointsArr[ 0 ] = triangle.a;\n\t\tpointsArr[ 1 ] = triangle.b;\n\t\tpointsArr[ 2 ] = triangle.c;\n\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst sb = satBounds[ i ];\n\t\t\tconst sa = satAxes[ i ];\n\t\t\tcachedSatBounds.setFromPoints( sa, pointsArr );\n\t\t\tif ( sb.isSeparated( cachedSatBounds ) ) return false;\n\n\t\t}\n\n\t\tconst triSatBounds = triangle.satBounds;\n\t\tconst triSatAxes = triangle.satAxes;\n\t\tconst points = this.points;\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst sb = triSatBounds[ i ];\n\t\t\tconst sa = triSatAxes[ i ];\n\t\t\tcachedSatBounds.setFromPoints( sa, points );\n\t\t\tif ( sb.isSeparated( cachedSatBounds ) ) return false;\n\n\t\t}\n\n\t\t// check crossed axes\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tconst sa1 = satAxes[ i ];\n\t\t\tfor ( let i2 = 0; i2 < 4; i2 ++ ) {\n\n\t\t\t\tconst sa2 = triSatAxes[ i2 ];\n\t\t\t\tcachedAxis.crossVectors( sa1, sa2 );\n\t\t\t\tcachedSatBounds.setFromPoints( cachedAxis, pointsArr );\n\t\t\t\tcachedSatBounds2.setFromPoints( cachedAxis, points );\n\t\t\t\tif ( cachedSatBounds.isSeparated( cachedSatBounds2 ) ) return false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t};\n\n} )();\n\nOrientedBox.prototype.closestPointToPoint = ( function () {\n\n\treturn function closestPointToPoint( point, target1 ) {\n\n\t\ttarget1\n\t\t\t.copy( point )\n\t\t\t.applyMatrix4( this.invMatrix )\n\t\t\t.clamp( this.min, this.max )\n\t\t\t.applyMatrix4( this.matrix );\n\n\t\treturn target1;\n\n\t};\n\n} )();\n\nOrientedBox.prototype.distanceToPoint = ( function () {\n\n\tconst target = new Vector3();\n\treturn function distanceToPoint( point ) {\n\n\t\tthis.closestPointToPoint( point, target );\n\t\treturn point.distanceTo( target );\n\n\t};\n\n} )();\n\n\nOrientedBox.prototype.distanceToBox = ( function () {\n\n\tconst xyzFields = [ 'x', 'y', 'z' ];\n\tconst segments1 = new Array( 12 ).fill().map( () => new Line3() );\n\tconst segments2 = new Array( 12 ).fill().map( () => new Line3() );\n\n\tconst point1 = new Vector3();\n\tconst point2 = new Vector3();\n\n\treturn function distanceToBox( box, threshold = 0, target1 = null, target2 = null ) {\n\n\t\tif ( this.intersectsBox( box ) ) {\n\n\t\t\tif ( target1 || target2 ) {\n\n\t\t\t\tbox.getCenter( point2 );\n\t\t\t\tthis.closestPointToPoint( point2, point1 );\n\t\t\t\tbox.closestPointToPoint( point1, point2 );\n\n\t\t\t\tif ( target1 ) target1.copy( point1 );\n\t\t\t\tif ( target2 ) target2.copy( point2 );\n\n\t\t\t}\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tconst threshold2 = threshold * threshold;\n\t\tconst min = box.min;\n\t\tconst max = box.max;\n\t\tconst points = this.points;\n\n\n\t\t// iterate over every edge and compare distances\n\t\tlet closestDistanceSq = Infinity;\n\n\t\t// check over all these points\n\t\tfor ( let i = 0; i < 8; i ++ ) {\n\n\t\t\tconst p = points[ i ];\n\t\t\tpoint2.copy( p ).clamp( min, max );\n\n\t\t\tconst dist = p.distanceToSquared( point2 );\n\t\t\tif ( dist < closestDistanceSq ) {\n\n\t\t\t\tclosestDistanceSq = dist;\n\t\t\t\tif ( target1 ) target1.copy( p );\n\t\t\t\tif ( target2 ) target2.copy( point2 );\n\n\t\t\t\tif ( dist < threshold2 ) return Math.sqrt( dist );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate and check all line segment distances\n\t\tlet count = 0;\n\t\tfor ( let i = 0; i < 3; i ++ ) {\n\n\t\t\tfor ( let i1 = 0; i1 <= 1; i1 ++ ) {\n\n\t\t\t\tfor ( let i2 = 0; i2 <= 1; i2 ++ ) {\n\n\t\t\t\t\tconst nextIndex = ( i + 1 ) % 3;\n\t\t\t\t\tconst nextIndex2 = ( i + 2 ) % 3;\n\n\t\t\t\t\t// get obb line segments\n\t\t\t\t\tconst index = i1 << nextIndex | i2 << nextIndex2;\n\t\t\t\t\tconst index2 = 1 << i | i1 << nextIndex | i2 << nextIndex2;\n\t\t\t\t\tconst p1 = points[ index ];\n\t\t\t\t\tconst p2 = points[ index2 ];\n\t\t\t\t\tconst line1 = segments1[ count ];\n\t\t\t\t\tline1.set( p1, p2 );\n\n\n\t\t\t\t\t// get aabb line segments\n\t\t\t\t\tconst f1 = xyzFields[ i ];\n\t\t\t\t\tconst f2 = xyzFields[ nextIndex ];\n\t\t\t\t\tconst f3 = xyzFields[ nextIndex2 ];\n\t\t\t\t\tconst line2 = segments2[ count ];\n\t\t\t\t\tconst start = line2.start;\n\t\t\t\t\tconst end = line2.end;\n\n\t\t\t\t\tstart[ f1 ] = min[ f1 ];\n\t\t\t\t\tstart[ f2 ] = i1 ? min[ f2 ] : max[ f2 ];\n\t\t\t\t\tstart[ f3 ] = i2 ? min[ f3 ] : max[ f2 ];\n\n\t\t\t\t\tend[ f1 ] = max[ f1 ];\n\t\t\t\t\tend[ f2 ] = i1 ? min[ f2 ] : max[ f2 ];\n\t\t\t\t\tend[ f3 ] = i2 ? min[ f3 ] : max[ f2 ];\n\n\t\t\t\t\tcount ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// check all the other boxes point\n\t\tfor ( let x = 0; x <= 1; x ++ ) {\n\n\t\t\tfor ( let y = 0; y <= 1; y ++ ) {\n\n\t\t\t\tfor ( let z = 0; z <= 1; z ++ ) {\n\n\t\t\t\t\tpoint2.x = x ? max.x : min.x;\n\t\t\t\t\tpoint2.y = y ? max.y : min.y;\n\t\t\t\t\tpoint2.z = z ? max.z : min.z;\n\n\t\t\t\t\tthis.closestPointToPoint( point2, point1 );\n\t\t\t\t\tconst dist = point2.distanceToSquared( point1 );\n\t\t\t\t\tif ( dist < closestDistanceSq ) {\n\n\t\t\t\t\t\tclosestDistanceSq = dist;\n\t\t\t\t\t\tif ( target1 ) target1.copy( point1 );\n\t\t\t\t\t\tif ( target2 ) target2.copy( point2 );\n\n\t\t\t\t\t\tif ( dist < threshold2 ) return Math.sqrt( dist );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 12; i ++ ) {\n\n\t\t\tconst l1 = segments1[ i ];\n\t\t\tfor ( let i2 = 0; i2 < 12; i2 ++ ) {\n\n\t\t\t\tconst l2 = segments2[ i2 ];\n\t\t\t\tclosestPointsSegmentToSegment( l1, l2, point1, point2 );\n\t\t\t\tconst dist = point1.distanceToSquared( point2 );\n\t\t\t\tif ( dist < closestDistanceSq ) {\n\n\t\t\t\t\tclosestDistanceSq = dist;\n\t\t\t\t\tif ( target1 ) target1.copy( point1 );\n\t\t\t\t\tif ( target2 ) target2.copy( point2 );\n\n\t\t\t\t\tif ( dist < threshold2 ) return Math.sqrt( dist );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Math.sqrt( closestDistanceSq );\n\n\t};\n\n} )();\n","// sets the vertices of triangle `tri` with the 3 vertices after i\r\nexport function setTriangle( tri, i, index, pos ) {\r\n\r\n\tconst ta = tri.a;\r\n\tconst tb = tri.b;\r\n\tconst tc = tri.c;\r\n\r\n\tlet i3 = index.getX( i );\r\n\tta.x = pos.getX( i3 );\r\n\tta.y = pos.getY( i3 );\r\n\tta.z = pos.getZ( i3 );\r\n\r\n\ti3 = index.getX( i + 1 );\r\n\ttb.x = pos.getX( i3 );\r\n\ttb.y = pos.getY( i3 );\r\n\ttb.z = pos.getZ( i3 );\r\n\r\n\ti3 = index.getX( i + 2 );\r\n\ttc.x = pos.getX( i3 );\r\n\ttc.y = pos.getY( i3 );\r\n\ttc.z = pos.getZ( i3 );\r\n\r\n}\r\n","import { Vector3, Vector2, Triangle, DoubleSide, BackSide } from 'three';\r\n\r\n// Ripped and modified From THREE.js Mesh raycast\r\n// https://github.com/mrdoob/three.js/blob/0aa87c999fe61e216c1133fba7a95772b503eddf/src/objects/Mesh.js#L115\r\nvar vA = new Vector3();\r\nvar vB = new Vector3();\r\nvar vC = new Vector3();\r\n\r\nvar uvA = new Vector2();\r\nvar uvB = new Vector2();\r\nvar uvC = new Vector2();\r\n\r\nvar intersectionPoint = new Vector3();\r\nvar intersectionPointWorld = new Vector3();\r\n\r\nfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\r\n\r\n\tvar intersect;\r\n\tif ( material.side === BackSide ) {\r\n\r\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t} else {\r\n\r\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\r\n\r\n\t}\r\n\r\n\tif ( intersect === null ) return null;\r\n\r\n\tintersectionPointWorld.copy( point );\r\n\tintersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\r\n\r\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\r\n\r\n\treturn {\r\n\t\tdistance: distance,\r\n\t\tpoint: intersectionPointWorld.clone(),\r\n\t\tobject: object\r\n\t};\r\n\r\n}\r\n\r\nfunction checkBufferGeometryIntersection( object, raycaster, ray, position, uv, a, b, c ) {\r\n\r\n\tvA.fromBufferAttribute( position, a );\r\n\tvB.fromBufferAttribute( position, b );\r\n\tvC.fromBufferAttribute( position, c );\r\n\r\n\tvar intersection = checkIntersection( object, object.material, raycaster, ray, vA, vB, vC, intersectionPoint );\r\n\r\n\tif ( intersection ) {\r\n\r\n\t\tif ( uv ) {\r\n\r\n\t\t\tuvA.fromBufferAttribute( uv, a );\r\n\t\t\tuvB.fromBufferAttribute( uv, b );\r\n\t\t\tuvC.fromBufferAttribute( uv, c );\r\n\r\n\t\t\tintersection.uv = Triangle.getUV( intersectionPoint, vA, vB, vC, uvA, uvB, uvC, new Vector2( ) );\r\n\r\n\t\t}\r\n\r\n\t\tconst face = {\r\n\t\t\ta: a,\r\n\t\t\tb: b,\r\n\t\t\tc: c,\r\n\t\t\tnormal: new Vector3( ),\r\n\t\t\tmaterialIndex: 0\r\n\t\t};\r\n\r\n\t\tTriangle.getNormal( vA, vB, vC, face.normal );\r\n\r\n\t\tintersection.face = face;\r\n\t\tintersection.faceIndex = a;\r\n\r\n\t}\r\n\r\n\treturn intersection;\r\n\r\n}\r\n\r\n// https://github.com/mrdoob/three.js/blob/0aa87c999fe61e216c1133fba7a95772b503eddf/src/objects/Mesh.js#L258\r\nfunction intersectTri( mesh, geo, raycaster, ray, tri, intersections ) {\r\n\r\n\tconst triOffset = tri * 3;\r\n\tconst a = geo.index.getX( triOffset );\r\n\tconst b = geo.index.getX( triOffset + 1 );\r\n\tconst c = geo.index.getX( triOffset + 2 );\r\n\r\n\tconst intersection = checkBufferGeometryIntersection( mesh, raycaster, ray, geo.attributes.position, geo.attributes.uv, a, b, c );\r\n\r\n\tif ( intersection ) {\r\n\r\n\t\tintersection.faceIndex = tri;\r\n\t\tif ( intersections ) intersections.push( intersection );\r\n\t\treturn intersection;\r\n\r\n\t}\r\n\r\n\treturn null;\r\n\r\n}\r\n\r\nexport { intersectTri };\r\n","import { intersectTri } from './ThreeIntersectionUtilities.js';\r\n\r\nexport function intersectTris( mesh, geo, raycaster, ray, offset, count, intersections ) {\r\n\r\n\tfor ( let i = offset, end = offset + count; i < end; i ++ ) {\r\n\r\n\t\tintersectTri( mesh, geo, raycaster, ray, i, intersections );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport function intersectClosestTri( mesh, geo, raycaster, ray, offset, count ) {\r\n\r\n\tlet dist = Infinity;\r\n\tlet res = null;\r\n\tfor ( let i = offset, end = offset + count; i < end; i ++ ) {\r\n\r\n\t\tconst intersection = intersectTri( mesh, geo, raycaster, ray, i );\r\n\t\tif ( intersection && intersection.distance < dist ) {\r\n\r\n\t\t\tres = intersection;\r\n\t\t\tdist = intersection.distance;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn res;\r\n\r\n};\r\n","\r\nimport { Box3, Vector3, Mesh, Matrix4 } from 'three';\r\nimport { intersectTris, intersectClosestTri } from './Utils/RayIntersectTriUtlities.js';\r\nimport { arrayToBox } from './Utils/ArrayBoxUtilities.js';\r\nimport { OrientedBox } from './Utils/OrientedBox.js';\r\nimport { setTriangle } from './Utils/TriangleUtils.js';\r\nimport { SeparatingAxisTriangle } from './Utils/SeparatingAxisTriangle.js';\r\nimport { CONTAINED } from './Constants.js';\r\n\r\nconst boundingBox = new Box3();\r\nconst boxIntersection = new Vector3();\r\nconst xyzFields = [ 'x', 'y', 'z' ];\r\n\r\nfunction intersectRay( node, ray, target ) {\r\n\r\n\tarrayToBox( node.boundingData, boundingBox );\r\n\r\n\treturn ray.intersectBox( boundingBox, target );\r\n\r\n}\r\n\r\nexport function raycast( node, mesh, raycaster, ray, intersects ) {\r\n\r\n\tif ( node.continueGeneration ) {\r\n\r\n\t\tnode.continueGeneration();\r\n\r\n\t}\r\n\r\n\tconst isLeaf = ! ! node.count;\r\n\tif ( isLeaf ) {\r\n\r\n\t\tintersectTris( mesh, mesh.geometry, raycaster, ray, node.offset, node.count, intersects );\r\n\r\n\t} else {\r\n\r\n\t\tif ( intersectRay( node.left, ray, boxIntersection ) ) {\r\n\r\n\t\t\traycast( node.left, mesh, raycaster, ray, intersects );\r\n\r\n\t\t}\r\n\r\n\t\tif ( intersectRay( node.right, ray, boxIntersection ) ) {\r\n\r\n\t\t\traycast( node.right, mesh, raycaster, ray, intersects );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport function raycastFirst( node, mesh, raycaster, ray ) {\r\n\r\n\tif ( node.continueGeneration ) {\r\n\r\n\t\tnode.continueGeneration();\r\n\r\n\t}\r\n\r\n\tconst isLeaf = ! ! node.count;\r\n\tif ( isLeaf ) {\r\n\r\n\t\treturn intersectClosestTri( mesh, mesh.geometry, raycaster, ray, node.offset, node.count );\r\n\r\n\t} else {\r\n\r\n\r\n\t\t// consider the position of the split plane with respect to the oncoming ray; whichever direction\r\n\t\t// the ray is coming from, look for an intersection among that side of the tree first\r\n\t\tconst splitAxis = node.splitAxis;\r\n\t\tconst xyzAxis = xyzFields[ splitAxis ];\r\n\t\tconst rayDir = ray.direction[ xyzAxis ];\r\n\t\tconst leftToRight = rayDir >= 0;\r\n\r\n\t\t// c1 is the child to check first\r\n\t\tlet c1, c2;\r\n\t\tif ( leftToRight ) {\r\n\r\n\t\t\tc1 = node.left;\r\n\t\t\tc2 = node.right;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tc1 = node.right;\r\n\t\t\tc2 = node.left;\r\n\r\n\t\t}\r\n\r\n\t\tconst c1Intersection = intersectRay( c1, ray, boxIntersection );\r\n\t\tconst c1Result = c1Intersection ? raycastFirst( c1, mesh, raycaster, ray ) : null;\r\n\r\n\t\t// if we got an intersection in the first node and it's closer than the second node's bounding\r\n\t\t// box, we don't need to consider the second node because it couldn't possibly be a better result\r\n\t\tif ( c1Result ) {\r\n\r\n\t\t\t// check if the point is within the second bounds\r\n\t\t\tconst point = c1Result.point[ xyzAxis ];\r\n\t\t\tconst isOutside = leftToRight ?\r\n\t\t\t\tpoint <= c2.boundingData[ splitAxis ] :\r\n\t\t\t\tpoint >= c2.boundingData[ splitAxis + 3 ];\r\n\r\n\t\t\tif ( isOutside ) {\r\n\r\n\t\t\t\treturn c1Result;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// either there was no intersection in the first node, or there could still be a closer\r\n\t\t// intersection in the second, so check the second node and then take the better of the two\r\n\t\tconst c2Intersection = intersectRay( c2, ray, boxIntersection );\r\n\t\tconst c2Result = c2Intersection ? raycastFirst( c2, mesh, raycaster, ray ) : null;\r\n\r\n\t\tif ( c1Result && c2Result ) {\r\n\r\n\t\t\treturn c1Result.distance <= c2Result.distance ? c1Result : c2Result;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn c1Result || c2Result || null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport const shapecast = ( function () {\r\n\r\n\tconst _triangle = new SeparatingAxisTriangle();\r\n\tconst _cachedBox1 = new Box3();\r\n\tconst _cachedBox2 = new Box3();\r\n\r\n\tfunction iterateOverTriangles(\r\n\t\toffset,\r\n\t\tcount,\r\n\t\tgeometry,\r\n\t\tintersectsTriangleFunc,\r\n\t\tcontained,\r\n\t\tdepth,\r\n\t\ttriangle\r\n\t) {\r\n\r\n\t\tconst index = geometry.index;\r\n\t\tconst pos = geometry.attributes.position;\r\n\t\tfor ( let i = offset * 3, l = ( count + offset ) * 3; i < l; i += 3 ) {\r\n\r\n\t\t\tsetTriangle( triangle, i, index, pos );\r\n\t\t\ttriangle.needsUpdate = true;\r\n\r\n\t\t\tif ( intersectsTriangleFunc( triangle, i, i + 1, i + 2, contained, depth ) ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\treturn function shapecast(\r\n\t\tnode,\r\n\t\tmesh,\r\n\t\tintersectsBoundsFunc,\r\n\t\tintersectsTriangleFunc = null,\r\n\t\tnodeScoreFunc = null,\r\n\t\tdepth = 0,\r\n\t\ttriangle = _triangle,\r\n\t\tcachedBox1 = _cachedBox1,\r\n\t\tcachedBox2 = _cachedBox2\r\n\t) {\r\n\r\n\t\t// Define these inside the function so it has access to the local variables needed\r\n\t\t// when converting to the buffer equivalents\r\n\t\tfunction getLeftOffset( node ) {\r\n\r\n\t\t\tif ( node.continueGeneration ) {\r\n\r\n\t\t\t\tnode.continueGeneration();\r\n\r\n\t\t\t}\r\n\r\n\t\t\twhile ( ! node.count ) {\r\n\r\n\t\t\t\tnode = node.left;\r\n\t\t\t\tif ( /* skip */ node.continueGeneration ) {\r\n\r\n\t\t\t\t\tnode.continueGeneration();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn node.offset;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getRightEndOffset( node ) {\r\n\r\n\t\t\tif ( node.continueGeneration ) {\r\n\r\n\t\t\t\tnode.continueGeneration();\r\n\r\n\t\t\t}\r\n\r\n\t\t\twhile ( ! node.count ) {\r\n\r\n\t\t\t\tnode = node.right;\r\n\t\t\t\tif ( /* skip */ node.continueGeneration ) {\r\n\r\n\t\t\t\t\tnode.continueGeneration();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn node.offset + node.count;\r\n\r\n\t\t}\r\n\r\n\t\tif ( node.continueGeneration ) {\r\n\r\n\t\t\tnode.continueGeneration();\r\n\r\n\t\t}\r\n\r\n\t\tconst isLeaf = ! ! node.count;\r\n\t\tif ( isLeaf && intersectsTriangleFunc ) {\r\n\r\n\t\t\tconst geometry = mesh.geometry;\r\n\t\t\tconst offset = node.offset;\r\n\t\t\tconst count = node.count;\r\n\t\t\treturn iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, false, depth, triangle );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst left = node.left;\r\n\t\t\tconst right = node.right;\r\n\t\t\tlet c1 = left;\r\n\t\t\tlet c2 = right;\r\n\r\n\t\t\tlet score1, score2;\r\n\t\t\tlet box1, box2;\r\n\t\t\tif ( nodeScoreFunc ) {\r\n\r\n\t\t\t\tbox1 = cachedBox1;\r\n\t\t\t\tbox2 = cachedBox2;\r\n\r\n\t\t\t\tarrayToBox( c1.boundingData, box1 );\r\n\t\t\t\tarrayToBox( c2.boundingData, box2 );\r\n\r\n\t\t\t\tscore1 = nodeScoreFunc( box1 );\r\n\t\t\t\tscore2 = nodeScoreFunc( box2 );\r\n\r\n\t\t\t\tif ( score2 < score1 ) {\r\n\r\n\t\t\t\t\tc1 = right;\r\n\t\t\t\t\tc2 = left;\r\n\r\n\t\t\t\t\tconst temp = score1;\r\n\t\t\t\t\tscore1 = score2;\r\n\t\t\t\t\tscore2 = temp;\r\n\r\n\t\t\t\t\tbox1 = box2;\r\n\t\t\t\t\t// box2 is always set before use below\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Check box 1 intersection\r\n\t\t\tif ( ! box1 ) {\r\n\r\n\t\t\t\tbox1 = cachedBox1;\r\n\t\t\t\tarrayToBox( c1.boundingData, box1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst isC1Leaf = ! ! c1.count;\r\n\t\t\tconst c1Intersection = intersectsBoundsFunc( box1, isC1Leaf, score1, depth + 1 );\r\n\r\n\t\t\tlet c1StopTraversal;\r\n\t\t\tif ( c1Intersection === CONTAINED ) {\r\n\r\n\t\t\t\tconst geometry = mesh.geometry;\r\n\t\t\t\tconst offset = getLeftOffset( c1 );\r\n\t\t\t\tconst end = getRightEndOffset( c1 );\r\n\t\t\t\tconst count = end - offset;\r\n\r\n\t\t\t\tc1StopTraversal = iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, true, depth + 1, triangle );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tc1StopTraversal =\r\n\t\t\t\t\tc1Intersection &&\r\n\t\t\t\t\tshapecast(\r\n\t\t\t\t\t\tc1,\r\n\t\t\t\t\t\tmesh,\r\n\t\t\t\t\t\tintersectsBoundsFunc,\r\n\t\t\t\t\t\tintersectsTriangleFunc,\r\n\t\t\t\t\t\tnodeScoreFunc,\r\n\t\t\t\t\t\tdepth + 1,\r\n\t\t\t\t\t\ttriangle,\r\n\t\t\t\t\t\tcachedBox1,\r\n\t\t\t\t\t\tcachedBox2\r\n\t\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( c1StopTraversal ) return true;\r\n\r\n\t\t\t// Check box 2 intersection\r\n\t\t\t// cached box2 will have been overwritten by previous traversal\r\n\t\t\tbox2 = cachedBox2;\r\n\t\t\tarrayToBox( c2.boundingData, box2 );\r\n\r\n\t\t\tconst isC2Leaf = ! ! c2.count;\r\n\t\t\tconst c2Intersection = intersectsBoundsFunc( box2, isC2Leaf, score2, depth + 1 );\r\n\r\n\t\t\tlet c2StopTraversal;\r\n\t\t\tif ( c2Intersection === CONTAINED ) {\r\n\r\n\t\t\t\tconst geometry = mesh.geometry;\r\n\t\t\t\tconst offset = getLeftOffset( c2 );\r\n\t\t\t\tconst end = getRightEndOffset( c2 );\r\n\t\t\t\tconst count = end - offset;\r\n\r\n\t\t\t\tc2StopTraversal = iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, true, depth + 1, triangle );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tc2StopTraversal =\r\n\t\t\t\t\tc2Intersection &&\r\n\t\t\t\t\tshapecast(\r\n\t\t\t\t\t\tc2,\r\n\t\t\t\t\t\tmesh,\r\n\t\t\t\t\t\tintersectsBoundsFunc,\r\n\t\t\t\t\t\tintersectsTriangleFunc,\r\n\t\t\t\t\t\tnodeScoreFunc,\r\n\t\t\t\t\t\tdepth + 1,\r\n\t\t\t\t\t\ttriangle,\r\n\t\t\t\t\t\tcachedBox1,\r\n\t\t\t\t\t\tcachedBox2\r\n\t\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( c2StopTraversal ) return true;\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n} )();\r\n\r\nexport const intersectsGeometry = ( function () {\r\n\r\n\tconst triangle = new SeparatingAxisTriangle();\r\n\tconst triangle2 = new SeparatingAxisTriangle();\r\n\tconst cachedMesh = new Mesh();\r\n\tconst invertedMat = new Matrix4();\r\n\r\n\tconst obb = new OrientedBox();\r\n\tconst obb2 = new OrientedBox();\r\n\r\n\treturn function intersectsGeometry( node, mesh, geometry, geometryToBvh, cachedObb = null ) {\r\n\r\n\t\tif ( node.continueGeneration ) {\r\n\r\n\t\t\tnode.continueGeneration();\r\n\r\n\t\t}\r\n\r\n\t\tif ( cachedObb === null ) {\r\n\r\n\t\t\tif ( ! geometry.boundingBox ) {\r\n\r\n\t\t\t\tgeometry.computeBoundingBox();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobb.set( geometry.boundingBox.min, geometry.boundingBox.max, geometryToBvh );\r\n\t\t\tobb.update();\r\n\t\t\tcachedObb = obb;\r\n\r\n\t\t}\r\n\r\n\t\tconst isLeaf = ! ! node.count;\r\n\t\tif ( isLeaf ) {\r\n\r\n\t\t\tconst thisGeometry = mesh.geometry;\r\n\t\t\tconst thisIndex = thisGeometry.index;\r\n\t\t\tconst thisPos = thisGeometry.attributes.position;\r\n\r\n\t\t\tconst index = geometry.index;\r\n\t\t\tconst pos = geometry.attributes.position;\r\n\r\n\t\t\tconst offset = node.offset;\r\n\t\t\tconst count = node.count;\r\n\r\n\t\t\t// get the inverse of the geometry matrix so we can transform our triangles into the\r\n\t\t\t// geometry space we're trying to test. We assume there are fewer triangles being checked\r\n\t\t\t// here.\r\n\t\t\tinvertedMat.copy( geometryToBvh ).invert();\r\n\r\n\t\t\tif ( geometry.boundsTree ) {\r\n\r\n\t\t\t\tarrayToBox( node.boundingData, obb2 );\r\n\t\t\t\tobb2.matrix.copy( invertedMat );\r\n\t\t\t\tobb2.update();\r\n\r\n\t\t\t\tcachedMesh.geometry = geometry;\r\n\t\t\t\tconst res = geometry.boundsTree.shapecast( cachedMesh, box => obb2.intersectsBox( box ), function ( tri ) {\r\n\r\n\t\t\t\t\ttri.a.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.b.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.c.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.update();\r\n\r\n\t\t\t\t\tfor ( let i = offset * 3, l = ( count + offset ) * 3; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\t\t// this triangle needs to be transformed into the current BVH coordinate frame\r\n\t\t\t\t\t\tsetTriangle( triangle2, i, thisIndex, thisPos );\r\n\t\t\t\t\t\ttriangle2.update();\r\n\t\t\t\t\t\tif ( tri.intersectsTriangle( triangle2 ) ) {\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tcachedMesh.geometry = null;\r\n\r\n\t\t\t\treturn res;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor ( let i = offset * 3, l = ( count + offset * 3 ); i < l; i += 3 ) {\r\n\r\n\t\t\t\t\t// this triangle needs to be transformed into the current BVH coordinate frame\r\n\t\t\t\t\tsetTriangle( triangle, i, thisIndex, thisPos );\r\n\t\t\t\t\ttriangle.a.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.b.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.c.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.update();\r\n\r\n\t\t\t\t\tfor ( let i2 = 0, l2 = index.count; i2 < l2; i2 += 3 ) {\r\n\r\n\t\t\t\t\t\tsetTriangle( triangle2, i2, index, pos );\r\n\t\t\t\t\t\ttriangle2.update();\r\n\r\n\t\t\t\t\t\tif ( triangle.intersectsTriangle( triangle2 ) ) {\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst left = node.left;\r\n\t\t\tconst right = node.right;\r\n\r\n\t\t\tarrayToBox( left.boundingData, boundingBox );\r\n\t\t\tconst leftIntersection =\r\n\t\t\t\tcachedObb.intersectsBox( boundingBox ) &&\r\n\t\t\t\tintersectsGeometry( left, mesh, geometry, geometryToBvh, cachedObb );\r\n\r\n\t\t\tif ( leftIntersection ) return true;\r\n\r\n\r\n\t\t\tarrayToBox( right.boundingData, boundingBox );\r\n\t\t\tconst rightIntersection =\r\n\t\t\t\tcachedObb.intersectsBox( boundingBox ) &&\r\n\t\t\t\tintersectsGeometry( right, mesh, geometry, geometryToBvh, cachedObb );\r\n\r\n\t\t\tif ( rightIntersection ) return true;\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n} )();\r\n","\n/**************************************************************************************************\n *\n * This file is generated from castFunctions.js and scripts/generate-cast-function.mjs. Do not edit.\n *\n *************************************************************************************************/\n\nimport { Box3, Vector3, Mesh, Matrix4 } from 'three';\r\nimport { intersectTris, intersectClosestTri } from './Utils/RayIntersectTriUtlities.js';\n\nimport { OrientedBox } from './Utils/OrientedBox.js';\r\nimport { setTriangle } from './Utils/TriangleUtils.js';\r\nimport { SeparatingAxisTriangle } from './Utils/SeparatingAxisTriangle.js';\r\nimport { CONTAINED } from './Constants.js';\n\nconst boundingBox = new Box3();\r\nconst boxIntersection = new Vector3();\r\nconst xyzFields = [ 'x', 'y', 'z' ];\n\nexport function raycastBuffer( stride4Offset, mesh, raycaster, ray, intersects ) {\n\n\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\tconst isLeaf = ! /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff );\r\n\tif ( isLeaf ) {\n\n\t\tintersectTris( mesh, mesh.geometry, raycaster, ray, /* node offset */ uint32Array[ stride4Offset + 6 ], /* node count */ uint16Array[ stride2Offset + 14 ], intersects );\n\n\t} else {\n\n\t\tif ( intersectRayBuffer( /* node left */ stride4Offset + 8, float32Array, ray, boxIntersection ) ) {\n\n\t\t\traycastBuffer( /* node left */ stride4Offset + 8, mesh, raycaster, ray, intersects );\n\n\t\t}\n\n\t\tif ( intersectRayBuffer( /* node right */ uint32Array[ stride4Offset + 6 ], float32Array, ray, boxIntersection ) ) {\n\n\t\t\traycastBuffer( /* node right */ uint32Array[ stride4Offset + 6 ], mesh, raycaster, ray, intersects );\n\n\t\t}\n\n\t}\n\n}\n\nexport function raycastFirstBuffer( stride4Offset, mesh, raycaster, ray ) {\n\n\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\tconst isLeaf = ! /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff );\r\n\tif ( isLeaf ) {\n\n\t\treturn intersectClosestTri( mesh, mesh.geometry, raycaster, ray, /* node offset */ uint32Array[ stride4Offset + 6 ], /* node count */ uint16Array[ stride2Offset + 14 ] );\n\n\t} else {\n\n\t\t// consider the position of the split plane with respect to the oncoming ray; whichever direction\r\n\t\t// the ray is coming from, look for an intersection among that side of the tree first\r\n\t\tconst splitAxis = /* node splitAxis */ uint32Array[ stride4Offset + 7 ];\r\n\t\tconst xyzAxis = xyzFields[ splitAxis ];\r\n\t\tconst rayDir = ray.direction[ xyzAxis ];\r\n\t\tconst leftToRight = rayDir >= 0;\n\n\t\t// c1 is the child to check first\r\n\t\tlet c1, c2;\r\n\t\tif ( leftToRight ) {\n\n\t\t\tc1 = /* node left */ stride4Offset + 8;\r\n\t\t\tc2 = /* node right */ uint32Array[ stride4Offset + 6 ];\n\n\t\t} else {\n\n\t\t\tc1 = /* node right */ uint32Array[ stride4Offset + 6 ];\r\n\t\t\tc2 = /* node left */ stride4Offset + 8;\n\n\t\t}\n\n\t\tconst c1Intersection = intersectRayBuffer( c1, float32Array, ray, boxIntersection );\r\n\t\tconst c1Result = c1Intersection ? raycastFirstBuffer( c1, mesh, raycaster, ray ) : null;\n\n\t\t// if we got an intersection in the first node and it's closer than the second node's bounding\r\n\t\t// box, we don't need to consider the second node because it couldn't possibly be a better result\r\n\t\tif ( c1Result ) {\n\n\t\t\t// check if the point is within the second bounds\r\n\t\t\tconst point = c1Result.point[ xyzAxis ];\r\n\t\t\tconst isOutside = leftToRight ?\r\n\t\t\t\tpoint <= /* c2 boundingData */ float32Array[ c2 + splitAxis ] :\r\n\t\t\t\tpoint >= /* c2 boundingData */ float32Array[ c2 + splitAxis + 3 ];\n\n\t\t\tif ( isOutside ) {\n\n\t\t\t\treturn c1Result;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// either there was no intersection in the first node, or there could still be a closer\r\n\t\t// intersection in the second, so check the second node and then take the better of the two\r\n\t\tconst c2Intersection = intersectRayBuffer( c2, float32Array, ray, boxIntersection );\r\n\t\tconst c2Result = c2Intersection ? raycastFirstBuffer( c2, mesh, raycaster, ray ) : null;\n\n\t\tif ( c1Result && c2Result ) {\n\n\t\t\treturn c1Result.distance <= c2Result.distance ? c1Result : c2Result;\n\n\t\t} else {\n\n\t\t\treturn c1Result || c2Result || null;\n\n\t\t}\n\n\t}\n\n}\n\nexport const shapecastBuffer = ( function () {\n\n\tconst _triangle = new SeparatingAxisTriangle();\r\n\tconst _cachedBox1 = new Box3();\r\n\tconst _cachedBox2 = new Box3();\n\n\tfunction iterateOverTriangles(\r\n\t\toffset,\r\n\t\tcount,\r\n\t\tgeometry,\r\n\t\tintersectsTriangleFunc,\r\n\t\tcontained,\r\n\t\tdepth,\r\n\t\ttriangle\r\n\t) {\n\n\t\tconst index = geometry.index;\r\n\t\tconst pos = geometry.attributes.position;\r\n\t\tfor ( let i = offset * 3, l = ( count + offset ) * 3; i < l; i += 3 ) {\n\n\t\t\tsetTriangle( triangle, i, index, pos );\r\n\t\t\ttriangle.needsUpdate = true;\n\n\t\t\tif ( intersectsTriangleFunc( triangle, i, i + 1, i + 2, contained, depth ) ) {\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\treturn function shapecastBuffer( stride4Offset,\r\n\t\tmesh,\r\n\t\tintersectsBoundsFunc,\r\n\t\tintersectsTriangleFunc = null,\r\n\t\tnodeScoreFunc = null,\r\n\t\tdepth = 0,\r\n\t\ttriangle = _triangle,\r\n\t\tcachedBox1 = _cachedBox1,\r\n\t\tcachedBox2 = _cachedBox2\r\n\t) {\n\n\t\t// Define these inside the function so it has access to the local variables needed\r\n\t\t// when converting to the buffer equivalents\r\n\t\tfunction getLeftOffsetBuffer( stride4Offset ) {\n\n\t\t\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\t\t\twhile ( /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff ) ) {\n\n\t\t\t\t/* node */ stride4Offset = /* node left */ stride4Offset + 8, stride2Offset = stride4Offset * 2;\n\n\t\t\t}\n\n\t\t\treturn /* node offset */ uint32Array[ stride4Offset + 6 ];\n\n\t\t}\n\n\t\tfunction getRightEndOffsetBuffer( stride4Offset ) {\n\n\t\t\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\t\t\twhile ( /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff ) ) {\n\n\t\t\t\t/* node */ stride4Offset = /* node right */ uint32Array[ stride4Offset + 6 ], stride2Offset = stride4Offset * 2;\n\n\t\t\t}\n\n\t\t\treturn /* node offset */ uint32Array[ stride4Offset + 6 ] + /* node count */ uint16Array[ stride2Offset + 14 ];\n\n\t\t}\n\n\t\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\t\tconst isLeaf = ! /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff );\r\n\t\tif ( isLeaf && intersectsTriangleFunc ) {\n\n\t\t\tconst geometry = mesh.geometry;\r\n\t\t\tconst offset = /* node offset */ uint32Array[ stride4Offset + 6 ];\r\n\t\t\tconst count = /* node count */ uint16Array[ stride2Offset + 14 ];\r\n\t\t\treturn iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, false, depth, triangle );\n\n\t\t} else {\n\n\t\t\tconst left = /* node left */ stride4Offset + 8;\r\n\t\t\tconst right = /* node right */ uint32Array[ stride4Offset + 6 ];\r\n\t\t\tlet c1 = left;\r\n\t\t\tlet c2 = right;\n\n\t\t\tlet score1, score2;\r\n\t\t\tlet box1, box2;\r\n\t\t\tif ( nodeScoreFunc ) {\n\n\t\t\t\tbox1 = cachedBox1;\r\n\t\t\t\tbox2 = cachedBox2;\n\n\t\t\t\tarrayToBoxBuffer( /* c1 boundingData */ c1, float32Array, box1 );\r\n\t\t\t\tarrayToBoxBuffer( /* c2 boundingData */ c2, float32Array, box2 );\n\n\t\t\t\tscore1 = nodeScoreFunc( box1 );\r\n\t\t\t\tscore2 = nodeScoreFunc( box2 );\n\n\t\t\t\tif ( score2 < score1 ) {\n\n\t\t\t\t\tc1 = right;\r\n\t\t\t\t\tc2 = left;\n\n\t\t\t\t\tconst temp = score1;\r\n\t\t\t\t\tscore1 = score2;\r\n\t\t\t\t\tscore2 = temp;\n\n\t\t\t\t\tbox1 = box2;\r\n\t\t\t\t\t// box2 is always set before use below\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Check box 1 intersection\r\n\t\t\tif ( ! box1 ) {\n\n\t\t\t\tbox1 = cachedBox1;\r\n\t\t\t\tarrayToBoxBuffer( /* c1 boundingData */ c1, float32Array, box1 );\n\n\t\t\t}\n\n\t\t\tconst isC1Leaf = ! /* c1 count */ ( uint16Array[ c1 + 15 ] !== 0xffff );\r\n\t\t\tconst c1Intersection = intersectsBoundsFunc( box1, isC1Leaf, score1, depth + 1 );\n\n\t\t\tlet c1StopTraversal;\r\n\t\t\tif ( c1Intersection === CONTAINED ) {\n\n\t\t\t\tconst geometry = mesh.geometry;\r\n\t\t\t\tconst offset = getLeftOffsetBuffer( c1 );\r\n\t\t\t\tconst end = getRightEndOffsetBuffer( c1 );\r\n\t\t\t\tconst count = end - offset;\n\n\t\t\t\tc1StopTraversal = iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, true, depth + 1, triangle );\n\n\t\t\t} else {\n\n\t\t\t\tc1StopTraversal =\r\n\t\t\t\t\tc1Intersection &&\r\n\t\t\t\t\tshapecastBuffer(\r\n\t\t\t\t\t\tc1,\r\n\t\t\t\t\t\tmesh,\r\n\t\t\t\t\t\tintersectsBoundsFunc,\r\n\t\t\t\t\t\tintersectsTriangleFunc,\r\n\t\t\t\t\t\tnodeScoreFunc,\r\n\t\t\t\t\t\tdepth + 1,\r\n\t\t\t\t\t\ttriangle,\r\n\t\t\t\t\t\tcachedBox1,\r\n\t\t\t\t\t\tcachedBox2\r\n\t\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( c1StopTraversal ) return true;\n\n\t\t\t// Check box 2 intersection\r\n\t\t\t// cached box2 will have been overwritten by previous traversal\r\n\t\t\tbox2 = cachedBox2;\r\n\t\t\tarrayToBoxBuffer( /* c2 boundingData */ c2, float32Array, box2 );\n\n\t\t\tconst isC2Leaf = ! /* c2 count */ ( uint16Array[ c2 + 15 ] !== 0xffff );\r\n\t\t\tconst c2Intersection = intersectsBoundsFunc( box2, isC2Leaf, score2, depth + 1 );\n\n\t\t\tlet c2StopTraversal;\r\n\t\t\tif ( c2Intersection === CONTAINED ) {\n\n\t\t\t\tconst geometry = mesh.geometry;\r\n\t\t\t\tconst offset = getLeftOffsetBuffer( c2 );\r\n\t\t\t\tconst end = getRightEndOffsetBuffer( c2 );\r\n\t\t\t\tconst count = end - offset;\n\n\t\t\t\tc2StopTraversal = iterateOverTriangles( offset, count, geometry, intersectsTriangleFunc, true, depth + 1, triangle );\n\n\t\t\t} else {\n\n\t\t\t\tc2StopTraversal =\r\n\t\t\t\t\tc2Intersection &&\r\n\t\t\t\t\tshapecastBuffer(\r\n\t\t\t\t\t\tc2,\r\n\t\t\t\t\t\tmesh,\r\n\t\t\t\t\t\tintersectsBoundsFunc,\r\n\t\t\t\t\t\tintersectsTriangleFunc,\r\n\t\t\t\t\t\tnodeScoreFunc,\r\n\t\t\t\t\t\tdepth + 1,\r\n\t\t\t\t\t\ttriangle,\r\n\t\t\t\t\t\tcachedBox1,\r\n\t\t\t\t\t\tcachedBox2\r\n\t\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( c2StopTraversal ) return true;\n\n\t\t\treturn false;\n\n\t\t}\n\n\t};\n\n} )();\n\nexport const intersectsGeometryBuffer = ( function () {\n\n\tconst triangle = new SeparatingAxisTriangle();\r\n\tconst triangle2 = new SeparatingAxisTriangle();\r\n\tconst cachedMesh = new Mesh();\r\n\tconst invertedMat = new Matrix4();\n\n\tconst obb = new OrientedBox();\r\n\tconst obb2 = new OrientedBox();\n\n\treturn function intersectsGeometryBuffer( stride4Offset, mesh, geometry, geometryToBvh, cachedObb = null ) {\n\n\t\tlet stride2Offset = stride4Offset * 2, float32Array = _float32Array, uint16Array = _uint16Array, uint32Array = _uint32Array;\n\n\t\tif ( cachedObb === null ) {\n\n\t\t\tif ( ! geometry.boundingBox ) {\n\n\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tobb.set( geometry.boundingBox.min, geometry.boundingBox.max, geometryToBvh );\r\n\t\t\tobb.update();\r\n\t\t\tcachedObb = obb;\n\n\t\t}\n\n\t\tconst isLeaf = ! /* node count */ ( uint16Array[ stride2Offset + 15 ] !== 0xffff );\r\n\t\tif ( isLeaf ) {\n\n\t\t\tconst thisGeometry = mesh.geometry;\r\n\t\t\tconst thisIndex = thisGeometry.index;\r\n\t\t\tconst thisPos = thisGeometry.attributes.position;\n\n\t\t\tconst index = geometry.index;\r\n\t\t\tconst pos = geometry.attributes.position;\n\n\t\t\tconst offset = /* node offset */ uint32Array[ stride4Offset + 6 ];\r\n\t\t\tconst count = /* node count */ uint16Array[ stride2Offset + 14 ];\n\n\t\t\t// get the inverse of the geometry matrix so we can transform our triangles into the\r\n\t\t\t// geometry space we're trying to test. We assume there are fewer triangles being checked\r\n\t\t\t// here.\r\n\t\t\tinvertedMat.copy( geometryToBvh ).invert();\n\n\t\t\tif ( geometry.boundsTree ) {\n\n\t\t\t\tarrayToBoxBuffer( /* node boundingData */ stride4Offset, float32Array, obb2 );\r\n\t\t\t\tobb2.matrix.copy( invertedMat );\r\n\t\t\t\tobb2.update();\n\n\t\t\t\tcachedMesh.geometry = geometry;\r\n\t\t\t\tconst res = geometry.boundsTree.shapecast( cachedMesh, box => obb2.intersectsBox( box ), function ( tri ) {\n\n\t\t\t\t\ttri.a.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.b.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.c.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri.update();\n\n\t\t\t\t\tfor ( let i = offset * 3, l = ( count + offset ) * 3; i < l; i += 3 ) {\n\n\t\t\t\t\t\t// this triangle needs to be transformed into the current BVH coordinate frame\r\n\t\t\t\t\t\tsetTriangle( triangle2, i, thisIndex, thisPos );\r\n\t\t\t\t\t\ttriangle2.update();\r\n\t\t\t\t\t\tif ( tri.intersectsTriangle( triangle2 ) ) {\n\n\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t} );\r\n\t\t\t\tcachedMesh.geometry = null;\n\n\t\t\t\treturn res;\n\n\t\t\t} else {\n\n\t\t\t\tfor ( let i = offset * 3, l = ( count + offset * 3 ); i < l; i += 3 ) {\n\n\t\t\t\t\t// this triangle needs to be transformed into the current BVH coordinate frame\r\n\t\t\t\t\tsetTriangle( triangle, i, thisIndex, thisPos );\r\n\t\t\t\t\ttriangle.a.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.b.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.c.applyMatrix4( invertedMat );\r\n\t\t\t\t\ttriangle.update();\n\n\t\t\t\t\tfor ( let i2 = 0, l2 = index.count; i2 < l2; i2 += 3 ) {\n\n\t\t\t\t\t\tsetTriangle( triangle2, i2, index, pos );\r\n\t\t\t\t\t\ttriangle2.update();\n\n\t\t\t\t\t\tif ( triangle.intersectsTriangle( triangle2 ) ) {\n\n\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst left = /* node left */ stride4Offset + 8;\r\n\t\t\tconst right = /* node right */ uint32Array[ stride4Offset + 6 ];\n\n\t\t\tarrayToBoxBuffer( /* left boundingData */ left, float32Array, boundingBox );\r\n\t\t\tconst leftIntersection =\r\n\t\t\t\tcachedObb.intersectsBox( boundingBox ) &&\r\n\t\t\t\tintersectsGeometryBuffer( left, mesh, geometry, geometryToBvh, cachedObb );\n\n\t\t\tif ( leftIntersection ) return true;\n\n\t\t\tarrayToBoxBuffer( /* right boundingData */ right, float32Array, boundingBox );\r\n\t\t\tconst rightIntersection =\r\n\t\t\t\tcachedObb.intersectsBox( boundingBox ) &&\r\n\t\t\t\tintersectsGeometryBuffer( right, mesh, geometry, geometryToBvh, cachedObb );\n\n\t\t\tif ( rightIntersection ) return true;\n\n\t\t\treturn false;\n\n\t\t}\n\n\t};\n\n} )();\n\nfunction intersectRayBuffer( stride4Offset, array, ray, target ) {\n\n\tarrayToBoxBuffer( stride4Offset, array, boundingBox );\n\treturn ray.intersectBox( boundingBox, target );\n\n}\n\nconst bufferStack = [];\nlet _prevBuffer;\nlet _float32Array;\nlet _uint16Array;\nlet _uint32Array;\nexport function setBuffer( buffer ) {\n\n\tif ( _prevBuffer ) {\n\n\t\tbufferStack.push( _prevBuffer );\n\n\t}\n\n\t_prevBuffer = buffer;\n\t_float32Array = new Float32Array( buffer );\n\t_uint16Array = new Uint16Array( buffer );\n\t_uint32Array = new Uint32Array( buffer );\n\n}\n\nexport function clearBuffer() {\n\n\t_prevBuffer = null;\n\t_float32Array = null;\n\t_uint16Array = null;\n\t_uint32Array = null;\n\n\tif ( bufferStack.length ) {\n\n\t\tsetBuffer( bufferStack.pop() );\n\n\t}\n\n}\n\nfunction arrayToBoxBuffer( stride4Offset, array, target ) {\n\n\ttarget.min.x = array[ stride4Offset ];\n\ttarget.min.y = array[ stride4Offset + 1 ];\n\ttarget.min.z = array[ stride4Offset + 2 ];\n\n\ttarget.max.x = array[ stride4Offset + 3 ];\n\ttarget.max.y = array[ stride4Offset + 4 ];\n\ttarget.max.z = array[ stride4Offset + 5 ];\n\n}\n","import { Vector3, BufferAttribute } from 'three';\r\nimport { CENTER } from './Constants.js';\r\nimport { buildTree } from './buildFunctions.js';\r\nimport { OrientedBox } from './Utils/OrientedBox.js';\r\nimport { SeparatingAxisTriangle } from './Utils/SeparatingAxisTriangle.js';\r\nimport { setTriangle } from './Utils/TriangleUtils.js';\r\nimport {\r\n\traycast,\r\n\traycastFirst,\r\n\tshapecast,\r\n\tintersectsGeometry,\r\n} from './castFunctions.js';\r\n\r\nimport {\r\n\traycastBuffer,\r\n\traycastFirstBuffer,\r\n\tshapecastBuffer,\r\n\tintersectsGeometryBuffer,\r\n\tsetBuffer,\r\n\tclearBuffer,\r\n} from './castFunctionsBuffer.js';\r\n\r\n// boundingData  \t\t\t\t: 6 float32\r\n// right / offset \t\t\t\t: 1 uint32\r\n// splitAxis / isLeaf + count \t: 1 uint32 / 2 uint16\r\nconst BYTES_PER_NODE = 6 * 4 + 4 + 4;\r\nconst IS_LEAFNODE_FLAG = 0xFFFF;\r\nconst SKIP_GENERATION = Symbol( 'skip tree generation' );\r\n\r\nconst obb = new OrientedBox();\r\nconst temp = new Vector3();\r\nconst tri2 = new SeparatingAxisTriangle();\r\nconst temp1 = new Vector3();\r\nconst temp2 = new Vector3();\r\n\r\nexport default class MeshBVH {\r\n\r\n\tstatic serialize( bvh, geometry, copyIndexBuffer = true ) {\r\n\r\n\t\tfunction finishTree( node ) {\r\n\r\n\t\t\tif ( node.continueGeneration ) {\r\n\r\n\t\t\t\tnode.continueGeneration();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! node.count ) {\r\n\r\n\t\t\t\tfinishTree( node.left );\r\n\t\t\t\tfinishTree( node.right );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction countNodes( node ) {\r\n\r\n\t\t\tif ( node.count ) {\r\n\r\n\t\t\t\treturn 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn 1 + countNodes( node.left ) + countNodes( node.right );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction populateBuffer( byteOffset, node ) {\r\n\r\n\t\t\tconst stride4Offset = byteOffset / 4;\r\n\t\t\tconst stride2Offset = byteOffset / 2;\r\n\t\t\tconst isLeaf = ! ! node.count;\r\n\t\t\tconst boundingData = node.boundingData;\r\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tfloat32Array[ stride4Offset + i ] = boundingData[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isLeaf ) {\r\n\r\n\t\t\t\tconst offset = node.offset;\r\n\t\t\t\tconst count = node.count;\r\n\t\t\t\tuint32Array[ stride4Offset + 6 ] = offset;\r\n\t\t\t\tuint16Array[ stride2Offset + 14 ] = count;\r\n\t\t\t\tuint16Array[ stride2Offset + 15 ] = IS_LEAFNODE_FLAG;\r\n\t\t\t\treturn byteOffset + BYTES_PER_NODE;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst left = node.left;\r\n\t\t\t\tconst right = node.right;\r\n\t\t\t\tconst splitAxis = node.splitAxis;\r\n\r\n\t\t\t\tlet nextUnusedPointer;\r\n\t\t\t\tnextUnusedPointer = populateBuffer( byteOffset + BYTES_PER_NODE, left );\r\n\r\n\t\t\t\tuint32Array[ stride4Offset + 6 ] = nextUnusedPointer / 4;\r\n\t\t\t\tnextUnusedPointer = populateBuffer( nextUnusedPointer, right );\r\n\r\n\t\t\t\tuint32Array[ stride4Offset + 7 ] = splitAxis;\r\n\t\t\t\treturn nextUnusedPointer;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tlet float32Array;\r\n\t\tlet uint32Array;\r\n\t\tlet uint16Array;\r\n\r\n\t\tconst roots = bvh._roots;\r\n\t\tlet rootData;\r\n\r\n\t\tif ( bvh._isPacked ) {\r\n\r\n\t\t\trootData = roots;\r\n\r\n\t\t} else {\r\n\r\n\t\t\trootData = [];\r\n\t\t\tfor ( let i = 0; i < roots.length; i ++ ) {\r\n\r\n\t\t\t\tconst root = roots[ i ];\r\n\t\t\t\tfinishTree( root );\r\n\t\t\t\tlet nodeCount = countNodes( root );\r\n\r\n\t\t\t\tconst buffer = new ArrayBuffer( BYTES_PER_NODE * nodeCount );\r\n\t\t\t\tfloat32Array = new Float32Array( buffer );\r\n\t\t\t\tuint32Array = new Uint32Array( buffer );\r\n\t\t\t\tuint16Array = new Uint16Array( buffer );\r\n\t\t\t\tpopulateBuffer( 0, root );\r\n\t\t\t\trootData.push( buffer );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tconst indexAttribute = geometry.getIndex();\r\n\t\tconst result = {\r\n\t\t\troots: rootData,\r\n\t\t\tindex: copyIndexBuffer ? indexAttribute.array.slice() : indexAttribute.array,\r\n\t\t};\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\tstatic deserialize( data, geometry, setIndex = true ) {\r\n\r\n\t\tconst { index, roots } = data;\r\n\t\tconst bvh = new MeshBVH( geometry, { [ SKIP_GENERATION ]: true } );\r\n\t\tbvh._roots = roots;\r\n\t\tbvh._isPacked = true;\r\n\r\n\t\tif ( setIndex ) {\r\n\r\n\t\t\tconst indexAttribute = geometry.getIndex();\r\n\t\t\tif ( indexAttribute === null ) {\r\n\r\n\t\t\t\tconst newIndex = new BufferAttribute( data.index, 1, false );\r\n\t\t\t\tgeometry.setIndex( newIndex );\r\n\r\n\t\t\t} else if ( indexAttribute.array !== index ) {\r\n\r\n\t\t\t\tindexAttribute.array.set( index );\r\n\t\t\t\tindexAttribute.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn bvh;\r\n\r\n\t}\r\n\r\n\tconstructor( geo, options = {} ) {\r\n\r\n\t\tif ( ! geo.isBufferGeometry ) {\r\n\r\n\t\t\tthrow new Error( 'MeshBVH: Only BufferGeometries are supported.' );\r\n\r\n\t\t} else if ( geo.attributes.position.isInterleavedBufferAttribute ) {\r\n\r\n\t\t\tthrow new Error( 'MeshBVH: InterleavedBufferAttribute is not supported for the position attribute.' );\r\n\r\n\t\t} else if ( geo.index && geo.index.isInterleavedBufferAttribute ) {\r\n\r\n\t\t\tthrow new Error( 'MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.' );\r\n\r\n\t\t}\r\n\r\n\t\t// default options\r\n\t\toptions = Object.assign( {\r\n\r\n\t\t\tstrategy: CENTER,\r\n\t\t\tmaxDepth: 40,\r\n\t\t\tmaxLeafTris: 10,\r\n\t\t\tverbose: true,\r\n\t\t\tlazyGeneration: true,\r\n\r\n\t\t\t// undocumented options\r\n\r\n\t\t\t// whether to the pack the data as a buffer or not. The data\r\n\t\t\t// will not be packed if lazyGeneration is true.\r\n\t\t\tpackData: true,\r\n\r\n\t\t\t// Whether to skip generating the tree. Used for deserialization.\r\n\t\t\t[ SKIP_GENERATION ]: false\r\n\r\n\t\t}, options );\r\n\t\toptions.strategy = Math.max( 0, Math.min( 2, options.strategy ) );\r\n\r\n\t\tthis._isPacked = false;\r\n\t\tthis._roots = null;\r\n\t\tif ( ! options[ SKIP_GENERATION ] ) {\r\n\r\n\t\t\tthis._roots = buildTree( geo, options );\r\n\t\t\tif ( ! options.lazyGeneration && options.packData ) {\r\n\r\n\t\t\t\tthis._roots = MeshBVH.serialize( this, geo, false ).roots;\r\n\t\t\t\tthis._isPacked = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\ttraverse( callback, rootIndex = 0 ) {\r\n\r\n\t\tif ( this._isPacked ) {\r\n\r\n\t\t\tconst buffer = this._roots[ rootIndex ];\r\n\t\t\tconst uint32Array = new Uint32Array( buffer );\r\n\t\t\tconst uint16Array = new Uint16Array( buffer );\r\n\t\t\t_traverseBuffer( 0 );\r\n\r\n\t\t\tfunction _traverseBuffer( stride4Offset, depth = 0 ) {\r\n\r\n\t\t\t\tconst stride2Offset = stride4Offset * 2;\r\n\t\t\t\tconst isLeaf = uint16Array[ stride2Offset + 15 ];\r\n\t\t\t\tif ( isLeaf ) {\r\n\r\n\t\t\t\t\tconst offset = uint32Array[ stride4Offset + 6 ];\r\n\t\t\t\t\tconst count = uint16Array[ stride2Offset + 14 ];\r\n\t\t\t\t\tcallback( depth, isLeaf, new Float32Array( buffer, stride4Offset * 4, 6 ), offset, count );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconst left = stride4Offset + BYTES_PER_NODE / 4;\r\n\t\t\t\t\tconst right = uint32Array[ stride4Offset + 6 ];\r\n\t\t\t\t\tconst splitAxis = uint32Array[ stride4Offset + 7 ];\r\n\t\t\t\t\tconst stopTraversal = callback( depth, isLeaf, new Float32Array( buffer, stride4Offset * 4, 6 ), splitAxis, false );\r\n\r\n\t\t\t\t\tif ( ! stopTraversal ) {\r\n\r\n\t\t\t\t\t\t_traverseBuffer( left, depth + 1 );\r\n\t\t\t\t\t\t_traverseBuffer( right, depth + 1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_traverseNode( this._roots[ rootIndex ] );\r\n\r\n\t\t\tfunction _traverseNode( node, depth = 0 ) {\r\n\r\n\t\t\t\tconst isLeaf = ! ! node.count;\r\n\t\t\t\tif ( isLeaf ) {\r\n\r\n\t\t\t\t\tcallback( depth, isLeaf, node.boundingData, node.offset, node.count );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconst stopTraversal = callback( depth, isLeaf, node.boundingData, node.splitAxis, ! ! node.continueGeneration );\r\n\r\n\t\t\t\t\tif ( ! stopTraversal ) {\r\n\r\n\t\t\t\t\t\tif ( node.left ) _traverseNode( node.left, depth + 1 );\r\n\t\t\t\t\t\tif ( node.right ) _traverseNode( node.right, depth + 1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/* Core Cast Functions */\r\n\traycast( mesh, raycaster, ray, intersects ) {\r\n\r\n\t\tconst isPacked = this._isPacked;\r\n\t\tfor ( const root of this._roots ) {\r\n\r\n\t\t\tif ( isPacked ) {\r\n\r\n\t\t\t\tsetBuffer( root );\r\n\t\t\t\traycastBuffer( 0, mesh, raycaster, ray, intersects );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\traycast( root, mesh, raycaster, ray, intersects );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisPacked && clearBuffer();\r\n\r\n\t}\r\n\r\n\traycastFirst( mesh, raycaster, ray ) {\r\n\r\n\t\tconst isPacked = this._isPacked;\r\n\t\tlet closestResult = null;\r\n\t\tfor ( const root of this._roots ) {\r\n\r\n\t\t\tlet result;\r\n\t\t\tif ( isPacked ) {\r\n\r\n\t\t\t\tsetBuffer( root );\r\n\t\t\t\tresult = raycastFirstBuffer( 0, mesh, raycaster, ray );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult = raycastFirst( root, mesh, raycaster, ray );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( result != null && ( closestResult == null || result.distance < closestResult.distance ) ) {\r\n\r\n\t\t\t\tclosestResult = result;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisPacked && clearBuffer();\r\n\r\n\t\treturn closestResult;\r\n\r\n\t}\r\n\r\n\tintersectsGeometry( mesh, geometry, geomToMesh ) {\r\n\r\n\t\tconst isPacked = this._isPacked;\r\n\t\tlet result = false;\r\n\t\tfor ( const root of this._roots ) {\r\n\r\n\t\t\tif ( isPacked ) {\r\n\r\n\t\t\t\tsetBuffer( root );\r\n\t\t\t\tresult = intersectsGeometryBuffer( 0, mesh, geometry, geomToMesh );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult = intersectsGeometry( root, mesh, geometry, geomToMesh );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( result ) {\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisPacked && clearBuffer();\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\tshapecast( mesh, intersectsBoundsFunc, intersectsTriangleFunc = null, orderNodesFunc = null ) {\r\n\r\n\t\tconst isPacked = this._isPacked;\r\n\t\tlet result = false;\r\n\t\tfor ( const root of this._roots ) {\r\n\r\n\t\t\tif ( isPacked ) {\r\n\r\n\t\t\t\tsetBuffer( root );\r\n\t\t\t\tresult = shapecastBuffer( 0, mesh, intersectsBoundsFunc, intersectsTriangleFunc, orderNodesFunc );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult = shapecast( root, mesh, intersectsBoundsFunc, intersectsTriangleFunc, orderNodesFunc );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( result ) {\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tisPacked && clearBuffer();\r\n\r\n\t\treturn result;\r\n\r\n\t}\r\n\r\n\t/* Derived Cast Functions */\r\n\tintersectsBox( mesh, box, boxToMesh ) {\r\n\r\n\t\tobb.set( box.min, box.max, boxToMesh );\r\n\t\tobb.update();\r\n\r\n\t\treturn this.shapecast(\r\n\t\t\tmesh,\r\n\t\t\tbox => obb.intersectsBox( box ),\r\n\t\t\ttri => obb.intersectsTriangle( tri )\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tintersectsSphere( mesh, sphere ) {\r\n\r\n\t\treturn this.shapecast(\r\n\t\t\tmesh,\r\n\t\t\tbox => sphere.intersectsBox( box ),\r\n\t\t\ttri => tri.intersectsSphere( sphere )\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tclosestPointToGeometry( mesh, geom, geometryToBvh, target1 = null, target2 = null, minThreshold = 0, maxThreshold = Infinity ) {\r\n\r\n\t\tif ( ! geom.boundingBox ) {\r\n\r\n\t\t\tgeom.computeBoundingBox();\r\n\r\n\t\t}\r\n\r\n\t\tobb.set( geom.boundingBox.min, geom.boundingBox.max, geometryToBvh );\r\n\t\tobb.update();\r\n\r\n\t\tconst pos = geom.attributes.position;\r\n\t\tconst index = geom.index;\r\n\r\n\t\tlet tempTarget1 = null;\r\n\t\tlet tempTarget2 = null;\r\n\t\tif ( target1 ) {\r\n\r\n\t\t\ttempTarget1 = temp1;\r\n\r\n\t\t}\r\n\r\n\t\tif ( target2 ) {\r\n\r\n\t\t\ttempTarget2 = temp2;\r\n\r\n\t\t}\r\n\r\n\t\tlet closestDistance = Infinity;\r\n\t\tthis.shapecast(\r\n\t\t\tmesh,\r\n\t\t\t( box, isLeaf, score ) => score < closestDistance && score < maxThreshold,\r\n\t\t\ttri => {\r\n\r\n\t\t\t\tif ( tri.needsUpdate ) {\r\n\r\n\t\t\t\t\ttri.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst sphere1 = tri.sphere;\r\n\t\t\t\tfor ( let i2 = 0, l2 = index.count; i2 < l2; i2 += 3 ) {\r\n\r\n\t\t\t\t\tsetTriangle( tri2, i2, index, pos );\r\n\t\t\t\t\ttri2.a.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri2.b.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri2.c.applyMatrix4( geometryToBvh );\r\n\t\t\t\t\ttri2.sphere.setFromPoints( tri2.points );\r\n\r\n\t\t\t\t\tconst sphere2 = tri2.sphere;\r\n\t\t\t\t\tconst sphereDist = sphere2.center.distanceTo( sphere1.center ) - sphere2.radius - sphere1.radius;\r\n\t\t\t\t\tif ( sphereDist > closestDistance ) {\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttri2.update();\r\n\r\n\t\t\t\t\tconst dist = tri.distanceToTriangle( tri2, tempTarget1, tempTarget2 );\r\n\t\t\t\t\tif ( dist < closestDistance ) {\r\n\r\n\t\t\t\t\t\tif ( target1 ) {\r\n\r\n\t\t\t\t\t\t\ttarget1.copy( tempTarget1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( target2 ) {\r\n\r\n\t\t\t\t\t\t\ttarget2.copy( tempTarget2 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tclosestDistance = dist;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// stop traversal if we find a point that's under the given threshold\r\n\t\t\t\t\tif ( dist < minThreshold ) {\r\n\r\n\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\tbox => obb.distanceToBox( box, Math.min( closestDistance, maxThreshold ) )\r\n\r\n\t\t);\r\n\r\n\t\treturn closestDistance;\r\n\r\n\t}\r\n\r\n\tdistanceToGeometry( mesh, geom, matrix, minThreshold, maxThreshold ) {\r\n\r\n\t\treturn this.closestPointToGeometry( mesh, geom, matrix, null, null, minThreshold, maxThreshold );\r\n\r\n\t}\r\n\r\n\tclosestPointToPoint( mesh, point, target, minThreshold = 0, maxThreshold = Infinity ) {\r\n\r\n\t\t// early out if under minThreshold\r\n\t\t// skip checking if over maxThreshold\r\n\t\t// set minThreshold = maxThreshold to quickly check if a point is within a threshold\r\n\t\t// returns Infinity if no value found\r\n\t\tlet closestDistance = Infinity;\r\n\t\tthis.shapecast(\r\n\r\n\t\t\tmesh,\r\n\t\t\t( box, isLeaf, score ) => score < closestDistance && score < maxThreshold,\r\n\t\t\ttri => {\r\n\r\n\t\t\t\ttri.closestPointToPoint( point, temp );\r\n\t\t\t\tconst dist = point.distanceTo( temp );\r\n\t\t\t\tif ( dist < closestDistance ) {\r\n\r\n\t\t\t\t\tif ( target ) {\r\n\r\n\t\t\t\t\t\ttarget.copy( temp );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tclosestDistance = dist;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( dist < minThreshold ) {\r\n\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tbox => box.distanceToPoint( point )\r\n\r\n\t\t);\r\n\r\n\t\treturn closestDistance;\r\n\r\n\t}\r\n\r\n\tdistanceToPoint( mesh, point, minThreshold, maxThreshold ) {\r\n\r\n\t\treturn this.closestPointToPoint( mesh, point, null, minThreshold, maxThreshold );\r\n\r\n\t}\r\n\r\n}\r\n","import { LineBasicMaterial, Box3Helper, Box3, Group, LineSegments } from 'three';\r\nimport { arrayToBox } from './Utils/ArrayBoxUtilities.js';\r\n\r\nconst wiremat = new LineBasicMaterial( { color: 0x00FF88, transparent: true, opacity: 0.3 } );\r\nconst boxGeom = new Box3Helper().geometry;\r\nlet boundingBox = new Box3();\r\n\r\nclass MeshBVHRootVisualizer extends Group {\r\n\r\n\tconstructor( mesh, depth = 10, group = 0 ) {\r\n\r\n\t\tsuper( 'MeshBVHRootVisualizer' );\r\n\r\n\t\tthis.depth = depth;\r\n\t\tthis._oldDepth = - 1;\r\n\t\tthis.mesh = mesh;\r\n\t\tthis._boundsTree = null;\r\n\t\tthis._group = group;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tupdate() {\r\n\r\n\t\tthis._oldDepth = this.depth;\r\n\t\tthis._boundsTree = this.mesh.geometry.boundsTree;\r\n\r\n\t\tlet requiredChildren = 0;\r\n\t\tif ( this._boundsTree ) {\r\n\r\n\t\t\tthis._boundsTree.traverse( ( depth, isLeaf, boundingData, offsetOrSplit, countOrIsUnfinished ) => {\r\n\r\n\t\t\t\tlet isTerminal = isLeaf || countOrIsUnfinished;\r\n\r\n\t\t\t\t// Stop traversal\r\n\t\t\t\tif ( depth >= this.depth ) {\r\n\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( depth === this.depth - 1 || isTerminal ) {\r\n\r\n\t\t\t\t\tlet m = requiredChildren < this.children.length ? this.children[ requiredChildren ] : null;\r\n\t\t\t\t\tif ( ! m ) {\r\n\r\n\t\t\t\t\t\tm = new LineSegments( boxGeom, wiremat );\r\n\t\t\t\t\t\tm.raycast = () => [];\r\n\t\t\t\t\t\tthis.add( m );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trequiredChildren ++;\r\n\t\t\t\t\tarrayToBox( boundingData, boundingBox );\r\n\t\t\t\t\tboundingBox.getCenter( m.position );\r\n\t\t\t\t\tm.scale.subVectors( boundingBox.max, boundingBox.min ).multiplyScalar( 0.5 );\r\n\r\n\t\t\t\t\tif ( m.scale.x === 0 ) m.scale.x = Number.EPSILON;\r\n\t\t\t\t\tif ( m.scale.y === 0 ) m.scale.y = Number.EPSILON;\r\n\t\t\t\t\tif ( m.scale.z === 0 ) m.scale.z = Number.EPSILON;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\twhile ( this.children.length > requiredChildren ) this.remove( this.children.pop() );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass MeshBVHVisualizer extends Group {\r\n\r\n\tconstructor( mesh, depth = 10 ) {\r\n\r\n\t\tsuper( 'MeshBVHVisualizer' );\r\n\r\n\t\tthis.depth = depth;\r\n\t\tthis.mesh = mesh;\r\n\t\tthis._roots = [];\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tupdate() {\r\n\r\n\t\tconst bvh = this.mesh.geometry.boundsTree;\r\n\t\tconst totalRoots = bvh ? bvh._roots.length : 0;\r\n\t\twhile ( this._roots.length > totalRoots ) {\r\n\r\n\t\t\tthis._roots.pop();\r\n\r\n\t\t}\r\n\r\n\t\tfor ( let i = 0; i < totalRoots; i ++ ) {\r\n\r\n\t\t\tif ( i >= this._roots.length ) {\r\n\r\n\t\t\t\tconst root = new MeshBVHRootVisualizer( this.mesh, this.depth, i );\r\n\t\t\t\tthis.add( root );\r\n\t\t\t\tthis._roots.push( root );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlet root = this._roots[ i ];\r\n\t\t\t\troot.depth = this.depth;\r\n\t\t\t\troot.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tupdateMatrixWorld( ...args ) {\r\n\r\n\t\tthis.position.copy( this.mesh.position );\r\n\t\tthis.rotation.copy( this.mesh.rotation );\r\n\t\tthis.scale.copy( this.mesh.scale );\r\n\r\n\t\tsuper.updateMatrixWorld( ...args );\r\n\r\n\t}\r\n\r\n\tcopy( source ) {\r\n\r\n\t\tthis.depth = source.depth;\r\n\t\tthis.mesh = source.mesh;\r\n\r\n\t}\r\n\r\n\tclone() {\r\n\r\n\t\treturn new MeshBVHVisualizer( this.mesh, this.depth );\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\nexport default MeshBVHVisualizer;\r\n","import { Box3, Vector3 } from 'three';\r\nimport { arrayToBox } from './Utils/ArrayBoxUtilities.js';\r\nconst box1 = new Box3();\r\nconst box2 = new Box3();\r\nconst vec = new Vector3();\r\n\r\nexport class MeshBVHDebug {\r\n\r\n\tconstructor( bvh, geometry ) {\r\n\r\n\t\tthis.bvh = bvh;\r\n\t\tthis.geometry = geometry;\r\n\r\n\t}\r\n\r\n\t// Returns a simple, human readable object that represents the BVH.\r\n\tgetJSONStructure() {\r\n\r\n\t\tconst { bvh } = this;\r\n\t\tconst depthStack = [];\r\n\r\n\t\tbvh.traverse( ( depth, isLeaf, boundingData, offset, count ) => {\r\n\r\n\t\t\tconst info = {\r\n\t\t\t\tbounds: arrayToBox( boundingData, new Box3() ),\r\n\t\t\t};\r\n\r\n\t\t\tif ( isLeaf ) {\r\n\r\n\t\t\t\tinfo.count = count;\r\n\t\t\t\tinfo.offset = offset;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tinfo.left = null;\r\n\t\t\t\tinfo.right = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdepthStack[ depth ] = info;\r\n\r\n\t\t\t// traversal hits the left then right node\r\n\t\t\tconst parent = depthStack[ depth - 1 ];\r\n\t\t\tif ( parent ) {\r\n\r\n\t\t\t\tif ( parent.left === null ) {\r\n\r\n\t\t\t\t\tparent.left = info;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tparent.right = info;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\treturn depthStack[ 0 ];\r\n\r\n\t}\r\n\r\n\tvalidateBounds() {\r\n\r\n\t\tconst { bvh, geometry } = this;\r\n\t\tconst depthStack = [];\r\n\t\tconst index = geometry.index;\r\n\t\tconst position = geometry.getAttribute( 'position' );\r\n\t\tlet passes = true;\r\n\r\n\t\tbvh.traverse( ( depth, isLeaf, boundingData, offset, count ) => {\r\n\r\n\t\t\tconst info = {\r\n\t\t\t\tdepth,\r\n\t\t\t\tisLeaf,\r\n\t\t\t\tboundingData,\r\n\t\t\t\toffset,\r\n\t\t\t\tcount,\r\n\t\t\t};\r\n\t\t\tdepthStack[ depth ] = info;\r\n\r\n\t\t\tarrayToBox( boundingData, box1 );\r\n\t\t\tconst parent = depthStack[ depth - 1 ];\r\n\r\n\t\t\tif ( isLeaf ) {\r\n\r\n\t\t\t\t// check triangles\r\n\t\t\t\tfor ( let i = offset * 3, l = ( offset + count ) * 3; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\tconst i0 = index.getX( i );\r\n\t\t\t\t\tconst i1 = index.getX( i + 1 );\r\n\t\t\t\t\tconst i2 = index.getX( i + 2 );\r\n\r\n\t\t\t\t\tlet isContained;\r\n\r\n\t\t\t\t\tvec.fromBufferAttribute( position, i0 );\r\n\t\t\t\t\tisContained = box1.containsPoint( vec );\r\n\r\n\t\t\t\t\tvec.fromBufferAttribute( position, i1 );\r\n\t\t\t\t\tisContained = isContained && box1.containsPoint( vec );\r\n\r\n\t\t\t\t\tvec.fromBufferAttribute( position, i2 );\r\n\t\t\t\t\tisContained = isContained && box1.containsPoint( vec );\r\n\r\n\t\t\t\t\tconsole.assert( isContained, 'Leaf bounds does not fully contain triangle.' );\r\n\t\t\t\t\tpasses = passes && isContained;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( parent ) {\r\n\r\n\t\t\t\t// check if my bounds fit in my parents\r\n\t\t\t\tarrayToBox( boundingData, box2 );\r\n\r\n\t\t\t\tconst isContained = box2.containsBox( box1 );\r\n\t\t\t\tconsole.assert( isContained, 'Parent bounds does not fully contain child.' );\r\n\t\t\t\tpasses = passes && isContained;\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\treturn passes;\r\n\r\n\t}\r\n\r\n}\r\n","import { Ray, Matrix4, Mesh } from 'three';\r\nimport MeshBVH from './MeshBVH.js';\r\nimport Visualizer from './MeshBVHVisualizer.js';\r\nimport { CENTER, AVERAGE, SAH, NOT_INTERSECTED, INTERSECTED, CONTAINED } from './Constants.js';\r\nimport { getBVHExtremes, estimateMemoryInBytes } from './Utils/Debug.js';\r\nimport { MeshBVHDebug } from './MeshBVHDebug.js';\r\n\r\nconst ray = new Ray();\r\nconst tmpInverseMatrix = new Matrix4();\r\nconst origMeshRaycastFunc = Mesh.prototype.raycast;\r\n\r\nfunction acceleratedRaycast( raycaster, intersects ) {\r\n\r\n\tif ( this.geometry.boundsTree ) {\r\n\r\n\t\tif ( this.material === undefined ) return;\r\n\r\n\t\ttmpInverseMatrix.copy( this.matrixWorld ).invert();\r\n\t\tray.copy( raycaster.ray ).applyMatrix4( tmpInverseMatrix );\r\n\r\n\t\tif ( raycaster.firstHitOnly === true ) {\r\n\r\n\t\t\tconst res = this.geometry.boundsTree.raycastFirst( this, raycaster, ray );\r\n\t\t\tif ( res ) intersects.push( res );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.geometry.boundsTree.raycast( this, raycaster, ray, intersects );\r\n\r\n\t\t}\r\n\r\n\t} else {\r\n\r\n\t\torigMeshRaycastFunc.call( this, raycaster, intersects );\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction computeBoundsTree( options ) {\r\n\r\n\tthis.boundsTree = new MeshBVH( this, options );\r\n\treturn this.boundsTree;\r\n\r\n}\r\n\r\nfunction disposeBoundsTree() {\r\n\r\n\tthis.boundsTree = null;\r\n\r\n}\r\n\r\nexport {\r\n\tMeshBVH, Visualizer, Visualizer as MeshBVHVisualizer, MeshBVHDebug,\r\n\tacceleratedRaycast, computeBoundsTree, disposeBoundsTree,\r\n\tCENTER, AVERAGE, SAH, NOT_INTERSECTED, INTERSECTED, CONTAINED,\r\n\testimateMemoryInBytes, getBVHExtremes\r\n};\r\n","export const Layers = {\n  // These 3 layers are hardcoded in THREE\n  CAMERA_LAYER_DEFAULT: 0,\n  CAMERA_LAYER_XR_LEFT_EYE: 1,\n  CAMERA_LAYER_XR_RIGHT_EYE: 2,\n\n  CAMERA_LAYER_REFLECTION: 3,\n  CAMERA_LAYER_INSPECT: 4,\n  CAMERA_LAYER_BATCH_INSPECT: 5,\n  CAMERA_LAYER_VIDEO_TEXTURE_TARGET: 6,\n\n  CAMERA_LAYER_THIRD_PERSON_ONLY: 7,\n  CAMERA_LAYER_FIRST_PERSON_ONLY: 8\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false },\n    inWorldHud: { type: \"boolean\", default: false },\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    const obj = this.el.object3D;\n\n    if (this.data.exclusive) {\n      obj.traverse(o => (o.layers.mask = 0));\n    }\n\n    for (const [name, layer] of Object.entries(Layers)) {\n      const oldValue = oldData[name];\n      const newValue = this.data[name];\n\n      if (oldValue !== newValue) {\n        if (newValue) {\n          obj.traverse(o => o.layers.enable(layer));\n        } else {\n          obj.traverse(o => o.layers.disable(layer));\n        }\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","'use strict';\n\n// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\n\nvar URL = window.URL || window.webkitURL;\n\nmodule.exports = function (content, url) {\n  try {\n    try {\n      var blob;\n\n      try {\n        // BlobBuilder = Deprecated, but widely implemented\n        var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n\n        blob = new BlobBuilder();\n\n        blob.append(content);\n\n        blob = blob.getBlob();\n      } catch (e) {\n        // The proposed API\n        blob = new Blob([content]);\n      }\n\n      return new Worker(URL.createObjectURL(blob));\n    } catch (e) {\n      return new Worker('data:application/javascript,' + encodeURIComponent(content));\n    }\n  } catch (e) {\n    if (!url) {\n      throw Error('Inline worker is not supported');\n    }\n\n    return new Worker(url);\n  }\n};","module.exports = function() {\n  return require(\"!!/Volumes/evo970/metahubs/node_modules/worker-loader/dist/workers/InlineWorker.js\")(\"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\\\"undefined\\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(e,\\\"__esModule\\\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\\\"object\\\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\\\"default\\\",{enumerable:!0,value:e}),2&t&&\\\"string\\\"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\\\"a\\\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\\\"https://assets.metaverseplus2.xyz/hubs/\\\",n(n.s=0)}([function(e,t,n){\\\"use strict\\\";n.r(t);var i=\\n/*!\\n * ZipLoader\\n * (c) 2017 @yomotsu\\n * Released under the MIT License.\\n * \\n * ZipLoader uses the library pako released under the MIT license :\\n * https://github.com/nodeca/pako/blob/master/LICENSE\\n */\\nfunction(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){var n=\\\"undefined\\\"!=typeof Uint8Array&&\\\"undefined\\\"!=typeof Uint16Array&&\\\"undefined\\\"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if(\\\"object\\\"!=typeof n)throw new TypeError(n+\\\"must be non-object\\\");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,r),r+=a.length;return o}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(n)}));i.assign,i.shrinkBuf,i.setTyped,i.Buf8,i.Buf16,i.Buf32;var r=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(r=r+t[i++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0};var a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();var o=function(e,t,n,i){var r=a,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},s=function(e,t){var n,i,r,a,o,s,f,l,d,u,c,h,w,p,b,m,v,k,g,y,x,_,B,A,S;n=e.state,i=e.next_in,A=e.input,r=i+(e.avail_in-5),a=e.next_out,S=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),f=n.dmax,l=n.wsize,d=n.whave,u=n.wnext,c=n.window,h=n.hold,w=n.bits,p=n.lencode,b=n.distcode,m=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=p[h&m];t:for(;;){if(h>>>=g=k>>>24,w-=g,0===(g=k>>>16&255))S[a++]=65535&k;else{if(!(16&g)){if(0==(64&g)){k=p[(65535&k)+(h&(1<<g)-1)];continue t}if(32&g){n.mode=12;break e}e.msg=\\\"invalid literal/length code\\\",n.mode=30;break e}y=65535&k,(g&=15)&&(w<g&&(h+=A[i++]<<w,w+=8),y+=h&(1<<g)-1,h>>>=g,w-=g),w<15&&(h+=A[i++]<<w,w+=8,h+=A[i++]<<w,w+=8),k=b[h&v];n:for(;;){if(h>>>=g=k>>>24,w-=g,!(16&(g=k>>>16&255))){if(0==(64&g)){k=b[(65535&k)+(h&(1<<g)-1)];continue n}e.msg=\\\"invalid distance code\\\",n.mode=30;break e}if(x=65535&k,w<(g&=15)&&(h+=A[i++]<<w,(w+=8)<g&&(h+=A[i++]<<w,w+=8)),(x+=h&(1<<g)-1)>f){e.msg=\\\"invalid distance too far back\\\",n.mode=30;break e}if(h>>>=g,w-=g,x>(g=a-o)){if((g=x-g)>d&&n.sane){e.msg=\\\"invalid distance too far back\\\",n.mode=30;break e}if(_=0,B=c,0===u){if(_+=l-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}else if(u<g){if(_+=l+u-g,(g-=u)<y){y-=g;do{S[a++]=c[_++]}while(--g);if(_=0,u<y){y-=g=u;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}}}else if(_+=u-g,g<y){y-=g;do{S[a++]=c[_++]}while(--g);_=a-x,B=S}for(;y>2;)S[a++]=B[_++],S[a++]=B[_++],S[a++]=B[_++],y-=3;y&&(S[a++]=B[_++],y>1&&(S[a++]=B[_++]))}else{_=a-x;do{S[a++]=S[_++],S[a++]=S[_++],S[a++]=S[_++],y-=3}while(y>2);y&&(S[a++]=S[_++],y>1&&(S[a++]=S[_++]))}break}}break}}while(i<r&&a<s);i-=y=w>>3,h&=(1<<(w-=y<<3))-1,e.next_in=i,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=h,n.bits=w},f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],c=function(e,t,n,r,a,o,s,c){var h,w,p,b,m,v,k,g,y,x=c.bits,_=0,B=0,A=0,S=0,U=0,C=0,j=0,O=0,T=0,z=0,R=null,E=0,L=new i.Buf16(16),D=new i.Buf16(16),P=null,H=0;for(_=0;_<=15;_++)L[_]=0;for(B=0;B<r;B++)L[t[n+B]]++;for(U=x,S=15;S>=1&&0===L[S];S--);if(U>S&&(U=S),0===S)return a[o++]=20971520,a[o++]=20971520,c.bits=1,0;for(A=1;A<S&&0===L[A];A++);for(U<A&&(U=A),O=1,_=1;_<=15;_++)if(O<<=1,(O-=L[_])<0)return-1;if(O>0&&(0===e||1!==S))return-1;for(D[1]=0,_=1;_<15;_++)D[_+1]=D[_]+L[_];for(B=0;B<r;B++)0!==t[n+B]&&(s[D[t[n+B]]++]=B);if(0===e?(R=P=s,v=19):1===e?(R=f,E-=257,P=l,H-=257,v=256):(R=d,P=u,v=-1),z=0,B=0,_=A,m=o,C=U,j=0,p=-1,b=(T=1<<U)-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){k=_-j,s[B]<v?(g=0,y=s[B]):s[B]>v?(g=P[H+s[B]],y=R[E+s[B]]):(g=96,y=0),h=1<<_-j,A=w=1<<C;do{a[m+(z>>j)+(w-=h)]=k<<24|g<<16|y|0}while(0!==w);for(h=1<<_-1;z&h;)h>>=1;if(0!==h?(z&=h-1,z+=h):z=0,B++,0==--L[_]){if(_===S)break;_=t[n+s[B]]}if(_>U&&(z&b)!==p){for(0===j&&(j=U),m+=A,O=1<<(C=_-j);C+j<S&&!((O-=L[C+j])<=0);)C++,O<<=1;if(T+=1<<C,1===e&&T>852||2===e&&T>592)return 1;a[p=z&b]=U<<24|C<<16|m-o|0}}return 0!==z&&(a[m+z]=_-j<<24|64<<16|0),c.bits=U,0};function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\\\"\\\",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function b(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,p(e)):-2}function m(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,b(e))):-2}function v(e,t){var n,i;return e?(i=new w,e.state=i,i.window=null,0!==(n=m(e,t))&&(e.state=null),n):-2}var k,g,y=!0;function x(e){if(y){var t;for(k=new i.Buf32(512),g=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(c(1,e.lens,0,288,k,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;c(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=k,e.lenbits=9,e.distcode=g,e.distbits=5}function _(e,t,n,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new i.Buf8(o.wsize)),r>=o.wsize?(i.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>r&&(a=r),i.arraySet(o.window,t,n-r,a,o.wnext),(r-=a)?(i.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}var B={inflateReset:b,inflateReset2:m,inflateResetKeep:p,inflateInit:function(e){return v(e,15)},inflateInit2:v,inflate:function(e,t){var n,a,f,l,d,u,w,p,b,m,v,k,g,y,B,A,S,U,C,j,O,T,z,R,E=0,L=new i.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,m=u,v=w,T=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(2&n.wrap&&35615===p){n.check=0,L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0),p=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){e.msg=\\\"incorrect header check\\\",n.mode=30;break}if(8!=(15&p)){e.msg=\\\"unknown compression method\\\",n.mode=30;break}if(b-=4,O=8+(15&(p>>>=4)),0===n.wbits)n.wbits=O;else if(O>n.wbits){e.msg=\\\"invalid window size\\\",n.mode=30;break}n.dmax=1<<O,e.adler=n.check=1,n.mode=512&p?10:12,p=0,b=0;break;case 2:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.flags=p,8!=(255&n.flags)){e.msg=\\\"unknown compression method\\\",n.mode=30;break}if(57344&n.flags){e.msg=\\\"unknown header flags set\\\",n.mode=30;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.time=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,L[2]=p>>>16&255,L[3]=p>>>24&255,n.check=o(n.check,L,4,0)),p=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=o(n.check,L,2,0)),p=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((k=n.length)>u&&(k=u),k&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,a,l,k,O)),512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===u)break e;k=0;do{O=a[l+k++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&k<u);if(512&n.flags&&(n.check=o(n.check,a,k,l)),u-=k,l+=k,O)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(65535&n.check)){e.msg=\\\"header crc mismatch\\\",n.mode=30;break}p=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}e.adler=n.check=h(p),p=0,b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){p>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}switch(n.last=1&p,b-=1,3&(p>>>=1)){case 0:n.mode=14;break;case 1:if(x(n),n.mode=20,6===t){p>>>=2,b-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg=\\\"invalid block type\\\",n.mode=30}p>>>=2,b-=2;break;case 14:for(p>>>=7&b,b-=7&b;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if((65535&p)!=(p>>>16^65535)){e.msg=\\\"invalid stored block lengths\\\",n.mode=30;break}if(n.length=65535&p,p=0,b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(k=n.length){if(k>u&&(k=u),k>w&&(k=w),0===k)break e;i.arraySet(f,a,l,k,d),u-=k,l+=k,w-=k,d+=k,n.length-=k;break}n.mode=12;break;case 17:for(;b<14;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(n.nlen=257+(31&p),p>>>=5,b-=5,n.ndist=1+(31&p),p>>>=5,b-=5,n.ncode=4+(15&p),p>>>=4,b-=4,n.nlen>286||n.ndist>30){e.msg=\\\"too many length or distance symbols\\\",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.lens[D[n.have++]]=7&p,p>>>=3,b-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},T=c(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,T){e.msg=\\\"invalid code lengths set\\\",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(S<16)p>>>=B,b-=B,n.lens[n.have++]=S;else{if(16===S){for(R=B+2;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p>>>=B,b-=B,0===n.have){e.msg=\\\"invalid bit length repeat\\\",n.mode=30;break}O=n.lens[n.have-1],k=3+(3&p),p>>>=2,b-=2}else if(17===S){for(R=B+3;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=3+(7&(p>>>=B)),p>>>=3,b-=3}else{for(R=B+7;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}b-=B,O=0,k=11+(127&(p>>>=B)),p>>>=7,b-=7}if(n.have+k>n.nlen+n.ndist){e.msg=\\\"invalid bit length repeat\\\",n.mode=30;break}for(;k--;)n.lens[n.have++]=O}}if(30===n.mode)break;if(0===n.lens[256]){e.msg=\\\"invalid code -- missing end-of-block\\\",n.mode=30;break}if(n.lenbits=9,z={bits:n.lenbits},T=c(1,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,T){e.msg=\\\"invalid literal/lengths set\\\",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},T=c(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,T){e.msg=\\\"invalid distances set\\\",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(u>=6&&w>=258){e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,s(e,v),d=e.next_out,f=e.output,w=e.avail_out,l=e.next_in,a=e.input,u=e.avail_in,p=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;A=(E=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(A&&0==(240&A)){for(U=B,C=A,j=S;A=(E=n.lencode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,n.length=S,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=12;break}if(64&A){e.msg=\\\"invalid literal/length code\\\",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(R=n.extra;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(E=n.distcode[p&(1<<n.distbits)-1])>>>16&255,S=65535&E,!((B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(0==(240&A)){for(U=B,C=A,j=S;A=(E=n.distcode[j+((p&(1<<U+C)-1)>>U)])>>>16&255,S=65535&E,!(U+(B=E>>>24)<=b);){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}p>>>=U,b-=U,n.back+=U}if(p>>>=B,b-=B,n.back+=B,64&A){e.msg=\\\"invalid distance code\\\",n.mode=30;break}n.offset=S,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(R=n.extra;b<R;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg=\\\"invalid distance too far back\\\",n.mode=30;break}n.mode=25;case 25:if(0===w)break e;if(k=v-w,n.offset>k){if((k=n.offset-k)>n.whave&&n.sane){e.msg=\\\"invalid distance too far back\\\",n.mode=30;break}k>n.wnext?(k-=n.wnext,g=n.wsize-k):g=n.wnext-k,k>n.length&&(k=n.length),y=n.window}else y=f,g=d-n.offset,k=n.length;k>w&&(k=w),w-=k,n.length-=k;do{f[d++]=y[g++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;f[d++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===u)break e;u--,p|=a[l++]<<b,b+=8}if(v-=w,e.total_out+=v,n.total+=v,v&&(e.adler=n.check=n.flags?o(n.check,f,v,d-v):r(n.check,f,v,d-v)),v=w,(n.flags?p:h(p))!==n.check){e.msg=\\\"incorrect data check\\\",n.mode=30;break}p=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===u)break e;u--,p+=a[l++]<<b,b+=8}if(p!==(4294967295&n.total)){e.msg=\\\"incorrect length check\\\",n.mode=30;break}p=0,b=0}n.mode=29;case 29:T=1;break e;case 30:T=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=w,e.next_in=l,e.avail_in=u,n.hold=p,n.bits=b,(n.wsize||v!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&_(e,e.output,e.next_out,v-e.avail_out)?(n.mode=31,-4):(m-=e.avail_in,v-=e.avail_out,e.total_in+=m,e.total_out+=v,n.total+=v,n.wrap&&v&&(e.adler=n.check=n.flags?o(n.check,f,v,e.next_out-v):r(n.check,f,v,e.next_out-v)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===m&&0===v||4===t)&&0===T&&(T=-5),T)},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&r(1,t,i,0)!==n.check?-3:_(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},inflateInfo:\\\"pako inflate (from Nodeca project)\\\"},A=!0,S=!0;try{String.fromCharCode.apply(null,[0])}catch(e){A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){S=!1}for(var U=new i.Buf8(256),C=0;C<256;C++)U[C]=C>=252?6:C>=248?5:C>=240?4:C>=224?3:C>=192?2:1;U[254]=U[254]=1;function j(e,t){if(t<65537&&(e.subarray&&S||!e.subarray&&A))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n=\\\"\\\",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var O=function(e){var t,n,r,a,o,s=e.length,f=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),f+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(f),o=0,a=0;o<f;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},T=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},z=function(e,t){var n,i,r,a,o=t||e.length,s=new Array(2*o);for(i=0,n=0;n<o;)if((r=e[n++])<128)s[i++]=r;else if((a=U[r])>4)s[i++]=65533,n+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&n<o;)r=r<<6|63&e[n++],a--;a>1?s[i++]=65533:r<65536?s[i++]=r:(r-=65536,s[i++]=55296|r>>10&1023,s[i++]=56320|1023&r)}return j(s,i)},R=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+U[e[n]]>t?n:t},E=0,L=2,D=4,P=0,H=1,I=2,N=-5,J={2:\\\"need dictionary\\\",1:\\\"stream end\\\",0:\\\"\\\",\\\"-1\\\":\\\"file error\\\",\\\"-2\\\":\\\"stream error\\\",\\\"-3\\\":\\\"data error\\\",\\\"-4\\\":\\\"insufficient memory\\\",\\\"-5\\\":\\\"buffer error\\\",\\\"-6\\\":\\\"incompatible version\\\"};var M=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\\\"\\\",this.state=null,this.data_type=2,this.adler=0};var $=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\\\"\\\",this.comment=\\\"\\\",this.hcrc=0,this.done=!1},G=Object.prototype.toString;function V(e){if(!(this instanceof V))return new V(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:\\\"\\\"},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\\\"\\\",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var n=B.inflateInit2(this.strm,t.windowBits);if(n!==P)throw new Error(J[n]);this.header=new $,B.inflateGetHeader(this.strm,this.header)}function q(e,t){var n=new V(t);if(n.push(e,!0),n.err)throw n.msg||J[n.err];return n.result}V.prototype.push=function(e,t){var n,r,a,o,s,f,l=this.strm,d=this.options.chunkSize,u=this.options.dictionary,c=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?D:E,\\\"string\\\"==typeof e?l.input=T(e):\\\"[object ArrayBuffer]\\\"===G.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new i.Buf8(d),l.next_out=0,l.avail_out=d),(n=B.inflate(l,E))===I&&u&&(f=\\\"string\\\"==typeof u?O(u):\\\"[object ArrayBuffer]\\\"===G.call(u)?new Uint8Array(u):u,n=B.inflateSetDictionary(this.strm,f)),n===N&&!0===c&&(n=P,c=!1),n!==H&&n!==P)return this.onEnd(n),this.ended=!0,!1;l.next_out&&(0!==l.avail_out&&n!==H&&(0!==l.avail_in||r!==D&&r!==L)||(\\\"string\\\"===this.options.to?(a=R(l.output,l.next_out),o=l.next_out-a,s=z(l.output,a),l.next_out=o,l.avail_out=d-o,o&&i.arraySet(l.output,l.output,a,o,0),this.onData(s)):this.onData(i.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(c=!0)}while((l.avail_in>0||0===l.avail_out)&&n!==H);return n===H&&(r=D),r===D?(n=B.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===P):r!==L||(this.onEnd(P),l.avail_out=0,!0)},V.prototype.onData=function(e){this.chunks.push(e)},V.prototype.onEnd=function(e){e===P&&(\\\"string\\\"===this.options.to?this.result=this.chunks.join(\\\"\\\"):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var F={Inflate:V,inflate:q,inflateRaw:function(e,t){return(t=t||{}).raw=!0,q(e,t)},ungzip:q};var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this.dataView=new DataView(t),this.position=0}return e.prototype.skip=function(e){this.position+=e},e.prototype.readBytes=function(e){var t=4===e?\\\"getUint32\\\":2===e?\\\"getUint16\\\":\\\"getUint8\\\",n=this.position;return this.position+=e,this.dataView[t](n,!0)},e}(),X=function(e){for(var t=new K(e),n={};;){var i=t.readBytes(4);if(67324752!==i){if(33639248!==i)break;W(t)}else{var r=Q(t);n[r.name]={buffer:r.buffer}}}return n},Q=function(e){var t=0,n=void 0;e.skip(4);var i=e.readBytes(2);e.skip(8);var r=e.readBytes(4);e.skip(4);var a=e.readBytes(2),o=e.readBytes(2),s=[],f=new Uint8Array(r);for(t=0;t<a;t++)s.push(String.fromCharCode(e.readBytes(1)));for(e.skip(o),t=0;t<r;t++)f[t]=e.readBytes(1);switch(i){case 0:n=f;break;case 8:n=new Uint8Array(F.inflate(f,{raw:!0}));break;default:console.log(s.join(\\\"\\\")+\\\": unsupported compression type\\\"),n=f}return{name:s.join(\\\"\\\"),buffer:n}},W=function(e){e.skip(24);var t=e.readBytes(2),n=e.readBytes(2),i=e.readBytes(2);e.skip(12),e.skip(t),e.skip(n),e.skip(i)};var Y=\\\"function\\\"==typeof Promise?Promise:function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e);var n=function(){};return t((function(){n()})),{then:function(e){n=e}}};var Z=0,ee=void 0,te=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\\\"Cannot call a class as a function\\\")}(this,e),this._id=Z,this._listeners={},this.url=t,this.files=null,Z++}return e.unzip=function(t){return new Y((function(n){var i=new e,r=new FileReader;r.onload=function(e){var t=e.target.result;i.files=X(t),n(i)},t instanceof Blob&&r.readAsArrayBuffer(t)}))},e.prototype.load=function(){var e=this;return new Y((function(t){var n=Date.now(),i=new XMLHttpRequest;i.open(\\\"GET\\\",e.url,!0),i.responseType=\\\"arraybuffer\\\",i.onprogress=function(t){e.dispatch({type:\\\"progress\\\",loaded:t.loaded,total:t.total,elapsedTime:Date.now()-n})},i.onload=function(){e.files=X(i.response),e.dispatch({type:\\\"load\\\",elapsedTime:Date.now()-n}),t()},i.send()}))},e.prototype.extractAsBlobUrl=function(e,t){if(this.files[e].url)return this.files[e].url;var n=new Blob([this.files[e].buffer],{type:t});return this.files[e].url=URL.createObjectURL(n),this.files[e].url},e.prototype.extractAsText=function(e){var t=this.files[e].buffer;if(\\\"undefined\\\"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var n=\\\"\\\",i=0,r=t.length;i<r;i++)n+=String.fromCharCode(t[i]);return decodeURIComponent(escape(n))},e.prototype.extractAsJSON=function(e){return JSON.parse(this.extractAsText(e))},e.prototype.loadThreeJSON=function(e){var t=this,n=this.extractAsJSON(e),i=e.replace(/\\\\/.+\\\\.json$/,\\\"/\\\"),r=\\\"__ziploader_\\\"+this._id+\\\"__\\\",a=new RegExp(r);return-1!==!ee.Loader.Handlers.handlers.indexOf(a)&&ee.Loader.Handlers.add(a,{load:function(e){return t.loadThreeTexture(e.replace(a,\\\"\\\"))}}),ee.JSONLoader.prototype.parse(n,r+i)},e.prototype.loadThreeTexture=function(e){var t=new ee.Texture,n=/\\\\.jpg$/.test(e)?\\\"image/jpeg\\\":/\\\\.png$/.test(e)?\\\"image/png\\\":/\\\\.gif$/.test(e)?\\\"image/gif\\\":void 0,i=new Blob([this.files[e].buffer],{type:n});return t.image=new Image,t.image.addEventListener(\\\"load\\\",(function e(){t.needsUpdate=!0,t.image.removeEventListener(\\\"load\\\",e),URL.revokeObjectURL(t.image.src)})),t.image.src=URL.createObjectURL(i),t},e.prototype.on=function(e,t){this._listeners[e]||(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)},e.prototype.off=function(e,t){var n=this._listeners[e];if(n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}},e.prototype.dispatch=function(e){var t=this._listeners[e.type];if(t){e.target=this;for(var n=t.length,i=0;i<n;i++)t[i].call(this,e)}},e.prototype.clear=function(e){if(e)return URL.revokeObjectURL(this.files[e].url),void delete this.files[e];for(var t in this.files)URL.revokeObjectURL(this.files[t].url);if(delete this.files,ee){var n=\\\"__ziploader_\\\"+this._id+\\\"__\\\";ee.Loader.Handlers.handlers.some((function(e,t){if(e instanceof RegExp&&e.source===n)return ee.Loader.Handlers.handlers.splice(t,2),!0}))}},e.install=function(e){e.THREE&&(ee=e.THREE)},e}();function ne(e,t,n,i,r,a,o){try{var s=e[a](o),f=s.value}catch(e){return void n(e)}s.done?t(f):Promise.resolve(f).then(i,r)}function ie(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){ne(a,i,r,o,s,\\\"next\\\",e)}function s(e){ne(a,i,r,o,s,\\\"throw\\\",e)}o(void 0)}))}}function re(){return(re=ie((function*(e){const t=new te(e);return t.load().then(()=>{const e={};for(const n in t.files)e[n]=t.extractAsBlobUrl(n);const n=JSON.parse(t.extractAsText(\\\"scene.gltf\\\"));return n.buffers&&n.buffers.forEach(t=>t.uri=e[t.uri]),n.images&&n.images.forEach(t=>t.uri=e[t.uri]),e[\\\"scene.gtlf\\\"]=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:\\\"text/plain\\\"})),e})}))).apply(this,arguments)}self.onmessage=function(){var e=ie((function*(e){try{const t=yield function(e){return re.apply(this,arguments)}(e.data.payload);self.postMessage({id:e.data.id,result:t})}catch(t){self.postMessage({id:e.data.id,err:t.message})}}));return function(t){return e.apply(this,arguments)}}()}]);\\n//# sourceMappingURL=sketchfab-zip.worker-7073275d8e44913c60f4.js.map\", \"/\" + \"assets/js/sketchfab-zip.worker-7073275d8e44913c60f4.js\");\n};","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\nimport qsTruthy from \"./utils/qs_truthy\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n    this.hubChannel = null;\n    this.mediaDevicesManager = null;\n\n    // TODO: Remove comments\n    // TODO: Rename or reconfigure these as needed\n    this.audios = new Map(); //                           el -> (THREE.Audio || THREE.PositionalAudio)\n    this.sourceType = new Map(); //                       el -> SourceType\n    this.audioOverrides = new Map(); //                   el -> AudioSettings\n    this.zoneOverrides = new Map(); //                    el -> AudioSettings\n    this.audioDebugPanelOverrides = new Map(); // SourceType -> AudioSettings\n    this.sceneAudioDefaults = new Map(); //       SourceType -> AudioSettings\n    this.gainMultipliers = new Map(); //                  el -> Number\n    this.supplementaryAttenuation = new Map(); //         el -> Number\n    this.clippingState = new Set();\n    this.mutedState = new Set();\n    this.isAudioPaused = new Set();\n  }\n\n  // This gets called by a-scene to setup the renderer, camera, and audio listener\n  // TODO ideally the contorl flow here would be inverted, and we would setup this stuff,\n  // initialize aframe, and then run our own RAF loop\n  setupRenderer(sceneEl) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.classList.add(\"a-canvas\");\n    canvas.dataset.aframeCanvas = true;\n\n    // TODO this comes from aframe and prevents zoom on ipad.\n    // This should alreeady be handleed by disable-ios-zoom but it does not appear to work\n    canvas.addEventListener(\"touchmove\", function(event) {\n      event.preventDefault();\n    });\n\n    const renderer = new THREE.WebGLRenderer({\n      // TODO we should not be using alpha: false https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#avoid_alphafalse_which_can_be_expensive\n      alpha: false,\n      antialias: true,\n      depth: true,\n      stencil: true,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: false,\n      logarithmicDepthBuffer: false,\n      // TODO we probably want high-performance\n      powerPreference: \"default\",\n      canvas\n    });\n\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    renderer.debug.checkShaderErrors = qsTruthy(\"checkShaderErrors\");\n\n    // These get overridden by environment-system but setting to the highly expected defaults to avoid any extra work\n    renderer.physicallyCorrectLights = true;\n    renderer.outputEncoding = THREE.sRGBEncoding;\n\n    sceneEl.appendChild(renderer.domElement);\n\n    const camera = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 0.05, 10000);\n\n    const audioListener = new THREE.AudioListener();\n    camera.add(audioListener);\n\n    const renderClock = new THREE.Clock();\n\n    // TODO NAF currently depends on this, it should not\n    sceneEl.clock = renderClock;\n\n    // Main RAF loop\n    function mainTick(_rafTime, xrFrame) {\n      // TODO we should probably be using time from the raf loop itself\n      const delta = renderClock.getDelta() * 1000;\n      const time = renderClock.elapsedTime * 1000;\n\n      // TODO pass this into systems that care about it (like input) once they are moved into this loop\n      sceneEl.frame = xrFrame;\n\n      // Tick AFrame systems and components\n      if (sceneEl.isPlaying) {\n        sceneEl.tick(time, delta);\n      }\n\n      renderer.render(sceneEl.object3D, camera);\n    }\n\n    // This gets called after all system and component init functions\n    sceneEl.addEventListener(\"loaded\", () => {\n      renderer.setAnimationLoop(mainTick);\n      sceneEl.renderStarted = true;\n    });\n\n    return {\n      renderer,\n      camera,\n      audioListener\n    };\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport defaultAvatar from \"../assets/models/DefaultAvatar.glb\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction chooseRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport async function fetchRandomDefaultAvatarId() {\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries || [];\n  if (defaultAvatars.length === 0) {\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\n    // when running against a fresh reticulum server, e.g. a local ret instance.\n    return new URL(defaultAvatar, location.href).href;\n  }\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\n  return chooseRandom(avatarIds);\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\nimport { qsGet } from \"../utils/qs_truthy.js\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\nimport { NO_DEVICE_ID } from \"../utils/media-devices-utils.js\";\n\nconst defaultMaterialQuality = (function() {\n  const MATERIAL_QUALITY_OPTIONS = [\"low\", \"medium\", \"high\"];\n\n  // HACK: AFRAME is not available on all pages, so we catch the ReferenceError.\n  // We could move AFRAME's device utils into a separate package (or into this repo)\n  // if we wanted to use these checks without having to import all of AFRAME.\n  const isMobile = window.AFRAME && (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR());\n  if (isMobile) {\n    const qsMobileDefault = qsGet(\"default_mobile_material_quality\");\n    if (qsMobileDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsMobileDefault) !== -1) {\n      return qsMobileDefault;\n    }\n    return \"low\";\n  }\n\n  const qsDefault = qsGet(\"default_material_quality\");\n  if (qsDefault && MATERIAL_QUALITY_OPTIONS.indexOf(qsDefault) !== -1) {\n    return qsDefault;\n  }\n\n  return \"high\";\n})();\n\n//workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1626081 : disable echoCancellation, noiseSuppression, autoGainControl\nconst isFirefoxReality = window.AFRAME?.utils.device.isMobileVR() && navigator.userAgent.match(/Firefox/);\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9_~ -]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" },\n        micMuted: { type: \"bool\" }\n      }\n    },\n\n    preferences: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        shouldPromptForRefresh: { type: \"bool\", default: false },\n        // Preferred media will be set dynamically\n        preferredMic: { type: \"string\", default: NO_DEVICE_ID },\n        preferredSpeakers: { type: \"string\", default: NO_DEVICE_ID },\n        preferredCamera: { type: \"string\", default: NO_DEVICE_ID },\n        muteMicOnEntry: { type: \"bool\", default: false },\n        disableLeftRightPanning: { type: \"bool\", default: false },\n        audioNormalization: { type: \"bool\", default: 0.0 },\n        invertTouchscreenCameraMove: { type: \"bool\", default: true },\n        enableOnScreenJoystickLeft: { type: \"bool\", default: false },\n        enableOnScreenJoystickRight: { type: \"bool\", default: false },\n        enableGyro: { type: \"bool\", default: true },\n        animateWaypointTransitions: { type: \"bool\", default: true },\n        showFPSCounter: { type: \"bool\", default: false },\n        allowMultipleHubsInstances: { type: \"bool\", default: false },\n        disableIdleDetection: { type: \"bool\", default: false },\n        fastRoomSwitching: { type: \"bool\", default: false },\n        lazyLoadSceneMedia: { type: \"bool\", default: false },\n        preferMobileObjectInfoPanel: { type: \"bool\", default: false },\n        // if unset, maxResolution = screen resolution\n        maxResolutionWidth: { type: \"number\", default: undefined },\n        maxResolutionHeight: { type: \"number\", default: undefined },\n        globalVoiceVolume: { type: \"number\", default: 100 },\n        globalMediaVolume: { type: \"number\", default: 100 },\n        globalSFXVolume: { type: \"number\", default: 100 },\n        snapRotationDegrees: { type: \"number\", default: 45 },\n        materialQualitySetting: { type: \"string\", default: defaultMaterialQuality },\n        enableDynamicShadows: { type: \"bool\", default: false },\n        disableSoundEffects: { type: \"bool\", default: false },\n        disableMovement: { type: \"bool\", default: false },\n        disableBackwardsMovement: { type: \"bool\", default: false },\n        disableStrafing: { type: \"bool\", default: false },\n        disableTeleporter: { type: \"bool\", default: false },\n        disableAutoPixelRatio: { type: \"bool\", default: false },\n        movementSpeedModifier: { type: \"number\", default: 1 },\n        disableEchoCancellation: { type: \"bool\", default: isFirefoxReality },\n        disableNoiseSuppression: { type: \"bool\", default: isFirefoxReality },\n        disableAutoGainControl: { type: \"bool\", default: isFirefoxReality },\n        locale: { type: \"string\", default: \"browser\" },\n        showRtcDebugPanel: { type: \"bool\", default: false },\n        showAudioDebugPanel: { type: \"bool\", default: false },\n        enableAudioClipping: { type: \"bool\", default: false },\n        audioClippingThreshold: { type: \"number\", default: 0.015 },\n        theme: { type: \"string\", default: undefined },\n        cursorSize: { type: \"number\", default: 1 },\n        nametagVisibility: { type: \"string\", default: \"showAll\" },\n        nametagVisibilityDistance: { type: \"number\", default: 5 },\n        avatarVoiceLevels: { type: \"object\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    preferences: { $ref: \"#/definitions/preferences\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    this._preferences = {};\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: [],\n      preferences: {}\n    });\n\n    this._shouldResetAvatarOnInit = false;\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this._shouldResetAvatarOnInit = true;\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n\n    this._signOutOnExpiredAuthToken();\n\n    const maybeDispatchThemeChanged = (() => {\n      let previous;\n      return () => {\n        const current = this.state.preferences.theme;\n        if ((previous || current) && previous !== current) {\n          this.dispatchEvent(new CustomEvent(\"themechanged\", { detail: { current, previous } }));\n        }\n        previous = current;\n      };\n    })();\n    this.addEventListener(\"statechanged\", maybeDispatchThemeChanged);\n  }\n\n  _signOutOnExpiredAuthToken = () => {\n    if (!this.state.credentials.token) return;\n\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\n    if (expiry <= Date.now()) {\n      this.update({ credentials: { token: null, email: null } });\n    }\n  };\n\n  initProfile = async () => {\n    if (this._shouldResetAvatarOnInit) {\n      await this.resetToRandomDefaultAvatar();\n    } else {\n      this.update({\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\n      });\n    }\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomDefaultAvatar = async () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      const state = (this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY)));\n      if (!state.preferences) state.preferences = {};\n      this._preferences = { ...state.preferences }; // cache prefs without injected defaults\n      // inject default values\n      for (const [key, props] of Object.entries(SCHEMA.definitions.preferences.properties)) {\n        if (!props.hasOwnProperty(\"default\")) continue;\n        if (!state.preferences.hasOwnProperty(key)) {\n          state.preferences[key] = props.default;\n        } else if (state.preferences[key] === props.default) {\n          delete this._preferences[key];\n        }\n      }\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge({ ...this.state, preferences: this._preferences }, newState, mergeOpts);\n    const { valid, errors } = validator.validate(finalState, SCHEMA);\n\n    // Cleanup unsupported properties\n    if (!valid) {\n      errors.forEach(error => {\n        console.error(`Removing invalid preference from store: ${error.message}`);\n        delete error.instance[error.argument];\n      });\n    }\n\n    if (newState.preferences) {\n      // clear preference if equal to default value so that, when client is updated with different defaults,\n      // new defaults will apply without user action\n      for (const [key, value] of Object.entries(finalState.preferences)) {\n        if (\n          SCHEMA.definitions.preferences.properties[key]?.hasOwnProperty(\"default\") &&\n          value === SCHEMA.definitions.preferences.properties[key].default\n        ) {\n          delete finalState.preferences[key];\n        }\n      }\n      this._preferences = finalState.preferences;\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n\n  get schema() {\n    return SCHEMA;\n  }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport { getColorSchemePref } from \"../utils/get-color-scheme-pref\";\nimport classNames from \"classnames\";\n\n// It seems we need to use require to import modules\n// under the three/examples/js to avoid tree shaking\n// in webpack production mode.\nrequire(\"three/examples/js/controls/OrbitControls\");\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode, findNode } from \"../utils/three-utils\";\nimport { ensureAvatarMaterial, MAT_NAME } from \"../utils/avatar-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context, forceWebVR: true });\n  renderer.outputEncoding = THREE.sRGBEncoding;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.Math.DEG2RAD, 30 * THREE.Math.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.Math.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nfunction getThemeBackground() {\n  const currentTheme = APP?.store?.state?.preferences?.theme;\n  const themes = window.APP_CONFIG?.theme?.themes;\n  const currentThemeObject = themes?.find(t => t.id === currentTheme) || getColorSchemePref();\n  const previewBackgroundColor = new THREE.Color(currentThemeObject?.variables[\"background3-color\"] || 0xeaeaea);\n  return previewBackgroundColor;\n}\n\nclass AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string,\n    onGltfLoaded: PropTypes.func\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: null };\n    this.avatar = null;\n    this.imageBitmaps = {};\n    this.mounted = false;\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new THREE.OrbitControls(this.camera, this.canvas);\n    this.controls.screenSpacePanning = true;\n    this.controls.enableKeys = true;\n\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\n\n    this.loadId = 0;\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadCurrentAvatarGltfUrl();\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(getThemeBackground());\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n\n    this.mounted = true;\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ error: null, loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    this.mounted = false;\n\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\n    // contexts by holding on to them directly or indirectly.\n\n    this.scene && this.scene.traverse(disposeNode);\n    if (this.previewRenderer) {\n      this.previewRenderer.dispose();\n    }\n    if (this.snapshotRenderer) {\n      this.snapshotRenderer.dispose();\n    }\n    if (this.controls) {\n      this.controls.dispose();\n      this.controls.domElement = null;\n    }\n\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ error: null, loading: true });\n        await this.loadCurrentAvatarGltfUrl();\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  async loadCurrentAvatarGltfUrl() {\n    const newLoadId = ++this.loadId;\n    const url = proxiedUrlFor(this.props.avatarGltfUrl);\n    const gltf = await this.loadPreviewAvatar(url);\n    // If we had started loading another avatar while we were loading this one, throw this one away\n    if (!this.mounted || newLoadId !== this.loadId) return;\n    if (gltf && this.props.onGltfLoaded) this.props.onGltfLoaded(gltf);\n    this.setAvatar(gltf.scene);\n  }\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    let gltf;\n    try {\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\", null, ensureAvatarMaterial);\n    } catch (e) {\n      console.error(\"Failed to load avatar preview\", e);\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    if (!this.mounted) return;\n\n    // TODO Check for \"Bot_Skinned\" here is a hack for legacy avatars which only has a name one of the MOZ_alt_material nodes\n    this.previewMesh = findNode(\n      gltf.scene,\n      n => (n.isMesh && n.material && n.material.name === MAT_NAME) || n.name === \"Bot_Skinned\"\n    );\n\n    if (!this.previewMesh) {\n      console.error(\"Failed to find avatar preview mesh\");\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(gltf.scene);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    gltf.scene.traverse(node => {\n      // Camera in preview is pretty tight, and skinned meshes tend to have poor bounding boxes\n      if (node.isSkinnedMesh) {\n        node.frustumCulled = false;\n      }\n\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      if (node.material) {\n        const removeOnUpdate = p => node.material[p] && delete node.material[p].onUpdate;\n        TEXTURE_PROPS[\"base_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"emissive_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"normal_map\"].forEach(removeOnUpdate);\n        TEXTURE_PROPS[\"orm_map\"].forEach(removeOnUpdate);\n      }\n    });\n\n    const { material } = this.previewMesh;\n    if (material) {\n      const getImage = p => material[p] && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      const dependencies = [\n        this.applyMaps({}, this.props) // Apply initial maps\n      ];\n\n      // Low and medium quality materials don't use environment maps\n      if (window.APP.store.state.preferences.materialQualitySetting === \"high\") {\n        dependencies.push(\n          // TODO apply environment map to secondary materials as well\n          createDefaultEnvironmentMap().then(t => {\n            this.previewMesh.material.envMap = t;\n            this.previewMesh.material.needsUpdate = true;\n          })\n        );\n      }\n\n      await Promise.all(dependencies);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n\n      // Low quality materials are missing normal maps\n      if (prop === \"normalMap\" && window.APP.store.state.preferences.materialQualitySetting === \"low\") {\n        return;\n      }\n\n      // Medium Quality materials are missing metalness and roughness maps\n      if (\n        (prop === \"roughnessMap\" || prop === \"metalnessMap\") &&\n        window.APP.store.state.preferences.materialQualitySetting !== \"high\"\n      ) {\n        return;\n      }\n\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n\n      if (texture) {\n        texture.image = bm;\n        texture.needsUpdate = true;\n      }\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotCamera.position.copy(this.camera.position);\n      this.snapshotCamera.rotation.copy(this.camera.rotation);\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {!this.props.avatarGltfUrl ||\n          (this.state.loading &&\n            !this.state.error && (\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            ))}\n        {this.props.avatarGltfUrl &&\n          (this.state.error && !this.state.loading) && (\n            <div className=\"error\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"error-icon\"\n              />\n              <FormattedMessage\n                id=\"avatar-preview.loading-failed\"\n                defaultMessage=\"Loading failed{linebreak}Please choose another avatar\"\n                values={{ linebreak: <br /> }}\n              />\n            </div>\n          )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarPreview, { forwardRef: true });\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // Hash can't be overriden like the other elements, but needs to be preserved for things like deep linking waypoints\n  const hash = history.location.hash;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state, hash });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function updateMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material = object3D.material.map(fn);\n  } else {\n    object3D.material = fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return [];\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return [fn(object3D.material)];\n  }\n}\n\n// HubsMeshBasicMaterial exists because we need to be able to set the emissiveMap in the avatar preview.\n// It also allows the material to be properly copied/cloned.\nclass HubsMeshBasicMaterial extends THREE.MeshBasicMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshBasicMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.emissive.copy(source.emissive);\n    material.emissiveIntensity = source.emissiveIntensity;\n    material.emissiveMap = source.emissiveMap;\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    material.lightMapIntensity = source.lightMapIntensity;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.alphaMap = source.alphaMap;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  constructor({ emissive, emissiveMap, emissiveIntensity, ...rest } = {}) {\n    super(rest);\n    this._emissive = { value: emissive || new THREE.Color() };\n    this._emissiveIntensity = { value: emissiveIntensity === undefined ? 1 : emissiveIntensity };\n    this._emissiveMap = { value: emissiveMap };\n  }\n\n  get emissive() {\n    return this._emissive.value;\n  }\n\n  set emissive(emissive) {\n    this._emissive.value = emissive;\n  }\n\n  get emissiveIntensity() {\n    return this._emissiveIntensity.value;\n  }\n\n  set emissiveIntensity(emissiveIntensity) {\n    this._emissiveIntensity.value = emissiveIntensity;\n  }\n\n  get emissiveMap() {\n    return this._emissiveMap.value;\n  }\n\n  set emissiveMap(emissiveMap) {\n    this._emissiveMap.value = emissiveMap;\n  }\n\n  copy(source) {\n    super.copy(source);\n    this.emissive.copy(source.emissive);\n    this.emissiveIntensity = source.emissiveIntensity;\n    this.emissiveMap = source.emissiveMap;\n    return this;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to the MeshBasicMaterial adds support for emissive maps.\n    shader.uniforms.emissive = this._emissive;\n    shader.uniforms.emissiveIntensity = this._emissiveIntensity;\n    shader.uniforms.emissiveMap = this._emissiveMap;\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lightmap_pars_fragment>\",\n      `#include <lightmap_pars_fragment>\n      uniform vec3 emissive;\n      uniform sampler2D emissiveMap;\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <envmap_fragment>\",\n      `#include <envmap_fragment>\n\n      vec3 totalEmissiveRadiance = emissive;\n      #include <emissivemap_fragment>\n      outgoingLight += totalEmissiveRadiance;\n\n      `\n    );\n  };\n}\n\nclass HubsMeshPhongMaterial extends THREE.MeshPhongMaterial {\n  static fromMeshStandardMaterial(source) {\n    const material = new HubsMeshPhongMaterial();\n\n    THREE.Material.prototype.copy.call(material, source);\n\n    material.color.copy(source.color);\n\n    material.map = source.map;\n\n    material.lightMap = source.lightMap;\n    material.lightMapIntensity = source.lightMapIntensity;\n\n    material.aoMap = source.aoMap;\n    material.aoMapIntensity = source.aoMapIntensity;\n\n    material.emissive.copy(source.emissive);\n    material.emissiveMap = source.emissiveMap;\n    material.emissiveIntensity = source.emissiveIntensity;\n\n    material.normalMapType = source.normalMapType;\n    material.normalMap = source.normalMap;\n    material.normalScale.copy(source.normalScale);\n\n    material.bumpMap = source.bumpMap;\n    material.bumpScale = source.bumpScale;\n\n    material.displacementMap = source.displacementMap;\n    material.displacementScale = source.displacementScale;\n    material.displacementBias = source.displacementBias;\n\n    material.alphaMap = source.alphaMap;\n\n    material.reflectivity = 0.5;\n    material.refractionRatio = source.refractionRatio;\n\n    material.wireframe = source.wireframe;\n    material.wireframeLinewidth = source.wireframeLinewidth;\n    material.wireframeLinecap = source.wireframeLinecap;\n    material.wireframeLinejoin = source.wireframeLinejoin;\n\n    return material;\n  }\n\n  onBeforeCompile = shader => {\n    // This patch to MeshPhongMaterial adds support for tangent space normal maps.\n    shader.vertexShader = shader.vertexShader.replace(\n      \"varying vec3 vNormal;\",\n      `varying vec3 vNormal;\n      #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n      #endif\n      `\n    );\n    shader.vertexShader = shader.vertexShader.replace(\n      \"vNormal = normalize( transformedNormal );\",\n      `vNormal = normalize( transformedNormal );\n      \n        #ifdef USE_TANGENT\n      \n          vTangent = normalize( transformedTangent );\n          vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n      \n        #endif\n      `\n    );\n    shader.fragmentShader = shader.fragmentShader.replace(\n      \"#include <lights_phong_pars_fragment>\",\n      `#include <lights_phong_pars_fragment>\n      #ifndef FLAT_SHADED\n\n        #ifdef USE_TANGENT\n          varying vec3 vTangent;\n          varying vec3 vBitangent;\n        #endif\n\n      #endif\n      `\n    );\n  };\n}\n\nexport function convertStandardMaterial(source, quality) {\n  if (!source.isMeshStandardMaterial) {\n    return source;\n  }\n\n  if (quality === \"medium\") {\n    return HubsMeshPhongMaterial.fromMeshStandardMaterial(source);\n  } else if (quality === \"low\") {\n    return HubsMeshBasicMaterial.fromMeshStandardMaterial(source);\n  }\n\n  return source;\n}\n\nexport function disposeTexture(texture) {\n  if (texture.dash) {\n    texture.dash.reset();\n  }\n\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.stopLoad();\n    texture.hls.detachMedia();\n    texture.hls.destroy();\n    texture.hls = null;\n  }\n\n  texture.dispose();\n}\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*,naf-dialog-adapter:*,mediasoup*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","import appLogo from \"../assets/images/app-logo.png\";\nimport appLogoDark from \"../assets/images/app-logo-dark.png\";\nimport companyLogo from \"../assets/images/company-logo.png\";\nimport homeHeroBackground from \"../assets/images/home-hero-background-unbranded.png\";\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\nimport { getLocale, getMessage } from \"./i18n\";\n\n// Read configs from global variable if available, otherwise use the process.env injected from build.\nconst configs = {};\nlet isAdmin = false;\n[\n  \"RETICULUM_SERVER\",\n  \"THUMBNAIL_SERVER\",\n  \"CORS_PROXY_SERVER\",\n  \"NON_CORS_PROXY_DOMAINS\",\n  \"SENTRY_DSN\",\n  \"GA_TRACKING_ID\",\n  \"SHORTLINK_DOMAIN\",\n  \"BASE_ASSETS_PATH\",\n  \"UPLOADS_HOST\"\n].forEach(x => {\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\n\n  const BASE_ASSETS_PATH_KEY = \"BASE_ASSETS_PATH\";\n  if (x === BASE_ASSETS_PATH_KEY && configs[BASE_ASSETS_PATH_KEY]) {\n    // BASE_ASSETS_PATH might be a relative URL like \"/\" when it is set in\n    // .env or .defaults.env when running locally. We need to convert that\n    // to an absolute URL.\n    if (!configs[BASE_ASSETS_PATH_KEY].startsWith(\"http\")) {\n      configs[BASE_ASSETS_PATH_KEY] = new URL(configs[BASE_ASSETS_PATH_KEY], window.location).toString();\n    }\n\n    // eslint-disable-next-line no-undef\n    __webpack_public_path__ = configs[BASE_ASSETS_PATH_KEY];\n  }\n});\n\n// Custom clients do not use <meta> tags for passing data, so if thumbnail_server meta tag exists, it is not a custom client\nconst hasThumbnailServerMetaTag = !!document.querySelector(\"meta[name='env:thumbnail_server']\");\nconfigs.IS_LOCAL_OR_CUSTOM_CLIENT = !hasThumbnailServerMetaTag;\n\n// Also include configs that reticulum injects as a script in the page head.\n\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\n\nif (process.env.APP_CONFIG) {\n  window.APP_CONFIG = process.env.APP_CONFIG;\n}\n\nif (window.APP_CONFIG) {\n  configs.APP_CONFIG = window.APP_CONFIG;\n  const { theme } = configs.APP_CONFIG;\n  if (theme) {\n    const colorVars = [];\n    for (const key in theme) {\n      if (!theme.hasOwnProperty(key)) continue;\n      colorVars.push(`--${key}: ${theme[key]};`);\n    }\n    const style = document.createElement(\"style\");\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\n    document.head.insertBefore(style, document.head.firstChild);\n  }\n\n  if (!configs.APP_CONFIG.features) {\n    configs.APP_CONFIG.features = {};\n  }\n} else {\n  configs.APP_CONFIG = {\n    features: {}\n  };\n}\n\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\n\nconfigs.feature = featureName => {\n  const value = configs.APP_CONFIG && configs.APP_CONFIG.features && configs.APP_CONFIG.features[featureName];\n  if (typeof value === \"boolean\" || featureName === \"enable_spoke\") {\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\n    return forceEnableSpoke || value;\n  } else {\n    return value;\n  }\n};\n\nlet localDevImages = {};\nif (isLocalDevelopment) {\n  localDevImages = {\n    logo: appLogo,\n    logo_dark: appLogoDark,\n    company_logo: companyLogo,\n    editor_logo: sceneEditorLogo,\n    home_background: homeHeroBackground\n  };\n}\n\nconfigs.image = (imageName, cssUrl) => {\n  const url =\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\n    localDevImages[imageName];\n  return url && cssUrl ? `url(${url})` : url;\n};\n\nconfigs.link = (linkName, defaultValue) => {\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\n};\n\nconfigs.setIsAdmin = _isAdmin => {\n  isAdmin = _isAdmin;\n};\nconfigs.isAdmin = () => isAdmin;\n\nconfigs.integration = integration => {\n  const availableIntegrations = configs.AVAILABLE_INTEGRATIONS;\n  // AVAILABLE_INTEGRATIONS has no properties defined on the dev server, but does support all integrations.\n  return !availableIntegrations.hasOwnProperty(integration) || availableIntegrations[integration];\n};\n\nconfigs.translation = key => {\n  const locale = getLocale();\n  const translationsConfig = (configs.APP_CONFIG && configs.APP_CONFIG.translations) || {};\n\n  return (\n    (translationsConfig[locale] && translationsConfig[locale][key]) ||\n    (translationsConfig.en && translationsConfig.en[key]) ||\n    getMessage(key) ||\n    \"\"\n  );\n};\n\nexport default configs;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseUnicodeLocaleId = exports.parseUnicodeLanguageId = exports.isUnicodeVariantSubtag = exports.isUnicodeScriptSubtag = exports.isUnicodeRegionSubtag = exports.isStructurallyValidLanguageTag = exports.isUnicodeLanguageSubtag = exports.SEPARATOR = void 0;\nvar tslib_1 = require(\"tslib\");\nvar ALPHANUM_1_8 = /^[a-z0-9]{1,8}$/i;\nvar ALPHANUM_2_8 = /^[a-z0-9]{2,8}$/i;\nvar ALPHANUM_3_8 = /^[a-z0-9]{3,8}$/i;\nvar KEY_REGEX = /^[a-z0-9][a-z]$/i;\nvar TYPE_REGEX = /^[a-z0-9]{3,8}$/i;\nvar ALPHA_4 = /^[a-z]{4}$/i;\n// alphanum-[tTuUxX]\nvar OTHER_EXTENSION_TYPE = /^[0-9a-svwyz]$/i;\nvar UNICODE_REGION_SUBTAG_REGEX = /^([a-z]{2}|[0-9]{3})$/i;\nvar UNICODE_VARIANT_SUBTAG_REGEX = /^([a-z0-9]{5,8}|[0-9][a-z0-9]{3})$/i;\nvar UNICODE_LANGUAGE_SUBTAG_REGEX = /^([a-z]{2,3}|[a-z]{5,8})$/i;\nvar TKEY_REGEX = /^[a-z][0-9]$/i;\nexports.SEPARATOR = '-';\nfunction isUnicodeLanguageSubtag(lang) {\n    return UNICODE_LANGUAGE_SUBTAG_REGEX.test(lang);\n}\nexports.isUnicodeLanguageSubtag = isUnicodeLanguageSubtag;\nfunction isStructurallyValidLanguageTag(tag) {\n    try {\n        parseUnicodeLanguageId(tag.split(exports.SEPARATOR));\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\nexports.isStructurallyValidLanguageTag = isStructurallyValidLanguageTag;\nfunction isUnicodeRegionSubtag(region) {\n    return UNICODE_REGION_SUBTAG_REGEX.test(region);\n}\nexports.isUnicodeRegionSubtag = isUnicodeRegionSubtag;\nfunction isUnicodeScriptSubtag(script) {\n    return ALPHA_4.test(script);\n}\nexports.isUnicodeScriptSubtag = isUnicodeScriptSubtag;\nfunction isUnicodeVariantSubtag(variant) {\n    return UNICODE_VARIANT_SUBTAG_REGEX.test(variant);\n}\nexports.isUnicodeVariantSubtag = isUnicodeVariantSubtag;\nfunction parseUnicodeLanguageId(chunks) {\n    if (typeof chunks === 'string') {\n        chunks = chunks.split(exports.SEPARATOR);\n    }\n    var lang = chunks.shift();\n    if (!lang) {\n        throw new RangeError('Missing unicode_language_subtag');\n    }\n    if (lang === 'root') {\n        return { lang: 'root', variants: [] };\n    }\n    // unicode_language_subtag\n    if (!isUnicodeLanguageSubtag(lang)) {\n        throw new RangeError('Malformed unicode_language_subtag');\n    }\n    var script;\n    // unicode_script_subtag\n    if (isUnicodeScriptSubtag(chunks[0])) {\n        script = chunks.shift();\n    }\n    var region;\n    // unicode_region_subtag\n    if (isUnicodeRegionSubtag(chunks[0])) {\n        region = chunks.shift();\n    }\n    var variants = {};\n    while (chunks.length && isUnicodeVariantSubtag(chunks[0])) {\n        var variant = chunks.shift();\n        if (variant in variants) {\n            throw new RangeError(\"Duplicate variant \\\"\" + variant + \"\\\"\");\n        }\n        variants[variant] = 1;\n    }\n    return {\n        lang: lang,\n        script: script,\n        region: region,\n        variants: Object.keys(variants),\n    };\n}\nexports.parseUnicodeLanguageId = parseUnicodeLanguageId;\nfunction parseUnicodeExtension(chunks) {\n    var keywords = [];\n    var keyword;\n    while (chunks.length && (keyword = parseKeyword(chunks))) {\n        keywords.push(keyword);\n    }\n    if (keywords.length) {\n        return {\n            type: 'u',\n            keywords: keywords,\n            attributes: [],\n        };\n    }\n    // Mix of attributes & keywords\n    // Check for attributes first\n    var attributes = [];\n    while (chunks.length && ALPHANUM_3_8.test(chunks[0])) {\n        attributes.push(chunks.shift());\n    }\n    while (chunks.length && (keyword = parseKeyword(chunks))) {\n        keywords.push(keyword);\n    }\n    if (keywords.length || attributes.length) {\n        return {\n            type: 'u',\n            attributes: attributes,\n            keywords: keywords,\n        };\n    }\n    throw new RangeError('Malformed unicode_extension');\n}\nfunction parseKeyword(chunks) {\n    var key;\n    if (!KEY_REGEX.test(chunks[0])) {\n        return;\n    }\n    key = chunks.shift();\n    var type = [];\n    while (chunks.length && TYPE_REGEX.test(chunks[0])) {\n        type.push(chunks.shift());\n    }\n    var value = '';\n    if (type.length) {\n        value = type.join(exports.SEPARATOR);\n    }\n    return [key, value];\n}\nfunction parseTransformedExtension(chunks) {\n    var lang;\n    try {\n        lang = parseUnicodeLanguageId(chunks);\n    }\n    catch (e) {\n        // Try just parsing tfield\n    }\n    var fields = [];\n    while (chunks.length && TKEY_REGEX.test(chunks[0])) {\n        var key = chunks.shift();\n        var value = [];\n        while (chunks.length && ALPHANUM_3_8.test(chunks[0])) {\n            value.push(chunks.shift());\n        }\n        if (!value.length) {\n            throw new RangeError(\"Missing tvalue for tkey \\\"\" + key + \"\\\"\");\n        }\n        fields.push([key, value.join(exports.SEPARATOR)]);\n    }\n    if (fields.length) {\n        return {\n            type: 't',\n            fields: fields,\n            lang: lang,\n        };\n    }\n    throw new RangeError('Malformed transformed_extension');\n}\nfunction parsePuExtension(chunks) {\n    var exts = [];\n    while (chunks.length && ALPHANUM_1_8.test(chunks[0])) {\n        exts.push(chunks.shift());\n    }\n    if (exts.length) {\n        return {\n            type: 'x',\n            value: exts.join(exports.SEPARATOR),\n        };\n    }\n    throw new RangeError('Malformed private_use_extension');\n}\nfunction parseOtherExtensionValue(chunks) {\n    var exts = [];\n    while (chunks.length && ALPHANUM_2_8.test(chunks[0])) {\n        exts.push(chunks.shift());\n    }\n    if (exts.length) {\n        return exts.join(exports.SEPARATOR);\n    }\n    return '';\n}\nfunction parseExtensions(chunks) {\n    if (!chunks.length) {\n        return { extensions: [] };\n    }\n    var extensions = [];\n    var unicodeExtension;\n    var transformedExtension;\n    var puExtension;\n    var otherExtensionMap = {};\n    do {\n        var type = chunks.shift();\n        switch (type) {\n            case 'u':\n            case 'U':\n                if (unicodeExtension) {\n                    throw new RangeError('There can only be 1 -u- extension');\n                }\n                unicodeExtension = parseUnicodeExtension(chunks);\n                extensions.push(unicodeExtension);\n                break;\n            case 't':\n            case 'T':\n                if (transformedExtension) {\n                    throw new RangeError('There can only be 1 -t- extension');\n                }\n                transformedExtension = parseTransformedExtension(chunks);\n                extensions.push(transformedExtension);\n                break;\n            case 'x':\n            case 'X':\n                if (puExtension) {\n                    throw new RangeError('There can only be 1 -x- extension');\n                }\n                puExtension = parsePuExtension(chunks);\n                extensions.push(puExtension);\n                break;\n            default:\n                if (!OTHER_EXTENSION_TYPE.test(type)) {\n                    throw new RangeError('Malformed extension type');\n                }\n                if (type in otherExtensionMap) {\n                    throw new RangeError(\"There can only be 1 -\" + type + \"- extension\");\n                }\n                var extension = {\n                    type: type,\n                    value: parseOtherExtensionValue(chunks),\n                };\n                otherExtensionMap[extension.type] = extension;\n                extensions.push(extension);\n                break;\n        }\n    } while (chunks.length);\n    return { extensions: extensions };\n}\nfunction parseUnicodeLocaleId(locale) {\n    var chunks = locale.split(exports.SEPARATOR);\n    var lang = parseUnicodeLanguageId(chunks);\n    return tslib_1.__assign({ lang: lang }, parseExtensions(chunks));\n}\nexports.parseUnicodeLocaleId = parseUnicodeLocaleId;\n","module.exports = __webpack_public_path__ + \"assets/images/avatar_unavailable-3145734291e8890bc42b09db277bb337.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.emitUnicodeLocaleId = exports.emitUnicodeLanguageId = void 0;\nvar tslib_1 = require(\"tslib\");\nfunction emitUnicodeLanguageId(lang) {\n    if (!lang) {\n        return '';\n    }\n    return tslib_1.__spreadArrays([lang.lang, lang.script, lang.region], (lang.variants || [])).filter(Boolean)\n        .join('-');\n}\nexports.emitUnicodeLanguageId = emitUnicodeLanguageId;\nfunction emitUnicodeLocaleId(_a) {\n    var lang = _a.lang, extensions = _a.extensions;\n    var chunks = [emitUnicodeLanguageId(lang)];\n    for (var _i = 0, extensions_1 = extensions; _i < extensions_1.length; _i++) {\n        var ext = extensions_1[_i];\n        chunks.push(ext.type);\n        switch (ext.type) {\n            case 'u':\n                chunks.push.apply(chunks, tslib_1.__spreadArrays(ext.attributes, ext.keywords.reduce(function (all, kv) { return all.concat(kv); }, [])));\n                break;\n            case 't':\n                chunks.push.apply(chunks, tslib_1.__spreadArrays([emitUnicodeLanguageId(ext.lang)], ext.fields.reduce(function (all, kv) { return all.concat(kv); }, [])));\n                break;\n            default:\n                chunks.push(ext.value);\n                break;\n        }\n    }\n    return chunks.filter(Boolean).join('-');\n}\nexports.emitUnicodeLocaleId = emitUnicodeLocaleId;\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preview\":\"avatar-preview__preview__2I8qx\"};","module.exports = __webpack_public_path__ + \"assets/models/DefaultAvatar-798e20921f79aae310651e2fcb6f6ebb.glb\";","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider } from \"react-intl\";\nimport \"@formatjs/intl-locale/polyfill\";\nimport \"@formatjs/intl-pluralrules/polyfill\";\nimport \"@formatjs/intl-pluralrules/locale-data/en\";\nimport \"@formatjs/intl-relativetimeformat/polyfill\";\nimport \"@formatjs/intl-relativetimeformat/locale-data/en\";\nimport { getLocale, getMessages } from \"../utils/i18n\";\n\nexport class WrappedIntlProvider extends React.Component {\n  static propTypes = {\n    children: PropTypes.node.isRequired\n  };\n\n  state = {\n    locale: getLocale(),\n    messages: getMessages()\n  };\n\n  updateLocale = () => {\n    this.setState({ locale: getLocale(), messages: getMessages() });\n  };\n\n  componentDidMount() {\n    this.updateLocale();\n    window.addEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"locale-updated\", this.updateLocale);\n  }\n\n  render() {\n    return (\n      <IntlProvider locale={this.state.locale} messages={this.state.messages}>\n        {this.props.children}\n      </IntlProvider>\n    );\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/app-logo-6c8cfcf9c903ba04105ca0bc29514de7.png\";","module.exports = __webpack_public_path__ + \"assets/images/app-logo-dark-3ce7d2da524556485823d5ac27c3a7fc.png\";","module.exports = __webpack_public_path__ + \"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png\";","module.exports = __webpack_public_path__ + \"assets/images/home-hero-background-unbranded-af23743b76d26ec9d5c160558a2e18ef.png\";","module.exports = __webpack_public_path__ + \"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png\";","var isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tObject.keys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tObject.keys(source).forEach(function(key) {\n\t\tif (!options.isMergeableObject(source[key]) || !target[key]) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = deepmerge(target[key], source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nexport default deepmerge_1;\n","export const MediaDevicesEvents = Object.freeze({\n  PERMISSIONS_STATUS_CHANGED: \"permissions_status_changed\",\n  MIC_SHARE_STARTED: \"mic_share_started\",\n  MIC_SHARE_ENDED: \"mic_share_ended\",\n  VIDEO_SHARE_STARTED: \"video_share_started\",\n  VIDEO_SHARE_ENDED: \"video_share_ended\",\n  DEVICE_CHANGE: \"devicechange\"\n});\n\nexport const PermissionStatus = Object.freeze({\n  GRANTED: \"granted\",\n  DENIED: \"denied\",\n  PROMPT: \"prompt\"\n});\n\nexport const MediaDevices = Object.freeze({\n  MICROPHONE: \"microphone\",\n  SPEAKERS: \"speakers\",\n  CAMERA: \"camera\",\n  SCREEN: \"screen\"\n});\n\nexport const NO_DEVICE_ID = \"none\";\n","import { hackyMobileSafariTest } from \"./detect-touchscreen\";\n\nconst MOBILE_RE = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\nconst TABLET_RE = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;\n\n// from https://stackoverflow.com/questions/57776001/how-to-detect-ipad-pro-as-ipad-using-javascript\nfunction isIpadOS() {\n  return window.navigator.maxTouchPoints && window.navigator.maxTouchPoints > 2 && /MacIntel/.test(navigator.platform);\n}\n\n// lifted from https://github.com/aframevr/aframe/blob/master/src/utils/device.js to ensure consistency\nexport function isIOS() {\n  return /iPad|iPhone|iPod/.test(window.navigator.platform) || isIpadOS();\n}\n\nfunction isTablet(mockUserAgent) {\n  const userAgent = mockUserAgent || window.navigator.userAgent;\n  return isIpadOS() || /ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(userAgent);\n}\n\nfunction isR7() {\n  return /R7 Build/.test(window.navigator.userAgent);\n}\n\nfunction isOculusBrowser() {\n  return /(OculusBrowser)/i.test(window.navigator.userAgent);\n}\n\nfunction isFirefoxReality() {\n  return /(Mobile VR)/i.test(window.navigator.userAgent);\n}\n\nfunction isMobileVR() {\n  return isOculusBrowser() || isFirefoxReality();\n}\n\nconst isMobile = (function() {\n  let _isMobile = false;\n  (function(a) {\n    // eslint-disable-next-line no-useless-escape\n    if (MOBILE_RE.test(a) || TABLET_RE.test(a.substr(0, 4))) {\n      _isMobile = true;\n    }\n    if (isIOS() || isTablet() || isR7()) {\n      _isMobile = true;\n    }\n    if (hackyMobileSafariTest()) {\n      _isMobile = true;\n    }\n    if (isMobileVR()) {\n      _isMobile = false;\n    }\n  })(window.navigator.userAgent || window.navigator.vendor || window.opera);\n\n  return function() {\n    return _isMobile;\n  };\n})();\n\nexport default isMobile;\n","const adjectives = [\n  \"able\",\n  \"absolute\",\n  \"acceptable\",\n  \"acclaimed\",\n  \"accomplished\",\n  \"accurate\",\n  \"aching\",\n  \"acrobatic\",\n  \"adorable\",\n  \"adventurous\",\n  \"basic\",\n  \"belated\",\n  \"beloved\",\n  \"calm\",\n  \"candid\",\n  \"capital\",\n  \"carefree\",\n  \"caring\",\n  \"cautious\",\n  \"celebrated\",\n  \"charming\",\n  \"daring\",\n  \"darling\",\n  \"dearest\",\n  \"each\",\n  \"eager\",\n  \"early\",\n  \"earnest\",\n  \"easy\",\n  \"easygoing\",\n  \"ecstatic\",\n  \"edible\",\n  \"fabulous\",\n  \"fair\",\n  \"faithful\",\n  \"familiar\",\n  \"famous\",\n  \"fancy\",\n  \"fantastic\",\n  \"far\",\n  \"generous\",\n  \"gentle\",\n  \"genuine\",\n  \"giant\",\n  \"handmade\",\n  \"handsome\",\n  \"handy\",\n  \"happy\",\n  \"icy\",\n  \"ideal\",\n  \"identical\",\n  \"keen\",\n  \"lasting\",\n  \"lavish\",\n  \"magnificent\",\n  \"majestic\",\n  \"mammoth\",\n  \"marvelous\",\n  \"natural\",\n  \"obedient\",\n  \"palatable\",\n  \"parched\",\n  \"passionate\",\n  \"pastel\",\n  \"peaceful\",\n  \"perfect\",\n  \"perfumed\",\n  \"quaint\",\n  \"qualified\",\n  \"radiant\",\n  \"rapid\",\n  \"rare\",\n  \"safe\",\n  \"sandy\",\n  \"satisfied\",\n  \"scaly\",\n  \"scarce\",\n  \"scared\",\n  \"scary\",\n  \"scented\",\n  \"scientific\",\n  \"secret\",\n  \"sentimental\",\n  \"talkative\",\n  \"tangible\",\n  \"tart\",\n  \"tasty\",\n  \"tattered\",\n  \"teeming\",\n  \"ultimate\",\n  \"uncommon\",\n  \"unconscious\",\n  \"understated\",\n  \"warm\",\n  \"active\",\n  \"adept\",\n  \"admirable\",\n  \"admired\",\n  \"adorable\",\n  \"adored\",\n  \"advanced\",\n  \"affectionate\",\n  \"beneficial\",\n  \"best\",\n  \"better\",\n  \"big\",\n  \"cheerful\",\n  \"cheery\",\n  \"chief\",\n  \"chilly\",\n  \"classic\",\n  \"clean\",\n  \"clear\",\n  \"clever\",\n  \"decent\",\n  \"decisive\",\n  \"deep\",\n  \"defiant\",\n  \"definitive\",\n  \"delectable\",\n  \"delicious\",\n  \"elaborate\",\n  \"elastic\",\n  \"elated\",\n  \"elegant\",\n  \"elementary\",\n  \"elliptical\",\n  \"fast\",\n  \"favorable\",\n  \"favorite\",\n  \"fearless\",\n  \"gifted\",\n  \"glamorous\",\n  \"gleaming\",\n  \"glittering\",\n  \"harmonious\",\n  \"imaginative\",\n  \"immense\",\n  \"jealous\",\n  \"kind\",\n  \"leafy\",\n  \"legal\",\n  \"mature\",\n  \"mean\",\n  \"nautical\",\n  \"neat\",\n  \"necessary\",\n  \"needy\",\n  \"oddball\",\n  \"offbeat\",\n  \"periodic\",\n  \"perky\",\n  \"personal\",\n  \"pertinent\",\n  \"petty\",\n  \"quarterly\",\n  \"ready\",\n  \"real\",\n  \"realistic\",\n  \"reasonable\",\n  \"regal\",\n  \"serene\",\n  \"shabby\",\n  \"sharp\",\n  \"shiny\",\n  \"showy\",\n  \"shy\",\n  \"silky\",\n  \"tempting\",\n  \"tense\",\n  \"terrific\",\n  \"testy\",\n  \"thankful\",\n  \"uniform\",\n  \"unique\",\n  \"vast\",\n  \"weary\",\n  \"wee\",\n  \"welcome\",\n  \"agile\",\n  \"alarmed\",\n  \"alert\",\n  \"alive\",\n  \"bleak\",\n  \"blissful\",\n  \"blushing\",\n  \"coarse\",\n  \"colorful\",\n  \"colossal\",\n  \"comfortable\",\n  \"compassionate\",\n  \"complete\",\n  \"delightful\",\n  \"dense\",\n  \"dependable\",\n  \"dependent\",\n  \"descriptive\",\n  \"detailed\",\n  \"determined\",\n  \"devoted\",\n  \"different\",\n  \"eminent\",\n  \"emotional\",\n  \"enchanted\",\n  \"enchanting\",\n  \"energetic\",\n  \"enormous\",\n  \"fine\",\n  \"finished\",\n  \"firm\",\n  \"firsthand\",\n  \"fixed\",\n  \"flashy\",\n  \"flawless\",\n  \"glorious\",\n  \"glossy\",\n  \"golden\",\n  \"good\",\n  \"gorgeous\",\n  \"graceful\",\n  \"healthy\",\n  \"heartfelt\",\n  \"hearty\",\n  \"helpful\",\n  \"impartial\",\n  \"impressive\",\n  \"jolly\",\n  \"jovial\",\n  \"lighthearted\",\n  \"likable\",\n  \"lined\",\n  \"mellow\",\n  \"melodic\",\n  \"memorable\",\n  \"mild\",\n  \"new\",\n  \"opulent\",\n  \"playful\",\n  \"pleasant\",\n  \"pleasing\",\n  \"plump\",\n  \"plush\",\n  \"polished\",\n  \"polite\",\n  \"reliable\",\n  \"relieved\",\n  \"remarkable\",\n  \"remote\",\n  \"respectful\",\n  \"responsible\",\n  \"simple\",\n  \"simplistic\",\n  \"sizzling\",\n  \"sleepy\",\n  \"slight\",\n  \"slim\",\n  \"smart\",\n  \"smooth\",\n  \"snappy\",\n  \"snoopy\",\n  \"thirsty\",\n  \"this\",\n  \"thorough\",\n  \"those\",\n  \"thoughtful\",\n  \"united\",\n  \"vibrant\",\n  \"vicious\",\n  \"wellmade\",\n  \"whimsical\",\n  \"whirlwind\",\n  \"zesty\",\n  \"amazing\",\n  \"ambitious\",\n  \"ample\",\n  \"amused\",\n  \"amusing\",\n  \"ancient\",\n  \"angelic\",\n  \"antique\",\n  \"bold\",\n  \"bossy\",\n  \"both\",\n  \"bouncy\",\n  \"bountiful\",\n  \"complex\",\n  \"conscious\",\n  \"considerate\",\n  \"constant\",\n  \"content\",\n  \"conventional\",\n  \"cooked\",\n  \"cool\",\n  \"cooperative\",\n  \"diligent\",\n  \"dimwitted\",\n  \"direct\",\n  \"discrete\",\n  \"envious\",\n  \"essential\",\n  \"ethical\",\n  \"euphoric\",\n  \"flippant\",\n  \"fluffy\",\n  \"flustered\",\n  \"focused\",\n  \"fond\",\n  \"gracious\",\n  \"grand\",\n  \"grandiose\",\n  \"granular\",\n  \"grateful\",\n  \"grave\",\n  \"great\",\n  \"hidden\",\n  \"high\",\n  \"hilarious\",\n  \"homely\",\n  \"incomparable\",\n  \"incredible\",\n  \"infamous\",\n  \"joyful\",\n  \"lively\",\n  \"loathsome\",\n  \"lonely\",\n  \"long\",\n  \"mindless\",\n  \"miniature\",\n  \"minor\",\n  \"misty\",\n  \"next\",\n  \"nice\",\n  \"nifty\",\n  \"nimble\",\n  \"orderly\",\n  \"organic\",\n  \"ornate\",\n  \"popular\",\n  \"posh\",\n  \"positive\",\n  \"potable\",\n  \"powerful\",\n  \"powerless\",\n  \"precious\",\n  \"present\",\n  \"prestigious\",\n  \"quick\",\n  \"rewarding\",\n  \"rich\",\n  \"right\",\n  \"sociable\",\n  \"soft\",\n  \"solid\",\n  \"some\",\n  \"sophisticated\",\n  \"soulful\",\n  \"sparkling\",\n  \"spectacular\",\n  \"speedy\",\n  \"spicy\",\n  \"spiffy\",\n  \"spirited\",\n  \"spiteful\",\n  \"splendid\",\n  \"spotless\",\n  \"spry\",\n  \"thrifty\",\n  \"tidy\",\n  \"tight\",\n  \"timely\",\n  \"tinted\",\n  \"unruly\",\n  \"untimely\",\n  \"violet\",\n  \"wicked\",\n  \"wide\",\n  \"wild\",\n  \"willing\",\n  \"winding\",\n  \"windy\",\n  \"zigzag\",\n  \"apprehensive\",\n  \"appropriate\",\n  \"artistic\",\n  \"assured\",\n  \"astonishing\",\n  \"bright\",\n  \"brilliant\",\n  \"bronze\",\n  \"coordinated\",\n  \"courageous\",\n  \"courteous\",\n  \"crafty\",\n  \"crazy\",\n  \"creamy\",\n  \"creative\",\n  \"crisp\",\n  \"distant\",\n  \"distinct\",\n  \"downright\",\n  \"evergreen\",\n  \"everlasting\",\n  \"every\",\n  \"evil\",\n  \"excellent\",\n  \"excitable\",\n  \"exemplary\",\n  \"exhausted\",\n  \"forthright\",\n  \"fortunate\",\n  \"fragrant\",\n  \"frank\",\n  \"free\",\n  \"frequent\",\n  \"fresh\",\n  \"friendly\",\n  \"frightened\",\n  \"frigid\",\n  \"gripping\",\n  \"grounded\",\n  \"honest\",\n  \"honorable\",\n  \"honored\",\n  \"hopeful\",\n  \"hospitable\",\n  \"hot\",\n  \"huge\",\n  \"infatuated\",\n  \"infinite\",\n  \"informal\",\n  \"insistent\",\n  \"instructive\",\n  \"juicy\",\n  \"jumbo\",\n  \"knowing\",\n  \"knowledgeable\",\n  \"longterm\",\n  \"loud\",\n  \"lovable\",\n  \"loving\",\n  \"modern\",\n  \"modest\",\n  \"monumental\",\n  \"normal\",\n  \"notable\",\n  \"outgoing\",\n  \"precious\",\n  \"pretty\",\n  \"prickly\",\n  \"primary\",\n  \"pristine\",\n  \"private\",\n  \"prize\",\n  \"productive\",\n  \"profitable\",\n  \"quiet\",\n  \"quintessential\",\n  \"roasted\",\n  \"robust\",\n  \"square\",\n  \"squiggly\",\n  \"stable\",\n  \"staid\",\n  \"starry\",\n  \"steel\",\n  \"stimulating\",\n  \"striking\",\n  \"striped\",\n  \"strong\",\n  \"studious\",\n  \"stunning\",\n  \"tough\",\n  \"trained\",\n  \"treasured\",\n  \"tremendous\",\n  \"triangular\",\n  \"tricky\",\n  \"unused\",\n  \"unusual\",\n  \"upbeat\",\n  \"virtual\",\n  \"witty\",\n  \"wonderful\",\n  \"wooden\",\n  \"worldly\",\n  \"youthful\",\n  \"attached\",\n  \"attentive\",\n  \"attractive\",\n  \"austere\",\n  \"authentic\",\n  \"automatic\",\n  \"aware\",\n  \"awesome\",\n  \"bubbly\",\n  \"bustling\",\n  \"busy\",\n  \"buttery\",\n  \"cuddly\",\n  \"cultured\",\n  \"curly\",\n  \"curvy\",\n  \"cute\",\n  \"cylindrical\",\n  \"downright\",\n  \"dramatic\",\n  \"excited\",\n  \"exciting\",\n  \"exotic\",\n  \"experienced\",\n  \"expert\",\n  \"frosty\",\n  \"fruitful\",\n  \"full\",\n  \"fumbling\",\n  \"funny\",\n  \"fussy\",\n  \"growing\",\n  \"grown\",\n  \"gummy\",\n  \"humble\",\n  \"humongous\",\n  \"hungry\",\n  \"intelligent\",\n  \"interesting\",\n  \"known\",\n  \"kooky\",\n  \"loyal\",\n  \"lucky\",\n  \"luminous\",\n  \"lustrous\",\n  \"luxurious\",\n  \"multicolored\",\n  \"mysterious\",\n  \"noteworthy\",\n  \"numb\",\n  \"nutritious\",\n  \"outstanding\",\n  \"overjoyed\",\n  \"proper\",\n  \"proud\",\n  \"prudent\",\n  \"punctual\",\n  \"puny\",\n  \"pure\",\n  \"puzzled\",\n  \"puzzling\",\n  \"quirky\",\n  \"stupendous\",\n  \"sturdy\",\n  \"stylish\",\n  \"subdued\",\n  \"subtle\",\n  \"sunny\",\n  \"super\",\n  \"superb\",\n  \"supportive\",\n  \"surprised\",\n  \"sweet\",\n  \"swift\",\n  \"sympathetic\",\n  \"trivial\",\n  \"trusting\",\n  \"trustworthy\",\n  \"trusty\",\n  \"truthful\",\n  \"twin\",\n  \"usable\",\n  \"used\",\n  \"useful\",\n  \"utilized\",\n  \"vital\",\n  \"vivid\",\n  \"worried\",\n  \"worthwhile\",\n  \"worthy\",\n  \"writhing\",\n  \"wry\",\n  \"yummy\",\n  \"chocolate\",\n  \"crimson\",\n  \"cyan\",\n  \"fuchsia\",\n  \"gold\",\n  \"honeydew\",\n  \"lime\",\n  \"linen\",\n  \"magenta\",\n  \"olive\",\n  \"peru\",\n  \"salmon\",\n  \"seashell\",\n  \"sienna\",\n  \"snow\",\n  \"thistle\",\n  \"tomato\",\n  \"transparent\",\n  \"turquoise\",\n  \"violet\"\n];\n\nconst nouns = [\n  \"space\",\n  \"land\",\n  \"world\",\n  \"universe\",\n  \"plane\",\n  \"room\",\n  \"nation\",\n  \"plaza\",\n  \"gathering\",\n  \"meetup\",\n  \"get together\",\n  \"conclave\",\n  \"party\",\n  \"domain\",\n  \"dominion\",\n  \"realm\",\n  \"square\",\n  \"commons\",\n  \"park\",\n  \"cosmos\",\n  \"sphere\",\n  \"terrain\",\n  \"spot\",\n  \"zone\",\n  \"area\",\n  \"tract\",\n  \"turf\",\n  \"place\",\n  \"territory\",\n  \"volume\",\n  \"camp\",\n  \"picnic\",\n  \"outing\",\n  \"vacation\",\n  \"adventure\",\n  \"exploration\",\n  \"outing\",\n  \"walkabout\",\n  \"safari\",\n  \"venture\",\n  \"roundtable\",\n  \"barbecue\",\n  \"celebration\",\n  \"festivity\",\n  \"gala\",\n  \"shindig\",\n  \"social\",\n  \"convention\",\n  \"assembly\",\n  \"congregation\",\n  \"rendezvous\",\n  \"huddle\",\n  \"meet\",\n  \"soiree\"\n];\n\nexport function generateHubName() {\n  const randItem = set => {\n    const s = set[Math.floor(Math.random() * set.length)];\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  };\n\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport configs from \"../utils/configs\";\nimport { sleep } from \"../utils/async-utils\";\n\nimport Store from \"../storage/store\";\n\nexport function hasReticulumServer() {\n  return !!configs.RETICULUM_SERVER;\n}\n\nexport function isLocalClient() {\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\n}\n\nexport function hubUrl(hubId, extraParams, slug) {\n  if (!hubId) {\n    if (isLocalClient()) {\n      hubId = new URLSearchParams(location.search).get(\"hub_id\");\n    } else {\n      hubId = location.pathname.split(\"/\")[1];\n    }\n  }\n\n  let url;\n  if (isLocalClient()) {\n    url = new URL(`/hub.html`, location.href);\n    url.searchParams.set(\"hub_id\", hubId);\n  } else {\n    const maybeSlug = slug ? `/${slug}` : \"\";\n    url = new URL(`/${hubId}${maybeSlug}`, location.href);\n  }\n\n  for (const key in extraParams) {\n    if (extraParams.hasOwnProperty(key)) {\n      url.searchParams.set(key, extraParams[key]);\n    }\n  }\n\n  return url;\n}\n\nconst resolverLink = document.createElement(\"a\");\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport function getReticulumFetchUrl(path, absolute = false, host = null, port = null) {\n  if (host || hasReticulumServer()) {\n    return `https://${host || configs.RETICULUM_SERVER}${port ? `:${port}` : \"\"}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nexport function getUploadsUrl(path, absolute = false, host = null, port = null) {\n  // If the Hubs Cloud stack is configured to use Cloudflare, we need to ignore the configured UPLOADS_HOST\n  // since reticulum will only serve uploads via the Cloudflare worker. BASE_ASSETS_PATH will have been\n  // correctly configured to use the Cloudflare worker, though we only need the hostname,\n  // not the full assets URL.\n  const isUsingCloudflare = configs.BASE_ASSETS_PATH.includes(\"workers.dev\");\n  const uploadsHost = isUsingCloudflare ? new URL(configs.BASE_ASSETS_PATH).hostname : configs.UPLOADS_HOST;\n  return uploadsHost\n    ? `https://${uploadsHost}${port ? `:${port}` : \"\"}${path}`\n    : getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nlet directReticulumHostAndPort;\n\nasync function refreshDirectReticulumHostAndPort() {\n  const qs = new URLSearchParams(location.search);\n  let host = qs.get(\"phx_host\");\n  const reticulumMeta = await getReticulumMeta();\n  host = host || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n  const port =\n    qs.get(\"phx_port\") ||\n    (hasReticulumServer() ? new URL(`${document.location.protocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\n  directReticulumHostAndPort = { host, port };\n}\n\nexport function getDirectReticulumFetchUrl(path, absolute = false) {\n  if (!directReticulumHostAndPort) {\n    console.warn(\"Cannot call getDirectReticulumFetchUrl before connectToReticulum. Returning non-direct url.\");\n    return getReticulumFetchUrl(path, absolute);\n  }\n\n  const { host, port } = directReticulumHostAndPort;\n  return getReticulumFetchUrl(path, absolute, host, port);\n}\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    await refreshDirectReticulumHostAndPort();\n    const { host, port } = directReticulumHostAndPort;\n    const protocol =\n      qs.get(\"phx_protocol\") ||\n      configs.RETICULUM_SOCKET_PROTOCOL ||\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n\n    return `${protocol}//${host}${port ? `:${port}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (isLocalClient()) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\nfunction migrateBindings(oldChannel, newChannel) {\n  const doNotDuplicate = [\"phx_close\", \"phx_error\", \"phx_reply\", \"presence_state\", \"presence_diff\"];\n  const shouldDuplicate = event => {\n    return !event.startsWith(\"chan_reply_\") && !doNotDuplicate.includes(event);\n  };\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    if (shouldDuplicate(item.event)) {\n      newChannel.bindings.push(item);\n    }\n  }\n  newChannel.bindingRef = oldChannel.bindingRef;\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  migrateBindings(oldChannel, channel);\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function migrateToChannel(oldChannel, newChannel) {\n  migrateBindings(oldChannel, newChannel);\n\n  return new Promise((resolve, reject) => {\n    newChannel\n      .join()\n      .receive(\"ok\", data => {\n        oldChannel.leave();\n        oldChannel.bindings = [];\n        resolve(data);\n      })\n      .receive(\"error\", data => {\n        newChannel.leave();\n        reject(data);\n      });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n\nexport function hasEmbedPresences(presences) {\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.context && m.context.embed) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function denoisePresence({ onJoin, onLeave, onChange }) {\n  return {\n    rawOnJoin: (key, beforeJoin, afterJoin) => {\n      if (beforeJoin === undefined) {\n        onJoin(key, afterJoin.metas[0]);\n      }\n    },\n    rawOnLeave: (key, remaining, removed) => {\n      if (remaining.metas.length === 0) {\n        onLeave(key, removed.metas[0]);\n      } else {\n        onChange(key, removed.metas[removed.metas.length - 1], remaining.metas[remaining.metas.length - 1]);\n      }\n    }\n  };\n}\n\nexport function presenceEventsForHub(events) {\n  const onJoin = (key, meta) => {\n    events.trigger(`hub:join`, { key, meta });\n  };\n  const onLeave = (key, meta) => {\n    events.trigger(`hub:leave`, { key, meta });\n  };\n  const onChange = (key, previous, current) => {\n    events.trigger(`hub:change`, { key, previous, current });\n  };\n  return {\n    onJoin,\n    onLeave,\n    onChange\n  };\n}\n\nexport const tryGetMatchingMeta = async ({ ret_pool, ret_version }, shouldAbandonMigration) => {\n  const backoffMS = 5000;\n  const randomMS = 15000;\n  const maxAttempts = 10;\n  let didMatchMeta = false;\n  let attempt = 0;\n  while (!didMatchMeta && attempt < maxAttempts && !shouldAbandonMigration()) {\n    try {\n      // Add randomness to the first request avoid flooding reticulum.\n      const delayMS = attempt * backoffMS + (attempt === 0 ? Math.random() * randomMS : 0);\n      console.log(\n        `[reconnect] Getting reticulum meta in ${Math.ceil(delayMS / 1000)} seconds.${\n          attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"\n        }`\n      );\n      await sleep(delayMS);\n      invalidateReticulumMeta();\n      console.log(`[reconnect] Getting reticulum meta.${attempt ? ` (Attempt ${attempt + 1} of ${maxAttempts})` : \"\"}`);\n      const { pool, version } = await getReticulumMeta();\n      didMatchMeta = ret_pool === pool && ret_version === version;\n    } catch {\n      didMatchMeta = false;\n    }\n\n    attempt = attempt + 1;\n  }\n  return didMatchMeta;\n};\n","import { themes } from \"../react-components/styles/theme\";\n\nexport function getColorSchemePref() {\n  const darkmodeQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  const darkMode = darkmodeQuery.matches;\n  return (darkMode && themes.find(t => t.darkModeDefault)) || themes.find(t => t.default);\n}\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-url-utils\";\nimport avatarUnavailableImage from \"../assets/images/avatar_unavailable.png\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nexport const AVATAR_TYPES = {\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nexport function getAvatarType(avatarId) {\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchSkinnableAvatar(avatarId) {\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\n  return resp && resp.avatars && resp.avatars[0];\n}\n\nexport async function fetchAvatar(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchSkinnableAvatar(avatarId);\n    case AVATAR_TYPES.URL:\n      return {\n        avatar_id: avatarId,\n        gltf_url: proxiedUrlFor(avatarId)\n      };\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return avatarUnavailableImage;\n  }\n}\n\n// Currently the way we do material overrides is with a special named material.\n// We want to migrate eventually to having a GLTF extension that specifies what\n// materials can be overridden, but in the meantime we want to be able to support\n// arbitrary models with some sort of functionality. This provides a fallback\nexport const MAT_NAME = \"Bot_PBS\";\nexport function ensureAvatarMaterial(gltf) {\n  if (gltf.materials.find(m => m.name === MAT_NAME)) return gltf;\n\n  function materialForMesh(mesh) {\n    if (!mesh.primitives) return;\n    const primitive = mesh.primitives.find(p => p.material !== undefined);\n    return primitive && gltf.materials[primitive.material];\n  }\n\n  let nodes = gltf.scenes[gltf.scene].nodes.slice(0);\n  while (nodes.length) {\n    const node = gltf.nodes[nodes.shift()];\n    const material = node.mesh !== undefined && materialForMesh(gltf.meshes[node.mesh]);\n    if (material) {\n      material.name = MAT_NAME;\n      break;\n    }\n    if (node.children) nodes = nodes.concat(node.children);\n  }\n\n  return gltf;\n}\n\nexport async function remixAvatar(parentId, name) {\n  const avatar = {\n    parent_avatar_listing_id: parentId,\n    name: name,\n    files: {}\n  };\n\n  return fetchReticulumAuthenticated(AVATARS_API, \"POST\", { avatar });\n}\n","import { waitForDOMContentLoaded } from \"./async-utils\";\nimport configs from \"./configs\";\n\n// Node these should be synchronized with the top of shared.scss\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\n\nconst DEFAULT_COLORS = {\n  \"action-color\": DEFAULT_ACTION_COLOR,\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\n  \"action-text-color\": \"#FFFFFF\",\n  \"action-subtitle-color\": \"#F0F0F0\",\n  \"notice-background-color\": \"#2F80ED\",\n  \"notice-text-color\": \"#FFFFFF\",\n  \"favorited-color\": \"#FFC000\",\n  \"nametag-color\": \"#000000\",\n  \"nametag-volume-color\": \"#7ED320\",\n  \"nametag-text-color\": \"#FFFFFF\",\n  \"nametag-border-color\": \"#7ED320\",\n  \"nametag-border-color-raised-hand\": \"#FFCD74\"\n};\n\nfunction getThemeColor(name) {\n  const themeId = window.APP?.store?.state?.preferences?.theme;\n\n  const theme =\n    (themeId && configs.APP_CONFIG?.theme?.themes?.find(theme => theme.id === themeId)) ||\n    configs.APP_CONFIG?.theme?.themes?.find(theme => theme.default === true);\n  if (theme?.variables?.[name]) {\n    return theme.variables[name];\n  }\n\n  return DEFAULT_COLORS[name];\n}\n\nfunction activateTheme() {\n  const actionColor = getThemeColor(\"action-color\");\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\n\n  if (document.querySelector(\"#rounded-text-button\")) {\n    // NOTE, using the object-based {} setAttribute variant in a-frame\n    // seems to not work in Firefox here -- the entities with the mixins are not\n    // updated.\n    document\n      .querySelector(\"#rounded-text-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\n      );\n\n    document\n      .querySelector(\"#rounded-text-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n\n    document\n      .querySelector(\"#rounded-action-button\")\n      .setAttribute(\n        \"text-button\",\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\n      );\n  }\n}\n\nconst onStoreChanged = (function() {\n  let themeId;\n  return function onStoreChanged() {\n    const newThemeId = window.APP?.store?.state?.preferences?.theme;\n    if (themeId !== newThemeId) {\n      themeId = newThemeId;\n      activateTheme();\n    }\n  };\n})();\n\nwaitForDOMContentLoaded().then(() => {\n  if (configs.APP_CONFIG && configs.APP_CONFIG.theme && configs.APP_CONFIG.theme[\"dark-theme\"]) {\n    document.body.classList.add(\"dark-theme\");\n  } else {\n    document.body.classList.add(\"light-theme\");\n  }\n  activateTheme();\n  window.APP?.store?.addEventListener(\"statechanged\", onStoreChanged);\n});\n\nfunction applyThemeToTextButton(el, highlighted) {\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundColor\",\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\n  );\n  el.setAttribute(\n    \"text-button\",\n    \"backgroundHoverColor\",\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\n  );\n}\n\nexport { applyThemeToTextButton, getThemeColor };\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// Disable ImageBitmap for Firefox so far because\n// createImageBitmap() with option fails on Firefox due to the bug.\n// Three.js ImageBitmapLoader passes {colorSpaceConversion: 'none'} option.\n// Without the option, the rendering result can be wrong if image file has ICC profiles.\n// See https://github.com/mrdoob/three.js/pull/21336\nconst HAS_IMAGE_BITMAP = window.createImageBitmap !== undefined && /Firefox/.test(navigator.userAgent) === false;\nexport const TEXTURES_FLIP_Y = !HAS_IMAGE_BITMAP;\n\nexport default class HubsTextureLoader extends THREE.TextureLoader {\n  constructor(manager) {\n    super(manager);\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const texture = HAS_IMAGE_BITMAP\n      ? this.loadImageBitmapTexture(url, onLoad, onProgress, onError)\n      : super.load(url, onLoad, onProgress, onError);\n\n    texture.onUpdate = function() {\n      // Delete texture data once it has been uploaded to the GPU\n      texture.image.close && texture.image.close();\n      delete texture.image;\n    };\n\n    return texture;\n  }\n\n  async loadAsync(url, onProgress) {\n    return new Promise((resolve, reject) => {\n      this.load(url, resolve, onProgress, reject);\n    });\n  }\n\n  loadImageBitmapTexture(url, onLoad, onProgress, onError) {\n    const texture = new THREE.Texture();\n    const loader = new THREE.ImageBitmapLoader(this.manager);\n    loader.setCrossOrigin(this.crossOrigin);\n    loader.setPath(this.path);\n\n    loader.load(\n      url,\n      bitmap => {\n        texture.image = bitmap;\n        texture.needsUpdate = true;\n\n        // We close the image bitmap when it's uploaded to texture.\n        // Closed image bitmap can't be reused so we remove the cache\n        // added in ImageBitmapLoader.\n        // You can remove this line once we entirely disable THREE.Cache.\n        THREE.Cache.remove(this.manager.resolveURL(url));\n\n        if (onLoad !== undefined) {\n          onLoad(texture);\n        }\n      },\n      onProgress,\n      onError\n    );\n\n    texture.flipY = false;\n    return texture;\n  }\n}\n"],"sourceRoot":""}