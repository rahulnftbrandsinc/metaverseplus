(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{111:function(e,t,n){"use strict";var r=e.exports.Validator=n(861);e.exports.ValidatorResult=n(337).ValidatorResult,e.exports.ValidationError=n(337).ValidationError,e.exports.SchemaError=n(337).SchemaError,e.exports.SchemaScanResult=n(488).SchemaScanResult,e.exports.scan=n(488).scan,e.exports.validate=function(e,t,n){return(new r).validate(e,t,n)}},337:function(e,t,n){"use strict";var r=n(185),i=t.ValidationError=function(e,t,n,r,i,s){r&&(this.property=r),e&&(this.message=e),n&&(n.id?this.schema=n.id:this.schema=n),t&&(this.instance=t),this.name=i,this.argument=s,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var s=t.ValidatorResult=function(e,t,n,r){this.instance=e,this.schema=t,this.propertyPath=r.propertyPath,this.errors=[],this.throwError=n&&n.throwError,this.disableFormat=n&&!0===n.disableFormat};function o(e,t){return t+": "+e.toString()+"\n"}s.prototype.addError=function(e){var t;if("string"==typeof e)t=new i(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new i(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t},s.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)},s.prototype.toString=function(e){return this.errors.map(o).join("")},Object.defineProperty(s.prototype,"valid",{get:function(){return!this.errors.length}});var a=t.SchemaError=function e(t,n){this.message=t,this.schema=n,Error.call(this,t),Error.captureStackTrace(this,e)};a.prototype=Object.create(Error.prototype,{constructor:{value:a,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var c=t.SchemaContext=function(e,t,n,r,i){this.schema=e,this.options=t,this.propertyPath=n,this.base=r,this.schemas=i};c.prototype.resolve=function(e){return r.resolve(this.base,e)},c.prototype.makeChild=function(e,t){var n=void 0===t?this.propertyPath:this.propertyPath+l(t),i=r.resolve(this.base,e.id||""),s=new c(e,this.options,n,i,Object.create(this.schemas));return e.id&&!s.schemas[i]&&(s.schemas[i]=e),s};var h=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};h.regexp=h.regex,h.pattern=h.regex,h.ipv4=h["ip-address"],t.isFormat=function(e,t,n){if("string"==typeof e&&void 0!==h[t]){if(h[t]instanceof RegExp)return h[t].test(e);if("function"==typeof h[t])return h[t](e)}else if(n&&n.customFormats&&"function"==typeof n.customFormats[t])return n.customFormats[t](e);return!0};var l=t.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function u(e,t,n,r){"object"==typeof n?t[r]=d(e[r],n):-1===e.indexOf(n)&&t.push(n)}function f(e,t,n){t[n]=e[n]}function p(e,t,n,r){"object"==typeof t[r]&&t[r]&&e[r]?n[r]=d(e[r],t[r]):n[r]=t[r]}function d(e,t){var n=Array.isArray(t),r=n&&[]||{};return n?(e=e||[],r=r.concat(e),t.forEach(u.bind(null,e,r))):(e&&"object"==typeof e&&Object.keys(e).forEach(f.bind(null,e,r)),Object.keys(t).forEach(p.bind(null,e,t,r))),r}function m(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}t.deepCompareStrict=function e(t,n){if(typeof t!=typeof n)return!1;if(t instanceof Array)return n instanceof Array&&(t.length===n.length&&t.every((function(r,i){return e(t[i],n[i])})));if("object"==typeof t){if(!t||!n)return t===n;var r=Object.keys(t),i=Object.keys(n);return r.length===i.length&&r.every((function(r){return e(t[r],n[r])}))}return t===n},e.exports.deepMerge=d,t.objectGetPath=function(e,t){for(var n,r=t.split("/").slice(1);"string"==typeof(n=r.shift());){var i=decodeURIComponent(n.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in e))return;e=e[i]}return e},t.encodePath=function(e){return e.map(m).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var n=e.toString().split("e");if(2===n.length){if("-"!==n[1][0])return t;t=Number(n[1].slice(1))}var r=n[0].split(".");return 2===r.length&&(t+=r[1].length),t}},34:function(e,t,n){"use strict";var r=n(863);function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(e){throw new i("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=i},488:function(e,t,n){var r=n(185),i=n(337);function s(e,t){this.id=e,this.ref=t}e.exports.SchemaScanResult=s,e.exports.scan=function(e,t){function n(e,t){if(t&&"object"==typeof t)if(t.$ref){var s=r.resolve(e,t.$ref);h[s]=h[s]?h[s]+1:0}else{var l=t.id?r.resolve(e,t.id):e;if(l){if(l.indexOf("#")<0&&(l+="#"),c[l]){if(!i.deepCompareStrict(c[l],t))throw new Error("Schema <"+t+"> already exists with different definition");return c[l]}c[l]=t,"#"==l[l.length-1]&&(c[l.substring(0,l.length-1)]=t)}o(l+"/items",t.items instanceof Array?t.items:[t.items]),o(l+"/extends",t.extends instanceof Array?t.extends:[t.extends]),n(l+"/additionalItems",t.additionalItems),a(l+"/properties",t.properties),n(l+"/additionalProperties",t.additionalProperties),a(l+"/definitions",t.definitions),a(l+"/patternProperties",t.patternProperties),a(l+"/dependencies",t.dependencies),o(l+"/disallow",t.disallow),o(l+"/allOf",t.allOf),o(l+"/anyOf",t.anyOf),o(l+"/oneOf",t.oneOf),n(l+"/not",t.not)}}function o(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++)n(e+"/"+r,t[r])}function a(e,t){if(t&&"object"==typeof t)for(var r in t)n(e+"/"+r,t[r])}var c={},h={};return n(e,t),new s(c,h)}},54:function(e,t,n){var r,i;
/*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(s){if(void 0===(i="function"==typeof(r=s)?r.call(t,n,t,e):r)||(e.exports=i),!0,e.exports=s(),!!0){var o=window.Cookies,a=window.Cookies=s();a.noConflict=function(){return window.Cookies=o,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,i,s){var o;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(s=e({path:"/"},r.defaults,s)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*s.expires),s.expires=a}s.expires=s.expires?s.expires.toUTCString():"";try{o=JSON.stringify(i),/^[\{\[]/.test(o)&&(i=o)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var h in s)s[h]&&(c+="; "+h,!0!==s[h]&&(c+="="+s[h]));return document.cookie=t+"="+i+c}t||(o={});for(var l=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,f=0;f<l.length;f++){var p=l[f].split("="),d=p.slice(1).join("=");this.json||'"'!==d.charAt(0)||(d=d.slice(1,-1));try{var m=p[0].replace(u,decodeURIComponent);if(d=n.read?n.read(d,m):n(d,m)||d.replace(u,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(t===m){o=d;break}t||(o[m]=d)}catch(e){}}return o}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}((function(){}))}))},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));const r=new WeakMap,i=new WeakMap;function s(e){const t=r.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function o(e,t){r.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(t);for(let e=0;e<n.length;++e){const t=n[e];t in this||Object.defineProperty(this,t,a(t))}}function a(e){return{get(){return s(this).event[e]},set(t){s(this).event[e]=t},configurable:!0,enumerable:!0}}function c(e){return{value(){const t=s(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function h(e){if(null==e||e===Object.prototype)return o;let t=i.get(e);return null==t&&(t=function(e,t){const n=Object.keys(t);if(0===n.length)return e;function r(t,n){e.call(this,t,n)}r.prototype=Object.create(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let i=0;i<n.length;++i){const s=n[i];if(!(s in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,s).value;Object.defineProperty(r.prototype,s,e?c(s):a(s))}}return r}(h(Object.getPrototypeOf(e)),e),i.set(e,t)),t}function l(e){return s(e).stopped}function u(e,t){s(e).passiveListener=t}o.prototype={get type(){return s(this).event.type},get target(){return s(this).eventTarget},get currentTarget(){return s(this).currentTarget},composedPath(){const e=s(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return s(this).eventPhase},stopPropagation(){const e=s(this);"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=s(this);e.stopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(s(this).event.bubbles)},get cancelable(){return Boolean(s(this).event.cancelable)},preventDefault(){const e=s(this);null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):console.warn("Event#preventDefault() was called from a passive listener:",e.passiveListener)},get defaultPrevented(){return s(this).canceled},get composed(){return Boolean(s(this).event.composed)},get timeStamp(){return s(this).timeStamp}},Object.defineProperty(o.prototype,"constructor",{value:o,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(o.prototype,window.Event.prototype),i.set(window.Event.prototype,o));const f=new WeakMap;function p(e){return null!==e&&"object"==typeof e}function d(e){const t=f.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function m(e,t){Object.defineProperty(e,"on"+t,function(e){return{get(){let t=d(this).get(e);for(;null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set(t){"function"==typeof t||p(t)||(t=null);const n=d(this);let r=null,i=n.get(e);for(;null!=i;)3===i.listenerType?null!==r?r.next=i.next:null!==i.next?n.set(e,i.next):n.delete(e):r=i,i=i.next;if(null!==t){const i={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(e,i):r.next=i}},configurable:!0,enumerable:!0}}(t))}function g(e){function t(){v.call(this)}t.prototype=Object.create(v.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let n=0;n<e.length;++n)m(t.prototype,e[n]);return t}function v(){if(!(this instanceof v)){if(1===arguments.length&&Array.isArray(arguments[0]))return g(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return g(e)}throw new TypeError("Cannot call a class as a function")}f.set(this,new Map)}v.prototype={addEventListener(e,t,n){if(null==t)return!1;if("function"!=typeof t&&!p(t))throw new TypeError("'listener' should be a function or an object.");const r=d(this),i=p(n),s=(i?Boolean(n.capture):Boolean(n))?1:2,o={listener:t,listenerType:s,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null};let a=r.get(e);if(void 0===a)return r.set(e,o),!0;let c=null;for(;null!=a;){if(a.listener===t&&a.listenerType===s)return!1;c=a,a=a.next}return c.next=o,!0},removeEventListener(e,t,n){if(null==t)return!1;const r=d(this),i=(p(n)?Boolean(n.capture):Boolean(n))?1:2;let s=null,o=r.get(e);for(;null!=o;){if(o.listener===t&&o.listenerType===i)return null!==s?s.next=o.next:null!==o.next?r.set(e,o.next):r.delete(e),!0;s=o,o=o.next}return!1},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=d(this),n=e.type;let r=t.get(n);if(null==r)return!0;const i=function(e,t){return new(h(Object.getPrototypeOf(t)))(e,t)}(this,e);let o=null;for(;null!=r;){if(r.once?null!==o?o.next=r.next:null!==r.next?t.set(n,r.next):t.delete(n):o=r,u(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(l(i))break;r=r.next}return u(i,null),function(e,t){s(e).eventPhase=t}(i,0),function(e,t){s(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(v.prototype,"constructor",{value:v,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(v.prototype,window.EventTarget.prototype)},861:function(e,t,n){"use strict";var r=n(185),i=n(862),s=n(337),o=n(488).scan,a=s.ValidatorResult,c=s.SchemaError,h=s.SchemaContext,l=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(f),this.attributes=Object.create(i.validators)};function u(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}l.prototype.customFormats={},l.prototype.schemas=null,l.prototype.types=null,l.prototype.attributes=null,l.prototype.unresolvedRefs=null,l.prototype.addSchema=function(e,t){var n=this;if(!e)return null;var r=o(t||"/",e),i=t||e.id;for(var s in r.id)this.schemas[s]=r.id[s];for(var s in r.ref)this.unresolvedRefs.push(s);return this.unresolvedRefs=this.unresolvedRefs.filter((function(e){return void 0===n.schemas[e]})),this.schemas[i]},l.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)this.addSubSchema(e,t[n])},l.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var n in t)this.addSubSchema(e,t[n])},l.prototype.setSchemas=function(e){this.schemas=e},l.prototype.getSchema=function(e){return this.schemas[e]},l.prototype.validate=function(e,t,n,i){n||(n={});var s=n.propertyName||"instance",a=r.resolve(n.base||"/",t.id||"");if(!i){(i=new h(t,n,s,a,Object.create(this.schemas))).schemas[a]||(i.schemas[a]=t);var l=o(a,t);for(var u in l.id){var f=l.id[u];i.schemas[u]=f}}if(t){var p=this.validateSchema(e,t,n,i);if(!p)throw new Error("Result undefined");return p}throw new c("no schema specified",t)},l.prototype.validateSchema=function(e,t,n,r){var o,l=new a(e,t,n,r);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var f={schema:t,ctx:r};t.extends.forEach(this.schemaTraverser.bind(this,f)),t=f.schema,f.schema=null,f.ctx=null,f=null}else t=s.deepMerge(t,this.superResolve(t.extends,r));if(o=u(t)){var p=this.resolve(t,o,r),d=new h(p.subschema,n,r.propertyPath,p.switchSchema,r.schemas);return this.validateSchema(e,p.subschema,n,d)}var m=n&&n.skipAttributes||[];for(var g in t)if(!i.ignoreProperties[g]&&m.indexOf(g)<0){var v=null,y=this.attributes[g];if(y)v=y.call(this,e,t,n,r);else if(!1===n.allowUnknownAttributes)throw new c("Unsupported attribute: "+g,t);v&&l.importErrors(v)}if("function"==typeof n.rewrite){var b=n.rewrite.call(this,e,t,n,r);l.instance=b}return l},l.prototype.schemaTraverser=function(e,t){e.schema=s.deepMerge(e.schema,this.superResolve(t,e.ctx))},l.prototype.superResolve=function(e,t){var n;return(n=u(e))?this.resolve(e,n,t).subschema:e},l.prototype.resolve=function(e,t,n){if(t=n.resolve(t),n.schemas[t])return{subschema:n.schemas[t],switchSchema:t};var i=r.parse(t),o=i&&i.hash,a=o&&o.length&&t.substr(0,t.length-o.length);if(!a||!n.schemas[a])throw new c("no such schema <"+t+">",e);var h=s.objectGetPath(n.schemas[a],o.substr(1));if(void 0===h)throw new c("no such schema "+o+" located in <"+a+">",e);return{subschema:h,switchSchema:t}},l.prototype.testType=function(e,t,n,r,i){if("function"==typeof this.types[i])return this.types[i].call(this,e);if(i&&"object"==typeof i){var s=this.validateSchema(e,i,n,r);return void 0===s||!(s&&s.errors.length)}return!0};var f=l.prototype.types={};f.string=function(e){return"string"==typeof e},f.number=function(e){return"number"==typeof e&&isFinite(e)},f.integer=function(e){return"number"==typeof e&&e%1==0},f.boolean=function(e){return"boolean"==typeof e},f.array=function(e){return Array.isArray(e)},f.null=function(e){return null===e},f.date=function(e){return e instanceof Date},f.any=function(e){return!0},f.object=function(e){return e&&"object"==typeof e&&!(e instanceof Array)&&!(e instanceof Date)},e.exports=l},862:function(e,t,n){"use strict";var r=n(337),i=r.ValidatorResult,s=r.SchemaError,o={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},a=o.validators={};function c(e,t,n,r,i){var s=t.throwError;t.throwError=!1;var o=this.validateSchema(e,i,t,n);return t.throwError=s,!o.valid&&r instanceof Function&&r(o),o.valid}function h(e,t,n,r,i,s){if(this.types.object(e)&&(!t.properties||void 0===t.properties[i]))if(!1===t.additionalProperties)s.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var o=t.additionalProperties||{};"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,i,o,n,r);var a=this.validateSchema(e[i],o,n,r.makeChild(o,i));a.instance!==s.instance[i]&&(s.instance[i]=a.instance),s.importErrors(a)}}a.type=function(e,t,n,r){if(void 0===e)return null;var s=new i(e,t,n,r),o=Array.isArray(t.type)?t.type:[t.type];if(!o.some(this.testType.bind(this,e,t,n,r))){var a=o.map((function(e){return e.id&&"<"+e.id+">"||e+""}));s.addError({name:"type",argument:a,message:"is not of a type(s) "+a})}return s},a.anyOf=function(e,t,n,r){if(void 0===e)return null;var o=new i(e,t,n,r),a=new i(e,t,n,r);if(!Array.isArray(t.anyOf))throw new s("anyOf must be an array");if(!t.anyOf.some(c.bind(this,e,n,r,(function(e){a.importErrors(e)})))){var h=t.anyOf.map((function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));n.nestedErrors&&o.importErrors(a),o.addError({name:"anyOf",argument:h,message:"is not any of "+h.join(",")})}return o},a.allOf=function(e,t,n,r){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new s("allOf must be an array");var o=new i(e,t,n,r),a=this;return t.allOf.forEach((function(t,i){var s=a.validateSchema(e,t,n,r);if(!s.valid){var c=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+i+"]";o.addError({name:"allOf",argument:{id:c,length:s.errors.length,valid:s},message:"does not match allOf schema "+c+" with "+s.errors.length+" error[s]:"}),o.importErrors(s)}})),o},a.oneOf=function(e,t,n,r){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new s("oneOf must be an array");var o=new i(e,t,n,r),a=new i(e,t,n,r),h=t.oneOf.filter(c.bind(this,e,n,r,(function(e){a.importErrors(e)}))).length,l=t.oneOf.map((function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));return 1!==h&&(n.nestedErrors&&o.importErrors(a),o.addError({name:"oneOf",argument:l,message:"is not exactly one from "+l.join(",")})),o},a.properties=function(e,t,n,r){if(this.types.object(e)){var s=new i(e,t,n,r),o=t.properties||{};for(var a in o){"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,a,o[a],n,r);var c=Object.hasOwnProperty.call(e,a)?e[a]:void 0,h=this.validateSchema(c,o[a],n,r.makeChild(o[a],a));h.instance!==s.instance[a]&&(s.instance[a]=h.instance),s.importErrors(h)}return s}},a.patternProperties=function(e,t,n,r){if(this.types.object(e)){var s=new i(e,t,n,r),o=t.patternProperties||{};for(var a in e){var c=!0;for(var l in o){if(new RegExp(l).test(a)){c=!1,"function"==typeof n.preValidateProperty&&n.preValidateProperty(e,a,o[l],n,r);var u=this.validateSchema(e[a],o[l],n,r.makeChild(o[l],a));u.instance!==s.instance[a]&&(s.instance[a]=u.instance),s.importErrors(u)}}c&&h.call(this,e,t,n,r,a,s)}return s}},a.additionalProperties=function(e,t,n,r){if(this.types.object(e)){if(t.patternProperties)return null;var s=new i(e,t,n,r);for(var o in e)h.call(this,e,t,n,r,o,s);return s}},a.minProperties=function(e,t,n,r){if(this.types.object(e)){var s=new i(e,t,n,r);return Object.keys(e).length>=t.minProperties||s.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),s}},a.maxProperties=function(e,t,n,r){if(this.types.object(e)){var s=new i(e,t,n,r);return Object.keys(e).length<=t.maxProperties||s.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),s}},a.items=function(e,t,n,r){var s=this;if(this.types.array(e)&&t.items){var o=new i(e,t,n,r);return e.every((function(e,i){var a=Array.isArray(t.items)?t.items[i]||t.additionalItems:t.items;if(void 0===a)return!0;if(!1===a)return o.addError({name:"items",message:"additionalItems not permitted"}),!1;var c=s.validateSchema(e,a,n,r.makeChild(a,i));return c.instance!==o.instance[i]&&(o.instance[i]=c.instance),o.importErrors(c),!0})),o}},a.minimum=function(e,t,n,r){if(this.types.number(e)){var s=new i(e,t,n,r);return(t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum:e>=t.minimum)||s.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),s}},a.maximum=function(e,t,n,r){if(this.types.number(e)){var s=new i(e,t,n,r);return(t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum:e<=t.maximum)||s.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),s}};var l=function(e,t,n,o,a,c){if(this.types.number(e)){var h=t[a];if(0==h)throw new s(a+" cannot be zero");var l=new i(e,t,n,o),u=r.getDecimalPlaces(e),f=r.getDecimalPlaces(h),p=Math.max(u,f),d=Math.pow(10,p);return Math.round(e*d)%Math.round(h*d)!=0&&l.addError({name:a,argument:h,message:c+JSON.stringify(h)}),l}};function u(e,t,n){var i,s=n.length;for(i=t+1;i<s;i++)if(r.deepCompareStrict(e,n[i]))return!1;return!0}a.multipleOf=function(e,t,n,r){return l.call(this,e,t,n,r,"multipleOf","is not a multiple of (divisible by) ")},a.divisibleBy=function(e,t,n,r){return l.call(this,e,t,n,r,"divisibleBy","is not divisible by (multiple of) ")},a.required=function(e,t,n,r){var s=new i(e,t,n,r);return void 0===e&&!0===t.required?s.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach((function(t){void 0===e[t]&&s.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})})),s},a.pattern=function(e,t,n,r){if(this.types.string(e)){var s=new i(e,t,n,r);return e.match(t.pattern)||s.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),s}},a.format=function(e,t,n,s){if(void 0!==e){var o=new i(e,t,n,s);return o.disableFormat||r.isFormat(e,t.format,this)||o.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),o}},a.minLength=function(e,t,n,r){if(this.types.string(e)){var s=new i(e,t,n,r),o=e.match(/[\uDC00-\uDFFF]/g);return e.length-(o?o.length:0)>=t.minLength||s.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),s}},a.maxLength=function(e,t,n,r){if(this.types.string(e)){var s=new i(e,t,n,r),o=e.match(/[\uDC00-\uDFFF]/g);return e.length-(o?o.length:0)<=t.maxLength||s.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),s}},a.minItems=function(e,t,n,r){if(this.types.array(e)){var s=new i(e,t,n,r);return e.length>=t.minItems||s.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),s}},a.maxItems=function(e,t,n,r){if(this.types.array(e)){var s=new i(e,t,n,r);return e.length<=t.maxItems||s.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),s}},a.uniqueItems=function(e,t,n,s){if(this.types.array(e)){var o=new i(e,t,n,s);return e.every((function(e,t,n){for(var i=t+1;i<n.length;i++)if(r.deepCompareStrict(e,n[i]))return!1;return!0}))||o.addError({name:"uniqueItems",message:"contains duplicate item"}),o}},a.uniqueItems=function(e,t,n,r){if(this.types.array(e)){var s=new i(e,t,n,r);return e.every(u)||s.addError({name:"uniqueItems",message:"contains duplicate item"}),s}},a.dependencies=function(e,t,n,r){if(this.types.object(e)){var s=new i(e,t,n,r);for(var o in t.dependencies)if(void 0!==e[o]){var a=t.dependencies[o],c=r.makeChild(a,o);if("string"==typeof a&&(a=[a]),Array.isArray(a))a.forEach((function(t){void 0===e[t]&&s.addError({name:"dependencies",argument:c.propertyPath,message:"property "+t+" not found, required by "+c.propertyPath})}));else{var h=this.validateSchema(e,a,n,c);s.instance!==h.instance&&(s.instance=h.instance),h&&h.errors.length&&(s.addError({name:"dependencies",argument:c.propertyPath,message:"does not meet dependency required by "+c.propertyPath}),s.importErrors(h))}}return s}},a.enum=function(e,t,n,o){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new s("enum expects an array",t);var a=new i(e,t,n,o);return t.enum.some(r.deepCompareStrict.bind(null,e))||a.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),a},a.const=function(e,t,n,s){if(void 0===e)return null;var o=new i(e,t,n,s);return r.deepCompareStrict(t.const,e)||o.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),o},a.not=a.disallow=function(e,t,n,r){var s=this;if(void 0===e)return null;var o=new i(e,t,n,r),a=t.not||t.disallow;return a?(Array.isArray(a)||(a=[a]),a.forEach((function(i){if(s.testType(e,t,n,r,i)){var a=i&&i.id&&"<"+i.id+">"||i;o.addError({name:"not",argument:a,message:"is of prohibited type "+a})}})),o):null},e.exports=o},863:function(e,t,n){var r=n(864);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return r(t)}}},864:function(e,t){function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,s=0,o=0,a="";i=t.charAt(o++);~i&&(r=s%4?64*r+i:i,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a}},87:function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return R}));const r="undefined"!=typeof self?self:null,i="undefined"!=typeof window?window:null,s=r||i||void 0,o=0,a=1,c=2,h=3,l="closed",u="errored",f="joined",p="joining",d="leaving",m="phx_close",g="phx_error",v="phx_join",y="phx_reply",b="phx_leave",w=[m,g,v,y,b],E="longpoll",x="websocket";let j=e=>{if("function"==typeof e)return e;return function(){return e}};class S{constructor(e,t,n,r){this.channel=e,this.event=t,this.payload=n||function(){return{}},this.receivedResp=null,this.timeout=r,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,ref:n}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}class O{constructor(e,t,n){this.state=l,this.topic=e,this.params=j(t||{}),this.socket=n,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new S(this,v,this.params,this.timeout),this.pushBuffer=[],this.rejoinTimer=new T(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.socket.onError(()=>this.rejoinTimer.reset()),this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()}),this.joinPush.receive("ok",()=>{this.state=f,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=u,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=l,this.socket.remove(this)}),this.onError(e=>{this.socket.hasLogger()&&this.socket.log("channel","error "+this.topic,e),this.isJoining()&&this.joinPush.reset(),this.state=u,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new S(this,b,j({}),this.timeout).send(),this.state=u,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(y,(e,t)=>{this.trigger(this.replyEventName(t),e)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(m,e)}onError(e){return this.on(g,t=>e(t))}on(e,t){let n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}off(e,t){this.bindings=this.bindings.filter(n=>!(n.event===e&&(void 0===t||t===n.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,n=this.timeout){if(!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let r=new S(this,e,(function(){return t}),n);return this.canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}pushUnreliable(e,t){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`;this.socket.push({topic:this.topic,event:e,payload:t,ref:null,join_ref:this.joinRef()},!1)}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=d;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel","leave "+this.topic),this.trigger(m,"leave")},n=new S(this,b,j({}),e);return n.receive("ok",()=>t()).receive("timeout",()=>t()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(e,t,n){return t}isLifecycleEvent(e){return w.indexOf(e)>=0}isMember(e,t,n,r){return this.topic===e&&(!r||r===this.joinRef()||!this.isLifecycleEvent(t)||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:r}),!1))}joinRef(){return this.joinPush.ref}sendJoin(e){this.state=p,this.joinPush.resend(e)}rejoin(e=this.timeout){this.isLeaving()||this.sendJoin(e)}trigger(e,t,n,r){let i=this.onMessage(e,t,n,r);if(t&&!i)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(let t=0;t<this.bindings.length;t++){const s=this.bindings[t];s.event===e&&s.callback(i,n,r||this.joinRef())}}replyEventName(e){return"chan_reply_"+e}isClosed(){return this.state===l}isErrored(){return this.state===u}isJoined(){return this.state===f}isJoining(){return this.state===p}isLeaving(){return this.state===d}}let P={encode(e,t){let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))},decode(e,t){let[n,r,i,s,o]=JSON.parse(e);return t({join_ref:n,ref:r,topic:i,event:s,payload:o})}};class A{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||1e4,this.transport=t.transport||s.WebSocket||k,this.defaultEncoder=P.encode,this.defaultDecoder=P.decode,this.closeWasClean=!1,this.unloaded=!1,this.binaryType=t.binaryType||"arraybuffer",this.transport!==k?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),i&&i.addEventListener&&i.addEventListener("beforeunload",e=>{this.conn&&(this.unloaded=!0,this.abnormalClose("unloaded"))}),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=e=>t.rejoinAfterMs?t.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4,this.reconnectAfterMs=e=>this.unloaded?100:t.reconnectAfterMs?t.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3,this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=j(t.params||{}),this.endPoint=`${e}/${x}`,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new T(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=C.appendParams(C.appendParams(this.endPoint,this.params()),{vsn:"2.0.0"});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,n){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=j(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=e=>this.onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this.onConnClose(e))}log(e,t,n){this.logger(e,t,n)}hasLogger(){return null!==this.logger}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}onConnOpen(){this.hasLogger()&&this.log("transport","connected to "+this.endPointURL()),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n||""):this.conn.close(),this.conn=null),e&&e()}onConnClose(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}onConnError(e){this.hasLogger()&&this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(g)})}connectionState(){switch(this.conn&&this.conn.readyState){case o:return"connecting";case a:return"open";case c:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){let n=new O(e,t,this);return this.channels.push(n),n}push(e,t=!0){if(this.hasLogger()){let{topic:t,event:n,payload:r,ref:i,join_ref:s}=e;this.log("push",`${t} ${n} (${s}, ${i})`,r)}this.isConnected()?this.encode(e,e=>this.conn.send(e)):t&&this.sendBuffer.push(()=>this.encode(e,e=>this.conn.send(e)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}abnormalClose(e){this.closeWasClean=!1,this.conn.close(1e3,e)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:n,payload:r,ref:i,join_ref:s}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.hasLogger()&&this.log("receive",`${r.status||""} ${t} ${n} ${i&&"("+i+")"||""}`,r);for(let e=0;e<this.channels.length;e++){const o=this.channels[e];o.isMember(t,n,r,s)&&o.trigger(n,r,i,s)}for(let t=0;t<this.stateChangeCallbacks.message.length;t++)this.stateChangeCallbacks.message[t](e)})}}class k{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=o,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+x),"$1/"+E)}endpointURL(){return C.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(){this.close(),this.readyState=o}ontimeout(){this.onerror("timeout"),this.closeAndRetry()}poll(){this.readyState!==a&&this.readyState!==o||C.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),e=>{if(e){var{status:t,token:n,messages:r}=e;this.token=n}else var t=0;switch(t){case 200:r.forEach(e=>this.onmessage({data:e})),this.poll();break;case 204:this.poll();break;case 410:this.readyState=a,this.onopen(),this.poll();break;case 0:case 500:this.onerror(),this.closeAndRetry();break;default:throw new Error("unhandled poll status "+t)}})}send(e){C.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),e=>{e&&200===e.status||(this.onerror(e&&e.status),this.closeAndRetry())})}close(e,t){this.readyState=h,this.onclose()}}class C{static request(e,t,n,r,i,o,a){if(s.XDomainRequest){let n=new XDomainRequest;this.xdomainRequest(n,e,t,r,i,o,a)}else{let c=s.XMLHttpRequest?new s.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(c,e,t,n,r,i,o,a)}}static xdomainRequest(e,t,n,r,i,s,o){e.timeout=i,e.open(t,n),e.onload=()=>{let t=this.parseJSON(e.responseText);o&&o(t)},s&&(e.ontimeout=s),e.onprogress=()=>{},e.send(r)}static xhrRequest(e,t,n,r,i,s,o,a){e.open(t,n,!0),e.timeout=s,e.setRequestHeader("Content-Type",r),e.onerror=()=>{a&&a(null)},e.onreadystatechange=()=>{if(e.readyState===this.states.complete&&a){let t=this.parseJSON(e.responseText);a(t)}},o&&(e.ontimeout=o),e.send(i)}static parseJSON(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let n=[];for(var r in e){if(!e.hasOwnProperty(r))continue;let i=t?`${t}[${r}]`:r,s=e[r];"object"==typeof s?n.push(this.serialize(s,i)):n.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}return n.join("&")}static appendParams(e,t){if(0===Object.keys(t).length)return e;let n=e.match(/\?/)?"&":"?";return`${e}${n}${this.serialize(t)}`}}C.states={complete:4};class R{constructor(e,t={}){let n=t.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=e,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(n.state,e=>{let{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel.joinRef(),this.state=R.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=R.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],r()}),this.channel.on(n.diff,e=>{let{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=R.syncDiff(this.state,e,t,n),r())})}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return R.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}static syncState(e,t,n,r){let i=this.clone(e),s={},o={};return this.map(i,(e,n)=>{t[e]||(o[e]=n)}),this.map(t,(e,t)=>{let n=i[e];if(n){let r=t.metas.map(e=>e.phx_ref),i=n.metas.map(e=>e.phx_ref),a=t.metas.filter(e=>i.indexOf(e.phx_ref)<0),c=n.metas.filter(e=>r.indexOf(e.phx_ref)<0);a.length>0&&(s[e]=t,s[e].metas=a),c.length>0&&(o[e]=this.clone(n),o[e].metas=c)}else s[e]=t}),this.syncDiff(i,{joins:s,leaves:o},n,r)}static syncDiff(e,{joins:t,leaves:n},r,i){let s=this.clone(e);return r||(r=function(){}),i||(i=function(){}),this.map(t,(e,t)=>{let n=s[e];if(s[e]=t,n){let t=s[e].metas.map(e=>e.phx_ref),r=n.metas.filter(e=>t.indexOf(e.phx_ref)<0);s[e].metas.unshift(...r)}r(e,n,t)}),this.map(n,(e,t)=>{let n=s[e];if(!n)return;let r=t.metas.map(e=>e.phx_ref);n.metas=n.metas.filter(e=>r.indexOf(e.phx_ref)<0),i(e,n,t),0===n.metas.length&&delete s[e]}),s}static list(e,t){return t||(t=function(e,t){return t}),this.map(e,(e,n)=>t(e,n))}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static clone(e){return JSON.parse(JSON.stringify(e))}}class T{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}}}]);
//# sourceMappingURL=store-4ea089c26aa5799597eb.js.map