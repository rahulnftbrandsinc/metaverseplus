var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,t,f){g!=Array.prototype&&g!=Object.prototype&&(g[t]=f.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(g,t,f,q){if(t){f=$jscomp.global;g=g.split(".");for(q=0;q<g.length-1;q++){var G=g[q];G in f||(f[G]={});f=f[G]}g=g[g.length-1];q=f[g];t=t(q);t!=q&&null!=t&&$jscomp.defineProperty(f,g,{configurable:!0,writable:!0,value:t})}};$jscomp.polyfill("Math.sign",function(g){return g?g:function(g){g=Number(g);return 0===g||isNaN(g)?g:0<g?1:-1}},"es6","es3");
(function(g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define([],g):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=g()})(function(){return function(){function g(t,f,q){function G(l,J){if(!f[l]){if(!t[l]){var b="function"==typeof require&&require;if(!J&&b)return b(l,!0);if(h)return h(l,!0);J=Error("Cannot find module '"+l+"'");throw J.code="MODULE_NOT_FOUND",J;}J=
f[l]={exports:{}};t[l][0].call(J.exports,function(b){return G(t[l][1][b]||b)},J,J.exports,g,t,f,q)}return f[l].exports}for(var h="function"==typeof require&&require,l=0;l<q.length;l++)G(q[l]);return G}return g}()({1:[function(g,t,f){(function(q,g,h,l,f){function G(a){if("contents"in a){var d="styleAttrs"in a?a.styleAttrs[l.byName.ruby.qname]:null;d="span"===a.kind&&("container"===d||"textContainer"===d||"baseContainer"===d);for(var b=a.contents.length-1;0<=b;b--)!d||"styleAttrs"in a.contents[b]&&
l.byName.ruby.qname in a.contents[b].styleAttrs?G(a.contents[b]):delete a.contents[b]}}function b(a,d,k,c){var z=c&&"seq"===c.timeContainer,r=0;c&&(r=z&&k?k.end:c.begin);d.begin=d.explicit_begin?d.explicit_begin+r:r;k=d.begin;c=null;for(var F in d.sets)b(a,d.sets[F],c,d),k="seq"===d.timeContainer?d.sets[F].end:Math.max(k,d.sets[F].end),c=d.sets[F];if("contents"in d)for(var e in d.contents)b(a,d.contents[e],c,d),k="seq"===d.timeContainer?d.contents[e].end:Math.max(k,d.contents[e].end),c=d.contents[e];
else k=z?d.begin:Number.POSITIVE_INFINITY;d.end=null!==d.explicit_end&&null!==d.explicit_dur?Math.min(d.begin+d.explicit_dur,r+d.explicit_end):null===d.explicit_end&&null!==d.explicit_dur?d.begin+d.explicit_dur:null!==d.explicit_end&&null===d.explicit_dur?r+d.explicit_end:k;delete d.explicit_begin;delete d.explicit_dur;delete d.explicit_end;a._registerEvent(d)}function c(a){this.node=a}function H(){this.events=[];this.head=new e;this.body=null}function e(){this.styling=new a;this.layout=new r}function a(){this.styles=
{};this.initials={}}function d(){this.styleRefs=this.styleAttrs=this.id=null}function k(){this.styleAttrs=null}function r(){this.regions={}}function u(a,d){this.kind="image";this.src=a;this.type=d}function N(a){this.id=a}function m(a){this.regionID=a}function C(a){this.styleAttrs=a}function I(a){this.sets=a}function p(a){this.contents=a}function A(a,d,b){this.explicit_begin=a;this.explicit_end=d;this.explicit_dur=b}function w(){this.kind="body"}function v(){this.kind="div"}function P(){this.kind=
"p"}function t(){this.kind="span"}function K(){this.kind="span"}function B(){this.kind="br"}function E(){}function U(){}function Q(a){return a&&"xml:id"in a.attributes?a.attributes["xml:id"].value||null:null}function y(a){return a&&"style"in a.attributes?a.attributes.style.value.split(" "):[]}function R(a,d){var b={};if(null!==a)for(var k in a.attributes){var c=a.attributes[k].uri+" "+a.attributes[k].local,r=l.byQName[c];if(void 0!==r){var z=r.parse(a.attributes[k].value);null!==z?(b[c]=z,r===l.byName.zIndex&&
M(d,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):L(d,"Cannot parse styling attribute "+c+" --\x3e "+a.attributes[k].value)}}return b}function O(a,d,b){for(var k in a.attributes)if(a.attributes[k].uri===d&&a.attributes[k].local===b)return a.attributes[k].value;return null}function Y(a,d){a=O(a,h.ns_tts,"extent");if(null===a)return null;var b=a.split(" ");if(2!==b.length)return M(d,"Malformed extent (ignoring)"),null;a=f.parseLength(b[0]);b=f.parseLength(b[1]);return b&&
a?{h:b,w:a}:(M(d,"Malformed extent values (ignoring)"),null)}function S(a,d,b){var k=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,c=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,r=/^(\d+(?:\.\d+)?)t$/,e=/^(\d+(?:\.\d+)?)ms$/,z=/^(\d+(?:\.\d+)?)s$/,F=/^(\d+(?:\.\d+)?)h$/,x=/^(\d+(?:\.\d+)?)m$/,u,h=null;null!==(u=/^(\d+(?:\.\d+)?)f$/.exec(b))?null!==d&&(h=parseFloat(u[1])/d):null!==(u=r.exec(b))?null!==a&&(h=parseFloat(u[1])/a):null!==(u=e.exec(b))?h=parseFloat(u[1])/1E3:null!==(u=z.exec(b))?h=parseFloat(u[1]):null!==
(u=F.exec(b))?h=3600*parseFloat(u[1]):null!==(u=x.exec(b))?h=60*parseFloat(u[1]):null!==(u=k.exec(b))?h=3600*parseInt(u[1])+60*parseInt(u[2])+parseFloat(u[3]):null!==(u=c.exec(b))&&null!==d&&(h=3600*parseInt(u[1])+60*parseInt(u[2])+parseInt(u[3])+(null===u[4]?0:parseInt(u[4])/d));return h}function V(a,d,b){for(;0<d.styleRefs.length;){var k=d.styleRefs.pop();k in a.styles?(V(a,a.styles[k],b),T(a.styles[k].styleAttrs,d.styleAttrs)):L(b,"Non-existant style id referenced")}}function W(a,d,b,k){for(var c=
d.length-1;0<=c;c--){var r=d[c];r in a.styles?T(a.styles[r].styleAttrs,b):L(k,"Non-existant style id referenced")}}function T(a,d){for(var b in a)b in d||(d[b]=a[b])}function M(a,d){if(a&&a.warn&&a.warn(d))throw d;}function L(a,d){if(a&&a.error&&a.error(d))throw d;}function D(a,d){a&&a.fatal&&a.fatal(d);throw d;}function X(a,d){for(var b=0,k=a.length-1,c;b<=k;){c=Math.floor((b+k)/2);var r=a[c];if(r<d)b=c+1;else if(r>d)k=c-1;else return{found:!0,index:c}}return{found:!1,index:b}}q.fromXML=function(z,
x,F){var p=g.parser(!0,{xmlns:!0}),n=[],m=[],q=[],C=0,f=null;p.onclosetag=function(d){if(n[0]instanceof a)for(var b in n[0].styles)V(n[0],n[0].styles[b],x);else if(n[0]instanceof P||n[0]instanceof t){if(1<n[0].contents.length){d=[n[0].contents[0]];for(b=1;b<n[0].contents.length;b++)n[0].contents[b]instanceof K&&d[d.length-1]instanceof K?d[d.length-1].text+=n[0].contents[b].text:d.push(n[0].contents[b]);n[0].contents=d}n[0]instanceof t&&1===n[0].contents.length&&n[0].contents[0]instanceof K&&(n[0].text=
n[0].contents[0].text,delete n[0].contents)}else if(n[0]instanceof c)if(n[0].node.uri===h.ns_tt&&"metadata"===n[0].node.local)C--;else if(0<C&&F&&"onCloseTag"in F)F.onCloseTag();q.shift();m.shift();n.shift()};p.ontext=function(a){if(void 0!==n[0])if(n[0]instanceof t||n[0]instanceof P){if(n[0]instanceof t){var d=n[0].styleAttrs[l.byName.ruby.qname];if("container"===d||"textContainer"===d||"baseContainer"===d)return}d=new K;d.initFromText(f,n[0],a,q[0],x);n[0].contents.push(d)}else if(n[0]instanceof
c&&0<C&&F&&"onText"in F)F.onText(a)};p.onopentag=function(b){var z=b.attributes["xml:space"];z?q.unshift(z.value):0===q.length?q.unshift("default"):q.unshift(q[0]);(z=b.attributes["xml:lang"])?m.unshift(z.value):0===m.length?m.unshift(""):m.unshift(m[0]);if(b.uri===h.ns_tt)if("tt"===b.local)null!==f&&D(x,"Two <tt> elements at ("+this.line+","+this.column+")"),f=new H,f.initFromNode(b,x),n.unshift(f);else if("head"===b.local)n[0]instanceof H||D(x,"Parent of <head> element is not <tt> at ("+this.line+
","+this.column+")"),n.unshift(f.head);else if("styling"===b.local)n[0]instanceof e||D(x,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),n.unshift(f.head.styling);else if("style"===b.local)if(n[0]instanceof a){var p=new d;p.initFromNode(b,x);p.id?f.head.styling.styles[p.id]=p:L(x,"<style> element missing @id attribute");n.unshift(p)}else n[0]instanceof E?(p=new d,p.initFromNode(b,x),T(p.styleAttrs,n[0].styleAttrs),n.unshift(p)):D(x,"Parent of <style> element is not <styling> or <region> at ("+
this.line+","+this.column+")");else if("initial"===b.local)if(n[0]instanceof a){z=new k;z.initFromNode(b,x);for(p in z.styleAttrs)f.head.styling.initials[p]=z.styleAttrs[p];n.unshift(z)}else D(x,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===b.local)n[0]instanceof e||D(x,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),n.unshift(f.head.layout);else if("region"===b.local)n[0]instanceof r||D(x,"Parent of <region> element is not <layout> at "+
this.line+","+this.column+")"),p=new E,p.initFromNode(f,b,x),!p.id||p.id in f.head.layout.regions?L(x,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):f.head.layout.regions[p.id]=p,n.unshift(p);else if("body"===b.local)n[0]instanceof H||D(x,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==f.body&&D(x,"Second <body> element at "+this.line+","+this.column+")"),p=new w,p.initFromNode(f,b,x),f.body=p,n.unshift(p);else if("div"===b.local){n[0]instanceof
v||n[0]instanceof w||D(x,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");p=new v;p.initFromNode(f,n[0],b,x);if(z=p.styleAttrs[l.byName.backgroundImage.qname])p.contents.push(new u(z)),delete p.styleAttrs[l.byName.backgroundImage.qname];n[0].contents.push(p);n.unshift(p)}else"image"===b.local?(n[0]instanceof v||D(x,"Parent of <image> element is not <div> at "+this.line+","+this.column+")"),p=new u,p.initFromNode(f,n[0],b,x),n[0].contents.push(p),n.unshift(p)):"p"===
b.local?(n[0]instanceof v||D(x,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),p=new P,p.initFromNode(f,n[0],b,x),n[0].contents.push(p),n.unshift(p)):"span"===b.local?(n[0]instanceof t||n[0]instanceof P||D(x,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),p=new t,p.initFromNode(f,n[0],b,q[0],x),n[0].contents.push(p),n.unshift(p)):"br"===b.local?(n[0]instanceof t||n[0]instanceof P||D(x,"Parent of <br> element is not <span> or <p> at "+this.line+
","+this.column+")"),p=new B,p.initFromNode(f,n[0],b,x),n[0].contents.push(p),n.unshift(p)):"set"===b.local?(n[0]instanceof t||n[0]instanceof P||n[0]instanceof v||n[0]instanceof w||n[0]instanceof E||n[0]instanceof B||D(x,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),p=new U,p.initFromNode(f,n[0],b,x),n[0].sets.push(p),n.unshift(p)):n.unshift(new c(b));else n.unshift(new c(b));if(n[0]instanceof c)if(b.uri===h.ns_tt&&"metadata"===b.local)C++;else if(0<
C&&F&&"onOpenTag"in F){p=[];for(var g in b.attributes)p[b.attributes[g].uri+" "+b.attributes[g].local]={uri:b.attributes[g].uri,local:b.attributes[g].local,value:b.attributes[g].value};F.onOpenTag(b.uri,b.local,p)}};p.write(z).close();delete f.head.styling.styles;z=!1;for(var N in f.head.layout.regions){z=!0;break}z||(N=E.prototype.createDefaultRegion(),f.head.layout.regions[N.id]=N);for(var I in f.head.layout.regions)b(f,f.head.layout.regions[I],null,null);f.body&&b(f,f.body,null,null);f.body&&G(f.body);
return f};H.prototype.initFromNode=function(a,d){var b=O(a,h.ns_ttp,"cellResolution"),k=15;var c=32;null!==b&&(b=/(\d+) (\d+)/.exec(b),null!==b?(c=parseInt(b[1]),k=parseInt(b[2])):M(d,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new f.ComputedLength(0,1/k),w:new f.ComputedLength(1/c,0)};k=O(a,h.ns_ttp,"frameRate");b=30;null!==k&&(c=/(\d+)/.exec(k),null!==c?b=parseInt(c[1]):M(d,"Malformed frame rate attribute (using initial value instead)"));c=O(a,h.ns_ttp,"frameRateMultiplier");
var r=1;null!==c&&(c=/(\d+) (\d+)/.exec(c),null!==c?r=parseInt(c[1])/parseInt(c[2]):M(d,"Malformed frame rate multiplier attribute (using initial value instead)"));b*=r;r=1;c=O(a,h.ns_ttp,"tickRate");null===c?null!==k&&(r=b):(c=/(\d+)/.exec(c),null!==c?r=parseInt(c[1]):M(d,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=b;this.tickRate=r;c=O(a,h.ns_ittp,"aspectRatio");null===c&&(c=O(a,h.ns_ttp,"displayAspectRatio"));k=null;null!==c&&(b=/(\d+)\s+(\d+)/.exec(c),
null!==b?(c=parseInt(b[1]),b=parseInt(b[2]),0!==c&&0!==b?k=c/b:L(d,"Illegal aspectRatio values (ignoring)")):L(d,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=k;k=O(a,h.ns_ttp,"timeBase");null!==k&&"media"!==k&&D(d,"Unsupported time base");a=Y(a,d);null===a?this.pxLength={h:null,w:null}:("px"===a.h.unit&&"px"===a.w.unit||D(d,"Extent on TT must be in px or absent"),this.pxLength={h:new f.ComputedLength(0,1/a.h.value),w:new f.ComputedLength(1/a.w.value,0)});this.dimensions={h:new f.ComputedLength(0,
1),w:new f.ComputedLength(1,0)}};H.prototype._registerEvent=function(a){if(!(a.end<=a.begin)){var b=X(this.events,a.begin);b.found||this.events.splice(b.index,0,a.begin);a.end!==Number.POSITIVE_INFINITY&&(b=X(this.events,a.end),b.found||this.events.splice(b.index,0,a.end))}};H.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]};H.prototype.getMediaTimeEvents=function(){return this.events};d.prototype.initFromNode=function(a,b){this.id=Q(a);this.styleAttrs=
R(a,b);this.styleRefs=y(a)};k.prototype.initFromNode=function(a,b){this.styleAttrs={};for(var d in a.attributes)if(a.attributes[d].uri===h.ns_itts||a.attributes[d].uri===h.ns_ebutts||a.attributes[d].uri===h.ns_tts)this.styleAttrs[a.attributes[d].uri+" "+a.attributes[d].local]=a.attributes[d].value};u.prototype.initFromNode=function(a,b,d,c){(this.src="src"in d.attributes?d.attributes.src.value:null)||L(c,"Invalid image@src attribute");(this.type="type"in d.attributes?d.attributes.type.value:null)||
L(c,"Invalid image@type attribute");C.prototype.initFromNode.call(this,a,b,d,c);A.prototype.initFromNode.call(this,a,b,d,c);I.prototype.initFromNode.call(this,a,b,d,c);m.prototype.initFromNode.call(this,a,b,d,c)};N.prototype.initFromNode=function(a,b,d,c){this.id=Q(d)};m.prototype.initFromNode=function(a,b,d,c){this.regionID=d&&"region"in d.attributes?d.attributes.region.value:""};C.prototype.initFromNode=function(a,d,b,c){this.styleAttrs=R(b,c);null!==a.head&&null!==a.head.styling&&W(a.head.styling,
y(b),this.styleAttrs,c)};I.prototype.initFromNode=function(a,d,b,c){this.sets=[]};p.prototype.initFromNode=function(a,d,b,c){this.contents=[]};A.prototype.initFromNode=function(a,d,b,c){d=null;b&&"begin"in b.attributes&&(d=S(a.tickRate,a.effectiveFrameRate,b.attributes.begin.value),null===d&&M(c,"Malformed begin value "+b.attributes.begin.value+" (using 0)"));var k=null;b&&"dur"in b.attributes&&(k=S(a.tickRate,a.effectiveFrameRate,b.attributes.dur.value),null===k&&M(c,"Malformed dur value "+b.attributes.dur.value+
" (ignoring)"));var r=null;b&&"end"in b.attributes&&(r=S(a.tickRate,a.effectiveFrameRate,b.attributes.end.value),null===r&&M(c,"Malformed end value (ignoring)"));this.explicit_begin=d;this.explicit_end=r;this.explicit_dur=k;(a=b&&"timeContainer"in b.attributes?b.attributes.timeContainer.value:null)&&"par"!==a?"seq"===a?c="seq":(L(c,"Illegal value of timeContainer (assuming 'par')"),c="par"):c="par";this.timeContainer=c};w.prototype.initFromNode=function(a,b,d){C.prototype.initFromNode.call(this,a,
null,b,d);A.prototype.initFromNode.call(this,a,null,b,d);I.prototype.initFromNode.call(this,a,null,b,d);m.prototype.initFromNode.call(this,a,null,b,d);p.prototype.initFromNode.call(this,a,null,b,d)};v.prototype.initFromNode=function(a,b,d,c){C.prototype.initFromNode.call(this,a,b,d,c);A.prototype.initFromNode.call(this,a,b,d,c);I.prototype.initFromNode.call(this,a,b,d,c);m.prototype.initFromNode.call(this,a,b,d,c);p.prototype.initFromNode.call(this,a,b,d,c)};P.prototype.initFromNode=function(a,b,
d,c){C.prototype.initFromNode.call(this,a,b,d,c);A.prototype.initFromNode.call(this,a,b,d,c);I.prototype.initFromNode.call(this,a,b,d,c);m.prototype.initFromNode.call(this,a,b,d,c);p.prototype.initFromNode.call(this,a,b,d,c)};t.prototype.initFromNode=function(a,b,d,c,k){C.prototype.initFromNode.call(this,a,b,d,k);A.prototype.initFromNode.call(this,a,b,d,k);I.prototype.initFromNode.call(this,a,b,d,k);m.prototype.initFromNode.call(this,a,b,d,k);p.prototype.initFromNode.call(this,a,b,d,k);this.space=
c};K.prototype.initFromText=function(a,b,d,c,k){A.prototype.initFromNode.call(this,a,b,null,k);this.text=d;this.space=c};B.prototype.initFromNode=function(a,b,d,c){m.prototype.initFromNode.call(this,a,b,d,c);A.prototype.initFromNode.call(this,a,b,d,c)};E.prototype.createDefaultRegion=function(){var a=new E;a.id="";a.styleAttrs={};a.sets=[];A.call(a,0,Number.POSITIVE_INFINITY,null);return a};E.prototype.initFromNode=function(a,b,d){N.prototype.initFromNode.call(this,a,null,b,d);C.prototype.initFromNode.call(this,
a,null,b,d);A.prototype.initFromNode.call(this,a,null,b,d);I.prototype.initFromNode.call(this,a,null,b,d);null!==a.head&&null!==a.head.styling&&W(a.head.styling,y(b),this.styleAttrs,d)};U.prototype.initFromNode=function(a,b,d,c){A.prototype.initFromNode.call(this,a,b,d,c);a=R(d,c);this.value=this.qname=null;for(var k in a){if(this.qname){L(c,"More than one style specified on set");break}this.qname=k;this.value=a[k]}}})("undefined"===typeof f?this.imscDoc={}:f,"undefined"===typeof sax?g("sax"):sax,
"undefined"===typeof imscNames?g("./names"):imscNames,"undefined"===typeof imscStyles?g("./styles"):imscStyles,"undefined"===typeof imscUtils?g("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(g,t,f){(function(q,f,h){function g(a,d,c){if("region"===c.kind){var k=document.createElement("div");k.style.position="absolute"}else if("body"===c.kind)k=document.createElement("div");else if("div"===c.kind)k=document.createElement("div");else if("image"===c.kind){if(k=document.createElement("img"),
null!==a.imgResolver&&null!==c.src){var e=a.imgResolver(c.src,k);e&&(k.src=e);k.height=a.regionH;k.width=a.regionW}}else if("p"===c.kind)k=document.createElement("p");else if("span"===c.kind){if("container"===c.styleAttrs[h.byName.ruby.qname])k=document.createElement("ruby"),a.ruby=!0;else if("base"===c.styleAttrs[h.byName.ruby.qname])k=document.createElement("rb");else if("text"===c.styleAttrs[h.byName.ruby.qname])k=document.createElement("rt");else if("baseContainer"===c.styleAttrs[h.byName.ruby.qname])k=
document.createElement("rbc");else if("textContainer"===c.styleAttrs[h.byName.ruby.qname])k=document.createElement("rtc");else{if("delimiter"===c.styleAttrs[h.byName.ruby.qname])return;k=document.createElement("span")}(e=c.styleAttrs[h.byName.textEmphasis.qname])&&"none"!==e.style&&(a.textEmphasis=!0)}else"br"===c.kind&&(k=document.createElement("br"));if(k){d.appendChild(k);k.style.margin="0";for(var q in H)d=H[q],e=c.styleAttrs[d.qname],void 0!==e&&null!==d.map&&d.map(a,k,c,e);q=k;if("region"===
c.kind)if(d=c.styleAttrs[h.byName.writingMode.qname],"lrtb"===d||"lr"===d)a.ipd="lr",a.bpd="tb";else if("rltb"===d||"rl"===d)a.ipd="rl",a.bpd="tb";else if("tblr"===d)a.ipd="tb",a.bpd="lr";else if("tbrl"===d||"tb"===d)a.ipd="tb",a.bpd="rl";(d=c.styleAttrs[h.byName.linePadding.qname])&&!d.isZero()&&(e=d.toUsedLength(a.w,a.h),0<e&&(e=Math.ceil(e)+"px","tb"===a.bpd?(q.style.paddingLeft=e,q.style.paddingRight=e):(q.style.paddingTop=e,q.style.paddingBottom=e),a.lp=d));(d=c.styleAttrs[h.byName.multiRowAlign.qname])&&
"auto"!==d&&(q=document.createElement("span"),q.style.display="inline-block",q.style.textAlign=d,k.appendChild(q),a.mra=d);(d=c.styleAttrs[h.byName.rubyReserve.qname])&&"none"!==d[0]&&(a.rubyReserve=d);c.styleAttrs[h.byName.fillLineGap.qname]&&(a.flg=!0);if("span"===c.kind&&c.text)if(h.byName.textCombine.qname in c.styleAttrs&&"all"===c.styleAttrs[h.byName.textCombine.qname][0])k.textContent=c.text;else for(d="",e=0;e<c.text.length;e++){d+=c.text.charAt(e);var m=c.text.charCodeAt(e);if(55296>m||56319<
m||e===c.text.length)m=document.createElement("span"),m.textContent=d,k.appendChild(m),d=""}for(var f in c.contents)g(a,q,c.contents[f]);f=[];if((a.lp||a.mra||a.flg||a.ruby||a.textEmphasis||a.rubyReserve)&&"p"===c.kind){b(a,q,f,null);if(a.rubyReserve){for(d=0;d<f.length;d++){e=document.createElement("ruby");m=document.createElement("rb");m.textContent="\u200b";e.appendChild(m);var l=a.rubyReserve[1].toUsedLength(a.w,a.h)+"px";if("both"===a.rubyReserve[0]){m=document.createElement("rtc");m.style.rubyPosition=
"under";m.textContent="\u200b";m.style.fontSize=l;var p=document.createElement("rtc");p.style.rubyPosition="over";p.textContent="\u200b";p.style.fontSize=l;e.appendChild(m);e.appendChild(p)}else m=document.createElement("rtc"),m.textContent="\u200b",m.style.fontSize=l,m.style.rubyPosition="after"===a.rubyReserve[0]||"outside"===a.rubyReserve[0]&&0<d?"tb"===a.bpd||"rl"===a.bpd?"under":"over":"tb"===a.bpd||"rl"===a.bpd?"over":"under",e.appendChild(m);f[d].elements[0].node.parentElement.insertBefore(e,
f[d].elements[0].node)}a.rubyReserve=null}if(a.ruby||a.rubyReserve){for(d=0;d<f.length;d++)for(e=0;e<f[d].rbc.length;e++)f[d].rbc[e].style.rubyPosition||(f[d].rbc[e].style.rubyPosition="tb"===a.bpd?0===d?"over":"under":"rl"===a.bpd?0===d?"over":"under":0===d?"under":"over");a.ruby=null}if(a.textEmphasis){for(d=0;d<f.length;d++)for(e=0;e<f[d].te.length;e++)f[d].te[e].style.textEmphasisPosition&&"none"!==f[d].te[e].style.textEmphasisPosition||(f[d].te[e].style.textEmphasisPosition="tb"===a.bpd?0===
d?"left over":"left under":"rl"===a.bpd?0===d?"right under":"left under":0===d?"left under":"right under");a.textEmphasis=null}if(a.mra){for(d=0;d<f.length-1;d++)m=f[d].elements.length,0!==m&&!1===f[d].br&&(e=document.createElement("br"),m=f[d].elements[m-1].node,m.parentElement.insertBefore(e,m.nextSibling));a.mra=null}if(a.lp){d=a.lp.toUsedLength(a.w,a.h);for(var A in f)e=f[A].elements[f[A].start_elem],m=f[A].elements[f[A].end_elem],p=Math.ceil(d)+"px",l="-"+Math.ceil(d)+"px",0!==f[A].elements.length&&
("lr"===a.ipd?(e.node.style.borderLeftColor=e.bgcolor||"#00000000",e.node.style.borderLeftStyle="solid",e.node.style.borderLeftWidth=p,e.node.style.marginLeft=l):"rl"===a.ipd?(e.node.style.borderRightColor=e.bgcolor||"#00000000",e.node.style.borderRightStyle="solid",e.node.style.borderRightWidth=p,e.node.style.marginRight=l):"tb"===a.ipd&&(e.node.style.borderTopColor=e.bgcolor||"#00000000",e.node.style.borderTopStyle="solid",e.node.style.borderTopWidth=p,e.node.style.marginTop=l),"lr"===a.ipd?(m.node.style.borderRightColor=
m.bgcolor||"#00000000",m.node.style.borderRightStyle="solid",m.node.style.borderRightWidth=p,m.node.style.marginRight=l):"rl"===a.ipd?(m.node.style.borderLeftColor=m.bgcolor||"#00000000",m.node.style.borderLeftStyle="solid",m.node.style.borderLeftWidth=p,m.node.style.marginLeft=l):"tb"===a.ipd&&(m.node.style.borderBottomColor=m.bgcolor||"#00000000",m.node.style.borderBottomStyle="solid",m.node.style.borderBottomWidth=p,m.node.style.marginBottom=l));a.lp=null}if(a.flg){d=t(q.getBoundingClientRect(),
a);A=d.before;d=d.after;e=Math.sign(d-A);for(m=0;m<=f.length;m++){p=0===m?A:m===f.length?d:(f[m].before+f[m-1].after)/2;if(0<m)for(var w=0;w<f[m-1].elements.length;w++)if(null!==f[m-1].elements[w].bgcolor){var v=f[m-1].elements[w];0>e*(v.after-p)&&(l=Math.ceil(Math.abs(p-v.after))+"px",v.node.style.backgroundColor=v.bgcolor,"lr"===a.bpd?v.node.style.paddingRight=l:"rl"===a.bpd?v.node.style.paddingLeft=l:"tb"===a.bpd&&(v.node.style.paddingBottom=l))}if(m<f.length)for(w=0;w<f[m].elements.length;w++)v=
f[m].elements[w],null!==v.bgcolor&&0<e*(v.before-p)&&(l=Math.ceil(Math.abs(v.before-p))+"px",v.node.style.backgroundColor=v.bgcolor,"lr"===a.bpd?v.node.style.paddingLeft=l:"rl"===a.bpd?v.node.style.paddingRight=l:"tb"===a.bpd&&(v.node.style.paddingTop=l))}a.flg=null}}"region"===c.kind&&(b(a,q,f),"tb"===a.bpd&&a.enableRollUp&&0<c.contents.length&&"after"===c.styleAttrs[h.byName.displayAlign.qname]&&(c=new G(""===c.id?"_":c.id,f),a.currentISDState[c.id]=c,a.previousISDState&&c.id in a.previousISDState&&
0<a.previousISDState[c.id].plist.length&&1<c.plist.length&&c.plist[c.plist.length-2].text===a.previousISDState[c.id].plist[a.previousISDState[c.id].plist.length-1].text&&(a=k.firstElementChild,c=c.plist[c.plist.length-1].after-c.plist[c.plist.length-1].before,a.style.bottom="-"+c+"px",a.style.transition="transform 0.4s",a.style.position="relative",a.style.transform="translateY(-"+c+"px)")))}else if(a=a.errorHandler,c="Error processing ISD element kind: "+c.kind,a&&a.error&&a.error(c))throw c;}function G(a,
b){this.id=a;this.plist=b}function t(a,b){var d={before:null,after:null,start:null,end:null};"tb"===b.bpd?(d.before=a.top,d.after=a.bottom,"lr"===b.ipd?(d.start=a.left,d.end=a.right):(d.start=a.right,d.end=a.left)):"lr"===b.bpd?(d.before=a.left,d.after=a.right,d.start=a.top,d.end=a.bottom):"rl"===b.bpd&&(d.before=a.right,d.after=a.left,d.start=a.top,d.end=a.bottom);return d}function b(a,d,c,e){if("rt"!==d.localName&&"rtc"!==d.localName)if(e=d.style.backgroundColor||e,0===d.childElementCount)if("span"===
d.localName||"rb"===d.localName){var k=d.getBoundingClientRect();if(0!==k.height&&0!==k.width){a=t(k,a);if(!(k=0===c.length)){k=a.before;var r=a.after,h=c[c.length-1].before,f=c[c.length-1].after;k=!(r<f&&k>h||f<=r&&h>=k)}k?c.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(k=Math.sign(a.after-a.before),r=Math.sign(a.end-a.start),0>k*(a.before-c[c.length-1].before)&&(c[c.length-1].before=a.before),0<k*(a.after-c[c.length-
1].after)&&(c[c.length-1].after=a.after),0>r*(a.start-c[c.length-1].start)&&(c[c.length-1].start=a.start,c[c.length-1].start_elem=c[c.length-1].elements.length),0<r*(a.end-c[c.length-1].end)&&(c[c.length-1].end=a.end,c[c.length-1].end_elem=c[c.length-1].elements.length));c[c.length-1].text+=d.textContent;c[c.length-1].elements.push({node:d,bgcolor:e,before:a.before,after:a.after})}}else"br"===d.localName&&0!==c.length&&(c[c.length-1].br=!0);else for(d=d.firstChild;d;)d.nodeType===Node.ELEMENT_NODE&&
(b(a,d,c,e),"ruby"===d.localName||"rtc"===d.localName?0<c.length&&c[c.length-1].rbc.push(d):"span"===d.localName&&d.style.textEmphasisStyle&&"none"!==d.style.textEmphasisStyle&&0<c.length&&c[c.length-1].te.push(d)),d=d.nextSibling}function c(a,b){this.qname=a;this.map=b}q.render=function(a,b,c,e,h,f,H,q,l){e=e||b.clientHeight;h=h||b.clientWidth;if(null!==a.aspectRatio){var d=e*a.aspectRatio;d>h?e=Math.round(h/a.aspectRatio):h=d}d=document.createElement("div");d.style.position="relative";d.style.width=
h+"px";d.style.height=e+"px";d.style.margin="auto";d.style.top=0;d.style.bottom=0;d.style.left=0;d.style.right=0;d.style.zIndex=0;c={h:e,w:h,regionH:null,regionW:null,imgResolver:c,displayForcedOnlyMode:f||!1,isd:a,errorHandler:H,previousISDState:q,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};b.appendChild(d);for(var k in a.contents)g(c,d,a.contents[k]);return c.currentISDState};var H=[new c("http://www.w3.org/ns/ttml#styling backgroundColor",
function(a,b,c,e){0!==e[3]&&(b.style.backgroundColor="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(e[3]/255).toString()+")")}),new c("http://www.w3.org/ns/ttml#styling color",function(a,b,c,e){b.style.color="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(e[3]/255).toString()+")"}),new c("http://www.w3.org/ns/ttml#styling direction",function(a,b,c,e){b.style.direction=e}),new c("http://www.w3.org/ns/ttml#styling display",function(a,b,c,e){}),new c("http://www.w3.org/ns/ttml#styling displayAlign",
function(a,b,c,e){b.style.display="flex";b.style.flexDirection="column";"before"===e?b.style.justifyContent="flex-start":"center"===e?b.style.justifyContent="center":"after"===e&&(b.style.justifyContent="flex-end")}),new c("http://www.w3.org/ns/ttml#styling extent",function(a,b,c,e){a.regionH=e.h.toUsedLength(a.w,a.h);a.regionW=e.w.toUsedLength(a.w,a.h);var d=e=0;if(c=c.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])e=c[0].toUsedLength(a.w,a.h)+c[2].toUsedLength(a.w,a.h),d=c[1].toUsedLength(a.w,
a.h)+c[3].toUsedLength(a.w,a.h);b.style.height=a.regionH-e+"px";b.style.width=a.regionW-d+"px"}),new c("http://www.w3.org/ns/ttml#styling fontFamily",function(a,b,c,e){a=[];for(var d in e)"monospaceSerif"===e[d]?(a.push("Courier New"),a.push('"Liberation Mono"'),a.push("Courier"),a.push("monospace")):"proportionalSansSerif"===e[d]?(a.push("Arial"),a.push("Helvetica"),a.push('"Liberation Sans"'),a.push("sans-serif")):"monospace"===e[d]?a.push("monospace"):"sansSerif"===e[d]?a.push("sans-serif"):"serif"===
e[d]?a.push("serif"):"monospaceSansSerif"===e[d]?(a.push("Consolas"),a.push("monospace")):"proportionalSerif"===e[d]?a.push("serif"):a.push(e[d]);b.style.fontFamily=a.join(",")}),new c("http://www.w3.org/ns/ttml#styling shear",function(a,b,c,e){0!==e&&(c=-.9*e,b.style.transform="tb"===a.bpd?"skewX("+c+"deg)":"skewY("+c+"deg)")}),new c("http://www.w3.org/ns/ttml#styling fontSize",function(a,b,c,e){b.style.fontSize=e.toUsedLength(a.w,a.h)+"px"}),new c("http://www.w3.org/ns/ttml#styling fontStyle",function(a,
b,c,e){b.style.fontStyle=e}),new c("http://www.w3.org/ns/ttml#styling fontWeight",function(a,b,c,e){b.style.fontWeight=e}),new c("http://www.w3.org/ns/ttml#styling lineHeight",function(a,b,c,e){b.style.lineHeight="normal"===e?"normal":e.toUsedLength(a.w,a.h)+"px"}),new c("http://www.w3.org/ns/ttml#styling opacity",function(a,b,c,e){b.style.opacity=e}),new c("http://www.w3.org/ns/ttml#styling origin",function(a,b,c,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+
"px"}),new c("http://www.w3.org/ns/ttml#styling overflow",function(a,b,c,e){b.style.overflow=e}),new c("http://www.w3.org/ns/ttml#styling padding",function(a,b,c,e){c=[];c[0]=e[0].toUsedLength(a.w,a.h)+"px";c[1]=e[3].toUsedLength(a.w,a.h)+"px";c[2]=e[2].toUsedLength(a.w,a.h)+"px";c[3]=e[1].toUsedLength(a.w,a.h)+"px";b.style.padding=c.join(" ")}),new c("http://www.w3.org/ns/ttml#styling position",function(a,b,c,e){b.style.top=e.h.toUsedLength(a.w,a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),
new c("http://www.w3.org/ns/ttml#styling rubyAlign",function(a,b,c,e){b.style.rubyAlign=e}),new c("http://www.w3.org/ns/ttml#styling rubyPosition",function(a,b,c,e){if("before"===e||"after"===e)b.parentElement.style.rubyPosition="tb"===a.bpd?"before"===e?"over":"under":"rl"===a.bpd?"before"===e?"over":"under":"before"===e?"under":"over"}),new c("http://www.w3.org/ns/ttml#styling showBackground",null),new c("http://www.w3.org/ns/ttml#styling textAlign",function(a,b,c,e){a=c.styleAttrs[h.byName.direction.qname];
b.style.textAlign="start"===e?"rtl"===a?"right":"left":"end"===e?"rtl"===a?"left":"right":e}),new c("http://www.w3.org/ns/ttml#styling textDecoration",function(a,b,c,e){b.style.textDecoration=e.join(" ").replace("lineThrough","line-through")}),new c("http://www.w3.org/ns/ttml#styling textOutline",function(a,b,c,e){}),new c("http://www.w3.org/ns/ttml#styling textShadow",function(a,b,c,e){c=c.styleAttrs[h.byName.textOutline.qname];if("none"===e&&"none"===c)b.style.textShadow="";else{var d=[];"none"!==
c&&d.push("rgba("+c.color[0].toString()+","+c.color[1].toString()+","+c.color[2].toString()+","+(c.color[3]/255).toString()+") 0px 0px "+c.thickness.toUsedLength(a.w,a.h)+"px");if("none"!==e)for(var k in e)d.push(e[k].x_off.toUsedLength(a.w,a.h)+"px "+e[k].y_off.toUsedLength(a.w,a.h)+"px "+e[k].b_radius.toUsedLength(a.w,a.h)+"px rgba("+e[k].color[0].toString()+","+e[k].color[1].toString()+","+e[k].color[2].toString()+","+(e[k].color[3]/255).toString()+")");b.style.textShadow=d.join(",")}}),new c("http://www.w3.org/ns/ttml#styling textCombine",
function(a,b,c,e){b.style.textCombineUpright=e.join(" ")}),new c("http://www.w3.org/ns/ttml#styling textEmphasis",function(a,b,c,e){if("none"===e.style)b.style.textEmphasisStyle="none";else if(b.style.textEmphasisStyle="auto"===e.style?"filled":e.style+" "+e.symbol,"before"===e.position||"after"===e.position)b.style.textEmphasisPosition="tb"===a.bpd?"before"===e.position?"left over":"left under":"rl"===a.bpd?"before"===e.position?"right under":"left under":"before"===e.position?"left under":"right under"}),
new c("http://www.w3.org/ns/ttml#styling unicodeBidi",function(a,b,c,e){b.style.unicodeBidi="bidiOverride"===e?"bidi-override":e}),new c("http://www.w3.org/ns/ttml#styling visibility",function(a,b,c,e){b.style.visibility=e}),new c("http://www.w3.org/ns/ttml#styling wrapOption",function(a,b,c,e){b.style.whiteSpace="wrap"===e?"preserve"===c.space?"pre-wrap":"normal":"preserve"===c.space?"pre":"noWrap"}),new c("http://www.w3.org/ns/ttml#styling writingMode",function(a,b,c,e){if("lrtb"===e||"lr"===e)a.writingMode=
"horizontal-tb";else if("rltb"===e||"rl"===e)a.writingMode="horizontal-tb";else if("tblr"===e)a.writingMode="vertical-lr";else if("tbrl"===e||"tb"===e)a.writingMode="vertical-rl";b.style.writingMode=a.writingMode}),new c("http://www.w3.org/ns/ttml#styling zIndex",function(a,b,c,e){b.style.zIndex=e}),new c("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(a,b,c,e){a.displayForcedOnlyMode&&!1===e&&(b.style.visibility="hidden")})],e;for(e in H);})("undefined"===typeof f?this.imscHTML=
{}:f,"undefined"===typeof imscNames?g("./names"):imscNames,"undefined"===typeof imscStyles?g("./styles"):imscStyles,"undefined"===typeof imscUtils?g("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],3:[function(g,t,f){(function(f,g,h,l){function q(a,c,k,f,g,t,m,C,J){if(c<m.begin||c>=m.end)return null;t="regionID"in m&&""!==m.regionID?m.regionID:t;if(null!==g&&t!==k.id&&(!("contents"in m)||"contents"in m&&0===m.contents.length||""!==t))return null;var d=new H(m);for(r in m.sets)c<m.sets[r].begin||
c>=m.sets[r].end||(d.styleAttrs[m.sets[r].qname]=m.sets[r].value);var r={};for(var w in d.styleAttrs)if(r[w]=!0,w===h.byName.writingMode.qname&&!(h.byName.direction.qname in d.styleAttrs)){var v=d.styleAttrs[w];if("lrtb"===v||"lr"===v)d.styleAttrs[h.byName.direction.qname]="ltr";else if("rltb"===v||"rl"===v)d.styleAttrs[h.byName.direction.qname]="rtl"}if(null!==g)for(var u in h.all)if(w=h.all[u],w.qname===h.byName.textDecoration.qname){v=g.styleAttrs[w.qname];var E=d.styleAttrs[w.qname],K=[];void 0===
E?K=v:-1===E.indexOf("none")?((-1===E.indexOf("noUnderline")&&-1!==v.indexOf("underline")||-1!==E.indexOf("underline"))&&K.push("underline"),(-1===E.indexOf("noLineThrough")&&-1!==v.indexOf("lineThrough")||-1!==E.indexOf("lineThrough"))&&K.push("lineThrough"),(-1===E.indexOf("noOverline")&&-1!==v.indexOf("overline")||-1!==E.indexOf("overline"))&&K.push("overline")):K.push("none");d.styleAttrs[w.qname]=K}else w.qname!==h.byName.fontSize.qname||w.qname in d.styleAttrs||"span"!==d.kind||"textContainer"!==
d.styleAttrs[h.byName.ruby.qname]?w.qname!==h.byName.fontSize.qname||w.qname in d.styleAttrs||"span"!==d.kind||"text"!==d.styleAttrs[h.byName.ruby.qname]?w.inherit&&w.qname in g.styleAttrs&&!(w.qname in d.styleAttrs)&&(d.styleAttrs[w.qname]=g.styleAttrs[w.qname]):(v=g.styleAttrs[h.byName.fontSize.qname],d.styleAttrs[w.qname]="textContainer"===g.styleAttrs[h.byName.ruby.qname]?v:new l.ComputedLength(.5*v.rw,.5*v.rh)):(v=g.styleAttrs[h.byName.fontSize.qname],d.styleAttrs[w.qname]=new l.ComputedLength(.5*
v.rw,.5*v.rh));for(var B in h.all)(u=h.all[B],u.qname in d.styleAttrs||u.qname===h.byName.position.qname&&h.byName.origin.qname in d.styleAttrs||u.qname===h.byName.origin.qname&&h.byName.position.qname in d.styleAttrs||(w=a.head.styling.initials[u.qname]||u.initial,"region"!==d.kind&&(!1!==u.inherit||null===w)))||(d.styleAttrs[u.qname]=u.parse(w),r[u.qname]=!0);for(var N in h.all)if(B=h.all[N],B.qname in r&&null!==B.compute)if(u=B.compute(a,g,d,d.styleAttrs[B.qname],J),null!==u)d.styleAttrs[B.qname]=
u;else if(d.styleAttrs[B.qname]=B.compute(a,g,d,B.parse(B.initial),J),B="Style '"+B.qname+"' on element '"+d.kind+"' cannot be computed",C&&C.error&&C.error(B))throw B;if("none"===d.styleAttrs[h.byName.display.qname])return null;if(null===g)var I=null===f?[]:[f];else"contents"in m&&(I=m.contents);for(var Q in I)g=q(a,c,k,f,d,t,I[Q],C,J),null!==g&&d.contents.push(g.element);for(var y in d.styleAttrs)a=!1,"span"===d.kind&&(c=d.styleAttrs[h.byName.ruby.qname],(a=("container"===c||"textContainer"===c||
"baseContainer"===c)&&-1!==e.indexOf(y))||(a="container"!==c&&y===h.byName.rubyAlign.qname),a||(a=!("textContainer"===c||"text"===c)&&y===h.byName.rubyPosition.qname)),a||(a=-1===h.byQName[y].applies.indexOf(d.kind)),a&&delete d.styleAttrs[y];"span"===d.kind&&d.text&&"default"===d.space&&(y=d.text.replace(/[\t\r\n ]+/g," "),d.text=y);if("p"===d.kind){y=[];G(d,y);a=0;c="after_br";for(k=0;;)if("after_br"===c)a>=y.length||"br"===y[a].kind?(c="before_br",k=a,a--):("preserve"!==y[a].space&&(y[a].text=
y[a].text.replace(/^[\t\r\n ]+/g,"")),0<y[a].text.length?(c="looking_br",a++):y.splice(a,1));else if("before_br"===c)if(0>a||"br"===y[a].kind){if(c="after_br",a=k+1,a>=y.length)break}else if("preserve"!==y[a].space&&(y[a].text=y[a].text.replace(/[\t\r\n ]+$/g,"")),0<y[a].text.length){if(c="after_br",a=k+1,a>=y.length)break}else y.splice(a,1),a--;else a>=y.length||"br"===y[a].kind?(c="before_br",k=a,a--):a++;b(d)}return"div"===d.kind&&h.byName.backgroundImage.qname in d.styleAttrs||"br"===d.kind||
"image"===d.kind||"contents"in d&&0<d.contents.length||"span"===d.kind&&null!==d.text||"region"===d.kind&&"always"===d.styleAttrs[h.byName.showBackground.qname]?{region_id:t,element:d}:null}function G(a,b){if("contents"in a)for(var c in a.contents)G(a.contents[c],b);else"span"!==a.kind&&"br"!==a.kind||b.push(a)}function b(a){if("br"===a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var c=a.contents.length;c--;)b(a.contents[c])&&a.contents.splice(c,1);return 0===a.contents.length}}
function c(a){this.contents=[];this.aspectRatio=a.aspectRatio}function H(a){this.kind=a.kind||"region";a.id&&(this.id=a.id);this.styleAttrs={};for(var b in a.styleAttrs)this.styleAttrs[b]=a.styleAttrs[b];"src"in a&&(this.src=a.src);"type"in a&&(this.type=a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}f.generateISD=function(a,b,e){var d=new c(a),h={},f;for(f in a.head.layout.regions){var k=q(a,b,a.head.layout.regions[f],
a.body,null,"",a.head.layout.regions[f],e,h);null!==k&&d.contents.push(k.element)}return d};var e=[h.byName.color.qname,h.byName.textCombine.qname,h.byName.textDecoration.qname,h.byName.textEmphasis.qname,h.byName.textOutline.qname,h.byName.textShadow.qname]})("undefined"===typeof f?this.imscISD={}:f,"undefined"===typeof imscNames?g("./names"):imscNames,"undefined"===typeof imscStyles?g("./styles"):imscStyles,"undefined"===typeof imscUtils?g("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],
4:[function(g,t,f){f.generateISD=g("./isd").generateISD;f.fromXML=g("./doc").fromXML;f.renderHTML=g("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(g,t,f){g="undefined"===typeof f?this.imscNames={}:f;g.ns_tt="http://www.w3.org/ns/ttml";g.ns_tts="http://www.w3.org/ns/ttml#styling";g.ns_ttp="http://www.w3.org/ns/ttml#parameter";g.ns_xml="http://www.w3.org/XML/1998/namespace";g.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";g.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";
g.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";g.ns_ebutts="urn:ebu:tt:style"},{}],6:[function(g,t,f){(function(f,g,h){function l(b,c,f,e,a,d,h,g){this.name=c;this.ns=b;this.qname=b+" "+c;this.inherit=a;this.animatable=d;this.initial=f;this.applies=e;this.parse=h;this.compute=g}f.all=[new l(g.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,h.parseColor,null),new l(g.ns_tts,"color","white",["span"],!0,!0,h.parseColor,null),new l(g.ns_tts,"direction",
"ltr",["p","span"],!0,!0,function(b){return b},null),new l(g.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(b){return b},null),new l(g.ns_tts,"displayAlign","before",["region"],!1,!0,function(b){return b},null),new l(g.ns_tts,"extent","auto",["tt","region"],!1,!0,function(b){if("auto"===b)return b;var c=b.split(" ");if(2!==c.length)return null;b=h.parseLength(c[0]);return(c=h.parseLength(c[1]))&&b?{h:c,w:b}:null},function(b,c,f,e,a){if("auto"===e)c=new h.ComputedLength(0,
1);else if(c=h.toComputedLength(e.h.value,e.h.unit,null,b.dimensions.h,null,b.pxLength.h),null===c)return null;if("auto"===e)b=new h.ComputedLength(1,0);else if(b=h.toComputedLength(e.w.value,e.w.unit,null,b.dimensions.w,null,b.pxLength.w),null===b)return null;return{h:c,w:b}}),new l(g.ns_tts,"fontFamily","default",["span"],!0,!0,function(b){b=b.split(",");var c=[],f;for(f in b)"'"!==b[f].charAt(0)&&'"'!==b[f].charAt(0)?"default"===b[f]?c.push("monospaceSerif"):c.push(b[f]):c.push(b[f]);return c},
null),new l(g.ns_tts,"shear","0%",["p"],!0,!0,h.parseLength,function(b,c,f,e){if("%"===e.unit)b=100<Math.abs(e.value)?100*Math.sign(e.value):e.value;else return null;return b}),new l(g.ns_tts,"fontSize","1c",["span"],!0,!0,h.parseLength,function(b,c,g,e,a){return h.toComputedLength(e.value,e.unit,null!==c?c.styleAttrs[f.byName.fontSize.qname]:b.cellLength.h,null!==c?c.styleAttrs[f.byName.fontSize.qname]:b.cellLength.h,b.cellLength.h,b.pxLength.h)}),new l(g.ns_tts,"fontStyle","normal",["span"],!0,
!0,function(b){return b},null),new l(g.ns_tts,"fontWeight","normal",["span"],!0,!0,function(b){return b},null),new l(g.ns_tts,"lineHeight","normal",["p"],!0,!0,function(b){return"normal"===b?b:h.parseLength(b)},function(b,c,g,e,a){if("normal"===e)b=e;else if(b=h.toComputedLength(e.value,e.unit,g.styleAttrs[f.byName.fontSize.qname],g.styleAttrs[f.byName.fontSize.qname],b.cellLength.h,b.pxLength.h),null===b)return null;return b}),new l(g.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new l(g.ns_tts,
"origin","auto",["region"],!1,!0,function(b){if("auto"===b)return b;var c=b.split(" ");if(2!==c.length)return null;b=h.parseLength(c[0]);return(c=h.parseLength(c[1]))&&b?{h:c,w:b}:null},function(b,c,f,e,a){if("auto"===e)c=new h.ComputedLength(0,0);else if(c=h.toComputedLength(e.h.value,e.h.unit,null,b.dimensions.h,null,b.pxLength.h),null===c)return null;if("auto"===e)b=new h.ComputedLength(0,0);else if(b=h.toComputedLength(e.w.value,e.w.unit,null,b.dimensions.w,null,b.pxLength.w),null===b)return null;
return{h:c,w:b}}),new l(g.ns_tts,"overflow","hidden",["region"],!1,!0,function(b){return b},null),new l(g.ns_tts,"padding","0px",["region"],!1,!0,function(b){b=b.split(" ");if(4<b.length)return null;var c=[],f;for(f in b){var e=h.parseLength(b[f]);if(!e)return null;c.push(e)}return c},function(b,c,g,e,a){if(1===e.length)c=[e[0],e[0],e[0],e[0]];else if(2===e.length)c=[e[0],e[1],e[0],e[1]];else if(3===e.length)c=[e[0],e[1],e[2],e[1]];else if(4===e.length)c=[e[0],e[1],e[2],e[3]];else return null;e=g.styleAttrs[f.byName.writingMode.qname];
if("lrtb"===e||"lr"===e)c=[c[0],c[3],c[2],c[1]];else if("rltb"===e||"rl"===e)c=[c[0],c[1],c[2],c[3]];else if("tblr"===e)c=[c[3],c[0],c[1],c[2]];else if("tbrl"===e||"tb"===e)c=[c[3],c[2],c[1],c[0]];else return null;e=[];for(var d in c)if(0===c[d].value)e[d]=new h.ComputedLength(0,0);else if(e[d]=h.toComputedLength(c[d].value,c[d].unit,g.styleAttrs[f.byName.fontSize.qname],"0"===d||"2"===d?g.styleAttrs[f.byName.extent.qname].h:g.styleAttrs[f.byName.extent.qname].w,"0"===d||"2"===d?b.cellLength.h:b.cellLength.w,
"0"===d||"2"===d?b.pxLength.h:b.pxLength.w),null===e[d])return null;return e}),new l(g.ns_tts,"position","top left",["region"],!1,!0,function(b){return h.parsePosition(b)},function(b,c,g,e){c=h.toComputedLength(e.v.offset.value,e.v.offset.unit,null,new h.ComputedLength(-g.styleAttrs[f.byName.extent.qname].h.rw,b.dimensions.h.rh-g.styleAttrs[f.byName.extent.qname].h.rh),null,b.pxLength.h);if(null===c)return null;"bottom"===e.v.edge&&(c=new h.ComputedLength(-c.rw-g.styleAttrs[f.byName.extent.qname].h.rw,
b.dimensions.h.rh-c.rh-g.styleAttrs[f.byName.extent.qname].h.rh));var a=h.toComputedLength(e.h.offset.value,e.h.offset.unit,null,new h.ComputedLength(b.dimensions.w.rw-g.styleAttrs[f.byName.extent.qname].w.rw,-g.styleAttrs[f.byName.extent.qname].w.rh),null,b.pxLength.w);if(null===c)return null;"right"===e.h.edge&&(a=new h.ComputedLength(b.dimensions.w.rw-a.rw-g.styleAttrs[f.byName.extent.qname].w.rw,-a.rh-g.styleAttrs[f.byName.extent.qname].w.rh));return{h:c,w:a}}),new l(g.ns_tts,"ruby","none",["span"],
!1,!0,function(b){return b},null),new l(g.ns_tts,"rubyAlign","center",["span"],!0,!0,function(b){return"center"!==b&&"spaceAround"!==b?null:b},null),new l(g.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(b){return b},null),new l(g.ns_tts,"rubyReserve","none",["p"],!0,!0,function(b){var c=b.split(" ");b=[null,null];if(0===c.length||2<c.length||"none"!==c[0]&&"both"!==c[0]&&"after"!==c[0]&&"before"!==c[0]&&"outside"!==c[0])return null;b[0]=c[0];if(2===c.length&&"none"!==c[0])if(c=h.parseLength(c[1]))b[1]=
c;else return null;return b},function(b,c,g,e,a){if("none"===e[0])return e;b=null===e[1]?new h.ComputedLength(.5*g.styleAttrs[f.byName.fontSize.qname].rw,.5*g.styleAttrs[f.byName.fontSize.qname].rh):h.toComputedLength(e[1].value,e[1].unit,g.styleAttrs[f.byName.fontSize.qname],g.styleAttrs[f.byName.fontSize.qname],b.cellLength.h,b.pxLength.h);return null===b?null:[e[0],b]}),new l(g.ns_tts,"showBackground","always",["region"],!1,!0,function(b){return b},null),new l(g.ns_tts,"textAlign","start",["p"],
!0,!0,function(b){return b},function(b,c,f,e,a){return"left"===e?"start":"right"===e?"end":e}),new l(g.ns_tts,"textCombine","none",["span"],!0,!0,function(b){b=b.split(" ");return 1!==b.length||"none"!==b[0]&&"all"!==b[0]?null:[b[0]]},null),new l(g.ns_tts,"textDecoration","none",["span"],!0,!0,function(b){return b.split(" ")},null),new l(g.ns_tts,"textEmphasis","none",["span"],!0,!0,function(b){b=b.split(" ");var c={style:null,symbol:null,color:null,position:null},f;for(f in b)if("none"===b[f]||"auto"===
b[f])c.style=b[f];else if("filled"===b[f]||"open"===b[f])c.style=b[f];else if("circle"===b[f]||"dot"===b[f]||"sesame"===b[f])c.symbol=b[f];else if("current"===b[f])c.color=b[f];else if("outside"===b[f]||"before"===b[f]||"after"===b[f])c.position=b[f];else if(c.color=h.parseColor(b[f]),null===c.color)return null;null==c.style&&null==c.symbol?c.style="auto":(c.symbol=c.symbol||"circle",c.style=c.style||"filled");c.position=c.position||"outside";c.color=c.color||"current";return c},null),new l(g.ns_tts,
"textOutline","none",["span"],!0,!0,function(b){if("none"===b)return b;var c={};b=b.split(" ");if(0===b.length||2<b.length)return null;var f=h.parseColor(b[0]);c.color=f;null!==f&&b.shift();if(1!==b.length)return null;b=h.parseLength(b[0]);if(!b)return null;c.thickness=b;return c},function(b,c,g,e,a){if("none"===e)return e;c={};c.color=null===e.color?g.styleAttrs[f.byName.color.qname]:e.color;c.thickness=h.toComputedLength(e.thickness.value,e.thickness.unit,g.styleAttrs[f.byName.fontSize.qname],g.styleAttrs[f.byName.fontSize.qname],
b.cellLength.h,b.pxLength.h);return null===c.thickness?null:c}),new l(g.ns_tts,"textShadow","none",["span"],!0,!0,h.parseTextShadow,function(b,c,g,e){if("none"===e)return e;c=[];for(var a in e){var d={};d.x_off=h.toComputedLength(e[a][0].value,e[a][0].unit,null,g.styleAttrs[f.byName.fontSize.qname],null,b.pxLength.w);if(null===d.x_off)return null;d.y_off=h.toComputedLength(e[a][1].value,e[a][1].unit,null,g.styleAttrs[f.byName.fontSize.qname],null,b.pxLength.h);if(null===d.y_off)return null;if(null===
e[a][2])d.b_radius=0;else if(d.b_radius=h.toComputedLength(e[a][2].value,e[a][2].unit,null,g.styleAttrs[f.byName.fontSize.qname],null,b.pxLength.h),null===d.b_radius)return null;d.color=null===e[a][3]?g.styleAttrs[f.byName.color.qname]:e[a][3];c.push(d)}return c}),new l(g.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(b){return b},null),new l(g.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(b){return b},null),new l(g.ns_tts,"wrapOption","wrap",["span"],
!0,!0,function(b){return b},null),new l(g.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(b){return b},null),new l(g.ns_tts,"zIndex","auto",["region"],!1,!0,function(b){"auto"!==b&&(b=parseInt(b),isNaN(b)&&(b=null));return b},null),new l(g.ns_ebutts,"linePadding","0c",["p"],!0,!1,h.parseLength,function(b,c,f,e,a){return h.toComputedLength(e.value,e.unit,null,null,b.cellLength.w,null)}),new l(g.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(b){return b},null),new l(g.ns_smpte,"backgroundImage",
null,["div"],!1,!1,function(b){return b},null),new l(g.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(b){return"true"===b?!0:!1},null),new l(g.ns_itts,"fillLineGap","false",["p"],!0,!0,function(b){return"true"===b?!0:!1},null)];f.byQName={};for(var q in f.all)f.byQName[f.all[q].qname]=f.all[q];f.byName={};for(var t in f.all)f.byName[f.all[t].name]=f.all[t]})("undefined"===typeof f?this.imscStyles={}:f,"undefined"===typeof imscNames?g("./names"):imscNames,"undefined"===
typeof imscUtils?g("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(g,t,f){(function(f){var g=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,h=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,l=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,q={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],
green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};f.parseColor=function(b){var c,f=null,e=q[b.toLowerCase()];void 0!==e?f=e:null!==(c=g.exec(b))?f=[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16),void 0!==c[4]?parseInt(c[4],16):255]:null!==(c=h.exec(b))?f=[parseInt(c[1]),parseInt(c[2]),parseInt(c[3]),255]:null!==(c=l.exec(b))&&(f=[parseInt(c[1]),parseInt(c[2]),
parseInt(c[3]),parseInt(c[4])]);return f};var t=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;f.parseLength=function(b){var c,f=null;null!==(c=t.exec(b))&&(f={value:parseFloat(c[1]),unit:c[2]});return f};f.parseTextShadow=function(b){b=b.split(",");var c=[],g;for(g in b){var e=b[g].split(" ");if(1===e.length&&"none"===e[0])return"none";if(1<e.length&&5>e.length){var a=[null,null,null,null],d=f.parseLength(e.shift());if(null===d)return null;a[0]=d;d=f.parseLength(e.shift());if(null===d)return null;
a[1]=d;if(0!==e.length&&(d=f.parseLength(e[0]),null!==d&&(a[2]=d,e.shift()),0!==e.length)){e=f.parseColor(e[0]);if(null===e)return null;a[3]=e}c.push(a)}}return c};f.parsePosition=function(b){b=b.split(" ");var c=function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<b.length)return null;for(var g in b)if(!c(b[g])){var e=f.parseLength(b[g]);if(null===e)return null;b[g]=e}g={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(e=
0;e<b.length;){var a=b[e++];if(c(a)){var d={value:0,unit:"%"};2!==b.length&&e<b.length&&!c(b[e])&&(d=b[e++]);"right"===a?(g.h.edge=a,g.h.offset=d):"bottom"===a?(g.v.edge=a,g.v.offset=d):"left"===a?g.h.offset=d:"top"===a&&(g.v.offset=d)}else if(1===b.length||2===b.length)1===e?g.h.offset=a:g.v.offset=a;else return null}return g};f.ComputedLength=function(b,c){this.rw=b;this.rh=c};f.ComputedLength.prototype.toUsedLength=function(b,c){return b*this.rw+c*this.rh};f.ComputedLength.prototype.isZero=function(){return 0===
this.rw&&0===this.rh};f.toComputedLength=function(b,c,g,e,a,d){return"%"===c&&e?new f.ComputedLength(e.rw*b/100,e.rh*b/100):"em"===c&&g?new f.ComputedLength(g.rw*b,g.rh*b):"c"===c&&a?new f.ComputedLength(b*a.rw,b*a.rh):"px"===c&&d?new f.ComputedLength(b*d.rw,b*d.rh):"rh"===c?new f.ComputedLength(0,b/100):"rw"===c?new f.ComputedLength(b/100,0):null}})("undefined"===typeof f?this.imscUtils={}:f)},{}]},{},[4])(4)});
